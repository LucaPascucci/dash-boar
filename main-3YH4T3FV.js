import{$ as Ot,A as kt,B as bn,C as Mu,D as at,E as tT,F as nT,G as Dn,H as oi,I as pa,J as ga,K as ma,L as ai,M as rT,N as iT,O as sT,P as oT,Q as _a,R as ya,S as fe,T as Ge,U as vt,V as Sn,W as zf,X as xu,Y as We,Z as Ye,_ as Zn,a as U,aa as aT,b as Pe,ba as Ze,c as Dr,ca as ku,d as y,da as q,e as F,ea as cT,f as is,g as WE,h as KE,i as QE,j as YE,k as ZE,l as Sr,m as Hf,n as qf,o as ss,p as yt,q as da,r as JE,s as ha,t as Pu,u as XE,v as Cn,w as eT,x as Yn,y as si,z as fa}from"./chunk-VUN4IAWB.js";function Ux(n,e){return Object.is(n,e)}var rt=null,Ou=!1,Fu=1,os=Symbol("SIGNAL");function ye(n){let e=rt;return rt=n,e}function uT(){return rt}var Lu={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function lT(n){if(Ou)throw new Error("");if(rt===null)return;rt.consumerOnSignalRead(n);let e=rt.nextProducerIndex++;if(Uu(rt),e<rt.producerNode.length&&rt.producerNode[e]!==n&&va(rt)){let t=rt.producerNode[e];Vu(t,rt.producerIndexOfThis[e])}rt.producerNode[e]!==n&&(rt.producerNode[e]=n,rt.producerIndexOfThis[e]=va(rt)?pT(n,rt,e):0),rt.producerLastReadVersion[e]=n.version}function jx(){Fu++}function Bx(n){if(!(va(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Fu)){if(!n.producerMustRecompute(n)&&!Wf(n)){n.dirty=!1,n.lastCleanEpoch=Fu;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Fu}}function dT(n){if(n.liveConsumerNode===void 0)return;let e=Ou;Ou=!0;try{for(let t of n.liveConsumerNode)t.dirty||$x(t)}finally{Ou=e}}function hT(){return rt?.consumerAllowSignalWrites!==!1}function $x(n){n.dirty=!0,dT(n),n.consumerMarkedDirty?.(n)}function Gf(n){return n&&(n.nextProducerIndex=0),ye(n)}function fT(n,e){if(ye(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(va(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Vu(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Wf(n){Uu(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Bx(t),r!==t.version))return!0}return!1}function Kf(n){if(Uu(n),va(n))for(let e=0;e<n.producerNode.length;e++)Vu(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function pT(n,e,t){if(gT(n),n.liveConsumerNode.length===0&&mT(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=pT(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Vu(n,e){if(gT(n),n.liveConsumerNode.length===1&&mT(n))for(let r=0;r<n.producerNode.length;r++)Vu(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Uu(i),i.producerIndexOfThis[r]=e}}function va(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Uu(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function gT(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function mT(n){return n.producerNode!==void 0}function Hx(){throw new Error}var _T=Hx;function yT(){_T()}function vT(n){_T=n}var qx=null;function IT(n){let e=Object.create(ET);e.value=n;let t=()=>(lT(e),e.value);return t[os]=e,t}function Qf(n,e){hT()||yT(),n.equal(n.value,e)||(n.value=e,zx(n))}function wT(n,e){hT()||yT(),Qf(n,e(n.value))}var ET=Pe(U({},Lu),{equal:Ux,value:void 0});function zx(n){n.version++,jx(),dT(n),qx?.()}function re(n){return typeof n=="function"}function as(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ju=as(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ci(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var $e=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(re(r))try{r()}catch(s){e=s instanceof ju?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{TT(s)}catch(o){e=e??[],o instanceof ju?e=[...e,...o.errors]:e.push(o)}}if(e)throw new ju(e)}}add(e){var t;if(e&&e!==this)if(this.closed)TT(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ci(t,e)}remove(e){let{_finalizers:t}=this;t&&ci(t,e),e instanceof n&&e._removeParent(this)}};$e.EMPTY=(()=>{let n=new $e;return n.closed=!0,n})();var Yf=$e.EMPTY;function Bu(n){return n instanceof $e||n&&"closed"in n&&re(n.remove)&&re(n.add)&&re(n.unsubscribe)}function TT(n){re(n)?n():n.unsubscribe()}var ln={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var cs={setTimeout(n,e,...t){let{delegate:r}=cs;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=cs;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function $u(n){cs.setTimeout(()=>{let{onUnhandledError:e}=ln;if(e)e(n);else throw n})}function Ia(){}var CT=Zf("C",void 0,void 0);function bT(n){return Zf("E",void 0,n)}function DT(n){return Zf("N",n,void 0)}function Zf(n,e,t){return{kind:n,value:e,error:t}}var ui=null;function us(n){if(ln.useDeprecatedSynchronousErrorHandling){let e=!ui;if(e&&(ui={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ui;if(ui=null,t)throw r}}else n()}function ST(n){ln.useDeprecatedSynchronousErrorHandling&&ui&&(ui.errorThrown=!0,ui.error=n)}var li=class extends $e{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Bu(e)&&e.add(this)):this.destination=Kx}static create(e,t,r){return new ls(e,t,r)}next(e){this.isStopped?Xf(DT(e),this):this._next(e)}error(e){this.isStopped?Xf(bT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Xf(CT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Gx=Function.prototype.bind;function Jf(n,e){return Gx.call(n,e)}var ep=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Hu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Hu(r)}else Hu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Hu(t)}}},ls=class extends li{constructor(e,t,r){super();let i;if(re(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&ln.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Jf(e.next,s),error:e.error&&Jf(e.error,s),complete:e.complete&&Jf(e.complete,s)}):i=e}this.destination=new ep(i)}};function Hu(n){ln.useDeprecatedSynchronousErrorHandling?ST(n):$u(n)}function Wx(n){throw n}function Xf(n,e){let{onStoppedNotification:t}=ln;t&&cs.setTimeout(()=>t(n,e))}var Kx={closed:!0,next:Ia,error:Wx,complete:Ia};var ds=typeof Symbol=="function"&&Symbol.observable||"@@observable";function At(n){return n}function qu(...n){return tp(n)}function tp(n){return n.length===0?At:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var le=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=Yx(t)?t:new ls(t,r,i);return us(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=AT(r),new r((i,s)=>{let o=new ls({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ds](){return this}pipe(...t){return tp(t)(this)}toPromise(t){return t=AT(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function AT(n){var e;return(e=n??ln.Promise)!==null&&e!==void 0?e:Promise}function Qx(n){return n&&re(n.next)&&re(n.error)&&re(n.complete)}function Yx(n){return n&&n instanceof li||Qx(n)&&Bu(n)}function np(n){return re(n?.lift)}function ae(n){return e=>{if(np(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(n,e,t,r,i){return new wa(n,e,t,r,i)}var wa=class extends li{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function hs(){return ae((n,e)=>{let t=null;n._refCount++;let r=ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var fs=class extends le{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,np(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new $e;let t=this.getSubject();e.add(this.source.subscribe(ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=$e.EMPTY)}return e}refCount(){return hs()(this)}};var RT=as(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var it=(()=>{class n extends le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new zu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new RT}next(t){us(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){us(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){us(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Yf:(this.currentObservers=null,s.push(t),new $e(()=>{this.currentObservers=null,ci(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new le;return t.source=this,t}}return n.create=(e,t)=>new zu(e,t),n})(),zu=class extends it{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Yf}};var dt=class extends it{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var rp={now(){return(rp.delegate||Date).now()},delegate:void 0};var Gu=class extends $e{constructor(e,t){super()}schedule(e,t=0){return this}};var Ea={setInterval(n,e,...t){let{delegate:r}=Ea;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Ea;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ps=class extends Gu{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Ea.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Ea.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ci(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var gs=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};gs.now=rp.now;var ms=class extends gs{constructor(e,t=gs.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ip=new ms(ps);var Wu=class extends ps{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Ku=class extends ms{};var sp=new Ku(Wu);var Ht=new le(n=>n.complete());function NT(n){return n&&re(n.schedule)}function PT(n){return n[n.length-1]}function MT(n){return re(PT(n))?n.pop():void 0}function Ar(n){return NT(PT(n))?n.pop():void 0}function op(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function kT(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(p){o(p)}}function c(d){try{l(r.throw(d))}catch(p){o(p)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function xT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function di(n){return this instanceof di?(this.v=n,this):new di(n)}function OT(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,p)}}function a(_,E){r[_]&&(i[_]=function(N){return new Promise(function(A,M){s.push([_,N,A,M])>1||c(_,N)})},E&&(i[_]=E(i[_])))}function c(_,E){try{l(r[_](E))}catch(N){g(s[0][3],N)}}function l(_){_.value instanceof di?Promise.resolve(_.value.v).then(d,p):g(s[0][2],_)}function d(_){c("next",_)}function p(_){c("throw",_)}function g(_,E){_(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function FT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof xT=="function"?xT(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Qu=n=>n&&typeof n.length=="number"&&typeof n!="function";function Yu(n){return re(n?.then)}function Zu(n){return re(n[ds])}function Ju(n){return Symbol.asyncIterator&&re(n?.[Symbol.asyncIterator])}function Xu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Zx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var el=Zx();function tl(n){return re(n?.[el])}function nl(n){return OT(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield di(t.read());if(i)return yield di(void 0);yield yield di(r)}}finally{t.releaseLock()}})}function rl(n){return re(n?.getReader)}function Je(n){if(n instanceof le)return n;if(n!=null){if(Zu(n))return Jx(n);if(Qu(n))return Xx(n);if(Yu(n))return ek(n);if(Ju(n))return LT(n);if(tl(n))return tk(n);if(rl(n))return nk(n)}throw Xu(n)}function Jx(n){return new le(e=>{let t=n[ds]();if(re(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Xx(n){return new le(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function ek(n){return new le(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,$u)})}function tk(n){return new le(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function LT(n){return new le(e=>{rk(n,e).catch(t=>e.error(t))})}function nk(n){return LT(nl(n))}function rk(n,e){var t,r,i,s;return kT(this,void 0,void 0,function*(){try{for(t=FT(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Ft(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Rr(n,e=0){return ae((t,r)=>{t.subscribe(ce(r,i=>Ft(r,n,()=>r.next(i),e),()=>Ft(r,n,()=>r.complete(),e),i=>Ft(r,n,()=>r.error(i),e)))})}function Nr(n,e=0){return ae((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function VT(n,e){return Je(n).pipe(Nr(e),Rr(e))}function UT(n,e){return Je(n).pipe(Nr(e),Rr(e))}function jT(n,e){return new le(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function BT(n,e){return new le(t=>{let r;return Ft(t,e,()=>{r=n[el](),Ft(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>re(r?.return)&&r.return()})}function il(n,e){if(!n)throw new Error("Iterable cannot be null");return new le(t=>{Ft(t,e,()=>{let r=n[Symbol.asyncIterator]();Ft(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function $T(n,e){return il(nl(n),e)}function HT(n,e){if(n!=null){if(Zu(n))return VT(n,e);if(Qu(n))return jT(n,e);if(Yu(n))return UT(n,e);if(Ju(n))return il(n,e);if(tl(n))return BT(n,e);if(rl(n))return $T(n,e)}throw Xu(n)}function He(n,e){return e?HT(n,e):Je(n)}function W(...n){let e=Ar(n);return He(n,e)}function _s(n,e){let t=re(n)?n:()=>n,r=i=>i.error(t());return new le(e?i=>e.schedule(r,0,i):r)}function ap(n){return!!n&&(n instanceof le||re(n.lift)&&re(n.subscribe))}var Jn=as(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function te(n,e){return ae((t,r)=>{let i=0;t.subscribe(ce(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:ik}=Array;function sk(n,e){return ik(e)?n(...e):n(e)}function qT(n){return te(e=>sk(n,e))}var{isArray:ok}=Array,{getPrototypeOf:ak,prototype:ck,keys:uk}=Object;function zT(n){if(n.length===1){let e=n[0];if(ok(e))return{args:e,keys:null};if(lk(e)){let t=uk(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function lk(n){return n&&typeof n=="object"&&ak(n)===ck}function GT(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function sl(...n){let e=Ar(n),t=MT(n),{args:r,keys:i}=zT(n);if(r.length===0)return He([],e);let s=new le(dk(r,e,i?o=>GT(i,o):At));return t?s.pipe(qT(t)):s}function dk(n,e,t=At){return r=>{WT(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)WT(e,()=>{let l=He(n[c],e),d=!1;l.subscribe(ce(r,p=>{s[c]=p,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function WT(n,e,t){n?Ft(t,n,e):e()}function KT(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,p=!1,g=()=>{p&&!c.length&&!l&&e.complete()},_=N=>l<r?E(N):c.push(N),E=N=>{s&&e.next(N),l++;let A=!1;Je(t(N,d++)).subscribe(ce(e,M=>{i?.(M),s?_(M):e.next(M)},()=>{A=!0},void 0,()=>{if(A)try{for(l--;c.length&&l<r;){let M=c.shift();o?Ft(e,o,()=>E(M)):E(M)}g()}catch(M){e.error(M)}}))};return n.subscribe(ce(e,_,()=>{p=!0,g()})),()=>{a?.()}}function Ke(n,e,t=1/0){return re(e)?Ke((r,i)=>te((s,o)=>e(r,s,i,o))(Je(n(r,i))),t):(typeof e=="number"&&(t=e),ae((r,i)=>KT(r,i,n,t)))}function cp(n=1/0){return Ke(At,n)}function QT(){return cp(1)}function ys(...n){return QT()(He(n,Ar(n)))}function ol(n){return new le(e=>{Je(n()).subscribe(e)})}function Rt(n,e){return ae((t,r)=>{let i=0;t.subscribe(ce(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Pr(n){return ae((e,t)=>{let r=null,i=!1,s;r=e.subscribe(ce(t,void 0,void 0,o=>{s=Je(n(o,Pr(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function YT(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(ce(o,d=>{let p=l++;c=a?n(c,d,p):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function hi(n,e){return re(e)?Ke(n,e,1):Ke(n,1)}function Mr(n){return ae((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Xn(n){return n<=0?()=>Ht:ae((e,t)=>{let r=0;e.subscribe(ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function up(n){return te(()=>n)}function al(n,e=At){return n=n??hk,ae((t,r)=>{let i,s=!0;t.subscribe(ce(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function hk(n,e){return n===e}function cl(n=fk){return ae((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function fk(){return new Jn}function Ta(n){return ae((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function An(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Rt((i,s)=>n(i,s,r)):At,Xn(1),t?Mr(e):cl(()=>new Jn))}function lp(n,e,t,r){return ae((i,s)=>{let o;!e||typeof e=="function"?o=e:{duration:t,element:o,connector:r}=e;let a=new Map,c=E=>{a.forEach(E),E(s)},l=E=>c(N=>N.error(E)),d=0,p=!1,g=new wa(s,E=>{try{let N=n(E),A=a.get(N);if(!A){a.set(N,A=r?r():new it);let M=_(N,A);if(s.next(M),t){let L=ce(A,()=>{A.complete(),L?.unsubscribe()},void 0,void 0,()=>a.delete(N));g.add(Je(t(M)).subscribe(L))}}A.next(o?o(E):E)}catch(N){l(N)}},()=>c(E=>E.complete()),l,()=>a.clear(),()=>(p=!0,d===0));i.subscribe(g);function _(E,N){let A=new le(M=>{d++;let L=N.subscribe(M);return()=>{L.unsubscribe(),--d===0&&p&&g.unsubscribe()}});return A.key=E,A}})}function vs(n){return n<=0?()=>Ht:ae((e,t)=>{let r=[];e.subscribe(ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function dp(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Rt((i,s)=>n(i,s,r)):At,vs(1),t?Mr(e):cl(()=>new Jn))}function ul(){return ae((n,e)=>{let t,r=!1;n.subscribe(ce(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function ll(n,e){return ae(YT(n,e,arguments.length>=2,!0))}function Is(...n){let e=Ar(n);return ae((t,r)=>{(e?ys(n,t,e):ys(n,t)).subscribe(r)})}function Lt(n,e){return ae((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(ce(r,c=>{i?.unsubscribe();let l=0,d=s++;Je(n(c,d)).subscribe(i=ce(r,p=>r.next(e?e(c,p,d,l++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function ws(n){return ae((e,t)=>{Je(n).subscribe(ce(t,()=>t.complete(),Ia)),!t.closed&&e.subscribe(t)})}function st(n,e,t){let r=re(n)||e||t?{next:n,error:e,complete:t}:n;return r?ae((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ce(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):At}var J=class extends Error{constructor(e,t){super(tg(e,t)),this.code=e}};function tg(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Ul(n){return{toString:n}.toString()}var dl="__parameters__";function pk(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function gk(n,e,t){return Ul(()=>{let r=pk(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let p=c.hasOwnProperty(dl)?c[dl]:Object.defineProperty(c,dl,{value:[]})[dl];for(;p.length<=d;)p.push(null);return(p[d]=p[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Re(n){for(let e in n)if(n[e]===Re)return e;throw Error("Could not find renamed property on target object.")}function qt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(qt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function ZT(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var mk=Re({__forward_ref__:Re});function PC(n){return n.__forward_ref__=PC,n.toString=function(){return qt(this())},n}function Xt(n){return MC(n)?n():n}function MC(n){return typeof n=="function"&&n.hasOwnProperty(mk)&&n.__forward_ref__===PC}function H(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function jl(n){return JT(n,kC)||JT(n,OC)}function xC(n){return jl(n)!==null}function JT(n,e){return n.hasOwnProperty(e)?n[e]:null}function _k(n){let e=n&&(n[kC]||n[OC]);return e||null}function XT(n){return n&&(n.hasOwnProperty(eC)||n.hasOwnProperty(yk))?n[eC]:null}var kC=Re({\u0275prov:Re}),eC=Re({\u0275inj:Re}),OC=Re({ngInjectableDef:Re}),yk=Re({ngInjectorDef:Re}),j=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=H({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function FC(n){return n&&!!n.\u0275providers}var vk=Re({\u0275cmp:Re}),Ik=Re({\u0275dir:Re}),wk=Re({\u0275pipe:Re}),Ek=Re({\u0275mod:Re}),yl=Re({\u0275fac:Re}),Da=Re({__NG_ELEMENT_ID__:Re}),tC=Re({__NG_ENV_ID__:Re});function LC(n){return typeof n=="string"?n:n==null?"":String(n)}function Tk(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():LC(n)}function Ck(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new J(-200,n)}function ng(n,e){throw new J(-201,!1)}var ue=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ue||{}),Ip;function VC(){return Ip}function Jt(n){let e=Ip;return Ip=n,e}function UC(n,e,t){let r=jl(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ue.Optional)return null;if(e!==void 0)return e;ng(n,"Injector")}var bk={},Sa=bk,wp="__NG_DI_FLAG__",vl="ngTempTokenPath",Dk="ngTokenPath",Sk=/\n/gm,Ak="\u0275",nC="__source",bs;function Rk(){return bs}function xr(n){let e=bs;return bs=n,e}function Nk(n,e=ue.Default){if(bs===void 0)throw new J(-203,!1);return bs===null?UC(n,void 0,e):bs.get(n,e&ue.Optional?null:void 0,e)}function Y(n,e=ue.Default){return(VC()||Nk)(Xt(n),e)}function O(n,e=ue.Default){return Y(n,Bl(e))}function Bl(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ep(n){let e=[];for(let t=0;t<n.length;t++){let r=Xt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new J(900,!1);let i,s=ue.Default;for(let o=0;o<r.length;o++){let a=r[o],c=Mk(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(Y(i,s))}else e.push(Y(r))}return e}function Pk(n,e){return n[wp]=e,n.prototype[wp]=e,n}function Mk(n){return n[wp]}function xk(n,e,t,r){let i=n[vl];throw e[nC]&&i.unshift(e[nC]),n.message=kk(`
`+n.message,i,t,r),n[Dk]=i,n[vl]=null,n}function kk(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==Ak?n.slice(2):n;let i=qt(e);if(Array.isArray(e))i=e.map(qt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):qt(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Sk,`
  `)}`}var X=Pk(gk("Optional"),8);function Ss(n,e){let t=n.hasOwnProperty(yl);return t?n[yl]:null}function rg(n,e){n.forEach(t=>Array.isArray(t)?rg(t,e):e(t))}function jC(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Il(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var Aa={},As=[],Rs=new j(""),BC=new j("",-1),$C=new j(""),wl=class{get(e,t=Sa){if(t===Sa){let r=new Error(`NullInjectorError: No provider for ${qt(e)}!`);throw r.name="NullInjectorError",r}return t}},HC=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(HC||{}),Pn=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Pn||{}),Or=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Or||{});function Ok(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Tp(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];Lk(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function Fk(n){return n===3||n===4||n===6}function Lk(n){return n.charCodeAt(0)===64}function ig(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?rC(n,t,i,null,e[++r]):rC(n,t,i,null,null))}}return n}function rC(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var qC="ng-template";function Vk(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Ok(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(sg(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function sg(n){return n.type===4&&n.value!==qC}function Uk(n,e,t){let r=n.type===4&&!t?qC:n.value;return e===r}function jk(n,e,t){let r=4,i=n.attrs,s=i!==null?Hk(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!dn(r)&&!dn(c))return!1;if(o&&dn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!Uk(n,c,t)||c===""&&e.length===1){if(dn(r))return!1;o=!0}}else if(r&8){if(i===null||!Vk(n,i,c,t)){if(dn(r))return!1;o=!0}}else{let l=e[++a],d=Bk(c,i,sg(n),t);if(d===-1){if(dn(r))return!1;o=!0;continue}if(l!==""){let p;if(d>s?p="":p=i[d+1].toLowerCase(),r&2&&l!==p){if(dn(r))return!1;o=!0}}}}return dn(r)||o}function dn(n){return(n&1)===0}function Bk(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return qk(e,n)}function $k(n,e,t=!1){for(let r=0;r<e.length;r++)if(jk(n,e[r],t))return!0;return!1}function Hk(n){for(let e=0;e<n.length;e++){let t=n[e];if(Fk(t))return e}return n.length}function qk(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function iC(n,e){return n?":not("+e.trim()+")":e}function zk(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!dn(o)&&(e+=iC(s,i),i=""),r=o,s=s||!dn(r);t++}return i!==""&&(e+=iC(s,i)),e}function Gk(n){return n.map(zk).join(",")}function Wk(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!dn(i))break;i=s}r++}return{attrs:e,classes:t}}function Fs(n){return Ul(()=>{let e=QC(n),t=Pe(U({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===HC.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Pn.Emulated,styles:n.styles||As,_:null,schemas:n.schemas||null,tView:null,id:""});YC(t);let r=n.dependencies;return t.directiveDefs=oC(r,!1),t.pipeDefs=oC(r,!0),t.id=Yk(t),t})}function Kk(n){return gi(n)||zC(n)}function Qk(n){return n!==null}function sC(n,e){if(n==null)return Aa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=Or.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==Or.None?[r,a]:r,e[s]=o):t[s]=r}return t}function og(n){return Ul(()=>{let e=QC(n);return YC(e),e})}function gi(n){return n[vk]||null}function zC(n){return n[Ik]||null}function GC(n){return n[wk]||null}function WC(n){let e=gi(n)||zC(n)||GC(n);return e!==null?e.standalone:!1}function KC(n,e){let t=n[Ek]||null;if(!t&&e===!0)throw new Error(`Type ${qt(n)} does not have '\u0275mod' property.`);return t}function QC(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Aa,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||As,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:sC(n.inputs,e),outputs:sC(n.outputs),debugInfo:null}}function YC(n){n.features?.forEach(e=>e(n))}function oC(n,e){if(!n)return null;let t=e?GC:Kk;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Qk)}function Yk(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Me(n){return{\u0275providers:n}}function Zk(...n){return{\u0275providers:ZC(!0,n),\u0275fromNgModule:!0}}function ZC(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return rg(e,o=>{let a=o;Cp(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&JC(i,s),t}function JC(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];ag(i,s=>{e(s,r)})}}function Cp(n,e,t,r){if(n=Xt(n),!n)return!1;let i=null,s=XT(n),o=!s&&gi(n);if(!s&&!o){let c=n.ngModule;if(s=XT(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Cp(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{rg(s.imports,d=>{Cp(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&JC(l,e)}if(!a){let l=Ss(i)||(()=>new i);e({provide:i,useFactory:l,deps:As},i),e({provide:$C,useValue:i,multi:!0},i),e({provide:Rs,useValue:()=>Y(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;ag(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function ag(n,e){for(let t of n)FC(t)&&(t=t.\u0275providers),Array.isArray(t)?ag(t,e):e(t)}var Jk=Re({provide:String,useValue:Re});function XC(n){return n!==null&&typeof n=="object"&&Jk in n}function Xk(n){return!!(n&&n.useExisting)}function eO(n){return!!(n&&n.useFactory)}function bp(n){return typeof n=="function"}var $l=new j(""),fl={},tO={},hp;function cg(){return hp===void 0&&(hp=new wl),hp}var tn=class{},Ra=class extends tn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Sp(e,o=>this.processProvider(o)),this.records.set(BC,Es(void 0,this)),i.has("environment")&&this.records.set(tn,Es(void 0,this));let s=this.records.get($l);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get($C,As,ue.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ye(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ye(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=xr(this),r=Jt(void 0),i;try{return e()}finally{xr(t),Jt(r)}}get(e,t=Sa,r=ue.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(tC))return e[tC](this);r=Bl(r);let i,s=xr(this),o=Jt(void 0);try{if(!(r&ue.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=aO(e)&&jl(e);l&&this.injectableDefInScope(l)?c=Es(Dp(e),fl):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ue.Self?cg():this.parent;return t=r&ue.Optional&&t===Sa?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[vl]=a[vl]||[]).unshift(qt(e)),s)throw a;return xk(a,e,"R3InjectorError",this.source)}else throw a}finally{Jt(o),xr(s)}}resolveInjectorInitializers(){let e=ye(null),t=xr(this),r=Jt(void 0),i;try{let s=this.get(Rs,As,ue.Self);for(let o of s)o()}finally{xr(t),Jt(r),ye(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(qt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new J(205,!1)}processProvider(e){e=Xt(e);let t=bp(e)?e:Xt(e&&e.provide),r=rO(e);if(!bp(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Es(void 0,fl,!0),i.factory=()=>Ep(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ye(null);try{return t.value===fl&&(t.value=tO,t.value=t.factory()),typeof t.value=="object"&&t.value&&oO(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ye(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Xt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Dp(n){let e=jl(n),t=e!==null?e.factory:Ss(n);if(t!==null)return t;if(n instanceof j)throw new J(204,!1);if(n instanceof Function)return nO(n);throw new J(204,!1)}function nO(n){if(n.length>0)throw new J(204,!1);let t=_k(n);return t!==null?()=>t.factory(n):()=>new n}function rO(n){if(XC(n))return Es(void 0,n.useValue);{let e=iO(n);return Es(e,fl)}}function iO(n,e,t){let r;if(bp(n)){let i=Xt(n);return Ss(i)||Dp(i)}else if(XC(n))r=()=>Xt(n.useValue);else if(eO(n))r=()=>n.useFactory(...Ep(n.deps||[]));else if(Xk(n))r=()=>Y(Xt(n.useExisting));else{let i=Xt(n&&(n.useClass||n.provide));if(sO(n))r=()=>new i(...Ep(n.deps));else return Ss(i)||Dp(i)}return r}function Es(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function sO(n){return!!n.deps}function oO(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function aO(n){return typeof n=="function"||typeof n=="object"&&n instanceof j}function Sp(n,e){for(let t of n)Array.isArray(t)?Sp(t,e):t&&FC(t)?Sp(t.\u0275providers,e):e(t)}function nr(n,e){n instanceof Ra&&n.assertNotDestroyed();let t,r=xr(n),i=Jt(void 0);try{return e()}finally{xr(r),Jt(i)}}function cO(){return VC()!==void 0||Rk()!=null}function uO(n){return typeof n=="function"}var rr=0,de=1,ie=2,Pt=3,hn=4,fn=5,El=6,Tl=7,nn=8,Ns=9,er=10,Gt=11,Na=12,aC=13,Ls=14,Mn=15,Ps=16,Ts=17,Ms=18,Hl=19,eb=20,kr=21,fp=22,en=23,xn=25,tb=1;var mi=7,Cl=8,bl=9,zt=10,Dl=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Dl||{});function fi(n){return Array.isArray(n)&&typeof n[tb]=="object"}function ir(n){return Array.isArray(n)&&n[tb]===!0}function nb(n){return(n.flags&4)!==0}function ug(n){return n.componentOffset>-1}function lg(n){return(n.flags&1)===1}function Oa(n){return!!n.template}function Ap(n){return(n[ie]&512)!==0}var Rp=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function rb(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function ql(){return ib}function ib(n){return n.type.prototype.ngOnChanges&&(n.setInput=dO),lO}ql.ngInherit=!0;function lO(){let n=ob(this),e=n?.current;if(e){let t=n.previous;if(t===Aa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function dO(n,e,t,r,i){let s=this.declaredInputs[r],o=ob(n)||hO(n,{previous:Aa,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Rp(l&&l.currentValue,t,c===Aa),rb(n,e,i,t)}var sb="__ngSimpleChanges__";function ob(n){return n[sb]||null}function hO(n,e){return n[sb]=e}var cC=null;var Rn=function(n,e,t){cC?.(n,e,t)},fO="svg",pO="math";function kn(n){for(;Array.isArray(n);)n=n[rr];return n}function gO(n,e){return kn(e[n])}function On(n,e){return kn(e[n.index])}function ab(n,e){return n.data[e]}function Vs(n,e){let t=e[n];return fi(t)?t:t[rr]}function dg(n){return(n[ie]&128)===128}function mO(n){return ir(n[Pt])}function Sl(n,e){return e==null?null:n[e]}function cb(n){n[Ts]=0}function ub(n){n[ie]&1024||(n[ie]|=1024,dg(n)&&Gl(n))}function _O(n,e){for(;n>0;)e=e[Ls],n--;return e}function zl(n){return!!(n[ie]&9216||n[en]?.dirty)}function Np(n){n[er].changeDetectionScheduler?.notify(8),n[ie]&64&&(n[ie]|=1024),zl(n)&&Gl(n)}function Gl(n){n[er].changeDetectionScheduler?.notify(0);let e=_i(n);for(;e!==null&&!(e[ie]&8192||(e[ie]|=8192,!dg(e)));)e=_i(e)}function lb(n,e){if((n[ie]&256)===256)throw new J(911,!1);n[kr]===null&&(n[kr]=[]),n[kr].push(e)}function yO(n,e){if(n[kr]===null)return;let t=n[kr].indexOf(e);t!==-1&&n[kr].splice(t,1)}function _i(n){let e=n[Pt];return ir(e)?e[Pt]:e}var ve={lFrame:Eb(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var db=!1;function vO(){return ve.lFrame.elementDepthCount}function IO(){ve.lFrame.elementDepthCount++}function wO(){ve.lFrame.elementDepthCount--}function hb(){return ve.bindingsEnabled}function EO(){return ve.skipHydrationRootTNode!==null}function TO(n){return ve.skipHydrationRootTNode===n}function CO(){ve.skipHydrationRootTNode=null}function ht(){return ve.lFrame.lView}function Us(){return ve.lFrame.tView}function fb(n){return ve.lFrame.contextLView=n,n[nn]}function pb(n){return ve.lFrame.contextLView=null,n}function Fn(){let n=gb();for(;n!==null&&n.type===64;)n=n.parent;return n}function gb(){return ve.lFrame.currentTNode}function bO(){let n=ve.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Fa(n,e){let t=ve.lFrame;t.currentTNode=n,t.isParent=e}function mb(){return ve.lFrame.isParent}function DO(){ve.lFrame.isParent=!1}function _b(){return db}function uC(n){db=n}function SO(n){return ve.lFrame.bindingIndex=n}function yb(){return ve.lFrame.bindingIndex++}function AO(){return ve.lFrame.inI18n}function RO(n,e){let t=ve.lFrame;t.bindingIndex=t.bindingRootIndex=n,Pp(e)}function NO(){return ve.lFrame.currentDirectiveIndex}function Pp(n){ve.lFrame.currentDirectiveIndex=n}function vb(n){ve.lFrame.currentQueryIndex=n}function PO(n){let e=n[de];return e.type===2?e.declTNode:e.type===1?n[fn]:null}function Ib(n,e,t){if(t&ue.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ue.Host);)if(i=PO(s),i===null||(s=s[Ls],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=ve.lFrame=wb();return r.currentTNode=e,r.lView=n,!0}function hg(n){let e=wb(),t=n[de];ve.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function wb(){let n=ve.lFrame,e=n===null?null:n.child;return e===null?Eb(n):e}function Eb(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Tb(){let n=ve.lFrame;return ve.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Cb=Tb;function fg(){let n=Tb();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function MO(n){return(ve.lFrame.contextLView=_O(n,ve.lFrame.contextLView))[nn]}function pg(){return ve.lFrame.selectedIndex}function yi(n){ve.lFrame.selectedIndex=n}function xO(){return ve.lFrame.currentNamespace}var bb=!0;function gg(){return bb}function mg(n){bb=n}function kO(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=ib(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function _g(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function pl(n,e,t){Db(n,e,3,t)}function gl(n,e,t,r){(n[ie]&3)===t&&Db(n,e,t,r)}function pp(n,e){let t=n[ie];(t&3)===e&&(t&=16383,t+=1,n[ie]=t)}function Db(n,e,t,r){let i=r!==void 0?n[Ts]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ts]+=65536),(a<s||s==-1)&&(OO(n,t,e,c),n[Ts]=(n[Ts]&4294901760)+c+2),c++}function lC(n,e){Rn(4,n,e);let t=ye(null);try{e.call(n)}finally{ye(t),Rn(5,n,e)}}function OO(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[ie]>>14<n[Ts]>>16&&(n[ie]&3)===e&&(n[ie]+=16384,lC(a,s)):lC(a,s)}var Ds=-1,Pa=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function FO(n){return n instanceof Pa}function LO(n){return(n.flags&8)!==0}function VO(n){return(n.flags&16)!==0}var gp={},Mp=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Bl(r);let i=this.injector.get(e,gp,r);return i!==gp||t===gp?i:this.parentInjector.get(e,t,r)}};function Sb(n){return n!==Ds}function Al(n){return n&32767}function UO(n){return n>>16}function Rl(n,e){let t=UO(n),r=e;for(;t>0;)r=r[Ls],t--;return r}var xp=!0;function dC(n){let e=xp;return xp=n,e}var jO=256,Ab=jO-1,Rb=5,BO=0,Nn={};function $O(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Da)&&(r=t[Da]),r==null&&(r=t[Da]=BO++);let i=r&Ab,s=1<<i;e.data[n+(i>>Rb)]|=s}function Nb(n,e){let t=Pb(n,e);if(t!==-1)return t;let r=e[de];r.firstCreatePass&&(n.injectorIndex=e.length,mp(r.data,n),mp(e,null),mp(r.blueprint,null));let i=yg(n,e),s=n.injectorIndex;if(Sb(i)){let o=Al(i),a=Rl(i,e),c=a[de].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function mp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Pb(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function yg(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Fb(i),r===null)return Ds;if(t++,i=i[Ls],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ds}function HO(n,e,t){$O(n,e,t)}function Mb(n,e,t){if(t&ue.Optional||n!==void 0)return n;ng(e,"NodeInjector")}function xb(n,e,t,r){if(t&ue.Optional&&r===void 0&&(r=null),!(t&(ue.Self|ue.Host))){let i=n[Ns],s=Jt(void 0);try{return i?i.get(e,r,t&ue.Optional):UC(e,r,t&ue.Optional)}finally{Jt(s)}}return Mb(r,e,t)}function kb(n,e,t,r=ue.Default,i){if(n!==null){if(e[ie]&2048&&!(r&ue.Self)){let o=KO(n,e,t,r,Nn);if(o!==Nn)return o}let s=Ob(n,e,t,r,Nn);if(s!==Nn)return s}return xb(e,t,r,i)}function Ob(n,e,t,r,i){let s=GO(t);if(typeof s=="function"){if(!Ib(e,n,r))return r&ue.Host?Mb(i,t,r):xb(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ue.Optional))ng(t);else return o}finally{Cb()}}else if(typeof s=="number"){let o=null,a=Pb(n,e),c=Ds,l=r&ue.Host?e[Mn][fn]:null;for((a===-1||r&ue.SkipSelf)&&(c=a===-1?yg(n,e):e[a+8],c===Ds||!fC(r,!1)?a=-1:(o=e[de],a=Al(c),e=Rl(c,e)));a!==-1;){let d=e[de];if(hC(s,a,d.data)){let p=qO(a,e,t,o,r,l);if(p!==Nn)return p}c=e[a+8],c!==Ds&&fC(r,e[de].data[a+8]===l)&&hC(s,a,e)?(o=d,a=Al(c),e=Rl(c,e)):a=-1}}return i}function qO(n,e,t,r,i,s){let o=e[de],a=o.data[n+8],c=r==null?ug(a)&&xp:r!=o&&(a.type&3)!==0,l=i&ue.Host&&s===a,d=zO(a,o,t,c,l);return d!==null?Ma(e,o,d,a):Nn}function zO(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,p=r?a:a+d,g=i?a+d:l;for(let _=p;_<g;_++){let E=o[_];if(_<c&&t===E||_>=c&&E.type===t)return _}if(i){let _=o[c];if(_&&Oa(_)&&_.type===t)return c}return null}function Ma(n,e,t,r){let i=n[t],s=e.data;if(FO(i)){let o=i;o.resolving&&Ck(Tk(s[t]));let a=dC(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Jt(o.injectImpl):null,d=Ib(n,r,ue.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&kO(t,s[t],e)}finally{l!==null&&Jt(l),dC(a),o.resolving=!1,Cb()}}return i}function GO(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Da)?n[Da]:void 0;return typeof e=="number"?e>=0?e&Ab:WO:e}function hC(n,e,t){let r=1<<n;return!!(t[e+(n>>Rb)]&r)}function fC(n,e){return!(n&ue.Self)&&!(n&ue.Host&&e)}var pi=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return kb(this._tNode,this._lView,e,Bl(r),t)}};function WO(){return new pi(Fn(),ht())}function vg(n){return Ul(()=>{let e=n.prototype.constructor,t=e[yl]||kp(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[yl]||kp(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function kp(n){return MC(n)?()=>{let e=kp(Xt(n));return e&&e()}:Ss(n)}function KO(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[ie]&2048&&!(o[ie]&512);){let a=Ob(s,o,t,r|ue.Self,Nn);if(a!==Nn)return a;let c=s.parent;if(!c){let l=o[eb];if(l){let d=l.get(t,Nn,r);if(d!==Nn)return d}c=Fb(o),o=o[Ls]}s=c}return i}function Fb(n){let e=n[de],t=e.type;return t===2?e.declTNode:t===1?n[fn]:null}function pC(n,e=null,t=null,r){let i=Lb(n,e,t,r);return i.resolveInjectorInitializers(),i}function Lb(n,e=null,t=null,r,i=new Set){let s=[t||As,Zk(n)];return r=r||(typeof n=="object"?void 0:qt(n)),new Ra(s,e||cg(),r||null,i)}var Ee=class n{static{this.THROW_IF_NOT_FOUND=Sa}static{this.NULL=new wl}static create(e,t){if(Array.isArray(e))return pC({name:""},t,e,"");{let r=e.name??"";return pC({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=H({token:n,providedIn:"any",factory:()=>Y(BC)})}static{this.__NG_ELEMENT_ID__=-1}};var QO=new j("");QO.__NG_ELEMENT_ID__=n=>{let e=Fn();if(e===null)throw new J(204,!1);if(e.type&2)return e.value;if(n&ue.Optional)return null;throw new J(204,!1)};var YO="ngOriginalError";function _p(n){return n[YO]}var Vb=!0,Ub=(()=>{class n{static{this.__NG_ELEMENT_ID__=ZO}static{this.__NG_ENV_ID__=t=>t}}return n})(),Op=class extends Ub{constructor(e){super(),this._lView=e}onDestroy(e){return lb(this._lView,e),()=>yO(this._lView,e)}};function ZO(){return new Op(ht())}var js=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new dt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}}return n})();var Fp=class extends it{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,cO()&&(this.destroyRef=O(Ub,{optional:!0})??void 0,this.pendingTasks=O(js,{optional:!0})??void 0)}emit(e){let t=ye(null);try{super.next(e)}finally{ye(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof $e&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Nt=Fp;function Nl(...n){}function jb(n){let e,t;function r(){n=Nl;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function gC(n){return queueMicrotask(()=>n()),()=>{n=Nl}}var Ig="isAngularZone",Pl=Ig+"_ID",JO=0,Q=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Nt(!1),this.onMicrotaskEmpty=new Nt(!1),this.onStable=new Nt(!1),this.onError=new Nt(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=Vb}=e;if(typeof Zone>"u")throw new J(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,t1(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Ig)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new J(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new J(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,XO,Nl,Nl);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},XO={};function wg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function e1(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){jb(()=>{n.callbackScheduled=!1,Lp(n),n.isCheckStableRunning=!0,wg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Lp(n)}function t1(n){let e=()=>{e1(n)},t=JO++;n._inner=n._inner.fork({name:"angular",properties:{[Ig]:!0,[Pl]:t,[Pl+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(n1(c))return r.invokeTask(s,o,a,c);try{return mC(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),_C(n)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return mC(n),r.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!r1(c)&&e(),_C(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Lp(n),wg(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Lp(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function mC(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function _C(n){n._nesting--,wg(n)}var Vp=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Nt,this.onMicrotaskEmpty=new Nt,this.onStable=new Nt,this.onError=new Nt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function n1(n){return Bb(n,"__ignore_ng_zone__")}function r1(n){return Bb(n,"__scheduler_tick__")}function Bb(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var tr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&_p(e);for(;t&&_p(t);)t=_p(t);return t||null}},i1=new j("",{providedIn:"root",factory:()=>{let n=O(Q),e=O(tr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function s1(){return Eg(Fn(),ht())}function Eg(n,e){return new Wl(On(n,e))}var Wl=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=s1}}return n})();function $b(n){return(n.flags&128)===128}var Hb=new Map,o1=0;function a1(){return o1++}function c1(n){Hb.set(n[Hl],n)}function Up(n){Hb.delete(n[Hl])}var yC="__ngContext__";function vi(n,e){fi(e)?(n[yC]=e[Hl],c1(e)):n[yC]=e}function qb(n){return Gb(n[Na])}function zb(n){return Gb(n[hn])}function Gb(n){for(;n!==null&&!ir(n);)n=n[hn];return n}var jp;function Wb(n){jp=n}function u1(){if(jp!==void 0)return jp;if(typeof document<"u")return document;throw new J(210,!1)}var Tg=new j("",{providedIn:"root",factory:()=>l1}),l1="ng",Cg=new j(""),pn=new j("",{providedIn:"platform",factory:()=>"unknown"});var bg=new j("",{providedIn:"root",factory:()=>u1().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var d1="h",h1="b";var f1=()=>null;function Dg(n,e,t=!1){return f1(n,e,t)}var Kb=!1,p1=new j("",{providedIn:"root",factory:()=>Kb});function Qb(n){return n instanceof Function?n():n}var Ii=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Ii||{}),g1;function Sg(n,e){return g1(n,e)}function Cs(n,e,t,r,i){if(r!=null){let s,o=!1;ir(r)?s=r:fi(r)&&(o=!0,r=r[rr]);let a=kn(r);n===0&&t!==null?i==null?Xb(e,t,a):xl(e,t,a,i||null,!0):n===1&&t!==null?xl(e,t,a,i||null,!0):n===2?N1(e,a,o):n===3&&e.destroyNode(a),s!=null&&M1(e,n,s,t,i)}}function m1(n,e){return n.createText(e)}function _1(n,e,t){n.setValue(e,t)}function Yb(n,e,t){return n.createElement(e,t)}function y1(n,e){Zb(n,e),e[rr]=null,e[fn]=null}function v1(n,e,t,r,i,s){r[rr]=i,r[fn]=e,Kl(n,r,t,1,i,s)}function Zb(n,e){e[er].changeDetectionScheduler?.notify(9),Kl(n,e,e[Gt],2,null,null)}function I1(n){let e=n[Na];if(!e)return yp(n[de],n);for(;e;){let t=null;if(fi(e))t=e[Na];else{let r=e[zt];r&&(t=r)}if(!t){for(;e&&!e[hn]&&e!==n;)fi(e)&&yp(e[de],e),e=e[Pt];e===null&&(e=n),fi(e)&&yp(e[de],e),t=e&&e[hn]}e=t}}function w1(n,e,t,r){let i=zt+r,s=t.length;r>0&&(t[i-1][hn]=e),r<s-zt?(e[hn]=t[i],jC(t,zt+r,e)):(t.push(e),e[hn]=null),e[Pt]=t;let o=e[Ps];o!==null&&t!==o&&Jb(o,e);let a=e[Ms];a!==null&&a.insertView(n),Np(e),e[ie]|=128}function Jb(n,e){let t=n[bl],r=e[Pt];if(fi(r))n[ie]|=Dl.HasTransplantedViews;else{let i=r[Pt][Mn];e[Mn]!==i&&(n[ie]|=Dl.HasTransplantedViews)}t===null?n[bl]=[e]:t.push(e)}function Ag(n,e){let t=n[bl],r=t.indexOf(e);t.splice(r,1)}function Ml(n,e){if(n.length<=zt)return;let t=zt+e,r=n[t];if(r){let i=r[Ps];i!==null&&i!==n&&Ag(i,r),e>0&&(n[t-1][hn]=r[hn]);let s=Il(n,zt+e);y1(r[de],r);let o=s[Ms];o!==null&&o.detachView(s[de]),r[Pt]=null,r[hn]=null,r[ie]&=-129}return r}function Rg(n,e){if(!(e[ie]&256)){let t=e[Gt];t.destroyNode&&Kl(n,e,t,3,null,null),I1(e)}}function yp(n,e){if(e[ie]&256)return;let t=ye(null);try{e[ie]&=-129,e[ie]|=256,e[en]&&Kf(e[en]),T1(n,e),E1(n,e),e[de].type===1&&e[Gt].destroy();let r=e[Ps];if(r!==null&&ir(e[Pt])){r!==e[Pt]&&Ag(r,e);let i=e[Ms];i!==null&&i.detachView(n)}Up(e)}finally{ye(t)}}function E1(n,e){let t=n.cleanup,r=e[Tl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Tl]=null);let i=e[kr];if(i!==null){e[kr]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function T1(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Pa)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Rn(4,a,c);try{c.call(a)}finally{Rn(5,a,c)}}else{Rn(4,i,s);try{s.call(i)}finally{Rn(5,i,s)}}}}}function C1(n,e,t){return b1(n,e.parent,t)}function b1(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[rr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Pn.None||s===Pn.Emulated)return null}return On(r,t)}}function xl(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Xb(n,e,t){n.appendChild(e,t)}function vC(n,e,t,r,i){r!==null?xl(n,e,t,r,i):Xb(n,e,t)}function eD(n,e){return n.parentNode(e)}function D1(n,e){return n.nextSibling(e)}function S1(n,e,t){return R1(n,e,t)}function A1(n,e,t){return n.type&40?On(n,t):null}var R1=A1,IC;function Ng(n,e,t,r){let i=C1(n,r,e),s=e[Gt],o=r.parent||e[fn],a=S1(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)vC(s,i,t[c],a,!1);else vC(s,i,t,a,!1);IC!==void 0&&IC(s,r,e,t,i)}function Ca(n,e){if(e!==null){let t=e.type;if(t&3)return On(e,n);if(t&4)return Bp(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Ca(n,r);{let i=n[e.index];return ir(i)?Bp(-1,i):kn(i)}}else{if(t&128)return Ca(n,e.next);if(t&32)return Sg(e,n)()||kn(n[e.index]);{let r=tD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=_i(n[Mn]);return Ca(i,r)}else return Ca(n,e.next)}}}return null}function tD(n,e){if(e!==null){let r=n[Mn][fn],i=e.projection;return r.projection[i]}return null}function Bp(n,e){let t=zt+n+1;if(t<e.length){let r=e[t],i=r[de].firstChild;if(i!==null)return Ca(r,i)}return e[mi]}function N1(n,e,t){n.removeChild(null,e,t)}function Pg(n,e,t,r,i,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(o&&e===0&&(a&&vi(kn(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)Pg(n,e,t.child,r,i,s,!1),Cs(e,n,i,a,s);else if(c&32){let l=Sg(t,r),d;for(;d=l();)Cs(e,n,i,d,s);Cs(e,n,i,a,s)}else c&16?P1(n,e,r,t,i,s):Cs(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Kl(n,e,t,r,i,s){Pg(t,r,n.firstChild,e,i,s,!1)}function P1(n,e,t,r,i,s){let o=t[Mn],c=o[fn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];Cs(e,n,i,d,s)}else{let l=c,d=o[Pt];$b(r)&&(l.flags|=128),Pg(n,e,l,d,i,s,!0)}}function M1(n,e,t,r,i){let s=t[mi],o=kn(t);s!==o&&Cs(e,n,r,s,i);for(let a=zt;a<t.length;a++){let c=t[a];Kl(c[de],c,n,e,r,s)}}function x1(n,e,t){n.setAttribute(e,"style",t)}function nD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function rD(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Tp(n,e,r),i!==null&&nD(n,e,i),s!==null&&x1(n,e,s)}var La={};function Mg(n=1){iD(Us(),ht(),pg()+n,!1)}function iD(n,e,t,r){if(!r)if((e[ie]&3)===3){let s=n.preOrderCheckHooks;s!==null&&pl(e,s,t)}else{let s=n.preOrderHooks;s!==null&&gl(e,s,0,t)}yi(t)}function xg(n,e=ue.Default){let t=ht();if(t===null)return Y(n,e);let r=Fn();return kb(r,t,Xt(n),e)}function sD(n,e,t,r,i,s){let o=ye(null);try{let a=null;i&Or.SignalBased&&(a=e[r][os]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Or.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):rb(e,a,r,s)}finally{ye(o)}}function k1(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)yi(~i);else{let s=i,o=t[++r],a=t[++r];RO(o,s);let c=e[s];a(2,c)}}}finally{yi(-1)}}function Ql(n,e,t,r,i,s,o,a,c,l,d){let p=e.blueprint.slice();return p[rr]=i,p[ie]=r|4|128|8|64,(l!==null||n&&n[ie]&2048)&&(p[ie]|=2048),cb(p),p[Pt]=p[Ls]=n,p[nn]=t,p[er]=o||n&&n[er],p[Gt]=a||n&&n[Gt],p[Ns]=c||n&&n[Ns]||null,p[fn]=s,p[Hl]=a1(),p[El]=d,p[eb]=l,p[Mn]=e.type==2?n[Mn]:p,p}function Yl(n,e,t,r,i){let s=n.data[e];if(s===null)s=O1(n,e,t,r,i),AO()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=bO();s.injectorIndex=o===null?-1:o.injectorIndex}return Fa(s,!0),s}function O1(n,e,t,r,i){let s=gb(),o=mb(),a=o?s:s&&s.parent,c=n.data[e]=j1(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function oD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function aD(n,e,t,r,i){let s=pg(),o=r&2;try{yi(-1),o&&e.length>xn&&iD(n,e,xn,!1),Rn(o?2:0,i),t(r,i)}finally{yi(s),Rn(o?3:1,i)}}function cD(n,e,t){if(nb(e)){let r=ye(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{ye(r)}}}function uD(n,e,t){hb()&&(q1(n,e,t,On(t,e)),(t.flags&64)===64&&pD(n,e,t))}function lD(n,e,t=On){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function dD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=kg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function kg(n,e,t,r,i,s,o,a,c,l,d){let p=xn+r,g=p+i,_=F1(p,g),E=typeof l=="function"?l():l;return _[de]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function F1(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:La);return t}function L1(n,e,t,r){let s=r.get(p1,Kb)||t===Pn.ShadowDom,o=n.selectRootElement(e,s);return V1(o),o}function V1(n){U1(n)}var U1=()=>null;function j1(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return EO()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function wC(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Or.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?EC(r,t,l,a,c):EC(r,t,l,a)}return r}function EC(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function B1(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let p=s[d],g=t?t.get(p):null,_=g?g.inputs:null,E=g?g.outputs:null;c=wC(0,p.inputs,d,c,_),l=wC(1,p.outputs,d,l,E);let N=c!==null&&o!==null&&!sg(e)?X1(c,d,o):null;a.push(N)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function hD(n,e,t,r){if(hb()){let i=r===null?null:{"":-1},s=G1(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&fD(n,e,t,o,i,a),i&&W1(t,r,i)}t.mergedAttrs=ig(t.mergedAttrs,t.attrs)}function fD(n,e,t,r,i,s){for(let l=0;l<r.length;l++)HO(Nb(t,e),n,r[l].type);Q1(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=oD(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=ig(t.mergedAttrs,d.hostAttrs),Y1(n,t,e,c,d),K1(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let p=d.type.prototype;!o&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}B1(n,t,s)}function $1(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;H1(o)!=a&&o.push(a),o.push(t,r,s)}}function H1(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function q1(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;ug(t)&&Z1(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Nb(t,e),vi(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=Ma(e,n,a,t);if(vi(l,e),o!==null&&J1(e,a-i,l,c,t,o),Oa(c)){let d=Vs(t.index,e);d[nn]=Ma(e,n,a,t)}}}function pD(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=NO();try{yi(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];Pp(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&z1(c,l)}}finally{yi(-1),Pp(o)}}function z1(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function G1(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if($k(e,o.selectors,!1))if(r||(r=[]),Oa(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;$p(n,e,c)}else r.unshift(o),$p(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function $p(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function W1(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new J(-301,!1);r.push(e[i],s)}}}function K1(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Oa(e)&&(t[""]=n)}}function Q1(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Y1(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Ss(i.type,!0)),o=new Pa(s,Oa(i),xg);n.blueprint[r]=o,t[r]=o,$1(n,e,r,oD(n,t,i.hostVars,La),i)}function Z1(n,e,t){let r=On(e,n),i=dD(t),s=n[er].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=Zl(n,Ql(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function J1(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],p=o[a++];sD(r,t,c,l,d,p)}}function X1(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function gD(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function mD(n,e){let t=n.contentQueries;if(t!==null){let r=ye(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];vb(s),a.contentQueries(2,e[o],o)}}}finally{ye(r)}}}function Zl(n,e){return n[Na]?n[aC][hn]=e:n[Na]=e,n[aC]=e,e}function Hp(n,e,t){vb(0);let r=ye(null);try{e(n,t)}finally{ye(r)}}function eF(n){return n[Tl]??=[]}function tF(n){return n.cleanup??=[]}function _D(n,e){let t=n[Ns],r=t?t.get(tr,null):null;r&&r.handleError(e)}function yD(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];sD(d,l,r,a,c,i)}}function nF(n,e,t){let r=gO(e,n);_1(n[Gt],r,t)}function rF(n,e){let t=Vs(e,n),r=t[de];iF(r,t);let i=t[rr];i!==null&&t[El]===null&&(t[El]=Dg(i,t[Ns])),Og(r,t,t[nn])}function iF(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Og(n,e,t){hg(e);try{let r=n.viewQuery;r!==null&&Hp(1,r,t);let i=n.template;i!==null&&aD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ms]?.finishViewCreation(n),n.staticContentQueries&&mD(n,e),n.staticViewQueries&&Hp(2,n.viewQuery,t);let s=n.components;s!==null&&sF(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ie]&=-5,fg()}}function sF(n,e){for(let t=0;t<e.length;t++)rF(n,e[t])}function oF(n,e,t,r){let i=ye(null);try{let s=e.tView,a=n[ie]&4096?4096:16,c=Ql(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Ps]=l;let d=n[Ms];return d!==null&&(c[Ms]=d.createEmbeddedView(s)),Og(s,c,t),c}finally{ye(i)}}function aF(n,e){let t=zt+e;if(t<n.length)return n[t]}function qp(n,e){return!e||e.firstChild===null||$b(n)}function vD(n,e,t,r=!0){let i=e[de];if(w1(i,e,n,t),r){let o=Bp(t,n),a=e[Gt],c=eD(a,n[mi]);c!==null&&v1(i,n[fn],a,e,c,o)}let s=e[El];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function cF(n,e){let t=Ml(n,e);return t!==void 0&&Rg(t[de],t),t}function kl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(kn(s)),ir(s)&&uF(s,r);let o=t.type;if(o&8)kl(n,e,t.child,r);else if(o&32){let a=Sg(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=tD(e,t);if(Array.isArray(a))r.push(...a);else{let c=_i(e[Mn]);kl(c[de],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function uF(n,e){for(let t=zt;t<n.length;t++){let r=n[t],i=r[de].firstChild;i!==null&&kl(r[de],r,i,e)}n[mi]!==n[rr]&&e.push(n[mi])}var ID=[];function lF(n){return n[en]??dF(n)}function dF(n){let e=ID.pop()??Object.create(fF);return e.lView=n,e}function hF(n){n.lView[en]!==n&&(n.lView=null,ID.push(n))}var fF=Pe(U({},Lu),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Gl(n.lView)},consumerOnSignalRead(){this.lView[en]=this}});function pF(n){let e=n[en]??Object.create(gF);return e.lView=n,e}var gF=Pe(U({},Lu),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=_i(n.lView);for(;e&&!wD(e[de]);)e=_i(e);e&&ub(e)},consumerOnSignalRead(){this.lView[en]=this}});function wD(n){return n.type!==2}var mF=100;function ED(n,e=!0,t=0){let r=n[er],i=r.rendererFactory,s=!1;s||i.begin?.();try{_F(n,t)}catch(o){throw e&&_D(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function _F(n,e){let t=_b();try{uC(!0),zp(n,e);let r=0;for(;zl(n);){if(r===mF)throw new J(103,!1);r++,zp(n,1)}}finally{uC(t)}}function yF(n,e,t,r){let i=e[ie];if((i&256)===256)return;let s=!1,o=!1;!s&&e[er].inlineEffectRunner?.flush(),hg(e);let a=!0,c=null,l=null;s||(wD(n)?(l=lF(e),c=Gf(l)):uT()===null?(a=!1,l=pF(e),c=Gf(l)):e[en]&&(Kf(e[en]),e[en]=null));try{cb(e),SO(n.bindingStartIndex),t!==null&&aD(n,e,t,2,r);let d=(i&3)===3;if(!s)if(d){let _=n.preOrderCheckHooks;_!==null&&pl(e,_,null)}else{let _=n.preOrderHooks;_!==null&&gl(e,_,0,null),pp(e,0)}if(o||vF(e),TD(e,0),n.contentQueries!==null&&mD(n,e),!s)if(d){let _=n.contentCheckHooks;_!==null&&pl(e,_)}else{let _=n.contentHooks;_!==null&&gl(e,_,1),pp(e,1)}k1(n,e);let p=n.components;p!==null&&bD(e,p,0);let g=n.viewQuery;if(g!==null&&Hp(2,g,r),!s)if(d){let _=n.viewCheckHooks;_!==null&&pl(e,_)}else{let _=n.viewHooks;_!==null&&gl(e,_,2),pp(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[fp]){for(let _ of e[fp])_();e[fp]=null}s||(e[ie]&=-73)}catch(d){throw s||Gl(e),d}finally{l!==null&&(fT(l,c),a&&hF(l)),fg()}}function TD(n,e){for(let t=qb(n);t!==null;t=zb(t))for(let r=zt;r<t.length;r++){let i=t[r];CD(i,e)}}function vF(n){for(let e=qb(n);e!==null;e=zb(e)){if(!(e[ie]&Dl.HasTransplantedViews))continue;let t=e[bl];for(let r=0;r<t.length;r++){let i=t[r];ub(i)}}}function IF(n,e,t){let r=Vs(e,n);CD(r,t)}function CD(n,e){dg(n)&&zp(n,e)}function zp(n,e){let r=n[de],i=n[ie],s=n[en],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Wf(s)),o||=!1,s&&(s.dirty=!1),n[ie]&=-9217,o)yF(r,n,r.template,n[nn]);else if(i&8192){TD(n,1);let a=r.components;a!==null&&bD(n,a,1)}}function bD(n,e,t){for(let r=0;r<e.length;r++)IF(n,e[r],t)}function Fg(n,e){let t=_b()?64:1088;for(n[er].changeDetectionScheduler?.notify(e);n;){n[ie]|=t;let r=_i(n);if(Ap(n)&&!r)return n;n=r}return null}var xs=class{get rootNodes(){let e=this._lView,t=e[de];return kl(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[nn]}set context(e){this._lView[nn]=e}get destroyed(){return(this._lView[ie]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Pt];if(ir(e)){let t=e[Cl],r=t?t.indexOf(this):-1;r>-1&&(Ml(e,r),Il(t,r))}this._attachedToViewContainer=!1}Rg(this._lView[de],this._lView)}onDestroy(e){lb(this._lView,e)}markForCheck(){Fg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ie]&=-129}reattach(){Np(this._lView),this._lView[ie]|=128}detectChanges(){this._lView[ie]|=1024,ED(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new J(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Ap(this._lView),t=this._lView[Ps];t!==null&&!e&&Ag(t,this._lView),Zb(this._lView[de],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new J(902,!1);this._appRef=e;let t=Ap(this._lView),r=this._lView[Ps];r!==null&&!t&&Jb(r,this._lView),Np(this._lView)}};var dQ=new RegExp(`^(\\d+)*(${h1}|${d1})*(.*)`);var wF=()=>null;function Gp(n,e){return wF(n,e)}var ks=class{},Jl=new j("",{providedIn:"root",factory:()=>!1});var DD=new j(""),SD=new j(""),Wp=class{},Ol=class{};function EF(n){let e=Error(`No component factory found for ${qt(n)}.`);return e[TF]=n,e}var TF="ngComponent";var Kp=class{resolveComponentFactory(e){throw EF(e)}},Fr=class{static{this.NULL=new Kp}},Os=class{};var CF=(()=>{class n{static{this.\u0275prov=H({token:n,providedIn:"root",factory:()=>null})}}return n})();function Qp(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=ZT(i,a);else if(s==2){let c=a,l=e[++o];r=ZT(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Fl=class extends Fr{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=gi(e);return new xa(t,this.ngModule)}};function TC(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let s=Array.isArray(i),o=s?i[0]:i,a=s?i[1]:Or.None;e?t.push({propName:o,templateName:r,isSignal:(a&Or.SignalBased)!==0}):t.push({propName:o,templateName:r})}return t}function bF(n){let e=n.toLowerCase();return e==="svg"?fO:e==="math"?pO:null}var xa=class extends Ol{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=TC(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return TC(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Gk(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=ye(null);try{i=i||this.ngModule;let o=i instanceof tn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Mp(e,o):e,c=a.get(Os,null);if(c===null)throw new J(407,!1);let l=a.get(CF,null),d=a.get(ks,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:d},g=c.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",E=r?L1(g,r,this.componentDef.encapsulation,a):Yb(g,_,bF(_)),N=512;this.componentDef.signals?N|=4096:this.componentDef.onPush||(N|=16);let A=null;E!==null&&(A=Dg(E,a,!0));let M=kg(0,null,null,1,0,null,null,null,null,null,null),L=Ql(null,M,null,N,null,null,p,g,a,null,A);hg(L);let $,G,Se=null;try{let K=this.componentDef,T,v=null;K.findHostDirectiveDefs?(T=[],v=new Map,K.findHostDirectiveDefs(K,T,v),T.push(K)):T=[K];let I=DF(L,E);Se=SF(I,E,K,T,L,p,g),G=ab(M,xn),E&&NF(g,K,E,r),t!==void 0&&PF(G,this.ngContentSelectors,t),$=RF(Se,K,T,v,L,[MF]),Og(M,L,null)}catch(K){throw Se!==null&&Up(Se),Up(L),K}finally{fg()}return new Yp(this.componentType,$,Eg(G,L),L,G)}finally{ye(s)}}},Yp=class extends Wp{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new xs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;yD(s[de],s,i,e,t),this.previousInputValues.set(e,t);let o=Vs(this._tNode.index,s);Fg(o,1)}}get injector(){return new pi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function DF(n,e){let t=n[de],r=xn;return n[r]=e,Yl(t,r,2,"#host",null)}function SF(n,e,t,r,i,s,o){let a=i[de];AF(r,n,e,o);let c=null;e!==null&&(c=Dg(e,i[Ns]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let p=Ql(i,dD(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&$p(a,n,r.length-1),Zl(i,p),i[n.index]=p}function AF(n,e,t,r){for(let i of n)e.mergedAttrs=ig(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Qp(e,e.mergedAttrs,!0),t!==null&&rD(r,t,e))}function RF(n,e,t,r,i,s){let o=Fn(),a=i[de],c=On(o,i);fD(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let p=o.directiveStart+d,g=Ma(i,a,p,o);vi(g,i)}pD(a,i,o),c&&vi(c,i);let l=Ma(i,a,o.directiveStart+o.componentOffset,o);if(n[nn]=i[nn]=l,s!==null)for(let d of s)d(l,e);return cD(a,o,i),l}function NF(n,e,t,r){if(r)Tp(n,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:s}=Wk(e.selectors[0]);i&&Tp(n,t,i),s&&s.length>0&&nD(n,t,s.join(" "))}}function PF(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function MF(){let n=Fn();_g(ht()[de],n)}var Xl=(()=>{class n{static{this.__NG_ELEMENT_ID__=xF}}return n})();function xF(){let n=Fn();return OF(n,ht())}var kF=Xl,AD=class extends kF{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Eg(this._hostTNode,this._hostLView)}get injector(){return new pi(this._hostTNode,this._hostLView)}get parentInjector(){let e=yg(this._hostTNode,this._hostLView);if(Sb(e)){let t=Rl(e,this._hostLView),r=Al(e),i=t[de].data[r+8];return new pi(i,t)}else return new pi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=CC(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-zt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Gp(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,qp(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!uO(e),a;if(o)a=t;else{let E=t||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new xa(gi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let N=(o?l:this.parentInjector).get(tn,null);N&&(s=N)}let d=gi(c.componentType??{}),p=Gp(this._lContainer,d?.id??null),g=p?.firstChild??null,_=c.create(l,i,g,s);return this.insertImpl(_.hostView,a,qp(this._hostTNode,p)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(mO(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Pt],l=new AD(c,c[fn],c[Pt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return vD(o,i,s,r),e.attachToViewContainerRef(),jC(vp(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=CC(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Ml(this._lContainer,t);r&&(Il(vp(this._lContainer),t),Rg(r[de],r))}detach(e){let t=this._adjustIndex(e,-1),r=Ml(this._lContainer,t);return r&&Il(vp(this._lContainer),t)!=null?new xs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function CC(n){return n[Cl]}function vp(n){return n[Cl]||(n[Cl]=[])}function OF(n,e){let t,r=e[n.index];return ir(r)?t=r:(t=gD(r,e,null,n),e[n.index]=t,Zl(e,t)),LF(t,e,n,r),new AD(t,n,e)}function FF(n,e){let t=n[Gt],r=t.createComment(""),i=On(e,n),s=eD(t,i);return xl(t,s,r,D1(t,i),!1),r}var LF=jF,VF=()=>!1;function UF(n,e,t){return VF(n,e,t)}function jF(n,e,t,r){if(n[mi])return;let i;t.type&8?i=kn(r):i=FF(e,t),n[mi]=i}var bC=new Set;function Va(n){bC.has(n)||(bC.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function RD(n,e){Va("NgSignals");let t=IT(n),r=t[os];return e?.equal&&(r.equal=e.equal),t.set=i=>Qf(r,i),t.update=i=>wT(r,i),t.asReadonly=BF.bind(t),t}function BF(){let n=this[os];if(n.readonlyFn===void 0){let e=()=>this();e[os]=n,n.readonlyFn=e}return n.readonlyFn}var Lr=class{},ka=class{};var Zp=class extends Lr{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Fl(this);let s=KC(e);this._bootstrapComponents=Qb(s.bootstrap),this._r3Injector=Lb(e,t,[{provide:Lr,useValue:this},{provide:Fr,useValue:this.componentFactoryResolver},...r],qt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Jp=class extends ka{constructor(e){super(),this.moduleType=e}create(e){return new Zp(this.moduleType,e,[])}};var Ll=class extends Lr{constructor(e){super(),this.componentFactoryResolver=new Fl(this),this.instance=null;let t=new Ra([...e.providers,{provide:Lr,useValue:this},{provide:Fr,useValue:this.componentFactoryResolver}],e.parent||cg(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Lg(n,e,t=null){return new Ll({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function ND(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function $F(n){return(n.flags&32)===32}function HF(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Yl(e,n,4,o||null,a||null);hD(e,t,d,Sl(l,c)),_g(e,d);let p=d.tView=kg(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),p.queries=e.queries.embeddedTView(d)),d}function qF(n,e,t,r,i,s,o,a,c,l){let d=t+xn,p=e.firstCreatePass?HF(d,e,n,r,i,s,o,a,c):e.data[d];Fa(p,!1);let g=zF(e,n,p,t);gg()&&Ng(e,n,g,p),vi(g,n);let _=gD(g,n,g,p);return n[d]=_,Zl(n,_),UF(_,p,n),lg(p)&&uD(e,n,p),c!=null&&lD(n,p,l),p}function Vg(n,e,t,r,i,s,o,a){let c=ht(),l=Us(),d=Sl(l.consts,s);return qF(c,l,n,e,t,r,i,d,o,a),Vg}var zF=GF;function GF(n,e,t,r){return mg(!0),e[Gt].createComment("")}var ba=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(ba||{}),WF=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}}return n})(),DC=class n{constructor(){this.ngZone=O(Q),this.scheduler=O(ks),this.errorHandler=O(tr,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[ba.EarlyRead,ba.Write,ba.MixedReadWrite,ba.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}};function KF(n,e,t,r){return ND(n,yb(),t)?e+LC(t)+r:La}function SC(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";yD(n,t,s[o],o,r)}function PD(n,e){Va("NgControlFlow");let t=ht(),r=yb(),i=t[r]!==La?t[r]:-1,s=i!==-1?AC(t,xn+i):void 0,o=0;if(ND(t,r,n)){let a=ye(null);try{if(s!==void 0&&cF(s,o),n!==-1){let c=xn+n,l=AC(t,c),d=QF(t[de],c),p=Gp(l,d.tView.ssrId),g=oF(t,d,e,{dehydratedView:p});vD(l,g,o,qp(d,p))}}finally{ye(a)}}else if(s!==void 0){let a=aF(s,o);a!==void 0&&(a[nn]=e)}}function AC(n,e){return n[e]}function QF(n,e){return ab(n,e)}function YF(n,e,t,r,i,s){let o=e.consts,a=Sl(o,i),c=Yl(e,n,2,r,a);return hD(e,t,c,Sl(o,s)),c.attrs!==null&&Qp(c,c.attrs,!1),c.mergedAttrs!==null&&Qp(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function Ur(n,e,t,r){let i=ht(),s=Us(),o=xn+n,a=i[Gt],c=s.firstCreatePass?YF(o,s,i,e,t,r):s.data[o],l=ZF(s,i,c,a,e,n);i[o]=l;let d=lg(c);return Fa(c,!0),rD(a,l,c),!$F(c)&&gg()&&Ng(s,i,l,c),vO()===0&&vi(l,i),IO(),d&&(uD(s,i,c),cD(s,c,i)),r!==null&&lD(i,c),Ur}function jr(){let n=Fn();mb()?DO():(n=n.parent,Fa(n,!1));let e=n;TO(e)&&CO(),wO();let t=Us();return t.firstCreatePass&&(_g(t,n),nb(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&LO(e)&&SC(t,e,ht(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&VO(e)&&SC(t,e,ht(),e.stylesWithoutHost,!1),jr}function Bs(n,e,t,r){return Ur(n,e,t,r),jr(),Bs}var ZF=(n,e,t,r,i,s)=>(mg(!0),Yb(r,i,xO()));function MD(){return ht()}var Vl="en-US";var JF=Vl;function XF(n){typeof n=="string"&&(JF=n.toLowerCase().replace(/_/g,"-"))}var eL=(n,e,t)=>{};function ed(n,e,t,r){let i=ht(),s=Us(),o=Fn();return nL(s,i,i[Gt],o,n,e,r),ed}function tL(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Tl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function nL(n,e,t,r,i,s,o){let a=lg(r),l=n.firstCreatePass&&tF(n),d=e[nn],p=eF(e),g=!0;if(r.type&3||o){let N=On(r,e),A=o?o(N):N,M=p.length,L=o?G=>o(kn(G[r.index])):r.index,$=null;if(!o&&a&&($=tL(n,e,i,r.index)),$!==null){let G=$.__ngLastListenerFn__||$;G.__ngNextListenerFn__=s,$.__ngLastListenerFn__=s,g=!1}else{s=NC(r,e,d,s),eL(N,i,s);let G=t.listen(A,i,s);p.push(s,G),l&&l.push(i,L,M,M+1)}}else s=NC(r,e,d,s);let _=r.outputs,E;if(g&&_!==null&&(E=_[i])){let N=E.length;if(N)for(let A=0;A<N;A+=2){let M=E[A],L=E[A+1],Se=e[M][L].subscribe(s),K=p.length;p.push(s,Se),l&&l.push(i,r.index,K,-(K+1))}}}function RC(n,e,t,r){let i=ye(null);try{return Rn(6,e,t),t(r)!==!1}catch(s){return _D(n,s),!1}finally{Rn(7,e,t),ye(i)}}function NC(n,e,t,r){return function i(s){if(s===Function)return r;let o=n.componentOffset>-1?Vs(n.index,e):e;Fg(o,5);let a=RC(e,t,r,s),c=i.__ngNextListenerFn__;for(;c;)a=RC(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Ug(n=1){return MO(n)}function jg(n,e=""){let t=ht(),r=Us(),i=n+xn,s=r.firstCreatePass?Yl(r,i,1,e,null):r.data[i],o=rL(r,t,s,e,n);t[i]=o,gg()&&Ng(r,t,o,s),Fa(s,!1)}var rL=(n,e,t,r,i)=>(mg(!0),m1(e[Gt],r));function Bg(n,e,t){let r=ht(),i=KF(r,n,e,t);return i!==La&&nF(r,pg(),i),Bg}var iL=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=ZC(!1,t.type),i=r.length>0?Lg([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=H({token:n,providedIn:"environment",factory:()=>new n(Y(tn))})}}return n})();function $s(n){Va("NgStandalone"),n.getStandaloneInjector=e=>e.get(iL).getOrCreateStandaloneInjector(n)}var Vr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},xD=new Vr("18.2.13");var td=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var kD=new j("");function Ua(n){return!!n&&typeof n.then=="function"}function OD(n){return!!n&&typeof n.subscribe=="function"}var Br=new j(""),FD=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=O(Br,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(Ua(s))t.push(s);else if(OD(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),$g=new j("");function sL(){vT(()=>{throw new J(600,!1)})}function oL(n){return n.isBoundToModule}var aL=10;function cL(n,e,t){try{let r=t();return Ua(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var wi=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=O(i1),this.afterRenderManager=O(WF),this.zonelessEnabled=O(Jl),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new it,this.afterTick=new it,this.componentTypes=[],this.components=[],this.isStable=O(js).hasPendingTasks.pipe(te(t=>!t)),this._injector=O(tn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Ol;if(!this._injector.get(FD).done){let g=!i&&WC(t),_=!1;throw new J(405,_)}let o;i?o=t:o=this._injector.get(Fr).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=oL(o)?void 0:this._injector.get(Lr),c=r||o.selector,l=o.create(Ee.NULL,[],c,a),d=l.location.nativeElement,p=l.injector.get(kD,null);return p?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),ml(this.components,l),p?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new J(101,!1);let t=ye(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,ye(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Os,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<aL;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:s}of this._views)uL(i,s,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>zl(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;ml(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get($g,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ml(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new J(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ml(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function uL(n,e,t,r){if(!t&&!zl(n))return;ED(n,e,t&&!r?0:1)}var Xp=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Hg=(()=>{class n{compileModuleSync(t){return new Jp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=KC(t),s=Qb(i.declarations).reduce((o,a)=>{let c=gi(a);return c&&o.push(new xa(c)),o},[]);return new Xp(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var lL=(()=>{class n{constructor(){this.zone=O(Q),this.changeDetectionScheduler=O(ks),this.applicationRef=O(wi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),dL=new j("",{factory:()=>!1});function LD({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Q(Pe(U({},UD()),{scheduleInRootZone:t})),[{provide:Q,useFactory:n},{provide:Rs,multi:!0,useFactory:()=>{let r=O(lL,{optional:!0});return()=>r.initialize()}},{provide:Rs,multi:!0,useFactory:()=>{let r=O(hL);return()=>{r.initialize()}}},e===!0?{provide:DD,useValue:!0}:[],{provide:SD,useValue:t??Vb}]}function VD(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=LD({ngZoneFactory:()=>{let i=UD(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Va("NgZone_CoalesceEvent"),new Q(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Me([{provide:dL,useValue:!0},{provide:Jl,useValue:!1},r])}function UD(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var hL=(()=>{class n{constructor(){this.subscription=new $e,this.initialized=!1,this.zone=O(Q),this.pendingTasks=O(js)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Q.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Q.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var fL=(()=>{class n{constructor(){this.appRef=O(wi),this.taskService=O(js),this.ngZone=O(Q),this.zonelessEnabled=O(Jl),this.disableScheduling=O(DD,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new $e,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Pl):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(O(SD,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Vp||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?gC:jb;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Pl+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,gC(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function pL(){return typeof $localize<"u"&&$localize.locale||Vl}var qg=new j("",{providedIn:"root",factory:()=>O(qg,ue.Optional|ue.SkipSelf)||pL()});var eg=new j("");function hl(n){return!n.moduleRef}function gL(n){let e=hl(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Q);return t.run(()=>{hl(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(tr,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:s=>{r.handleError(s)}})}),hl(n)){let s=()=>e.destroy(),o=n.platformInjector.get(eg);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(eg);o.add(s),n.moduleRef.onDestroy(()=>{ml(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return cL(r,t,()=>{let s=e.get(FD);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(qg,Vl);if(XF(o||Vl),hl(n)){let a=e.get(wi);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return mL(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function mL(n,e){let t=n.injector.get(wi);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new J(-403,!1);e.push(n)}var _l=null;function _L(n=[],e){return Ee.create({name:e,providers:[{provide:$l,useValue:"platform"},{provide:eg,useValue:new Set([()=>_l=null])},...n]})}function yL(n=[]){if(_l)return _l;let e=_L(n);return _l=e,sL(),vL(e),e}function vL(n){n.get(Cg,null)?.forEach(t=>t())}var ja=(()=>{class n{static{this.__NG_ELEMENT_ID__=IL}}return n})();function IL(n){return wL(Fn(),ht(),(n&16)===16)}function wL(n,e,t){if(ug(n)&&!t){let r=Vs(n.index,e);return new xs(r,r)}else if(n.type&175){let r=e[Mn];return new xs(r,e)}return null}function jD(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=yL(r),s=[LD({}),{provide:ks,useExisting:fL},...t||[]],o=new Ll({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return gL({r3Injector:o.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}var qD=null;function Hs(){return qD}function zD(n){qD??=n}var nd=class{};var rn=new j(""),GD=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(DL),providedIn:"platform"})}}return n})();var DL=(()=>{class n extends GD{constructor(){super(),this._doc=O(rn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Hs().getBaseHref(this._doc)}onPopState(t){let r=Hs().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Hs().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function WD(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function BD(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Ei(n){return n&&n[0]!=="?"?"?"+n:n}var id=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(KD),providedIn:"root"})}}return n})(),SL=new j(""),KD=(()=>{class n extends id{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??O(rn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return WD(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Ei(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Ei(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Ei(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Y(GD),Y(SL,8))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ba=(()=>{class n{constructor(t){this._subject=new Nt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=NL(BD($D(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ei(r))}normalize(t){return n.stripTrailingSlash(RL(this._basePath,$D(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ei(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ei(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Ei}static{this.joinWithSlash=WD}static{this.stripTrailingSlash=BD}static{this.\u0275fac=function(r){return new(r||n)(Y(id))}}static{this.\u0275prov=H({token:n,factory:()=>AL(),providedIn:"root"})}}return n})();function AL(){return new Ba(Y(id))}function RL(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function $D(n){return n.replace(/\/index.html$/,"")}function NL(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function QD(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Wg="browser",PL="server";function Kg(n){return n===Wg}function Qg(n){return n===PL}var rd=class{};var Jg=class extends nd{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Xg=class n extends Jg{static makeCurrent(){zD(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=ML();return t==null?null:xL(t)}resetBaseElement(){$a=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return QD(document.cookie,e)}},$a=null;function ML(){return $a=$a||document.querySelector("base"),$a?$a.getAttribute("href"):null}function xL(n){return new URL(n,document.baseURI).pathname}var kL=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})(),em=new j(""),XD=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new J(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Y(em),Y(Q))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})(),sd=class{constructor(e){this._doc=e}},Yg="ng-app-id",eS=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Qg(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Yg}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(Yg),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(Yg,this.appId),t.appendChild(o),o}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Y(rn),Y(Tg),Y(bg,8),Y(pn))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})(),Zg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},nm=/%COMP%/g,tS="%COMP%",OL=`_nghost-${tS}`,FL=`_ngcontent-${tS}`,LL=!0,VL=new j("",{providedIn:"root",factory:()=>LL});function UL(n){return FL.replace(nm,n)}function jL(n){return OL.replace(nm,n)}function nS(n,e){return e.map(t=>t.replace(nm,n))}var YD=(()=>{class n{constructor(t,r,i,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Qg(a),this.defaultRenderer=new Ha(t,o,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Pn.ShadowDom&&(r=Pe(U({},r),{encapsulation:Pn.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof od?i.applyToHost(t):i instanceof qa&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case Pn.Emulated:s=new od(c,l,r,this.appId,d,o,a,p);break;case Pn.ShadowDom:return new tm(c,l,t,r,o,a,this.nonce,p);default:s=new qa(c,l,r,d,o,a,p);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Y(XD),Y(eS),Y(Tg),Y(VL),Y(rn),Y(pn),Y(Q),Y(bg))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})(),Ha=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Zg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(ZD(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(ZD(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new J(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Zg[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Zg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ii.DashCase|Ii.Important)?e.style.setProperty(t,r,i&Ii.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ii.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Hs().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function ZD(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var tm=class extends Ha{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=nS(i.id,i.styles);for(let d of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=d,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},qa=class extends Ha{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?nS(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},od=class extends qa{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=UL(l),this.hostAttr=jL(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},BL=(()=>{class n extends sd{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Y(rn))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})(),JD=["alt","control","meta","shift"],$L={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},HL={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},qL=(()=>{class n extends sd{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Hs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),JD.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=$L[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),JD.forEach(o=>{if(o!==i){let a=HL[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Y(rn))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac})}}return n})();function rS(n,e){return jD(U({rootComponent:n},zL(e)))}function zL(n){return{appProviders:[...YL,...n?.providers??[]],platformProviders:QL}}function GL(){Xg.makeCurrent()}function WL(){return new tr}function KL(){return Wb(document),document}var QL=[{provide:pn,useValue:Wg},{provide:Cg,useValue:GL,multi:!0},{provide:rn,useFactory:KL,deps:[]}];var YL=[{provide:$l,useValue:"root"},{provide:tr,useFactory:WL,deps:[]},{provide:em,useClass:BL,multi:!0,deps:[rn,Q,pn]},{provide:em,useClass:qL,multi:!0,deps:[rn]},YD,eS,XD,{provide:Os,useExisting:YD},{provide:rd,useClass:kL,deps:[]},[]];var ad=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Y(rn))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var oe="primary",cc=Symbol("RouteTitle"),am=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Qs(n){return new am(n)}function ZL(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function JL(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ln(n[t],e[t]))return!1;return!0}function Ln(n,e){let t=n?cm(n):void 0,r=e?cm(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!hS(n[i],e[i]))return!1;return!0}function cm(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function hS(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function fS(n){return n.length>0?n[n.length-1]:null}function $r(n){return ap(n)?n:Ua(n)?He(Promise.resolve(n)):W(n)}var XL={exact:gS,subset:mS},pS={exact:eV,subset:tV,ignored:()=>!0};function sS(n,e,t){return XL[t.paths](n.root,e.root,t.matrixParams)&&pS[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function eV(n,e){return Ln(n,e)}function gS(n,e,t){if(!Ci(n.segments,e.segments)||!ld(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!gS(n.children[r],e.children[r],t))return!1;return!0}function tV(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>hS(n[t],e[t]))}function mS(n,e,t){return _S(n,e,e.segments,t)}function _S(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Ci(i,t)||e.hasChildren()||!ld(i,t,r))}else if(n.segments.length===t.length){if(!Ci(n.segments,t)||!ld(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!mS(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Ci(n.segments,i)||!ld(n.segments,i,r)||!n.children[oe]?!1:_S(n.children[oe],e,s,r)}}function ld(n,e,t){return e.every((r,i)=>pS[t](n[i].parameters,r.parameters))}var or=class{constructor(e=new Ce([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Qs(this.queryParams),this._queryParamMap}toString(){return iV.serialize(this)}},Ce=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dd(this)}},Ti=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Qs(this.parameters),this._parameterMap}toString(){return vS(this)}};function nV(n,e){return Ci(n,e)&&n.every((t,r)=>Ln(t.parameters,e[r].parameters))}function Ci(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function rV(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var xm=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>new Za,providedIn:"root"})}}return n})(),Za=class{parse(e){let t=new lm(e);return new or(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${za(e.root,!0)}`,r=aV(e.queryParams),i=typeof e.fragment=="string"?`#${sV(e.fragment)}`:"";return`${t}${r}${i}`}},iV=new Za;function dd(n){return n.segments.map(e=>vS(e)).join("/")}function za(n,e){if(!n.hasChildren())return dd(n);if(e){let t=n.children[oe]?za(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==oe&&r.push(`${i}:${za(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=rV(n,(r,i)=>i===oe?[za(n.children[oe],!1)]:[`${i}:${za(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${dd(n)}/${t[0]}`:`${dd(n)}/(${t.join("//")})`}}function yS(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cd(n){return yS(n).replace(/%3B/gi,";")}function sV(n){return encodeURI(n)}function um(n){return yS(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hd(n){return decodeURIComponent(n)}function oS(n){return hd(n.replace(/\+/g,"%20"))}function vS(n){return`${um(n.path)}${oV(n.parameters)}`}function oV(n){return Object.entries(n).map(([e,t])=>`;${um(e)}=${um(t)}`).join("")}function aV(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${cd(t)}=${cd(i)}`).join("&"):`${cd(t)}=${cd(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var cV=/^[^\/()?;#]+/;function rm(n){let e=n.match(cV);return e?e[0]:""}var uV=/^[^\/()?;=#]+/;function lV(n){let e=n.match(uV);return e?e[0]:""}var dV=/^[^=?&#]+/;function hV(n){let e=n.match(dV);return e?e[0]:""}var fV=/^[^&#]+/;function pV(n){let e=n.match(fV);return e?e[0]:""}var lm=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ce([],{}):new Ce([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new Ce(e,t)),r}parseSegment(){let e=rm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new J(4009,!1);return this.capture(e),new Ti(hd(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=lV(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=rm(this.remaining);i&&(r=i,this.capture(r))}e[hd(t)]=hd(r)}parseQueryParam(e){let t=hV(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=pV(this.remaining);o&&(r=o,this.capture(r))}let i=oS(t),s=oS(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=rm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new J(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=oe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[oe]:new Ce([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new J(4011,!1)}};function IS(n){return n.segments.length>0?new Ce([],{[oe]:n}):n}function wS(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=wS(i);if(r===oe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Ce(n.segments,e);return gV(t)}function gV(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new Ce(n.segments.concat(e.segments),e.children)}return n}function Ja(n){return n instanceof or}function mV(n,e,t=null,r=null){let i=ES(n);return TS(i,e,t,r)}function ES(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Ce(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=IS(r);return e??i}function TS(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return im(i,i,i,t,r);let s=_V(e);if(s.toRoot())return im(i,i,new Ce([],{}),t,r);let o=yV(s,i,n),a=o.processChildren?Ka(o.segmentGroup,o.index,s.commands):bS(o.segmentGroup,o.index,s.commands);return im(i,o.segmentGroup,a,t,r)}function fd(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Xa(n){return typeof n=="object"&&n!=null&&n.outlets}function im(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=CS(n,e,t);let a=IS(wS(o));return new or(a,s,i)}function CS(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=CS(s,e,t)}),new Ce(n.segments,r)}var pd=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&fd(r[0]))throw new J(4003,!1);let i=r.find(Xa);if(i&&i!==fS(r))throw new J(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function _V(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new pd(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new pd(t,e,r)}var Gs=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function yV(n,e,t){if(n.isAbsolute)return new Gs(e,!0,0);if(!t)return new Gs(e,!1,NaN);if(t.parent===null)return new Gs(t,!0,0);let r=fd(n.commands[0])?0:1,i=t.segments.length-1+r;return vV(t,i,n.numberOfDoubleDots)}function vV(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new J(4005,!1);i=r.segments.length}return new Gs(r,!1,i-s)}function IV(n){return Xa(n[0])?n[0].outlets:{[oe]:n}}function bS(n,e,t){if(n??=new Ce([],{}),n.segments.length===0&&n.hasChildren())return Ka(n,e,t);let r=wV(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Ce(n.segments.slice(0,r.pathIndex),{});return s.children[oe]=new Ce(n.segments.slice(r.pathIndex),n.children),Ka(s,0,i)}else return r.match&&i.length===0?new Ce(n.segments,{}):r.match&&!n.hasChildren()?dm(n,e,t):r.match?Ka(n,0,i):dm(n,e,t)}function Ka(n,e,t){if(t.length===0)return new Ce(n.segments,{});{let r=IV(t),i={};if(Object.keys(r).some(s=>s!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let s=Ka(n.children[oe],e,t);return new Ce(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=bS(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ce(n.segments,i)}}function wV(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Xa(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!cS(c,l,o))return s;r+=2}else{if(!cS(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function dm(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Xa(s)){let c=EV(s.outlets);return new Ce(r,c)}if(i===0&&fd(t[0])){let c=n.segments[e];r.push(new Ti(c.path,aS(t[0]))),i++;continue}let o=Xa(s)?s.outlets[oe]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&fd(a)?(r.push(new Ti(o,aS(a))),i+=2):(r.push(new Ti(o,{})),i++)}return new Ce(r,{})}function EV(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=dm(new Ce([],{}),0,r))}),e}function aS(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function cS(n,e,t){return n==t.path&&Ln(e,t.parameters)}var Qa="imperative",ft=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ft||{}),sn=class{constructor(e,t){this.id=e,this.url=t}},ec=class extends sn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=ft.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},bi=class extends sn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=ft.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Kt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Kt||{}),hm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(hm||{}),sr=class extends sn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ft.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Di=class extends sn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ft.NavigationSkipped}},tc=class extends sn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=ft.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},gd=class extends sn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ft.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fm=class extends sn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ft.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pm=class extends sn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=ft.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},gm=class extends sn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ft.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mm=class extends sn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ft.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_m=class{constructor(e){this.route=e,this.type=ft.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ym=class{constructor(e){this.route=e,this.type=ft.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},vm=class{constructor(e){this.snapshot=e,this.type=ft.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Im=class{constructor(e){this.snapshot=e,this.type=ft.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wm=class{constructor(e){this.snapshot=e,this.type=ft.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},nc=class{constructor(e){this.snapshot=e,this.type=ft.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var rc=class{},Ys=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function TV(n,e){return n.providers&&!n._injector&&(n._injector=Lg(n.providers,e,`Route: ${n.path}`)),n._injector??e}function mn(n){return n.outlet||oe}function CV(n,e){let t=n.filter(r=>mn(r)===e);return t.push(...n.filter(r=>mn(r)!==e)),t}function uc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Em=class{get injector(){return uc(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Ed(this.rootInjector),this.attachRef=null}},Ed=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Em(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(Y(tn))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),md=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Tm(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Tm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Cm(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Cm(e,this._root).map(t=>t.value)}};function Tm(n,e){if(n===e.value)return e;for(let t of e.children){let r=Tm(n,t);if(r)return r}return null}function Cm(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Cm(n,t);if(r.length)return r.unshift(e),r}return[]}var Wt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function zs(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var _d=class extends md{constructor(e,t){super(e),this.snapshot=t,km(this,e)}toString(){return this.snapshot.toString()}};function DS(n){let e=bV(n),t=new dt([new Ti("",{})]),r=new dt({}),i=new dt({}),s=new dt({}),o=new dt(""),a=new Zs(t,r,s,o,i,oe,n,e.root);return a.snapshot=e.root,new _d(new Wt(a,[]),e)}function bV(n){let e={},t={},r={},i="",s=new Ws([],e,r,i,t,oe,n,null,{});return new vd("",new Wt(s,[]))}var Zs=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(te(l=>l[cc]))??W(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(te(e=>Qs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(te(e=>Qs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function yd(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:U(U({},e.params),n.params),data:U(U({},e.data),n.data),resolve:U(U(U(U({},n.data),e.data),i?.data),n._resolvedData)}:r={params:U({},n.params),data:U({},n.data),resolve:U(U({},n.data),n._resolvedData??{})},i&&AS(i)&&(r.resolve[cc]=i.title),r}var Ws=class{get title(){return this.data?.[cc]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Qs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Qs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},vd=class extends md{constructor(e,t){super(t),this.url=e,km(this,t)}toString(){return SS(this._root)}};function km(n,e){e.value._routerState=n,e.children.forEach(t=>km(n,t))}function SS(n){let e=n.children.length>0?` { ${n.children.map(SS).join(", ")} } `:"";return`${n.value}${e}`}function sm(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ln(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ln(e.params,t.params)||n.paramsSubject.next(t.params),JL(e.url,t.url)||n.urlSubject.next(t.url),Ln(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function bm(n,e){let t=Ln(n.params,e.params)&&nV(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||bm(n.parent,e.parent))}function AS(n){return typeof n.title=="string"||n.title===null}var Om=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new Nt,this.deactivateEvents=new Nt,this.attachEvents=new Nt,this.detachEvents=new Nt,this.parentContexts=O(Ed),this.location=O(Xl),this.changeDetector=O(ja),this.inputBinder=O(Fm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new J(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new J(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new J(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new J(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Dm(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=og({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ql]})}}return n})(),Dm=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Zs?this.route:e===Ed?this.childContexts:this.parent.get(e,t)}},Fm=new j("");function DV(n,e,t){let r=ic(n,e._root,t?t._root:void 0);return new _d(r,e)}function ic(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=SV(n,e,t);return new Wt(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ic(n,a)),o}}let r=AV(e.value),i=e.children.map(s=>ic(n,s));return new Wt(r,i)}}function SV(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return ic(n,r,i);return ic(n,r)})}function AV(n){return new Zs(new dt(n.url),new dt(n.params),new dt(n.queryParams),new dt(n.fragment),new dt(n.data),n.outlet,n.component,n)}var sc=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},RS="ngNavigationCancelingError";function Id(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ja(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=NS(!1,Kt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function NS(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[RS]=!0,t.cancellationCode=e,t}function RV(n){return PS(n)&&Ja(n.url)}function PS(n){return!!n&&n[RS]}var NV=(n,e,t,r)=>te(i=>(new Sm(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Sm=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),sm(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=zs(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=zs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=zs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=zs(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new nc(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Im(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(sm(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),sm(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},wd=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ks=class{constructor(e,t){this.component=e,this.route=t}};function PV(n,e,t){let r=n._root,i=e?e._root:null;return Ga(r,i,t,[r.value])}function MV(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Xs(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!xC(n)?n:e.get(n):r}function Ga(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=zs(e);return n.children.forEach(o=>{xV(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ya(a,t.getContext(o),i)),i}function xV(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=kV(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new wd(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ga(n,e,a?a.children:null,r,i):Ga(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ks(a.outlet.component,o))}else o&&Ya(e,a,i),i.canActivateChecks.push(new wd(r)),s.component?Ga(n,null,a?a.children:null,r,i):Ga(n,null,t,r,i);return i}function kV(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Ci(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ci(n.url,e.url)||!Ln(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!bm(n,e)||!Ln(n.queryParams,e.queryParams);case"paramsChange":default:return!bm(n,e)}}function Ya(n,e,t){let r=zs(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Ya(o,e.children.getContext(s),t):Ya(o,null,t):Ya(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ks(e.outlet.component,i)):t.canDeactivateChecks.push(new Ks(null,i)):t.canDeactivateChecks.push(new Ks(null,i))}function lc(n){return typeof n=="function"}function OV(n){return typeof n=="boolean"}function FV(n){return n&&lc(n.canLoad)}function LV(n){return n&&lc(n.canActivate)}function VV(n){return n&&lc(n.canActivateChild)}function UV(n){return n&&lc(n.canDeactivate)}function jV(n){return n&&lc(n.canMatch)}function MS(n){return n instanceof Jn||n?.name==="EmptyError"}var ud=Symbol("INITIAL_VALUE");function Js(){return Lt(n=>sl(n.map(e=>e.pipe(Xn(1),Is(ud)))).pipe(te(e=>{for(let t of e)if(t!==!0){if(t===ud)return ud;if(t===!1||BV(t))return t}return!0}),Rt(e=>e!==ud),Xn(1)))}function BV(n){return Ja(n)||n instanceof sc}function $V(n,e){return Ke(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?W(Pe(U({},t),{guardsResult:!0})):HV(o,r,i,n).pipe(Ke(a=>a&&OV(a)?qV(r,s,n,e):W(a)),te(a=>Pe(U({},t),{guardsResult:a})))})}function HV(n,e,t,r){return He(n).pipe(Ke(i=>QV(i.component,i.route,t,e,r)),An(i=>i!==!0,!0))}function qV(n,e,t,r){return He(e).pipe(hi(i=>ys(GV(i.route.parent,r),zV(i.route,r),KV(n,i.path,t),WV(n,i.route,t))),An(i=>i!==!0,!0))}function zV(n,e){return n!==null&&e&&e(new wm(n)),W(!0)}function GV(n,e){return n!==null&&e&&e(new vm(n)),W(!0)}function WV(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return W(!0);let i=r.map(s=>ol(()=>{let o=uc(e)??t,a=Xs(s,o),c=LV(a)?a.canActivate(e,n):nr(o,()=>a(e,n));return $r(c).pipe(An())}));return W(i).pipe(Js())}function KV(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>MV(o)).filter(o=>o!==null).map(o=>ol(()=>{let a=o.guards.map(c=>{let l=uc(o.node)??t,d=Xs(c,l),p=VV(d)?d.canActivateChild(r,n):nr(l,()=>d(r,n));return $r(p).pipe(An())});return W(a).pipe(Js())}));return W(s).pipe(Js())}function QV(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return W(!0);let o=s.map(a=>{let c=uc(e)??i,l=Xs(a,c),d=UV(l)?l.canDeactivate(n,e,t,r):nr(c,()=>l(n,e,t,r));return $r(d).pipe(An())});return W(o).pipe(Js())}function YV(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return W(!0);let s=i.map(o=>{let a=Xs(o,n),c=FV(a)?a.canLoad(e,t):nr(n,()=>a(e,t));return $r(c)});return W(s).pipe(Js(),xS(r))}function xS(n){return qu(st(e=>{if(typeof e!="boolean")throw Id(n,e)}),te(e=>e===!0))}function ZV(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return W(!0);let s=i.map(o=>{let a=Xs(o,n),c=jV(a)?a.canMatch(e,t):nr(n,()=>a(e,t));return $r(c)});return W(s).pipe(Js(),xS(r))}var oc=class{constructor(e){this.segmentGroup=e||null}},ac=class extends Error{constructor(e){super(),this.urlTree=e}};function qs(n){return _s(new oc(n))}function JV(n){return _s(new J(4e3,!1))}function XV(n){return _s(NS(!1,Kt.GuardRejected))}var Am=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return W(r);if(i.numberOfChildren>1||!i.children[oe])return JV(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:d,url:p,outlet:g,params:_,data:E,title:N}=i,A=nr(s,()=>a({params:_,data:E,queryParams:c,fragment:l,routeConfig:d,url:p,outlet:g,title:N}));if(A instanceof or)throw new ac(A);t=A}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new ac(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new or(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ce(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new J(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Rm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function eU(n,e,t,r,i){let s=kS(n,e,t);return s.matched?(r=TV(e,r),ZV(r,e,t,i).pipe(te(o=>o===!0?s:U({},Rm)))):W(s)}function kS(n,e,t){if(e.path==="**")return tU(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?U({},Rm):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||ZL)(t,n,e);if(!i)return U({},Rm);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?U(U({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function tU(n){return{matched:!0,parameters:n.length>0?fS(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function uS(n,e,t,r){return t.length>0&&iU(n,t,r)?{segmentGroup:new Ce(e,rU(r,new Ce(t,n.children))),slicedSegments:[]}:t.length===0&&sU(n,t,r)?{segmentGroup:new Ce(n.segments,nU(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ce(n.segments,n.children),slicedSegments:t}}function nU(n,e,t,r){let i={};for(let s of t)if(Td(n,e,s)&&!r[mn(s)]){let o=new Ce([],{});i[mn(s)]=o}return U(U({},r),i)}function rU(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&mn(r)!==oe){let i=new Ce([],{});t[mn(r)]=i}return t}function iU(n,e,t){return t.some(r=>Td(n,e,r)&&mn(r)!==oe)}function sU(n,e,t){return t.some(r=>Td(n,e,r))}function Td(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function oU(n,e,t){return e.length===0&&!n.children[t]}var Nm=class{};function aU(n,e,t,r,i,s,o="emptyOnly"){return new Pm(n,e,t,r,i,o,s).recognize()}var cU=31,Pm=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Am(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new J(4002,`'${e.segmentGroup}'`)}recognize(){let e=uS(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(te(({children:t,rootSnapshot:r})=>{let i=new Wt(r,t),s=new vd("",i),o=mV(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Ws([],Object.freeze({}),Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(te(r=>({children:r,rootSnapshot:t})),Pr(r=>{if(r instanceof ac)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof oc?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(te(o=>o instanceof Wt?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return He(s).pipe(hi(o=>{let a=r.children[o],c=CV(t,o);return this.processSegmentGroup(e,c,a,o,i)}),ll((o,a)=>(o.push(...a),o)),Mr(null),dp(),Ke(o=>{if(o===null)return qs(r);let a=OS(o);return uU(a),W(a)}))}processSegment(e,t,r,i,s,o,a){return He(t).pipe(hi(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(Pr(l=>{if(l instanceof oc)return W(null);throw l}))),An(c=>!!c),Pr(c=>{if(MS(c))return oU(r,i,s)?W(new Nm):qs(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return mn(r)!==o&&(o===oe||!Td(i,s,r))?qs(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):qs(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:d,positionalParamSegments:p,remainingSegments:g}=kS(t,i,s);if(!c)return qs(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>cU&&(this.allowRedirects=!1));let _=new Ws(s,l,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,lS(i),mn(i),i.component??i._loadedComponent??null,i,dS(i)),E=yd(_,a,this.paramsInheritanceStrategy);_.params=Object.freeze(E.params),_.data=Object.freeze(E.data);let N=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,p,_,e);return this.applyRedirects.lineralizeSegments(i,N).pipe(Ke(A=>this.processSegment(e,r,t,A.concat(g),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=eU(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Lt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Lt(({routes:l})=>{let d=r._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:_}=c,E=new Ws(g,p,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,lS(r),mn(r),r.component??r._loadedComponent??null,r,dS(r)),N=yd(E,o,this.paramsInheritanceStrategy);E.params=Object.freeze(N.params),E.data=Object.freeze(N.data);let{segmentGroup:A,slicedSegments:M}=uS(t,g,_,l);if(M.length===0&&A.hasChildren())return this.processChildren(d,l,A,E).pipe(te($=>new Wt(E,$)));if(l.length===0&&M.length===0)return W(new Wt(E,[]));let L=mn(r)===s;return this.processSegment(d,l,A,M,L?oe:s,!0,E).pipe(te($=>new Wt(E,$ instanceof Wt?[$]:[])))}))):qs(t)))}getChildConfig(e,t,r){return t.children?W({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?W({routes:t._loadedRoutes,injector:t._loadedInjector}):YV(e,t,r,this.urlSerializer).pipe(Ke(i=>i?this.configLoader.loadChildren(e,t).pipe(st(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):XV(t))):W({routes:[],injector:e})}};function uU(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function lU(n){let e=n.value.routeConfig;return e&&e.path===""}function OS(n){let e=[],t=new Set;for(let r of n){if(!lU(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=OS(r.children);e.push(new Wt(r.value,i))}return e.filter(r=>!t.has(r))}function lS(n){return n.data||{}}function dS(n){return n.resolve||{}}function dU(n,e,t,r,i,s){return Ke(o=>aU(n,e,t,r,o.extractedUrl,i,s).pipe(te(({state:a,tree:c})=>Pe(U({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function hU(n,e){return Ke(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return W(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of FS(c))o.add(l);let a=0;return He(o).pipe(hi(c=>s.has(c)?fU(c,r,n,e):(c.data=yd(c,c.parent,n).resolve,W(void 0))),st(()=>a++),vs(1),Ke(c=>a===o.size?W(t):Ht))})}function FS(n){let e=n.children.map(t=>FS(t)).flat();return[n,...e]}function fU(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!AS(i)&&(s[cc]=i.title),pU(s,n,e,r).pipe(te(o=>(n._resolvedData=o,n.data=yd(n,n.parent,t).resolve,null)))}function pU(n,e,t,r){let i=cm(n);if(i.length===0)return W({});let s={};return He(i).pipe(Ke(o=>gU(n[o],e,t,r).pipe(An(),st(a=>{if(a instanceof sc)throw Id(new Za,a);s[o]=a}))),vs(1),up(s),Pr(o=>MS(o)?Ht:_s(o)))}function gU(n,e,t,r){let i=uc(e)??r,s=Xs(n,i),o=s.resolve?s.resolve(e,t):nr(i,()=>s(e,t));return $r(o)}function om(n){return Lt(e=>{let t=n(e);return t?He(t).pipe(te(()=>e)):W(e)})}var LS=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===oe);return r}getResolvedTitleForRoute(t){return t.data[cc]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(mU),providedIn:"root"})}}return n})(),mU=(()=>{class n extends LS{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Y(ad))}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Lm=new j("",{providedIn:"root",factory:()=>({})}),Vm=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Fs({type:n,selectors:[["ng-component"]],standalone:!0,features:[$s],decls:1,vars:0,template:function(r,i){r&1&&Bs(0,"router-outlet")},dependencies:[Om],encapsulation:2})}}return n})();function Um(n){let e=n.children&&n.children.map(Um),t=e?Pe(U({},n),{children:e}):U({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=Vm),t}var jm=new j(""),_U=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=O(Hg)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return W(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=$r(t.loadComponent()).pipe(te(VS),st(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Ta(()=>{this.componentLoaders.delete(t)})),i=new fs(r,()=>new it).pipe(hs());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return W({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=yU(r,this.compiler,t,this.onLoadEndListener).pipe(Ta(()=>{this.childrenLoaders.delete(r)})),o=new fs(s,()=>new it).pipe(hs());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function yU(n,e,t,r){return $r(n.loadChildren()).pipe(te(VS),Ke(i=>i instanceof ka||Array.isArray(i)?W(i):He(e.compileModuleAsync(i))),te(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(jm,[],{optional:!0,self:!0}).flat()),{routes:o.map(Um),injector:s}}))}function vU(n){return n&&typeof n=="object"&&"default"in n}function VS(n){return vU(n)?n.default:n}var Bm=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(IU),providedIn:"root"})}}return n})(),IU=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),wU=new j("");var EU=new j(""),TU=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new it,this.transitionAbortSubject=new it,this.configLoader=O(_U),this.environmentInjector=O(tn),this.urlSerializer=O(xm),this.rootContexts=O(Ed),this.location=O(Ba),this.inputBindingEnabled=O(Fm,{optional:!0})!==null,this.titleStrategy=O(LS),this.options=O(Lm,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=O(Bm),this.createViewTransition=O(wU,{optional:!0}),this.navigationErrorHandler=O(EU,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>W(void 0),this.rootComponentType=null;let t=i=>this.events.next(new _m(i)),r=i=>this.events.next(new ym(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Pe(U(U({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new dt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Qa,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Rt(s=>s.id!==0),te(s=>Pe(U({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Lt(s=>{let o=!1,a=!1;return W(s).pipe(Lt(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Kt.SupersededByNewNavigation),Ht;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Pe(U({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&d!=="reload"){let p="";return this.events.next(new Di(c.id,this.urlSerializer.serialize(c.rawUrl),p,hm.IgnoredSameUrlNavigation)),c.resolve(!1),Ht}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return W(c).pipe(Lt(p=>{let g=this.transitions?.getValue();return this.events.next(new ec(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?Ht:Promise.resolve(p)}),dU(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),st(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Pe(U({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new gd(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:p,extractedUrl:g,source:_,restoredState:E,extras:N}=c,A=new ec(p,this.urlSerializer.serialize(g),_,E);this.events.next(A);let M=DS(this.rootComponentType).snapshot;return this.currentTransition=s=Pe(U({},c),{targetSnapshot:M,urlAfterRedirects:g,extras:Pe(U({},N),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,W(s)}else{let p="";return this.events.next(new Di(c.id,this.urlSerializer.serialize(c.extractedUrl),p,hm.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Ht}}),st(c=>{let l=new fm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),te(c=>(this.currentTransition=s=Pe(U({},c),{guards:PV(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),$V(this.environmentInjector,c=>this.events.next(c)),st(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Id(this.urlSerializer,c.guardsResult);let l=new pm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Rt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Kt.GuardRejected),!1)),om(c=>{if(c.guards.canActivateChecks.length)return W(c).pipe(st(l=>{let d=new gm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Lt(l=>{let d=!1;return W(l).pipe(hU(this.paramsInheritanceStrategy,this.environmentInjector),st({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Kt.NoDataFromResolver)}}))}),st(l=>{let d=new mm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),om(c=>{let l=d=>{let p=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(d.routeConfig).pipe(st(g=>{d.component=g}),te(()=>{})));for(let g of d.children)p.push(...l(g));return p};return sl(l(c.targetSnapshot.root)).pipe(Mr(null),Xn(1))}),om(()=>this.afterPreactivation()),Lt(()=>{let{currentSnapshot:c,targetSnapshot:l}=s,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?He(d).pipe(te(()=>s)):W(s)}),te(c=>{let l=DV(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=Pe(U({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),st(()=>{this.events.next(new rc)}),NV(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Xn(1),st({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new bi(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),ws(this.transitionAbortSubject.pipe(st(c=>{throw c}))),Ta(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",Kt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Pr(c=>{if(a=!0,PS(c))this.events.next(new sr(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),RV(c)?this.events.next(new Ys(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let l=new tc(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let d=nr(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(d instanceof sc){let{message:p,cancellationCode:g}=Id(this.urlSerializer,d);this.events.next(new sr(s.id,this.urlSerializer.serialize(s.extractedUrl),p,g)),this.events.next(new Ys(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(l);let p=t.errorHandler(c);s.resolve(!!p)}}catch(d){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(d)}}return Ht}))}))}cancelNavigationTransition(t,r,i){let s=new sr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function CU(n){return n!==Qa}var bU=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(DU),providedIn:"root"})}}return n})(),Mm=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},DU=(()=>{class n extends Mm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=vg(n)))(i||n)}})()}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),US=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:()=>O(SU),providedIn:"root"})}}return n})(),SU=(()=>{class n extends US{constructor(){super(...arguments),this.location=O(Ba),this.urlSerializer=O(xm),this.options=O(Lm,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=O(Bm),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new or,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=DS(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ec)this.stateMemento=this.createStateMemento();else if(t instanceof Di)this.rawUrlTree=r.initialUrl;else if(t instanceof gd){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof rc?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof sr&&(t.code===Kt.GuardRejected||t.code===Kt.NoDataFromResolver)?this.restoreHistory(r):t instanceof tc?this.restoreHistory(r,!0):t instanceof bi&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof or?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=U(U({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=U(U({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=vg(n)))(i||n)}})()}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Wa=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Wa||{});function AU(n,e){n.events.pipe(Rt(t=>t instanceof bi||t instanceof sr||t instanceof tc||t instanceof Di),te(t=>t instanceof bi||t instanceof Di?Wa.COMPLETE:(t instanceof sr?t.code===Kt.Redirect||t.code===Kt.SupersededByNewNavigation:!1)?Wa.REDIRECTING:Wa.FAILED),Rt(t=>t!==Wa.REDIRECTING),Xn(1)).subscribe(()=>{e()})}function RU(n){throw n}var NU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},PU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Cd=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=O(td),this.stateManager=O(US),this.options=O(Lm,{optional:!0})||{},this.pendingTasks=O(js),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=O(TU),this.urlSerializer=O(xm),this.location=O(Ba),this.urlHandlingStrategy=O(Bm),this._events=new it,this.errorHandler=this.options.errorHandler||RU,this.navigated=!1,this.routeReuseStrategy=O(bU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=O(jm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!O(Fm,{optional:!0}),this.eventsSubscription=new $e,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof sr&&r.code!==Kt.Redirect&&r.code!==Kt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof bi)this.navigated=!0;else if(r instanceof Ys){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=U({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||CU(i.source)},o);this.scheduleNavigation(a,Qa,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}xU(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qa,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=U({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Um),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=U(U({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let p;try{let g=i?i.snapshot:this.routerState.snapshot.root;p=ES(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return TS(p,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Ja(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Qa,null,r)}navigate(t,r={skipLocationChange:!1}){return MU(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=U({},NU):r===!1?i=U({},PU):i=r,Ja(t))return sS(this.currentUrlTree,t,i);let s=this.parseUrl(t);return sS(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((p,g)=>{a=p,c=g});let d=this.pendingTasks.add();return AU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function MU(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new J(4008,!1)}function xU(n){return!(n instanceof rc)&&!(n instanceof Ys)}var kU=new j("");function jS(n,...e){return Me([{provide:jm,multi:!0,useValue:n},[],{provide:Zs,useFactory:OU,deps:[Cd]},{provide:$g,multi:!0,useFactory:FU},e.map(t=>t.\u0275providers)])}function OU(n){return n.routerState.root}function FU(){let n=O(Ee);return e=>{let t=n.get(wi);if(e!==t.components[0])return;let r=n.get(Cd),i=n.get(LU);n.get(VU)===1&&r.initialNavigation(),n.get(UU,null,ue.Optional)?.setUpPreloading(),n.get(kU,null,ue.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var LU=new j("",{factory:()=>new it}),VU=new j("",{providedIn:"root",factory:()=>1});var UU=new j("");var BS=[];var BU="firebase",$U="10.14.1";q(BU,$U,"app");var ke=new Vr("ANGULARFIRE2_VERSION"),to=n=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this
context. Rather than injecting ${n} in the constructor, first ensure that ${n} is supported by calling
\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${n})\`.`;function Xe(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Qe=(n,e)=>{let t=e?[e]:ku(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Vt=class{constructor(){return Qe(HU)}},HU="app-check";function eo(){}var bd=class{zone;delegate;constructor(e,t=sp){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},$m=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",eo,{},eo,eo)),t.pipe(st({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},qe=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new bd(Zone.current)),this.insideAngular=t.run(()=>new bd(Zone.current,ip)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Y(Q))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Dd(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function qU(n){return Dd().ngZone.runOutsideAngular(()=>n())}function Si(n){return Dd().ngZone.run(()=>n())}function zU(n){return GU(Dd())(n)}function GU(n){return function(t){return t=t.lift(new $m(n.ngZone)),t.pipe(Nr(n.outsideAngular),Rr(n.insideAngular))}}var WU=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Si(()=>n.apply(void 0,r))},Ie=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Si(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",eo,{},eo,eo))),r[s]=WU(r[s],t));let i=qU(()=>n.apply(this,r));if(!e)if(i instanceof le){let s=Dd();return i.pipe(Nr(s.outsideAngular),Rr(s.insideAngular))}else return Si(()=>i);return i instanceof le?i.pipe(zU):i instanceof Promise?Si(()=>new Promise((s,o)=>i.then(a=>Si(()=>s(a)),a=>Si(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Si(()=>i)};var Oe=class{constructor(e){return e}},Ve=class{constructor(){return ku()}};function KU(n){return n&&n.length===1?n[0]:new Oe(Ze())}var Hm=new j("angularfire2._apps"),QU={provide:Oe,useFactory:KU,deps:[[new X,Hm]]},YU={provide:Ve,deps:[[new X,Hm]]};function ZU(n){return(e,t)=>{let r=t.get(pn);q("angularfire",ke.full,"core"),q("angularfire",ke.full,"app"),q("angular",xD.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Oe(i)}}function $S(n,...e){return Me([QU,YU,{provide:Hm,useFactory:ZU(n),multi:!0,deps:[Q,Ee,qe,...e]}])}var HS=Ie(aT,!0);function iA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var sA=iA,oA=new bn("auth","Firebase",iA());var Md=new Sn("@firebase/auth");function JU(n,...e){Md.logLevel<=vt.WARN&&Md.warn(`Auth (${Ot}): ${n}`,...e)}function Ad(n,...e){Md.logLevel<=vt.ERROR&&Md.error(`Auth (${Ot}): ${n}`,...e)}function qr(n,...e){throw u_(n,...e)}function Ri(n,...e){return u_(n,...e)}function aA(n,e,t){let r=Object.assign(Object.assign({},sA()),{[e]:t});return new bn("auth","Firebase",r).create(e,{appName:n.name})}function Ai(n){return aA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function u_(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return oA.create(n,...e)}function ee(n,e,...t){if(!n)throw u_(e,...t)}function ar(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ad(e),new Error(e)}function zr(n,e){n||ar(e)}function Wm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function XU(){return qS()==="http:"||qS()==="https:"}function qS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function ej(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XU()||ha()||"connection"in navigator)?navigator.onLine:!0}function tj(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ni=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,zr(t>e,"Short delay should be less than long delay!"),this.isMobile=da()||Pu()}get(){return ej()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function l_(n,e){zr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var xd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var nj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var rj=new Ni(3e4,6e4);function d_(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function ro(s,o,a,c){return y(this,arguments,function*(n,e,t,r,i={}){return cA(n,i,()=>y(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let p=ai(Object.assign({key:n.config.apiKey},d)).slice(1),g=yield n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);let _=Object.assign({method:e,headers:g},l);return JE()||(_.referrerPolicy="no-referrer"),xd.fetch()(uA(n,n.config.apiHost,t,p),_)}))})}function cA(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},nj),e);try{let i=new Km(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Sd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Sd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Sd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw aA(n,d,l);qr(n,d)}}catch(i){if(i instanceof kt)throw i;qr(n,"network-request-failed",{message:String(i)})}})}function ij(s,o,a,c){return y(this,arguments,function*(n,e,t,r,i={}){let l=yield ro(n,e,t,r,i);return"mfaPendingCredential"in l&&qr(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function uA(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?l_(n.config,i):`${n.config.apiScheme}://${i}`}var Km=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ri(this.auth,"network-request-failed")),rj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Sd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ri(n,e,r);return i.customData._tokenResponse=t,i}function sj(n,e){return y(this,null,function*(){return ro(n,"POST","/v1/accounts:delete",e)})}function lA(n,e){return y(this,null,function*(){return ro(n,"POST","/v1/accounts:lookup",e)})}function dc(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function h_(n,e=!1){return y(this,null,function*(){let t=fe(n),r=yield t.getIdToken(e),i=f_(r);ee(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:dc(qm(i.auth_time)),issuedAtTime:dc(qm(i.iat)),expirationTime:dc(qm(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function qm(n){return Number(n)*1e3}function f_(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ad("JWT malformed, contained fewer than 3 sections"),null;try{let i=QE(t);return i?JSON.parse(i):(Ad("Failed to decode base64 JWT payload"),null)}catch(i){return Ad("Caught error parsing JWT payload as JSON",i?.toString()),null}}function zS(n){let e=f_(n);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function fc(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof kt&&oj(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function oj({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Qm=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var pc=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=dc(this.lastLoginAt),this.creationTime=dc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function kd(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield fc(n,lA(t,{idToken:r}));ee(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?dA(s.providerUserInfo):[],a=aj(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new pc(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,p)})}function p_(n){return y(this,null,function*(){let e=fe(n);yield kd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function aj(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function dA(n){return n.map(e=>{var{providerId:t}=e,r=op(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function cj(n,e){return y(this,null,function*(){let t=yield cA(n,{},()=>y(this,null,function*(){let r=ai({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=uA(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",xd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function uj(n,e){return y(this,null,function*(){return ro(n,"POST","/v2/accounts:revokeToken",d_(n,e))})}var hc=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ee(e.length!==0,"internal-error");let t=zS(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield cj(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ee(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ee(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ar("not implemented")}};function Hr(n,e){ee(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var no=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=op(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Qm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new pc(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield fc(this,this.stsTokenManager.getToken(this.auth,e));return ee(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return h_(this,e)}reload(){return p_(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield kd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Zn(this.auth.app))return Promise.reject(Ai(this.auth));let e=yield this.getIdToken();return yield fc(this,sj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let p=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,N=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,M=(l=t.createdAt)!==null&&l!==void 0?l:void 0,L=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:$,emailVerified:G,isAnonymous:Se,providerData:K,stsTokenManager:T}=t;ee($&&T,e,"internal-error");let v=hc.fromJSON(this.name,T);ee(typeof $=="string",e,"internal-error"),Hr(p,e.name),Hr(g,e.name),ee(typeof G=="boolean",e,"internal-error"),ee(typeof Se=="boolean",e,"internal-error"),Hr(_,e.name),Hr(E,e.name),Hr(N,e.name),Hr(A,e.name),Hr(M,e.name),Hr(L,e.name);let I=new n({uid:$,auth:e,email:g,emailVerified:G,displayName:p,isAnonymous:Se,photoURL:E,phoneNumber:_,tenantId:N,stsTokenManager:v,createdAt:M,lastLoginAt:L});return K&&Array.isArray(K)&&(I.providerData=K.map(C=>Object.assign({},C))),A&&(I._redirectEventId=A),I}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new hc;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield kd(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];ee(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?dA(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new hc;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new pc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var GS=new Map;function cr(n){zr(n instanceof Function,"Expected a class definition");let e=GS.get(n);return e?(zr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,GS.set(n,e),e)}var lj=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ym=lj;function Rd(n,e,t){return`firebase:${n}:${e}:${t}`}var Od=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Rd(this.userKey,i.apiKey,s),this.fullPersistenceKey=Rd("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?no._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(cr(Ym),e,r);let i=(yield Promise.all(t.map(l=>y(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||cr(Ym),o=Rd(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let p=no._fromJSON(e,d);l!==s&&(a=p),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>y(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function WS(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_A(e))return"Blackberry";if(yA(e))return"Webos";if(fA(e))return"Safari";if((e.includes("chrome/")||pA(e))&&!e.includes("edge/"))return"Chrome";if(mA(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function hA(n=yt()){return/firefox\//i.test(n)}function fA(n=yt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pA(n=yt()){return/crios\//i.test(n)}function gA(n=yt()){return/iemobile/i.test(n)}function mA(n=yt()){return/android/i.test(n)}function _A(n=yt()){return/blackberry/i.test(n)}function yA(n=yt()){return/webos/i.test(n)}function g_(n=yt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function dj(n=yt()){var e;return g_(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hj(){return XE()&&document.documentMode===10}function vA(n=yt()){return g_(n)||mA(n)||yA(n)||_A(n)||/windows phone/i.test(n)||gA(n)}function IA(n,e=[]){let t;switch(n){case"Browser":t=WS(yt());break;case"Worker":t=`${WS(yt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ot}/${r}`}var Zm=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function fj(t){return y(this,arguments,function*(n,e={}){return ro(n,"GET","/v2/passwordPolicy",d_(n,e))})}var pj=6,Jm=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:pj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Xm=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fd(this),this.idTokenSubscription=new Fd(this),this.beforeStateQueue=new Zm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=cr(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Od.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield lA(this,{idToken:e}),r=yield no._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Zn(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield kd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=tj()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Zn(this.app))return Promise.reject(Ai(this));let t=e?fe(e):null;return t&&ee(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Zn(this.app)?Promise.reject(Ai(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Zn(this.app)?Promise.reject(Ai(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(cr(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield fj(this),t=new Jm(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new bn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield uj(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&cr(e)||this._popupRedirectResolver;ee(t,this,"argument-error"),this.redirectPersistenceManager=yield Od.create(this,[cr(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&JU(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function m_(n){return fe(n)}var Fd=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=iT(t=>this.observer=t)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var __={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gj(n){__=n}function mj(n){return __.loadJS(n)}function _j(){return __.gapiScript}function wA(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function y_(n,e){let t=Ye(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(ma(s,e??{}))return i;qr(i,"already-initialized")}return t.initialize({options:e})}function yj(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(cr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function v_(n,e,t){let r=m_(n);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=EA(e),{host:o,port:a}=vj(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Ij()}function EA(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function vj(n){let e=EA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:KS(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:KS(o)}}}function KS(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Ij(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ld=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ar("not implemented")}_getIdTokenResponse(e){return ar("not implemented")}_linkToIdToken(e,t){return ar("not implemented")}_getReauthenticationResolver(e){return ar("not implemented")}};function zm(n,e){return y(this,null,function*(){return ij(n,"POST","/v1/accounts:signInWithIdp",d_(n,e))})}var Vd=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var e_=class extends Vd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var gc=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield no._fromIdTokenResponse(e,r,i),o=QS(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=QS(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function QS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var t_=class n extends kt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function TA(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?t_._fromErrorAndOperation(n,s,e,r):s})}function wj(n,e,t=!1){return y(this,null,function*(){let r=yield fc(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return gc._forOperation(n,"link",r)})}function Ej(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Zn(r.app))return Promise.reject(Ai(r));let i="reauthenticate";try{let s=yield fc(n,TA(r,i,e,n),t);ee(s.idToken,r,"internal-error");let o=f_(s.idToken);ee(o,r,"internal-error");let{sub:a}=o;return ee(n.uid===a,r,"user-mismatch"),gc._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&qr(r,"user-mismatch"),s}})}function Tj(n,e,t=!1){return y(this,null,function*(){if(Zn(n.app))return Promise.reject(Ai(n));let r="signIn",i=yield TA(n,r,e),s=yield gc._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Hd(n,e,t,r){return fe(n).onIdTokenChanged(e,t,r)}function I_(n,e,t){return fe(n).beforeAuthStateChanged(e,t)}function qd(n,e,t,r){return fe(n).onAuthStateChanged(e,t,r)}var Ud="__sak";var jd=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ud,"1"),this.storage.removeItem(Ud),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Cj=1e3,bj=10,Dj=(()=>{class n extends jd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vA(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);hj()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,bj):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Cj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Dr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Dr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Dr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),CA=Dj;var Sj=(()=>{class n extends jd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),w_=Sj;function Aj(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Rj=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>y(this,null,function*(){return d(r.origin,o)})),l=yield Aj(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function bA(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var n_=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=bA("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let g=p;if(g.data.eventId===l)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Vn(){return window}function Nj(n){Vn().location.href=n}function DA(){return typeof Vn().WorkerGlobalScope<"u"&&typeof Vn().importScripts=="function"}function Pj(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Mj(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function xj(){return DA()?self:null}var SA="firebaseLocalStorageDb",kj=1,Bd="firebaseLocalStorage",AA="fbase_key",Pi=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function zd(n,e){return n.transaction([Bd],e?"readwrite":"readonly").objectStore(Bd)}function Oj(){let n=indexedDB.deleteDatabase(SA);return new Pi(n).toPromise()}function r_(){let n=indexedDB.open(SA,kj);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Bd,{keyPath:AA})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Bd)?e(r):(r.close(),yield Oj(),e(yield r_()))}))})}function YS(n,e,t){return y(this,null,function*(){let r=zd(n,!0).put({[AA]:e,value:t});return new Pi(r).toPromise()})}function Fj(n,e){return y(this,null,function*(){let t=zd(n,!1).get(e),r=yield new Pi(t).toPromise();return r===void 0?null:r.value})}function ZS(n,e){let t=zd(n,!0).delete(e);return new Pi(t).toPromise()}var Lj=800,Vj=3,Uj=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield r_(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Vj)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return DA()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=Rj._getInstance(xj()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Pj(),!this.activeServiceWorker)return;this.sender=new n_(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Mj()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield r_();return yield YS(t,Ud,"1"),yield ZS(t,Ud),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>YS(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>Fj(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>ZS(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let o=zd(s,!1).getAll();return new Pi(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),Lj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),RA=Uj;var E7=wA("rcb"),T7=new Ni(3e4,6e4);function jj(n,e){return e?cr(e):(ee(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var mc=class extends Ld{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return zm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return zm(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Bj(n){return Tj(n.auth,new mc(n),n.bypassAuthState)}function $j(n){let{auth:e,user:t}=n;return ee(t,e,"internal-error"),Ej(t,new mc(n),n.bypassAuthState)}function Hj(n){return y(this,null,function*(){let{auth:e,user:t}=n;return ee(t,e,"internal-error"),wj(t,new mc(n),n.bypassAuthState)})}var i_=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bj;case"linkViaPopup":case"linkViaRedirect":return Hj;case"reauthViaPopup":case"reauthViaRedirect":return $j;default:qr(this.auth,"internal-error")}}resolve(e){zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var C7=new Ni(2e3,1e4);var qj="pendingRedirect",Nd=new Map,s_=class n extends i_{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Nd.get(this.auth._key());if(!e){try{let r=(yield zj(this.resolver,this.auth))?yield Dr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Nd.set(this.auth._key(),e)}return this.bypassAuthState||Nd.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Dr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Dr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function zj(n,e){return y(this,null,function*(){let t=Kj(e),r=Wj(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Gj(n,e){Nd.set(n._key(),e)}function Wj(n){return cr(n._redirectPersistence)}function Kj(n){return Rd(qj,n.config.apiKey,n.name)}function Qj(n,e,t=!1){return y(this,null,function*(){if(Zn(n.app))return Promise.reject(Ai(n));let r=m_(n),i=jj(r,e),o=yield new s_(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var Yj=10*60*1e3,o_=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Zj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!NA(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ri(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Yj&&this.cachedEventUids.clear(),this.cachedEventUids.has(JS(e))}saveEventToCache(e){this.cachedEventUids.add(JS(e)),this.lastProcessedEventTime=Date.now()}};function JS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function NA({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Zj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NA(n);default:return!1}}function Jj(t){return y(this,arguments,function*(n,e={}){return ro(n,"GET","/v1/projects",e)})}var Xj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eB=/^https?/;function tB(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Jj(n);for(let t of e)try{if(nB(t))return}catch{}qr(n,"unauthorized-domain")})}function nB(n){let e=Wm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!eB.test(t))return!1;if(Xj.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var rB=new Ni(3e4,6e4);function XS(){let n=Vn().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function iB(n){return new Promise((e,t)=>{var r,i,s;function o(){XS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XS(),t(Ri(n,"network-request-failed"))},timeout:rB.get()})}if(!((i=(r=Vn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Vn().gapi)===null||s===void 0)&&s.load)o();else{let a=wA("iframefcb");return Vn()[a]=()=>{gapi.load?o():t(Ri(n,"network-request-failed"))},mj(`${_j()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Pd=null,e})}var Pd=null;function sB(n){return Pd=Pd||iB(n),Pd}var oB=new Ni(5e3,15e3),aB="__/auth/iframe",cB="emulator/auth/iframe",uB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dB(n){let e=n.config;ee(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?l_(e,cB):`https://${n.config.authDomain}/${aB}`,r={apiKey:e.apiKey,appName:n.name,v:Ot},i=lB.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${ai(r).slice(1)}`}function hB(n){return y(this,null,function*(){let e=yield sB(n),t=Vn().gapi;return ee(t,n,"internal-error"),e.open({where:document.body,url:dB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uB,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Ri(n,"network-request-failed"),a=Vn().setTimeout(()=>{s(o)},oB.get());function c(){Vn().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var fB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pB=500,gB=600,mB="_blank",_B="http://localhost",$d=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function yB(n,e,t,r=pB,i=gB){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},fB),{width:r.toString(),height:i.toString(),top:s,left:o}),l=yt().toLowerCase();t&&(a=pA(l)?mB:t),hA(l)&&(e=e||_B,c.scrollbars="yes");let d=Object.entries(c).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(dj(l)&&a!=="_self")return vB(e||"",a),new $d(null);let p=window.open(e||"",a,d);ee(p,n,"popup-blocked");try{p.focus()}catch{}return new $d(p)}function vB(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var IB="__/auth/handler",wB="emulator/auth/handler",EB=encodeURIComponent("fac");function eA(n,e,t,r,i,s){return y(this,null,function*(){ee(n.config.authDomain,n,"auth-domain-config-required"),ee(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ot,eventId:i};if(e instanceof Vd){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",pa(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof e_){let d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${EB}=${encodeURIComponent(c)}`:"";return`${TB(n)}?${ai(a).slice(1)}${l}`})}function TB({config:n}){return n.emulator?l_(n,wB):`https://${n.authDomain}/${IB}`}var Gm="webStorageSupport",a_=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=w_,this._completeRedirectFn=Qj,this._overrideRedirectResult=Gj}_openPopup(e,t,r,i){return y(this,null,function*(){var s;zr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield eA(e,t,r,Wm(),i);return yB(e,o,bA())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield eA(e,t,r,Wm(),i);return Nj(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(zr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield hB(e),r=new o_(e);return t.register("authEvent",i=>(ee(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Gm,{type:Gm},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Gm];o!==void 0&&t(!!o),qr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return vA()||fA()||g_()}},PA=a_;var tA="@firebase/auth",nA="1.7.9";var c_=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function CB(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bB(n){We(new Ge("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IA(n)},l=new Xm(r,i,s,c);return yj(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),We(new Ge("auth-internal",e=>{let t=m_(e.getProvider("auth").getImmediate());return(r=>new c_(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),q(tA,nA,CB(n)),q(tA,nA,"esm2017")}var DB=5*60,SB=Hf("authIdTokenMaxAge")||DB,rA=null,AB=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>SB)return;let i=t?.token;rA!==i&&(rA=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function E_(n=Ze()){let e=Ye(n,"auth");if(e.isInitialized())return e.getImmediate();let t=y_(n,{popupRedirectResolver:PA,persistence:[RA,CA,w_]}),r=Hf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=AB(s.toString());I_(t,o,()=>o(t.currentUser)),Hd(t,a=>o(a))}}let i=ZE("auth");return i&&v_(t,`http://${i}`),t}function RB(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}gj({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Ri("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",RB().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bB("Browser");function xA(n){return new le(function(e){var t=qd(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var kA="auth",Mi=class{constructor(e){return e}},_n=class{constructor(){return Qe(kA)}};var T_=new j("angularfire2.auth-instances");function w2(n,e){let t=Xe(kA,n,e);return t&&new Mi(t)}function E2(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Mi(r)}}var T2={provide:_n,deps:[[new X,T_]]},C2={provide:Mi,useFactory:w2,deps:[[new X,T_],Oe]};function OA(n,...e){return q("angularfire",ke.full,"auth"),Me([C2,T2,{provide:T_,useFactory:E2(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,Vt],...e]}])}var FA=Ie(xA,!0);var LA=Ie(E_,!0);var Gd="analytics",D2="firebase_id",S2="origin",A2=60*1e3,R2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",N_="https://www.googletagmanager.com/gtag/js";var Mt=new Sn("@firebase/analytics");var N2={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Qt=new bn("analytics","Analytics",N2);function P2(n){if(!n.startsWith(N_)){let e=Qt.create("invalid-gtag-resource",{gtagURL:n});return Mt.warn(e.message),""}return n}function qA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function M2(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function x2(n,e){let t=M2("firebase-js-sdk-policy",{createScriptURL:P2}),r=document.createElement("script"),i=`${N_}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function k2(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function O2(n,e,t,r,i,s){return y(this,null,function*(){let o=r[i];try{if(o)yield e[o];else{let c=(yield qA(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){Mt.error(a)}n("config",i,s)})}function F2(n,e,t,r,i){return y(this,null,function*(){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);let a=yield qA(t);for(let c of o){let l=a.find(p=>p.measurementId===c),d=l&&e[l.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),n("event",r,i||{})}catch(s){Mt.error(s)}})}function L2(n,e,t,r){function i(s,...o){return y(this,null,function*(){try{if(s==="event"){let[a,c]=o;yield F2(n,e,t,a,c)}else if(s==="config"){let[a,c]=o;yield O2(n,e,t,r,a,c)}else if(s==="consent"){let[a,c]=o;n("consent",a,c)}else if(s==="get"){let[a,c,l]=o;n("get",a,c,l)}else if(s==="set"){let[a]=o;n("set",a)}else n(s,...o)}catch(a){Mt.error(a)}})}return i}function V2(n,e,t,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=L2(s,n,e,t),{gtagCore:s,wrappedGtag:window[i]}}function U2(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(N_)&&t.src.includes(n))return t;return null}var j2=30,B2=1e3,b_=class{constructor(e={},t=B2){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},zA=new b_;function $2(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function H2(n){return y(this,null,function*(){var e;let{appId:t,apiKey:r}=n,i={method:"GET",headers:$2(r)},s=R2.replace("{app-id}",t),o=yield fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{let c=yield o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Qt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()})}function q2(r){return y(this,arguments,function*(n,e=zA,t){let{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw Qt.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw Qt.create("no-api-key")}let a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new D_;return setTimeout(()=>y(this,null,function*(){c.abort()}),t!==void 0?t:A2),GA({appId:i,apiKey:s,measurementId:o},a,c,e)})}function GA(s,o,a){return y(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=zA){var c;let{appId:l,measurementId:d}=n;try{yield z2(r,e)}catch(p){if(d)return Mt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:l,measurementId:d};throw p}try{let p=yield H2(n);return i.deleteThrottleMetadata(l),p}catch(p){let g=p;if(!G2(g)){if(i.deleteThrottleMetadata(l),d)return Mt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:l,measurementId:d};throw p}let _=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?ya(t,i.intervalMillis,j2):ya(t,i.intervalMillis),E={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return i.setThrottleMetadata(l,E),Mt.debug(`Calling attemptFetch again in ${_} millis`),GA(n,E,r,i)}})}function z2(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(Qt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function G2(n){if(!(n instanceof kt)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var D_=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var S_;function W2(n,e,t,r,i){return y(this,null,function*(){if(i&&i.global){n("event",t,r);return}else{let s=yield e,o=Object.assign(Object.assign({},r),{send_to:s});n("event",t,o)}})}function K2(n,e,t,r){return y(this,null,function*(){if(r&&r.global)return n("set",{user_id:t}),Promise.resolve();{let i=yield e;n("config",i,{update:!0,user_id:t})}})}var A_;function Q2(n){A_=n}function Y2(n){S_=n}function Z2(){return y(this,null,function*(){if(Yn())try{yield si()}catch(n){return Mt.warn(Qt.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Mt.warn(Qt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function J2(n,e,t,r,i,s,o){return y(this,null,function*(){var a;let c=q2(n);c.then(_=>{t[_.measurementId]=_.appId,n.options.measurementId&&_.measurementId!==n.options.measurementId&&Mt.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${_.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(_=>Mt.error(_)),e.push(c);let l=Z2().then(_=>{if(_)return r.getId()}),[d,p]=yield Promise.all([c,l]);U2(s)||x2(s,d.measurementId),A_&&(i("consent","default",A_),Q2(void 0)),i("js",new Date);let g=(a=o?.config)!==null&&a!==void 0?a:{};return g[S2]="firebase",g.update=!0,p!=null&&(g[D2]=p),i("config",d.measurementId,g),S_&&(i("set",S_),Y2(void 0)),d.measurementId})}var R_=class{constructor(e){this.app=e}_delete(){return delete io[this.app.options.appId],Promise.resolve()}},io={},VA=[],UA={},C_="dataLayer",X2="gtag",jA,P_,BA=!1;function e$(){let n=[];if(ha()&&n.push("This is a browser extension environment."),fa()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Qt.create("invalid-analytics-context",{errorInfo:e});Mt.warn(t.message)}}function t$(n,e,t){e$();let r=n.options.appId;if(!r)throw Qt.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Mt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Qt.create("no-api-key");if(io[r]!=null)throw Qt.create("already-exists",{id:r});if(!BA){k2(C_);let{wrappedGtag:s,gtagCore:o}=V2(io,VA,UA,C_,X2);P_=s,jA=o,BA=!0}return io[r]=J2(n,VA,UA,e,jA,C_,t),new R_(n)}function WA(n=Ze()){n=fe(n);let e=Ye(n,Gd);return e.isInitialized()?e.getImmediate():KA(n)}function KA(n,e={}){let t=Ye(n,Gd);if(t.isInitialized()){let i=t.getImmediate();if(ma(e,t.getOptions()))return i;throw Qt.create("already-initialized")}return t.initialize({options:e})}function QA(){return y(this,null,function*(){if(ha()||!fa()||!Yn())return!1;try{return yield si()}catch{return!1}})}function YA(n,e,t){n=fe(n),K2(P_,io[n.app.options.appId],e,t).catch(r=>Mt.error(r))}function M_(n,e,t,r){n=fe(n),W2(P_,io[n.app.options.appId],e,t,r).catch(i=>Mt.error(i))}var $A="@firebase/analytics",HA="0.10.8";function n$(){We(new Ge(Gd,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return t$(r,i,t)},"PUBLIC")),We(new Ge("analytics-internal",n,"PRIVATE")),q($A,HA),q($A,HA,"esm2017");function n(e){try{let t=e.getProvider(Gd).getImmediate();return{logEvent:(r,i,s)=>M_(t,r,i,s)}}catch(t){throw Qt.create("interop-component-reg-failed",{reason:t})}}}n$();var xi=class{constructor(e){return e}},XA="analytics",k_=class{constructor(){return Qe(XA)}};var O_="__angularfire_symbol__analyticsIsSupportedValue",e0="__angularfire_symbol__analyticsIsSupported";globalThis[e0]||=QA().then(n=>globalThis[O_]=n).catch(()=>globalThis[O_]=!1);var Wd={async:()=>globalThis[e0],sync:()=>{let n=globalThis[O_];if(n===void 0)throw new Error(to("Analytics"));return n}},t0=Wd.async,n0=Ie(WA,!0);var r$=Ie(M_,!0);var i$=Ie(YA,!0);var L_=(()=>{class n{initialized;disposables=[];constructor(t,r,i){q("angularfire",ke.full,"user-tracking");let s;this.initialized=r.runOutsideAngular(()=>new Promise(o=>{s=o})),t0().then(()=>{let o=i.get(xi);o?this.disposables=[FA(t).subscribe(a=>{i$(o,a?.uid),s()})]:s()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(r){return new(r||n)(Y(Mi),Y(Q),Y(Ee))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),s$="firebase_event_origin",o$="firebase_previous_class",a$="firebase_previous_id",c$="firebase_previous_screen",u$="firebase_screen_class",ZA="firebase_screen_id",l$="firebase_screen",F_="outlet",d$="page_path",h$="page_title",_c="screen_class",JA="screen_name",f$="screen_view",p$="auto",g$="#",m$=Math.floor(Math.random()*(2**32-1))-2**31,x_={},_$=n=>{let e=[n[_c],n[F_]].join(g$);if(x_.hasOwnProperty(e))return x_[e];{let t=m$++;return x_[e]=t,t}},y$=(n,e,t)=>n.events.pipe(Rt(i=>i instanceof nc)).pipe(Lt(i=>{let o=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,g=>g.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",a=n.routerState.root.children.map(g=>g).find(g=>g.outlet===i.snapshot.outlet);if(!a)return W(null);let c=a;for(;c.firstChild;)c=c.firstChild;let l=c.pathFromRoot.map(g=>g.routeConfig?.path).filter(g=>g).join("/")||"/",d={[JA]:l,[d$]:`/${o}`,[s$]:p$,[l$]:l,[F_]:i.snapshot.outlet};e&&(d[h$]=e.getTitle());let p=a.component;if(p){if(p===Vm){let g=i.snapshot;for(;g.firstChild;)g=g.firstChild;p=g.component}}else p=i.snapshot.component;if(typeof p=="string")return W(Pe(U({},d),{[_c]:p}));if(p){let g=t.resolveComponentFactory(p);return W(Pe(U({},d),{[_c]:g.selector}))}return W(null)}),Rt(i=>!!i),te(i=>U({[u$]:i[_c],[ZA]:_$(i)},i)),lp(i=>i[F_]),Ke(i=>i.pipe(al((s,o)=>JSON.stringify(s)===JSON.stringify(o)),Is(void 0),ul(),te(([s,o])=>s?U({[o$]:s[_c],[c$]:s[JA],[a$]:s[ZA]},o):o)))),r0=(()=>{class n{disposable;constructor(t,r,i,s,o,a){q("angularfire",ke.full,"screen-tracking"),t0().then(()=>{let c=a.get(xi);!t||!c||s.runOutsideAngular(()=>{this.disposable=y$(t,r,i).pipe(Lt(l=>y(this,null,function*(){return o&&(yield o.initialized),r$(c,f$,l)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||n)(Y(Cd,8),Y(ad,8),Y(Fr),Y(Q),Y(L_,8),Y(Ee))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),V_=new j("angularfire2.analytics-instances");function v$(n,e){if(!Wd.sync())return null;let t=Xe(XA,n,e);return t&&new xi(t)}function I$(n){return(e,t)=>{if(!Wd.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new xi(r)}}var w$={provide:k_,deps:[[new X,V_]]},E$={provide:xi,useFactory:v$,deps:[[new X,V_],Oe]};function i0(n,...e){return q("angularfire",ke.full,"analytics"),Me([E$,w$,{provide:Br,useValue:Wd.async,multi:!0},{provide:V_,useFactory:I$(n),multi:!0,deps:[Q,Ee,qe,Ve,...e]}])}var s0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o0={};var Gr,U_;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,b,S){for(var w=Array(arguments.length-2),Wn=2;Wn<arguments.length;Wn++)w[Wn-2]=arguments[Wn];return v.prototype[b].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var C=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)C[b]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(b=0;16>b;++b)C[b]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],b=T.g[2];var S=T.g[3],w=v+(S^I&(b^S))+C[0]+3614090360&4294967295;v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[1]+3905402710&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[2]+606105819&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[3]+3250441966&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[4]+4118548399&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[5]+1200080426&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[6]+2821735955&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[7]+4249261313&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[8]+1770035416&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[9]+2336552879&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[10]+4294925233&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[11]+2304563134&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[12]+1804603682&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[13]+4254626195&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[14]+2792965006&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[15]+1236535329&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(b^S&(I^b))+C[1]+4129170786&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[6]+3225465664&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[11]+643717713&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[0]+3921069994&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[5]+3593408605&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[10]+38016083&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[15]+3634488961&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[4]+3889429448&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[9]+568446438&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[14]+3275163606&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[3]+4107603335&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[8]+1163531501&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[13]+2850285829&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[2]+4243563512&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[7]+1735328473&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[12]+2368359562&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(I^b^S)+C[5]+4294588738&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[8]+2272392833&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[11]+1839030562&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[14]+4259657740&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[1]+2763975236&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[4]+1272893353&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[7]+4139469664&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[10]+3200236656&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[13]+681279174&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[0]+3936430074&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[3]+3572445317&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[6]+76029189&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[9]+3654602809&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[12]+3873151461&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[15]+530742520&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[2]+3299628645&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(b^(I|~S))+C[0]+4096336452&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[7]+1126891415&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[14]+2878612391&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[5]+4237533241&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[12]+1700485571&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[3]+2399980690&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[10]+4293915773&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[1]+2240044497&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[8]+1873313359&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[15]+4264355552&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[6]+2734768916&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[13]+1309151649&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[4]+4149444226&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[11]+3174756917&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[2]+718787259&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+S&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,C=this.B,b=this.h,S=0;S<v;){if(b==0)for(;S<=I;)i(this,T,S),S+=this.blockSize;if(typeof T=="string"){for(;S<v;)if(C[b++]=T.charCodeAt(S++),b==this.blockSize){i(this,C),b=0;break}}else for(;S<v;)if(C[b++]=T[S++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var C=0;32>C;C+=8)T[I++]=this.g[v]>>>C&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],C=!0,b=T.length-1;0<=b;b--){var S=T[b]|0;C&&S==v||(I[b]=S,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return A(l(-T));for(var v=[],I=1,C=0;T>=I;C++)v[C]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return A(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),C=p,b=0;b<T.length;b+=8){var S=Math.min(8,T.length-b),w=parseInt(T.substring(b,b+S),v);8>S?(S=l(Math.pow(v,S)),C=C.j(S).add(l(w))):(C=C.j(I),C=C.add(l(w)))}return C}var p=c(0),g=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(N(this))return-A(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(E(this))return"0";if(N(this))return"-"+A(this).toString(T);for(var v=l(Math.pow(T,6)),I=this,C="";;){var b=G(I,v).g;I=M(I,b.j(v));var S=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=b,E(I))return S+C;for(;6>S.length;)S="0"+S;C=S+C}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function E(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function N(T){return T.h==-1}n.l=function(T){return T=M(this,T),N(T)?-1:E(T)?0:1};function A(T){for(var v=T.g.length,I=[],C=0;C<v;C++)I[C]=~T.g[C];return new o(I,~T.h).add(g)}n.abs=function(){return N(this)?A(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0,b=0;b<=v;b++){var S=C+(this.i(b)&65535)+(T.i(b)&65535),w=(S>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);C=w>>>16,S&=65535,w&=65535,I[b]=w<<16|S}return new o(I,I[I.length-1]&-2147483648?-1:0)};function M(T,v){return T.add(A(v))}n.j=function(T){if(E(this)||E(T))return p;if(N(this))return N(T)?A(this).j(A(T)):A(A(this).j(T));if(N(T))return A(this.j(A(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],C=0;C<2*v;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<T.g.length;b++){var S=this.i(C)>>>16,w=this.i(C)&65535,Wn=T.i(b)>>>16,Go=T.i(b)&65535;I[2*C+2*b]+=w*Go,L(I,2*C+2*b),I[2*C+2*b+1]+=S*Go,L(I,2*C+2*b+1),I[2*C+2*b+1]+=w*Wn,L(I,2*C+2*b+1),I[2*C+2*b+2]+=S*Wn,L(I,2*C+2*b+2)}for(C=0;C<v;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=v;C<2*v;C++)I[C]=0;return new o(I,0)};function L(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function $(T,v){this.g=T,this.h=v}function G(T,v){if(E(v))throw Error("division by zero");if(E(T))return new $(p,p);if(N(T))return v=G(A(T),v),new $(A(v.g),A(v.h));if(N(v))return v=G(T,A(v)),new $(A(v.g),v.h);if(30<T.g.length){if(N(T)||N(v))throw Error("slowDivide_ only works with positive integers.");for(var I=g,C=v;0>=C.l(T);)I=Se(I),C=Se(C);var b=K(I,1),S=K(C,1);for(C=K(C,2),I=K(I,2);!E(C);){var w=S.add(C);0>=w.l(T)&&(b=b.add(I),S=w),C=K(C,1),I=K(I,1)}return v=M(T,b.j(v)),new $(b,v)}for(b=p;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),S=l(I),w=S.j(v);N(w)||0<w.l(T);)I-=C,S=l(I),w=S.j(v);E(S)&&(S=g),b=b.add(S),T=M(T,w)}return new $(b,T)}n.A=function(T){return G(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function Se(T){for(var v=T.g.length+1,I=[],C=0;C<v;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function K(T,v){var I=v>>5;v%=32;for(var C=T.g.length-I,b=[],S=0;S<C;S++)b[S]=0<v?T.i(S+I)>>>v|T.i(S+I+1)<<32-v:T.i(S+I);return new o(b,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,U_=o0.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Gr=o0.Integer=o}).apply(typeof s0<"u"?s0:typeof self<"u"?self:typeof window<"u"?window:{});var Kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ur={};var j_,T$,so,B_,yc,Qd,$_,H_,q_;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,f){return u==Array.prototype||u==Object.prototype||(u[h]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kd=="object"&&Kd];for(var h=0;h<u.length;++h){var f=u[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,h){if(h)e:{var f=r;u=u.split(".");for(var m=0;m<u.length-1;m++){var D=u[m];if(!(D in f))break e;f=f[D]}u=u[u.length-1],m=f[u],h=h(m),h!=m&&h!=null&&e(f,u,{configurable:!0,writable:!0,value:h})}}function s(u,h){u instanceof String&&(u+="");var f=0,m=!1,D={next:function(){if(!m&&f<u.length){var R=f++;return{value:h(R,u[R]),done:!1}}return m=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(u){return u||function(){return s(this,function(h,f){return f})}});var o=o||{},a=this||self;function c(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function l(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,f){return u.call.apply(u.bind,arguments)}function p(u,h,f){if(!u)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,m),u.apply(h,D)}}return function(){return u.apply(h,arguments)}}function g(u,h,f){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,g.apply(null,arguments)}function _(u,h){var f=Array.prototype.slice.call(arguments,1);return function(){var m=f.slice();return m.push.apply(m,arguments),u.apply(this,m)}}function E(u,h){function f(){}f.prototype=h.prototype,u.aa=h.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(m,D,R){for(var k=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)k[Ae-2]=arguments[Ae];return h.prototype[D].apply(m,k)}}function N(u){let h=u.length;if(0<h){let f=Array(h);for(let m=0;m<h;m++)f[m]=u[m];return f}return[]}function A(u,h){for(let f=1;f<arguments.length;f++){let m=arguments[f];if(c(m)){let D=u.length||0,R=m.length||0;u.length=D+R;for(let k=0;k<R;k++)u[D+k]=m[k]}else u.push(m)}}class M{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function L(u){return/^[\s\xa0]*$/.test(u)}function $(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function G(u){return G[" "](u),u}G[" "]=function(){};var Se=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function K(u,h,f){for(let m in u)h.call(f,u[m],m,u)}function T(u,h){for(let f in u)h.call(void 0,u[f],f,u)}function v(u){let h={};for(let f in u)h[f]=u[f];return h}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,h){let f,m;for(let D=1;D<arguments.length;D++){m=arguments[D];for(f in m)u[f]=m[f];for(let R=0;R<I.length;R++)f=I[R],Object.prototype.hasOwnProperty.call(m,f)&&(u[f]=m[f])}}function b(u){var h=1;u=u.split(":");let f=[];for(;0<h&&u.length;)f.push(u.shift()),h--;return u.length&&f.push(u.join(":")),f}function S(u){a.setTimeout(()=>{throw u},0)}function w(){var u=yf;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class Wn{constructor(){this.h=this.g=null}add(h,f){let m=Go.get();m.set(h,f),this.h?this.h.next=m:this.g=m,this.h=m}}var Go=new M(()=>new sx,u=>u.reset());class sx{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Wo,Ko=!1,yf=new Wn,Gw=()=>{let u=a.Promise.resolve(void 0);Wo=()=>{u.then(ox)}};var ox=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(f){S(f)}var h=Go;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}Ko=!1};function Er(){this.s=this.s,this.C=this.C}Er.prototype.s=!1,Er.prototype.ma=function(){this.s||(this.s=!0,this.N())},Er.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pt(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}pt.prototype.h=function(){this.defaultPrevented=!0};var ax=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,h),a.removeEventListener("test",f,h)}catch{}return u}();function Qo(u,h){if(pt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,m=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(Se){e:{try{G(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else f=="mouseover"?h=u.fromElement:f=="mouseout"&&(h=u.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:cx[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Qo.aa.h.call(this)}}E(Qo,pt);var cx={2:"touch",3:"pen",4:"mouse"};Qo.prototype.h=function(){Qo.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Yo="closure_listenable_"+(1e6*Math.random()|0),ux=0;function lx(u,h,f,m,D){this.listener=u,this.proxy=null,this.src=h,this.type=f,this.capture=!!m,this.ha=D,this.key=++ux,this.da=this.fa=!1}function pu(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function gu(u){this.src=u,this.g={},this.h=0}gu.prototype.add=function(u,h,f,m,D){var R=u.toString();u=this.g[R],u||(u=this.g[R]=[],this.h++);var k=If(u,h,m,D);return-1<k?(h=u[k],f||(h.fa=!1)):(h=new lx(h,this.src,R,!!m,D),h.fa=f,u.push(h)),h};function vf(u,h){var f=h.type;if(f in u.g){var m=u.g[f],D=Array.prototype.indexOf.call(m,h,void 0),R;(R=0<=D)&&Array.prototype.splice.call(m,D,1),R&&(pu(h),u.g[f].length==0&&(delete u.g[f],u.h--))}}function If(u,h,f,m){for(var D=0;D<u.length;++D){var R=u[D];if(!R.da&&R.listener==h&&R.capture==!!f&&R.ha==m)return D}return-1}var wf="closure_lm_"+(1e6*Math.random()|0),Ef={};function Ww(u,h,f,m,D){if(m&&m.once)return Qw(u,h,f,m,D);if(Array.isArray(h)){for(var R=0;R<h.length;R++)Ww(u,h[R],f,m,D);return null}return f=Df(f),u&&u[Yo]?u.K(h,f,l(m)?!!m.capture:!!m,D):Kw(u,h,f,!1,m,D)}function Kw(u,h,f,m,D,R){if(!h)throw Error("Invalid event type");var k=l(D)?!!D.capture:!!D,Ae=Cf(u);if(Ae||(u[wf]=Ae=new gu(u)),f=Ae.add(h,f,m,k,R),f.proxy)return f;if(m=dx(),f.proxy=m,m.src=u,m.listener=f,u.addEventListener)ax||(D=k),D===void 0&&(D=!1),u.addEventListener(h.toString(),m,D);else if(u.attachEvent)u.attachEvent(Zw(h.toString()),m);else if(u.addListener&&u.removeListener)u.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return f}function dx(){function u(f){return h.call(u.src,u.listener,f)}let h=hx;return u}function Qw(u,h,f,m,D){if(Array.isArray(h)){for(var R=0;R<h.length;R++)Qw(u,h[R],f,m,D);return null}return f=Df(f),u&&u[Yo]?u.L(h,f,l(m)?!!m.capture:!!m,D):Kw(u,h,f,!0,m,D)}function Yw(u,h,f,m,D){if(Array.isArray(h))for(var R=0;R<h.length;R++)Yw(u,h[R],f,m,D);else m=l(m)?!!m.capture:!!m,f=Df(f),u&&u[Yo]?(u=u.i,h=String(h).toString(),h in u.g&&(R=u.g[h],f=If(R,f,m,D),-1<f&&(pu(R[f]),Array.prototype.splice.call(R,f,1),R.length==0&&(delete u.g[h],u.h--)))):u&&(u=Cf(u))&&(h=u.g[h.toString()],u=-1,h&&(u=If(h,f,m,D)),(f=-1<u?h[u]:null)&&Tf(f))}function Tf(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[Yo])vf(h.i,u);else{var f=u.type,m=u.proxy;h.removeEventListener?h.removeEventListener(f,m,u.capture):h.detachEvent?h.detachEvent(Zw(f),m):h.addListener&&h.removeListener&&h.removeListener(m),(f=Cf(h))?(vf(f,u),f.h==0&&(f.src=null,h[wf]=null)):pu(u)}}}function Zw(u){return u in Ef?Ef[u]:Ef[u]="on"+u}function hx(u,h){if(u.da)u=!0;else{h=new Qo(h,this);var f=u.listener,m=u.ha||u.src;u.fa&&Tf(u),u=f.call(m,h)}return u}function Cf(u){return u=u[wf],u instanceof gu?u:null}var bf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Df(u){return typeof u=="function"?u:(u[bf]||(u[bf]=function(h){return u.handleEvent(h)}),u[bf])}function gt(){Er.call(this),this.i=new gu(this),this.M=this,this.F=null}E(gt,Er),gt.prototype[Yo]=!0,gt.prototype.removeEventListener=function(u,h,f,m){Yw(this,u,h,f,m)};function Dt(u,h){var f,m=u.F;if(m)for(f=[];m;m=m.F)f.push(m);if(u=u.M,m=h.type||h,typeof h=="string")h=new pt(h,u);else if(h instanceof pt)h.target=h.target||u;else{var D=h;h=new pt(m,u),C(h,D)}if(D=!0,f)for(var R=f.length-1;0<=R;R--){var k=h.g=f[R];D=mu(k,m,!0,h)&&D}if(k=h.g=u,D=mu(k,m,!0,h)&&D,D=mu(k,m,!1,h)&&D,f)for(R=0;R<f.length;R++)k=h.g=f[R],D=mu(k,m,!1,h)&&D}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var f=u.g[h],m=0;m<f.length;m++)pu(f[m]);delete u.g[h],u.h--}}this.F=null},gt.prototype.K=function(u,h,f,m){return this.i.add(String(u),h,!1,f,m)},gt.prototype.L=function(u,h,f,m){return this.i.add(String(u),h,!0,f,m)};function mu(u,h,f,m){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,R=0;R<h.length;++R){var k=h[R];if(k&&!k.da&&k.capture==f){var Ae=k.listener,lt=k.ha||k.src;k.fa&&vf(u.i,k),D=Ae.call(lt,m)!==!1&&D}}return D&&!m.defaultPrevented}function Jw(u,h,f){if(typeof u=="function")f&&(u=g(u,f));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function Xw(u){u.g=Jw(()=>{u.g=null,u.i&&(u.i=!1,Xw(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class fx extends Er{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Xw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zo(u){Er.call(this),this.h=u,this.g={}}E(Zo,Er);var eE=[];function tE(u){K(u.g,function(h,f){this.g.hasOwnProperty(f)&&Tf(h)},u),u.g={}}Zo.prototype.N=function(){Zo.aa.N.call(this),tE(this)},Zo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Sf=a.JSON.stringify,px=a.JSON.parse,gx=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Af(){}Af.prototype.h=null;function nE(u){return u.h||(u.h=u.i())}function rE(){}var Jo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rf(){pt.call(this,"d")}E(Rf,pt);function Nf(){pt.call(this,"c")}E(Nf,pt);var ti={},iE=null;function _u(){return iE=iE||new gt}ti.La="serverreachability";function sE(u){pt.call(this,ti.La,u)}E(sE,pt);function Xo(u){let h=_u();Dt(h,new sE(h))}ti.STAT_EVENT="statevent";function oE(u,h){pt.call(this,ti.STAT_EVENT,u),this.stat=h}E(oE,pt);function St(u){let h=_u();Dt(h,new oE(h,u))}ti.Ma="timingevent";function aE(u,h){pt.call(this,ti.Ma,u),this.size=h}E(aE,pt);function ea(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function ta(){this.g=!0}ta.prototype.xa=function(){this.g=!1};function mx(u,h,f,m,D,R){u.info(function(){if(u.g)if(R)for(var k="",Ae=R.split("&"),lt=0;lt<Ae.length;lt++){var we=Ae[lt].split("=");if(1<we.length){var mt=we[0];we=we[1];var _t=mt.split("_");k=2<=_t.length&&_t[1]=="type"?k+(mt+"="+we+"&"):k+(mt+"=redacted&")}}else k=null;else k=R;return"XMLHTTP REQ ("+m+") [attempt "+D+"]: "+h+`
`+f+`
`+k})}function _x(u,h,f,m,D,R,k){u.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+D+"]: "+h+`
`+f+`
`+R+" "+k})}function es(u,h,f,m){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+vx(u,f)+(m?" "+m:"")})}function yx(u,h){u.info(function(){return"TIMEOUT: "+h})}ta.prototype.info=function(){};function vx(u,h){if(!u.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var m=f[u];if(!(2>m.length)){var D=m[1];if(Array.isArray(D)&&!(1>D.length)){var R=D[0];if(R!="noop"&&R!="stop"&&R!="close")for(var k=1;k<D.length;k++)D[k]=""}}}}return Sf(f)}catch{return h}}var yu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cE={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pf;function vu(){}E(vu,Af),vu.prototype.g=function(){return new XMLHttpRequest},vu.prototype.i=function(){return{}},Pf=new vu;function Tr(u,h,f,m){this.j=u,this.i=h,this.l=f,this.R=m||1,this.U=new Zo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new uE}function uE(){this.i=null,this.g="",this.h=!1}var lE={},Mf={};function xf(u,h,f){u.L=1,u.v=Tu(Kn(h)),u.m=f,u.P=!0,dE(u,null)}function dE(u,h){u.F=Date.now(),Iu(u),u.A=Kn(u.v);var f=u.A,m=u.R;Array.isArray(m)||(m=[String(m)]),bE(f.i,"t",m),u.C=0,f=u.j.J,u.h=new uE,u.g=HE(u.j,f?h:null,!u.m),0<u.O&&(u.M=new fx(g(u.Y,u,u.g),u.O)),h=u.U,f=u.g,m=u.ca;var D="readystatechange";Array.isArray(D)||(D&&(eE[0]=D.toString()),D=eE);for(var R=0;R<D.length;R++){var k=Ww(f,D[R],m||h.handleEvent,!1,h.h||h);if(!k)break;h.g[k.key]=k}h=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),Xo(),mx(u.i,u.u,u.A,u.l,u.R,u.m)}Tr.prototype.ca=function(u){u=u.target;let h=this.M;h&&Qn(u)==3?h.j():this.Y(u)},Tr.prototype.Y=function(u){try{if(u==this.g)e:{let _t=Qn(this.g);var h=this.g.Ba();let rs=this.g.Z();if(!(3>_t)&&(_t!=3||this.g&&(this.h.h||this.g.oa()||ME(this.g)))){this.J||_t!=4||h==7||(h==8||0>=rs?Xo(3):Xo(2)),kf(this);var f=this.g.Z();this.X=f;t:if(hE(this)){var m=ME(this.g);u="";var D=m.length,R=Qn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ni(this),na(this);var k="";break t}this.h.i=new a.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,u+=this.h.i.decode(m[h],{stream:!(R&&h==D-1)});m.length=0,this.h.g+=u,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=f==200,_x(this.i,this.u,this.A,this.l,this.R,_t,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,lt=this.g;if((Ae=lt.g?lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(Ae)){var we=Ae;break t}}we=null}if(f=we)es(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Of(this,f);else{this.o=!1,this.s=3,St(12),ni(this),na(this);break e}}if(this.P){f=!0;let un;for(;!this.J&&this.C<k.length;)if(un=Ix(this,k),un==Mf){_t==4&&(this.s=4,St(14),f=!1),es(this.i,this.l,null,"[Incomplete Response]");break}else if(un==lE){this.s=4,St(15),es(this.i,this.l,k,"[Invalid Chunk]"),f=!1;break}else es(this.i,this.l,un,null),Of(this,un);if(hE(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_t!=4||k.length!=0||this.h.h||(this.s=1,St(16),f=!1),this.o=this.o&&f,!f)es(this.i,this.l,k,"[Invalid Chunked Response]"),ni(this),na(this);else if(0<k.length&&!this.W){this.W=!0;var mt=this.j;mt.g==this&&mt.ba&&!mt.M&&(mt.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Bf(mt),mt.M=!0,St(11))}}else es(this.i,this.l,k,null),Of(this,k);_t==4&&ni(this),this.o&&!this.J&&(_t==4?UE(this.j,this):(this.o=!1,Iu(this)))}else Lx(this.g),f==400&&0<k.indexOf("Unknown SID")?(this.s=3,St(12)):(this.s=0,St(13)),ni(this),na(this)}}}catch{}finally{}};function hE(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ix(u,h){var f=u.C,m=h.indexOf(`
`,f);return m==-1?Mf:(f=Number(h.substring(f,m)),isNaN(f)?lE:(m+=1,m+f>h.length?Mf:(h=h.slice(m,m+f),u.C=m+f,h)))}Tr.prototype.cancel=function(){this.J=!0,ni(this)};function Iu(u){u.S=Date.now()+u.I,fE(u,u.I)}function fE(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=ea(g(u.ba,u),h)}function kf(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Tr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(yx(this.i,this.A),this.L!=2&&(Xo(),St(17)),ni(this),this.s=2,na(this)):fE(this,this.S-u)};function na(u){u.j.G==0||u.J||UE(u.j,u)}function ni(u){kf(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,tE(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function Of(u,h){try{var f=u.j;if(f.G!=0&&(f.g==u||Ff(f.h,u))){if(!u.K&&Ff(f.h,u)&&f.G==3){try{var m=f.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var D=m;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Au(f),Du(f);else break e;jf(f),St(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=ea(g(f.Za,f),6e3));if(1>=mE(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ii(f,11)}else if((u.K||f.g==u)&&Au(f),!L(h))for(D=f.Da.g.parse(h),h=0;h<D.length;h++){let we=D[h];if(f.T=we[0],we=we[1],f.G==2)if(we[0]=="c"){f.K=we[1],f.ia=we[2];let mt=we[3];mt!=null&&(f.la=mt,f.j.info("VER="+f.la));let _t=we[4];_t!=null&&(f.Aa=_t,f.j.info("SVER="+f.Aa));let rs=we[5];rs!=null&&typeof rs=="number"&&0<rs&&(m=1.5*rs,f.L=m,f.j.info("backChannelRequestTimeoutMs_="+m)),m=f;let un=u.g;if(un){let Nu=un.g?un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nu){var R=m.h;R.g||Nu.indexOf("spdy")==-1&&Nu.indexOf("quic")==-1&&Nu.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Lf(R,R.h),R.h=null))}if(m.D){let $f=un.g?un.g.getResponseHeader("X-HTTP-Session-Id"):null;$f&&(m.ya=$f,xe(m.I,m.D,$f))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),m=f;var k=u;if(m.qa=$E(m,m.J?m.ia:null,m.W),k.K){_E(m.h,k);var Ae=k,lt=m.L;lt&&(Ae.I=lt),Ae.B&&(kf(Ae),Iu(Ae)),m.g=k}else LE(m);0<f.i.length&&Su(f)}else we[0]!="stop"&&we[0]!="close"||ii(f,7);else f.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?ii(f,7):Uf(f):we[0]!="noop"&&f.l&&f.l.ta(we),f.v=0)}}Xo(4)}catch{}}var wx=class{constructor(u,h){this.g=u,this.map=h}};function pE(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function gE(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function mE(u){return u.h?1:u.g?u.g.size:0}function Ff(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Lf(u,h){u.g?u.g.add(h):u.h=h}function _E(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}pE.prototype.cancel=function(){if(this.i=yE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function yE(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let f of u.g.values())h=h.concat(f.D);return h}return N(u.i)}function Ex(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var h=[],f=u.length,m=0;m<f;m++)h.push(u[m]);return h}h=[],f=0;for(m in u)h[f++]=u[m];return h}function Tx(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var h=[];u=u.length;for(var f=0;f<u;f++)h.push(f);return h}h=[],f=0;for(let m in u)h[f++]=m;return h}}}function vE(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var f=Tx(u),m=Ex(u),D=m.length,R=0;R<D;R++)h.call(void 0,m[R],f&&f[R],u)}var IE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cx(u,h){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var m=u[f].indexOf("="),D=null;if(0<=m){var R=u[f].substring(0,m);D=u[f].substring(m+1)}else R=u[f];h(R,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function ri(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ri){this.h=u.h,wu(this,u.j),this.o=u.o,this.g=u.g,Eu(this,u.s),this.l=u.l;var h=u.i,f=new sa;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),wE(this,f),this.m=u.m}else u&&(h=String(u).match(IE))?(this.h=!1,wu(this,h[1]||"",!0),this.o=ra(h[2]||""),this.g=ra(h[3]||"",!0),Eu(this,h[4]),this.l=ra(h[5]||"",!0),wE(this,h[6]||"",!0),this.m=ra(h[7]||"")):(this.h=!1,this.i=new sa(null,this.h))}ri.prototype.toString=function(){var u=[],h=this.j;h&&u.push(ia(h,EE,!0),":");var f=this.g;return(f||h=="file")&&(u.push("//"),(h=this.o)&&u.push(ia(h,EE,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(ia(f,f.charAt(0)=="/"?Sx:Dx,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",ia(f,Rx)),u.join("")};function Kn(u){return new ri(u)}function wu(u,h,f){u.j=f?ra(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function Eu(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function wE(u,h,f){h instanceof sa?(u.i=h,Nx(u.i,u.h)):(f||(h=ia(h,Ax)),u.i=new sa(h,u.h))}function xe(u,h,f){u.i.set(h,f)}function Tu(u){return xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ra(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function ia(u,h,f){return typeof u=="string"?(u=encodeURI(u).replace(h,bx),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function bx(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var EE=/[#\/\?@]/g,Dx=/[#\?:]/g,Sx=/[#\?]/g,Ax=/[#\?@]/g,Rx=/#/g;function sa(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function Cr(u){u.g||(u.g=new Map,u.h=0,u.i&&Cx(u.i,function(h,f){u.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}n=sa.prototype,n.add=function(u,h){Cr(this),this.i=null,u=ts(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(h),this.h+=1,this};function TE(u,h){Cr(u),h=ts(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function CE(u,h){return Cr(u),h=ts(u,h),u.g.has(h)}n.forEach=function(u,h){Cr(this),this.g.forEach(function(f,m){f.forEach(function(D){u.call(h,D,m,this)},this)},this)},n.na=function(){Cr(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let m=0;m<h.length;m++){let D=u[m];for(let R=0;R<D.length;R++)f.push(h[m])}return f},n.V=function(u){Cr(this);let h=[];if(typeof u=="string")CE(this,u)&&(h=h.concat(this.g.get(ts(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)h=h.concat(u[f])}return h},n.set=function(u,h){return Cr(this),this.i=null,u=ts(this,u),CE(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},n.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function bE(u,h,f){TE(u,h),0<f.length&&(u.i=null,u.g.set(ts(u,h),N(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var m=h[f];let R=encodeURIComponent(String(m)),k=this.V(m);for(m=0;m<k.length;m++){var D=R;k[m]!==""&&(D+="="+encodeURIComponent(String(k[m]))),u.push(D)}}return this.i=u.join("&")};function ts(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function Nx(u,h){h&&!u.j&&(Cr(u),u.i=null,u.g.forEach(function(f,m){var D=m.toLowerCase();m!=D&&(TE(this,m),bE(this,D,f))},u)),u.j=h}function Px(u,h){let f=new ta;if(a.Image){let m=new Image;m.onload=_(br,f,"TestLoadImage: loaded",!0,h,m),m.onerror=_(br,f,"TestLoadImage: error",!1,h,m),m.onabort=_(br,f,"TestLoadImage: abort",!1,h,m),m.ontimeout=_(br,f,"TestLoadImage: timeout",!1,h,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=u}else h(!1)}function Mx(u,h){let f=new ta,m=new AbortController,D=setTimeout(()=>{m.abort(),br(f,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:m.signal}).then(R=>{clearTimeout(D),R.ok?br(f,"TestPingServer: ok",!0,h):br(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),br(f,"TestPingServer: error",!1,h)})}function br(u,h,f,m,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),m(f)}catch{}}function xx(){this.g=new gx}function kx(u,h,f){let m=f||"";try{vE(u,function(D,R){let k=D;l(D)&&(k=Sf(D)),h.push(m+R+"="+encodeURIComponent(k))})}catch(D){throw h.push(m+"type="+encodeURIComponent("_badmap")),D}}function oa(u){this.l=u.Ub||null,this.j=u.eb||!1}E(oa,Af),oa.prototype.g=function(){return new Cu(this.l,this.j)},oa.prototype.i=function(u){return function(){return u}}({});function Cu(u,h){gt.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Cu,gt),n=Cu.prototype,n.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,ca(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,aa(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ca(this)),this.g&&(this.readyState=3,ca(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;DE(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function DE(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?aa(this):ca(this),this.readyState==3&&DE(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,aa(this))},n.Qa=function(u){this.g&&(this.response=u,aa(this))},n.ga=function(){this.g&&aa(this)};function aa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ca(u)}n.setRequestHeader=function(u,h){this.u.append(u,h)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=h.next();return u.join(`\r
`)};function ca(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Cu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function SE(u){let h="";return K(u,function(f,m){h+=m,h+=":",h+=f,h+=`\r
`}),h}function Vf(u,h,f){e:{for(m in f){var m=!1;break e}m=!0}m||(f=SE(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):xe(u,h,f))}function Be(u){gt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Be,gt);var Ox=/^https?$/i,Fx=["POST","PUT"];n=Be.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,h,f,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pf.g(),this.v=this.o?nE(this.o):nE(Pf),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(R){AE(this,R);return}if(u=f||"",f=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var D in m)f.set(D,m[D]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let R of m.keys())f.set(R,m.get(R));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),D=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Fx,h,void 0))||m||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,k]of f)this.g.setRequestHeader(R,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{PE(this),this.u=!0,this.g.send(u),this.u=!1}catch(R){AE(this,R)}};function AE(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,RE(u),bu(u)}function RE(u){u.A||(u.A=!0,Dt(u,"complete"),Dt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Dt(this,"complete"),Dt(this,"abort"),bu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bu(this,!0)),Be.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?NE(this):this.bb())},n.bb=function(){NE(this)};function NE(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Qn(u)!=4||u.Z()!=2)){if(u.u&&Qn(u)==4)Jw(u.Ea,0,u);else if(Dt(u,"readystatechange"),Qn(u)==4){u.h=!1;try{let k=u.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var m;if(m=k===0){var D=String(u.D).match(IE)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),m=!Ox.test(D?D.toLowerCase():"")}f=m}if(f)Dt(u,"complete"),Dt(u,"success");else{u.m=6;try{var R=2<Qn(u)?u.g.statusText:""}catch{R=""}u.l=R+" ["+u.Z()+"]",RE(u)}}finally{bu(u)}}}}function bu(u,h){if(u.g){PE(u);let f=u.g,m=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||Dt(u,"ready");try{f.onreadystatechange=m}catch{}}}function PE(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Qn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Qn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),px(h)}};function ME(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Lx(u){let h={};u=(u.g&&2<=Qn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<u.length;m++){if(L(u[m]))continue;var f=b(u[m]);let D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let R=h[D]||[];h[D]=R,R.push(f)}T(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ua(u,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||h}function xE(u){this.Aa=0,this.i=[],this.j=new ta,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ua("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ua("baseRetryDelayMs",5e3,u),this.cb=ua("retryDelaySeedMs",1e4,u),this.Wa=ua("forwardChannelMaxRetries",2,u),this.wa=ua("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new pE(u&&u.concurrentRequestLimit),this.Da=new xx,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=xE.prototype,n.la=8,n.G=1,n.connect=function(u,h,f,m){St(0),this.W=u,this.H=h||{},f&&m!==void 0&&(this.H.OSID=f,this.H.OAID=m),this.F=this.X,this.I=$E(this,null,this.W),Su(this)};function Uf(u){if(kE(u),u.G==3){var h=u.U++,f=Kn(u.I);if(xe(f,"SID",u.K),xe(f,"RID",h),xe(f,"TYPE","terminate"),la(u,f),h=new Tr(u,u.j,h),h.L=2,h.v=Tu(Kn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=h.v,f=!0),f||(h.g=HE(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Iu(h)}BE(u)}function Du(u){u.g&&(Bf(u),u.g.cancel(),u.g=null)}function kE(u){Du(u),u.u&&(a.clearTimeout(u.u),u.u=null),Au(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Su(u){if(!gE(u.h)&&!u.s){u.s=!0;var h=u.Ga;Wo||Gw(),Ko||(Wo(),Ko=!0),yf.add(h,u),u.B=0}}function Vx(u,h){return mE(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=ea(g(u.Ga,u,h),jE(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let D=new Tr(this,this.j,u),R=this.o;if(this.S&&(R?(R=v(R),C(R,this.S)):R=this.S),this.m!==null||this.O||(D.H=R,R=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var m=this.i[f];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=FE(this,D,h),f=Kn(this.I),xe(f,"RID",u),xe(f,"CVER",22),this.D&&xe(f,"X-HTTP-Session-Id",this.D),la(this,f),R&&(this.O?h="headers="+encodeURIComponent(String(SE(R)))+"&"+h:this.m&&Vf(f,this.m,R)),Lf(this.h,D),this.Ua&&xe(f,"TYPE","init"),this.P?(xe(f,"$req",h),xe(f,"SID","null"),D.T=!0,xf(D,f,null)):xf(D,f,h),this.G=2}}else this.G==3&&(u?OE(this,u):this.i.length==0||gE(this.h)||OE(this))};function OE(u,h){var f;h?f=h.l:f=u.U++;let m=Kn(u.I);xe(m,"SID",u.K),xe(m,"RID",f),xe(m,"AID",u.T),la(u,m),u.m&&u.o&&Vf(m,u.m,u.o),f=new Tr(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),h&&(u.i=h.D.concat(u.i)),h=FE(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Lf(u.h,f),xf(f,m,h)}function la(u,h){u.H&&K(u.H,function(f,m){xe(h,m,f)}),u.l&&vE({},function(f,m){xe(h,m,f)})}function FE(u,h,f){f=Math.min(u.i.length,f);var m=u.l?g(u.l.Na,u.l,u):null;e:{var D=u.i;let R=-1;for(;;){let k=["count="+f];R==-1?0<f?(R=D[0].g,k.push("ofs="+R)):R=0:k.push("ofs="+R);let Ae=!0;for(let lt=0;lt<f;lt++){let we=D[lt].g,mt=D[lt].map;if(we-=R,0>we)R=Math.max(0,D[lt].g-100),Ae=!1;else try{kx(mt,k,"req"+we+"_")}catch{m&&m(mt)}}if(Ae){m=k.join("&");break e}}}return u=u.i.splice(0,f),h.D=u,m}function LE(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;Wo||Gw(),Ko||(Wo(),Ko=!0),yf.add(h,u),u.v=0}}function jf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=ea(g(u.Fa,u),jE(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,VE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=ea(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,St(10),Du(this),VE(this))};function Bf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function VE(u){u.g=new Tr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=Kn(u.qa);xe(h,"RID","rpc"),xe(h,"SID",u.K),xe(h,"AID",u.T),xe(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&xe(h,"TO",u.ja),xe(h,"TYPE","xmlhttp"),la(u,h),u.m&&u.o&&Vf(h,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=Tu(Kn(h)),f.m=null,f.P=!0,dE(f,u)}n.Za=function(){this.C!=null&&(this.C=null,Du(this),jf(this),St(19))};function Au(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function UE(u,h){var f=null;if(u.g==h){Au(u),Bf(u),u.g=null;var m=2}else if(Ff(u.h,h))f=h.D,_E(u.h,h),m=1;else return;if(u.G!=0){if(h.o)if(m==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var D=u.B;m=_u(),Dt(m,new aE(m,f)),Su(u)}else LE(u);else if(D=h.s,D==3||D==0&&0<h.X||!(m==1&&Vx(u,h)||m==2&&jf(u)))switch(f&&0<f.length&&(h=u.h,h.i=h.i.concat(f)),D){case 1:ii(u,5);break;case 4:ii(u,10);break;case 3:ii(u,6);break;default:ii(u,2)}}}function jE(u,h){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*h}function ii(u,h){if(u.j.info("Error code "+h),h==2){var f=g(u.fb,u),m=u.Xa;let D=!m;m=new ri(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||wu(m,"https"),Tu(m),D?Px(m.toString(),f):Mx(m.toString(),f)}else St(2);u.G=0,u.l&&u.l.sa(h),BE(u),kE(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),St(2)):(this.j.info("Failed to ping google.com"),St(1))};function BE(u){if(u.G=0,u.ka=[],u.l){let h=yE(u.h);(h.length!=0||u.i.length!=0)&&(A(u.ka,h),A(u.ka,u.i),u.h.i.length=0,N(u.i),u.i.length=0),u.l.ra()}}function $E(u,h,f){var m=f instanceof ri?Kn(f):new ri(f);if(m.g!="")h&&(m.g=h+"."+m.g),Eu(m,m.s);else{var D=a.location;m=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var R=new ri(null);m&&wu(R,m),h&&(R.g=h),D&&Eu(R,D),f&&(R.l=f),m=R}return f=u.D,h=u.ya,f&&h&&xe(m,f,h),xe(m,"VER",u.la),la(u,m),m}function HE(u,h,f){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new Be(new oa({eb:f})):new Be(u.pa),h.Ha(u.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function qE(){}n=qE.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ru(){}Ru.prototype.g=function(u,h){return new $t(u,h)};function $t(u,h){gt.call(this),this.g=new xE(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!L(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!L(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new ns(this)}E($t,gt),$t.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$t.prototype.close=function(){Uf(this.g)},$t.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=Sf(u),u=f);h.i.push(new wx(h.Ya++,u)),h.G==3&&Su(h)},$t.prototype.N=function(){this.g.l=null,delete this.j,Uf(this.g),delete this.g,$t.aa.N.call(this)};function zE(u){Rf.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let f in h){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}E(zE,Rf);function GE(){Nf.call(this),this.status=1}E(GE,Nf);function ns(u){this.g=u}E(ns,qE),ns.prototype.ua=function(){Dt(this.g,"a")},ns.prototype.ta=function(u){Dt(this.g,new zE(u))},ns.prototype.sa=function(u){Dt(this.g,new GE)},ns.prototype.ra=function(){Dt(this.g,"b")},Ru.prototype.createWebChannel=Ru.prototype.g,$t.prototype.send=$t.prototype.o,$t.prototype.open=$t.prototype.m,$t.prototype.close=$t.prototype.close,q_=ur.createWebChannelTransport=function(){return new Ru},H_=ur.getStatEventTarget=function(){return _u()},$_=ur.Event=ti,Qd=ur.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},yu.NO_ERROR=0,yu.TIMEOUT=8,yu.HTTP_ERROR=6,yc=ur.ErrorCode=yu,cE.COMPLETE="complete",B_=ur.EventType=cE,rE.EventType=Jo,Jo.OPEN="a",Jo.CLOSE="b",Jo.ERROR="c",Jo.MESSAGE="d",gt.prototype.listen=gt.prototype.K,so=ur.WebChannel=rE,T$=ur.FetchXmlHttpFactory=oa,Be.prototype.listenOnce=Be.prototype.L,Be.prototype.getLastError=Be.prototype.Ka,Be.prototype.getLastErrorCode=Be.prototype.Ba,Be.prototype.getStatus=Be.prototype.Z,Be.prototype.getResponseJson=Be.prototype.Oa,Be.prototype.getResponseText=Be.prototype.oa,Be.prototype.send=Be.prototype.ea,Be.prototype.setWithCredentials=Be.prototype.Ha,j_=ur.XhrIo=Be}).apply(typeof Kd<"u"?Kd:typeof self<"u"?self:typeof window<"u"?window:{});var a0="@firebase/firestore";var ct=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ct.UNAUTHENTICATED=new ct(null),ct.GOOGLE_CREDENTIALS=new ct("google-credentials-uid"),ct.FIRST_PARTY=new ct("first-party-uid"),ct.MOCK_USER=new ct("mock-user");var bo="10.14.0";var Li=new Sn("@firebase/firestore");function vc(){return Li.logLevel}function B(n,...e){if(Li.logLevel<=vt.DEBUG){let t=e.map(Dv);Li.debug(`Firestore (${bo}): ${n}`,...t)}}function dr(n,...e){if(Li.logLevel<=vt.ERROR){let t=e.map(Dv);Li.error(`Firestore (${bo}): ${n}`,...t)}}function fo(n,...e){if(Li.logLevel<=vt.WARN){let t=e.map(Dv);Li.warn(`Firestore (${bo}): ${n}`,...t)}}function Dv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Z(n="Unexpected state"){let e=`FIRESTORE (${bo}) INTERNAL ASSERTION FAILED: `+n;throw dr(e),new Error(e)}function be(n,e){n||Z()}function ne(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends kt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Bn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var eh=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Q_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ct.UNAUTHENTICATED))}shutdown(){}},Y_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Z_=class{constructor(e){this.t=e,this.currentUser=ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Bn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Bn,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Bn)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(be(typeof r.accessToken=="string"),new eh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new ct(e)}},J_=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ct.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},X_=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new J_(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ey=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ty=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){be(this.o===void 0);let r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(be(typeof t.token=="string"),this.R=t.token,new ey(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function C$(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var th=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=C$(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function Te(n,e){return n<e?-1:n>e?1:0}function po(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ot=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var se=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ot(0,0))}static max(){return new n(new ot(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var nh=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Z(),r===void 0?r=e.length-t:r>e.length-t&&Z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ue=class n extends nh{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},b$=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yt=class n extends nh{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return b$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new V(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new V(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new V(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new V(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var z=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ue.fromString(e))}static fromName(e){return new n(Ue.fromString(e).popFirst(5))}static empty(){return new n(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ue.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ue(e.slice()))}};var ny=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ny.UNKNOWN_ID=-1;function D$(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new ot(t+1,0):new ot(t,r));return new Vi(i,z.empty(),e)}function S$(n){return new Vi(n.readTime,n.key,-1)}var Vi=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(se.min(),z.empty(),-1)}static max(){return new n(se.max(),z.empty(),-1)}};function A$(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=z.comparator(n.documentKey,e.documentKey),t!==0?t:Te(n.largestBatchId,e.largestBatchId))}var R$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ry=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Uc(n){return y(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==R$)throw n;B("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function N$(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function jc(n){return n.name==="IndexedDbTransactionError"}var $0=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Mh(n){return n==null}function bc(n){return n===0&&1/n==-1/0}function P$(n){return typeof n=="number"&&Number.isInteger(n)&&!bc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var M$=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],oJ=[...M$,"documentOverlays"],x$=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],k$=x$,O$=[...k$,"indexConfiguration","indexState","indexEntries"];var aJ=[...O$,"globals"];function c0(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Do(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function H0(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ze=class n{constructor(e,t){this.comparator=e,this.root=t||$n.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$n.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uo(this.root,e,this.comparator,!1)}getReverseIterator(){return new uo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uo(this.root,e,this.comparator,!0)}},uo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},$n=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Z();let e=this.left.check();if(e!==this.right.check())throw Z();return e+(this.isRed()?0:1)}};$n.EMPTY=null,$n.RED=!0,$n.BLACK=!1;$n.EMPTY=new class{constructor(){this.size=0}get key(){throw Z()}get value(){throw Z()}get color(){throw Z()}get left(){throw Z()}get right(){throw Z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new $n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var wt=class n{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rh(this.data.getIterator())}getIteratorFrom(e){return new rh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},rh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var jn=class n{constructor(e){this.fields=e,e.sort(Yt.comparator)}static empty(){return new n([])}unionWith(e){let t=new wt(Yt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return po(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ih=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Et=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ih("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Et.EMPTY_BYTE_STRING=new Et("");var F$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hr(n){if(be(!!n),typeof n=="string"){let e=0,t=F$.exec(n);if(be(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(n.seconds),nanos:Le(n.nanos)}}function Le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Qr(n){return typeof n=="string"?Et.fromBase64String(n):Et.fromUint8Array(n)}function Sv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Av(n){let e=n.mapValue.fields.__previous_value__;return Sv(e)?Av(e):e}function Dc(n){let e=hr(n.mapValue.fields.__local_write_time__.timestampValue);return new ot(e.seconds,e.nanos)}var iy=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},sh=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Yd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ui(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sv(n)?4:z0(n)?9007199254740991:q0(n)?10:11:Z()}function zn(n,e){if(n===e)return!0;let t=Ui(n);if(t!==Ui(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dc(n).isEqual(Dc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=hr(i.timestampValue),a=hr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Qr(i.bytesValue).isEqual(Qr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Le(i.geoPointValue.latitude)===Le(s.geoPointValue.latitude)&&Le(i.geoPointValue.longitude)===Le(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Le(i.integerValue)===Le(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Le(i.doubleValue),a=Le(s.doubleValue);return o===a?bc(o)===bc(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return po(n.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(c0(o)!==c0(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!zn(o[c],a[c])))return!1;return!0}(n,e);default:return Z()}}function Sc(n,e){return(n.values||[]).find(t=>zn(t,e))!==void 0}function go(n,e){if(n===e)return 0;let t=Ui(n),r=Ui(e);if(t!==r)return Te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Te(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Le(s.integerValue||s.doubleValue),c=Le(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return u0(n.timestampValue,e.timestampValue);case 4:return u0(Dc(n),Dc(e));case 5:return Te(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Qr(s),c=Qr(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=Te(a[l],c[l]);if(d!==0)return d}return Te(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Te(Le(s.latitude),Le(o.latitude));return a!==0?a:Te(Le(s.longitude),Le(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return l0(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let p=s.fields||{},g=o.fields||{},_=(a=p.value)===null||a===void 0?void 0:a.arrayValue,E=(c=g.value)===null||c===void 0?void 0:c.arrayValue,N=Te(((l=_?.values)===null||l===void 0?void 0:l.length)||0,((d=E?.values)===null||d===void 0?void 0:d.length)||0);return N!==0?N:l0(_,E)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Yd.mapValue&&o===Yd.mapValue)return 0;if(s===Yd.mapValue)return 1;if(o===Yd.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let p=0;p<c.length&&p<d.length;++p){let g=Te(c[p],d[p]);if(g!==0)return g;let _=go(a[c[p]],l[d[p]]);if(_!==0)return _}return Te(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Z()}}function u0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Te(n,e);let t=hr(n),r=hr(e),i=Te(t.seconds,r.seconds);return i!==0?i:Te(t.nanos,r.nanos)}function l0(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=go(t[i],r[i]);if(s)return s}return Te(t.length,r.length)}function mo(n){return sy(n)}function sy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=hr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Qr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=sy(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${sy(t.fields[o])}`;return i+"}"}(n.mapValue):Z()}function d0(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function oy(n){return!!n&&"integerValue"in n}function Rv(n){return!!n&&"arrayValue"in n}function h0(n){return!!n&&"nullValue"in n}function f0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function q0(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function wc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Do(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=wc(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function z0(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var yn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wc(t)}setAll(e){let t=Yt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=wc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Jd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Do(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(wc(this.value))}};function G0(n){let e=[];return Do(n.fields,(t,r)=>{let i=new Yt([t]);if(Jd(r)){let s=G0(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new jn(e)}var vn=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,se.min(),se.min(),se.min(),yn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,se.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,se.min(),se.min(),yn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,se.min(),se.min(),yn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var _o=class{constructor(e,t){this.position=e,this.inclusive=t}};function p0(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=z.comparator(z.fromName(o.referenceValue),t.key):r=go(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function g0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!zn(n.position[t],e.position[t]))return!1;return!0}var yo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function L$(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var oh=class{},nt=class n extends oh{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new cy(e,t,r):t==="array-contains"?new dy(e,r):t==="in"?new hy(e,r):t==="not-in"?new fy(e,r):t==="array-contains-any"?new py(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new uy(e,r):new ly(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(go(t,this.value)):t!==null&&Ui(this.value)===Ui(t)&&this.matchesComparison(go(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},In=class n extends oh{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return W0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function W0(n){return n.op==="and"}function K0(n){return V$(n)&&W0(n)}function V$(n){for(let e of n.filters)if(e instanceof In)return!1;return!0}function ay(n){if(n instanceof nt)return n.field.canonicalString()+n.op.toString()+mo(n.value);if(K0(n))return n.filters.map(e=>ay(e)).join(",");{let e=n.filters.map(t=>ay(t)).join(",");return`${n.op}(${e})`}}function Q0(n,e){return n instanceof nt?function(r,i){return i instanceof nt&&r.op===i.op&&r.field.isEqual(i.field)&&zn(r.value,i.value)}(n,e):n instanceof In?function(r,i){return i instanceof In&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Q0(o,i.filters[a]),!0):!1}(n,e):void Z()}function Y0(n){return n instanceof nt?function(t){return`${t.field.canonicalString()} ${t.op} ${mo(t.value)}`}(n):n instanceof In?function(t){return t.op.toString()+" {"+t.getFilters().map(Y0).join(" ,")+"}"}(n):"Filter"}var cy=class extends nt{constructor(e,t,r){super(e,t,r),this.key=z.fromName(r.referenceValue)}matches(e){let t=z.comparator(e.key,this.key);return this.matchesComparison(t)}},uy=class extends nt{constructor(e,t){super(e,"in",t),this.keys=Z0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ly=class extends nt{constructor(e,t){super(e,"not-in",t),this.keys=Z0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Z0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>z.fromName(r.referenceValue))}var dy=class extends nt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Rv(t)&&Sc(t.arrayValue,this.value)}},hy=class extends nt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Sc(this.value.arrayValue,t)}},fy=class extends nt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Sc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Sc(this.value.arrayValue,t)}},py=class extends nt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Rv(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Sc(this.value.arrayValue,r))}};var gy=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function m0(n,e=null,t=[],r=[],i=null,s=null,o=null){return new gy(n,e,t,r,i,s,o)}function Nv(n){let e=ne(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ay(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Mh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>mo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>mo(r)).join(",")),e.ue=t}return e.ue}function Pv(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!L$(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Q0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!g0(n.startAt,e.startAt)&&g0(n.endAt,e.endAt)}function my(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var ji=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function U$(n,e,t,r,i,s,o,a){return new ji(n,e,t,r,i,s,o,a)}function Mv(n){return new ji(n)}function _0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function J0(n){return n.collectionGroup!==null}function Ec(n){let e=ne(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new wt(Yt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new yo(s,r))}),t.has(Yt.keyField().canonicalString())||e.ce.push(new yo(Yt.keyField(),r))}return e.ce}function Hn(n){let e=ne(n);return e.le||(e.le=j$(e,Ec(n))),e.le}function j$(n,e){if(n.limitType==="F")return m0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new yo(i.field,s)});let t=n.endAt?new _o(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new _o(n.startAt.position,n.startAt.inclusive):null;return m0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function _y(n,e){let t=n.filters.concat([e]);return new ji(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function yy(n,e,t){return new ji(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function xh(n,e){return Pv(Hn(n),Hn(e))&&n.limitType===e.limitType}function X0(n){return`${Nv(Hn(n))}|lt:${n.limitType}`}function oo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Y0(i)).join(", ")}]`),Mh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>mo(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>mo(i)).join(",")),`Target(${r})`}(Hn(n))}; limitType=${n.limitType})`}function kh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):z.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Ec(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=p0(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,Ec(r),i)||r.endAt&&!function(o,a,c){let l=p0(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,Ec(r),i))}(n,e)}function B$(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function eR(n){return(e,t)=>{let r=!1;for(let i of Ec(n)){let s=$$(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function $$(n,e,t){let r=n.field.isKeyField()?z.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?go(c,l):Z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Z()}}var Yr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Do(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return H0(this.inner)}size(){return this.innerSize}};var H$=new ze(z.comparator);function fr(){return H$}var tR=new ze(z.comparator);function Ic(...n){let e=tR;for(let t of n)e=e.insert(t.key,t);return e}function nR(n){let e=tR;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ki(){return Tc()}function rR(){return Tc()}function Tc(){return new Yr(n=>n.toString(),(n,e)=>n.isEqual(e))}var q$=new ze(z.comparator),z$=new wt(z.comparator);function he(...n){let e=z$;for(let t of n)e=e.add(t);return e}var G$=new wt(Te);function W$(){return G$}function xv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bc(e)?"-0":e}}function iR(n){return{integerValue:""+n}}function K$(n,e){return P$(e)?iR(e):xv(n,e)}var vo=class{constructor(){this._=void 0}};function Q$(n,e,t){return n instanceof Io?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sv(s)&&(s=Av(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Bi?oR(n,e):n instanceof $i?aR(n,e):function(i,s){let o=sR(i,s),a=y0(o)+y0(i.Pe);return oy(o)&&oy(i.Pe)?iR(a):xv(i.serializer,a)}(n,e)}function Y$(n,e,t){return n instanceof Bi?oR(n,e):n instanceof $i?aR(n,e):t}function sR(n,e){return n instanceof wo?function(r){return oy(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Io=class extends vo{},Bi=class extends vo{constructor(e){super(),this.elements=e}};function oR(n,e){let t=cR(e);for(let r of n.elements)t.some(i=>zn(i,r))||t.push(r);return{arrayValue:{values:t}}}var $i=class extends vo{constructor(e){super(),this.elements=e}};function aR(n,e){let t=cR(e);for(let r of n.elements)t=t.filter(i=>!zn(i,r));return{arrayValue:{values:t}}}var wo=class extends vo{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function y0(n){return Le(n.integerValue||n.doubleValue)}function cR(n){return Rv(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Z$(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Bi&&i instanceof Bi||r instanceof $i&&i instanceof $i?po(r.elements,i.elements,zn):r instanceof wo&&i instanceof wo?zn(r.Pe,i.Pe):r instanceof Io&&i instanceof Io}(n.transform,e.transform)}var vy=class{constructor(e,t){this.version=e,this.transformResults=t}},Wr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Xd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Eo=class{};function uR(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ac(n.key,Wr.none()):new Hi(n.key,n.data,Wr.none());{let t=n.data,r=yn.empty(),i=new wt(Yt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new pr(n.key,r,new jn(i.toArray()),Wr.none())}}function J$(n,e,t){n instanceof Hi?function(i,s,o){let a=i.value.clone(),c=I0(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof pr?function(i,s,o){if(!Xd(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=I0(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(lR(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Cc(n,e,t,r){return n instanceof Hi?function(s,o,a,c){if(!Xd(s.precondition,o))return a;let l=s.value.clone(),d=w0(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof pr?function(s,o,a,c){if(!Xd(s.precondition,o))return a;let l=w0(s.fieldTransforms,c,o),d=o.data;return d.setAll(lR(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,a){return Xd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function X$(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=sR(r.transform,i||null);s!=null&&(t===null&&(t=yn.empty()),t.set(r.field,s))}return t||null}function v0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&po(r,i,(s,o)=>Z$(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Hi=class extends Eo{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},pr=class extends Eo{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function lR(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function I0(n,e,t){let r=new Map;be(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Y$(o,a,t[i]))}return r}function w0(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,Q$(s,o,e))}return r}var Ac=class extends Eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Iy=class extends Eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var wy=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&J$(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Cc(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Cc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=rR();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=uR(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&po(this.mutations,e.mutations,(t,r)=>v0(t,r))&&po(this.baseMutations,e.baseMutations,(t,r)=>v0(t,r))}},Ey=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){be(e.mutations.length===r.length);let i=function(){return q$}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Ty=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Cy=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var et,ge;function eH(n){switch(n){default:return Z();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function dR(n){if(n===void 0)return dr("GRPC error has no .code"),P.UNKNOWN;switch(n){case et.OK:return P.OK;case et.CANCELLED:return P.CANCELLED;case et.UNKNOWN:return P.UNKNOWN;case et.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case et.INTERNAL:return P.INTERNAL;case et.UNAVAILABLE:return P.UNAVAILABLE;case et.UNAUTHENTICATED:return P.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case et.NOT_FOUND:return P.NOT_FOUND;case et.ALREADY_EXISTS:return P.ALREADY_EXISTS;case et.PERMISSION_DENIED:return P.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case et.ABORTED:return P.ABORTED;case et.OUT_OF_RANGE:return P.OUT_OF_RANGE;case et.UNIMPLEMENTED:return P.UNIMPLEMENTED;case et.DATA_LOSS:return P.DATA_LOSS;default:return Z()}}(ge=et||(et={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var E0=null;function tH(){return new TextEncoder}var nH=new Gr([4294967295,4294967295],0);function T0(n){let e=tH().encode(n),t=new U_;return t.update(e),new Uint8Array(t.digest())}function C0(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gr([t,r],0),new Gr([i,s],0)]}var by=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Oi(`Invalid padding: ${t}`);if(r<0)throw new Oi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Oi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Oi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Gr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Gr.fromNumber(r)));return i.compare(nH)===1&&(i=new Gr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=T0(e),[r,i]=C0(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=T0(e),[r,i]=C0(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Oi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ah=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Rc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(se.min(),i,new ze(Te),fr(),he())}},Rc=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,he(),he(),he())}};var lo=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},ch=class{constructor(e,t){this.targetId=e,this.me=t}},uh=class{constructor(e,t,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},lh=class{constructor(){this.fe=0,this.ge=D0(),this.pe=Et.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=he(),t=he(),r=he();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Z()}}),new Rc(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=D0()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Dy=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=fr(),this.qe=b0(),this.Qe=new ze(Te)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(my(s))if(r===0){let o=new z(s.path);this.Ue(t,o,vn.newNoDocument(o,se.min()))}else be(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}E0?.et(function(d,p,g,_,E){var N,A,M,L,$,G;let Se={localCacheCount:d,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},K=p.unchangedNames;return K&&(Se.bloomFilter={applied:E===0,hashCount:(N=K?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(L=(M=(A=K?.bits)===null||A===void 0?void 0:A.bitmap)===null||M===void 0?void 0:M.length)!==null&&L!==void 0?L:0,padding:(G=($=K?.bits)===null||$===void 0?void 0:$.padding)!==null&&G!==void 0?G:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),Se}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Qr(r).toUint8Array()}catch(c){if(c instanceof ih)return fo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new by(o,i,s)}catch(c){return fo(c instanceof Oi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&my(a.target)){let c=new z(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,vn.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=he();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new ah(e,t,this.Qe,this.ke,r);return this.ke=fr(),this.qe=b0(),this.Qe=new ze(Te),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new lh,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new wt(Te),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new lh),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function b0(){return new ze(z.comparator)}function D0(){return new ze(z.comparator)}var rH={asc:"ASCENDING",desc:"DESCENDING"},iH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sH={and:"AND",or:"OR"},Sy=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ay(n,e){return n.useProto3Json||Mh(e)?e:{value:e}}function dh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function oH(n,e){return dh(n,e.toTimestamp())}function qn(n){return be(!!n),se.fromTimestamp(function(t){let r=hr(t);return new ot(r.seconds,r.nanos)}(n))}function kv(n,e){return Ry(n,e).canonicalString()}function Ry(n,e){let t=function(i){return new Ue(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function fR(n){let e=Ue.fromString(n);return be(yR(e)),e}function Ny(n,e){return kv(n.databaseId,e.path)}function z_(n,e){let t=fR(e);if(t.get(1)!==n.databaseId.projectId)throw new V(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new z(gR(t))}function pR(n,e){return kv(n.databaseId,e)}function aH(n){let e=fR(n);return e.length===4?Ue.emptyPath():gR(e)}function Py(n){return new Ue(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function gR(n){return be(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function S0(n,e,t){return{name:Ny(n,e),fields:t.value.mapValue.fields}}function cH(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(be(d===void 0||typeof d=="string"),Et.fromBase64String(d||"")):(be(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Et.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?P.UNKNOWN:dR(l.code);return new V(d,l.message||"")}(o);t=new uh(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=z_(n,r.document.name),s=qn(r.document.updateTime),o=r.document.createTime?qn(r.document.createTime):se.min(),a=new yn({mapValue:{fields:r.document.fields}}),c=vn.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new lo(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=z_(n,r.document),s=r.readTime?qn(r.readTime):se.min(),o=vn.newNoDocument(i,s),a=r.removedTargetIds||[];t=new lo([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=z_(n,r.document),s=r.removedTargetIds||[];t=new lo([],s,i,null)}else{if(!("filter"in e))return Z();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Cy(i,s),a=r.targetId;t=new ch(a,o)}}return t}function uH(n,e){let t;if(e instanceof Hi)t={update:S0(n,e.key,e.value)};else if(e instanceof Ac)t={delete:Ny(n,e.key)};else if(e instanceof pr)t={update:S0(n,e.key,e.data),updateMask:yH(e.fieldMask)};else{if(!(e instanceof Iy))return Z();t={verify:Ny(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Io)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Bi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof $i)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oH(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Z()}(n,e.precondition)),t}function lH(n,e){return n&&n.length>0?(be(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?qn(i.updateTime):qn(s);return o.isEqual(se.min())&&(o=qn(s)),new vy(o,i.transformResults||[])}(t,e))):[]}function dH(n,e){return{documents:[pR(n,e.path)]}}function hH(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=pR(n,i);let s=function(l){if(l.length!==0)return _R(In.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:ao(g.field),direction:gH(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=Ay(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function fH(n){let e=aH(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){be(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){let g=mR(p);return g instanceof In&&K0(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(g=>function(E){return new yo(co(E.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,Mh(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(p){let g=!!p.before,_=p.values||[];return new _o(_,g)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let g=!p.before,_=p.values||[];return new _o(_,g)}(t.endAt)),U$(e,i,o,s,a,"F",c,l)}function pH(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function mR(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=co(t.unaryFilter.field);return nt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=co(t.unaryFilter.field);return nt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=co(t.unaryFilter.field);return nt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=co(t.unaryFilter.field);return nt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Z()}}(n):n.fieldFilter!==void 0?function(t){return nt.create(co(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return In.create(t.compositeFilter.filters.map(r=>mR(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Z()}}(t.compositeFilter.op))}(n):Z()}function gH(n){return rH[n]}function mH(n){return iH[n]}function _H(n){return sH[n]}function ao(n){return{fieldPath:n.canonicalString()}}function co(n){return Yt.fromServerFormat(n.fieldPath)}function _R(n){return n instanceof nt?function(t){if(t.op==="=="){if(f0(t.value))return{unaryFilter:{field:ao(t.field),op:"IS_NAN"}};if(h0(t.value))return{unaryFilter:{field:ao(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(f0(t.value))return{unaryFilter:{field:ao(t.field),op:"IS_NOT_NAN"}};if(h0(t.value))return{unaryFilter:{field:ao(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ao(t.field),op:mH(t.op),value:t.value}}}(n):n instanceof In?function(t){let r=t.getFilters().map(i=>_R(i));return r.length===1?r[0]:{compositeFilter:{op:_H(t.op),filters:r}}}(n):Z()}function yH(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function yR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Nc=class n{constructor(e,t,r,i,s=se.min(),o=se.min(),a=Et.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var My=class{constructor(e){this.ct=e}};function vH(n){let e=fH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?yy(e,e.limit,"L"):e}var hh=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Le(e.integerValue));else if("doubleValue"in e){let r=Le(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),bc(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=hr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Qr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?z0(e)?this.dt(t,Number.MAX_SAFE_INTEGER):q0(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Z()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Le(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),z.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};hh.vt=new hh;var xy=class{constructor(){this.un=new ky}addToCollectionParentIndex(e,t){return this.un.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Vi.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Vi.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},ky=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new wt(Ue.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new wt(Ue.comparator)).toArray()}};var uJ=new Uint8Array(0);var Un=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Un.DEFAULT_COLLECTION_PERCENTILE=10,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Un.DEFAULT=new Un(41943040,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Un.DISABLED=new Un(-1,0,0);var Pc=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Oy=class{constructor(){this.changes=new Yr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,vn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Fy=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ly=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Cc(r.mutation,i,jn.empty(),ot.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,t,r=he()){let i=ki();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ic();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=ki();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,he()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=fr(),o=Tc(),a=function(){return Tc()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof pr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Cc(d.mutation,l,d.mutation.getFieldMask(),ot.now())):o.set(l.key,jn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var p;return a.set(l,new Fy(d,(p=o.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Tc(),i=new ze((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||jn.empty();d=a.applyToLocalView(l,d),r.set(c,d);let p=(i.get(a.batchId)||he()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,p=rR();d.forEach(g=>{if(!s.has(g)){let _=uR(t.get(g),r.get(g));_!==null&&p.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):J0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(ki()),a=-1,c=s;return o.next(l=>x.forEach(l,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,he())).next(d=>({batchId:a,changes:nR(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new z(t)).next(r=>{let i=Ic();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Ic();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,c=>{let l=function(p,g){return new ji(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,vn.newInvalidDocument(d)))});let a=Ic();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Cc(d.mutation,l,jn.empty(),ot.now()),kh(t,l)&&(a=a.insert(c,l))}),a})}};var Vy=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return x.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:qn(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:vH(i.bundledQuery),readTime:qn(i.readTime)}}(t)),x.resolve()}};var Uy=class{constructor(){this.overlays=new ze(z.comparator),this.Ir=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=ki();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=ki(),s=t.length+1,o=new z(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ze((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=ki(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=ki(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ty(t,r));let s=this.Ir.get(t);s===void 0&&(s=he(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var jy=class{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var Mc=class{constructor(){this.Tr=new wt(tt.Er),this.dr=new wt(tt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new tt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new tt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new z(new Ue([])),r=new tt(t,e),i=new tt(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new z(new Ue([])),r=new tt(t,e),i=new tt(t,e+1),s=he();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new tt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},tt=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return z.comparator(e.key,t.key)||Te(e.wr,t.wr)}static Ar(e,t){return Te(e.wr,t.wr)||z.comparator(e.key,t.key)}};var By=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new wt(tt.Er)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new wy(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new tt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new tt(t,0),i=new tt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new wt(Te);return t.forEach(i=>{let s=new tt(i,0),o=new tt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),x.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;z.isDocumentKey(s)||(s=s.child(""));let o=new tt(new z(s),0),a=new wt(Te);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),x.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){be(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return x.forEach(t.mutations,i=>{let s=new tt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new tt(t,0),i=this.br.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $y=class{constructor(e){this.Mr=e,this.docs=function(){return new ze(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():vn.newInvalidDocument(t))}getEntries(e,t){let r=fr();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vn.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=fr(),o=t.path,a=new z(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||A$(S$(d),r)<=0||(i.has(d.key)||kh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Z()}Or(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Hy(this)}getSize(e){return x.resolve(this.size)}},Hy=class extends Oy{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var qy=class{constructor(e){this.persistence=e,this.Nr=new Yr(t=>Nv(t),Pv),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mc,this.targetCount=0,this.kr=Pc.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),x.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Pc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Kn(t),x.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Br.containsKey(t))}};var zy=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new $0(0),this.Kr=!1,this.Kr=!0,this.$r=new jy,this.referenceDelegate=e(this),this.Ur=new qy(this),this.indexManager=new xy,this.remoteDocumentCache=function(i){return new $y(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new My(t),this.Gr=new Vy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Uy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new By(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){B("MemoryPersistence","Starting transaction:",e);let i=new Gy(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return x.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Gy=class extends ry{constructor(e){super(),this.currentSequenceNumber=e}},Wy=class n{constructor(e){this.persistence=e,this.Jr=new Mc,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw Z()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),x.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Xr,r=>{let i=z.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,se.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return x.or([()=>x.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Ky=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=he(),i=he();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Qy=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Yy=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return eT()?8:N$(yt())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Qy;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(vc()<=vt.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",oo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),x.resolve()):(vc()<=vt.DEBUG&&B("QueryEngine","Query:",oo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(vc()<=vt.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",oo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):x.resolve())}Yi(e,t){if(_0(t))return x.resolve(null);let r=Hn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=yy(t,null,"F"),r=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=he(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,o,c.readTime)?this.Yi(e,yy(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return _0(t)||i.isEqual(se.min())?x.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?x.resolve(null):(vc()<=vt.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),oo(t)),this.rs(e,o,t,D$(i,-1)).next(a=>a))})}ts(e,t){let r=new wt(eR(e));return t.forEach((i,s)=>{kh(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return vc()<=vt.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",oo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Vi.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Zy=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ze(Te),this._s=new Yr(s=>Nv(s),Pv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ly(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function IH(n,e,t,r){return new Zy(n,e,t,r)}function vR(n,e){return y(this,null,function*(){let t=ne(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=he();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function wH(n,e){let t=ne(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let p=l.batch,g=p.keys(),_=x.resolve();return g.forEach(E=>{_=_.next(()=>d.getEntry(c,E)).next(N=>{let A=l.docVersions.get(E);be(A!==null),N.version.compareTo(A)<0&&(p.applyToRemoteDocument(N,l),N.isValidDocument()&&(N.setReadTime(l.commitVersion),d.addEntry(N)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=he();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function IR(n){let e=ne(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function EH(n,e){let t=ne(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,p)=>{let g=i.get(p);if(!g)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,p)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(Et.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(p,_),function(N,A,M){return N.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(g,_,d)&&a.push(t.Ur.updateTargetData(s,_))});let c=fr(),l=he();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(TH(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(se.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function TH(n,e,t){let r=he(),i=he();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=fr();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):B("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function CH(n,e){let t=ne(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function bH(n,e){let t=ne(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Nc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Jy(n,e,t){return y(this,null,function*(){let r=ne(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!jc(o))throw o;B("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function A0(n,e,t){let r=ne(n),i=se.min(),s=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let p=ne(c),g=p._s.get(d);return g!==void 0?x.resolve(p.os.get(g)):p.Ur.getTargetData(l,d)}(r,o,Hn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:se.min(),t?s:he())).next(a=>(DH(r,B$(e),a),{documents:a,Ts:s})))}function DH(n,e,t){let r=n.us.get(e)||se.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var fh=class{constructor(){this.activeTargetIds=W$()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Xy=class{constructor(){this.so=new fh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new fh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ev=class{_o(e){}shutdown(){}};var ph=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Zd=null;function G_(){return Zd===null?Zd=function(){return 268435456+Math.round(2147483648*Math.random())}():Zd++,"0x"+Zd.toString(16)}var SH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var tv=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var It="WebChannelConnection",nv=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=G_(),c=this.xo(t,r.toUriEncodedString());B("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,c,l,i).then(d=>(B("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw fo("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+bo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=SH[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=G_();return new Promise((o,a)=>{let c=new j_;c.setWithCredentials(!0),c.listenOnce(B_.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yc.NO_ERROR:let d=c.getResponseJson();B(It,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case yc.TIMEOUT:B(It,`RPC '${e}' ${s} timed out`),a(new V(P.DEADLINE_EXCEEDED,"Request time out"));break;case yc.HTTP_ERROR:let p=c.getStatus();if(B(It,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let _=g?.error;if(_&&_.status&&_.message){let E=function(A){let M=A.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(M)>=0?M:P.UNKNOWN}(_.status);a(new V(E,_.message))}else a(new V(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new V(P.UNAVAILABLE,"Connection failed."));break;default:Z()}}finally{B(It,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);B(It,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=G_(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=q_(),a=H_(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");B(It,`Creating RPC '${e}' stream ${i}: ${d}`,c);let p=o.createWebChannel(d,c),g=!1,_=!1,E=new tv({Io:A=>{_?B(It,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(g||(B(It,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),B(It,`RPC '${e}' stream ${i} sending:`,A),p.send(A))},To:()=>p.close()}),N=(A,M,L)=>{A.listen(M,$=>{try{L($)}catch(G){setTimeout(()=>{throw G},0)}})};return N(p,so.EventType.OPEN,()=>{_||(B(It,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),N(p,so.EventType.CLOSE,()=>{_||(_=!0,B(It,`RPC '${e}' stream ${i} transport closed`),E.So())}),N(p,so.EventType.ERROR,A=>{_||(_=!0,fo(It,`RPC '${e}' stream ${i} transport errored:`,A),E.So(new V(P.UNAVAILABLE,"The operation could not be completed")))}),N(p,so.EventType.MESSAGE,A=>{var M;if(!_){let L=A.data[0];be(!!L);let $=L,G=$.error||((M=$[0])===null||M===void 0?void 0:M.error);if(G){B(It,`RPC '${e}' stream ${i} received error:`,G);let Se=G.status,K=function(I){let C=et[I];if(C!==void 0)return dR(C)}(Se),T=G.message;K===void 0&&(K=P.INTERNAL,T="Unknown error status: "+Se+" with message "+G.message),_=!0,E.So(new V(K,T)),p.close()}else B(It,`RPC '${e}' stream ${i} received:`,L),E.bo(L)}}),N(a,$_.STAT_EVENT,A=>{A.stat===Qd.PROXY?B(It,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===Qd.NOPROXY&&B(It,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}};function W_(){return typeof document<"u"?document:null}function Oh(n){return new Sy(n,!0)}var gh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var mh=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new gh(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(dr(t.toString()),dr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new V(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return B("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},rv=class extends mh{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=cH(this.serializer,e),r=function(s){if(!("targetChange"in s))return se.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?qn(o.readTime):se.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Py(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=my(c)?{documents:dH(s,c)}:{query:hH(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=hR(s,o.resumeToken);let l=Ay(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(se.min())>0){a.readTime=dh(s,o.snapshotVersion.toTimestamp());let l=Ay(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=pH(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Py(this.serializer),t.removeTarget=e,this.a_(t)}},iv=class extends mh{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return be(!!e.streamToken),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=lH(e.writeResults,e.commitTime),r=qn(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Py(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>uH(this.serializer,r))};this.a_(t)}};var sv=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new V(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Ry(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(P.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Ry(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(P.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},ov=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(dr(t),this.D_=!1):B("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var av=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>y(this,null,function*(){zi(this)&&(B("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let l=ne(c);l.L_.add(4),yield Bc(l),l.q_.set("Unknown"),l.L_.delete(4),yield Fh(l)})}(this))}))}),this.q_=new ov(r,i)}};function Fh(n){return y(this,null,function*(){if(zi(n))for(let e of n.B_)yield e(!0)})}function Bc(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function wR(n,e){let t=ne(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Vv(t)?Lv(t):So(t).r_()&&Fv(t,e))}function Ov(n,e){let t=ne(n),r=So(t);t.N_.delete(e),r.r_()&&ER(t,e),t.N_.size===0&&(r.r_()?r.o_():zi(t)&&t.q_.set("Unknown"))}function Fv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}So(n).A_(e)}function ER(n,e){n.Q_.xe(e),So(n).R_(e)}function Lv(n){n.Q_=new Dy({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),So(n).start(),n.q_.v_()}function Vv(n){return zi(n)&&!So(n).n_()&&n.N_.size>0}function zi(n){return ne(n).L_.size===0}function TR(n){n.Q_=void 0}function AH(n){return y(this,null,function*(){n.q_.set("Online")})}function RH(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Fv(n,e)})})}function NH(n,e){return y(this,null,function*(){TR(n),Vv(n)?(n.q_.M_(e),Lv(n)):n.q_.set("Unknown")})}function PH(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof uh&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){B("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield _h(n,r)}else if(e instanceof lo?n.Q_.Ke(e):e instanceof ch?n.Q_.He(e):n.Q_.We(e),!t.isEqual(se.min()))try{let r=yield IR(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Et.EMPTY_BYTE_STRING,d.snapshotVersion)),ER(s,c);let p=new Nc(d.target,c,l,d.sequenceNumber);Fv(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){B("RemoteStore","Failed to raise snapshot:",r),yield _h(n,r)}})}function _h(n,e,t){return y(this,null,function*(){if(!jc(e))throw e;n.L_.add(1),yield Bc(n),n.q_.set("Offline"),t||(t=()=>IR(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){B("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Fh(n)}))})}function CR(n,e){return e().catch(t=>_h(n,t,e))}function Lh(n){return y(this,null,function*(){let e=ne(n),t=Zr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;MH(e);)try{let i=yield CH(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,xH(e,i)}catch(i){yield _h(e,i)}bR(e)&&DR(e)})}function MH(n){return zi(n)&&n.O_.length<10}function xH(n,e){n.O_.push(e);let t=Zr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function bR(n){return zi(n)&&!Zr(n).n_()&&n.O_.length>0}function DR(n){Zr(n).start()}function kH(n){return y(this,null,function*(){Zr(n).p_()})}function OH(n){return y(this,null,function*(){let e=Zr(n);for(let t of n.O_)e.m_(t.mutations)})}function FH(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=Ey.from(r,e,t);yield CR(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Lh(n)})}function LH(n,e){return y(this,null,function*(){e&&Zr(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return eH(o)&&o!==P.ABORTED}(i.code)){let s=r.O_.shift();Zr(r).s_(),yield CR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Lh(r)}})}(n,e)),bR(n)&&DR(n)})}function R0(n,e){return y(this,null,function*(){let t=ne(n);t.asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials");let r=zi(t);t.L_.add(3),yield Bc(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Fh(t)})}function VH(n,e){return y(this,null,function*(){let t=ne(n);e?(t.L_.delete(2),yield Fh(t)):e||(t.L_.add(2),yield Bc(t),t.q_.set("Unknown"))})}function So(n){return n.K_||(n.K_=function(t,r,i){let s=ne(t);return s.w_(),new rv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:AH.bind(null,n),Ro:RH.bind(null,n),mo:NH.bind(null,n),d_:PH.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Vv(n)?Lv(n):n.q_.set("Unknown")):(yield n.K_.stop(),TR(n))}))),n.K_}function Zr(n){return n.U_||(n.U_=function(t,r,i){let s=ne(t);return s.w_(),new iv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:kH.bind(null,n),mo:LH.bind(null,n),f_:OH.bind(null,n),g_:FH.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield Lh(n)):(yield n.U_.stop(),n.O_.length>0&&(B("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var cv=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Uv(n,e){if(dr("AsyncQueue",`${e}: ${n}`),jc(n))return new V(P.UNAVAILABLE,`${e}: ${n}`);throw n}var yh=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||z.comparator(t.key,r.key):(t,r)=>z.comparator(t.key,r.key),this.keyedMap=Ic(),this.sortedSet=new ze(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var vh=class{constructor(){this.W_=new ze(z.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Z():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},To=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,yh.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var uv=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},lv=class{constructor(){this.queries=N0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=ne(t),s=i.queries;i.queries=N0(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new V(P.ABORTED,"Firestore shutting down"))}};function N0(){return new Yr(n=>X0(n),xh)}function SR(n,e){return y(this,null,function*(){let t=ne(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new uv,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Uv(o,`Initialization of query '${oo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&jv(t)})}function AR(n,e){return y(this,null,function*(){let t=ne(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function UH(n,e){let t=ne(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&jv(t)}function jH(n,e,t){let r=ne(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function jv(n){n.Y_.forEach(e=>{e.next()})}var dv,P0;(P0=dv||(dv={})).ea="default",P0.Cache="cache";var Ih=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new To(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=To.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==dv.Cache}};var wh=class{constructor(e){this.key=e}},Eh=class{constructor(e){this.key=e}},hv=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=he(),this.mutatedKeys=he(),this.Aa=eR(e),this.Ra=new yh(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new vh,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{let g=i.get(d),_=kh(this.query,p)?p:null,E=!!g&&this.mutatedKeys.has(g.key),N=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),A=!1;g&&_?g.data.isEqual(_.data)?E!==N&&(r.track({type:3,doc:_}),A=!0):this.ga(g,_)||(r.track({type:2,doc:_}),A=!0,(c&&this.Aa(_,c)>0||l&&this.Aa(_,l)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),A=!0):g&&!_&&(r.track({type:1,doc:g}),A=!0,(c||l)&&(a=!0)),A&&(_?(o=o.add(_),s=N?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,p)=>function(_,E){let N=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z()}};return N(_)-N(E)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new To(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new vh,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=he(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Eh(r))}),this.da.forEach(r=>{e.has(r)||t.push(new wh(r))}),t}ba(e){this.Ta=e.Ts,this.da=he();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return To.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},fv=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},pv=class{constructor(e){this.key=e,this.va=!1}},gv=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Yr(a=>X0(a),xh),this.Ma=new Map,this.xa=new Set,this.Oa=new ze(z.comparator),this.Na=new Map,this.La=new Mc,this.Ba={},this.ka=new Map,this.qa=Pc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function BH(n,e,t=!0){return y(this,null,function*(){let r=kR(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield RR(r,e,t,!0),i})}function $H(n,e){return y(this,null,function*(){let t=kR(n);yield RR(t,e,!0,!1)})}function RR(n,e,t,r){return y(this,null,function*(){let i=yield bH(n.localStore,Hn(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield HH(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&wR(n.remoteStore,i),a})}function HH(n,e,t,r,i){return y(this,null,function*(){n.Ka=(p,g,_)=>function(N,A,M,L){return y(this,null,function*(){let $=A.view.ma(M);$.ns&&($=yield A0(N.localStore,A.query,!1).then(({documents:T})=>A.view.ma(T,$)));let G=L&&L.targetChanges.get(A.targetId),Se=L&&L.targetMismatches.get(A.targetId)!=null,K=A.view.applyChanges($,N.isPrimaryClient,G,Se);return x0(N,A.targetId,K.wa),K.snapshot})}(n,p,g,_);let s=yield A0(n.localStore,e,!0),o=new hv(e,s.Ts),a=o.ma(s.documents),c=Rc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);x0(n,t,l.wa);let d=new fv(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function qH(n,e,t){return y(this,null,function*(){let r=ne(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!xh(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Jy(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ov(r.remoteStore,i.targetId),mv(r,i.targetId)}).catch(Uc))):(mv(r,i.targetId),yield Jy(r.localStore,i.targetId,!0))})}function zH(n,e){return y(this,null,function*(){let t=ne(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ov(t.remoteStore,r.targetId))})}function GH(n,e,t){return y(this,null,function*(){let r=XH(n);try{let i=yield function(o,a){let c=ne(o),l=ot.now(),d=a.reduce((_,E)=>_.add(E.key),he()),p,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=fr(),N=he();return c.cs.getEntries(_,d).next(A=>{E=A,E.forEach((M,L)=>{L.isValidDocument()||(N=N.add(M))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(A=>{p=A;let M=[];for(let L of a){let $=X$(L,p.get(L.key).overlayedDocument);$!=null&&M.push(new pr(L.key,$,G0($.value.mapValue),Wr.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,M,a)}).next(A=>{g=A;let M=A.applyToLocalDocumentSet(p,N);return c.documentOverlayCache.saveOverlays(_,A.batchId,M)})}).then(()=>({batchId:g.batchId,changes:nR(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new ze(Te)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield $c(r,i.changes),yield Lh(r.remoteStore)}catch(i){let s=Uv(i,"Failed to persist write");t.reject(s)}})}function NR(n,e){return y(this,null,function*(){let t=ne(n);try{let r=yield EH(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(be(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?be(o.va):i.removedDocuments.size>0&&(be(o.va),o.va=!1))}),yield $c(t,r,e)}catch(r){yield Uc(r)}})}function M0(n,e,t){let r=ne(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=ne(o);c.onlineState=a;let l=!1;c.queries.forEach((d,p)=>{for(let g of p.j_)g.Z_(a)&&(l=!0)}),l&&jv(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function WH(n,e,t){return y(this,null,function*(){let r=ne(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new ze(z.comparator);o=o.insert(s,vn.newNoDocument(s,se.min()));let a=he().add(s),c=new ah(se.min(),new Map,new ze(Te),o,a);yield NR(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Bv(r)}else yield Jy(r.localStore,e,!1).then(()=>mv(r,e,t)).catch(Uc)})}function KH(n,e){return y(this,null,function*(){let t=ne(n),r=e.batch.batchId;try{let i=yield wH(t.localStore,e);MR(t,r,null),PR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield $c(t,i)}catch(i){yield Uc(i)}})}function QH(n,e,t){return y(this,null,function*(){let r=ne(n);try{let i=yield function(o,a){let c=ne(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(be(p!==null),d=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);MR(r,e,t),PR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield $c(r,i)}catch(i){yield Uc(i)}})}function PR(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function MR(n,e,t){let r=ne(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function mv(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||xR(n,r)})}function xR(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Ov(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Bv(n))}function x0(n,e,t){for(let r of t)r instanceof wh?(n.La.addReference(r.key,e),YH(n,r)):r instanceof Eh?(B("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||xR(n,r.key)):Z()}function YH(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(B("SyncEngine","New document in limbo: "+t),n.xa.add(r),Bv(n))}function Bv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new z(Ue.fromString(e)),r=n.qa.next();n.Na.set(r,new pv(t)),n.Oa=n.Oa.insert(t,r),wR(n.remoteStore,new Nc(Hn(Mv(t.path)),r,"TargetPurposeLimboResolution",$0.oe))}}function $c(n,e,t){return y(this,null,function*(){let r=ne(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=Ky.Wi(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return y(this,null,function*(){let d=ne(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>x.forEach(l,g=>x.forEach(g.$i,_=>d.persistence.referenceDelegate.addReference(p,g.targetId,_)).next(()=>x.forEach(g.Ui,_=>d.persistence.referenceDelegate.removeReference(p,g.targetId,_)))))}catch(p){if(!jc(p))throw p;B("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let g=p.targetId;if(!p.fromCache){let _=d.os.get(g),E=_.snapshotVersion,N=_.withLastLimboFreeSnapshotVersion(E);d.os=d.os.insert(g,N)}}})}(r.localStore,s))})}function ZH(n,e){return y(this,null,function*(){let t=ne(n);if(!t.currentUser.isEqual(e)){B("SyncEngine","User change. New user:",e.toKey());let r=yield vR(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new V(P.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield $c(t,r.hs)}})}function JH(n,e){let t=ne(n),r=t.Na.get(e);if(r&&r.va)return he().add(r.key);{let i=he(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function kR(n){let e=ne(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=NR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WH.bind(null,e),e.Ca.d_=UH.bind(null,e.eventManager),e.Ca.$a=jH.bind(null,e.eventManager),e}function XH(n){let e=ne(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=QH.bind(null,e),e}var k0=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Oh(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return IH(this.persistence,new Yy,t.initialUser,this.serializer)}Ga(t){return new zy(Wy.Zr,this.serializer)}Wa(t){return new Xy}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var eq=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>M0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=ZH.bind(null,this.syncEngine),yield VH(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new lv}()}createDatastore(t){let r=Oh(t.databaseInfo.databaseId),i=function(o){return new nv(o)}(t.databaseInfo);return function(o,a,c,l){return new sv(o,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,c){return new av(i,s,o,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>M0(this.syncEngine,r,0),function(){return ph.D()?new ph:new ev}())}createSyncEngine(t,r){return function(s,o,a,c,l,d,p){let g=new gv(s,o,a,c,l,d);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(s){return y(this,null,function*(){let o=ne(s);B("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Bc(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Th=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):dr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var _v=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ct.UNAUTHENTICATED,this.clientId=th.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>y(this,null,function*(){B("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(B("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Uv(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function K_(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield vR(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function O0(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield tq(n);B("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>R0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>R0(e.remoteStore,i)),n._onlineComponents=e})}function tq(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B("FirestoreClient","Using user provided OfflineComponentProvider");try{yield K_(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;fo("Error using user provided cache. Falling back to memory cache: "+t),yield K_(n,new k0)}}else B("FirestoreClient","Using default OfflineComponentProvider"),yield K_(n,new k0);return n._offlineComponents})}function OR(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(B("FirestoreClient","Using user provided OnlineComponentProvider"),yield O0(n,n._uninitializedComponentsProvider._online)):(B("FirestoreClient","Using default OnlineComponentProvider"),yield O0(n,new eq))),n._onlineComponents})}function nq(n){return OR(n).then(e=>e.syncEngine)}function yv(n){return y(this,null,function*(){let e=yield OR(n),t=e.eventManager;return t.onListen=BH.bind(null,e.syncEngine),t.onUnlisten=qH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$H.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zH.bind(null,e.syncEngine),t})}function rq(n,e,t={}){let r=new Bn;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,l){let d=new Th({next:g=>{d.Za(),o.enqueueAndForget(()=>AR(s,p)),g.fromCache&&c.source==="server"?l.reject(new V(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),p=new Ih(a,d,{includeMetadataChanges:!0,_a:!0});return SR(s,p)}(yield yv(n),n.asyncQueue,e,t,r)})),r.promise}function FR(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var F0=new Map;function LR(n,e,t){if(!t)throw new V(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function iq(n,e,t,r){if(e===!0&&r===!0)throw new V(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function L0(n){if(!z.isDocumentKey(n))throw new V(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function V0(n){if(z.isDocumentKey(n))throw new V(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Vh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Z()}function lr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vh(n);throw new V(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Ch=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new V(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Co=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ch({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new V(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ch(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Q_;switch(r.type){case"firstParty":return new X_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=F0.get(t);r&&(B("ComponentProvider","Removing Datastore"),F0.delete(t),r.terminate())}(this),Promise.resolve()}};function VR(n,e,t,r={}){var i;let s=(n=lr(n,Co))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&fo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ct.MOCK_USER;else{a=ss(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new V(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ct(l)}n._authCredentials=new Y_(new eh(a,c))}}var qi=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ut=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Kr=class n extends qi{constructor(e,t,r){super(e,t,Mv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new z(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function UR(n,e,...t){if(n=fe(n),LR("collection","path",e),n instanceof Co){let r=Ue.fromString(e,...t);return V0(r),new Kr(n,null,r)}{if(!(n instanceof Ut||n instanceof Kr))throw new V(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ue.fromString(e,...t));return V0(r),new Kr(n.firestore,null,r)}}function jR(n,e,...t){if(n=fe(n),arguments.length===1&&(e=th.newId()),LR("doc","path",e),n instanceof Co){let r=Ue.fromString(e,...t);return L0(r),new Ut(n,null,new z(r))}{if(!(n instanceof Ut||n instanceof Kr))throw new V(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ue.fromString(e,...t));return L0(r),new Ut(n.firestore,n instanceof Kr?n.converter:null,new z(r))}}var bh=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new gh(this,"async_queue_retry"),this.Vu=()=>{let r=W_();r&&B("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=W_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=W_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Bn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return y(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!jc(e))throw e;B("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw dr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=cv.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Z()}verifyOperationInProgress(){}wu(){return y(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function U0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Jr=class extends Co{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new bh,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new bh(e),this._firestoreClient=void 0,yield e}})}};function BR(n,e){let t=typeof n=="object"?n:Ze(),r=typeof n=="string"?n:e||"(default)",i=Ye(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Sr("firestore");s&&VR(i,...s)}return i}function $v(n){if(n._terminated)throw new V(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sq(n),n._firestoreClient}function sq(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new iy(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,FR(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new _v(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}var xc=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Et.fromBase64String(e))}catch(t){throw new V(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var kc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Dh=class{constructor(e){this._methodName=e}};var Oc=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}};var Fc=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var oq=/^__.*__$/,vv=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hi(e,this.data,t,this.fieldTransforms)}};function $R(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z()}}var Iv=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Sh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if($R(this.Cu)&&oq.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},wv=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Oh(e)}Qu(e,t,r,i=!1){return new Iv({Cu:e,methodName:t,qu:r,path:Yt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function HR(n){let e=n._freezeSettings(),t=Oh(n._databaseId);return new wv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function aq(n,e,t,r,i,s={}){let o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);GR("Data must be an object, but it was:",o,r);let a=qR(r,o),c,l;if(s.merge)c=new jn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let p of s.mergeFields){let g=uq(e,p,t);if(!o.contains(g))throw new V(P.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);dq(d,g)||d.push(g)}c=new jn(d),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new vv(new yn(a),c,l)}function cq(n,e,t,r=!1){return Hv(t,n.Qu(r?4:3,e))}function Hv(n,e){if(zR(n=fe(n)))return GR("Unsupported field value:",e,n),qR(n,e);if(n instanceof Dh)return function(r,i){if(!$R(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Hv(a,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return K$(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ot.fromDate(r);return{timestampValue:dh(i.serializer,s)}}if(r instanceof ot){let s=new ot(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:dh(i.serializer,s)}}if(r instanceof Oc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xc)return{bytesValue:hR(i.serializer,r._byteString)};if(r instanceof Ut){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Fc)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return xv(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Vh(r)}`)}(n,e)}function qR(n,e){let t={};return H0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Do(n,(r,i)=>{let s=Hv(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function zR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ot||n instanceof Oc||n instanceof xc||n instanceof Ut||n instanceof Dh||n instanceof Fc)}function GR(n,e,t){if(!zR(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Vh(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function uq(n,e,t){if((e=fe(e))instanceof kc)return e._internalPath;if(typeof e=="string")return WR(n,e);throw Sh("Field path arguments must be of type string or ",n,!1,void 0,t)}var lq=new RegExp("[~\\*/\\[\\]]");function WR(n,e,t){if(e.search(lq)>=0)throw Sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new kc(...e.split("."))._internalPath}catch{throw Sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Sh(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new V(P.INVALID_ARGUMENT,a+n+c)}function dq(n,e){return n.some(t=>t.isEqual(e))}var Ah=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ev(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(qv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ev=class extends Ah{data(){return super.data()}};function qv(n,e){return typeof e=="string"?WR(n,e):e instanceof kc?e._internalPath:e._delegate._internalPath}function KR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Lc=class{},Tv=class extends Lc{};function QR(n,e,...t){let r=[];e instanceof Lc&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof Cv).length,a=s.filter(c=>c instanceof Rh).length;if(o>1||o>0&&a>0)throw new V(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Rh=class n extends Tv{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return ZR(e._query,t),new qi(e.firestore,e.converter,_y(e._query,t))}_parse(e){let t=HR(e.firestore);return function(s,o,a,c,l,d,p){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new V(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){B0(p,d);let _=[];for(let E of p)_.push(j0(c,s,E));g={arrayValue:{values:_}}}else g=j0(c,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||B0(p,d),g=cq(a,o,p,d==="in"||d==="not-in");return nt.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function YR(n,e,t){let r=e,i=qv("where",n);return Rh._create(i,r,t)}var Cv=class n extends Lc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:In.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)ZR(o,c),o=_y(o,c)}(e._query,t),new qi(e.firestore,e.converter,_y(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function j0(n,e,t){if(typeof(t=fe(t))=="string"){if(t==="")throw new V(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!J0(e)&&t.indexOf("/")!==-1)throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Ue.fromString(t));if(!z.isDocumentKey(r))throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return d0(n,new z(r))}if(t instanceof Ut)return d0(n,t._key);throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vh(t)}.`)}function B0(n,e){if(!Array.isArray(n)||n.length===0)throw new V(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ZR(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var bv=class{convertValue(e,t="none"){switch(Ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Do(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Le(o.doubleValue));return new Fc(s)}convertGeoPoint(e){return new Oc(Le(e.latitude),Le(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Av(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Dc(e));default:return null}}convertTimestamp(e){let t=hr(e);return new ot(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ue.fromString(e);be(yR(r));let i=new sh(r.get(1),r.get(3)),s=new z(r.popFirst(5));return i.isEqual(t)||dr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function hq(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Fi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Nh=class extends Ah{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ho(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(qv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ho=class extends Nh{data(e={}){return super.data(e)}},Ph=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ho(this._firestore,this._userDataWriter,r.key,r,new Fi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new ho(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new ho(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:fq(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function fq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z()}}var Vc=class extends bv{constructor(e){super(),this.firestore=e}convertBytes(e){return new xc(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,t)}};function JR(n){n=lr(n,qi);let e=lr(n.firestore,Jr),t=$v(e),r=new Vc(e);return KR(n._query),rq(t,n._query).then(i=>new Ph(e,r,n,i))}function XR(n,e,t){n=lr(n,Ut);let r=lr(n.firestore,Jr),i=hq(n.converter,e,t);return tN(r,[aq(HR(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Wr.none())])}function eN(n){return tN(lr(n.firestore,Jr),[new Ac(n._key,Wr.none())])}function zv(n,...e){var t,r,i;n=fe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||U0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(U0(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,d;if(n instanceof Ut)l=lr(n.firestore,Jr),d=Mv(n._key.path),c={next:p=>{e[o]&&e[o](pq(l,n,p))},error:e[o+1],complete:e[o+2]};else{let p=lr(n,qi);l=lr(p.firestore,Jr),d=p._query;let g=new Vc(l);c={next:_=>{e[o]&&e[o](new Ph(l,g,p,_))},error:e[o+1],complete:e[o+2]},KR(n._query)}return function(g,_,E,N){let A=new Th(N),M=new Ih(_,A,E);return g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return SR(yield yv(g),M)})),()=>{A.Za(),g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return AR(yield yv(g),M)}))}}($v(l),d,a,c)}function tN(n,e){return function(r,i){let s=new Bn;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return GH(yield nq(r),i,s)})),s.promise}($v(n),e)}function pq(n,e,t){let r=t.docs.get(e._key),i=new Vc(n);return new Nh(n,i,e._key,r,new Fi(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){bo=i})(Ot),We(new Ge("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Jr(new Z_(r.getProvider("auth-internal")),new ty(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new V(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sh(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),q(a0,"4.7.3",e),q(a0,"4.7.3","esm2017")})();var Uh=function(){return Uh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Uh.apply(this,arguments)};var _q={includeMetadataChanges:!1};function nN(n,e){return e===void 0&&(e=_q),new le(function(t){var r=zv(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function rN(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Uh(Uh({},r),(t={},t[e.idField]=n.id,t))}function iN(n){return nN(n,{includeMetadataChanges:!0}).pipe(te(function(e){return e.docs}))}function sN(n,e){return e===void 0&&(e={}),iN(n).pipe(te(function(t){return t.map(function(r){return rN(r,e)})}))}var gr=class{constructor(e){return e}},oN="firestore",Gv=class{constructor(){return Qe(oN)}};var Wv=new j("angularfire2.firestore-instances");function yq(n,e){let t=Xe(oN,n,e);return t&&new gr(t)}function vq(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new gr(r)}}var Iq={provide:Gv,deps:[[new X,Wv]]},wq={provide:gr,useFactory:yq,deps:[[new X,Wv],Oe]};function aN(n,...e){return q("angularfire",ke.full,"fst"),Me([wq,Iq,{provide:Wv,useFactory:vq(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,_n],[new X,Vt],...e]}])}var jh=Ie(sN,!0);var Bh=Ie(UR,!0);var cN=Ie(eN,!0);var mr=Ie(jR,!0);var Ao=Ie(JR,!0);var uN=Ie(BR,!0);var $h=Ie(QR,!0);var Ro=Ie(XR,!0);var Hh=Ie(YR,!0);var lN="@firebase/database",dN="1.0.8";var zI="";function Eq(n){zI=n}var tI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),at(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Mu(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var nI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var HN=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new tI(e)}}catch{}return new nI},Wi=HN("localStorage"),rI=HN("sessionStorage");var xo=new Sn("@firebase/database"),Tq=function(){let n=1;return function(){return n++}}(),qN=function(n){let e=oT(n),t=new rT;t.update(e);let r=t.digest();return WE.encodeByteArray(r)},tu=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=tu.apply(null,r):typeof r=="object"?e+=at(r):e+=r,e+=" "}return e},Ki=null,hN=!0,Cq=function(n,e){F(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(xo.logLevel=vt.VERBOSE,Ki=xo.log.bind(xo),e&&rI.set("logging_enabled",!0)):typeof n=="function"?Ki=n:(Ki=null,rI.remove("logging_enabled"))},Tt=function(...n){if(hN===!0&&(hN=!1,Ki===null&&rI.get("logging_enabled")===!0&&Cq(!0)),Ki){let e=tu.apply(null,n);Ki(e)}},nu=function(n){return function(...e){Tt(n,...e)}},iI=function(...n){let e="FIREBASE INTERNAL ERROR: "+tu(...n);xo.error(e)},yr=function(...n){let e=`FIREBASE FATAL ERROR: ${tu(...n)}`;throw xo.error(e),new Error(e)},Zt=function(...n){let e="FIREBASE WARNING: "+tu(...n);xo.warn(e)},bq=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Zt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},zN=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Dq=function(n){if(Cn()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Oo="[MIN_NAME]",Qi="[MAX_NAME]",$o=function(n,e){if(n===e)return 0;if(n===Oo||e===Qi)return-1;if(e===Oo||n===Qi)return 1;{let t=fN(n),r=fN(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},Sq=function(n,e){return n===e?0:n<e?-1:1},Hc=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+at(e))},GI=function(n){if(typeof n!="object"||n===null)return at(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=at(e[r]),t+=":",t+=GI(n[e[r]]);return t+="}",t},GN=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function cn(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var WN=function(n){F(!zN(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),p="";for(c=0;c<64;c+=8){let g=parseInt(d.substr(c,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},Aq=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Rq=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var Nq=new RegExp("^-?(0*)\\d{1,10}$"),Pq=-2147483648,Mq=2147483647,fN=function(n){if(Nq.test(n)){let e=Number(n);if(e>=Pq&&e<=Mq)return e}return null},ru=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Zt("Exception was thrown by user callback.",t),e},Math.floor(0))}},xq=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Kc=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var sI=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Zt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var oI=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Tt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Zt(e)}},Qc=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),zh="5",KN="v",QN="s",YN="r",ZN="f",JN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,XN="ls",eP="p",aI="ac",tP="websocket",nP="long_polling";var Gh=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Wi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Wi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function kq(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function rP(n,e,t){F(typeof e=="string","typeof type must == string"),F(typeof t=="object","typeof params must == object");let r;if(e===tP)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===nP)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);kq(n)&&(t.ns=n.namespace);let i=[];return cn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var cI=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return YE(this.counters_)}};var Kv={},Qv={};function WI(n){let e=n.toString();return Kv[e]||(Kv[e]=new cI),Kv[e]}function Oq(n,e){let t=n.toString();return Qv[t]||(Qv[t]=e()),Qv[t]}var uI=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ru(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var pN="start",Fq="close",Lq="pLPCommand",Vq="pRTLPCB",iP="id",sP="pw",oP="ser",Uq="cb",jq="seg",Bq="ts",$q="d",Hq="dframe",aP=1870,cP=30,qq=aP-cP,zq=25e3,Gq=3e4,lI=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=nu(e),this.stats_=WI(t),this.urlFn=c=>(this.appCheckToken&&(c[aI]=this.appCheckToken),rP(t,nP,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new uI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Gq)),Dq(()=>{if(this.isClosed_)return;this.scriptTagHolder=new dI((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===pN)this.id=a,this.password=c;else if(o===Fq)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[pN]="t",r[oP]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Uq]=this.scriptTagHolder.uniqueCallbackIdentifier),r[KN]=zh,this.transportSessionId&&(r[QN]=this.transportSessionId),this.lastSessionId&&(r[XN]=this.lastSessionId),this.applicationId&&(r[eP]=this.applicationId),this.appCheckToken&&(r[aI]=this.appCheckToken),typeof location<"u"&&location.hostname&&JN.test(location.hostname)&&(r[YN]=ZN);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Cn()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Aq()&&!Rq()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=at(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=KE(t),i=GN(r,qq);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Cn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Hq]="t",r[iP]=e,r[sP]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=at(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},dI=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Cn())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Tq(),window[Lq+this.uniqueCallbackIdentifier]=e,window[Vq+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Tt("frame writing exception"),a.stack&&Tt(a.stack),Tt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Tt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[iP]=this.myID,e[sP]=this.myPW,e[oP]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+cP+r.length<=aP;){let o=this.pendingSegs.shift();r=r+"&"+jq+i+"="+o.seg+"&"+Bq+i+"="+o.ts+"&"+$q+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(zq)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Cn()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Tt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var Wq=16384,Kq=45e3,Wh=null;typeof MozWebSocket<"u"?Wh=MozWebSocket:typeof WebSocket<"u"&&(Wh=WebSocket);var qc=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=nu(this.connId),this.stats_=WI(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[KN]=zh,!Cn()&&typeof location<"u"&&location.hostname&&JN.test(location.hostname)&&(a[YN]=ZN),r&&(a[QN]=r),i&&(a[XN]=i),s&&(a[aI]=s),o&&(a[eP]=o),rP(t,tP,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Wi.set("previous_websocket_failure",!0);try{let i;if(Cn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${zh}/${zI}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Wh(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Wh!==null&&!n.forceDisallow_}static previouslyFailed(){return Wi.isInMemoryStorage||Wi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Wi.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Mu(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(F(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=at(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=GN(r,Wq);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Kq))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Qq=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[lI,qc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=qc&&qc.isAvailable(),i=r&&!qc.previouslyFailed();if(t.webSocketOnly&&(r||Zt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[qc];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),Yq=6e4,Zq=5e3,Jq=10*1024,Xq=100*1024,Yv="t",gN="d",ez="s",mN="r",tz="e",_N="o",yN="a",vN="n",IN="p",nz="h",hI=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=nu("c:"+this.id+":"),this.transportManager_=new Qq(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Kc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Xq?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Jq?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Yv in e){let t=e[Yv];t===yN?this.upgradeIfSecondaryHealthy_():t===mN?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===_N&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Hc("t",e),r=Hc("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:IN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:yN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:vN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Hc("t",e),r=Hc("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Hc(Yv,e);if(gN in e){let r=e[gN];if(t===nz){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===vN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ez?this.onConnectionShutdown_(r):t===mN?this.onReset_(r):t===tz?iI("Server Error: "+r):t===_N?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):iI("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),zh!==r&&Zt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Kc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Yq))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Kc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Zq))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:IN,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Wi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Kh=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Qh=class{constructor(e){this.allowedEvents_=e,this.listeners_={},F(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){F(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Yh=class n extends Qh{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!da()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return F(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var wN=32,EN=768,Ne=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function De(){return new Ne("")}function me(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ei(n){return n.pieces_.length-n.pieceNum_}function Fe(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ne(n.pieces_,e)}function uP(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function rz(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function lP(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function dP(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ne(e,0)}function ut(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Ne(t,0)}function pe(n){return n.pieceNum_>=n.pieces_.length}function on(n,e){let t=me(n),r=me(e);if(t===null)return e;if(t===r)return on(Fe(n),Fe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function hP(n,e){if(ei(n)!==ei(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function En(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ei(n)>ei(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var fI=class{constructor(e,t){this.errorPrefix_=t,this.parts_=lP(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=_a(this.parts_[r]);fP(this)}};function iz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=_a(e),fP(n)}function sz(n){let e=n.parts_.pop();n.byteLength_-=_a(e),n.parts_.length>0&&(n.byteLength_-=1)}function fP(n){if(n.byteLength_>EN)throw new Error(n.errorPrefix_+"has a key path longer than "+EN+" bytes ("+n.byteLength_+").");if(n.parts_.length>wN)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+wN+") or object contains a cycle "+Gi(n))}function Gi(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var pI=class n extends Qh{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return F(e==="visible","Unknown event type: "+e),[this.visible_]}};var zc=1e3,oz=60*5*1e3,TN=30*1e3,az=1.3,cz=3e4,uz="server_kill",CN=3,KI=(()=>{class n extends Kh{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=nu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=zc,this.maxReconnectDelay_=oz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Cn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");pI.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Yh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(at(o)),F(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new qf,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),F(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),F(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Dn(t,"w")){let i=oi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Zt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||nT(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=TN)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=tT(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),F(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+at(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):iI("Unrecognized action received from server: "+at(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){F(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=zc,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=zc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cz&&(this.reconnectDelay_=zc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*az)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(g){F(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,_]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);a?Tt("getToken() completed but was canceled"):(Tt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=_&&_.token,c=new hI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,E=>{Zt(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(uz)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&Zt(g),l())}}})}interrupt(t){Tt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Tt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],pa(this.interruptReasons_)&&(this.reconnectDelay_=zc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>GI(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Ne(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Tt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=CN&&(this.reconnectDelay_=TN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Tt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=CN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Cn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+zI.replace(/\./g,"-")]=1,da()?t["framework.cordova"]=1:Pu()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Yh.getInstance().currentlyOnline();return pa(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),_e=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Fo=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new _e(Oo,e),i=new _e(Oo,t);return this.compare(r,i)!==0}minPost(){return _e.MIN}};var qh,Zh=class extends Fo{static get __EMPTY_NODE(){return qh}static set __EMPTY_NODE(e){qh=e}compare(e,t){return $o(e.name,t.name)}isDefinedOn(e){throw is("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return _e.MIN}maxPost(){return new _e(Qi,qh)}makePost(e,t){return F(typeof e=="string","KeyIndex indexValue must always be a string."),new _e(e,qh)}toString(){return".key"}},ko=new Zh;var Po=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},wn=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??an.EMPTY_NODE,this.right=o??an.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return an.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return an.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),gI=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new wn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},an=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wn.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Po(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Po(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Po(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Po(this.root_,null,this.comparator_,!0,e)}};an.EMPTY_NODE=new gI;function lz(n,e){return $o(n.name,e.name)}function QI(n,e){return $o(n,e)}var mI;function dz(n){mI=n}var pP=function(n){return typeof n=="number"?"number:"+WN(n):"string:"+n},gP=function(n){if(n.isLeafNode()){let e=n.val();F(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else F(n===mI||n.isEmpty(),"priority of unexpected type.");F(n===mI||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var bN,Lo=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,F(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),gP(this.priorityNode_)}static set __childrenNodeConstructor(t){bN=t}static get __childrenNodeConstructor(){return bN}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return pe(t)?this:me(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=me(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(F(i!==".priority"||ei(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Fe(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+pP(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=WN(this.value_):t+=this.value_,this.lazyHash_=qN(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(F(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return F(s>=0,"Unknown leaf type: "+r),F(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),mP,_P;function hz(n){mP=n}function fz(n){_P=n}var _I=class extends Fo{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?$o(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return _e.MIN}maxPost(){return new _e(Qi,new Lo("[PRIORITY-POST]",_P))}makePost(e,t){let r=mP(e);return new _e(t,new Lo("[PRIORITY-POST]",r))}toString(){return".priority"}},bt=new _I;var pz=Math.log(2),yI=class{constructor(e){let t=s=>parseInt(Math.log(s)/pz,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Jh=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,p,g;if(d===0)return null;if(d===1)return p=n[c],g=t?t(p):p,new wn(g,p.node,wn.BLACK,null,null);{let _=parseInt(d/2,10)+c,E=i(c,_),N=i(_+1,l);return p=n[_],g=t?t(p):p,new wn(g,p.node,wn.BLACK,E,N)}},s=function(c){let l=null,d=null,p=n.length,g=function(E,N){let A=p-E,M=p;p-=E;let L=i(A+1,M),$=n[A],G=t?t($):$;_(new wn(G,$.node,N,null,L))},_=function(E){l?(l.left=E,l=E):(d=E,l=E)};for(let E=0;E<c.count;++E){let N=c.nextBitIsOne(),A=Math.pow(2,c.count-(E+1));N?g(A,wn.BLACK):(g(A,wn.BLACK),g(A,wn.RED))}return d},o=new yI(n.length),a=s(o);return new an(r||e,a)};var Zv,No={},Vo=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return F(No&&bt,"ChildrenNode.ts has not been loaded"),Zv=Zv||new n({".priority":No},{".priority":bt}),Zv}get(e){let t=oi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof an?t:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,t){F(e!==ko,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(_e.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Jh(r,e.getCompare()):a=No;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=ga(this.indexes_,(i,s)=>{let o=oi(this.indexSet_,s);if(F(o,"Missing index implementation for "+s),i===No)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(_e.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Jh(a,o.getCompare())}else return No;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new _e(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=ga(this.indexes_,i=>{if(i===No)return i;{let s=t.get(e.name);return s?i.remove(new _e(e.name,s)):i}});return new n(r,this.indexSet_)}};var Gc,je=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&gP(this.priorityNode_),this.children_.isEmpty()&&F(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Gc||(Gc=new n(new an(QI),null,Vo.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Gc}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Gc:r}}getChild(t){let r=me(t);return r===null?this:this.getImmediateChild(r).getChild(Fe(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(F(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new _e(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Gc:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=me(t);if(i===null)return r;{F(me(t)!==".priority"||ei(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Fe(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(bt,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+pP(this.getPriority().val())+":"),this.forEachChild(bt,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":qN(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new _e(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new _e(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new _e(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,_e.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,_e.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===iu?-1:0}withIndex(t){if(t===ko||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ko||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(bt),s=r.getIterator(bt),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ko?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),vI=class extends je{constructor(){super(new an(QI),je.EMPTY_NODE,Vo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return je.EMPTY_NODE}isEmpty(){return!1}},iu=new vI;Object.defineProperties(_e,{MIN:{value:new _e(Oo,je.EMPTY_NODE)},MAX:{value:new _e(Qi,iu)}});Zh.__EMPTY_NODE=je.EMPTY_NODE;Lo.__childrenNodeConstructor=je;dz(iu);fz(iu);var gz=!0;function Ct(n,e=null){if(n===null)return je.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),F(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Lo(t,Ct(e))}if(!(n instanceof Array)&&gz){let t=[],r=!1;if(cn(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=Ct(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new _e(o,c)))}}),t.length===0)return je.EMPTY_NODE;let s=Jh(t,lz,o=>o.name,QI);if(r){let o=Jh(t,bt.getCompare());return new je(s,Ct(e),new Vo({".priority":o},{".priority":bt}))}else return new je(s,Ct(e),Vo.Default)}else{let t=je.EMPTY_NODE;return cn(n,(r,i)=>{if(Dn(n,r)&&r.substring(0,1)!=="."){let s=Ct(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Ct(e))}}hz(Ct);var II=class extends Fo{constructor(e){super(),this.indexPath_=e,F(!pe(e)&&me(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?$o(e.name,t.name):s}makePost(e,t){let r=Ct(e),i=je.EMPTY_NODE.updateChild(this.indexPath_,r);return new _e(t,i)}maxPost(){let e=je.EMPTY_NODE.updateChild(this.indexPath_,iu);return new _e(Qi,e)}toString(){return lP(this.indexPath_,0).join("/")}};var wI=class extends Fo{compare(e,t){let r=e.node.compareTo(t.node);return r===0?$o(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return _e.MIN}maxPost(){return _e.MAX}makePost(e,t){let r=Ct(e);return new _e(t,r)}toString(){return".value"}},mz=new wI;function _z(n){return{type:"value",snapshotNode:n}}function yz(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function vz(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function DN(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Iz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var EI=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=bt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return F(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return F(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Oo}hasEnd(){return this.endSet_}getIndexEndValue(){return F(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return F(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return F(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===bt}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function SN(n){let e={};if(n.isDefault())return e;let t;if(n.index_===bt?t="$priority":n.index_===mz?t="$value":n.index_===ko?t="$key":(F(n.index_ instanceof II,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=at(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=at(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+at(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=at(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+at(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function AN(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==bt&&(e.i=n.index_.toString()),e}var TI=class n extends Kh{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=nu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(F(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=SN(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let p=d;if(l===404&&(p=null,l=null),l===null&&this.onDataUpdate_(s,p,!1,r),oi(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=SN(e._queryParams),r=e._path.toString(),i=new qf;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ai(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Mu(a.responseText)}catch{Zt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Zt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var CI=class{constructor(){this.rootNode_=je.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Xh(){return{value:null,children:new Map}}function yP(n,e,t){if(pe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=me(e);n.children.has(r)||n.children.set(r,Xh());let i=n.children.get(r);e=Fe(e),yP(i,e,t)}}function bI(n,e,t){n.value!==null?t(e,n.value):wz(n,(r,i)=>{let s=new Ne(e.toString()+"/"+r);bI(i,s,t)})}function wz(n,e){n.children.forEach((t,r)=>{e(r,t)})}var DI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&cn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var RN=10*1e3,Ez=30*1e3,Tz=5*60*1e3,SI=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new DI(e);let r=RN+(Ez-RN)*Math.random();Kc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;cn(e,(i,s)=>{s>0&&Dn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Kc(this.reportStats_.bind(this),Math.floor(Math.random()*2*Tz))}};var _r=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(_r||{});function vP(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function IP(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function wP(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var AI=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=_r.ACK_USER_WRITE,this.source=vP()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return F(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Ne(e));return new n(De(),t,this.revert)}}else return F(me(this.path)===e,"operationForChild called for unrelated child."),new n(Fe(this.path),this.affectedTree,this.revert)}};var Uo=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=_r.OVERWRITE}operationForChild(e){return pe(this.path)?new n(this.source,De(),this.snap.getImmediateChild(e)):new n(this.source,Fe(this.path),this.snap)}};var ef=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=_r.MERGE}operationForChild(e){if(pe(this.path)){let t=this.children.subtree(new Ne(e));return t.isEmpty()?null:t.value?new Uo(this.source,De(),t.value):new n(this.source,De(),t)}else return F(me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Fe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Jc=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;let t=me(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function Cz(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Iz(o.childName,o.snapshotNode))}),Wc(n,i,"child_removed",e,r,t),Wc(n,i,"child_added",e,r,t),Wc(n,i,"child_moved",s,r,t),Wc(n,i,"child_changed",e,r,t),Wc(n,i,"value",e,r,t),i}function Wc(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>Dz(n,a,c)),o.forEach(a=>{let c=bz(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function bz(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Dz(n,e,t){if(e.childName==null||t.childName==null)throw is("Should only compare child_ events.");let r=new _e(e.childName,e.snapshotNode),i=new _e(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function EP(n,e){return{eventCache:n,serverCache:e}}function Yc(n,e,t,r){return EP(new Jc(e,t,r),n.serverCache)}function TP(n,e,t,r){return EP(n.eventCache,new Jc(e,t,r))}function RI(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Yi(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Jv,Sz=()=>(Jv||(Jv=new an(Sq)),Jv),jt=class n{constructor(e,t=Sz()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return cn(e,(r,i)=>{t=t.set(new Ne(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:De(),value:this.value};if(pe(e))return null;{let r=me(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Fe(e),t);return s!=null?{path:ut(new Ne(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{let t=me(e),r=this.children.get(t);return r!==null?r.subtree(Fe(e)):new n(null)}}set(e,t){if(pe(e))return new n(t,this.children);{let r=me(e),s=(this.children.get(r)||new n(null)).set(Fe(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=me(e),r=this.children.get(t);if(r){let i=r.remove(Fe(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(pe(e))return this.value;{let t=me(e),r=this.children.get(t);return r?r.get(Fe(e)):null}}setTree(e,t){if(pe(e))return t;{let r=me(e),s=(this.children.get(r)||new n(null)).setTree(Fe(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(De(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ut(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,De(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(pe(e))return null;{let s=me(e),o=this.children.get(s);return o?o.findOnPath_(Fe(e),ut(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,De(),t)}foreachOnPath_(e,t,r){if(pe(e))return this;{this.value&&r(t,this.value);let i=me(e),s=this.children.get(i);return s?s.foreachOnPath_(Fe(e),ut(t,i),r):new n(null)}}foreach(e){this.foreach_(De(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ut(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Tn=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new jt(null))}};function Zc(n,e,t){if(pe(e))return new Tn(new jt(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=on(i,e);return s=s.updateChild(o,t),new Tn(n.writeTree_.set(i,s))}else{let i=new jt(t),s=n.writeTree_.setTree(e,i);return new Tn(s)}}}function NN(n,e,t){let r=n;return cn(t,(i,s)=>{r=Zc(r,ut(e,i),s)}),r}function PN(n,e){if(pe(e))return Tn.empty();{let t=n.writeTree_.setTree(e,new jt(null));return new Tn(t)}}function NI(n,e){return Zi(n,e)!=null}function Zi(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(on(t.path,e)):null}function MN(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(bt,(r,i)=>{e.push(new _e(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new _e(r,i.value))}),e}function Xr(n,e){if(pe(e))return n;{let t=Zi(n,e);return t!=null?new Tn(new jt(t)):new Tn(n.writeTree_.subtree(e))}}function PI(n){return n.writeTree_.isEmpty()}function jo(n,e){return CP(De(),n.writeTree_,e)}function CP(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(F(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=CP(ut(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ut(n,".priority"),r)),t}}function bP(n,e){return NP(e,n)}function Az(n,e,t,r,i){F(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Zc(n.visibleWrites,e,t)),n.lastWriteId=r}function Rz(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function Nz(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);F(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&Pz(a,r.path)?i=!1:En(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return Mz(n),!0;if(r.snap)n.visibleWrites=PN(n.visibleWrites,r.path);else{let a=r.children;cn(a,c=>{n.visibleWrites=PN(n.visibleWrites,ut(r.path,c))})}return!0}else return!1}function Pz(n,e){if(n.snap)return En(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&En(ut(n.path,t),e))return!0;return!1}function Mz(n){n.visibleWrites=DP(n.allWrites,xz,De()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function xz(n){return n.visible}function DP(n,e,t){let r=Tn.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)En(t,o)?(a=on(t,o),r=Zc(r,a,s.snap)):En(o,t)&&(a=on(o,t),r=Zc(r,De(),s.snap.getChild(a)));else if(s.children){if(En(t,o))a=on(t,o),r=NN(r,a,s.children);else if(En(o,t))if(a=on(o,t),pe(a))r=NN(r,De(),s.children);else{let c=oi(s.children,me(a));if(c){let l=c.getChild(Fe(a));r=Zc(r,De(),l)}}}else throw is("WriteRecord should have .snap or .children")}}return r}function SP(n,e,t,r,i){if(!r&&!i){let s=Zi(n.visibleWrites,e);if(s!=null)return s;{let o=Xr(n.visibleWrites,e);if(PI(o))return t;if(t==null&&!NI(o,De()))return null;{let a=t||je.EMPTY_NODE;return jo(o,a)}}}else{let s=Xr(n.visibleWrites,e);if(!i&&PI(s))return t;if(!i&&t==null&&!NI(s,De()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(En(l.path,e)||En(e,l.path))},a=DP(n.allWrites,o,e),c=t||je.EMPTY_NODE;return jo(a,c)}}}function kz(n,e,t){let r=je.EMPTY_NODE,i=Zi(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(bt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Xr(n.visibleWrites,e);return t.forEachChild(bt,(o,a)=>{let c=jo(Xr(s,new Ne(o)),a);r=r.updateImmediateChild(o,c)}),MN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Xr(n.visibleWrites,e);return MN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Oz(n,e,t,r,i){F(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ut(e,t);if(NI(n.visibleWrites,s))return null;{let o=Xr(n.visibleWrites,s);return PI(o)?i.getChild(t):jo(o,i.getChild(t))}}function Fz(n,e,t,r){let i=ut(e,t),s=Zi(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Xr(n.visibleWrites,i);return jo(o,r.getNode().getImmediateChild(t))}else return null}function Lz(n,e){return Zi(n.visibleWrites,e)}function Vz(n,e,t,r,i,s,o){let a,c=Xr(n.visibleWrites,e),l=Zi(c,De());if(l!=null)a=l;else if(t!=null)a=jo(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],p=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=g.getNext();for(;_&&d.length<i;)p(_,r)!==0&&d.push(_),_=g.getNext();return d}else return[]}function Uz(){return{visibleWrites:Tn.empty(),allWrites:[],lastWriteId:-1}}function MI(n,e,t,r){return SP(n.writeTree,n.treePath,e,t,r)}function AP(n,e){return kz(n.writeTree,n.treePath,e)}function xN(n,e,t,r){return Oz(n.writeTree,n.treePath,e,t,r)}function tf(n,e){return Lz(n.writeTree,ut(n.treePath,e))}function jz(n,e,t,r,i,s){return Vz(n.writeTree,n.treePath,e,t,r,i,s)}function YI(n,e,t){return Fz(n.writeTree,n.treePath,e,t)}function RP(n,e){return NP(ut(n.treePath,e),n.writeTree)}function NP(n,e){return{treePath:n,writeTree:e}}var xI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;F(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),F(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,DN(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,vz(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,yz(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,DN(r,e.snapshotNode,i.oldSnap));else throw is("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var kI=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},PP=new kI,Xc=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Jc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return YI(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Yi(this.viewCache_),s=jz(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function Bz(n,e){F(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),F(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function $z(n,e,t,r,i){let s=new xI,o,a;if(t.type===_r.OVERWRITE){let l=t;l.source.fromUser?o=OI(n,e,l.path,l.snap,r,i,s):(F(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!pe(l.path),o=nf(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===_r.MERGE){let l=t;l.source.fromUser?o=qz(n,e,l.path,l.children,r,i,s):(F(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=FI(n,e,l.path,l.children,r,i,a,s))}else if(t.type===_r.ACK_USER_WRITE){let l=t;l.revert?o=Wz(n,e,l.path,r,i,s):o=zz(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===_r.LISTEN_COMPLETE)o=Gz(n,e,t.path,r,s);else throw is("Unknown operation type: "+t.type);let c=s.getChanges();return Hz(e,o,c),{viewCache:o,changes:c}}function Hz(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=RI(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(_z(RI(e)))}}function MP(n,e,t,r,i,s){let o=e.eventCache;if(tf(r,t)!=null)return e;{let a,c;if(pe(t))if(F(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Yi(e),d=l instanceof je?l:je.EMPTY_NODE,p=AP(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let l=MI(r,Yi(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=me(t);if(l===".priority"){F(ei(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let p=xN(r,t,d,c);p!=null?a=n.filter.updatePriority(d,p):a=o.getNode()}else{let d=Fe(t),p;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let g=xN(r,t,o.getNode(),c);g!=null?p=o.getNode().getImmediateChild(l).updateChild(d,g):p=o.getNode().getImmediateChild(l)}else p=YI(r,l,e.serverCache);p!=null?a=n.filter.updateChild(o.getNode(),l,p,d,i,s):a=o.getNode()}}return Yc(e,a,o.isFullyInitialized()||pe(t),n.filter.filtersNodes())}}function nf(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(pe(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=me(t);if(!c.isCompleteForPath(t)&&ei(t)>1)return e;let E=Fe(t),A=c.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?l=d.updatePriority(c.getNode(),A):l=d.updateChild(c.getNode(),_,A,E,PP,null)}let p=TP(e,l,c.isFullyInitialized()||pe(t),d.filtersNodes()),g=new Xc(i,p,s);return MP(n,p,t,i,g,a)}function OI(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new Xc(i,e,s);if(pe(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Yc(e,l,!0,n.filter.filtersNodes());else{let p=me(t);if(p===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=Yc(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=Fe(t),_=a.getNode().getImmediateChild(p),E;if(pe(g))E=r;else{let N=d.getCompleteChild(p);N!=null?uP(g)===".priority"&&N.getChild(dP(g)).isEmpty()?E=N:E=N.updateChild(g,r):E=je.EMPTY_NODE}if(_.equals(E))c=e;else{let N=n.filter.updateChild(a.getNode(),p,E,g,d,o);c=Yc(e,N,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function kN(n,e){return n.eventCache.isCompleteForChild(e)}function qz(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=ut(t,c);kN(e,me(d))&&(a=OI(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=ut(t,c);kN(e,me(d))||(a=OI(n,a,d,l,i,s,o))}),a}function ON(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function FI(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;pe(t)?l=r:l=new jt(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((p,g)=>{if(d.hasChild(p)){let _=e.serverCache.getNode().getImmediateChild(p),E=ON(n,_,g);c=nf(n,c,new Ne(p),E,i,s,o,a)}}),l.children.inorderTraversal((p,g)=>{let _=!e.serverCache.isCompleteForChild(p)&&g.value===null;if(!d.hasChild(p)&&!_){let E=e.serverCache.getNode().getImmediateChild(p),N=ON(n,E,g);c=nf(n,c,new Ne(p),N,i,s,o,a)}}),c}function zz(n,e,t,r,i,s,o){if(tf(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(pe(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return nf(n,e,t,c.getNode().getChild(t),i,s,a,o);if(pe(t)){let l=new jt(null);return c.getNode().forEachChild(ko,(d,p)=>{l=l.set(new Ne(d),p)}),FI(n,e,t,l,i,s,a,o)}else return e}else{let l=new jt(null);return r.foreach((d,p)=>{let g=ut(t,d);c.isCompleteForPath(g)&&(l=l.set(d,c.getNode().getChild(g)))}),FI(n,e,t,l,i,s,a,o)}}function Gz(n,e,t,r,i){let s=e.serverCache,o=TP(e,s.getNode(),s.isFullyInitialized()||pe(t),s.isFiltered());return MP(n,o,t,r,PP,i)}function Wz(n,e,t,r,i,s){let o;if(tf(r,t)!=null)return e;{let a=new Xc(r,e,i),c=e.eventCache.getNode(),l;if(pe(t)||me(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=MI(r,Yi(e));else{let p=e.serverCache.getNode();F(p instanceof je,"serverChildren would be complete if leaf node"),d=AP(r,p)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=me(t),p=YI(r,d,e.serverCache);p==null&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),p!=null?l=n.filter.updateChild(c,d,p,Fe(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,je.EMPTY_NODE,Fe(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=MI(r,Yi(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||tf(r,De())!=null,Yc(e,l,o,n.filter.filtersNodes())}}function Kz(n,e){let t=Yi(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!pe(e)&&!t.getImmediateChild(me(e)).isEmpty())?t.getChild(e):null}function FN(n,e,t,r){e.type===_r.MERGE&&e.source.queryId!==null&&(F(Yi(n.viewCache_),"We should always have a full cache before handling merges"),F(RI(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=$z(n.processor_,i,e,t,r);return Bz(n.processor_,s.viewCache),F(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Qz(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Qz(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return Cz(n.eventGenerator_,e,t,i)}var LN;function Yz(n){F(!LN,"__referenceConstructor has already been defined"),LN=n}function ZI(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return F(s!=null,"SyncTree gave us an op for an invalid query."),FN(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(FN(o,e,t,r));return s}}function JI(n,e){let t=null;for(let r of n.views.values())t=t||Kz(r,e);return t}var VN;function Zz(n){F(!VN,"__referenceConstructor has already been defined"),VN=n}var rf=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new jt(null),this.pendingWriteTree_=Uz(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Jz(n,e,t,r,i){return Az(n.pendingWriteTree_,e,t,r,i),i?of(n,new Uo(vP(),e,t)):[]}function Mo(n,e,t=!1){let r=Rz(n.pendingWriteTree_,e);if(Nz(n.pendingWriteTree_,e)){let s=new jt(null);return r.snap!=null?s=s.set(De(),!0):cn(r.children,o=>{s=s.set(new Ne(o),!0)}),of(n,new AI(r.path,s,t))}else return[]}function sf(n,e,t){return of(n,new Uo(IP(),e,t))}function Xz(n,e,t){let r=jt.fromObject(t);return of(n,new ef(IP(),e,r))}function eG(n,e,t,r){let i=FP(n,r);if(i!=null){let s=LP(i),o=s.path,a=s.queryId,c=on(o,e),l=new Uo(wP(a),c,t);return VP(n,o,l)}else return[]}function tG(n,e,t,r){let i=FP(n,r);if(i){let s=LP(i),o=s.path,a=s.queryId,c=on(o,e),l=jt.fromObject(t),d=new ef(wP(a),c,l);return VP(n,o,d)}else return[]}function xP(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=on(o,e),l=JI(a,c);if(l)return l});return SP(i,e,s,t,!0)}function of(n,e){return kP(e,n.syncPointTree_,null,bP(n.pendingWriteTree_,De()))}function kP(n,e,t,r){if(pe(n.path))return OP(n,e,t,r);{let i=e.get(De());t==null&&i!=null&&(t=JI(i,De()));let s=[],o=me(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=RP(r,o);s=s.concat(kP(a,c,l,d))}return i&&(s=s.concat(ZI(i,n,r,t))),s}}function OP(n,e,t,r){let i=e.get(De());t==null&&i!=null&&(t=JI(i,De()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=RP(r,o),d=n.operationForChild(o);d&&(s=s.concat(OP(d,a,c,l)))}),i&&(s=s.concat(ZI(i,n,r,t))),s}function FP(n,e){return n.tagToQueryMap.get(e)}function LP(n){let e=n.indexOf("$");return F(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ne(n.substr(0,e))}}function VP(n,e,t){let r=n.syncPointTree_.get(e);F(r,"Missing sync point for query tag that we're tracking");let i=bP(n.pendingWriteTree_,e);return ZI(r,t,i,null)}var LI=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},VI=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ut(this.path_,e);return new n(this.syncTree_,t)}node(){return xP(this.syncTree_,this.path_)}},nG=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},UN=function(n,e,t){if(!n||typeof n!="object")return n;if(F(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return rG(n[".sv"],e,t);if(typeof n[".sv"]=="object")return iG(n[".sv"],e);F(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},rG=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:F(!1,"Unexpected server value: "+n)}},iG=function(n,e,t){n.hasOwnProperty("increment")||F(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&F(!1,"Unexpected increment value: "+r);let i=e.node();if(F(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},sG=function(n,e,t,r){return XI(e,new VI(t,n),r)},oG=function(n,e,t){return XI(n,new LI(e),t)};function XI(n,e,t){let r=n.getPriority().val(),i=UN(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=UN(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Lo(a,Ct(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Lo(i))),o.forEachChild(bt,(a,c)=>{let l=XI(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var eu=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function ew(n,e){let t=e instanceof Ne?e:new Ne(e),r=n,i=me(t);for(;i!==null;){let s=oi(r.node.children,i)||{children:{},childCount:0};r=new eu(i,r,s),t=Fe(t),i=me(t)}return r}function Ho(n){return n.node.value}function UP(n,e){n.node.value=e,UI(n)}function jP(n){return n.node.childCount>0}function aG(n){return Ho(n)===void 0&&!jP(n)}function af(n,e){cn(n.node.children,(t,r)=>{e(new eu(t,n,r))})}function BP(n,e,t,r){t&&!r&&e(n),af(n,i=>{BP(i,e,!0,r)}),t&&r&&e(n)}function cG(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function su(n){return new Ne(n.parent===null?n.name:su(n.parent)+"/"+n.name)}function UI(n){n.parent!==null&&uG(n.parent,n.name,n)}function uG(n,e,t){let r=aG(t),i=Dn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,UI(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,UI(n))}var lG=/[\[\].#$\/\u0000-\u001F\u007F]/,dG=/[\[\].#$\u0000-\u001F\u007F]/,Xv=10*1024*1024,$P=function(n){return typeof n=="string"&&n.length!==0&&!lG.test(n)},hG=function(n){return typeof n=="string"&&n.length!==0&&!dG.test(n)},fG=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),hG(n)};var HP=function(n,e,t){let r=t instanceof Ne?new fI(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Gi(r));if(typeof e=="function")throw new Error(n+"contains a function "+Gi(r)+" with contents = "+e.toString());if(zN(e))throw new Error(n+"contains "+e.toString()+" "+Gi(r));if(typeof e=="string"&&e.length>Xv/3&&_a(e)>Xv)throw new Error(n+"contains a string greater than "+Xv+" utf8 bytes "+Gi(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(cn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!$P(o)))throw new Error(n+" contains an invalid key ("+o+") "+Gi(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);iz(r,o),HP(n,a,r),sz(r)}),i&&s)throw new Error(n+' contains ".value" child '+Gi(r)+" in addition to actual children.")}};var pG=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!$P(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!fG(t))throw new Error(sT(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var jI=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function gG(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!hP(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Ji(n,e,t){gG(n,t),mG(n,r=>En(r,e)||En(e,r))}function mG(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(_G(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function _G(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Ki&&Tt("event: "+t.toString()),ru(r)}}}var yG="repo_interrupt",vG=25,BI=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new jI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xh(),this.transactionQueueTree_=new eu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function IG(n,e,t){if(n.stats_=WI(n.repoInfo_),n.forceRestClient_||xq())n.server_=new TI(n.repoInfo_,(r,i,s,o)=>{jN(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>BN(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{at(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new KI(n.repoInfo_,e,(r,i,s,o)=>{jN(n,r,i,s,o)},r=>{BN(n,r)},r=>{EG(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=Oq(n.repoInfo_,()=>new SI(n.stats_,n.server_)),n.infoData_=new CI,n.infoSyncTree_=new rf({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=sf(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),tw(n,"connected",!1),n.serverSyncTree_=new rf({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Ji(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function wG(n){let t=n.infoData_.getNode(new Ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function qP(n){return nG({timestamp:wG(n)})}function jN(n,e,t,r,i){n.dataUpdateCount++;let s=new Ne(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=ga(t,l=>Ct(l));o=tG(n.serverSyncTree_,s,c,i)}else{let c=Ct(t);o=eG(n.serverSyncTree_,s,c,i)}else if(r){let c=ga(t,l=>Ct(l));o=Xz(n.serverSyncTree_,s,c)}else{let c=Ct(t);o=sf(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=rw(n,s)),Ji(n.eventQueue_,a,o)}function BN(n,e){tw(n,"connected",e),e===!1&&CG(n)}function EG(n,e){cn(e,(t,r)=>{tw(n,t,r)})}function tw(n,e,t){let r=new Ne("/.info/"+e),i=Ct(t);n.infoData_.updateSnapshot(r,i);let s=sf(n.infoSyncTree_,r,i);Ji(n.eventQueue_,r,s)}function TG(n){return n.nextWriteId_++}function CG(n){zP(n,"onDisconnectEvents");let e=qP(n),t=Xh();bI(n.onDisconnect_,De(),(i,s)=>{let o=sG(i,s,n.serverSyncTree_,e);yP(t,i,o)});let r=[];bI(t,De(),(i,s)=>{r=r.concat(sf(n.serverSyncTree_,i,s));let o=AG(n,i);rw(n,o)}),n.onDisconnect_=Xh(),Ji(n.eventQueue_,De(),r)}function bG(n){n.persistentConnection_&&n.persistentConnection_.interrupt(yG)}function zP(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Tt(t,...e)}function GP(n,e,t){return xP(n.serverSyncTree_,e,t)||je.EMPTY_NODE}function nw(n,e=n.transactionQueueTree_){if(e||cf(n,e),Ho(e)){let t=KP(n,e);F(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&DG(n,su(e),t)}else jP(e)&&af(e,t=>{nw(n,t)})}function DG(n,e,t){let r=t.map(l=>l.currentWriteId),i=GP(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];F(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let p=on(e,d.path);s=s.updateChild(p,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{zP(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let p=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Mo(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&p.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();cf(n,ew(n.transactionQueueTree_,e)),nw(n,n.transactionQueueTree_),Ji(n.eventQueue_,e,d);for(let g=0;g<p.length;g++)ru(p[g])}else{if(l==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{Zt("transaction at "+c.toString()+" failed: "+l);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=l}rw(n,e)}},o)}function rw(n,e){let t=WP(n,e),r=su(t),i=KP(n,t);return SG(n,i,r),r}function SG(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=on(t,c.path),d=!1,p;if(F(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,p=c.abortReason,i=i.concat(Mo(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=vG)d=!0,p="maxretry",i=i.concat(Mo(n.serverSyncTree_,c.currentWriteId,!0));else{let g=GP(n,c.path,o);c.currentInputSnapshot=g;let _=e[a].update(g.val());if(_!==void 0){HP("transaction failed: Data returned ",_,c.path);let E=Ct(_);typeof _=="object"&&_!=null&&Dn(_,".priority")||(E=E.updatePriority(g.getPriority()));let A=c.currentWriteId,M=qP(n),L=oG(E,g,M);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=L,c.currentWriteId=TG(n),o.splice(o.indexOf(A),1),i=i.concat(Jz(n.serverSyncTree_,c.path,L,c.currentWriteId,c.applyLocally)),i=i.concat(Mo(n.serverSyncTree_,A,!0))}else d=!0,p="nodata",i=i.concat(Mo(n.serverSyncTree_,c.currentWriteId,!0))}Ji(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(p==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(p),!1,null))))}cf(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)ru(r[a]);nw(n,n.transactionQueueTree_)}function WP(n,e){let t,r=n.transactionQueueTree_;for(t=me(e);t!==null&&Ho(r)===void 0;)r=ew(r,t),e=Fe(e),t=me(e);return r}function KP(n,e){let t=[];return QP(n,e,t),t.sort((r,i)=>r.order-i.order),t}function QP(n,e,t){let r=Ho(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);af(e,i=>{QP(n,i,t)})}function cf(n,e){let t=Ho(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,UP(e,t.length>0?t:void 0)}af(e,r=>{cf(n,r)})}function AG(n,e){let t=su(WP(n,e)),r=ew(n.transactionQueueTree_,e);return cG(r,i=>{eI(n,i)}),eI(n,r),BP(r,i=>{eI(n,i)}),t}function eI(n,e){let t=Ho(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(F(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(F(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Mo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?UP(e,void 0):t.length=s+1,Ji(n.eventQueue_,su(e),i);for(let o=0;o<r.length;o++)ru(r[o])}}function RG(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function NG(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Zt(`Invalid query segment '${t}' in query '${n}'`)}return e}var $N=function(n,e){let t=PG(n),r=t.namespace;t.domain==="firebase.com"&&yr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&yr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||bq();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Gh(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Ne(t.pathString)}},PG=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let p=n.indexOf("?");p===-1&&(p=n.length),e=n.substring(0,Math.min(d,p)),d<p&&(i=RG(n.substring(d,p)));let g=NG(n.substring(Math.min(n.length,p)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var $I=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return pe(this._path)?null:uP(this._path)}get ref(){return new Bo(this._repo,this._path)}get _queryIdentifier(){let e=AN(this._queryParams),t=GI(e);return t==="{}"?"default":t}get _queryObject(){return AN(this._queryParams)}isEqual(e){if(e=fe(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=hP(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+rz(this._path)}};var Bo=class n extends $I{constructor(e,t){super(e,t,new EI,!1)}get parent(){let e=dP(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};Yz(Bo);Zz(Bo);var MG="FIREBASE_DATABASE_EMULATOR_HOST",HI={},xG=!1;function kG(n,e,t,r){n.repoInfo_=new Gh(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function OG(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||yr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=$N(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[MG]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=$N(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Qc(Qc.OWNER):new oI(n.name,n.options,e);pG("Invalid Firebase Database URL",o),pe(o.path)||yr("Database URL must point to the root of a Firebase Database (not including a child path).");let p=LG(a,n,d,new sI(n.name,t));return new qI(p,n)}function FG(n,e){let t=HI[e];(!t||t[n.key]!==n)&&yr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),bG(n),delete t[n.key]}function LG(n,e,t,r){let i=HI[e.name];i||(i={},HI[e.name]=i);let s=i[n.toURLString()];return s&&yr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new BI(n,xG,t,r),i[n.toURLString()]=s,s}var qI=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(IG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Bo(this._repo,De())),this._rootInternal}_delete(){return this._rootInternal!==null&&(FG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&yr("Cannot call "+e+" on a deleted database.")}};function YP(n=Ze(),e){let t=Ye(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Sr("database");r&&ZP(t,...r)}return t}function ZP(n,e,t,r={}){n=fe(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&yr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&yr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Qc(Qc.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:ss(r.mockUserToken,n.app.options.projectId);s=new Qc(o)}kG(i,e,t,s)}function VG(n){Eq(Ot),We(new Ge("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return OG(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),q(lN,dN,n),q(lN,dN,"esm2017")}KI.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};KI.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};VG();var ou=class{constructor(e){return e}},JP="database",iw=class{constructor(){return Qe(JP)}};var sw=new j("angularfire2.database-instances");function UG(n,e){let t=Xe(JP,n,e);return t&&new ou(t)}function jG(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ou(r)}}var BG={provide:iw,deps:[[new X,sw]]},$G={provide:ou,useFactory:UG,deps:[[new X,sw],Oe]};function XP(n,...e){return q("angularfire",ke.full,"rtdb"),Me([$G,BG,{provide:sw,useFactory:jG(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,_n],[new X,Vt],...e]}])}var eM=Ie(YP,!0);var rM="functions";var ow=class{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||t.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return y(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return y(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return y(this,null,function*(){if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return y(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var aw="us-central1";var cw=class{constructor(e,t,r,i,s=aw,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new ow(t,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=aw}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function HG(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var tM="@firebase/functions",nM="0.11.8";var qG="auth-internal",zG="app-check-internal",GG="messaging-internal";function WG(n,e){let t=(r,{instanceIdentifier:i})=>{let s=r.getProvider("app").getImmediate(),o=r.getProvider(qG),a=r.getProvider(GG),c=r.getProvider(zG);return new cw(s,o,a,c,i,n)};We(new Ge(rM,t,"PUBLIC").setMultipleInstances(!0)),q(tM,nM,e),q(tM,nM,"esm2017")}function iM(n=Ze(),e=aw){let r=Ye(fe(n),rM).getImmediate({identifier:e}),i=Sr("functions");return i&&sM(r,...i),r}function sM(n,e,t){HG(fe(n),e,t)}WG(fetch.bind(self));var au=class{constructor(e){return e}},oM="functions",uw=class{constructor(){return Qe(oM)}};var lw=new j("angularfire2.functions-instances");function KG(n,e){let t=Xe(oM,n,e);return t&&new au(t)}function QG(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new au(r)}}var YG={provide:uw,deps:[[new X,lw]]},ZG={provide:au,useFactory:KG,deps:[[new X,lw],Oe]};function aM(n,...e){return q("angularfire",ke.full,"fn"),Me([ZG,YG,{provide:lw,useFactory:QG(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,_n],[new X,Vt],...e]}])}var cM=Ie(iM,!0);var JG="/firebase-messaging-sw.js",XG="/firebase-cloud-messaging-push-scope",pM="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",eW="https://fcmregistrations.googleapis.com/v1",gM="google.c.a.c_id",tW="google.c.a.c_l",nW="google.c.a.ts",rW="google.c.a.e";var uf=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}(uf||{});function vr(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function iW(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}var dw="fcm_token_details_db",sW=5,uM="fcm_token_object_Store";function oW(n){return y(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(dw))return null;let e=null;return(yield zf(dw,sW,{upgrade:(r,i,s,o)=>y(this,null,function*(){var a;if(i<2||!r.objectStoreNames.contains(uM))return;let c=o.objectStore(uM),l=yield c.index("fcmSenderId").get(n);if(yield c.clear(),!!l){if(i===2){let d=l;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:vr(d.vapidKey)}}}else if(i===3){let d=l;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vr(d.auth),p256dh:vr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vr(d.vapidKey)}}}else if(i===4){let d=l;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:vr(d.auth),p256dh:vr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:vr(d.vapidKey)}}}}})})).close(),yield xu(dw),yield xu("fcm_vapid_details_db"),yield xu("undefined"),aW(e)?e:null})}function aW(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var cW="firebase-messaging-database",uW=1,cu="firebase-messaging-store",hw=null;function mM(){return hw||(hw=zf(cW,uW,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(cu)}}})),hw}function lW(n){return y(this,null,function*(){let e=_M(n),r=yield(yield mM()).transaction(cu).objectStore(cu).get(e);if(r)return r;{let i=yield oW(n.appConfig.senderId);if(i)return yield gw(n,i),i}})}function gw(n,e){return y(this,null,function*(){let t=_M(n),i=(yield mM()).transaction(cu,"readwrite");return yield i.objectStore(cu).put(e,t),yield i.done,e})}function _M({appConfig:n}){return n.appId}var dW={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},xt=new bn("messaging","Messaging",dW);function hW(n,e){return y(this,null,function*(){let t=yield _w(n),r=yM(e),i={method:"POST",headers:t,body:JSON.stringify(r)},s;try{s=yield(yield fetch(mw(n.appConfig),i)).json()}catch(o){throw xt.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw xt.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw xt.create("token-subscribe-no-token");return s.token})}function fW(n,e){return y(this,null,function*(){let t=yield _w(n),r=yM(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)},s;try{s=yield(yield fetch(`${mw(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw xt.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw xt.create("token-update-failed",{errorInfo:o})}if(!s.token)throw xt.create("token-update-no-token");return s.token})}function pW(n,e){return y(this,null,function*(){let r={method:"DELETE",headers:yield _w(n)};try{let s=yield(yield fetch(`${mw(n.appConfig)}/${e}`,r)).json();if(s.error){let o=s.error.message;throw xt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw xt.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function mw({projectId:n}){return`${eW}/projects/${n}/registrations`}function _w(t){return y(this,arguments,function*({appConfig:n,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function yM({p256dh:n,auth:e,endpoint:t,vapidKey:r}){let i={web:{endpoint:t,auth:e,p256dh:n}};return r!==pM&&(i.web.applicationPubKey=r),i}var gW=7*24*60*60*1e3;function mW(n){return y(this,null,function*(){let e=yield yW(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:vr(e.getKey("auth")),p256dh:vr(e.getKey("p256dh"))},r=yield lW(n.firebaseDependencies);if(r){if(vW(r.subscriptionOptions,t))return Date.now()>=r.createTime+gW?_W(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield pW(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return lM(n.firebaseDependencies,t)}else return lM(n.firebaseDependencies,t)})}function _W(n,e){return y(this,null,function*(){try{let t=yield fW(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield gw(n.firebaseDependencies,r),t}catch(t){throw t}})}function lM(n,e){return y(this,null,function*(){let r={token:yield hW(n,e),createTime:Date.now(),subscriptionOptions:e};return yield gw(n,r),r.token})}function yW(n,e){return y(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:iW(e)})})}function vW(n,e){let t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}function dM(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return IW(e,n),wW(e,n),EW(e,n),e}function IW(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let r=e.notification.body;r&&(n.notification.body=r);let i=e.notification.image;i&&(n.notification.image=i);let s=e.notification.icon;s&&(n.notification.icon=s)}function wW(n,e){e.data&&(n.data=e.data)}function EW(n,e){var t,r,i,s,o;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;a&&(n.fcmOptions.link=a);let c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(n.fcmOptions.analyticsLabel=c)}function TW(n){return typeof n=="object"&&!!n&&gM in n}CW("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function CW(n,e){let t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function bW(n){if(!n||!n.options)throw fw("App Configuration Object");if(!n.name)throw fw("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let r of e)if(!t[r])throw fw(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fw(n){return xt.create("missing-app-config-values",{valueName:n})}var pw=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=bW(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};function DW(n){return y(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(JG,{scope:XG}),n.swRegistration.update().catch(()=>{})}catch(e){throw xt.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function SW(n,e){return y(this,null,function*(){if(!e&&!n.swRegistration&&(yield DW(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw xt.create("invalid-sw-registration");n.swRegistration=e}})}function AW(n,e){return y(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=pM)})}function RW(n,e){return y(this,null,function*(){if(!navigator)throw xt.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw xt.create("permission-blocked");return yield AW(n,e?.vapidKey),yield SW(n,e?.serviceWorkerRegistration),mW(n)})}function NW(n,e,t){return y(this,null,function*(){let r=PW(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[gM],message_name:t[tW],message_time:t[nW],message_device_time:Math.floor(Date.now()/1e3)})})}function PW(n){switch(n){case uf.NOTIFICATION_CLICKED:return"notification_open";case uf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function MW(n,e){return y(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===uf.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(dM(t)):n.onMessageHandler.next(dM(t)));let r=t.data;TW(r)&&r[rW]==="1"&&(yield NW(n,t.messageType,r))})}var hM="@firebase/messaging",fM="0.12.12";var xW=n=>{let e=new pw(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>MW(e,t)),e},kW=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:r=>RW(e,r)}};function OW(){We(new Ge("messaging",xW,"PUBLIC")),We(new Ge("messaging-internal",kW,"PRIVATE")),q(hM,fM),q(hM,fM,"esm2017")}function yw(){return y(this,null,function*(){try{yield si()}catch{return!1}return typeof window<"u"&&Yn()&&fa()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function vM(n=Ze()){return yw().then(e=>{if(!e)throw xt.create("unsupported-browser")},e=>{throw xt.create("indexed-db-unsupported")}),Ye(fe(n),"messaging").getImmediate()}OW();var uu=class{constructor(e){return e}},IM="messaging",vw=class{constructor(){return Qe(IM)}};var wM="__angularfire_symbol__messagingIsSupported",Iw="__angularfire_symbol__messagingIsSupportedValue";globalThis[wM]||=yw().then(n=>globalThis[Iw]=n).catch(()=>globalThis[Iw]=!1);var lf={async:()=>globalThis[wM],sync:()=>{let n=globalThis[Iw];if(n===void 0)throw new Error(to("Messaging"));return n}},ww=new j("angularfire2.messaging-instances");function FW(n,e){if(!lf.sync())return null;let t=Xe(IM,n,e);return t&&new uu(t)}function LW(n){return(e,t)=>{if(!lf.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new uu(r)}}var VW={provide:vw,deps:[[new X,ww]]},UW={provide:uu,useFactory:FW,deps:[[new X,ww],Oe]};function EM(n,...e){return q("angularfire",ke.full,"fcm"),Me([UW,VW,{provide:Br,useValue:lf.async,multi:!0},{provide:ww,useFactory:LW(n),multi:!0,deps:[Q,Ee,qe,Ve,...e]}])}var Tte=lf.async;var TM=Ie(vM,!0);var lu=class{constructor(e){return e}},CM="performance",Ew=class{constructor(){return Qe(CM)}};var Tw=new j("angularfire2.performance-instances");function jW(n,e,t){if(!Kg(t))return null;let r=Xe(CM,n,e);return r&&new lu(r)}function BW(n){return(e,t,r)=>{if(!Kg(t))return null;let i=e.runOutsideAngular(()=>n(r));return new lu(i)}}var $W={provide:Ew,deps:[[new X,Tw]]},HW={provide:lu,useFactory:jW,deps:[[new X,Tw],Oe,pn]};function bM(n,...e){return q("angularfire",ke.full,"perf"),Me([HW,$W,{provide:Tw,useFactory:BW(n),multi:!0,deps:[Q,pn,Ee,qe,Ve,...e]}])}var DM=Ie(cT,!0);var MM="firebasestorage.googleapis.com",qW="storageBucket",zW=2*60*1e3,GW=10*60*1e3;var Gn=class n extends kt{constructor(e,t,r=0){super(Cw(e),`Firebase Storage: ${t} (${Cw(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Cw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},wr=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(wr||{});function Cw(n){return"storage/"+n}function WW(){let n="An unknown error occurred, please check the error payload for server response.";return new Gn(wr.UNKNOWN,n)}function KW(){return new Gn(wr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QW(){return new Gn(wr.CANCELED,"User canceled the upload/download.")}function YW(n){return new Gn(wr.INVALID_URL,"Invalid URL '"+n+"'.")}function ZW(n){return new Gn(wr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function SM(n){return new Gn(wr.INVALID_ARGUMENT,n)}function xM(){return new Gn(wr.APP_DELETED,"The Firebase app was deleted.")}function JW(n){return new Gn(wr.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Ir=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw ZW(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(G){G.path_=decodeURIComponent(G.path)}let d="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${d}/b/${i}/o${g}`,"i"),E={bucket:1,path:3},N=t===MM?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",M=new RegExp(`^https?://${N}/${i}/${A}`,"i"),$=[{regex:a,indices:c,postModify:s},{regex:_,indices:E,postModify:l},{regex:M,indices:{bucket:1,path:2},postModify:l}];for(let G=0;G<$.length;G++){let Se=$[G],K=Se.regex.exec(e);if(K){let T=K[Se.indices.bucket],v=K[Se.indices.path];v||(v=""),r=new n(T,v),Se.postModify(r);break}}if(r==null)throw YW(e);return r}},bw=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function XW(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...A){l||(l=!0,e.apply(null,A))}function p(A){i=setTimeout(()=>{i=null,n(_,c())},A)}function g(){s&&clearTimeout(s)}function _(A,...M){if(l){g();return}if(A){g(),d.call(null,A,...M);return}if(c()||o){g(),d.call(null,A,...M);return}r<64&&(r*=2);let $;a===1?(a=2,$=0):$=(r+Math.random())*1e3,p($)}let E=!1;function N(A){E||(E=!0,g(),!l&&(i!==null?(A||(a=2),clearTimeout(i),p(0)):A||(a=1)))}return p(0),s=setTimeout(()=>{o=!0,N(!0)},t),N}function e4(n){n(!1)}function t4(n){return n!==void 0}function AM(n,e,t,r){if(r<e)throw SM(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw SM(`Invalid value for '${n}'. Expected ${t} or less.`)}function n4(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Dw=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Dw||{});function r4(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var Sw=class{constructor(e,t,r,i,s,o,a,c,l,d,p,g=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=p,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new qo(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Dw.NO_ERROR,c=s.getStatus();if(!a||r4(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Dw.ABORT;r(!1,new qo(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new qo(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());t4(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=WW();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?xM():QW();o(c)}else{let c=KW();o(c)}};this.canceled_?t(!1,new qo(!1,null,!0)):this.backoffId_=XW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&e4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},qo=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function i4(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function s4(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function o4(n,e){e&&(n["X-Firebase-GMPID"]=e)}function a4(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function c4(n,e,t,r,i,s,o=!0){let a=n4(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return o4(l,e),i4(l,t),s4(l,s),a4(l,r),new Sw(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function u4(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function l4(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var jte=256*1024;var Aw=class n{constructor(e,t){this._service=e,t instanceof Ir?this._location=t:this._location=Ir.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Ir(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return l4(this._location.path)}get storage(){return this._service}get parent(){let e=u4(this._location.path);if(e===null)return null;let t=new Ir(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw JW(e)}};function RM(n,e){let t=e?.[qW];return t==null?null:Ir.makeFromBucketSpec(t,n)}function d4(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:ss(i,n.app.options.projectId))}var Rw=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=MM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=zW,this._maxUploadRetryTime=GW,this._requests=new Set,i!=null?this._bucket=Ir.makeFromBucketSpec(i,this._host):this._bucket=RM(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ir.makeFromBucketSpec(this._url,e):this._bucket=RM(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AM("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AM("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Aw(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new bw(xM());{let o=c4(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},NM="@firebase/storage",PM="0.13.2";var kM="storage";function OM(n=Ze(),e){n=fe(n);let r=Ye(n,kM).getImmediate({identifier:e}),i=Sr("storage");return i&&FM(r,...i),r}function FM(n,e,t,r={}){d4(n,e,t,r)}function h4(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Rw(t,r,i,e,Ot)}function f4(){We(new Ge(kM,h4,"PUBLIC").setMultipleInstances(!0)),q(NM,PM,""),q(NM,PM,"esm2017")}f4();var du=class{constructor(e){return e}},LM="storage",Nw=class{constructor(){return Qe(LM)}};var Pw=new j("angularfire2.storage-instances");function p4(n,e){let t=Xe(LM,n,e);return t&&new du(t)}function g4(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new du(r)}}var m4={provide:Nw,deps:[[new X,Pw]]},_4={provide:du,useFactory:p4,deps:[[new X,Pw],Oe]};function VM(n,...e){return q("angularfire",ke.full,"gcs"),Me([_4,m4,{provide:Pw,useFactory:g4(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,_n],[new X,Vt],...e]}])}var UM=Ie(OM,!0);var Mw="@firebase/remote-config",jM="0.4.9";var BM="remote-config";var y4={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},Bt=new bn("remoteconfig","Remote Config",y4);function $M(n=Ze()){return n=fe(n),Ye(n,BM).getImmediate()}function HM(n){let e=fe(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var xw=class{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&s.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(s),i})}};function v4(n=navigator){return n.languages&&n.languages[0]||n.language}var kw=class{constructor(e,t,r,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:v4()},c={method:"POST",headers:o,body:JSON.stringify(a)},l=fetch(s,c),d=new Promise((A,M)=>{e.signal.addEventListener(()=>{let L=new Error("The operation was aborted.");L.name="AbortError",M(L)})}),p;try{yield Promise.race([l,d]),p=yield l}catch(A){let M="fetch-client-network";throw A?.name==="AbortError"&&(M="fetch-timeout"),Bt.create(M,{originalErrorMessage:A?.message})}let g=p.status,_=p.headers.get("ETag")||void 0,E,N;if(p.status===200){let A;try{A=yield p.json()}catch(M){throw Bt.create("fetch-client-parse",{originalErrorMessage:M?.message})}E=A.entries,N=A.state}if(N==="INSTANCE_STATE_UNSPECIFIED"?g=500:N==="NO_CHANGE"?g=304:(N==="NO_TEMPLATE"||N==="EMPTY_CONFIG")&&(E={}),g!==304&&g!==200)throw Bt.create("fetch-status",{httpStatus:g});return{status:g,eTag:_,config:E}})}};function I4(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(Bt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function w4(n){if(!(n instanceof kt)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var Ow=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return y(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(i,s){return y(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:r}){yield I4(e.signal,t);try{let o=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),o}catch(o){if(!w4(o))throw o;let a={throttleEndTimeMillis:Date.now()+ya(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(a),this.attemptFetch(e,a)}})}};var E4=60*1e3,T4=12*60*60*1e3,Fw=class{constructor(e,t,r,i,s){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:E4,minimumFetchIntervalMillis:T4},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}};function df(n,e){let t=n.target.error||void 0;return Bt.create(e,{originalErrorMessage:t&&t?.message})}var Xi="app_namespace_store",C4="firebase_remote_config",b4=1;function D4(){return new Promise((n,e)=>{try{let t=indexedDB.open(C4,b4);t.onerror=r=>{e(df(r,"storage-open"))},t.onsuccess=r=>{n(r.target.result)},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Xi,{keyPath:"compositeKey"})}}}catch(t){e(Bt.create("storage-open",{originalErrorMessage:t?.message}))}})}var Lw=class{constructor(e,t,r,i=D4()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){return y(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let o=t.transaction([Xi],"readonly").objectStore(Xi),a=this.createCompositeKey(e);try{let c=o.get(a);c.onerror=l=>{i(df(l,"storage-get"))},c.onsuccess=l=>{let d=l.target.result;r(d?d.value:void 0)}}catch(c){i(Bt.create("storage-get",{originalErrorMessage:c?.message}))}})})}set(e,t){return y(this,null,function*(){let r=yield this.openDbPromise;return new Promise((i,s)=>{let a=r.transaction([Xi],"readwrite").objectStore(Xi),c=this.createCompositeKey(e);try{let l=a.put({compositeKey:c,value:t});l.onerror=d=>{s(df(d,"storage-set"))},l.onsuccess=()=>{i()}}catch(l){s(Bt.create("storage-set",{originalErrorMessage:l?.message}))}})})}delete(e){return y(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let o=t.transaction([Xi],"readwrite").objectStore(Xi),a=this.createCompositeKey(e);try{let c=o.delete(a);c.onerror=l=>{i(df(l,"storage-delete"))},c.onsuccess=()=>{r()}}catch(c){i(Bt.create("storage-delete",{originalErrorMessage:c?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};var Vw=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){return y(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=yield e;i&&(this.lastFetchStatus=i);let s=yield t;s&&(this.lastSuccessfulFetchTimestampMillis=s);let o=yield r;o&&(this.activeConfig=o)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}};function S4(){We(new Ge(BM,n,"PUBLIC").setMultipleInstances(!0)),q(Mw,jM),q(Mw,jM,"esm2017");function n(e,{instanceIdentifier:t}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Bt.create("registration-window");if(!Yn())throw Bt.create("indexed-db-unavailable");let{projectId:s,apiKey:o,appId:a}=r.options;if(!s)throw Bt.create("registration-project-id");if(!o)throw Bt.create("registration-api-key");if(!a)throw Bt.create("registration-app-id");t=t||"firebase";let c=new Lw(a,r.name,t),l=new Vw(c),d=new Sn(Mw);d.logLevel=vt.ERROR;let p=new kw(i,Ot,t,s,o,a),g=new Ow(p,c),_=new xw(g,c,l,d),E=new Fw(r,_,l,c,d);return HM(E),E}}function qM(){return y(this,null,function*(){if(!Yn())return!1;try{return yield si()}catch{return!1}})}S4();var hu=class{constructor(e){return e}},zM="remote-config",Uw=class{constructor(){return Qe(zM)}};var jw="__angularfire_symbol__remoteConfigIsSupportedValue",GM="__angularfire_symbol__remoteConfigIsSupported";globalThis[GM]||=qM().then(n=>globalThis[jw]=n).catch(()=>globalThis[jw]=!1);var hf={async:()=>globalThis[GM],sync:()=>{let n=globalThis[jw];if(n===void 0)throw new Error(to("RemoteConfig"));return n}},Bw=new j("angularfire2.remote-config-instances");function A4(n,e){if(!hf.sync())return null;let t=Xe(zM,n,e);return t&&new hu(t)}function R4(n){return(e,t)=>{if(!hf.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new hu(r)}}var N4={provide:Uw,deps:[[new X,Bw]]},P4={provide:hu,useFactory:A4,deps:[[new X,Bw],Oe]};function WM(n,...e){return q("angularfire",ke.full,"rc"),Me([P4,N4,{provide:Br,useValue:hf.async,multi:!0},{provide:Bw,useFactory:R4(n),multi:!0,deps:[Q,Ee,qe,Ve,...e]}])}var Lne=hf.async;var KM=Ie($M,!0);var QM="@firebase/vertexai-preview",YM="0.0.4";var ZM="vertexAI",JM="us-central1";var $w=class{constructor(e,t,r,i){var s;this.app=e,this.options=i;let o=r?.getImmediate({optional:!0}),a=t?.getImmediate({optional:!0});this.auth=a||null,this.appCheck=o||null,this.location=((s=this.options)===null||s===void 0?void 0:s.location)||JM}_delete(){return Promise.resolve()}};var Hw=function(n){return n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.OTHER="OTHER",n}(Hw||{});var Hne=[Hw.RECITATION,Hw.SAFETY];function XM(n=Ze(),e){return n=fe(n),Ye(n,ZM).getImmediate({identifier:e?.location||JM})}function M4(){We(new Ge(ZM,(n,{instanceIdentifier:e})=>{let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new $w(t,r,i,{location:e})},"PUBLIC").setMultipleInstances(!0)),q(QM,YM),q(QM,YM,"esm2017")}M4();var fu=class{constructor(e){return e}},ex="vertexai",qw=class{constructor(){return Qe(ex)}};var zw=new j("angularfire2.vertexai-instances");function x4(n,e){let t=Xe(ex,n,e);return t&&new fu(t)}function k4(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new fu(r)}}var O4={provide:qw,deps:[[new X,zw]]},F4={provide:fu,useFactory:x4,deps:[[new X,zw],Oe]};function tx(n,...e){return q("angularfire",ke.full,"vertexai"),Me([F4,O4,{provide:zw,useFactory:k4(n),multi:!0,deps:[Q,Ee,qe,Ve,[new X,Vt],...e]}])}var nx=Ie(XM,!0);var rx={firebaseConfig:{apiKey:"AIzaSyBggO56pZ3V5jgNnv_4i_CpUbgU_iGvcsk",authDomain:"dash-boar-7ee0d.firebaseapp.com",projectId:"dash-boar-7ee0d",storageBucket:"dash-boar-7ee0d.firebasestorage.app",messagingSenderId:"325394396819",appId:"1:325394396819:web:e9673769b33be96849bf66",measurementId:"G-V0X3V5XKL2"},production:!0};var ix={providers:[VD({eventCoalescing:!0}),jS(BS),$S(()=>HS(rx.firebaseConfig)),OA(()=>LA()),i0(()=>n0()),r0,L_,aN(()=>uN()),XP(()=>eM()),aM(()=>cM()),EM(()=>TM()),bM(()=>DM()),VM(()=>UM()),WM(()=>KM()),tx(()=>nx())]};var ff=class n{firestorePath="/drivers";firestore=O(gr);driversRef;constructor(){this.driversRef=Bh(this.firestore,this.firestorePath)}getAll(){return jh(this.driversRef)}create(e){let t=e.id?mr(this.driversRef,e.id):mr(this.driversRef);return Ro(t,e)}update(e){return Ro(mr(this.driversRef,e.id),e,{merge:!0})}getById(e){return y(this,null,function*(){let t=$h(this.driversRef,Hh("id","==",e)),r=yield Ao(t);if(!r.empty)return r.docs[0].data()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var zo=class n{constructor(){}get(){return{durationHour:24,endTyreChangeWindowHour:14,fuelDurationMinute:120,minDriverChange:30,minStintMinute:5,startTyreChangeWindowHour:10}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var pf=class n{firestore=O(gr);destroy$=new it;constructor(){}generateNextId(){return y(this,null,function*(){let e=yield Ao(this.collectionRef),t=0;return e.forEach(r=>{let i=r.data(),s=parseInt(i.id,10);!isNaN(s)&&s>t&&(t=s)}),(t+1).toString()})}delete(e){return cN(mr(this.collectionRef,e))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var gf=class n extends pf{collectionPath="/races";collectionRef=Bh(this.firestore,this.collectionPath);raceConfigService=O(zo);activeRace=RD(void 0);constructor(){super(),console.log("RaceService constructor"),this.getAll().pipe(ws(this.destroy$)).subscribe(e=>{let t=this.getActiveRace(e);this.activeRace.set(t)})}getAll(){return jh(this.collectionRef).pipe(te(e=>e.filter(t=>!t.deleted)))}create(e){return y(this,null,function*(){if(this.activeRace()!==void 0)return console.log("Race already active -> "+this.activeRace()),Promise.resolve();e.id=yield this.generateNextId();let t=mr(this.collectionRef,e.id);return Ro(t,e)})}update(e){return Ro(mr(this.collectionRef,e.id),e,{merge:!0})}getById(e){return y(this,null,function*(){let t=$h(this.collectionRef,Hh("id","==",e)),r=yield Ao(t);if(!r.empty)return r.docs[0].data()})}getActiveRace(e){let t=new Date;for(let r of e){let i=r.start.toDate();if(i.setHours(i.getHours()+this.raceConfigService.get().durationHour),i>t)return r}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function V4(n,e){if(n&1){let t=MD();Ur(0,"button",3),ed("click",function(){fb(t);let i=Ug();return pb(i.startRace())}),jg(1," Start "),jr()}}function U4(n,e){if(n&1&&(Ur(0,"div",2),jg(1),jr()),n&2){let t=Ug();Mg(),Bg(" ",t.timeLeft," ")}}var mf=class n{raceService=O(gf);raceConfigService=O(zo);durationHour;intervalId;activeRace;timeLeft="";constructor(){this.durationHour=this.raceConfigService.get().durationHour,this.activeRace=this.raceService.activeRace}ngOnInit(){this.intervalId=setInterval(()=>{this.activeRace()?this.timeLeft=this.calculateLeftTime(this.activeRace()?.start.toDate()):this.timeLeft=""},1e3)}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId)}startRace(){this.raceService.create({id:"1",start:ot.now(),deleted:!1})}pad(e,t=2){let r=e.toString();for(;r.length<t;)r="0"+r;return r}calculateLeftTime(e){let t=new Date().getTime(),i=e.getTime()+this.durationHour*60*60*1e3-t;if(i<0)return"00:00:00";{let s=Math.floor(i%864e5/36e5),o=Math.floor(i%(1e3*60*60)/(1e3*60)),a=Math.floor(i%(1e3*60)/1e3);return`${this.pad(s)}:${this.pad(o)}:${this.pad(a)}`}}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Fs({type:n,selectors:[["app-race"]],standalone:!0,features:[$s],decls:4,vars:1,consts:[[1,"flex","items-center","justify-center","h-20"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded"],[1,"text-4xl","font-bold"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded",3,"click"]],template:function(t,r){t&1&&(Ur(0,"div",0)(1,"div"),Vg(2,V4,2,0,"button",1)(3,U4,2,1,"div",2),jr()()),t&2&&(Mg(2),PD(r.activeRace()?3:2))}})};var _f=class n{driverService=O(ff);drivers$;constructor(){this.drivers$=this.driverService.getAll()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Fs({type:n,selectors:[["app-root"]],standalone:!0,features:[$s],decls:3,vars:0,consts:[[1,"container","mx-auto"]],template:function(t,r){t&1&&(Ur(0,"div",0),Bs(1,"app-race"),jr(),Bs(2,"router-outlet"))},dependencies:[Om,mf]})};rS(_f,ix).catch(n=>console.error(n));
