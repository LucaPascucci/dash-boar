import{$ as xn,A as Wn,B as tr,C as ph,D as zt,E as RD,F as xD,G as $r,H as Qo,I as Fl,J as Ll,K as Vl,L as Zo,M as ND,N as MD,O as PD,P as kD,Q as Ul,R as fa,S as Fe,T as Et,U as en,V as nr,W as Vv,X as mh,Y as It,Z as $t,_ as ui,a as U,aa as OD,b as he,ba as Ht,c as Xi,ca as gh,d as y,da as te,e as $,ea as FD,f as la,g as hh,h as ID,i as TD,j as CD,k as bD,l as eo,m as Lv,n as ua,o as da,p as ln,q as Pl,r as DD,s as kl,t as fh,u as SD,v as jr,w as AD,x as Br,y as ha,z as Ol}from"./chunk-TSZ4SNPW.js";function Hv(n,e){return Object.is(n,e)}var qt=null,jl=!1,qv=1,Nn=Symbol("SIGNAL");function Me(n){let e=qt;return qt=n,e}function LD(){return qt}function qV(){return jl}var Jo={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function yh(n){if(jl)throw new Error("");if(qt===null)return;qt.consumerOnSignalRead(n);let e=qt.nextProducerIndex++;if(wh(qt),e<qt.producerNode.length&&qt.producerNode[e]!==n&&Bl(qt)){let t=qt.producerNode[e];_h(t,qt.producerIndexOfThis[e])}qt.producerNode[e]!==n&&(qt.producerNode[e]=n,qt.producerIndexOfThis[e]=Bl(qt)?BD(n,qt,e):0),qt.producerLastReadVersion[e]=n.version}function WV(){qv++}function Wv(n){if(!(Bl(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===qv)){if(!n.producerMustRecompute(n)&&!Hl(n)){Bv(n);return}n.producerRecomputeValue(n),Bv(n)}}function VD(n){if(n.liveConsumerNode===void 0)return;let e=jl;jl=!0;try{for(let t of n.liveConsumerNode)t.dirty||jD(t)}finally{jl=e}}function UD(){return qt?.consumerAllowSignalWrites!==!1}function jD(n){n.dirty=!0,VD(n),n.consumerMarkedDirty?.(n)}function Bv(n){n.dirty=!1,n.lastCleanEpoch=qv}function pa(n){return n&&(n.nextProducerIndex=0),Me(n)}function $l(n,e){if(Me(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Bl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)_h(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Hl(n){wh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Wv(t),r!==t.version))return!0}return!1}function ma(n){if(wh(n),Bl(n))for(let e=0;e<n.producerNode.length;e++)_h(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function BD(n,e,t){if($D(n),n.liveConsumerNode.length===0&&HD(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=BD(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function _h(n,e){if($D(n),n.liveConsumerNode.length===1&&HD(n))for(let r=0;r<n.producerNode.length;r++)_h(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];wh(i),i.producerIndexOfThis[r]=e}}function Bl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function wh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function $D(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function HD(n){return n.producerNode!==void 0}function qD(n){let e=Object.create(zV);e.computation=n;let t=()=>{if(Wv(e),yh(e),e.value===vh)throw e.error;return e.value};return t[Nn]=e,t}var Uv=Symbol("UNSET"),jv=Symbol("COMPUTING"),vh=Symbol("ERRORED"),zV=he(U({},Jo),{value:Uv,dirty:!0,error:null,equal:Hv,kind:"computed",producerMustRecompute(n){return n.value===Uv||n.value===jv},producerRecomputeValue(n){if(n.value===jv)throw new Error("Detected cycle in computations.");let e=n.value;n.value=jv;let t=pa(n),r,i=!1;try{r=n.computation(),Me(null),i=e!==Uv&&e!==vh&&r!==vh&&n.equal(e,r)}catch(o){r=vh,n.error=o}finally{$l(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function GV(){throw new Error}var WD=GV;function zD(){WD()}function GD(n){WD=n}var KV=null;function KD(n){let e=Object.create(zv);e.value=n;let t=()=>(yh(e),e.value);return t[Nn]=e,t}function Eh(n,e){UD()||zD(),n.equal(n.value,e)||(n.value=e,YV(n))}function YD(n,e){UD()||zD(),Eh(n,e(n.value))}var zv=he(U({},Jo),{equal:Hv,value:void 0,kind:"signal"});function YV(n){n.version++,WV(),VD(n),KV?.()}function QD(n,e,t){let r=Object.create(QV);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;let i=c=>{r.cleanupFn=c};function o(c){return c.fn===null&&c.schedule===null}function s(c){o(c)||(ma(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=$v)}let a=()=>{if(r.fn===null)return;if(qV())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!Hl(r))return;r.hasRun=!0;let c=pa(r);try{r.cleanupFn(),r.cleanupFn=$v,r.fn(i)}finally{$l(r,c)}};return r.ref={notify:()=>jD(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>s(r),[Nn]:r},r.ref}var $v=()=>{},QV=he(U({},Jo),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule!==null&&n.schedule(n.ref)},hasRun:!1,cleanupFn:$v});function ye(n){return typeof n=="function"}function ga(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ih=ga(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Xo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ye(r))try{r()}catch(o){e=o instanceof Ih?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{ZD(o)}catch(s){e=e??[],s instanceof Ih?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Ih(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ZD(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Xo(t,e)}remove(e){let{_finalizers:t}=this;t&&Xo(t,e),e instanceof n&&e._removeParent(this)}};Tt.EMPTY=(()=>{let n=new Tt;return n.closed=!0,n})();var Gv=Tt.EMPTY;function Th(n){return n instanceof Tt||n&&"closed"in n&&ye(n.remove)&&ye(n.add)&&ye(n.unsubscribe)}function ZD(n){ye(n)?n():n.unsubscribe()}var Er={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var va={setTimeout(n,e,...t){let{delegate:r}=va;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=va;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ch(n){va.setTimeout(()=>{let{onUnhandledError:e}=Er;if(e)e(n);else throw n})}function ql(){}var JD=Kv("C",void 0,void 0);function XD(n){return Kv("E",void 0,n)}function eS(n){return Kv("N",n,void 0)}function Kv(n,e,t){return{kind:n,value:e,error:t}}var es=null;function ya(n){if(Er.useDeprecatedSynchronousErrorHandling){let e=!es;if(e&&(es={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=es;if(es=null,t)throw r}}else n()}function tS(n){Er.useDeprecatedSynchronousErrorHandling&&es&&(es.errorThrown=!0,es.error=n)}var ts=class extends Tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Th(e)&&e.add(this)):this.destination=XV}static create(e,t,r){return new _a(e,t,r)}next(e){this.isStopped?Qv(eS(e),this):this._next(e)}error(e){this.isStopped?Qv(XD(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Qv(JD,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},ZV=Function.prototype.bind;function Yv(n,e){return ZV.call(n,e)}var Zv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){bh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){bh(r)}else bh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){bh(t)}}},_a=class extends ts{constructor(e,t,r){super();let i;if(ye(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Er.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Yv(e.next,o),error:e.error&&Yv(e.error,o),complete:e.complete&&Yv(e.complete,o)}):i=e}this.destination=new Zv(i)}};function bh(n){Er.useDeprecatedSynchronousErrorHandling?tS(n):Ch(n)}function JV(n){throw n}function Qv(n,e){let{onStoppedNotification:t}=Er;t&&va.setTimeout(()=>t(n,e))}var XV={closed:!0,next:ql,error:JV,complete:ql};var wa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wn(n){return n}function Dh(...n){return Jv(n)}function Jv(n){return n.length===0?wn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var fe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=t2(t)?t:new _a(t,r,i);return ya(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=nS(r),new r((i,o)=>{let s=new _a({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[wa](){return this}pipe(...t){return Jv(t)(this)}toPromise(t){return t=nS(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function nS(n){var e;return(e=n??Er.Promise)!==null&&e!==void 0?e:Promise}function e2(n){return n&&ye(n.next)&&ye(n.error)&&ye(n.complete)}function t2(n){return n&&n instanceof ts||e2(n)&&Th(n)}function Xv(n){return ye(n?.lift)}function Te(n){return e=>{if(Xv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function we(n,e,t,r,i){return new Wl(n,e,t,r,i)}var Wl=class extends ts{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ea(){return Te((n,e)=>{let t=null;n._refCount++;let r=we(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Ia=class extends fe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Xv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Tt;let t=this.getSubject();e.add(this.source.subscribe(we(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Tt.EMPTY)}return e}refCount(){return Ea()(this)}};var rS=ga(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var st=(()=>{class n extends fe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Sh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new rS}next(t){ya(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ya(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ya(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Gv:(this.currentObservers=null,o.push(t),new Tt(()=>{this.currentObservers=null,Xo(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new fe;return t.source=this,t}}return n.create=(e,t)=>new Sh(e,t),n})(),Sh=class extends st{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Gv}};var tn=class extends st{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var zl={now(){return(zl.delegate||Date).now()},delegate:void 0};var Gl=class extends st{constructor(e=1/0,t=1/0,r=zl){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var Ah=class extends Tt{constructor(e,t){super()}schedule(e,t=0){return this}};var Kl={setInterval(n,e,...t){let{delegate:r}=Kl;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Kl;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Ta=class extends Ah{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Kl.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Kl.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Xo(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ca=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Ca.now=zl.now;var ba=class extends Ca{constructor(e,t=Ca.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Da=new ba(Ta),ey=Da;var Rh=class extends Ta{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var xh=class extends ba{};var ty=new xh(Rh);var zn=new fe(n=>n.complete());function Nh(n){return n&&ye(n.schedule)}function iS(n){return n[n.length-1]}function Mh(n){return ye(iS(n))?n.pop():void 0}function to(n){return Nh(iS(n))?n.pop():void 0}function ny(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function sS(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(r.next(d))}catch(f){s(f)}}function c(d){try{u(r.throw(d))}catch(f){s(f)}}function u(d){d.done?o(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function oS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ns(n){return this instanceof ns?(this.v=n,this):new ns(n)}function aS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(v){return function(w){return Promise.resolve(w).then(v,f)}}function a(v,w){r[v]&&(i[v]=function(P){return new Promise(function(N,V){o.push([v,P,N,V])>1||c(v,P)})},w&&(i[v]=w(i[v])))}function c(v,w){try{u(r[v](w))}catch(P){m(o[0][3],P)}}function u(v){v.value instanceof ns?Promise.resolve(v.value.v).then(d,f):m(o[0][2],v)}function d(v){c("next",v)}function f(v){c("throw",v)}function m(v,w){v(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}function cS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof oS=="function"?oS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}}var Ph=n=>n&&typeof n.length=="number"&&typeof n!="function";function kh(n){return ye(n?.then)}function Oh(n){return ye(n[wa])}function Fh(n){return Symbol.asyncIterator&&ye(n?.[Symbol.asyncIterator])}function Lh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function n2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Vh=n2();function Uh(n){return ye(n?.[Vh])}function jh(n){return aS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ns(t.read());if(i)return yield ns(void 0);yield yield ns(r)}}finally{t.releaseLock()}})}function Bh(n){return ye(n?.getReader)}function Ct(n){if(n instanceof fe)return n;if(n!=null){if(Oh(n))return r2(n);if(Ph(n))return i2(n);if(kh(n))return o2(n);if(Fh(n))return lS(n);if(Uh(n))return s2(n);if(Bh(n))return a2(n)}throw Lh(n)}function r2(n){return new fe(e=>{let t=n[wa]();if(ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function i2(n){return new fe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function o2(n){return new fe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ch)})}function s2(n){return new fe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function lS(n){return new fe(e=>{c2(n,e).catch(t=>e.error(t))})}function a2(n){return lS(jh(n))}function c2(n,e){var t,r,i,o;return sS(this,void 0,void 0,function*(){try{for(t=cS(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Mn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function no(n,e=0){return Te((t,r)=>{t.subscribe(we(r,i=>Mn(r,n,()=>r.next(i),e),()=>Mn(r,n,()=>r.complete(),e),i=>Mn(r,n,()=>r.error(i),e)))})}function ro(n,e=0){return Te((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function uS(n,e){return Ct(n).pipe(ro(e),no(e))}function dS(n,e){return Ct(n).pipe(ro(e),no(e))}function hS(n,e){return new fe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function fS(n,e){return new fe(t=>{let r;return Mn(t,e,()=>{r=n[Vh](),Mn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>ye(r?.return)&&r.return()})}function $h(n,e){if(!n)throw new Error("Iterable cannot be null");return new fe(t=>{Mn(t,e,()=>{let r=n[Symbol.asyncIterator]();Mn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function pS(n,e){return $h(jh(n),e)}function mS(n,e){if(n!=null){if(Oh(n))return uS(n,e);if(Ph(n))return hS(n,e);if(kh(n))return dS(n,e);if(Fh(n))return $h(n,e);if(Uh(n))return fS(n,e);if(Bh(n))return pS(n,e)}throw Lh(n)}function lt(n,e){return e?mS(n,e):Ct(n)}function oe(...n){let e=to(n);return lt(n,e)}function Sa(n,e){let t=ye(n)?n:()=>n,r=i=>i.error(t());return new fe(e?i=>e.schedule(r,0,i):r)}function ry(n){return!!n&&(n instanceof fe||ye(n.lift)&&ye(n.subscribe))}var di=ga(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function gS(n){return n instanceof Date&&!isNaN(n)}function X(n,e){return Te((t,r)=>{let i=0;t.subscribe(we(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:l2}=Array;function u2(n,e){return l2(e)?n(...e):n(e)}function Hh(n){return X(e=>u2(n,e))}var{isArray:d2}=Array,{getPrototypeOf:h2,prototype:f2,keys:p2}=Object;function qh(n){if(n.length===1){let e=n[0];if(d2(e))return{args:e,keys:null};if(m2(e)){let t=p2(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function m2(n){return n&&typeof n=="object"&&h2(n)===f2}function Wh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function He(...n){let e=to(n),t=Mh(n),{args:r,keys:i}=qh(n);if(r.length===0)return lt([],e);let o=new fe(g2(r,e,i?s=>Wh(i,s):wn));return t?o.pipe(Hh(t)):o}function g2(n,e,t=wn){return r=>{vS(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)vS(e,()=>{let u=lt(n[c],e),d=!1;u.subscribe(we(r,f=>{o[c]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function vS(n,e,t){n?Mn(t,n,e):e()}function yS(n,e,t,r,i,o,s,a){let c=[],u=0,d=0,f=!1,m=()=>{f&&!c.length&&!u&&e.complete()},v=P=>u<r?w(P):c.push(P),w=P=>{o&&e.next(P),u++;let N=!1;Ct(t(P,d++)).subscribe(we(e,V=>{i?.(V),o?v(V):e.next(V)},()=>{N=!0},void 0,()=>{if(N)try{for(u--;c.length&&u<r;){let V=c.shift();s?Mn(e,s,()=>w(V)):w(V)}m()}catch(V){e.error(V)}}))};return n.subscribe(we(e,v,()=>{f=!0,m()})),()=>{a?.()}}function St(n,e,t=1/0){return ye(e)?St((r,i)=>X((o,s)=>e(r,o,i,s))(Ct(n(r,i))),t):(typeof e=="number"&&(t=e),Te((r,i)=>yS(r,i,n,t)))}function iy(n=1/0){return St(wn,n)}function _S(){return iy(1)}function Aa(...n){return _S()(lt(n,to(n)))}function zh(n){return new fe(e=>{Ct(n()).subscribe(e)})}function oy(...n){let e=Mh(n),{args:t,keys:r}=qh(n),i=new fe(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,u=s;for(let d=0;d<s;d++){let f=!1;Ct(t[d]).subscribe(we(o,m=>{f||(f=!0,u--),a[d]=m},()=>c--,void 0,()=>{(!c||!f)&&(u||o.next(r?Wh(r,a):a),o.complete())}))}});return e?i.pipe(Hh(e)):i}function sy(n=0,e,t=ey){let r=-1;return e!=null&&(Nh(e)?t=e:r=e),new fe(i=>{let o=gS(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function At(n=0,e=Da){return n<0&&(n=0),sy(n,n,e)}function En(n,e){return Te((t,r)=>{let i=0;t.subscribe(we(r,o=>n.call(e,o,i++)&&r.next(o)))})}function io(n){return Te((e,t)=>{let r=null,i=!1,o;r=e.subscribe(we(t,void 0,void 0,s=>{o=Ct(n(s,io(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function wS(n,e,t,r,i){return(o,s)=>{let a=t,c=e,u=0;o.subscribe(we(s,d=>{let f=u++;c=a?n(c,d,f):(a=!0,d),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function rs(n,e){return ye(e)?St(n,e,1):St(n,1)}function oo(n){return Te((e,t)=>{let r=!1;e.subscribe(we(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Hr(n){return n<=0?()=>zn:Te((e,t)=>{let r=0;e.subscribe(we(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Gh(n,e=wn){return n=n??v2,Te((t,r)=>{let i,o=!0;t.subscribe(we(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function v2(n,e){return n===e}function Kh(n=y2){return Te((e,t)=>{let r=!1;e.subscribe(we(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function y2(){return new di}function Yl(n){return Te((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function hi(n,e){let t=arguments.length>=2;return r=>r.pipe(n?En((i,o)=>n(i,o,r)):wn,Hr(1),t?oo(e):Kh(()=>new di))}function ay(n,e,t,r){return Te((i,o)=>{let s;!e||typeof e=="function"?s=e:{duration:t,element:s,connector:r}=e;let a=new Map,c=w=>{a.forEach(w),w(o)},u=w=>c(P=>P.error(w)),d=0,f=!1,m=new Wl(o,w=>{try{let P=n(w),N=a.get(P);if(!N){a.set(P,N=r?r():new st);let V=v(P,N);if(o.next(V),t){let z=we(N,()=>{N.complete(),z?.unsubscribe()},void 0,void 0,()=>a.delete(P));m.add(Ct(t(V)).subscribe(z))}}N.next(s?s(w):w)}catch(P){u(P)}},()=>c(w=>w.complete()),u,()=>a.clear(),()=>(f=!0,d===0));i.subscribe(m);function v(w,P){let N=new fe(V=>{d++;let z=P.subscribe(V);return()=>{z.unsubscribe(),--d===0&&f&&m.unsubscribe()}});return N.key=w,N}})}function Ra(n){return n<=0?()=>zn:Te((e,t)=>{let r=[];e.subscribe(we(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function cy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?En((i,o)=>n(i,o,r)):wn,Ra(1),t?oo(e):Kh(()=>new di))}function Yh(){return Te((n,e)=>{let t,r=!1;n.subscribe(we(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Qh(n,e){return Te(wS(n,e,arguments.length>=2,!0))}function xa(...n){let e=to(n);return Te((t,r)=>{(e?Aa(n,t,e):Aa(n,t)).subscribe(r)})}function Pn(n,e){return Te((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(we(r,c=>{i?.unsubscribe();let u=0,d=o++;Ct(n(c,d)).subscribe(i=we(r,f=>r.next(e?e(c,f,d,u++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Gt(n){return Te((e,t)=>{Ct(n).subscribe(we(t,()=>t.complete(),ql)),!t.closed&&e.subscribe(t)})}function nn(n,e,t){let r=ye(n)||e||t?{next:n,error:e,complete:t}:n;return r?Te((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(we(o,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),o.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):wn}var _2="https://g.co/ng/security#xss",Z=class extends Error{code;constructor(e,t){super(d_(e,t)),this.code=e}};function d_(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}var iA=Symbol("InputSignalNode#UNSET"),w2=he(U({},zv),{transformFn:void 0,applyValueToInputSignal(n,e){Eh(n,e)}});function oA(n,e){let t=Object.create(w2);t.value=n,t.transformFn=e?.transform;function r(){if(yh(t),t.value===iA)throw new Z(-950,!1);return t.value}return r[Nn]=t,r}function cu(n){return{toString:n}.toString()}var Zh="__parameters__";function E2(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function sA(n,e,t){return cu(()=>{let r=E2(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,u,d){let f=c.hasOwnProperty(Zh)?c[Zh]:Object.defineProperty(c,Zh,{value:[]})[Zh];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Zl=globalThis;function Ze(n){for(let e in n)if(n[e]===Ze)return e;throw Error("Could not find renamed property on target object.")}function I2(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function On(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(On).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function ES(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var T2=Ze({__forward_ref__:Ze});function sr(n){return n.__forward_ref__=sr,n.toString=function(){return On(this())},n}function In(n){return aA(n)?n():n}function aA(n){return typeof n=="function"&&n.hasOwnProperty(T2)&&n.__forward_ref__===sr}function j(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function vo(n){return{providers:n.providers||[],imports:n.imports||[]}}function Pf(n){return IS(n,lA)||IS(n,uA)}function cA(n){return Pf(n)!==null}function IS(n,e){return n.hasOwnProperty(e)?n[e]:null}function C2(n){let e=n&&(n[lA]||n[uA]);return e||null}function TS(n){return n&&(n.hasOwnProperty(CS)||n.hasOwnProperty(b2))?n[CS]:null}var lA=Ze({\u0275prov:Ze}),CS=Ze({\u0275inj:Ze}),uA=Ze({ngInjectableDef:Ze}),b2=Ze({ngInjectorDef:Ze}),H=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=j({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function dA(n){return n&&!!n.\u0275providers}var D2=Ze({\u0275cmp:Ze}),S2=Ze({\u0275dir:Ze}),A2=Ze({\u0275pipe:Ze}),R2=Ze({\u0275mod:Ze}),af=Ze({\u0275fac:Ze}),eu=Ze({__NG_ELEMENT_ID__:Ze}),bS=Ze({__NG_ENV_ID__:Ze});function h_(n){return typeof n=="string"?n:n==null?"":String(n)}function x2(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():h_(n)}function N2(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Z(-200,n)}function f_(n,e){throw new Z(-201,!1)}var be=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(be||{}),Ey;function hA(){return Ey}function kn(n){let e=Ey;return Ey=n,e}function fA(n,e,t){let r=Pf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&be.Optional)return null;if(e!==void 0)return e;f_(n,"Injector")}var M2={},tu=M2,Iy="__NG_DI_FLAG__",cf="ngTempTokenPath",P2="ngTokenPath",k2=/\n/gm,O2="\u0275",DS="__source",ka;function F2(){return ka}function so(n){let e=ka;return ka=n,e}function L2(n,e=be.Default){if(ka===void 0)throw new Z(-203,!1);return ka===null?fA(n,void 0,e):ka.get(n,e&be.Optional?null:void 0,e)}function de(n,e=be.Default){return(hA()||L2)(In(n),e)}function S(n,e=be.Default){return de(n,kf(e))}function kf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ty(n){let e=[];for(let t=0;t<n.length;t++){let r=In(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Z(900,!1);let i,o=be.Default;for(let s=0;s<r.length;s++){let a=r[s],c=V2(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(de(i,o))}else e.push(de(r))}return e}function pA(n,e){return n[Iy]=e,n.prototype[Iy]=e,n}function V2(n){return n[Iy]}function U2(n,e,t,r){let i=n[cf];throw e[DS]&&i.unshift(e[DS]),n.message=j2(`
`+n.message,i,t,r),n[P2]=i,n[cf]=null,n}function j2(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==O2?n.slice(2):n;let i=On(e);if(Array.isArray(e))i=e.map(On).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):On(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(k2,`
  `)}`}var Ee=pA(sA("Optional"),8);var B2=pA(sA("SkipSelf"),4);function ss(n,e){let t=n.hasOwnProperty(af);return t?n[af]:null}function p_(n,e){n.forEach(t=>Array.isArray(t)?p_(t,e):e(t))}function mA(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function lf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function $2(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function H2(n,e,t){let r=lu(n,e);return r>=0?n[r|1]=t:(r=~r,$2(n,r,e,t)),r}function ly(n,e){let t=lu(n,e);if(t>=0)return n[t|1]}function lu(n,e){return q2(n,e,1)}function q2(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Fa={},rr=[],La=new H(""),gA=new H("",-1),vA=new H(""),uf=class{get(e,t=tu){if(t===tu){let r=new Error(`NullInjectorError: No provider for ${On(e)}!`);throw r.name="NullInjectorError",r}return t}};function yA(n,e){let t=n[R2]||null;if(!t&&e===!0)throw new Error(`Type ${On(n)} does not have '\u0275mod' property.`);return t}function as(n){return n[D2]||null}function _A(n){return n[S2]||null}function wA(n){return n[A2]||null}function EA(n){let e=as(n)||_A(n)||wA(n);return e!==null&&e.standalone}function ut(n){return{\u0275providers:n}}function W2(...n){return{\u0275providers:IA(!0,n),\u0275fromNgModule:!0}}function IA(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return p_(e,s=>{let a=s;Cy(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&TA(i,o),t}function TA(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];m_(i,o=>{e(o,r)})}}function Cy(n,e,t,r){if(n=In(n),!n)return!1;let i=null,o=TS(n),s=!o&&as(n);if(!o&&!s){let c=n.ngModule;if(o=TS(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of c)Cy(u,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let u;try{p_(o.imports,d=>{Cy(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&TA(u,e)}if(!a){let u=ss(i)||(()=>new i);e({provide:i,useFactory:u,deps:rr},i),e({provide:vA,useValue:i,multi:!0},i),e({provide:La,useValue:()=>de(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let u=n;m_(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function m_(n,e){for(let t of n)dA(t)&&(t=t.\u0275providers),Array.isArray(t)?m_(t,e):e(t)}var z2=Ze({provide:String,useValue:Ze});function CA(n){return n!==null&&typeof n=="object"&&z2 in n}function G2(n){return!!(n&&n.useExisting)}function K2(n){return!!(n&&n.useFactory)}function Va(n){return typeof n=="function"}function Y2(n){return!!n.useClass}var Of=new H(""),ef={},Q2={},uy;function g_(){return uy===void 0&&(uy=new uf),uy}var Ln=class{},nu=class extends Ln{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,Dy(e,s=>this.processProvider(s)),this.records.set(gA,Na(void 0,this)),i.has("environment")&&this.records.set(Ln,Na(void 0,this));let o=this.records.get(Of);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(vA,rr,be.Self))}destroy(){Jl(this),this._destroyed=!0;let e=Me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Me(e)}}onDestroy(e){return Jl(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Jl(this);let t=so(this),r=kn(void 0),i;try{return e()}finally{so(t),kn(r)}}get(e,t=tu,r=be.Default){if(Jl(this),e.hasOwnProperty(bS))return e[bS](this);r=kf(r);let i,o=so(this),s=kn(void 0);try{if(!(r&be.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=tU(e)&&Pf(e);u&&this.injectableDefInScope(u)?c=Na(by(e),ef):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&be.Self?g_():this.parent;return t=r&be.Optional&&t===tu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[cf]=a[cf]||[]).unshift(On(e)),o)throw a;return U2(a,e,"R3InjectorError",this.source)}else throw a}finally{kn(s),so(o)}}resolveInjectorInitializers(){let e=Me(null),t=so(this),r=kn(void 0),i;try{let o=this.get(La,rr,be.Self);for(let s of o)s()}finally{so(t),kn(r),Me(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(On(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=In(e);let t=Va(e)?e:In(e&&e.provide),r=J2(e);if(!Va(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Na(void 0,ef,!0),i.factory=()=>Ty(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Me(null);try{return t.value===ef&&(t.value=Q2,t.value=t.factory()),typeof t.value=="object"&&t.value&&eU(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=In(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function by(n){let e=Pf(n),t=e!==null?e.factory:ss(n);if(t!==null)return t;if(n instanceof H)throw new Z(204,!1);if(n instanceof Function)return Z2(n);throw new Z(204,!1)}function Z2(n){if(n.length>0)throw new Z(204,!1);let t=C2(n);return t!==null?()=>t.factory(n):()=>new n}function J2(n){if(CA(n))return Na(void 0,n.useValue);{let e=bA(n);return Na(e,ef)}}function bA(n,e,t){let r;if(Va(n)){let i=In(n);return ss(i)||by(i)}else if(CA(n))r=()=>In(n.useValue);else if(K2(n))r=()=>n.useFactory(...Ty(n.deps||[]));else if(G2(n))r=()=>de(In(n.useExisting));else{let i=In(n&&(n.useClass||n.provide));if(X2(n))r=()=>new i(...Ty(n.deps));else return ss(i)||by(i)}return r}function Jl(n){if(n.destroyed)throw new Z(205,!1)}function Na(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function X2(n){return!!n.deps}function eU(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function tU(n){return typeof n=="function"||typeof n=="object"&&n instanceof H}function Dy(n,e){for(let t of n)Array.isArray(t)?Dy(t,e):t&&dA(t)?Dy(t.\u0275providers,e):e(t)}function Cn(n,e){n instanceof nu&&Jl(n);let t,r=so(n),i=kn(void 0);try{return e()}finally{so(r),kn(i)}}function DA(){return hA()!==void 0||F2()!=null}function Ga(n){if(!DA())throw new Z(-203,!1)}function nU(n){return typeof n=="function"}var vi=0,Se=1,ue=2,Tn=3,Tr=4,Cr=5,df=6,hf=7,or=8,Ua=9,lo=10,Pt=11,ru=12,SS=13,Ka=14,Wr=15,ja=16,Ma=17,Ba=18,Ff=19,SA=20,ao=21,tf=22,cs=23,Gn=24,Fn=25,AA=1;var ls=7,ff=8,pf=9,Kn=10;function co(n){return Array.isArray(n)&&typeof n[AA]=="object"}function yi(n){return Array.isArray(n)&&n[AA]===!0}function v_(n){return(n.flags&4)!==0}function Lf(n){return n.componentOffset>-1}function Vf(n){return(n.flags&1)===1}function uo(n){return!!n.template}function Sy(n){return(n[ue]&512)!==0}function uu(n){return(n[ue]&256)===256}var Ay=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function RA(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var yo=(()=>{let n=()=>xA;return n.ngInherit=!0,n})();function xA(n){return n.type.prototype.ngOnChanges&&(n.setInput=iU),rU}function rU(){let n=MA(this),e=n?.current;if(e){let t=n.previous;if(t===Fa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function iU(n,e,t,r,i){let o=this.declaredInputs[r],s=MA(n)||oU(n,{previous:Fa,current:null}),a=s.current||(s.current={}),c=s.previous,u=c[o];a[o]=new Ay(u&&u.currentValue,t,c===Fa),RA(n,e,i,t)}var NA="__ngSimpleChanges__";function MA(n){return n[NA]||null}function oU(n,e){return n[NA]=e}var AS=null;var ir=function(n,e,t){AS?.(n,e,t)},sU="svg",aU="math";function zr(n){for(;Array.isArray(n);)n=n[vi];return n}function PA(n,e){return zr(e[n])}function ar(n,e){return zr(e[n.index])}function y_(n,e){return n.data[e]}function cU(n,e){return n[e]}function _o(n,e){let t=e[n];return co(t)?t:t[vi]}function __(n){return(n[ue]&128)===128}function lU(n){return yi(n[Tn])}function $a(n,e){return e==null?null:n[e]}function kA(n){n[Ma]=0}function w_(n){n[ue]&1024||(n[ue]|=1024,__(n)&&du(n))}function uU(n,e){for(;n>0;)e=e[Ka],n--;return e}function Uf(n){return!!(n[ue]&9216||n[Gn]?.dirty)}function Ry(n){n[lo].changeDetectionScheduler?.notify(9),n[ue]&64&&(n[ue]|=1024),Uf(n)&&du(n)}function du(n){n[lo].changeDetectionScheduler?.notify(0);let e=us(n);for(;e!==null&&!(e[ue]&8192||(e[ue]|=8192,!__(e)));)e=us(e)}function OA(n,e){if(uu(n))throw new Z(911,!1);n[ao]===null&&(n[ao]=[]),n[ao].push(e)}function dU(n,e){if(n[ao]===null)return;let t=n[ao].indexOf(e);t!==-1&&n[ao].splice(t,1)}function us(n){let e=n[Tn];return yi(e)?e[Tn]:e}function hU(n){return n[hf]??=[]}function fU(n){return n.cleanup??=[]}var xe={lFrame:HA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var xy=!1;function pU(){return xe.lFrame.elementDepthCount}function mU(){xe.lFrame.elementDepthCount++}function gU(){xe.lFrame.elementDepthCount--}function FA(){return xe.bindingsEnabled}function vU(){return xe.skipHydrationRootTNode!==null}function yU(n){return xe.skipHydrationRootTNode===n}function _U(){xe.skipHydrationRootTNode=null}function qe(){return xe.lFrame.lView}function un(){return xe.lFrame.tView}function ft(n){return xe.lFrame.contextLView=n,n[or]}function pt(n){return xe.lFrame.contextLView=null,n}function dn(){let n=LA();for(;n!==null&&n.type===64;)n=n.parent;return n}function LA(){return xe.lFrame.currentTNode}function wU(){let n=xe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function gs(n,e){let t=xe.lFrame;t.currentTNode=n,t.isParent=e}function E_(){return xe.lFrame.isParent}function VA(){xe.lFrame.isParent=!1}function UA(){return xy}function mf(n){let e=xy;return xy=n,e}function I_(){let n=xe.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function EU(n){return xe.lFrame.bindingIndex=n}function hu(){return xe.lFrame.bindingIndex++}function IU(n){let e=xe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function TU(){return xe.lFrame.inI18n}function CU(n,e){let t=xe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Ny(e)}function bU(){return xe.lFrame.currentDirectiveIndex}function Ny(n){xe.lFrame.currentDirectiveIndex=n}function DU(n){let e=xe.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function jA(n){xe.lFrame.currentQueryIndex=n}function SU(n){let e=n[Se];return e.type===2?e.declTNode:e.type===1?n[Cr]:null}function BA(n,e,t){if(t&be.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&be.Host);)if(i=SU(o),i===null||(o=o[Ka],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=xe.lFrame=$A();return r.currentTNode=e,r.lView=n,!0}function T_(n){let e=$A(),t=n[Se];xe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function $A(){let n=xe.lFrame,e=n===null?null:n.child;return e===null?HA(n):e}function HA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function qA(){let n=xe.lFrame;return xe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var WA=qA;function C_(){let n=qA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function AU(n){return(xe.lFrame.contextLView=uU(n,xe.lFrame.contextLView))[or]}function Ya(){return xe.lFrame.selectedIndex}function ds(n){xe.lFrame.selectedIndex=n}function b_(){let n=xe.lFrame;return y_(n.tView,n.selectedIndex)}function RU(){return xe.lFrame.currentNamespace}var zA=!0;function jf(){return zA}function Bf(n){zA=n}function xU(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=xA(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function $f(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function nf(n,e,t){GA(n,e,3,t)}function rf(n,e,t,r){(n[ue]&3)===t&&GA(n,e,t,r)}function dy(n,e){let t=n[ue];(t&3)===e&&(t&=16383,t+=1,n[ue]=t)}function GA(n,e,t,r){let i=r!==void 0?n[Ma]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ma]+=65536),(a<o||o==-1)&&(NU(n,t,e,c),n[Ma]=(n[Ma]&4294901760)+c+2),c++}function RS(n,e){ir(4,n,e);let t=Me(null);try{e.call(n)}finally{Me(t),ir(5,n,e)}}function NU(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ue]>>14<n[Ma]>>16&&(n[ue]&3)===e&&(n[ue]+=16384,RS(a,o)):RS(a,o)}var Oa=-1,hs=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function MU(n){return n instanceof hs}function PU(n){return(n.flags&8)!==0}function kU(n){return(n.flags&16)!==0}function OU(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];LU(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function FU(n){return n===3||n===4||n===6}function LU(n){return n.charCodeAt(0)===64}function Ha(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?xS(n,t,i,null,e[++r]):xS(n,t,i,null,null))}}return n}function xS(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var hy={},My=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=kf(r);let i=this.injector.get(e,hy,r);return i!==hy||t===hy?i:this.parentInjector.get(e,t,r)}};function KA(n){return n!==Oa}function gf(n){return n&32767}function VU(n){return n>>16}function vf(n,e){let t=VU(n),r=e;for(;t>0;)r=r[Ka],t--;return r}var Py=!0;function yf(n){let e=Py;return Py=n,e}var UU=256,YA=UU-1,QA=5,jU=0,qr={};function BU(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(eu)&&(r=t[eu]),r==null&&(r=t[eu]=jU++);let i=r&YA,o=1<<i;e.data[n+(i>>QA)]|=o}function _f(n,e){let t=ZA(n,e);if(t!==-1)return t;let r=e[Se];r.firstCreatePass&&(n.injectorIndex=e.length,fy(r.data,n),fy(e,null),fy(r.blueprint,null));let i=D_(n,e),o=n.injectorIndex;if(KA(i)){let s=gf(i),a=vf(i,e),c=a[Se].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|c[s+u]}return e[o+8]=i,o}function fy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ZA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function D_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=nR(i),r===null)return Oa;if(t++,i=i[Ka],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Oa}function ky(n,e,t){BU(n,e,t)}function JA(n,e,t){if(t&be.Optional||n!==void 0)return n;f_(e,"NodeInjector")}function XA(n,e,t,r){if(t&be.Optional&&r===void 0&&(r=null),!(t&(be.Self|be.Host))){let i=n[Ua],o=kn(void 0);try{return i?i.get(e,r,t&be.Optional):fA(e,r,t&be.Optional)}finally{kn(o)}}return JA(r,e,t)}function eR(n,e,t,r=be.Default,i){if(n!==null){if(e[ue]&2048&&!(r&be.Self)){let s=zU(n,e,t,r,qr);if(s!==qr)return s}let o=tR(n,e,t,r,qr);if(o!==qr)return o}return XA(e,t,r,i)}function tR(n,e,t,r,i){let o=qU(t);if(typeof o=="function"){if(!BA(e,n,r))return r&be.Host?JA(i,t,r):XA(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&be.Optional))f_(t);else return s}finally{WA()}}else if(typeof o=="number"){let s=null,a=ZA(n,e),c=Oa,u=r&be.Host?e[Wr][Cr]:null;for((a===-1||r&be.SkipSelf)&&(c=a===-1?D_(n,e):e[a+8],c===Oa||!MS(r,!1)?a=-1:(s=e[Se],a=gf(c),e=vf(c,e)));a!==-1;){let d=e[Se];if(NS(o,a,d.data)){let f=$U(a,e,t,s,r,u);if(f!==qr)return f}c=e[a+8],c!==Oa&&MS(r,e[Se].data[a+8]===u)&&NS(o,a,e)?(s=d,a=gf(c),e=vf(c,e)):a=-1}}return i}function $U(n,e,t,r,i,o){let s=e[Se],a=s.data[n+8],c=r==null?Lf(a)&&Py:r!=s&&(a.type&3)!==0,u=i&be.Host&&o===a,d=HU(a,s,t,c,u);return d!==null?qa(e,s,d,a):qr}function HU(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,u=n.directiveEnd,d=o>>20,f=r?a:a+d,m=i?a+d:u;for(let v=f;v<m;v++){let w=s[v];if(v<c&&t===w||v>=c&&w.type===t)return v}if(i){let v=s[c];if(v&&uo(v)&&v.type===t)return c}return null}function qa(n,e,t,r){let i=n[t],o=e.data;if(MU(i)){let s=i;s.resolving&&N2(x2(o[t]));let a=yf(s.canSeeViewProviders);s.resolving=!0;let c,u=s.injectImpl?kn(s.injectImpl):null,d=BA(n,r,be.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&xU(t,o[t],e)}finally{u!==null&&kn(u),yf(a),s.resolving=!1,WA()}}return i}function qU(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(eu)?n[eu]:void 0;return typeof e=="number"?e>=0?e&YA:WU:e}function NS(n,e,t){let r=1<<n;return!!(t[e+(n>>QA)]&r)}function MS(n,e){return!(n&be.Self)&&!(n&be.Host&&e)}var os=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return eR(this._tNode,this._lView,e,kf(r),t)}};function WU(){return new os(dn(),qe())}function br(n){return cu(()=>{let e=n.prototype.constructor,t=e[af]||Oy(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[af]||Oy(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Oy(n){return aA(n)?()=>{let e=Oy(In(n));return e&&e()}:ss(n)}function zU(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ue]&2048&&!(s[ue]&512);){let a=tR(o,s,t,r|be.Self,qr);if(a!==qr)return a;let c=o.parent;if(!c){let u=s[SA];if(u){let d=u.get(t,qr,r);if(d!==qr)return d}c=nR(s),s=s[Ka]}o=c}return i}function nR(n){let e=n[Se],t=e.type;return t===2?e.declTNode:t===1?n[Cr]:null}function PS(n,e=null,t=null,r){let i=rR(n,e,t,r);return i.resolveInjectorInitializers(),i}function rR(n,e=null,t=null,r,i=new Set){let o=[t||rr,W2(n)];return r=r||(typeof n=="object"?void 0:On(n)),new nu(o,e||g_(),r||null,i)}var De=class n{static THROW_IF_NOT_FOUND=tu;static NULL=new uf;static create(e,t){if(Array.isArray(e))return PS({name:""},t,e,"");{let r=e.name??"";return PS({name:r},e.parent,e.providers,r)}}static \u0275prov=j({token:n,providedIn:"any",factory:()=>de(gA)});static __NG_ELEMENT_ID__=-1};var GU=new H("");GU.__NG_ELEMENT_ID__=n=>{let e=dn();if(e===null)throw new Z(204,!1);if(e.type&2)return e.value;if(n&be.Optional)return null;throw new Z(204,!1)};var iR=!1,_i=(()=>{class n{static __NG_ELEMENT_ID__=KU;static __NG_ENV_ID__=t=>t}return n})(),wf=class extends _i{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return OA(this._lView,e),()=>dU(this._lView,e)}};function KU(){return new wf(qe())}var fs=class{},Hf=new H("",{providedIn:"root",factory:()=>!1});var oR=new H(""),sR=new H(""),wo=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new tn(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),qf=(()=>{class n{internalPendingTasks=S(wo);scheduler=S(fs);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(12),this.internalPendingTasks.remove(t))}}run(t){return y(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),Fy=class extends st{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,DA()&&(this.destroyRef=S(_i,{optional:!0})??void 0,this.pendingTasks=S(wo,{optional:!0})??void 0)}emit(e){let t=Me(null);try{super.next(e)}finally{Me(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Tt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Kt=Fy;function iu(...n){}function aR(n){let e,t;function r(){n=iu;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function kS(n){return queueMicrotask(()=>n()),()=>{n=iu}}var S_="isAngularZone",Ef=S_+"_ID",YU=0,pe=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Kt(!1);onMicrotaskEmpty=new Kt(!1);onStable=new Kt(!1);onError=new Kt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=iR}=e;if(typeof Zone>"u")throw new Z(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,JU(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(S_)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Z(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Z(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,QU,iu,iu);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},QU={};function A_(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ZU(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){aR(()=>{n.callbackScheduled=!1,Ly(n),n.isCheckStableRunning=!0,A_(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Ly(n)}function JU(n){let e=()=>{ZU(n)},t=YU++;n._inner=n._inner.fork({name:"angular",properties:{[S_]:!0,[Ef]:t,[Ef+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(XU(c))return r.invokeTask(o,s,a,c);try{return OS(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),FS(n)}},onInvoke:(r,i,o,s,a,c,u)=>{try{return OS(n),r.invoke(o,s,a,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!ej(c)&&e(),FS(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Ly(n),A_(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Ly(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function OS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function FS(n){n._nesting--,A_(n)}var Vy=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Kt;onMicrotaskEmpty=new Kt;onStable=new Kt;onError=new Kt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function XU(n){return cR(n,"__ignore_ng_zone__")}function ej(n){return cR(n,"__scheduler_tick__")}function cR(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var fi=class{_console=console;handleError(e){this._console.error("ERROR",e)}},tj=new H("",{providedIn:"root",factory:()=>{let n=S(pe),e=S(fi);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function LS(n,e){return oA(n,e)}function nj(n){return oA(iA,n)}var lR=(LS.required=nj,LS);function rj(){return Wf(dn(),qe())}function Wf(n,e){return new cr(ar(n,e))}var cr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=rj}return n})();var VS=new Set;function Eo(n){VS.has(n)||(VS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function ij(n){return typeof n=="function"&&n[Nn]!==void 0}function J(n,e){Eo("NgSignals");let t=KD(n),r=t[Nn];return e?.equal&&(r.equal=e.equal),t.set=i=>Eh(r,i),t.update=i=>YD(r,i),t.asReadonly=oj.bind(t),t}function oj(){let n=this[Nn];if(n.readonlyFn===void 0){let e=()=>this();e[Nn]=n,n.readonlyFn=e}return n.readonlyFn}function uR(n){return ij(n)&&typeof n.set=="function"}function dR(n){return(n.flags&128)===128}var hR=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(hR||{}),fR=new Map,sj=0;function aj(){return sj++}function cj(n){fR.set(n[Ff],n)}function Uy(n){fR.delete(n[Ff])}var US="__ngContext__";function ho(n,e){co(e)?(n[US]=e[Ff],cj(e)):n[US]=e}function pR(n){return gR(n[ru])}function mR(n){return gR(n[Tr])}function gR(n){for(;n!==null&&!yi(n);)n=n[Tr];return n}var jy;function vR(n){jy=n}function lj(){if(jy!==void 0)return jy;if(typeof document<"u")return document;throw new Z(210,!1)}var R_=new H("",{providedIn:"root",factory:()=>uj}),uj="ng",x_=new H(""),kt=new H("",{providedIn:"platform",factory:()=>"unknown"});var N_=new H("",{providedIn:"root",factory:()=>lj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var dj="h",hj="b";var yR=!1,fj=new H("",{providedIn:"root",factory:()=>yR});var _R=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(_R||{}),zf=new H("");var pj=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})();var mj=()=>null;function M_(n,e,t=!1){return mj(n,e,t)}function wR(n,e){let t=n.contentQueries;if(t!==null){let r=Me(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];jA(o),a.contentQueries(2,e[s],s)}}}finally{Me(r)}}}function By(n,e,t){jA(0);let r=Me(null);try{e(n,t)}finally{Me(r)}}function P_(n,e,t){if(v_(e)){let r=Me(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Me(r)}}}var Gr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Gr||{});var $y=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${_2})`}};function k_(n){return n instanceof $y?n.changingThisBreaksApplicationSecurity:n}var gj=/^>|^->|<!--|-->|--!>|<!-$/g,vj=/(<|>)/g,yj="\u200B$1\u200B";function _j(n){return n.replace(gj,e=>e.replace(vj,yj))}function ER(n){return n instanceof Function?n():n}var fo=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(fo||{});function wj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var IR="ng-template";function Ej(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&wj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(O_(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function O_(n){return n.type===4&&n.value!==IR}function Ij(n,e,t){let r=n.type===4&&!t?IR:n.value;return e===r}function Tj(n,e,t){let r=4,i=n.attrs,o=i!==null?Dj(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Ir(r)&&!Ir(c))return!1;if(s&&Ir(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Ij(n,c,t)||c===""&&e.length===1){if(Ir(r))return!1;s=!0}}else if(r&8){if(i===null||!Ej(n,i,c,t)){if(Ir(r))return!1;s=!0}}else{let u=e[++a],d=Cj(c,i,O_(n),t);if(d===-1){if(Ir(r))return!1;s=!0;continue}if(u!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&u!==f){if(Ir(r))return!1;s=!0}}}}return Ir(r)||s}function Ir(n){return(n&1)===0}function Cj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return Sj(e,n)}function bj(n,e,t=!1){for(let r=0;r<e.length;r++)if(Tj(n,e[r],t))return!0;return!1}function Dj(n){for(let e=0;e<n.length;e++){let t=n[e];if(FU(t))return e}return n.length}function Sj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function jS(n,e){return n?":not("+e.trim()+")":e}function Aj(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Ir(s)&&(e+=jS(o,i),i=""),r=s,o=o||!Ir(r);t++}return i!==""&&(e+=jS(o,i)),e}function Rj(n){return n.map(Aj).join(",")}function xj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Ir(i))break;i=o}r++}return{attrs:e,classes:t}}var Io={};function k(n=1){TR(un(),qe(),Ya()+n,!1)}function TR(n,e,t,r){if(!r)if((e[ue]&3)===3){let o=n.preOrderCheckHooks;o!==null&&nf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&rf(e,o,0,t)}ds(t)}function Ne(n,e=be.Default){let t=qe();if(t===null)return de(n,e);let r=dn();return eR(r,t,In(n),e)}function CR(n,e,t,r,i,o){let s=Me(null);try{let a=null;i&fo.SignalBased&&(a=e[r][Nn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&fo.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):RA(e,a,r,o)}finally{Me(s)}}function Nj(n,e){return n.createText(e)}function Mj(n,e,t){n.setValue(e,t)}function Pj(n,e){return n.createComment(_j(e))}function bR(n,e,t){return n.createElement(e,t)}function If(n,e,t,r,i){n.insertBefore(e,t,r,i)}function DR(n,e,t){n.appendChild(e,t)}function BS(n,e,t,r,i){r!==null?If(n,e,t,r,i):DR(n,e,t)}function kj(n,e,t){n.removeChild(null,e,t)}function Oj(n,e,t){n.setAttribute(e,"style",t)}function Fj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function SR(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&OU(n,e,r),i!==null&&Fj(n,e,i),o!==null&&Oj(n,e,o)}function Gf(n,e,t,r,i,o,s,a,c,u,d){let f=e.blueprint.slice();return f[vi]=i,f[ue]=r|4|128|8|64|1024,(u!==null||n&&n[ue]&2048)&&(f[ue]|=2048),kA(f),f[Tn]=f[Ka]=n,f[or]=t,f[lo]=s||n&&n[lo],f[Pt]=a||n&&n[Pt],f[Ua]=c||n&&n[Ua]||null,f[Cr]=o,f[Ff]=aj(),f[df]=d,f[SA]=u,f[Wr]=e.type==2?n[Wr]:f,f}function AR(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function RR(n,e,t,r,i){let o=Ya(),s=r&2;try{ds(-1),s&&e.length>Fn&&TR(n,e,Fn,!1),ir(s?2:0,i),t(r,i)}finally{ds(o),ir(s?3:1,i)}}function F_(n,e,t){FA()&&(zj(n,e,t,ar(t,e)),(t.flags&64)===64&&PR(n,e,t))}function L_(n,e,t=ar){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function xR(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=V_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function V_(n,e,t,r,i,o,s,a,c,u,d){let f=Fn+r,m=f+i,v=Lj(f,m),w=typeof u=="function"?u():u;return v[Se]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function Lj(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Io);return t}function Vj(n,e,t,r){let o=r.get(fj,yR)||t===Gr.ShadowDom,s=n.selectRootElement(e,o);return Uj(s),s}function Uj(n){jj(n)}var jj=()=>null;function $S(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=fo.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let u=o;if(i!==null){if(!i.hasOwnProperty(o))continue;u=i[o]}n===0?HS(r,t,u,a,c):HS(r,t,u,a)}return r}function HS(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function Bj(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let f=o[d],m=t?t.get(f):null,v=m?m.inputs:null,w=m?m.outputs:null;c=$S(0,f.inputs,d,c,v),u=$S(1,f.outputs,d,u,w);let P=c!==null&&s!==null&&!O_(e)?rB(c,d,s):null;a.push(P)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function $j(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function NR(n,e,t,r,i,o,s,a){let c=ar(e,t),u=e.inputs,d;!a&&u!=null&&(d=u[r])?(j_(n,t,d,r,i),Lf(e)&&Hj(t,e.index)):e.type&3?(r=$j(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function Hj(n,e){let t=_o(e,n);t[ue]&16||(t[ue]|=64)}function U_(n,e,t,r){if(FA()){let i=r===null?null:{"":-1},o=Kj(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&MR(n,e,t,s,i,a),i&&Yj(t,r,i)}t.mergedAttrs=Ha(t.mergedAttrs,t.attrs)}function MR(n,e,t,r,i,o){for(let u=0;u<r.length;u++)ky(_f(t,e),n,r[u].type);Zj(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let s=!1,a=!1,c=AR(n,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];t.mergedAttrs=Ha(t.mergedAttrs,d.hostAttrs),Jj(n,t,e,c,d),Qj(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!s&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}Bj(n,t,o)}function qj(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;Wj(s)!=a&&s.push(a),s.push(t,r,o)}}function Wj(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function zj(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;Lf(t)&&Xj(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||_f(t,e),ho(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],u=qa(e,n,a,t);if(ho(u,e),s!==null&&nB(e,a-i,u,c,t,s),uo(c)){let d=_o(t.index,e);d[or]=qa(e,n,a,t)}}}function PR(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=bU();try{ds(o);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];Ny(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Gj(c,u)}}finally{ds(-1),Ny(s)}}function Gj(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Kj(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(bj(e,s.selectors,!1))if(r||(r=[]),uo(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;Hy(n,e,c)}else r.unshift(s),Hy(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Hy(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Yj(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Z(-301,!1);r.push(e[i],o)}}}function Qj(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;uo(e)&&(t[""]=n)}}function Zj(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Jj(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=ss(i.type,!0)),s=new hs(o,uo(i),Ne);n.blueprint[r]=s,t[r]=s,qj(n,e,r,AR(n,t,i.hostVars,Io),i)}function kR(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function Xj(n,e,t){let r=ar(e,n),i=xR(t),o=n[lo].rendererFactory,s=Kf(n,Gf(n,i,null,kR(t),r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=s}function eB(n,e,t,r,i,o){let s=ar(n,e);tB(e[Pt],s,o,n.value,t,r,i)}function tB(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?h_(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function nB(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],u=s[a++],d=s[a++],f=s[a++];CR(r,t,c,u,d,f)}}function rB(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function OR(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Kf(n,e){return n[ru]?n[SS][Tr]=e:n[ru]=e,n[SS]=e,e}function FR(n,e){let t=n[Ua],r=t?t.get(fi,null):null;r&&r.handleError(e)}function j_(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],u=e[s],d=n.data[s];CR(d,u,r,a,c,i)}}function iB(n,e){let t=_o(e,n),r=t[Se];oB(r,t);let i=t[vi];i!==null&&t[df]===null&&(t[df]=M_(i,t[Ua])),B_(r,t,t[or])}function oB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function B_(n,e,t){T_(e);try{let r=n.viewQuery;r!==null&&By(1,r,t);let i=n.template;i!==null&&RR(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ba]?.finishViewCreation(n),n.staticContentQueries&&wR(n,e),n.staticViewQueries&&By(2,n.viewQuery,t);let o=n.components;o!==null&&sB(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ue]&=-5,C_()}}function sB(n,e){for(let t=0;t<e.length;t++)iB(n,e[t])}var pi=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(pi||{}),aB;function $_(n,e){return aB(n,e)}function Pa(n,e,t,r,i){if(r!=null){let o,s=!1;yi(r)?o=r:co(r)&&(s=!0,r=r[vi]);let a=zr(r);n===0&&t!==null?i==null?DR(e,t,a):If(e,t,a,i||null,!0):n===1&&t!==null?If(e,t,a,i||null,!0):n===2?kj(e,a,s):n===3&&e.destroyNode(a),o!=null&&wB(e,n,o,t,i)}}function cB(n,e){LR(n,e),e[vi]=null,e[Cr]=null}function lB(n,e,t,r,i,o){r[vi]=i,r[Cr]=e,Qf(n,r,t,1,i,o)}function LR(n,e){e[lo].changeDetectionScheduler?.notify(10),Qf(n,e,e[Pt],2,null,null)}function uB(n){let e=n[ru];if(!e)return py(n[Se],n);for(;e;){let t=null;if(co(e))t=e[ru];else{let r=e[Kn];r&&(t=r)}if(!t){for(;e&&!e[Tr]&&e!==n;)co(e)&&py(e[Se],e),e=e[Tn];e===null&&(e=n),co(e)&&py(e[Se],e),t=e&&e[Tr]}e=t}}function dB(n,e,t,r){let i=Kn+r,o=t.length;r>0&&(t[i-1][Tr]=e),r<o-Kn?(e[Tr]=t[i],mA(t,Kn+r,e)):(t.push(e),e[Tr]=null),e[Tn]=t;let s=e[ja];s!==null&&t!==s&&VR(s,e);let a=e[Ba];a!==null&&a.insertView(n),Ry(e),e[ue]|=128}function VR(n,e){let t=n[pf],r=e[Tn];if(co(r))n[ue]|=2;else{let i=r[Tn][Wr];e[Wr]!==i&&(n[ue]|=2)}t===null?n[pf]=[e]:t.push(e)}function H_(n,e){let t=n[pf],r=t.indexOf(e);t.splice(r,1)}function Tf(n,e){if(n.length<=Kn)return;let t=Kn+e,r=n[t];if(r){let i=r[ja];i!==null&&i!==n&&H_(i,r),e>0&&(n[t-1][Tr]=r[Tr]);let o=lf(n,Kn+e);cB(r[Se],r);let s=o[Ba];s!==null&&s.detachView(o[Se]),r[Tn]=null,r[Tr]=null,r[ue]&=-129}return r}function q_(n,e){if(uu(e))return;let t=e[Pt];t.destroyNode&&Qf(n,e,t,3,null,null),uB(e)}function py(n,e){if(uu(e))return;let t=Me(null);try{e[ue]&=-129,e[ue]|=256,e[Gn]&&ma(e[Gn]),fB(n,e),hB(n,e),e[Se].type===1&&e[Pt].destroy();let r=e[ja];if(r!==null&&yi(e[Tn])){r!==e[Tn]&&H_(r,e);let i=e[Ba];i!==null&&i.detachView(n)}Uy(e)}finally{Me(t)}}function hB(n,e){let t=n.cleanup,r=e[hf];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[hf]=null);let i=e[ao];if(i!==null){e[ao]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[cs];if(o!==null){e[cs]=null;for(let s of o)s.destroy()}}function fB(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof hs)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];ir(4,a,c);try{c.call(a)}finally{ir(5,a,c)}}else{ir(4,i,o);try{o.call(i)}finally{ir(5,i,o)}}}}}function pB(n,e,t){return mB(n,e.parent,t)}function mB(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[vi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===Gr.None||o===Gr.Emulated)return null}return ar(r,t)}}function gB(n,e,t){return yB(n,e,t)}function vB(n,e,t){return n.type&40?ar(n,t):null}var yB=vB,qS;function Yf(n,e,t,r){let i=pB(n,r,e),o=e[Pt],s=r.parent||e[Cr],a=gB(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)BS(o,i,t[c],a,!1);else BS(o,i,t,a,!1);qS!==void 0&&qS(o,r,e,t,i)}function Xl(n,e){if(e!==null){let t=e.type;if(t&3)return ar(e,n);if(t&4)return qy(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Xl(n,r);{let i=n[e.index];return yi(i)?qy(-1,i):zr(i)}}else{if(t&128)return Xl(n,e.next);if(t&32)return $_(e,n)()||zr(n[e.index]);{let r=UR(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=us(n[Wr]);return Xl(i,r)}else return Xl(n,e.next)}}}return null}function UR(n,e){if(e!==null){let r=n[Wr][Cr],i=e.projection;return r.projection[i]}return null}function qy(n,e){let t=Kn+n+1;if(t<e.length){let r=e[t],i=r[Se].firstChild;if(i!==null)return Xl(r,i)}return e[ls]}function W_(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&ho(zr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)W_(n,e,t.child,r,i,o,!1),Pa(e,n,i,a,o);else if(c&32){let u=$_(t,r),d;for(;d=u();)Pa(e,n,i,d,o);Pa(e,n,i,a,o)}else c&16?_B(n,e,r,t,i,o):Pa(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Qf(n,e,t,r,i,o){W_(t,r,n.firstChild,e,i,o,!1)}function _B(n,e,t,r,i,o){let s=t[Wr],c=s[Cr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];Pa(e,n,i,d,o)}else{let u=c,d=s[Tn];dR(r)&&(u.flags|=128),W_(n,e,u,d,i,o,!0)}}function wB(n,e,t,r,i){let o=t[ls],s=zr(t);o!==s&&Pa(e,n,r,o,i);for(let a=Kn;a<t.length;a++){let c=t[a];Qf(c[Se],c,n,e,r,o)}}function EB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:pi.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=pi.Important),n.setStyle(t,r,i,o))}}function jR(n,e,t,r){let i=Me(null);try{let o=e.tView,a=n[ue]&4096?4096:16,c=Gf(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[ja]=u;let d=n[Ba];return d!==null&&(c[Ba]=d.createEmbeddedView(o)),B_(o,c,t),c}finally{Me(i)}}function IB(n,e){let t=Kn+e;if(t<n.length)return n[t]}function Wy(n,e){return!e||e.firstChild===null||dR(n)}function BR(n,e,t,r=!0){let i=e[Se];if(dB(i,e,n,t),r){let s=qy(t,n),a=e[Pt],c=a.parentNode(n[ls]);c!==null&&lB(i,n[Cr],a,e,c,s)}let o=e[df];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function TB(n,e){let t=Tf(n,e);return t!==void 0&&q_(t[Se],t),t}function Cf(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(zr(o)),yi(o)&&CB(o,r);let s=t.type;if(s&8)Cf(n,e,t.child,r);else if(s&32){let a=$_(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=UR(e,t);if(Array.isArray(a))r.push(...a);else{let c=us(e[Wr]);Cf(c[Se],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function CB(n,e){for(let t=Kn;t<n.length;t++){let r=n[t],i=r[Se].firstChild;i!==null&&Cf(r[Se],r,i,e)}n[ls]!==n[vi]&&e.push(n[ls])}var $R=[];function bB(n){return n[Gn]??DB(n)}function DB(n){let e=$R.pop()??Object.create(AB);return e.lView=n,e}function SB(n){n.lView[Gn]!==n&&(n.lView=null,$R.push(n))}var AB=he(U({},Jo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{du(n.lView)},consumerOnSignalRead(){this.lView[Gn]=this}});function RB(n){let e=n[Gn]??Object.create(xB);return e.lView=n,e}var xB=he(U({},Jo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=us(n.lView);for(;e&&!HR(e[Se]);)e=us(e);e&&w_(e)},consumerOnSignalRead(){this.lView[Gn]=this}});function HR(n){return n.type!==2}function qR(n){if(n[cs]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[cs])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ue]&8192)}}var NB=100;function WR(n,e=!0,t=0){let i=n[lo].rendererFactory,o=!1;o||i.begin?.();try{MB(n,t)}catch(s){throw e&&FR(n,s),s}finally{o||i.end?.()}}function MB(n,e){let t=UA();try{mf(!0),zy(n,e);let r=0;for(;Uf(n);){if(r===NB)throw new Z(103,!1);r++,zy(n,1)}}finally{mf(t)}}function PB(n,e,t,r){if(uu(e))return;let i=e[ue],o=!1,s=!1;T_(e);let a=!0,c=null,u=null;o||(HR(n)?(u=bB(e),c=pa(u)):LD()===null?(a=!1,u=RB(e),c=pa(u)):e[Gn]&&(ma(e[Gn]),e[Gn]=null));try{kA(e),EU(n.bindingStartIndex),t!==null&&RR(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let v=n.preOrderCheckHooks;v!==null&&nf(e,v,null)}else{let v=n.preOrderHooks;v!==null&&rf(e,v,0,null),dy(e,0)}if(s||kB(e),qR(e),zR(e,0),n.contentQueries!==null&&wR(n,e),!o)if(d){let v=n.contentCheckHooks;v!==null&&nf(e,v)}else{let v=n.contentHooks;v!==null&&rf(e,v,1),dy(e,1)}FB(n,e);let f=n.components;f!==null&&KR(e,f,0);let m=n.viewQuery;if(m!==null&&By(2,m,r),!o)if(d){let v=n.viewCheckHooks;v!==null&&nf(e,v)}else{let v=n.viewHooks;v!==null&&rf(e,v,2),dy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[tf]){for(let v of e[tf])v();e[tf]=null}o||(e[ue]&=-73)}catch(d){throw o||du(e),d}finally{u!==null&&($l(u,c),a&&SB(u)),C_()}}function zR(n,e){for(let t=pR(n);t!==null;t=mR(t))for(let r=Kn;r<t.length;r++){let i=t[r];GR(i,e)}}function kB(n){for(let e=pR(n);e!==null;e=mR(e)){if(!(e[ue]&2))continue;let t=e[pf];for(let r=0;r<t.length;r++){let i=t[r];w_(i)}}}function OB(n,e,t){let r=_o(e,n);GR(r,t)}function GR(n,e){__(n)&&zy(n,e)}function zy(n,e){let r=n[Se],i=n[ue],o=n[Gn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Hl(o)),s||=!1,o&&(o.dirty=!1),n[ue]&=-9217,s)PB(r,n,r.template,n[or]);else if(i&8192){qR(n),zR(n,1);let a=r.components;a!==null&&KR(n,a,1)}}function KR(n,e,t){for(let r=0;r<e.length;r++)OB(n,e[r],t)}function FB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ds(~i);else{let o=i,s=t[++r],a=t[++r];CU(s,o);let c=e[o];ir(24,c),a(2,c),ir(25,c)}}}finally{ds(-1)}}function z_(n,e){let t=UA()?64:1088;for(n[lo].changeDetectionScheduler?.notify(e);n;){n[ue]|=t;let r=us(n);if(Sy(n)&&!r)return n;n=r}return null}var ps=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[Se];return Cf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[or]}get dirty(){return!!(this._lView[ue]&9280)||!!this._lView[Gn]?.dirty}set context(e){this._lView[or]=e}get destroyed(){return uu(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Tn];if(yi(e)){let t=e[ff],r=t?t.indexOf(this):-1;r>-1&&(Tf(e,r),lf(t,r))}this._attachedToViewContainer=!1}q_(this._lView[Se],this._lView)}onDestroy(e){OA(this._lView,e)}markForCheck(){z_(this._cdRefInjectingView||this._lView,4)}markForRefresh(){w_(this._cdRefInjectingView||this._lView)}detach(){this._lView[ue]&=-129}reattach(){Ry(this._lView),this._lView[ue]|=128}detectChanges(){this._lView[ue]|=1024,WR(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Sy(this._lView),t=this._lView[ja];t!==null&&!e&&H_(t,this._lView),LR(this._lView[Se],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Z(902,!1);this._appRef=e;let t=Sy(this._lView),r=this._lView[ja];r!==null&&!t&&VR(r,this._lView),Ry(this._lView)}},G_=(()=>{class n{static __NG_ELEMENT_ID__=UB}return n})(),LB=G_,VB=class extends LB{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=jR(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new ps(i)}};function UB(){return jB(dn(),qe())}function jB(n,e){return n.type&4?new VB(e,n,Wf(n,e)):null}function fu(n,e,t,r,i){let o=n.data[e];if(o===null)o=BB(n,e,t,r,i),TU()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=wU();o.injectorIndex=s===null?-1:s.injectorIndex}return gs(o,!0),o}function BB(n,e,t,r,i){let o=LA(),s=E_(),a=s?o:o&&o.parent,c=n.data[e]=HB(n,a,t,e,r,i);return $B(n,c,o,s),c}function $B(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function HB(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return vU()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Poe=new RegExp(`^(\\d+)*(${hj}|${dj})*(.*)`);var qB=()=>null;function Gy(n,e){return qB(n,e)}var Ky=class{},bf=class{},Yy=class{resolveComponentFactory(e){throw Error(`No component factory found for ${On(e)}.`)}},po=class{static NULL=new Yy},Wa=class{},wi=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>WB()}return n})();function WB(){let n=qe(),e=dn(),t=_o(e.index,n);return(co(t)?t:n)[Pt]}var zB=(()=>{class n{static \u0275prov=j({token:n,providedIn:"root",factory:()=>null})}return n})();function Df(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=ES(i,a);else if(o==2){let c=a,u=e[++s];r=ES(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Sf=class extends po{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=as(e);return new ou(t,this.ngModule)}};function WS(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:fo.None;e?t.push({propName:s,templateName:r,isSignal:(a&fo.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function GB(n){let e=n.toLowerCase();return e==="svg"?sU:e==="math"?aU:null}function KB(n){let{attrs:e,classes:t}=xj(n),r=e;return t.length&&r.push(1,...t),r}var ou=class extends bf{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,t=e.inputTransforms,r=WS(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return WS(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Rj(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=Me(null);try{i=i||this.ngModule;let s=i instanceof Ln?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new My(e,s):e,c=a.get(Wa,null);if(c===null)throw new Z(407,!1);let u=a.get(zB,null),d=a.get(fs,null),f={rendererFactory:c,sanitizer:u,changeDetectionScheduler:d},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",w=r?Vj(m,r,this.componentDef.encapsulation,a):bR(m,v,GB(v)),P=512;this.componentDef.signals?P|=4096:this.componentDef.onPush||(P|=16);let N=null;w!==null&&(N=M_(w,a,!0));let V=V_(0,null,null,1,0,null,null,null,null,null,null),z=Gf(null,V,null,P,null,null,f,m,a,null,N);z[Fn]=w,T_(z);let Y,re=null;try{let le=this.componentDef,D,_=null;le.findHostDirectiveDefs?(D=[],_=new Map,le.findHostDirectiveDefs(le,D,_),D.push(le)):D=[le];let E=r?["ng-version","19.1.3"]:KB(this.componentDef.selectors[0]),b=fu(V,Fn,2,"#host",E);for(let A of D)b.mergedAttrs=Ha(b.mergedAttrs,A.hostAttrs);b.mergedAttrs=Ha(b.mergedAttrs,E),Df(b,b.mergedAttrs,!0),w&&SR(m,w,b),re=YB(b,w,le,D,z,f),t!==void 0&&ZB(b,this.ngContentSelectors,t),Y=QB(re,le,D,_,z,[JB]),B_(V,z,null)}catch(le){throw re!==null&&Uy(re),Uy(z),le}finally{C_()}let it=y_(V,Fn);return new Qy(this.componentType,Y,Wf(it,z),z,it)}finally{Me(o)}}},Qy=class extends Ky{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new ps(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;j_(o[Se],o,i,e,t),this.previousInputValues.set(e,t);let s=_o(this._tNode.index,o);z_(s,1)}}get injector(){return new os(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function YB(n,e,t,r,i,o){let s=i[Se],a=null;e!==null&&(a=M_(e,i[Ua]));let c=o.rendererFactory.createRenderer(e,t),u=Gf(i,xR(t),null,kR(t),i[n.index],n,o,c,null,null,a);return s.firstCreatePass&&Hy(s,n,r.length-1),Kf(i,u),i[n.index]=u}function QB(n,e,t,r,i,o){let s=dn(),a=i[Se],c=ar(s,i);MR(a,i,s,t,null,r);for(let d=0;d<t.length;d++){let f=s.directiveStart+d,m=qa(i,a,f,s);ho(m,i)}PR(a,i,s),c&&ho(c,i);let u=qa(i,a,s.directiveStart+s.componentOffset,s);if(n[or]=i[or]=u,o!==null)for(let d of o)d(u,e);return P_(a,s,i),u}function ZB(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}function JB(){let n=dn();$f(qe()[Se],n)}var vs=(()=>{class n{static __NG_ELEMENT_ID__=XB}return n})();function XB(){let n=dn();return t$(n,qe())}var e$=vs,YR=class extends e${_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Wf(this._hostTNode,this._hostLView)}get injector(){return new os(this._hostTNode,this._hostLView)}get parentInjector(){let e=D_(this._hostTNode,this._hostLView);if(KA(e)){let t=vf(e,this._hostLView),r=gf(e),i=t[Se].data[r+8];return new os(i,t)}else return new os(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=zS(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Kn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=Gy(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,Wy(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!nU(e),a;if(s)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,o=w.environmentInjector||w.ngModuleRef}let c=s?e:new ou(as(e)),u=r||this.parentInjector;if(!o&&c.ngModule==null){let P=(s?u:this.parentInjector).get(Ln,null);P&&(o=P)}let d=as(c.componentType??{}),f=Gy(this._lContainer,d?.id??null),m=f?.firstChild??null,v=c.create(u,i,m,o);return this.insertImpl(v.hostView,a,Wy(this._hostTNode,f)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(lU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Tn],u=new YR(c,c[Cr],c[Tn]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return BR(s,i,o,r),e.attachToViewContainerRef(),mA(my(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=zS(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Tf(this._lContainer,t);r&&(lf(my(this._lContainer),t),q_(r[Se],r))}detach(e){let t=this._adjustIndex(e,-1),r=Tf(this._lContainer,t);return r&&lf(my(this._lContainer),t)!=null?new ps(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function zS(n){return n[ff]}function my(n){return n[ff]||(n[ff]=[])}function t$(n,e){let t,r=e[n.index];return yi(r)?t=r:(t=OR(r,e,null,n),e[n.index]=t,Kf(e,t)),r$(t,e,n,r),new YR(t,n,e)}function n$(n,e){let t=n[Pt],r=t.createComment(""),i=ar(e,n),o=t.parentNode(i);return If(t,o,r,t.nextSibling(i),!1),r}var r$=s$,i$=()=>!1;function o$(n,e,t){return i$(n,e,t)}function s$(n,e,t,r){if(n[ls])return;let i;t.type&8?i=zr(r):i=n$(e,t),n[ls]=i}var mo=class{},su=class{};var Zy=class extends mo{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Sf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=yA(e);this._bootstrapComponents=ER(o.bootstrap),this._r3Injector=rR(e,t,[{provide:mo,useValue:this},{provide:po,useValue:this.componentFactoryResolver},...r],On(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Jy=class extends su{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Zy(this.moduleType,e,[])}};var Af=class extends mo{injector;componentFactoryResolver=new Sf(this);instance=null;constructor(e){super();let t=new nu([...e.providers,{provide:mo,useValue:this},{provide:po,useValue:this.componentFactoryResolver}],e.parent||g_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function K_(n,e,t=null){return new Af({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var a$=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=IA(!1,t.type),i=r.length>0?K_([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=j({token:n,providedIn:"environment",factory:()=>new n(de(Ln))})}return n})();function Le(n){return cu(()=>{let e=ZR(n),t=he(U({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===hR.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(a$).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Gr.Emulated,styles:n.styles||rr,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Eo("NgStandalone"),JR(t);let r=n.dependencies;return t.directiveDefs=KS(r,!1),t.pipeDefs=KS(r,!0),t.id=u$(t),t})}function c$(n){return as(n)||_A(n)}function l$(n){return n!==null}function To(n){return cu(()=>({type:n.type,bootstrap:n.bootstrap||rr,declarations:n.declarations||rr,imports:n.imports||rr,exports:n.exports||rr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function GS(n,e){if(n==null)return Fa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=fo.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==fo.None?[r,a]:r,e[o]=s):t[o]=r}return t}function at(n){return cu(()=>{let e=ZR(n);return JR(e),e})}function QR(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function ZR(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Fa,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||rr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:GS(n.inputs,e),outputs:GS(n.outputs),debugInfo:null}}function JR(n){n.features?.forEach(e=>e(n))}function KS(n,e){if(!n)return null;let t=e?wA:c$;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(l$)}function u$(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function d$(n){return Object.getPrototypeOf(n.prototype).constructor}function Vn(n){let e=d$(n.type),t=!0,r=[n];for(;e;){let i;if(uo(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Z(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=Jh(n.inputs),s.inputTransforms=Jh(n.inputTransforms),s.declaredInputs=Jh(n.declaredInputs),s.outputs=Jh(n.outputs);let a=i.hostBindings;a&&g$(n,a);let c=i.viewQuery,u=i.contentQueries;if(c&&p$(n,c),u&&m$(n,u),h$(n,i),I2(n.outputs,i.outputs),uo(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Vn&&(t=!1)}}e=Object.getPrototypeOf(e)}f$(r)}function h$(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function f$(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Ha(i.hostAttrs,t=Ha(t,i.hostAttrs))}}function Jh(n){return n===Fa?{}:n===rr?[]:n}function p$(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function m$(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function g$(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function XR(n){return y$(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function v$(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function y$(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function ex(n,e,t){return n[e]=t}function mi(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function _$(n,e,t,r){let i=mi(n,e,t);return mi(n,e+1,r)||i}function w$(n){return(n.flags&32)===32}function E$(n,e,t,r,i,o,s,a,c){let u=e.consts,d=fu(e,n,4,s||null,a||null);U_(e,t,d,$a(u,c)),$f(e,d);let f=d.tView=V_(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function I$(n,e,t,r,i,o,s,a,c,u){let d=t+Fn,f=e.firstCreatePass?E$(d,e,n,r,i,o,s,a,c):e.data[d];gs(f,!1);let m=T$(e,n,f,t);jf()&&Yf(e,n,m,f),ho(m,n);let v=OR(m,n,m,f);return n[d]=v,Kf(n,v),o$(v,f,n),Vf(f)&&F_(e,n,f),c!=null&&L_(n,f,u),f}function ee(n,e,t,r,i,o,s,a){let c=qe(),u=un(),d=$a(u.consts,o);return I$(c,u,n,e,t,r,i,d,s,a),ee}var T$=C$;function C$(n,e,t,r){return Bf(!0),e[Pt].createComment("")}var Y_=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var tx=new H("");function ys(n){return!!n&&typeof n.then=="function"}function nx(n){return!!n&&typeof n.subscribe=="function"}var rx=new H("");var ix=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=S(rx,{optional:!0})??[];injector=S(De);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Cn(this.injector,i);if(ys(o))t.push(o);else if(nx(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ox=(()=>{class n{static \u0275prov=j({token:n,providedIn:"root",factory:()=>new Rf})}return n})(),Rf=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},Q_=new H("");function b$(){GD(()=>{throw new Z(600,!1)})}function D$(n){return n.isBoundToModule}var S$=10;function A$(n,e,t){try{let r=t();return ys(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var go=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=S(tj);afterRenderManager=S(pj);zonelessEnabled=S(Hf);rootEffectScheduler=S(ox);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new st;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=S(wo).hasPendingTasks.pipe(X(t=>!t));constructor(){S(zf,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=S(Ln);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){let i=t instanceof bf;if(!this._injector.get(ix).done){let m=!i&&EA(t),v=!1;throw new Z(405,v)}let s;i?s=t:s=this._injector.get(po).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=D$(s)?void 0:this._injector.get(mo),c=r||s.selector,u=s.create(De.NULL,[],c,a),d=u.location.nativeElement,f=u.injector.get(tx,null);return f?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),of(this.components,u),f?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(_R.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new Z(101,!1);let t=Me(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Me(t),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Wa,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;this.dirtyFlags!==0&&t++<S$;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)R$(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Uf(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;of(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Q_,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>of(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Z(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function of(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function R$(n,e,t,r){if(!t&&!Uf(n))return;WR(n,e,t&&!r?0:1)}function pu(n,e,t,r){let i=qe(),o=hu();if(mi(i,o,e)){let s=un(),a=b_();eB(a,i,n,e,t,r)}return pu}function x$(n,e,t,r){return mi(n,hu(),t)?e+h_(t)+r:Io}function Xh(n,e){return n<<17|e<<2}function ms(n){return n>>17&32767}function N$(n){return(n&2)==2}function M$(n,e){return n&131071|e<<17}function Xy(n){return n|2}function za(n){return(n&131068)>>2}function gy(n,e){return n&-131069|e<<2}function P$(n){return(n&1)===1}function e_(n){return n|1}function k$(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=ms(s),c=za(s);n[r]=t;let u=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||lu(f,d)>0)&&(u=!0)}else d=t;if(i)if(c!==0){let m=ms(n[a+1]);n[r+1]=Xh(m,a),m!==0&&(n[m+1]=gy(n[m+1],r)),n[a+1]=M$(n[a+1],r)}else n[r+1]=Xh(a,0),a!==0&&(n[a+1]=gy(n[a+1],r)),a=r;else n[r+1]=Xh(c,0),a===0?a=r:n[c+1]=gy(n[c+1],r),c=r;u&&(n[r+1]=Xy(n[r+1])),YS(n,d,r,!0),YS(n,d,r,!1),O$(e,d,n,r,o),s=Xh(a,c),o?e.classBindings=s:e.styleBindings=s}function O$(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&lu(o,e)>=0&&(t[r+1]=e_(t[r+1]))}function YS(n,e,t,r){let i=n[t+1],o=e===null,s=r?ms(i):za(i),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],u=n[s+1];F$(c,e)&&(a=!0,n[s+1]=r?e_(u):Xy(u)),s=r?ms(u):za(u)}a&&(n[t+1]=r?Xy(i):e_(i))}function F$(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?lu(n,e)>=0:!1}function Q(n,e,t){let r=qe(),i=hu();if(mi(r,i,e)){let o=un(),s=b_();NR(o,s,r,n,e,r[Pt],t,!1)}return Q}function QS(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";j_(n,t,o[s],s,r)}function Qa(n,e,t){return sx(n,e,t,!1),Qa}function Zf(n,e){return sx(n,e,null,!0),Zf}function sx(n,e,t,r){let i=qe(),o=un(),s=IU(2);if(o.firstUpdatePass&&V$(o,n,s,r),e!==Io&&mi(i,s,e)){let a=o.data[Ya()];H$(o,a,i,i[Pt],n,i[s+1]=q$(e,t),r,s)}}function L$(n,e){return e>=n.expandoStartIndex}function V$(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Ya()],s=L$(n,t);W$(o,r)&&e===null&&!s&&(e=!1),e=U$(i,o,e,r),k$(i,o,e,t,s,r)}}function U$(n,e,t,r){let i=DU(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=vy(null,n,e,t,r),t=au(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=vy(i,n,e,t,r),o===null){let c=j$(n,e,r);c!==void 0&&Array.isArray(c)&&(c=vy(null,n,e,c[1],r),c=au(c,e.attrs,r),B$(n,e,r,c))}else o=$$(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function j$(n,e,t){let r=t?e.classBindings:e.styleBindings;if(za(r)!==0)return n[ms(r)]}function B$(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[ms(i)]=r}function $$(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=au(r,s,t)}return au(r,e.attrs,t)}function vy(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=au(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function au(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),H2(n,s,t?!0:e[++o]))}return n===void 0?null:n}function H$(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let c=n.data,u=c[a+1],d=P$(u)?ZS(c,e,t,i,za(u),s):void 0;if(!xf(d)){xf(o)||N$(u)&&(o=ZS(c,null,t,i,a,s));let f=PA(Ya(),t);EB(r,s,f,i,o)}}function ZS(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let c=n[i],u=Array.isArray(c),d=u?c[1]:c,f=d===null,m=t[i+1];m===Io&&(m=f?rr:void 0);let v=f?ly(m,r):d===r?m:void 0;if(u&&!xf(v)&&(v=ly(c,r)),xf(v)&&(a=v,s))return a;let w=n[i+1];i=s?ms(w):za(w)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=ly(c,r))}return a}function xf(n){return n!==void 0}function q$(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=On(k_(n)))),n}function W$(n,e){return(n.flags&(e?8:16))!==0}function se(n,e){Eo("NgControlFlow");let t=qe(),r=hu(),i=t[r]!==Io?t[r]:-1,o=i!==-1?JS(t,Fn+i):void 0,s=0;if(mi(t,r,n)){let a=Me(null);try{if(o!==void 0&&TB(o,s),n!==-1){let c=Fn+n,u=JS(t,c),d=z$(t[Se],c),f=Gy(u,d.tView.ssrId),m=jR(t,d,e,{dehydratedView:f});BR(u,m,s,Wy(d,f))}}finally{Me(a)}}else if(o!==void 0){let a=IB(o,s);a!==void 0&&(a[or]=e)}}function JS(n,e){return n[e]}function z$(n,e){return y_(n,e)}function G$(n,e,t,r,i,o){let s=e.consts,a=$a(s,i),c=fu(e,n,2,r,a);return U_(e,t,c,$a(s,o)),c.attrs!==null&&Df(c,c.attrs,!1),c.mergedAttrs!==null&&Df(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function T(n,e,t,r){let i=qe(),o=un(),s=Fn+n,a=i[Pt],c=o.firstCreatePass?G$(s,o,i,e,t,r):o.data[s],u=K$(o,i,c,a,e,n);i[s]=u;let d=Vf(c);return gs(c,!0),SR(a,u,c),!w$(c)&&jf()&&Yf(o,i,u,c),pU()===0&&ho(u,i),mU(),d&&(F_(o,i,c),P_(o,c,i)),r!==null&&L_(i,c),T}function C(){let n=dn();E_()?VA():(n=n.parent,gs(n,!1));let e=n;yU(e)&&_U(),gU();let t=un();return t.firstCreatePass&&($f(t,n),v_(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&PU(e)&&QS(t,e,qe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&kU(e)&&QS(t,e,qe(),e.stylesWithoutHost,!1),C}function Ce(n,e,t,r){return T(n,e,t,r),C(),Ce}var K$=(n,e,t,r,i,o)=>(Bf(!0),bR(r,i,RU()));function Y$(n,e,t,r,i){let o=e.consts,s=$a(o,r),a=fu(e,n,8,"ng-container",s);s!==null&&Df(a,s,!0);let c=$a(o,i);return U_(e,t,a,c),e.queries!==null&&e.queries.elementStart(e,a),a}function Z_(n,e,t){let r=qe(),i=un(),o=n+Fn,s=i.firstCreatePass?Y$(o,i,r,e,t):i.data[o];gs(s,!0);let a=Q$(i,r,s,n);return r[o]=a,jf()&&Yf(i,r,a,s),ho(a,r),Vf(s)&&(F_(i,r,s),P_(i,s,r)),t!=null&&L_(r,s),Z_}function J_(){let n=dn(),e=un();return E_()?VA():(n=n.parent,gs(n,!1)),e.firstCreatePass&&($f(e,n),v_(n)&&e.queries.elementEnd(n)),J_}var Q$=(n,e,t,r)=>(Bf(!0),Pj(e[Pt],""));function Ei(){return qe()}var is=void 0;function Z$(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var J$=["en",[["a","p"],["AM","PM"],is],[["AM","PM"],is,is],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],is,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],is,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",is,"{1} 'at' {0}",is],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",Z$],yy={};function lr(n){let e=X$(n),t=XS(e);if(t)return t;let r=e.split("-")[0];if(t=XS(r),t)return t;if(r==="en")return J$;throw new Z(701,!1)}function XS(n){return n in yy||(yy[n]=Zl.ng&&Zl.ng.common&&Zl.ng.common.locales&&Zl.ng.common.locales[n]),yy[n]}var Rt=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Rt||{});function X$(n){return n.toLowerCase().replace(/_/g,"-")}var Nf="en-US";var eH=Nf;function tH(n){typeof n=="string"&&(eH=n.toLowerCase().replace(/_/g,"-"))}var nH=(n,e,t)=>{};function ce(n,e,t,r){let i=qe(),o=un(),s=dn();return ax(o,i,i[Pt],s,n,e,r),ce}function rH(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[hf],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function ax(n,e,t,r,i,o,s){let a=Vf(r),u=n.firstCreatePass&&fU(n),d=e[or],f=hU(e),m=!0;if(r.type&3||s){let P=ar(r,e),N=s?s(P):P,V=f.length,z=s?re=>s(zr(re[r.index])):r.index,Y=null;if(!s&&a&&(Y=rH(n,e,i,r.index)),Y!==null){let re=Y.__ngLastListenerFn__||Y;re.__ngNextListenerFn__=o,Y.__ngLastListenerFn__=o,m=!1}else{o=tA(r,e,d,o),nH(P,i,o);let re=t.listen(N,i,o);f.push(o,re),u&&u.push(i,z,V,V+1)}}else o=tA(r,e,d,o);let v=r.outputs,w;if(m&&v!==null&&(w=v[i])){let P=w.length;if(P)for(let N=0;N<P;N+=2){let V=w[N],z=w[N+1],it=e[V][z].subscribe(o),le=f.length;f.push(o,it),u&&u.push(i,r.index,le,-(le+1))}}}function eA(n,e,t,r){let i=Me(null);try{return ir(6,e,t),t(r)!==!1}catch(o){return FR(n,o),!1}finally{ir(7,e,t),Me(i)}}function tA(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?_o(n.index,e):e;z_(s,5);let a=eA(e,t,r,o),c=i.__ngNextListenerFn__;for(;c;)a=eA(e,t,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function q(n=1){return AU(n)}function iH(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function x(n,e=""){let t=qe(),r=un(),i=n+Fn,o=r.firstCreatePass?fu(r,i,1,e,null):r.data[i],s=oH(r,t,o,e,n);t[i]=s,jf()&&Yf(r,t,s,o),gs(o,!1)}var oH=(n,e,t,r,i)=>(Bf(!0),Nj(e[Pt],r));function mt(n){return G("",n,""),mt}function G(n,e,t){let r=qe(),i=x$(r,n,e,t);return i!==Io&&sH(r,Ya(),i),G}function sH(n,e,t){let r=PA(e,n);Mj(n[Pt],r,t)}function Dr(n,e,t){uR(e)&&(e=e());let r=qe(),i=hu();if(mi(r,i,e)){let o=un(),s=b_();NR(o,s,r,n,e,r[Pt],t,!1)}return Dr}function Kr(n,e){let t=uR(n);return t&&n.set(e),t}function Sr(n,e){let t=qe(),r=un(),i=dn();return ax(r,t,t[Pt],i,n,e),Sr}function aH(n,e,t){let r=un();if(r.firstCreatePass){let i=uo(n);t_(t,r.data,r.blueprint,i,!0),t_(e,r.data,r.blueprint,i,!1)}}function t_(n,e,t,r,i){if(n=In(n),Array.isArray(n))for(let o=0;o<n.length;o++)t_(n[o],e,t,r,i);else{let o=un(),s=qe(),a=dn(),c=Va(n)?n:In(n.provide),u=bA(n),d=a.providerIndexes&1048575,f=a.directiveStart,m=a.providerIndexes>>20;if(Va(n)||!n.multi){let v=new hs(u,i,Ne),w=wy(c,e,i?d:d+m,f);w===-1?(ky(_f(a,s),o,c),_y(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(v),s.push(v)):(t[w]=v,s[w]=v)}else{let v=wy(c,e,d+m,f),w=wy(c,e,d,d+m),P=v>=0&&t[v],N=w>=0&&t[w];if(i&&!N||!i&&!P){ky(_f(a,s),o,c);let V=uH(i?lH:cH,t.length,i,r,u);!i&&N&&(t[w].providerFactory=V),_y(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(V),s.push(V)}else{let V=cx(t[i?w:v],u,!i&&r);_y(o,n,v>-1?v:w,V)}!i&&r&&N&&t[w].componentProviders++}}}function _y(n,e,t,r){let i=Va(e),o=Y2(e);if(i||o){let c=(o?In(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[r,c]):u[d+1].push(r,c)}else u.push(t,c)}}}function cx(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function wy(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function cH(n,e,t,r){return n_(this.multi,[])}function lH(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=qa(t,t[Se],this.providerFactory.index,r);o=a.slice(0,s),n_(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],n_(i,o);return o}function n_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function uH(n,e,t,r,i){let o=new hs(n,t,Ne);return o.multi=[],o.index=e,o.componentProviders=0,cx(o,i,r&&!t),o}function Yr(n,e=[]){return t=>{t.providersResolver=(r,i)=>aH(r,i?i(n):n,e)}}function tt(n,e,t,r){return dH(qe(),I_(),n,e,t,r)}function Ar(n,e,t,r,i){return ux(qe(),I_(),n,e,t,r,i)}function lx(n,e){let t=n[e];return t===Io?void 0:t}function dH(n,e,t,r,i,o){let s=e+t;return mi(n,s,i)?ex(n,s+1,o?r.call(o,i):r(i)):lx(n,s+1)}function ux(n,e,t,r,i,o,s){let a=e+t;return _$(n,a,i,o)?ex(n,a+2,s?r.call(s,i,o):r(i,o)):lx(n,a+2)}function Ii(n,e){let t=un(),r,i=n+Fn;t.firstCreatePass?(r=hH(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=ss(r.type,!0)),s,a=kn(Ne);try{let c=yf(!1),u=o();return yf(c),iH(t,qe(),i,u),u}finally{kn(a)}}function hH(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Ti(n,e,t,r){let i=n+Fn,o=qe(),s=cU(o,i);return fH(o,i)?ux(o,I_(),e,s.transform,t,r,s):s.transform(t,r)}function fH(n,e){return n[Se].data[e].pure}var gi=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},dx=new gi("19.1.3"),r_=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},X_=(()=>{class n{compileModuleSync(t){return new Jy(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=yA(t),o=ER(i.declarations).reduce((s,a)=>{let c=as(a);return c&&s.push(new ou(c)),s},[]);return new r_(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var pH=(()=>{class n{zone=S(pe);changeDetectionScheduler=S(fs);applicationRef=S(go);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mH=new H("",{factory:()=>!1});function hx({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new pe(he(U({},px()),{scheduleInRootZone:t})),[{provide:pe,useFactory:n},{provide:La,multi:!0,useFactory:()=>{let r=S(pH,{optional:!0});return()=>r.initialize()}},{provide:La,multi:!0,useFactory:()=>{let r=S(gH);return()=>{r.initialize()}}},e===!0?{provide:oR,useValue:!0}:[],{provide:sR,useValue:t??iR}]}function fx(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=hx({ngZoneFactory:()=>{let i=px(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Eo("NgZone_CoalesceEvent"),new pe(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return ut([{provide:mH,useValue:!0},{provide:Hf,useValue:!1},r])}function px(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var gH=(()=>{class n{subscription=new Tt;initialized=!1;zone=S(pe);pendingTasks=S(wo);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{pe.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{pe.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var vH=(()=>{class n{appRef=S(go);taskService=S(wo);ngZone=S(pe);zonelessEnabled=S(Hf);tracing=S(zf,{optional:!0});disableScheduling=S(oR,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Ef):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(S(sR,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Vy||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?kS:aR;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Ef+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,kS(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yH(){return typeof $localize<"u"&&$localize.locale||Nf}var Jf=new H("",{providedIn:"root",factory:()=>S(Jf,be.Optional|be.SkipSelf)||yH()});var i_=new H(""),_H=new H("");function Ql(n){return!n.moduleRef}function wH(n){let e=Ql(n)?n.r3Injector:n.moduleRef.injector,t=e.get(pe);return t.run(()=>{Ql(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(fi,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),Ql(n)){let o=()=>e.destroy(),s=n.platformInjector.get(i_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(i_);s.add(o),n.moduleRef.onDestroy(()=>{of(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return A$(r,t,()=>{let o=e.get(ix);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Jf,Nf);if(tH(s||Nf),!e.get(_H,!0))return Ql(n)?e.get(go):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Ql(n)){let c=e.get(go);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return EH(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function EH(n,e){let t=n.injector.get(go);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Z(-403,!1);e.push(n)}var sf=null;function IH(n=[],e){return De.create({name:e,providers:[{provide:Of,useValue:"platform"},{provide:i_,useValue:new Set([()=>sf=null])},...n]})}function TH(n=[]){if(sf)return sf;let e=IH(n);return sf=e,b$(),CH(e),e}function CH(n){let e=n.get(x_,null);Cn(n,()=>{e?.forEach(t=>t())})}function ew(){return!1}var Co=(()=>{class n{static __NG_ELEMENT_ID__=bH}return n})();function bH(n){return DH(dn(),qe(),(n&16)===16)}function DH(n,e,t){if(Lf(n)&&!t){let r=_o(n.index,e);return new ps(r,r)}else if(n.type&175){let r=e[Wr];return new ps(r,e)}return null}var o_=class{constructor(){}supports(e){return XR(e)}create(e){return new s_(e)}},SH=(n,e)=>e,s_=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||SH}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<nA(r,i,o)?t:r,a=nA(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let u=a-i,d=c-i;if(u!=d){for(let m=0;m<u;m++){let v=m<o.length?o[m]:o[m]=0,w=v+m;d<=w&&w<u&&(o[m]=v+1)}let f=s.previousIndex;o[f]=d-u}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!XR(e))throw new Z(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,v$(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new a_(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Mf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Mf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},a_=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},c_=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Mf=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new c_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function nA(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function rA(){return new tw([new o_])}var tw=(()=>{class n{factories;static \u0275prov=j({token:n,providedIn:"root",factory:rA});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||rA()),deps:[[n,new B2,new Ee]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Z(901,!1)}}return n})();function mx(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=TH(r),o=[hx({}),{provide:fs,useExisting:vH},...t||[]],s=new Af({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return wH({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function mu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Ae(n,e){Eo("NgSignals");let t=qD(n);return e?.equal&&(t[Nn].equal=e.equal),t}function ur(n){let e=Me(null);try{return n()}finally{Me(e)}}var gx=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=AH}return n})();function AH(){return new gx(qe(),dn())}var RH=!1,xH=(()=>{class n extends Rf{pendingTasks=S(wo);taskId=null;schedule(t){super.schedule(t),this.taskId===null&&(this.taskId=this.pendingTasks.add(),queueMicrotask(()=>this.flush()))}flush(){try{super.flush()}finally{this.taskId!==null&&(this.pendingTasks.remove(this.taskId),this.taskId=null)}}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),l_=class{scheduler;effectFn;zone;injector;unregisterOnDestroy;watcher;constructor(e,t,r,i,o,s){this.scheduler=e,this.effectFn=t,this.zone=r,this.injector=o,this.watcher=QD(a=>this.runEffect(a),()=>this.schedule(),s),this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(fi,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.schedule(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function NH(){}function vx(n,e){Eo("NgSignals"),!e?.injector&&Ga(NH);let t=e?.injector??S(De),r=e?.manualCleanup!==!0?t.get(_i):null,i=new l_(t.get(xH),n,typeof Zone>"u"?null:Zone.current,r,t,e?.allowSignalWrites??!1),o=t.get(Co,null,{optional:!0});return!o||!(o._lView[ue]&8)?i.watcher.notify():(o._lView[tf]??=[]).push(i.watcher.notify),i}var MH=RH;var u_=class{[Nn];constructor(e){this[Nn]=e}destroy(){this[Nn].destroy()}};function Rr(n,e){if(MH)return vx(n,e);Eo("NgSignals"),!e?.injector&&Ga(Rr);let t=e?.injector??S(De),r=e?.manualCleanup!==!0?t.get(_i):null,i,o=t.get(gx,null,{optional:!0}),s=t.get(fs);return o!==null&&!e?.forceRoot?(i=OH(o.view,s,n),r instanceof wf&&r._lView===o.view&&(r=null)):i=FH(n,t.get(ox),s),i.injector=t,r!==null&&(i.onDestroyFn=r.onDestroy(()=>i.destroy())),new u_(i)}var yx=he(U({},Jo),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:iu,run(){if(this.dirty=!1,this.hasRun&&!Hl(this))return;this.hasRun=!0;let n=r=>(this.cleanupFns??=[]).push(r),e=pa(this),t=mf(!1);try{this.maybeCleanup(),this.fn(n)}finally{mf(t),$l(this,e)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),PH=he(U({},yx),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(13)},destroy(){ma(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),kH=he(U({},yx),{consumerMarkedDirty(){this.view[ue]|=8192,du(this.view),this.notifier.notify(14)},destroy(){ma(this),this.onDestroyFn(),this.maybeCleanup(),this.view[cs]?.delete(this)}});function OH(n,e,t){let r=Object.create(kH);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=t,n[cs]??=new Set,n[cs].add(r),r.consumerMarkedDirty(r),r}function FH(n,e,t){let r=Object.create(PH);return r.fn=n,r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.schedule(r),r.notifier.notify(13),r}var Cx=null;function bi(){return Cx}function bx(n){Cx??=n}var ap=class{};var Un=new H(""),Dx=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(UH),providedIn:"platform"})}return n})();var UH=(()=>{class n extends Dx{_location;_history;_doc=S(Un);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return bi().getBaseHref(this._doc)}onPopState(t){let r=bi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=bi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Sx(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function _x(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function _s(n){return n&&n[0]!=="?"?"?"+n:n}var up=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(Ax),providedIn:"root"})}return n})(),jH=new H(""),Ax=(()=>{class n extends up{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??S(Un).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Sx(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+_s(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+_s(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+_s(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(de(Dx),de(jH,8))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var gu=(()=>{class n{_subject=new st;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=HH(_x(wx(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+_s(r))}normalize(t){return n.stripTrailingSlash($H(this._basePath,wx(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_s(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_s(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=_s;static joinWithSlash=Sx;static stripTrailingSlash=_x;static \u0275fac=function(r){return new(r||n)(de(up))};static \u0275prov=j({token:n,factory:()=>BH(),providedIn:"root"})}return n})();function BH(){return new gu(de(up))}function $H(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function wx(n){return n.replace(/\/index.html$/,"")}function HH(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var bn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(bn||{}),Je=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Je||{}),Yn=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Yn||{}),bo={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function qH(n){return lr(n)[Rt.LocaleId]}function WH(n,e,t){let r=lr(n),i=[r[Rt.DayPeriodsFormat],r[Rt.DayPeriodsStandalone]],o=dr(i,e);return dr(o,t)}function zH(n,e,t){let r=lr(n),i=[r[Rt.DaysFormat],r[Rt.DaysStandalone]],o=dr(i,e);return dr(o,t)}function GH(n,e,t){let r=lr(n),i=[r[Rt.MonthsFormat],r[Rt.MonthsStandalone]],o=dr(i,e);return dr(o,t)}function KH(n,e){let r=lr(n)[Rt.Eras];return dr(r,e)}function Xf(n,e){let t=lr(n);return dr(t[Rt.DateFormat],e)}function ep(n,e){let t=lr(n);return dr(t[Rt.TimeFormat],e)}function tp(n,e){let r=lr(n)[Rt.DateTimeFormat];return dr(r,e)}function dp(n,e){let t=lr(n),r=t[Rt.NumberSymbols][e];if(typeof r>"u"){if(e===bo.CurrencyDecimal)return t[Rt.NumberSymbols][bo.Decimal];if(e===bo.CurrencyGroup)return t[Rt.NumberSymbols][bo.Group]}return r}function Rx(n){if(!n[Rt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Rt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function YH(n){let e=lr(n);return Rx(e),(e[Rt.ExtraData][2]||[]).map(r=>typeof r=="string"?nw(r):[nw(r[0]),nw(r[1])])}function QH(n,e,t){let r=lr(n);Rx(r);let i=[r[Rt.ExtraData][0],r[Rt.ExtraData][1]],o=dr(i,e)||[];return dr(o,t)||[]}function dr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function nw(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var ZH=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,np={},JH=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function XH(n,e,t,r){let i=cq(n);e=Ci(t,e)||e;let s=[],a;for(;e;)if(a=JH.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let c=i.getTimezoneOffset();r&&(c=Nx(r,c),i=aq(i,r,!0));let u="";return s.forEach(d=>{let f=oq(d);u+=f?f(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function cp(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Ci(n,e){let t=qH(n);if(np[t]??={},np[t][e])return np[t][e];let r="";switch(e){case"shortDate":r=Xf(n,Yn.Short);break;case"mediumDate":r=Xf(n,Yn.Medium);break;case"longDate":r=Xf(n,Yn.Long);break;case"fullDate":r=Xf(n,Yn.Full);break;case"shortTime":r=ep(n,Yn.Short);break;case"mediumTime":r=ep(n,Yn.Medium);break;case"longTime":r=ep(n,Yn.Long);break;case"fullTime":r=ep(n,Yn.Full);break;case"short":let i=Ci(n,"shortTime"),o=Ci(n,"shortDate");r=rp(tp(n,Yn.Short),[i,o]);break;case"medium":let s=Ci(n,"mediumTime"),a=Ci(n,"mediumDate");r=rp(tp(n,Yn.Medium),[s,a]);break;case"long":let c=Ci(n,"longTime"),u=Ci(n,"longDate");r=rp(tp(n,Yn.Long),[c,u]);break;case"full":let d=Ci(n,"fullTime"),f=Ci(n,"fullDate");r=rp(tp(n,Yn.Full),[d,f]);break}return r&&(np[t][e]=r),r}function rp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function xr(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),o+s}function eq(n,e){return xr(n,3).substring(0,e)}function Ot(n,e,t=0,r=!1,i=!1){return function(o,s){let a=tq(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return eq(a,e);let c=dp(s,bo.MinusSign);return xr(a,e,c,r,i)}}function tq(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function nt(n,e,t=bn.Format,r=!1){return function(i,o){return nq(i,o,n,e,t,r)}}function nq(n,e,t,r,i,o){switch(t){case 2:return GH(e,i,r)[n.getMonth()];case 1:return zH(e,i,r)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=YH(e),d=QH(e,i,r),f=u.findIndex(m=>{if(Array.isArray(m)){let[v,w]=m,P=s>=v.hours&&a>=v.minutes,N=s<w.hours||s===w.hours&&a<w.minutes;if(v.hours<w.hours){if(P&&N)return!0}else if(P||N)return!0}else if(m.hours===s&&m.minutes===a)return!0;return!1});if(f!==-1)return d[f]}return WH(e,i,r)[s<12?0:1];case 3:return KH(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function ip(n){return function(e,t,r){let i=-1*r,o=dp(t,bo.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+xr(s,2,o)+xr(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+xr(s,1,o);case 2:return"GMT"+(i>=0?"+":"")+xr(s,2,o)+":"+xr(Math.abs(i%60),2,o);case 3:return r===0?"Z":(i>=0?"+":"")+xr(s,2,o)+":"+xr(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var rq=0,sp=4;function iq(n){let e=cp(n,rq,1).getDay();return cp(n,0,1+(e<=sp?sp:sp+7)-e)}function xx(n){let e=n.getDay(),t=e===0?-3:sp-e;return cp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function rw(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=xx(t),s=iq(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return xr(i,n,dp(r,bo.MinusSign))}}function op(n,e=!1){return function(t,r){let o=xx(t).getFullYear();return xr(o,n,dp(r,bo.MinusSign),e)}}var iw={};function oq(n){if(iw[n])return iw[n];let e;switch(n){case"G":case"GG":case"GGG":e=nt(3,Je.Abbreviated);break;case"GGGG":e=nt(3,Je.Wide);break;case"GGGGG":e=nt(3,Je.Narrow);break;case"y":e=Ot(0,1,0,!1,!0);break;case"yy":e=Ot(0,2,0,!0,!0);break;case"yyy":e=Ot(0,3,0,!1,!0);break;case"yyyy":e=Ot(0,4,0,!1,!0);break;case"Y":e=op(1);break;case"YY":e=op(2,!0);break;case"YYY":e=op(3);break;case"YYYY":e=op(4);break;case"M":case"L":e=Ot(1,1,1);break;case"MM":case"LL":e=Ot(1,2,1);break;case"MMM":e=nt(2,Je.Abbreviated);break;case"MMMM":e=nt(2,Je.Wide);break;case"MMMMM":e=nt(2,Je.Narrow);break;case"LLL":e=nt(2,Je.Abbreviated,bn.Standalone);break;case"LLLL":e=nt(2,Je.Wide,bn.Standalone);break;case"LLLLL":e=nt(2,Je.Narrow,bn.Standalone);break;case"w":e=rw(1);break;case"ww":e=rw(2);break;case"W":e=rw(1,!0);break;case"d":e=Ot(2,1);break;case"dd":e=Ot(2,2);break;case"c":case"cc":e=Ot(7,1);break;case"ccc":e=nt(1,Je.Abbreviated,bn.Standalone);break;case"cccc":e=nt(1,Je.Wide,bn.Standalone);break;case"ccccc":e=nt(1,Je.Narrow,bn.Standalone);break;case"cccccc":e=nt(1,Je.Short,bn.Standalone);break;case"E":case"EE":case"EEE":e=nt(1,Je.Abbreviated);break;case"EEEE":e=nt(1,Je.Wide);break;case"EEEEE":e=nt(1,Je.Narrow);break;case"EEEEEE":e=nt(1,Je.Short);break;case"a":case"aa":case"aaa":e=nt(0,Je.Abbreviated);break;case"aaaa":e=nt(0,Je.Wide);break;case"aaaaa":e=nt(0,Je.Narrow);break;case"b":case"bb":case"bbb":e=nt(0,Je.Abbreviated,bn.Standalone,!0);break;case"bbbb":e=nt(0,Je.Wide,bn.Standalone,!0);break;case"bbbbb":e=nt(0,Je.Narrow,bn.Standalone,!0);break;case"B":case"BB":case"BBB":e=nt(0,Je.Abbreviated,bn.Format,!0);break;case"BBBB":e=nt(0,Je.Wide,bn.Format,!0);break;case"BBBBB":e=nt(0,Je.Narrow,bn.Format,!0);break;case"h":e=Ot(3,1,-12);break;case"hh":e=Ot(3,2,-12);break;case"H":e=Ot(3,1);break;case"HH":e=Ot(3,2);break;case"m":e=Ot(4,1);break;case"mm":e=Ot(4,2);break;case"s":e=Ot(5,1);break;case"ss":e=Ot(5,2);break;case"S":e=Ot(6,1);break;case"SS":e=Ot(6,2);break;case"SSS":e=Ot(6,3);break;case"Z":case"ZZ":case"ZZZ":e=ip(0);break;case"ZZZZZ":e=ip(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=ip(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=ip(2);break;default:return null}return iw[n]=e,e}function Nx(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function sq(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function aq(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),o=Nx(e,i);return sq(n,r*(o-i))}function cq(n){if(Ex(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,s=1]=n.split("-").map(a=>+a);return cp(i,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(ZH))return lq(r)}let e=new Date(n);if(!Ex(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function lq(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,c,u),e}function Ex(n){return n instanceof Date&&!isNaN(n.valueOf())}function Mx(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var ow=/\s+/,Ix=[],rt=(()=>{class n{_ngEl;_renderer;initialClasses=Ix;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(ow):Ix}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(ow):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(ow).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(Ne(cr),Ne(wi))};static \u0275dir=at({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var sw=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},jn=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new sw(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),Tx(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);Tx(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Ne(vs),Ne(G_),Ne(tw))};static \u0275dir=at({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function Tx(n,e){n.context.$implicit=e.item}function uq(n,e){return new Z(2100,!1)}var dq="mediumDate",hq=new H(""),fq=new H(""),Za=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??dq,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return XH(t,s,o||this.locale,a)}catch(s){throw uq(n,s.message)}}static \u0275fac=function(r){return new(r||n)(Ne(Jf,16),Ne(hq,24),Ne(fq,24))};static \u0275pipe=QR({name:"date",type:n,pure:!0})}return n})();var aw="browser",pq="server";function Ja(n){return n===aw}function Di(n){return n===pq}var lp=class{};var lw=class extends ap{supportsDOMEvents=!0},uw=class n extends lw{static makeCurrent(){bx(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=mq();return t==null?null:gq(t)}resetBaseElement(){vu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Mx(document.cookie,e)}},vu=null;function mq(){return vu=vu||document.querySelector("base"),vu?vu.getAttribute("href"):null}function gq(n){return new URL(n,document.baseURI).pathname}var vq=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),dw=new H(""),Vx=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Z(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(de(dw),de(pe))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),fp=class{_doc;constructor(e){this._doc=e}manager},hp="ng-app-id";function Px(n){for(let e of n)e.remove()}function kx(n,e){let t=e.createElement("style");return t.textContent=n,t}function yq(n,e,t,r){let i=n.head?.querySelectorAll(`style[${hp}="${e}"],link[${hp}="${e}"]`);if(i)for(let o of i)o.removeAttribute(hp),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function hw(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Ux=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Di(o),yq(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,kx);r?.forEach(i=>this.addUsage(i,this.external,hw))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Px(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Px(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,kx(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,hw(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(hp,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(de(Un),de(R_),de(N_,8),de(kt))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),cw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},pw=/%COMP%/g,jx="%COMP%",_q=`_nghost-${jx}`,wq=`_ngcontent-${jx}`,Eq=!0,Iq=new H("",{providedIn:"root",factory:()=>Eq});function Tq(n){return wq.replace(pw,n)}function Cq(n){return _q.replace(pw,n)}function Bx(n,e){return e.map(t=>t.replace(pw,n))}var Ox=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,c,u=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=u,this.tracingService=d,this.platformIsServer=Di(a),this.defaultRenderer=new yu(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Gr.ShadowDom&&(r=he(U({},r),{encapsulation:Gr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof pp?i.applyToHost(t):i instanceof _u&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Gr.Emulated:o=new pp(c,u,r,this.appId,d,s,a,f,this.tracingService);break;case Gr.ShadowDom:return new fw(c,u,t,r,s,a,this.nonce,f,this.tracingService);default:o=new _u(c,u,r,d,s,a,f,this.tracingService);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(de(Vx),de(Ux),de(R_),de(Iq),de(Un),de(kt),de(pe),de(N_),de(zf,8))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),yu=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(cw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Fx(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Fx(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Z(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=cw[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=cw[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(pi.DashCase|pi.Important)?e.style.setProperty(t,r,i&pi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&pi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=bi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);let o=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Fx(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var fw=class extends yu{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,c,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=Bx(i.id,i.styles);for(let m of d){let v=document.createElement("style");a&&v.setAttribute("nonce",a),v.textContent=m,this.shadowRoot.appendChild(v)}let f=i.getExternalStyles?.();if(f)for(let m of f){let v=hw(m,o);a&&v.setAttribute("nonce",a),this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},_u=class extends yu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?Bx(u,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},pp=class extends _u{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,c,u){let d=i+"-"+r.id;super(e,t,r,o,s,a,c,u,d),this.contentAttr=Tq(d),this.hostAttr=Cq(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},bq=(()=>{class n extends fp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(de(Un))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),Lx=["alt","control","meta","shift"],Dq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sq={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Aq=(()=>{class n extends fp{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bi().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),Lx.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),s+=u+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=Dq[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Lx.forEach(s=>{if(s!==i){let a=Sq[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(de(Un))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})();function $x(n,e){return mx(U({rootComponent:n},Rq(e)))}function Rq(n){return{appProviders:[...kq,...n?.providers??[]],platformProviders:Pq}}function xq(){uw.makeCurrent()}function Nq(){return new fi}function Mq(){return vR(document),document}var Pq=[{provide:kt,useValue:aw},{provide:x_,useValue:xq,multi:!0},{provide:Un,useFactory:Mq,deps:[]}];var kq=[{provide:Of,useValue:"root"},{provide:fi,useFactory:Nq,deps:[]},{provide:dw,useClass:bq,multi:!0,deps:[Un,pe,kt]},{provide:dw,useClass:Aq,multi:!0,deps:[Un]},Ox,Ux,Vx,{provide:Wa,useExisting:Ox},{provide:lp,useClass:vq,deps:[]},[]];var mp=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(de(Un))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ie="primary",Fu=Symbol("RouteTitle"),_w=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ic(n){return new _w(n)}function Oq(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Fq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Qr(n[t],e[t]))return!1;return!0}function Qr(n,e){let t=n?ww(n):void 0,r=e?ww(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!Zx(n[i],e[i]))return!1;return!0}function ww(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Zx(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function Jx(n){return n.length>0?n[n.length-1]:null}function Do(n){return ry(n)?n:ys(n)?lt(Promise.resolve(n)):oe(n)}var Lq={exact:eN,subset:tN},Xx={exact:Vq,subset:Uq,ignored:()=>!0};function qx(n,e,t){return Lq[t.paths](n.root,e.root,t.matrixParams)&&Xx[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Vq(n,e){return Qr(n,e)}function eN(n,e,t){if(!Es(n.segments,e.segments)||!yp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!eN(n.children[r],e.children[r],t))return!1;return!0}function Uq(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Zx(n[t],e[t]))}function tN(n,e,t){return nN(n,e,e.segments,t)}function nN(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Es(i,t)||e.hasChildren()||!yp(i,t,r))}else if(n.segments.length===t.length){if(!Es(n.segments,t)||!yp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!tN(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Es(n.segments,i)||!yp(n.segments,i,r)||!n.children[Ie]?!1:nN(n.children[Ie],e,o,r)}}function yp(n,e,t){return e.every((r,i)=>Xx[t](n[i].parameters,r.parameters))}var Ai=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ze([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ic(this.queryParams),this._queryParamMap}toString(){return $q.serialize(this)}},ze=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _p(this)}},ws=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ic(this.parameters),this._parameterMap}toString(){return iN(this)}};function jq(n,e){return Es(n,e)&&n.every((t,r)=>Qr(t.parameters,e[r].parameters))}function Es(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Bq(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Ie&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Ie&&(t=t.concat(e(i,r)))}),t}var Ww=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>new bu,providedIn:"root"})}return n})(),bu=class{parse(e){let t=new Iw(e);return new Ai(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${wu(e.root,!0)}`,r=Wq(e.queryParams),i=typeof e.fragment=="string"?`#${Hq(e.fragment)}`:"";return`${t}${r}${i}`}},$q=new bu;function _p(n){return n.segments.map(e=>iN(e)).join("/")}function wu(n,e){if(!n.hasChildren())return _p(n);if(e){let t=n.children[Ie]?wu(n.children[Ie],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==Ie&&r.push(`${i}:${wu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Bq(n,(r,i)=>i===Ie?[wu(n.children[Ie],!1)]:[`${i}:${wu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ie]!=null?`${_p(n)}/${t[0]}`:`${_p(n)}/(${t.join("//")})`}}function rN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gp(n){return rN(n).replace(/%3B/gi,";")}function Hq(n){return encodeURI(n)}function Ew(n){return rN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function wp(n){return decodeURIComponent(n)}function Wx(n){return wp(n.replace(/\+/g,"%20"))}function iN(n){return`${Ew(n.path)}${qq(n.parameters)}`}function qq(n){return Object.entries(n).map(([e,t])=>`;${Ew(e)}=${Ew(t)}`).join("")}function Wq(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${gp(t)}=${gp(i)}`).join("&"):`${gp(t)}=${gp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var zq=/^[^\/()?;#]+/;function mw(n){let e=n.match(zq);return e?e[0]:""}var Gq=/^[^\/()?;=#]+/;function Kq(n){let e=n.match(Gq);return e?e[0]:""}var Yq=/^[^=?&#]+/;function Qq(n){let e=n.match(Yq);return e?e[0]:""}var Zq=/^[^&#]+/;function Jq(n){let e=n.match(Zq);return e?e[0]:""}var Iw=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ze([],{}):new ze([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Ie]=new ze(e,t)),r}parseSegment(){let e=mw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Z(4009,!1);return this.capture(e),new ws(wp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Kq(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=mw(this.remaining);i&&(r=i,this.capture(r))}e[wp(t)]=wp(r)}parseQueryParam(e){let t=Qq(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=Jq(this.remaining);s&&(r=s,this.capture(r))}let i=Wx(t),o=Wx(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=mw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Z(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ie);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[Ie]:new ze([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Z(4011,!1)}};function oN(n){return n.segments.length>0?new ze([],{[Ie]:n}):n}function sN(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=sN(i);if(r===Ie&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new ze(n.segments,e);return Xq(t)}function Xq(n){if(n.numberOfChildren===1&&n.children[Ie]){let e=n.children[Ie];return new ze(n.segments.concat(e.segments),e.children)}return n}function Du(n){return n instanceof Ai}function eW(n,e,t=null,r=null){let i=aN(n);return cN(i,e,t,r)}function aN(n){let e;function t(o){let s={};for(let c of o.children){let u=t(c);s[c.outlet]=u}let a=new ze(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=oN(r);return e??i}function cN(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return gw(i,i,i,t,r);let o=tW(e);if(o.toRoot())return gw(i,i,new ze([],{}),t,r);let s=nW(o,i,n),a=s.processChildren?Iu(s.segmentGroup,s.index,o.commands):uN(s.segmentGroup,s.index,o.commands);return gw(i,s.segmentGroup,a,t,r)}function Ep(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Su(n){return typeof n=="object"&&n!=null&&n.outlets}function gw(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,u])=>{o[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let s;n===e?s=t:s=lN(n,e,t);let a=oN(sN(s));return new Ai(a,o,i)}function lN(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=lN(o,e,t)}),new ze(n.segments,r)}var Ip=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ep(r[0]))throw new Z(4003,!1);let i=r.find(Su);if(i&&i!==Jx(r))throw new Z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function tW(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Ip(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Ip(t,e,r)}var tc=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function nW(n,e,t){if(n.isAbsolute)return new tc(e,!0,0);if(!t)return new tc(e,!1,NaN);if(t.parent===null)return new tc(t,!0,0);let r=Ep(n.commands[0])?0:1,i=t.segments.length-1+r;return rW(t,i,n.numberOfDoubleDots)}function rW(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Z(4005,!1);i=r.segments.length}return new tc(r,!1,i-o)}function iW(n){return Su(n[0])?n[0].outlets:{[Ie]:n}}function uN(n,e,t){if(n??=new ze([],{}),n.segments.length===0&&n.hasChildren())return Iu(n,e,t);let r=oW(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new ze(n.segments.slice(0,r.pathIndex),{});return o.children[Ie]=new ze(n.segments.slice(r.pathIndex),n.children),Iu(o,0,i)}else return r.match&&i.length===0?new ze(n.segments,{}):r.match&&!n.hasChildren()?Tw(n,e,t):r.match?Iu(n,0,i):Tw(n,e,t)}function Iu(n,e,t){if(t.length===0)return new ze(n.segments,{});{let r=iW(t),i={};if(Object.keys(r).some(o=>o!==Ie)&&n.children[Ie]&&n.numberOfChildren===1&&n.children[Ie].segments.length===0){let o=Iu(n.children[Ie],e,t);return new ze(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=uN(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new ze(n.segments,i)}}function oW(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Su(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!Gx(c,u,s))return o;r+=2}else{if(!Gx(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Tw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Su(o)){let c=sW(o.outlets);return new ze(r,c)}if(i===0&&Ep(t[0])){let c=n.segments[e];r.push(new ws(c.path,zx(t[0]))),i++;continue}let s=Su(o)?o.outlets[Ie]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Ep(a)?(r.push(new ws(s,zx(a))),i+=2):(r.push(new ws(s,{})),i++)}return new ze(r,{})}function sW(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Tw(new ze([],{}),0,r))}),e}function zx(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Gx(n,e,t){return n==t.path&&Qr(e,t.parameters)}var Tu="imperative",rn=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(rn||{}),hr=class{id;url;constructor(e,t){this.id=e,this.url=t}},Au=class extends hr{type=rn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Is=class extends hr{urlAfterRedirects;type=rn.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Zn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Zn||{}),Cw=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Cw||{}),Si=class extends hr{reason;code;type=rn.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ts=class extends hr{reason;code;type=rn.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Ru=class extends hr{error;target;type=rn.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Tp=class extends hr{urlAfterRedirects;state;type=rn.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bw=class extends hr{urlAfterRedirects;state;type=rn.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dw=class extends hr{urlAfterRedirects;state;shouldActivate;type=rn.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Sw=class extends hr{urlAfterRedirects;state;type=rn.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Aw=class extends hr{urlAfterRedirects;state;type=rn.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Rw=class{route;type=rn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},xw=class{route;type=rn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Nw=class{snapshot;type=rn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mw=class{snapshot;type=rn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pw=class{snapshot;type=rn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xu=class{snapshot;type=rn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Nu=class{},oc=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function aW(n,e){return n.providers&&!n._injector&&(n._injector=K_(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Nr(n){return n.outlet||Ie}function cW(n,e){let t=n.filter(r=>Nr(r)===e);return t.push(...n.filter(r=>Nr(r)!==e)),t}function Lu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var kw=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Lu(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new xp(this.rootInjector)}},xp=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new kw(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(de(Ln))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cp=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Ow(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Ow(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Fw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Fw(e,this._root).map(t=>t.value)}};function Ow(n,e){if(n===e.value)return e;for(let t of e.children){let r=Ow(n,t);if(r)return r}return null}function Fw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Fw(n,t);if(r.length)return r.unshift(e),r}return[]}var Qn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ec(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var bp=class extends Cp{snapshot;constructor(e,t){super(e),this.snapshot=t,zw(this,e)}toString(){return this.snapshot.toString()}};function dN(n){let e=lW(n),t=new tn([new ws("",{})]),r=new tn({}),i=new tn({}),o=new tn({}),s=new tn(""),a=new sc(t,r,o,s,i,Ie,n,e.root);return a.snapshot=e.root,new bp(new Qn(a,[]),e)}function lW(n){let e={},t={},r={},i="",o=new nc([],e,r,i,t,Ie,n,null,{});return new Sp("",new Qn(o,[]))}var sc=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(X(u=>u[Fu]))??oe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(X(e=>ic(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(X(e=>ic(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Dp(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:U(U({},e.params),n.params),data:U(U({},e.data),n.data),resolve:U(U(U(U({},n.data),e.data),i?.data),n._resolvedData)}:r={params:U({},n.params),data:U({},n.data),resolve:U(U({},n.data),n._resolvedData??{})},i&&fN(i)&&(r.resolve[Fu]=i.title),r}var nc=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Fu]}constructor(e,t,r,i,o,s,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ic(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ic(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Sp=class extends Cp{url;constructor(e,t){super(t),this.url=e,zw(this,t)}toString(){return hN(this._root)}};function zw(n,e){e.value._routerState=n,e.children.forEach(t=>zw(n,t))}function hN(n){let e=n.children.length>0?` { ${n.children.map(hN).join(", ")} } `:"";return`${n.value}${e}`}function vw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Qr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Qr(e.params,t.params)||n.paramsSubject.next(t.params),Fq(e.url,t.url)||n.urlSubject.next(t.url),Qr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Lw(n,e){let t=Qr(n.params,e.params)&&jq(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Lw(n.parent,e.parent))}function fN(n){return typeof n.title=="string"||n.title===null}var uW=new H(""),Gw=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ie;activateEvents=new Kt;deactivateEvents=new Kt;attachEvents=new Kt;detachEvents=new Kt;routerOutletData=lR(void 0);parentContexts=S(xp);location=S(vs);changeDetector=S(Co);inputBinder=S(Kw,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Z(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Z(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Vw(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[yo]})}return n})(),Vw=class n{route;childContexts;parent;outletData;__ngOutletInjector(e){return new n(this.route,this.childContexts,e,this.outletData)}constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===sc?this.route:e===xp?this.childContexts:e===uW?this.outletData:this.parent.get(e,t)}},Kw=new H("");function dW(n,e,t){let r=Mu(n,e._root,t?t._root:void 0);return new bp(r,e)}function Mu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=hW(n,e,t);return new Qn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Mu(n,a)),s}}let r=fW(e.value),i=e.children.map(o=>Mu(n,o));return new Qn(r,i)}}function hW(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Mu(n,r,i);return Mu(n,r)})}function fW(n){return new sc(new tn(n.url),new tn(n.params),new tn(n.queryParams),new tn(n.fragment),new tn(n.data),n.outlet,n.component,n)}var Pu=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},pN="ngNavigationCancelingError";function Ap(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Du(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=mN(!1,Zn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function mN(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[pN]=!0,t.cancellationCode=e,t}function pW(n){return gN(n)&&Du(n.url)}function gN(n){return!!n&&n[pN]}var mW=(n,e,t,r)=>X(i=>(new Uw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Uw=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),vw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ec(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=ec(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=ec(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ec(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new xu(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Mw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(vw(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),vw(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Rp=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},rc=class{component;route;constructor(e,t){this.component=e,this.route=t}};function gW(n,e,t){let r=n._root,i=e?e._root:null;return Eu(r,i,t,[r.value])}function vW(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function cc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!cA(n)?n:e.get(n):r}function Eu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=ec(e);return n.children.forEach(s=>{yW(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Cu(a,t.getContext(s),i)),i}function yW(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=_W(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Rp(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Eu(n,e,a?a.children:null,r,i):Eu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new rc(a.outlet.component,s))}else s&&Cu(e,a,i),i.canActivateChecks.push(new Rp(r)),o.component?Eu(n,null,a?a.children:null,r,i):Eu(n,null,t,r,i);return i}function _W(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Es(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Es(n.url,e.url)||!Qr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Lw(n,e)||!Qr(n.queryParams,e.queryParams);case"paramsChange":default:return!Lw(n,e)}}function Cu(n,e,t){let r=ec(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Cu(s,e.children.getContext(o),t):Cu(s,null,t):Cu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new rc(e.outlet.component,i)):t.canDeactivateChecks.push(new rc(null,i)):t.canDeactivateChecks.push(new rc(null,i))}function Vu(n){return typeof n=="function"}function wW(n){return typeof n=="boolean"}function EW(n){return n&&Vu(n.canLoad)}function IW(n){return n&&Vu(n.canActivate)}function TW(n){return n&&Vu(n.canActivateChild)}function CW(n){return n&&Vu(n.canDeactivate)}function bW(n){return n&&Vu(n.canMatch)}function vN(n){return n instanceof di||n?.name==="EmptyError"}var vp=Symbol("INITIAL_VALUE");function ac(){return Pn(n=>He(n.map(e=>e.pipe(Hr(1),xa(vp)))).pipe(X(e=>{for(let t of e)if(t!==!0){if(t===vp)return vp;if(t===!1||DW(t))return t}return!0}),En(e=>e!==vp),Hr(1)))}function DW(n){return Du(n)||n instanceof Pu}function SW(n,e){return St(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?oe(he(U({},t),{guardsResult:!0})):AW(s,r,i,n).pipe(St(a=>a&&wW(a)?RW(r,o,n,e):oe(a)),X(a=>he(U({},t),{guardsResult:a})))})}function AW(n,e,t,r){return lt(n).pipe(St(i=>kW(i.component,i.route,t,e,r)),hi(i=>i!==!0,!0))}function RW(n,e,t,r){return lt(e).pipe(rs(i=>Aa(NW(i.route.parent,r),xW(i.route,r),PW(n,i.path,t),MW(n,i.route,t))),hi(i=>i!==!0,!0))}function xW(n,e){return n!==null&&e&&e(new Pw(n)),oe(!0)}function NW(n,e){return n!==null&&e&&e(new Nw(n)),oe(!0)}function MW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return oe(!0);let i=r.map(o=>zh(()=>{let s=Lu(e)??t,a=cc(o,s),c=IW(a)?a.canActivate(e,n):Cn(s,()=>a(e,n));return Do(c).pipe(hi())}));return oe(i).pipe(ac())}function PW(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>vW(s)).filter(s=>s!==null).map(s=>zh(()=>{let a=s.guards.map(c=>{let u=Lu(s.node)??t,d=cc(c,u),f=TW(d)?d.canActivateChild(r,n):Cn(u,()=>d(r,n));return Do(f).pipe(hi())});return oe(a).pipe(ac())}));return oe(o).pipe(ac())}function kW(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return oe(!0);let s=o.map(a=>{let c=Lu(e)??i,u=cc(a,c),d=CW(u)?u.canDeactivate(n,e,t,r):Cn(c,()=>u(n,e,t,r));return Do(d).pipe(hi())});return oe(s).pipe(ac())}function OW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return oe(!0);let o=i.map(s=>{let a=cc(s,n),c=EW(a)?a.canLoad(e,t):Cn(n,()=>a(e,t));return Do(c)});return oe(o).pipe(ac(),yN(r))}function yN(n){return Dh(nn(e=>{if(typeof e!="boolean")throw Ap(n,e)}),X(e=>e===!0))}function FW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return oe(!0);let o=i.map(s=>{let a=cc(s,n),c=bW(a)?a.canMatch(e,t):Cn(n,()=>a(e,t));return Do(c)});return oe(o).pipe(ac(),yN(r))}var ku=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Ou=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Xa(n){return Sa(new ku(n))}function LW(n){return Sa(new Z(4e3,!1))}function VW(n){return Sa(mN(!1,Zn.GuardRejected))}var jw=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return oe(r);if(i.numberOfChildren>1||!i.children[Ie])return LW(`${e.redirectTo}`);i=i.children[Ie]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,params:v,data:w,title:P}=i,N=Cn(o,()=>a({params:v,data:w,queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,title:P}));if(N instanceof Ai)throw new Ou(N);t=N}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Ou(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Ai(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new ze(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Z(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Bw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function UW(n,e,t,r,i){let o=_N(n,e,t);return o.matched?(r=aW(e,r),FW(r,e,t,i).pipe(X(s=>s===!0?o:U({},Bw)))):oe(o)}function _N(n,e,t){if(e.path==="**")return jW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?U({},Bw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Oq)(t,n,e);if(!i)return U({},Bw);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?U(U({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function jW(n){return{matched:!0,parameters:n.length>0?Jx(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Kx(n,e,t,r){return t.length>0&&HW(n,t,r)?{segmentGroup:new ze(e,$W(r,new ze(t,n.children))),slicedSegments:[]}:t.length===0&&qW(n,t,r)?{segmentGroup:new ze(n.segments,BW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ze(n.segments,n.children),slicedSegments:t}}function BW(n,e,t,r){let i={};for(let o of t)if(Np(n,e,o)&&!r[Nr(o)]){let s=new ze([],{});i[Nr(o)]=s}return U(U({},r),i)}function $W(n,e){let t={};t[Ie]=e;for(let r of n)if(r.path===""&&Nr(r)!==Ie){let i=new ze([],{});t[Nr(r)]=i}return t}function HW(n,e,t){return t.some(r=>Np(n,e,r)&&Nr(r)!==Ie)}function qW(n,e,t){return t.some(r=>Np(n,e,r))}function Np(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function WW(n,e,t){return e.length===0&&!n.children[t]}var $w=class{};function zW(n,e,t,r,i,o,s="emptyOnly"){return new Hw(n,e,t,r,i,s,o).recognize()}var GW=31,Hw=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new jw(this.urlSerializer,this.urlTree)}noMatchError(e){return new Z(4002,`'${e.segmentGroup}'`)}recognize(){let e=Kx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(X(({children:t,rootSnapshot:r})=>{let i=new Qn(r,t),o=new Sp("",i),s=eW(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new nc([],Object.freeze({}),Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ie,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Ie,t).pipe(X(r=>({children:r,rootSnapshot:t})),io(r=>{if(r instanceof Ou)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ku?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(X(s=>s instanceof Qn?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return lt(o).pipe(rs(s=>{let a=r.children[s],c=cW(t,s);return this.processSegmentGroup(e,c,a,s,i)}),Qh((s,a)=>(s.push(...a),s)),oo(null),cy(),St(s=>{if(s===null)return Xa(r);let a=wN(s);return KW(a),oe(a)}))}processSegment(e,t,r,i,o,s,a){return lt(t).pipe(rs(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(io(u=>{if(u instanceof ku)return oe(null);throw u}))),hi(c=>!!c),io(c=>{if(vN(c))return WW(r,i,o)?oe(new $w):Xa(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return Nr(r)!==s&&(s===Ie||!Np(i,o,r))?Xa(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):Xa(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:f,remainingSegments:m}=_N(t,i,o);if(!c)return Xa(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>GW&&(this.allowRedirects=!1));let v=new nc(o,u,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Yx(i),Nr(i),i.component??i._loadedComponent??null,i,Qx(i)),w=Dp(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(w.params),v.data=Object.freeze(w.data);let P=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,v,e);return this.applyRedirects.lineralizeSegments(i,P).pipe(St(N=>this.processSegment(e,r,t,N.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=UW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Pn(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Pn(({routes:u})=>{let d=r._loadedInjector??e,{parameters:f,consumedSegments:m,remainingSegments:v}=c,w=new nc(m,f,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Yx(r),Nr(r),r.component??r._loadedComponent??null,r,Qx(r)),P=Dp(w,s,this.paramsInheritanceStrategy);w.params=Object.freeze(P.params),w.data=Object.freeze(P.data);let{segmentGroup:N,slicedSegments:V}=Kx(t,m,v,u);if(V.length===0&&N.hasChildren())return this.processChildren(d,u,N,w).pipe(X(Y=>new Qn(w,Y)));if(u.length===0&&V.length===0)return oe(new Qn(w,[]));let z=Nr(r)===o;return this.processSegment(d,u,N,V,z?Ie:o,!0,w).pipe(X(Y=>new Qn(w,Y instanceof Qn?[Y]:[])))}))):Xa(t)))}getChildConfig(e,t,r){return t.children?oe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?oe({routes:t._loadedRoutes,injector:t._loadedInjector}):OW(e,t,r,this.urlSerializer).pipe(St(i=>i?this.configLoader.loadChildren(e,t).pipe(nn(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):VW(t))):oe({routes:[],injector:e})}};function KW(n){n.sort((e,t)=>e.value.outlet===Ie?-1:t.value.outlet===Ie?1:e.value.outlet.localeCompare(t.value.outlet))}function YW(n){let e=n.value.routeConfig;return e&&e.path===""}function wN(n){let e=[],t=new Set;for(let r of n){if(!YW(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=wN(r.children);e.push(new Qn(r.value,i))}return e.filter(r=>!t.has(r))}function Yx(n){return n.data||{}}function Qx(n){return n.resolve||{}}function QW(n,e,t,r,i,o){return St(s=>zW(n,e,t,r,s.extractedUrl,i,o).pipe(X(({state:a,tree:c})=>he(U({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function ZW(n,e){return St(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return oe(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let u of EN(c))s.add(u);let a=0;return lt(s).pipe(rs(c=>o.has(c)?JW(c,r,n,e):(c.data=Dp(c,c.parent,n).resolve,oe(void 0))),nn(()=>a++),Ra(1),St(c=>a===s.size?oe(t):zn))})}function EN(n){let e=n.children.map(t=>EN(t)).flat();return[n,...e]}function JW(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!fN(i)&&(o[Fu]=i.title),XW(o,n,e,r).pipe(X(s=>(n._resolvedData=s,n.data=Dp(n,n.parent,t).resolve,null)))}function XW(n,e,t,r){let i=ww(n);if(i.length===0)return oe({});let o={};return lt(i).pipe(St(s=>ez(n[s],e,t,r).pipe(hi(),nn(a=>{if(a instanceof Pu)throw Ap(new bu,a);o[s]=a}))),Ra(1),X(()=>o),io(s=>vN(s)?zn:Sa(s)))}function ez(n,e,t,r){let i=Lu(e)??r,o=cc(n,i),s=o.resolve?o.resolve(e,t):Cn(i,()=>o(e,t));return Do(s)}function yw(n){return Pn(e=>{let t=n(e);return t?lt(t).pipe(X(()=>e)):oe(e)})}var IN=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Ie);return r}getResolvedTitleForRoute(t){return t.data[Fu]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(tz),providedIn:"root"})}return n})(),tz=(()=>{class n extends IN{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(de(mp))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yw=new H("",{providedIn:"root",factory:()=>({})}),Qw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Le({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Ce(0,"router-outlet")},dependencies:[Gw],encapsulation:2})}return n})();function Zw(n){let e=n.children&&n.children.map(Zw),t=e?he(U({},n),{children:e}):U({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ie&&(t.component=Qw),t}var Jw=new H(""),nz=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=S(X_);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return oe(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Do(t.loadComponent()).pipe(X(TN),nn(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Yl(()=>{this.componentLoaders.delete(t)})),i=new Ia(r,()=>new st).pipe(Ea());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return oe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=rz(r,this.compiler,t,this.onLoadEndListener).pipe(Yl(()=>{this.childrenLoaders.delete(r)})),s=new Ia(o,()=>new st).pipe(Ea());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function rz(n,e,t,r){return Do(n.loadChildren()).pipe(X(TN),St(i=>i instanceof su||Array.isArray(i)?oe(i):lt(e.compileModuleAsync(i))),X(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Jw,[],{optional:!0,self:!0}).flat()),{routes:s.map(Zw),injector:o}}))}function iz(n){return n&&typeof n=="object"&&"default"in n}function TN(n){return iz(n)?n.default:n}var Xw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(oz),providedIn:"root"})}return n})(),oz=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sz=new H("");var az=new H(""),cz=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new st;transitionAbortSubject=new st;configLoader=S(nz);environmentInjector=S(Ln);urlSerializer=S(Ww);rootContexts=S(xp);location=S(gu);inputBindingEnabled=S(Kw,{optional:!0})!==null;titleStrategy=S(IN);options=S(Yw,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=S(Xw);createViewTransition=S(sz,{optional:!0});navigationErrorHandler=S(az,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>oe(void 0);rootComponentType=null;constructor(){let t=i=>this.events.next(new Rw(i)),r=i=>this.events.next(new xw(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(he(U(U({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new tn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Tu,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(En(o=>o.id!==0),X(o=>he(U({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Pn(o=>{let s=!1,a=!1;return oe(o).pipe(Pn(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Zn.SupersededByNewNavigation),zn;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?he(U({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload"){let f="";return this.events.next(new Ts(c.id,this.urlSerializer.serialize(c.rawUrl),f,Cw.IgnoredSameUrlNavigation)),c.resolve(!1),zn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return oe(c).pipe(Pn(f=>{let m=this.transitions?.getValue();return this.events.next(new Au(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),m!==this.transitions?.getValue()?zn:Promise.resolve(f)}),QW(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),nn(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation=he(U({},this.currentNavigation),{finalUrl:f.urlAfterRedirects});let m=new Tp(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:f,extractedUrl:m,source:v,restoredState:w,extras:P}=c,N=new Au(f,this.urlSerializer.serialize(m),v,w);this.events.next(N);let V=dN(this.rootComponentType).snapshot;return this.currentTransition=o=he(U({},c),{targetSnapshot:V,urlAfterRedirects:m,extras:he(U({},P),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,oe(o)}else{let f="";return this.events.next(new Ts(c.id,this.urlSerializer.serialize(c.extractedUrl),f,Cw.IgnoredByUrlHandlingStrategy)),c.resolve(!1),zn}}),nn(c=>{let u=new bw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),X(c=>(this.currentTransition=o=he(U({},c),{guards:gW(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),SW(this.environmentInjector,c=>this.events.next(c)),nn(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Ap(this.urlSerializer,c.guardsResult);let u=new Dw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),En(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Zn.GuardRejected),!1)),yw(c=>{if(c.guards.canActivateChecks.length)return oe(c).pipe(nn(u=>{let d=new Sw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Pn(u=>{let d=!1;return oe(u).pipe(ZW(this.paramsInheritanceStrategy,this.environmentInjector),nn({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",Zn.NoDataFromResolver)}}))}),nn(u=>{let d=new Aw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),yw(c=>{let u=d=>{let f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(nn(m=>{d.component=m}),X(()=>{})));for(let m of d.children)f.push(...u(m));return f};return He(u(c.targetSnapshot.root)).pipe(oo(null),Hr(1))}),yw(()=>this.afterPreactivation()),Pn(()=>{let{currentSnapshot:c,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?lt(d).pipe(X(()=>o)):oe(o)}),X(c=>{let u=dW(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=he(U({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),nn(()=>{this.events.next(new Nu)}),mW(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Hr(1),nn({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Is(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),Gt(this.transitionAbortSubject.pipe(nn(c=>{throw c}))),Yl(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Zn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),io(c=>{if(a=!0,gN(c))this.events.next(new Si(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),pW(c)?this.events.next(new oc(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let u=new Ru(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let d=Cn(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(d instanceof Pu){let{message:f,cancellationCode:m}=Ap(this.urlSerializer,d);this.events.next(new Si(o.id,this.urlSerializer.serialize(o.extractedUrl),f,m)),this.events.next(new oc(d.redirectTo,d.navigationBehaviorOptions))}else throw this.events.next(u),c}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return zn}))}))}cancelNavigationTransition(t,r,i){let o=new Si(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lz(n){return n!==Tu}var uz=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(dz),providedIn:"root"})}return n})(),qw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},dz=(()=>{class n extends qw{static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CN=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(hz),providedIn:"root"})}return n})(),hz=(()=>{class n extends CN{location=S(gu);urlSerializer=S(Ww);options=S(Yw,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=S(Xw);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Ai;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=dN(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Au)this.stateMemento=this.createStateMemento();else if(t instanceof Ts)this.rawUrlTree=r.initialUrl;else if(t instanceof Tp){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Nu?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Si&&(t.code===Zn.GuardRejected||t.code===Zn.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ru?this.restoreHistory(r,!0):t instanceof Is&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Ai?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=U(U({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=U(U({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function fz(n,e){n.events.pipe(En(t=>t instanceof Is||t instanceof Si||t instanceof Ru||t instanceof Ts),X(t=>t instanceof Is||t instanceof Ts?0:(t instanceof Si?t.code===Zn.Redirect||t.code===Zn.SupersededByNewNavigation:!1)?2:1),En(t=>t!==2),Hr(1)).subscribe(()=>{e()})}var pz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Mp=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=S(Y_);stateManager=S(CN);options=S(Yw,{optional:!0})||{};pendingTasks=S(wo);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=S(cz);urlSerializer=S(Ww);location=S(gu);urlHandlingStrategy=S(Xw);_events=new st;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=S(uz);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=S(Jw,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!S(Kw,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Tt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Si&&r.code!==Zn.Redirect&&r.code!==Zn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Is)this.navigated=!0;else if(r instanceof oc){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=U({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||lz(i.source)},s);this.scheduleNavigation(a,Tu,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}vz(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Tu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=U({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Zw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=U(U({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let m=i?i.snapshot:this.routerState.snapshot.root;f=aN(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return cN(f,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Du(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Tu,null,r)}navigate(t,r={skipLocationChange:!1}){return gz(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=U({},pz):r===!1?i=U({},mz):i=r,Du(t))return qx(this.currentUrlTree,t,i);let o=this.parseUrl(t);return qx(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,u;s?(a=s.resolve,c=s.reject,u=s.promise):u=new Promise((f,m)=>{a=f,c=m});let d=this.pendingTasks.add();return fz(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gz(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Z(4008,!1)}function vz(n){return!(n instanceof Nu)&&!(n instanceof oc)}var yz=new H("");function bN(n,...e){return ut([{provide:Jw,multi:!0,useValue:n},[],{provide:sc,useFactory:_z,deps:[Mp]},{provide:Q_,multi:!0,useFactory:wz},e.map(t=>t.\u0275providers)])}function _z(n){return n.routerState.root}function wz(){let n=S(De);return e=>{let t=n.get(go);if(e!==t.components[0])return;let r=n.get(Mp),i=n.get(Ez);n.get(Iz)===1&&r.initialNavigation(),n.get(Tz,null,be.Optional)?.setUpPreloading(),n.get(yz,null,be.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Ez=new H("",{factory:()=>new st}),Iz=new H("",{providedIn:"root",factory:()=>1});var Tz=new H("");var DN=[];var bz="firebase",Dz="11.2.0";te(bz,Dz,"app");function Xe(n){n||(Ga(Xe),n=S(_i));let e=new fe(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(Gt(e))}function me(n,e){!e?.injector&&Ga(me);let t=e?.injector??S(De),r=new Gl(1),i=Rr(()=>{let o;try{o=n()}catch(s){ur(()=>r.error(s));return}ur(()=>r.next(o))},{injector:t,manualCleanup:!0});return t.get(_i).onDestroy(()=>{i.destroy(),r.complete()}),r.asObservable()}function eE(n){n===void 0&&(Ga(eE),n=S(De));let e=n.get(qf);return t=>new fe(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:c=>{r.next(c),s()},complete:()=>{r.complete(),s()},error:c=>{r.error(c),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var dt=new gi("ANGULARFIRE2_VERSION");function Wt(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ft=(n,e)=>{let t=e?[e]:gh(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},lc=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(lc||{}),SN=ew()&&typeof Zone<"u"?lc.WARN:lc.SILENT;var Pp=class{zone;delegate;constructor(e,t=ty){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},bt=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=S(pe);this.outsideAngular=t.runOutsideAngular(()=>new Pp(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Pp(typeof Zone>"u"?void 0:Zone.current,Da))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),AN=!1;function Sz(n,e){!AN&&(SN>lc.SILENT||ew())&&(AN=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),SN>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Az(n){let e=S(pe,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Cs(n){let e=S(pe,{optional:!0});return e?e.run(()=>n()):n()}var Rz=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Cn(t,()=>Cs(()=>n.apply(void 0,r)))),$e=(n,e,t)=>(t||=e?lc.WARN:lc.VERBOSE,function(){let r,i=arguments,o,s,a;try{o=S(bt),s=S(qf),a=S(Ln)}catch{return Sz(n,t),n.apply(this,i)}for(let u=0;u<arguments.length;u++)typeof i[u]=="function"&&(e&&(r||=Cs(()=>s.add())),i[u]=Rz(i[u],r,a));let c=Az(()=>n.apply(this,i));return e?c instanceof fe?c.pipe(ro(o.outsideAngular),no(o.insideAngular),eE(a)):c instanceof Promise?Cs(()=>new Promise((u,d)=>{s.run(()=>c).then(f=>Cn(a,()=>Cs(()=>u(f))),f=>Cn(a,()=>Cs(()=>d(f))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:Cs(()=>c):c instanceof fe?c.pipe(ro(o.outsideAngular),no(o.insideAngular)):Cs(()=>c)});var gt=class{constructor(e){return e}},xt=class{constructor(){return gh()}};function xz(n){return n&&n.length===1?n[0]:new gt(Ht())}var tE=new H("angularfire2._apps"),Nz={provide:gt,useFactory:xz,deps:[[new Ee,tE]]},Mz={provide:xt,deps:[[new Ee,tE]]};function Pz(n){return(e,t)=>{let r=t.get(kt);te("angularfire",dt.full,"core"),te("angularfire",dt.full,"app"),te("angular",dx.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new gt(i)}}function RN(n,...e){return ut([Nz,Mz,{provide:tE,useFactory:Pz(n),multi:!0,deps:[pe,De,bt,...e]}])}var xN=$e(OD,!0);var kz=new Map,Oz={activated:!1,tokenObservers:[]},Fz={initialized:!1,enabled:!1};function Mr(n){return kz.get(n)||Object.assign({},Oz)}function ON(){return Fz}var Lz="https://content-firebaseappcheck.googleapis.com/v1";var Vz="exchangeDebugToken",NN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},zae=24*60*60*1e3;var rE=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new ua,this.pending.promise.catch(t=>{}),yield Uz(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ua,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Uz(n){return new Promise(e=>{setTimeout(e,n)})}var jz={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},So=new tr("appCheck","AppCheck",jz);function FN(n){if(!Mr(n).activated)throw So.create("use-before-activation",{appName:n.name})}function LN(r,i){return y(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let v=yield s.getHeartbeatsHeader();v&&(o["X-Firebase-Client"]=v)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(v){throw So.create("fetch-network-error",{originalErrorMessage:v?.message})}if(c.status!==200)throw So.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(v){throw So.create("fetch-parse-error",{originalErrorMessage:v?.message})}let d=u.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw So.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let f=Number(d[1])*1e3,m=Date.now();return{token:u.token,expireTimeMillis:m+f,issuedAtTimeMillis:m}})}function VN(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Lz}/projects/${t}/apps/${r}:${Vz}?key=${i}`,body:{debug_token:e}}}var Bz="firebase-app-check-database",$z=1,iE="firebase-app-check-store";var kp=null;function Hz(){return kp||(kp=new Promise((n,e)=>{try{let t=indexedDB.open(Bz,$z);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(So.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(iE,{keyPath:"compositeKey"})}}}catch(t){e(So.create("storage-open",{originalErrorMessage:t?.message}))}}),kp)}function qz(n,e){return Wz(zz(n),e)}function Wz(n,e){return y(this,null,function*(){let r=(yield Hz()).transaction(iE,"readwrite"),o=r.objectStore(iE).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var u;a(So.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function zz(n){return`${n.options.appId}-${n.name}`}var oE=new nr("@firebase/app-check");function nE(n,e){return Br()?qz(n,e).catch(t=>{oE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function UN(){return ON().enabled}function jN(){return y(this,null,function*(){let n=ON();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Gz={error:"UNKNOWN_ERROR"};function Kz(n){return hh.encodeString(JSON.stringify(n),!1)}function sE(n,e=!1){return y(this,null,function*(){let t=n.app;FN(t);let r=Mr(t),i=r.token,o;if(i&&!Uu(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Uu(c)?i=c:yield nE(t,void 0))}if(!e&&i&&Uu(i))return{token:i.token};let s=!1;if(UN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=LN(VN(t,yield jN()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield nE(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Mr(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?oE.warn(c.message):oE.error(c),o=c}let a;return i?o?Uu(i)?a={token:i.token,internalError:o}:a=PN(o):(a={token:i.token},r.token=i,yield nE(t,i)):a=PN(o),s&&Jz(t,a),a})}function Yz(n){return y(this,null,function*(){let e=n.app;FN(e);let{provider:t}=Mr(e);if(UN()){let r=yield jN(),{token:i}=yield LN(VN(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Qz(n,e,t,r){let{app:i}=n,o=Mr(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Uu(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),MN(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>MN(n))}function BN(n,e){let t=Mr(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function MN(n){let{app:e}=n,t=Mr(e),r=t.tokenRefresher;r||(r=Zz(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Zz(n){let{app:e}=n;return new rE(()=>y(this,null,function*(){let t=Mr(e),r;if(t.token?r=yield sE(n,!0):r=yield sE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Mr(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},NN.RETRIAL_MIN_WAIT,NN.RETRIAL_MAX_WAIT)}function Jz(n,e){let t=Mr(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Uu(n){return n.expireTimeMillis-Date.now()>0}function PN(n){return{token:Kz(Gz),error:n}}var aE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Mr(this.app);for(let t of e)BN(this.app,t.next);return Promise.resolve()}};function Xz(n,e){return new aE(n,e)}function eG(n){return{getToken:e=>sE(n,e),getLimitedUseToken:()=>Yz(n),addTokenListener:e=>Qz(n,"INTERNAL",e),removeTokenListener:e=>BN(n.app,e)}}var tG="@firebase/app-check",nG="0.8.11";var rG="app-check",kN="app-check-internal";function iG(){It(new Et(rG,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Xz(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(kN).initialize()})),It(new Et(kN,n=>{let e=n.getProvider("app-check").getImmediate();return eG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),te(tG,nG)}iG();var oG="app-check";var fr=class{constructor(){return Ft(oG)}};var sG=["localhost","0.0.0.0","127.0.0.1"],oce=typeof window<"u"&&sG.includes(window.location.hostname);function nM(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var rM=nM,iM=new tr("auth","Firebase",nM());var jp=new nr("@firebase/auth");function aG(n,...e){jp.logLevel<=en.WARN&&jp.warn(`Auth (${xn}): ${n}`,...e)}function Fp(n,...e){jp.logLevel<=en.ERROR&&jp.error(`Auth (${xn}): ${n}`,...e)}function Ro(n,...e){throw SE(n,...e)}function Ds(n,...e){return SE(n,...e)}function oM(n,e,t){let r=Object.assign(Object.assign({},rM()),{[e]:t});return new tr("auth","Firebase",r).create(e,{appName:n.name})}function bs(n){return oM(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SE(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return iM.create(n,...e)}function ge(n,e,...t){if(!n)throw SE(e,...t)}function Ri(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Fp(e),new Error(e)}function xo(n,e){n||Ri(e)}function dE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function cG(){return $N()==="http:"||$N()==="https:"}function $N(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function lG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cG()||kl()||"connection"in navigator)?navigator.onLine:!0}function uG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ss=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,xo(t>e,"Short delay should be less than long delay!"),this.isMobile=Pl()||fh()}get(){return lG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function AE(n,e){xo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Bp=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ri("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ri("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ri("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var dG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var hG=new Ss(3e4,6e4);function RE(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function dc(o,s,a,c){return y(this,arguments,function*(n,e,t,r,i={}){return sM(n,i,()=>y(this,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let f=Zo(Object.assign({key:n.config.apiKey},d)).slice(1),m=yield n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);let v=Object.assign({method:e,headers:m},u);return DD()||(v.referrerPolicy="no-referrer"),Bp.fetch()(aM(n,n.config.apiHost,t,f),v)}))})}function sM(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},dG),e);try{let i=new hE(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw Op(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Op(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Op(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw Op(n,"user-disabled",s);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw oM(n,d,u);Ro(n,d)}}catch(i){if(i instanceof Wn)throw i;Ro(n,"network-request-failed",{message:String(i)})}})}function fG(o,s,a,c){return y(this,arguments,function*(n,e,t,r,i={}){let u=yield dc(n,e,t,r,i);return"mfaPendingCredential"in u&&Ro(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function aM(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?AE(n.config,i):`${n.config.apiScheme}://${i}`}var hE=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ds(this.auth,"network-request-failed")),hG.get())})}};function Op(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ds(n,e,r);return i.customData._tokenResponse=t,i}function pG(n,e){return y(this,null,function*(){return dc(n,"POST","/v1/accounts:delete",e)})}function cM(n,e){return y(this,null,function*(){return dc(n,"POST","/v1/accounts:lookup",e)})}function ju(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function xE(n,e=!1){return y(this,null,function*(){let t=Fe(n),r=yield t.getIdToken(e),i=NE(r);ge(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:ju(cE(i.auth_time)),issuedAtTime:ju(cE(i.iat)),expirationTime:ju(cE(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function cE(n){return Number(n)*1e3}function NE(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Fp("JWT malformed, contained fewer than 3 sections"),null;try{let i=TD(t);return i?JSON.parse(i):(Fp("Failed to decode base64 JWT payload"),null)}catch(i){return Fp("Caught error parsing JWT payload as JSON",i?.toString()),null}}function HN(n){let e=NE(n);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function $u(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Wn&&mG(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function mG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var fE=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Hu=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ju(this.lastLoginAt),this.creationTime=ju(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function $p(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield $u(n,cM(t,{idToken:r}));ge(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?lM(o.providerUserInfo):[],a=gG(n.providerData,s),c=n.isAnonymous,u=!(n.email&&o.passwordHash)&&!a?.length,d=c?u:!1,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Hu(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(n,f)})}function ME(n){return y(this,null,function*(){let e=Fe(n);yield $p(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function gG(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function lM(n){return n.map(e=>{var{providerId:t}=e,r=ny(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function vG(n,e){return y(this,null,function*(){let t=yield sM(n,{},()=>y(this,null,function*(){let r=Zo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=aM(n,i,"/v1/token",`key=${o}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Bp.fetch()(s,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function yG(n,e){return y(this,null,function*(){return dc(n,"POST","/v2/accounts:revokeToken",RE(n,e))})}var Bu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):HN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ge(e.length!==0,"internal-error");let t=HN(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield vG(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(ge(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(ge(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(ge(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ri("not implemented")}};function Ao(n,e){ge(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var uc=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=ny(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Hu(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield $u(this,this.stsTokenManager.getToken(this.auth,e));return ge(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return xE(this,e)}reload(){return ME(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield $p(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(ui(this.auth.app))return Promise.reject(bs(this.auth));let e=yield this.getIdToken();return yield $u(this,pG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,c,u,d;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,v=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,w=(s=t.photoURL)!==null&&s!==void 0?s:void 0,P=(a=t.tenantId)!==null&&a!==void 0?a:void 0,N=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,V=(u=t.createdAt)!==null&&u!==void 0?u:void 0,z=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:Y,emailVerified:re,isAnonymous:it,providerData:le,stsTokenManager:D}=t;ge(Y&&D,e,"internal-error");let _=Bu.fromJSON(this.name,D);ge(typeof Y=="string",e,"internal-error"),Ao(f,e.name),Ao(m,e.name),ge(typeof re=="boolean",e,"internal-error"),ge(typeof it=="boolean",e,"internal-error"),Ao(v,e.name),Ao(w,e.name),Ao(P,e.name),Ao(N,e.name),Ao(V,e.name),Ao(z,e.name);let E=new n({uid:Y,auth:e,email:m,emailVerified:re,displayName:f,isAnonymous:it,photoURL:w,phoneNumber:v,tenantId:P,stsTokenManager:_,createdAt:V,lastLoginAt:z});return le&&Array.isArray(le)&&(E.providerData=le.map(b=>Object.assign({},b))),N&&(E._redirectEventId=N),E}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Bu;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield $p(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];ge(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?lM(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new Bu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Hu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c})}};var qN=new Map;function xi(n){xo(n instanceof Function,"Expected a class definition");let e=qN.get(n);return e?(xo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qN.set(n,e),e)}var _G=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),pE=_G;function Lp(n,e,t){return`firebase:${n}:${e}:${t}`}var Hp=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Lp(this.userKey,i.apiKey,o),this.fullPersistenceKey=Lp("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?uc._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(xi(pE),e,r);let i=(yield Promise.all(t.map(u=>y(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),o=i[0]||xi(pE),s=Lp(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(s);if(d){let f=uc._fromJSON(e,d);u!==o&&(a=f),o=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,r):(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(u=>y(this,null,function*(){if(u!==o)try{yield u._remove(s)}catch{}}))),new n(o,e,r))})}};function WN(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fM(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uM(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mM(e))return"Blackberry";if(gM(e))return"Webos";if(dM(e))return"Safari";if((e.includes("chrome/")||hM(e))&&!e.includes("edge/"))return"Chrome";if(pM(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function uM(n=ln()){return/firefox\//i.test(n)}function dM(n=ln()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hM(n=ln()){return/crios\//i.test(n)}function fM(n=ln()){return/iemobile/i.test(n)}function pM(n=ln()){return/android/i.test(n)}function mM(n=ln()){return/blackberry/i.test(n)}function gM(n=ln()){return/webos/i.test(n)}function PE(n=ln()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function wG(n=ln()){var e;return PE(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function EG(){return SD()&&document.documentMode===10}function vM(n=ln()){return PE(n)||pM(n)||gM(n)||mM(n)||/windows phone/i.test(n)||fM(n)}function yM(n,e=[]){let t;switch(n){case"Browser":t=WN(ln());break;case"Worker":t=`${WN(ln())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xn}/${r}`}var mE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let c=e(o);s(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function IG(t){return y(this,arguments,function*(n,e={}){return dc(n,"GET","/v2/passwordPolicy",RE(n,e))})}var TG=6,gE=class{constructor(e){var t,r,i,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:TG,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(s=c.containsNumericCharacter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var vE=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qp(this),this.idTokenSubscription=new qp(this),this.beforeStateQueue=new mE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iM,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xi(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Hp.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield cM(this,{idToken:e}),r=yield uc._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(ui(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!s||s===a)&&c?.user&&(i=c.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield $p(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=uG()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(ui(this.app))return Promise.reject(bs(this));let t=e?Fe(e):null;return t&&ge(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return ui(this.app)?Promise.reject(bs(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ui(this.app)?Promise.reject(bs(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(xi(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield IG(this),t=new gE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new tr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield yG(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&xi(e)||this._popupRedirectResolver;ge(t,this,"argument-error"),this.redirectPersistenceManager=yield Hp.create(this,[xi(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{s=!0,c()}}else{let c=e.addObserver(t);return()=>{s=!0,c()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&aG(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function kE(n){return Fe(n)}var qp=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=MD(t=>this.observer=t)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var OE={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CG(n){OE=n}function bG(n){return OE.loadJS(n)}function DG(){return OE.gapiScript}function _M(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function FE(n,e){let t=$t(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Vl(o,e??{}))return i;Ro(i,"already-initialized")}return t.initialize({options:e})}function SG(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(xi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function LE(n,e,t){let r=kE(n);ge(r._canInitEmulator,r,"emulator-config-failed"),ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=wM(e),{host:s,port:a}=AG(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${o}//${s}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||RG()}function wM(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function AG(n){let e=wM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:zN(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:zN(s)}}}function zN(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function RG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Wp=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ri("not implemented")}_getIdTokenResponse(e){return Ri("not implemented")}_linkToIdToken(e,t){return Ri("not implemented")}_getReauthenticationResolver(e){return Ri("not implemented")}};function lE(n,e){return y(this,null,function*(){return fG(n,"POST","/v1/accounts:signInWithIdp",RE(n,e))})}var zp=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var yE=class extends zp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var qu=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield uc._fromIdTokenResponse(e,r,i),s=GN(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=GN(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function GN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var _E=class n extends Wn{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function EM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?_E._fromErrorAndOperation(n,o,e,r):o})}function xG(n,e,t=!1){return y(this,null,function*(){let r=yield $u(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return qu._forOperation(n,"link",r)})}function NG(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(ui(r.app))return Promise.reject(bs(r));let i="reauthenticate";try{let o=yield $u(n,EM(r,i,e,n),t);ge(o.idToken,r,"internal-error");let s=NE(o.idToken);ge(s,r,"internal-error");let{sub:a}=s;return ge(n.uid===a,r,"user-mismatch"),qu._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ro(r,"user-mismatch"),o}})}function MG(n,e,t=!1){return y(this,null,function*(){if(ui(n.app))return Promise.reject(bs(n));let r="signIn",i=yield EM(n,r,e),o=yield qu._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Zp(n,e,t,r){return Fe(n).onIdTokenChanged(e,t,r)}function VE(n,e,t){return Fe(n).beforeAuthStateChanged(e,t)}function Jp(n,e,t,r){return Fe(n).onAuthStateChanged(e,t,r)}var Gp="__sak";var Kp=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Gp,"1"),this.storage.removeItem(Gp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var PG=1e3,kG=10,OG=(()=>{class n extends Kp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vM(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);EG()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,kG):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},PG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Xi(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Xi(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Xi(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),IM=OG;var FG=(()=>{class n extends Kp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),UE=FG;function LG(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var VG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let c=Array.from(a).map(d=>y(this,null,function*(){return d(r.origin,s)})),u=yield LG(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function TM(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var wE=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{let u=TM("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(f){let m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(m.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}};function Zr(){return window}function UG(n){Zr().location.href=n}function CM(){return typeof Zr().WorkerGlobalScope<"u"&&typeof Zr().importScripts=="function"}function jG(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function BG(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function $G(){return CM()?self:null}var bM="firebaseLocalStorageDb",HG=1,Yp="firebaseLocalStorage",DM="fbase_key",As=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Xp(n,e){return n.transaction([Yp],e?"readwrite":"readonly").objectStore(Yp)}function qG(){let n=indexedDB.deleteDatabase(bM);return new As(n).toPromise()}function EE(){let n=indexedDB.open(bM,HG);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Yp,{keyPath:DM})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Yp)?e(r):(r.close(),yield qG(),e(yield EE()))}))})}function KN(n,e,t){return y(this,null,function*(){let r=Xp(n,!0).put({[DM]:e,value:t});return new As(r).toPromise()})}function WG(n,e){return y(this,null,function*(){let t=Xp(n,!1).get(e),r=yield new As(t).toPromise();return r===void 0?null:r.value})}function YN(n,e){let t=Xp(n,!0).delete(e);return new As(t).toPromise()}var zG=800,GG=3,KG=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield EE(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>GG)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return CM()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=VG._getInstance($G()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield jG(),!this.activeServiceWorker)return;this.sender=new wE(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||BG()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield EE();return yield KN(t,Gp,"1"),yield YN(t,Gp),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>KN(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>WG(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>YN(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let s=Xp(o,!1).getAll();return new As(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),zG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),SM=KG;var mce=_M("rcb"),gce=new Ss(3e4,6e4);function YG(n,e){return e?xi(e):(ge(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Wu=class extends Wp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lE(e,this._buildIdpRequest())}_linkToIdToken(e,t){return lE(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return lE(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function QG(n){return MG(n.auth,new Wu(n),n.bypassAuthState)}function ZG(n){let{auth:e,user:t}=n;return ge(t,e,"internal-error"),NG(t,new Wu(n),n.bypassAuthState)}function JG(n){return y(this,null,function*(){let{auth:e,user:t}=n;return ge(t,e,"internal-error"),xG(t,new Wu(n),n.bypassAuthState)})}var IE=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QG;case"linkViaPopup":case"linkViaRedirect":return JG;case"reauthViaPopup":case"reauthViaRedirect":return ZG;default:Ro(this.auth,"internal-error")}}resolve(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var vce=new Ss(2e3,1e4);var XG="pendingRedirect",Vp=new Map,TE=class n extends IE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Vp.get(this.auth._key());if(!e){try{let r=(yield e4(this.resolver,this.auth))?yield Xi(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Vp.set(this.auth._key(),e)}return this.bypassAuthState||Vp.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Xi(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Xi(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function e4(n,e){return y(this,null,function*(){let t=r4(e),r=n4(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function t4(n,e){Vp.set(n._key(),e)}function n4(n){return xi(n._redirectPersistence)}function r4(n){return Lp(XG,n.config.apiKey,n.name)}function i4(n,e,t=!1){return y(this,null,function*(){if(ui(n.app))return Promise.reject(bs(n));let r=kE(n),i=YG(r,e),s=yield new TE(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,e)),s})}var o4=10*60*1e3,CE=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!s4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!AM(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ds(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o4&&this.cachedEventUids.clear(),this.cachedEventUids.has(QN(e))}saveEventToCache(e){this.cachedEventUids.add(QN(e)),this.lastProcessedEventTime=Date.now()}};function QN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function AM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function s4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AM(n);default:return!1}}function a4(t){return y(this,arguments,function*(n,e={}){return dc(n,"GET","/v1/projects",e)})}var c4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,l4=/^https?/;function u4(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield a4(n);for(let t of e)try{if(d4(t))return}catch{}Ro(n,"unauthorized-domain")})}function d4(n){let e=dE(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!l4.test(t))return!1;if(c4.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var h4=new Ss(3e4,6e4);function ZN(){let n=Zr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function f4(n){return new Promise((e,t)=>{var r,i,o;function s(){ZN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ZN(),t(Ds(n,"network-request-failed"))},timeout:h4.get()})}if(!((i=(r=Zr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Zr().gapi)===null||o===void 0)&&o.load)s();else{let a=_M("iframefcb");return Zr()[a]=()=>{gapi.load?s():t(Ds(n,"network-request-failed"))},bG(`${DG()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Up=null,e})}var Up=null;function p4(n){return Up=Up||f4(n),Up}var m4=new Ss(5e3,15e3),g4="__/auth/iframe",v4="emulator/auth/iframe",y4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w4(n){let e=n.config;ge(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?AE(e,v4):`https://${n.config.authDomain}/${g4}`,r={apiKey:e.apiKey,appName:n.name,v:xn},i=_4.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Zo(r).slice(1)}`}function E4(n){return y(this,null,function*(){let e=yield p4(n),t=Zr().gapi;return ge(t,n,"internal-error"),e.open({where:document.body,url:w4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y4,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let s=Ds(n,"network-request-failed"),a=Zr().setTimeout(()=>{o(s)},m4.get());function c(){Zr().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{o(s)})})))})}var I4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T4=500,C4=600,b4="_blank",D4="http://localhost",Qp=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function S4(n,e,t,r=T4,i=C4){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},I4),{width:r.toString(),height:i.toString(),top:o,left:s}),u=ln().toLowerCase();t&&(a=hM(u)?b4:t),uM(u)&&(e=e||D4,c.scrollbars="yes");let d=Object.entries(c).reduce((m,[v,w])=>`${m}${v}=${w},`,"");if(wG(u)&&a!=="_self")return A4(e||"",a),new Qp(null);let f=window.open(e||"",a,d);ge(f,n,"popup-blocked");try{f.focus()}catch{}return new Qp(f)}function A4(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var R4="__/auth/handler",x4="emulator/auth/handler",N4=encodeURIComponent("fac");function JN(n,e,t,r,i,o){return y(this,null,function*(){ge(n.config.authDomain,n,"auth-domain-config-required"),ge(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:xn,eventId:i};if(e instanceof zp){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",Fl(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(o||{}))s[d]=f}if(e instanceof yE){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${N4}=${encodeURIComponent(c)}`:"";return`${M4(n)}?${Zo(a).slice(1)}${u}`})}function M4({config:n}){return n.emulator?AE(n,x4):`https://${n.authDomain}/${R4}`}var uE="webStorageSupport",bE=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UE,this._completeRedirectFn=i4,this._overrideRedirectResult=t4}_openPopup(e,t,r,i){return y(this,null,function*(){var o;xo((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let s=yield JN(e,t,r,dE(),i);return S4(e,s,TM())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield JN(e,t,r,dE(),i);return UG(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(xo(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield E4(e),r=new CE(e);return t.register("authEvent",i=>(ge(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(uE,{type:uE},i=>{var o;let s=(o=i?.[0])===null||o===void 0?void 0:o[uE];s!==void 0&&t(!!s),Ro(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=u4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return vM()||dM()||PE()}},RM=bE;var XN="@firebase/auth",eM="1.8.2";var DE=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function P4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function k4(n){It(new Et("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;ge(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yM(n)},u=new vE(r,i,o,c);return SG(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),It(new Et("auth-internal",e=>{let t=kE(e.getProvider("auth").getImmediate());return(r=>new DE(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),te(XN,eM,P4(n)),te(XN,eM,"esm2017")}var O4=5*60,F4=Lv("authIdTokenMaxAge")||O4,tM=null,L4=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>F4)return;let i=t?.token;tM!==i&&(tM=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function jE(n=Ht()){let e=$t(n,"auth");if(e.isInitialized())return e.getImmediate();let t=FE(n,{popupRedirectResolver:RM,persistence:[SM,IM,UE]}),r=Lv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=L4(o.toString());VE(t,s,()=>s(t.currentUser)),Zp(t,a=>s(a))}}let i=bD("auth");return i&&LE(t,`http://${i}`),t}function V4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}CG({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Ds("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",V4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});k4("Browser");function NM(n){return new fe(function(e){var t=Jp(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var MM="auth",Rs=class{constructor(e){return e}},Pr=class{constructor(){return Ft(MM)}};var BE=new H("angularfire2.auth-instances");function R3(n,e){let t=Wt(MM,n,e);return t&&new Rs(t)}function x3(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Rs(r)}}var N3={provide:Pr,deps:[[new Ee,BE]]},M3={provide:Rs,useFactory:R3,deps:[[new Ee,BE],gt]};function PM(n,...e){return te("angularfire",dt.full,"auth"),ut([M3,N3,{provide:BE,useFactory:x3(n),multi:!0,deps:[pe,De,bt,xt,[new Ee,fr],...e]}])}var kM=$e(NM,!0);var OM=$e(jE,!0);var em="analytics",k3="firebase_id",O3="origin",F3=60*1e3,L3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",KE="https://www.googletagmanager.com/gtag/js";var Dn=new nr("@firebase/analytics");var V3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Jn=new tr("analytics","Analytics",V3);function U3(n){if(!n.startsWith(KE)){let e=Jn.create("invalid-gtag-resource",{gtagURL:n});return Dn.warn(e.message),""}return n}function $M(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function j3(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function B3(n,e){let t=j3("firebase-js-sdk-policy",{createScriptURL:U3}),r=document.createElement("script"),i=`${KE}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function $3(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function H3(n,e,t,r,i,o){return y(this,null,function*(){let s=r[i];try{if(s)yield e[s];else{let c=(yield $M(t)).find(u=>u.measurementId===i);c&&(yield e[c.appId])}}catch(a){Dn.error(a)}n("config",i,o)})}function q3(n,e,t,r,i){return y(this,null,function*(){try{let o=[];if(i&&i.send_to){let s=i.send_to;Array.isArray(s)||(s=[s]);let a=yield $M(t);for(let c of s){let u=a.find(f=>f.measurementId===c),d=u&&e[u.appId];if(d)o.push(d);else{o=[];break}}}o.length===0&&(o=Object.values(e)),yield Promise.all(o),n("event",r,i||{})}catch(o){Dn.error(o)}})}function W3(n,e,t,r){function i(o,...s){return y(this,null,function*(){try{if(o==="event"){let[a,c]=s;yield q3(n,e,t,a,c)}else if(o==="config"){let[a,c]=s;yield H3(n,e,t,r,a,c)}else if(o==="consent"){let[a,c]=s;n("consent",a,c)}else if(o==="get"){let[a,c,u]=s;n("get",a,c,u)}else if(o==="set"){let[a]=s;n("set",a)}else n(o,...s)}catch(a){Dn.error(a)}})}return i}function z3(n,e,t,r,i){let o=function(...s){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(o=window[i]),window[i]=W3(o,n,e,t),{gtagCore:o,wrappedGtag:window[i]}}function G3(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(KE)&&t.src.includes(n))return t;return null}var K3=30,Y3=1e3,HE=class{constructor(e={},t=Y3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},HM=new HE;function Q3(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function Z3(n){return y(this,null,function*(){var e;let{appId:t,apiKey:r}=n,i={method:"GET",headers:Q3(r)},o=L3.replace("{app-id}",t),s=yield fetch(o,i);if(s.status!==200&&s.status!==304){let a="";try{let c=yield s.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Jn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()})}function J3(r){return y(this,arguments,function*(n,e=HM,t){let{appId:i,apiKey:o,measurementId:s}=n.options;if(!i)throw Jn.create("no-app-id");if(!o){if(s)return{measurementId:s,appId:i};throw Jn.create("no-api-key")}let a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new qE;return setTimeout(()=>y(this,null,function*(){c.abort()}),t!==void 0?t:F3),qM({appId:i,apiKey:o,measurementId:s},a,c,e)})}function qM(o,s,a){return y(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=HM){var c;let{appId:u,measurementId:d}=n;try{yield X3(r,e)}catch(f){if(d)return Dn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:u,measurementId:d};throw f}try{let f=yield Z3(n);return i.deleteThrottleMetadata(u),f}catch(f){let m=f;if(!e6(m)){if(i.deleteThrottleMetadata(u),d)return Dn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m?.message}]`),{appId:u,measurementId:d};throw f}let v=Number((c=m?.customData)===null||c===void 0?void 0:c.httpStatus)===503?fa(t,i.intervalMillis,K3):fa(t,i.intervalMillis),w={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return i.setThrottleMetadata(u,w),Dn.debug(`Calling attemptFetch again in ${v} millis`),qM(n,w,r,i)}})}function X3(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(Jn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function e6(n){if(!(n instanceof Wn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var qE=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var WE;function t6(n,e,t,r,i){return y(this,null,function*(){if(i&&i.global){n("event",t,r);return}else{let o=yield e,s=Object.assign(Object.assign({},r),{send_to:o});n("event",t,s)}})}function n6(n,e,t,r){return y(this,null,function*(){if(r&&r.global)return n("set",{user_id:t}),Promise.resolve();{let i=yield e;n("config",i,{update:!0,user_id:t})}})}var zE;function r6(n){zE=n}function i6(n){WE=n}function o6(){return y(this,null,function*(){if(Br())try{yield ha()}catch(n){return Dn.warn(Jn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Dn.warn(Jn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function s6(n,e,t,r,i,o,s){return y(this,null,function*(){var a;let c=J3(n);c.then(v=>{t[v.measurementId]=v.appId,n.options.measurementId&&v.measurementId!==n.options.measurementId&&Dn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>Dn.error(v)),e.push(c);let u=o6().then(v=>{if(v)return r.getId()}),[d,f]=yield Promise.all([c,u]);G3(o)||B3(o,d.measurementId),zE&&(i("consent","default",zE),r6(void 0)),i("js",new Date);let m=(a=s?.config)!==null&&a!==void 0?a:{};return m[O3]="firebase",m.update=!0,f!=null&&(m[k3]=f),i("config",d.measurementId,m),WE&&(i("set",WE),i6(void 0)),d.measurementId})}var GE=class{constructor(e){this.app=e}_delete(){return delete hc[this.app.options.appId],Promise.resolve()}},hc={},FM=[],LM={},$E="dataLayer",a6="gtag",VM,YE,UM=!1;function c6(){let n=[];if(kl()&&n.push("This is a browser extension environment."),Ol()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Jn.create("invalid-analytics-context",{errorInfo:e});Dn.warn(t.message)}}function l6(n,e,t){c6();let r=n.options.appId;if(!r)throw Jn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Dn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Jn.create("no-api-key");if(hc[r]!=null)throw Jn.create("already-exists",{id:r});if(!UM){$3($E);let{wrappedGtag:o,gtagCore:s}=z3(hc,FM,LM,$E,a6);YE=o,VM=s,UM=!0}return hc[r]=s6(n,FM,LM,e,VM,$E,t),new GE(n)}function WM(n=Ht()){n=Fe(n);let e=$t(n,em);return e.isInitialized()?e.getImmediate():zM(n)}function zM(n,e={}){let t=$t(n,em);if(t.isInitialized()){let i=t.getImmediate();if(Vl(e,t.getOptions()))return i;throw Jn.create("already-initialized")}return t.initialize({options:e})}function GM(){return y(this,null,function*(){if(kl()||!Ol()||!Br())return!1;try{return yield ha()}catch{return!1}})}function KM(n,e,t){n=Fe(n),n6(YE,hc[n.app.options.appId],e,t).catch(r=>Dn.error(r))}function QE(n,e,t,r){n=Fe(n),t6(YE,hc[n.app.options.appId],e,t,r).catch(i=>Dn.error(i))}var jM="@firebase/analytics",BM="0.10.11";function u6(){It(new Et(em,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return l6(r,i,t)},"PUBLIC")),It(new Et("analytics-internal",n,"PRIVATE")),te(jM,BM),te(jM,BM,"esm2017");function n(e){try{let t=e.getProvider(em).getImmediate();return{logEvent:(r,i,o)=>QE(t,r,i,o)}}catch(t){throw Jn.create("interop-component-reg-failed",{reason:t})}}}u6();var xs=class{constructor(e){return e}},ZM="analytics",JE=class{constructor(){return Ft(ZM)}};var JM=$e(WM,!0);var XM=$e(GM,!1),d6=$e(QE,!1,2);var h6=$e(KM,!0,2);var eI=(()=>{class n{initialized;disposables=[];constructor(t,r,i){te("angularfire",dt.full,"user-tracking");let o;this.initialized=r.runOutsideAngular(()=>new Promise(s=>{o=s})),XM().then(()=>{let s=i.get(xs);s?this.disposables=[kM(t).subscribe(a=>{h6(s,a?.uid),o()})]:o()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(r){return new(r||n)(de(Rs),de(pe),de(De))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),f6="firebase_event_origin",p6="firebase_previous_class",m6="firebase_previous_id",g6="firebase_previous_screen",v6="firebase_screen_class",YM="firebase_screen_id",y6="firebase_screen",XE="outlet",_6="page_path",w6="page_title",zu="screen_class",QM="screen_name",E6="screen_view",I6="auto",T6="#",C6=Math.floor(Math.random()*(2**32-1))-2**31,ZE={},b6=n=>{let e=[n[zu],n[XE]].join(T6);if(ZE.hasOwnProperty(e))return ZE[e];{let t=C6++;return ZE[e]=t,t}},D6=(n,e,t)=>n.events.pipe(En(i=>i instanceof xu)).pipe(Pn(i=>{let s=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,m=>m.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",a=n.routerState.root.children.map(m=>m).find(m=>m.outlet===i.snapshot.outlet);if(!a)return oe(null);let c=a;for(;c.firstChild;)c=c.firstChild;let u=c.pathFromRoot.map(m=>m.routeConfig?.path).filter(m=>m).join("/")||"/",d={[QM]:u,[_6]:`/${s}`,[f6]:I6,[y6]:u,[XE]:i.snapshot.outlet};e&&(d[w6]=e.getTitle());let f=a.component;if(f){if(f===Qw){let m=i.snapshot;for(;m.firstChild;)m=m.firstChild;f=m.component}}else f=i.snapshot.component;if(typeof f=="string")return oe(he(U({},d),{[zu]:f}));if(f){let m=t.resolveComponentFactory(f);return oe(he(U({},d),{[zu]:m.selector}))}return oe(null)}),En(i=>!!i),X(i=>U({[v6]:i[zu],[YM]:b6(i)},i)),ay(i=>i[XE]),St(i=>i.pipe(Gh((o,s)=>JSON.stringify(o)===JSON.stringify(s)),xa(void 0),Yh(),X(([o,s])=>o?U({[p6]:o[zu],[g6]:o[QM],[m6]:o[YM]},s):s)))),eP=(()=>{class n{disposable;constructor(t,r,i,o,s,a){te("angularfire",dt.full,"screen-tracking"),XM().then(()=>{let c=a.get(xs);!t||!c||o.runOutsideAngular(()=>{this.disposable=D6(t,r,i).pipe(Pn(u=>y(this,null,function*(){return s&&(yield s.initialized),d6(c,E6,u)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||n)(de(Mp,8),de(mp,8),de(po),de(pe),de(eI,8),de(De))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),tI=new H("angularfire2.analytics-instances");function S6(n,e,t){if(!Ja(t))return null;let r=Wt(ZM,n,e);return r&&new xs(r)}function A6(n){return(e,t,r)=>{if(!Ja(r))return null;let i=e.runOutsideAngular(()=>n(t));return new xs(i)}}var R6={provide:JE,deps:[[new Ee,tI]]},x6={provide:xs,useFactory:S6,deps:[[new Ee,tI],gt,kt]};function tP(n,...e){return te("angularfire",dt.full,"analytics"),ut([x6,R6,{provide:tI,useFactory:A6(n),multi:!0,deps:[pe,De,kt,bt,xt,...e]}])}var nP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rP={};var Ni,nI;(function(){var n;function e(D,_){function E(){}E.prototype=_.prototype,D.D=_.prototype,D.prototype=new E,D.prototype.constructor=D,D.C=function(b,A,M){for(var I=Array(arguments.length-2),ai=2;ai<arguments.length;ai++)I[ai-2]=arguments[ai];return _.prototype[A].apply(b,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,_,E){E||(E=0);var b=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)b[A]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(A=0;16>A;++A)b[A]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=D.g[0],E=D.g[1],A=D.g[2];var M=D.g[3],I=_+(M^E&(A^M))+b[0]+3614090360&4294967295;_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[1]+3905402710&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[2]+606105819&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[3]+3250441966&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[4]+4118548399&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[5]+1200080426&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[6]+2821735955&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[7]+4249261313&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[8]+1770035416&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[9]+2336552879&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[10]+4294925233&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[11]+2304563134&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[12]+1804603682&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[13]+4254626195&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[14]+2792965006&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[15]+1236535329&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(A^M&(E^A))+b[1]+4129170786&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[6]+3225465664&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[11]+643717713&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[0]+3921069994&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[5]+3593408605&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[10]+38016083&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[15]+3634488961&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[4]+3889429448&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[9]+568446438&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[14]+3275163606&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[3]+4107603335&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[8]+1163531501&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[13]+2850285829&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[2]+4243563512&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[7]+1735328473&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[12]+2368359562&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(E^A^M)+b[5]+4294588738&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[8]+2272392833&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[11]+1839030562&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[14]+4259657740&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[1]+2763975236&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[4]+1272893353&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[7]+4139469664&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[10]+3200236656&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[13]+681279174&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[0]+3936430074&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[3]+3572445317&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[6]+76029189&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[9]+3654602809&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[12]+3873151461&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[15]+530742520&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[2]+3299628645&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(A^(E|~M))+b[0]+4096336452&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[7]+1126891415&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[14]+2878612391&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[5]+4237533241&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[12]+1700485571&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[3]+2399980690&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[10]+4293915773&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[1]+2240044497&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[8]+1873313359&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[15]+4264355552&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[6]+2734768916&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[13]+1309151649&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[4]+4149444226&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[11]+3174756917&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[2]+718787259&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[9]+3951481745&4294967295,D.g[0]=D.g[0]+_&4294967295,D.g[1]=D.g[1]+(A+(I<<21&4294967295|I>>>11))&4294967295,D.g[2]=D.g[2]+A&4294967295,D.g[3]=D.g[3]+M&4294967295}r.prototype.u=function(D,_){_===void 0&&(_=D.length);for(var E=_-this.blockSize,b=this.B,A=this.h,M=0;M<_;){if(A==0)for(;M<=E;)i(this,D,M),M+=this.blockSize;if(typeof D=="string"){for(;M<_;)if(b[A++]=D.charCodeAt(M++),A==this.blockSize){i(this,b),A=0;break}}else for(;M<_;)if(b[A++]=D[M++],A==this.blockSize){i(this,b),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var _=1;_<D.length-8;++_)D[_]=0;var E=8*this.o;for(_=D.length-8;_<D.length;++_)D[_]=E&255,E/=256;for(this.u(D),D=Array(16),_=E=0;4>_;++_)for(var b=0;32>b;b+=8)D[E++]=this.g[_]>>>b&255;return D};function o(D,_){var E=a;return Object.prototype.hasOwnProperty.call(E,D)?E[D]:E[D]=_(D)}function s(D,_){this.h=_;for(var E=[],b=!0,A=D.length-1;0<=A;A--){var M=D[A]|0;b&&M==_||(E[A]=M,b=!1)}this.g=E}var a={};function c(D){return-128<=D&&128>D?o(D,function(_){return new s([_|0],0>_?-1:0)}):new s([D|0],0>D?-1:0)}function u(D){if(isNaN(D)||!isFinite(D))return f;if(0>D)return N(u(-D));for(var _=[],E=1,b=0;D>=E;b++)_[b]=D/E|0,E*=4294967296;return new s(_,0)}function d(D,_){if(D.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(D.charAt(0)=="-")return N(d(D.substring(1),_));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(_,8)),b=f,A=0;A<D.length;A+=8){var M=Math.min(8,D.length-A),I=parseInt(D.substring(A,A+M),_);8>M?(M=u(Math.pow(_,M)),b=b.j(M).add(u(I))):(b=b.j(E),b=b.add(u(I)))}return b}var f=c(0),m=c(1),v=c(16777216);n=s.prototype,n.m=function(){if(P(this))return-N(this).m();for(var D=0,_=1,E=0;E<this.g.length;E++){var b=this.i(E);D+=(0<=b?b:4294967296+b)*_,_*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(w(this))return"0";if(P(this))return"-"+N(this).toString(D);for(var _=u(Math.pow(D,6)),E=this,b="";;){var A=re(E,_).g;E=V(E,A.j(_));var M=((0<E.g.length?E.g[0]:E.h)>>>0).toString(D);if(E=A,w(E))return M+b;for(;6>M.length;)M="0"+M;b=M+b}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function w(D){if(D.h!=0)return!1;for(var _=0;_<D.g.length;_++)if(D.g[_]!=0)return!1;return!0}function P(D){return D.h==-1}n.l=function(D){return D=V(this,D),P(D)?-1:w(D)?0:1};function N(D){for(var _=D.g.length,E=[],b=0;b<_;b++)E[b]=~D.g[b];return new s(E,~D.h).add(m)}n.abs=function(){return P(this)?N(this):this},n.add=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0,A=0;A<=_;A++){var M=b+(this.i(A)&65535)+(D.i(A)&65535),I=(M>>>16)+(this.i(A)>>>16)+(D.i(A)>>>16);b=I>>>16,M&=65535,I&=65535,E[A]=I<<16|M}return new s(E,E[E.length-1]&-2147483648?-1:0)};function V(D,_){return D.add(N(_))}n.j=function(D){if(w(this)||w(D))return f;if(P(this))return P(D)?N(this).j(N(D)):N(N(this).j(D));if(P(D))return N(this.j(N(D)));if(0>this.l(v)&&0>D.l(v))return u(this.m()*D.m());for(var _=this.g.length+D.g.length,E=[],b=0;b<2*_;b++)E[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<D.g.length;A++){var M=this.i(b)>>>16,I=this.i(b)&65535,ai=D.i(A)>>>16,pl=D.i(A)&65535;E[2*b+2*A]+=I*pl,z(E,2*b+2*A),E[2*b+2*A+1]+=M*pl,z(E,2*b+2*A+1),E[2*b+2*A+1]+=I*ai,z(E,2*b+2*A+1),E[2*b+2*A+2]+=M*ai,z(E,2*b+2*A+2)}for(b=0;b<_;b++)E[b]=E[2*b+1]<<16|E[2*b];for(b=_;b<2*_;b++)E[b]=0;return new s(E,0)};function z(D,_){for(;(D[_]&65535)!=D[_];)D[_+1]+=D[_]>>>16,D[_]&=65535,_++}function Y(D,_){this.g=D,this.h=_}function re(D,_){if(w(_))throw Error("division by zero");if(w(D))return new Y(f,f);if(P(D))return _=re(N(D),_),new Y(N(_.g),N(_.h));if(P(_))return _=re(D,N(_)),new Y(N(_.g),_.h);if(30<D.g.length){if(P(D)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var E=m,b=_;0>=b.l(D);)E=it(E),b=it(b);var A=le(E,1),M=le(b,1);for(b=le(b,2),E=le(E,2);!w(b);){var I=M.add(b);0>=I.l(D)&&(A=A.add(E),M=I),b=le(b,1),E=le(E,1)}return _=V(D,A.j(_)),new Y(A,_)}for(A=f;0<=D.l(_);){for(E=Math.max(1,Math.floor(D.m()/_.m())),b=Math.ceil(Math.log(E)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),M=u(E),I=M.j(_);P(I)||0<I.l(D);)E-=b,M=u(E),I=M.j(_);w(M)&&(M=m),A=A.add(M),D=V(D,I)}return new Y(A,D)}n.A=function(D){return re(this,D).h},n.and=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)&D.i(b);return new s(E,this.h&D.h)},n.or=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)|D.i(b);return new s(E,this.h|D.h)},n.xor=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)^D.i(b);return new s(E,this.h^D.h)};function it(D){for(var _=D.g.length+1,E=[],b=0;b<_;b++)E[b]=D.i(b)<<1|D.i(b-1)>>>31;return new s(E,D.h)}function le(D,_){var E=_>>5;_%=32;for(var b=D.g.length-E,A=[],M=0;M<b;M++)A[M]=0<_?D.i(M+E)>>>_|D.i(M+E+1)<<32-_:D.i(M+E);return new s(A,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,nI=rP.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,Ni=rP.Integer=s}).apply(typeof nP<"u"?nP:typeof self<"u"?self:typeof window<"u"?window:{});var tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mi={};var rI,N6,fc,iI,Gu,nm,oI,sI,aI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof tm=="object"&&tm];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var p=r;l=l.split(".");for(var g=0;g<l.length-1;g++){var R=l[g];if(!(R in p))break e;p=p[R]}l=l[l.length-1],g=p[l],h=h(g),h!=g&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function o(l,h){l instanceof String&&(l+="");var p=0,g=!1,R={next:function(){if(!g&&p<l.length){var O=p++;return{value:h(O,l[O]),done:!1}}return g=!0,{done:!0,value:void 0}}};return R[Symbol.iterator]=function(){return R},R}i("Array.prototype.values",function(l){return l||function(){return o(this,function(h,p){return p})}});var s=s||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var R=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(R,g),l.apply(h,R)}}return function(){return l.apply(h,arguments)}}function m(l,h,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function v(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var g=p.slice();return g.push.apply(g,arguments),l.apply(this,g)}}function w(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(g,R,O){for(var B=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)B[Qe-2]=arguments[Qe];return h.prototype[R].apply(g,B)}}function P(l){let h=l.length;if(0<h){let p=Array(h);for(let g=0;g<h;g++)p[g]=l[g];return p}return[]}function N(l,h){for(let p=1;p<arguments.length;p++){let g=arguments[p];if(c(g)){let R=l.length||0,O=g.length||0;l.length=R+O;for(let B=0;B<O;B++)l[R+B]=g[B]}else l.push(g)}}class V{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function z(l){return/^[\s\xa0]*$/.test(l)}function Y(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function re(l){return re[" "](l),l}re[" "]=function(){};var it=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function le(l,h,p){for(let g in l)h.call(p,l[g],g,l)}function D(l,h){for(let p in l)h.call(void 0,l[p],p,l)}function _(l){let h={};for(let p in l)h[p]=l[p];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(l,h){let p,g;for(let R=1;R<arguments.length;R++){g=arguments[R];for(p in g)l[p]=g[p];for(let O=0;O<E.length;O++)p=E[O],Object.prototype.hasOwnProperty.call(g,p)&&(l[p]=g[p])}}function A(l){var h=1;l=l.split(":");let p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function M(l){a.setTimeout(()=>{throw l},0)}function I(){var l=hv;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ai{constructor(){this.h=this.g=null}add(h,p){let g=pl.get();g.set(h,p),this.h?this.h.next=g:this.g=g,this.h=g}}var pl=new V(()=>new uV,l=>l.reset());class uV{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ml,gl=!1,hv=new ai,Eb=()=>{let l=a.Promise.resolve(void 0);ml=()=>{l.then(dV)}};var dV=()=>{for(var l;l=I();){try{l.h.call(l.g)}catch(p){M(p)}var h=pl;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}gl=!1};function Yi(){this.s=this.s,this.C=this.C}Yi.prototype.s=!1,Yi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Yi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function on(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}on.prototype.h=function(){this.defaultPrevented=!0};var hV=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function vl(l,h){if(on.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,g=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(it){e:{try{re(h.nodeName);var R=!0;break e}catch{}R=!1}R||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:fV[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&vl.aa.h.call(this)}}w(vl,on);var fV={2:"touch",3:"pen",4:"mouse"};vl.prototype.h=function(){vl.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var yl="closure_listenable_"+(1e6*Math.random()|0),pV=0;function mV(l,h,p,g,R){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!g,this.ha=R,this.key=++pV,this.da=this.fa=!1}function Yd(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Qd(l){this.src=l,this.g={},this.h=0}Qd.prototype.add=function(l,h,p,g,R){var O=l.toString();l=this.g[O],l||(l=this.g[O]=[],this.h++);var B=pv(l,h,g,R);return-1<B?(h=l[B],p||(h.fa=!1)):(h=new mV(h,this.src,O,!!g,R),h.fa=p,l.push(h)),h};function fv(l,h){var p=h.type;if(p in l.g){var g=l.g[p],R=Array.prototype.indexOf.call(g,h,void 0),O;(O=0<=R)&&Array.prototype.splice.call(g,R,1),O&&(Yd(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function pv(l,h,p,g){for(var R=0;R<l.length;++R){var O=l[R];if(!O.da&&O.listener==h&&O.capture==!!p&&O.ha==g)return R}return-1}var mv="closure_lm_"+(1e6*Math.random()|0),gv={};function Ib(l,h,p,g,R){if(g&&g.once)return Cb(l,h,p,g,R);if(Array.isArray(h)){for(var O=0;O<h.length;O++)Ib(l,h[O],p,g,R);return null}return p=wv(p),l&&l[yl]?l.K(h,p,u(g)?!!g.capture:!!g,R):Tb(l,h,p,!1,g,R)}function Tb(l,h,p,g,R,O){if(!h)throw Error("Invalid event type");var B=u(R)?!!R.capture:!!R,Qe=yv(l);if(Qe||(l[mv]=Qe=new Qd(l)),p=Qe.add(h,p,g,B,O),p.proxy)return p;if(g=gV(),p.proxy=g,g.src=l,g.listener=p,l.addEventListener)hV||(R=B),R===void 0&&(R=!1),l.addEventListener(h.toString(),g,R);else if(l.attachEvent)l.attachEvent(Db(h.toString()),g);else if(l.addListener&&l.removeListener)l.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return p}function gV(){function l(p){return h.call(l.src,l.listener,p)}let h=vV;return l}function Cb(l,h,p,g,R){if(Array.isArray(h)){for(var O=0;O<h.length;O++)Cb(l,h[O],p,g,R);return null}return p=wv(p),l&&l[yl]?l.L(h,p,u(g)?!!g.capture:!!g,R):Tb(l,h,p,!0,g,R)}function bb(l,h,p,g,R){if(Array.isArray(h))for(var O=0;O<h.length;O++)bb(l,h[O],p,g,R);else g=u(g)?!!g.capture:!!g,p=wv(p),l&&l[yl]?(l=l.i,h=String(h).toString(),h in l.g&&(O=l.g[h],p=pv(O,p,g,R),-1<p&&(Yd(O[p]),Array.prototype.splice.call(O,p,1),O.length==0&&(delete l.g[h],l.h--)))):l&&(l=yv(l))&&(h=l.g[h.toString()],l=-1,h&&(l=pv(h,p,g,R)),(p=-1<l?h[l]:null)&&vv(p))}function vv(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[yl])fv(h.i,l);else{var p=l.type,g=l.proxy;h.removeEventListener?h.removeEventListener(p,g,l.capture):h.detachEvent?h.detachEvent(Db(p),g):h.addListener&&h.removeListener&&h.removeListener(g),(p=yv(h))?(fv(p,l),p.h==0&&(p.src=null,h[mv]=null)):Yd(l)}}}function Db(l){return l in gv?gv[l]:gv[l]="on"+l}function vV(l,h){if(l.da)l=!0;else{h=new vl(h,this);var p=l.listener,g=l.ha||l.src;l.fa&&vv(l),l=p.call(g,h)}return l}function yv(l){return l=l[mv],l instanceof Qd?l:null}var _v="__closure_events_fn_"+(1e9*Math.random()>>>0);function wv(l){return typeof l=="function"?l:(l[_v]||(l[_v]=function(h){return l.handleEvent(h)}),l[_v])}function sn(){Yi.call(this),this.i=new Qd(this),this.M=this,this.F=null}w(sn,Yi),sn.prototype[yl]=!0,sn.prototype.removeEventListener=function(l,h,p,g){bb(this,l,h,p,g)};function yn(l,h){var p,g=l.F;if(g)for(p=[];g;g=g.F)p.push(g);if(l=l.M,g=h.type||h,typeof h=="string")h=new on(h,l);else if(h instanceof on)h.target=h.target||l;else{var R=h;h=new on(g,l),b(h,R)}if(R=!0,p)for(var O=p.length-1;0<=O;O--){var B=h.g=p[O];R=Zd(B,g,!0,h)&&R}if(B=h.g=l,R=Zd(B,g,!0,h)&&R,R=Zd(B,g,!1,h)&&R,p)for(O=0;O<p.length;O++)B=h.g=p[O],R=Zd(B,g,!1,h)&&R}sn.prototype.N=function(){if(sn.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],g=0;g<p.length;g++)Yd(p[g]);delete l.g[h],l.h--}}this.F=null},sn.prototype.K=function(l,h,p,g){return this.i.add(String(l),h,!1,p,g)},sn.prototype.L=function(l,h,p,g){return this.i.add(String(l),h,!0,p,g)};function Zd(l,h,p,g){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var R=!0,O=0;O<h.length;++O){var B=h[O];if(B&&!B.da&&B.capture==p){var Qe=B.listener,Xt=B.ha||B.src;B.fa&&fv(l.i,B),R=Qe.call(Xt,g)!==!1&&R}}return R&&!g.defaultPrevented}function Sb(l,h,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Ab(l){l.g=Sb(()=>{l.g=null,l.i&&(l.i=!1,Ab(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class yV extends Yi{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Ab(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _l(l){Yi.call(this),this.h=l,this.g={}}w(_l,Yi);var Rb=[];function xb(l){le(l.g,function(h,p){this.g.hasOwnProperty(p)&&vv(h)},l),l.g={}}_l.prototype.N=function(){_l.aa.N.call(this),xb(this)},_l.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ev=a.JSON.stringify,_V=a.JSON.parse,wV=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Iv(){}Iv.prototype.h=null;function Nb(l){return l.h||(l.h=l.i())}function Mb(){}var wl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Tv(){on.call(this,"d")}w(Tv,on);function Cv(){on.call(this,"c")}w(Cv,on);var zo={},Pb=null;function Jd(){return Pb=Pb||new sn}zo.La="serverreachability";function kb(l){on.call(this,zo.La,l)}w(kb,on);function El(l){let h=Jd();yn(h,new kb(h))}zo.STAT_EVENT="statevent";function Ob(l,h){on.call(this,zo.STAT_EVENT,l),this.stat=h}w(Ob,on);function _n(l){let h=Jd();yn(h,new Ob(h,l))}zo.Ma="timingevent";function Fb(l,h){on.call(this,zo.Ma,l),this.size=h}w(Fb,on);function Il(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Tl(){this.g=!0}Tl.prototype.xa=function(){this.g=!1};function EV(l,h,p,g,R,O){l.info(function(){if(l.g)if(O)for(var B="",Qe=O.split("&"),Xt=0;Xt<Qe.length;Xt++){var Be=Qe[Xt].split("=");if(1<Be.length){var an=Be[0];Be=Be[1];var cn=an.split("_");B=2<=cn.length&&cn[1]=="type"?B+(an+"="+Be+"&"):B+(an+"=redacted&")}}else B=null;else B=O;return"XMLHTTP REQ ("+g+") [attempt "+R+"]: "+h+`
`+p+`
`+B})}function IV(l,h,p,g,R,O,B){l.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+R+"]: "+h+`
`+p+`
`+O+" "+B})}function oa(l,h,p,g){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+CV(l,p)+(g?" "+g:"")})}function TV(l,h){l.info(function(){return"TIMEOUT: "+h})}Tl.prototype.info=function(){};function CV(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var g=p[l];if(!(2>g.length)){var R=g[1];if(Array.isArray(R)&&!(1>R.length)){var O=R[0];if(O!="noop"&&O!="stop"&&O!="close")for(var B=1;B<R.length;B++)R[B]=""}}}}return Ev(p)}catch{return h}}var Xd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Lb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},bv;function eh(){}w(eh,Iv),eh.prototype.g=function(){return new XMLHttpRequest},eh.prototype.i=function(){return{}},bv=new eh;function Qi(l,h,p,g){this.j=l,this.i=h,this.l=p,this.R=g||1,this.U=new _l(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Vb}function Vb(){this.i=null,this.g="",this.h=!1}var Ub={},Dv={};function Sv(l,h,p){l.L=1,l.v=ih(ci(h)),l.m=p,l.P=!0,jb(l,null)}function jb(l,h){l.F=Date.now(),th(l),l.A=ci(l.v);var p=l.A,g=l.R;Array.isArray(g)||(g=[String(g)]),eD(p.i,"t",g),l.C=0,p=l.j.J,l.h=new Vb,l.g=yD(l.j,p?h:null,!l.m),0<l.O&&(l.M=new yV(m(l.Y,l,l.g),l.O)),h=l.U,p=l.g,g=l.ca;var R="readystatechange";Array.isArray(R)||(R&&(Rb[0]=R.toString()),R=Rb);for(var O=0;O<R.length;O++){var B=Ib(p,R[O],g||h.handleEvent,!1,h.h||h);if(!B)break;h.g[B.key]=B}h=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),El(),EV(l.i,l.u,l.A,l.l,l.R,l.m)}Qi.prototype.ca=function(l){l=l.target;let h=this.M;h&&li(l)==3?h.j():this.Y(l)},Qi.prototype.Y=function(l){try{if(l==this.g)e:{let cn=li(this.g);var h=this.g.Ba();let ca=this.g.Z();if(!(3>cn)&&(cn!=3||this.g&&(this.h.h||this.g.oa()||aD(this.g)))){this.J||cn!=4||h==7||(h==8||0>=ca?El(3):El(2)),Av(this);var p=this.g.Z();this.X=p;t:if(Bb(this)){var g=aD(this.g);l="";var R=g.length,O=li(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Go(this),Cl(this);var B="";break t}this.h.i=new a.TextDecoder}for(h=0;h<R;h++)this.h.h=!0,l+=this.h.i.decode(g[h],{stream:!(O&&h==R-1)});g.length=0,this.h.g+=l,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=p==200,IV(this.i,this.u,this.A,this.l,this.R,cn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Xt=this.g;if((Qe=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(Qe)){var Be=Qe;break t}}Be=null}if(p=Be)oa(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Rv(this,p);else{this.o=!1,this.s=3,_n(12),Go(this),Cl(this);break e}}if(this.P){p=!0;let wr;for(;!this.J&&this.C<B.length;)if(wr=bV(this,B),wr==Dv){cn==4&&(this.s=4,_n(14),p=!1),oa(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==Ub){this.s=4,_n(15),oa(this.i,this.l,B,"[Invalid Chunk]"),p=!1;break}else oa(this.i,this.l,wr,null),Rv(this,wr);if(Bb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cn!=4||B.length!=0||this.h.h||(this.s=1,_n(16),p=!1),this.o=this.o&&p,!p)oa(this.i,this.l,B,"[Invalid Chunked Response]"),Go(this),Cl(this);else if(0<B.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Ov(an),an.M=!0,_n(11))}}else oa(this.i,this.l,B,null),Rv(this,B);cn==4&&Go(this),this.o&&!this.J&&(cn==4?pD(this.j,this):(this.o=!1,th(this)))}else $V(this.g),p==400&&0<B.indexOf("Unknown SID")?(this.s=3,_n(12)):(this.s=0,_n(13)),Go(this),Cl(this)}}}catch{}finally{}};function Bb(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function bV(l,h){var p=l.C,g=h.indexOf(`
`,p);return g==-1?Dv:(p=Number(h.substring(p,g)),isNaN(p)?Ub:(g+=1,g+p>h.length?Dv:(h=h.slice(g,g+p),l.C=g+p,h)))}Qi.prototype.cancel=function(){this.J=!0,Go(this)};function th(l){l.S=Date.now()+l.I,$b(l,l.I)}function $b(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Il(m(l.ba,l),h)}function Av(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Qi.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(TV(this.i,this.A),this.L!=2&&(El(),_n(17)),Go(this),this.s=2,Cl(this)):$b(this,this.S-l)};function Cl(l){l.j.G==0||l.J||pD(l.j,l)}function Go(l){Av(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,xb(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Rv(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||xv(p.h,l))){if(!l.K&&xv(p.h,l)&&p.G==3){try{var g=p.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var R=g;if(R[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)lh(p),ah(p);else break e;kv(p),_n(18)}}else p.za=R[1],0<p.za-p.T&&37500>R[2]&&p.F&&p.v==0&&!p.C&&(p.C=Il(m(p.Za,p),6e3));if(1>=Wb(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Yo(p,11)}else if((l.K||p.g==l)&&lh(p),!z(h))for(R=p.Da.g.parse(h),h=0;h<R.length;h++){let Be=R[h];if(p.T=Be[0],Be=Be[1],p.G==2)if(Be[0]=="c"){p.K=Be[1],p.ia=Be[2];let an=Be[3];an!=null&&(p.la=an,p.j.info("VER="+p.la));let cn=Be[4];cn!=null&&(p.Aa=cn,p.j.info("SVER="+p.Aa));let ca=Be[5];ca!=null&&typeof ca=="number"&&0<ca&&(g=1.5*ca,p.L=g,p.j.info("backChannelRequestTimeoutMs_="+g)),g=p;let wr=l.g;if(wr){let dh=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(dh){var O=g.h;O.g||dh.indexOf("spdy")==-1&&dh.indexOf("quic")==-1&&dh.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Nv(O,O.h),O.h=null))}if(g.D){let Fv=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Fv&&(g.ya=Fv,ot(g.I,g.D,Fv))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),g=p;var B=l;if(g.qa=vD(g,g.J?g.ia:null,g.W),B.K){zb(g.h,B);var Qe=B,Xt=g.L;Xt&&(Qe.I=Xt),Qe.B&&(Av(Qe),th(Qe)),g.g=B}else hD(g);0<p.i.length&&ch(p)}else Be[0]!="stop"&&Be[0]!="close"||Yo(p,7);else p.G==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?Yo(p,7):Pv(p):Be[0]!="noop"&&p.l&&p.l.ta(Be),p.v=0)}}El(4)}catch{}}var DV=class{constructor(l,h){this.g=l,this.map=h}};function Hb(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qb(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Wb(l){return l.h?1:l.g?l.g.size:0}function xv(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Nv(l,h){l.g?l.g.add(h):l.h=h}function zb(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Hb.prototype.cancel=function(){if(this.i=Gb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function Gb(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let p of l.g.values())h=h.concat(p.D);return h}return P(l.i)}function SV(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,g=0;g<p;g++)h.push(l[g]);return h}h=[],p=0;for(g in l)h[p++]=l[g];return h}function AV(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(let g in l)h[p++]=g;return h}}}function Kb(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=AV(l),g=SV(l),R=g.length,O=0;O<R;O++)h.call(void 0,g[O],p&&p[O],l)}var Yb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function RV(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var g=l[p].indexOf("="),R=null;if(0<=g){var O=l[p].substring(0,g);R=l[p].substring(g+1)}else O=l[p];h(O,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Ko(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ko){this.h=l.h,nh(this,l.j),this.o=l.o,this.g=l.g,rh(this,l.s),this.l=l.l;var h=l.i,p=new Sl;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),Qb(this,p),this.m=l.m}else l&&(h=String(l).match(Yb))?(this.h=!1,nh(this,h[1]||"",!0),this.o=bl(h[2]||""),this.g=bl(h[3]||"",!0),rh(this,h[4]),this.l=bl(h[5]||"",!0),Qb(this,h[6]||"",!0),this.m=bl(h[7]||"")):(this.h=!1,this.i=new Sl(null,this.h))}Ko.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Dl(h,Zb,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Dl(h,Zb,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Dl(p,p.charAt(0)=="/"?MV:NV,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Dl(p,kV)),l.join("")};function ci(l){return new Ko(l)}function nh(l,h,p){l.j=p?bl(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function rh(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Qb(l,h,p){h instanceof Sl?(l.i=h,OV(l.i,l.h)):(p||(h=Dl(h,PV)),l.i=new Sl(h,l.h))}function ot(l,h,p){l.i.set(h,p)}function ih(l){return ot(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function bl(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Dl(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,xV),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function xV(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Zb=/[#\/\?@]/g,NV=/[#\?:]/g,MV=/[#\?]/g,PV=/[#\?@]/g,kV=/#/g;function Sl(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Zi(l){l.g||(l.g=new Map,l.h=0,l.i&&RV(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Sl.prototype,n.add=function(l,h){Zi(this),this.i=null,l=sa(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Jb(l,h){Zi(l),h=sa(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Xb(l,h){return Zi(l),h=sa(l,h),l.g.has(h)}n.forEach=function(l,h){Zi(this),this.g.forEach(function(p,g){p.forEach(function(R){l.call(h,R,g,this)},this)},this)},n.na=function(){Zi(this);let l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let g=0;g<h.length;g++){let R=l[g];for(let O=0;O<R.length;O++)p.push(h[g])}return p},n.V=function(l){Zi(this);let h=[];if(typeof l=="string")Xb(this,l)&&(h=h.concat(this.g.get(sa(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Zi(this),this.i=null,l=sa(this,l),Xb(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function eD(l,h,p){Jb(l,h),0<p.length&&(l.i=null,l.g.set(sa(l,h),P(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var g=h[p];let O=encodeURIComponent(String(g)),B=this.V(g);for(g=0;g<B.length;g++){var R=O;B[g]!==""&&(R+="="+encodeURIComponent(String(B[g]))),l.push(R)}}return this.i=l.join("&")};function sa(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function OV(l,h){h&&!l.j&&(Zi(l),l.i=null,l.g.forEach(function(p,g){var R=g.toLowerCase();g!=R&&(Jb(this,g),eD(this,R,p))},l)),l.j=h}function FV(l,h){let p=new Tl;if(a.Image){let g=new Image;g.onload=v(Ji,p,"TestLoadImage: loaded",!0,h,g),g.onerror=v(Ji,p,"TestLoadImage: error",!1,h,g),g.onabort=v(Ji,p,"TestLoadImage: abort",!1,h,g),g.ontimeout=v(Ji,p,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=l}else h(!1)}function LV(l,h){let p=new Tl,g=new AbortController,R=setTimeout(()=>{g.abort(),Ji(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:g.signal}).then(O=>{clearTimeout(R),O.ok?Ji(p,"TestPingServer: ok",!0,h):Ji(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(R),Ji(p,"TestPingServer: error",!1,h)})}function Ji(l,h,p,g,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),g(p)}catch{}}function VV(){this.g=new wV}function UV(l,h,p){let g=p||"";try{Kb(l,function(R,O){let B=R;u(R)&&(B=Ev(R)),h.push(g+O+"="+encodeURIComponent(B))})}catch(R){throw h.push(g+"type="+encodeURIComponent("_badmap")),R}}function Al(l){this.l=l.Ub||null,this.j=l.eb||!1}w(Al,Iv),Al.prototype.g=function(){return new oh(this.l,this.j)},Al.prototype.i=function(l){return function(){return l}}({});function oh(l,h){sn.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(oh,sn),n=oh.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,xl(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Rl(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,xl(this)),this.g&&(this.readyState=3,xl(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;tD(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function tD(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Rl(this):xl(this),this.readyState==3&&tD(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Rl(this))},n.Qa=function(l){this.g&&(this.response=l,Rl(this))},n.ga=function(){this.g&&Rl(this)};function Rl(l){l.readyState=4,l.l=null,l.j=null,l.v=null,xl(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function xl(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(oh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function nD(l){let h="";return le(l,function(p,g){h+=g,h+=":",h+=p,h+=`\r
`}),h}function Mv(l,h,p){e:{for(g in p){var g=!1;break e}g=!0}g||(p=nD(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):ot(l,h,p))}function wt(l){sn.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(wt,sn);var jV=/^https?$/i,BV=["POST","PUT"];n=wt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():bv.g(),this.v=this.o?Nb(this.o):Nb(bv),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(O){rD(this,O);return}if(l=p||"",p=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var R in g)p.set(R,g[R]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let O of g.keys())p.set(O,g.get(O));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(p.keys()).find(O=>O.toLowerCase()=="content-type"),R=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(BV,h,void 0))||g||R||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,B]of p)this.g.setRequestHeader(O,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sD(this),this.u=!0,this.g.send(l),this.u=!1}catch(O){rD(this,O)}};function rD(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,iD(l),sh(l)}function iD(l){l.A||(l.A=!0,yn(l,"complete"),yn(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,yn(this,"complete"),yn(this,"abort"),sh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sh(this,!0)),wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?oD(this):this.bb())},n.bb=function(){oD(this)};function oD(l){if(l.h&&typeof s<"u"&&(!l.v[1]||li(l)!=4||l.Z()!=2)){if(l.u&&li(l)==4)Sb(l.Ea,0,l);else if(yn(l,"readystatechange"),li(l)==4){l.h=!1;try{let B=l.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var g;if(g=B===0){var R=String(l.D).match(Yb)[1]||null;!R&&a.self&&a.self.location&&(R=a.self.location.protocol.slice(0,-1)),g=!jV.test(R?R.toLowerCase():"")}p=g}if(p)yn(l,"complete"),yn(l,"success");else{l.m=6;try{var O=2<li(l)?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.Z()+"]",iD(l)}}finally{sh(l)}}}}function sh(l,h){if(l.g){sD(l);let p=l.g,g=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||yn(l,"ready");try{p.onreadystatechange=g}catch{}}}function sD(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function li(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<li(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),_V(h)}};function aD(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function $V(l){let h={};l=(l.g&&2<=li(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<l.length;g++){if(z(l[g]))continue;var p=A(l[g]);let R=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let O=h[R]||[];h[R]=O,O.push(p)}D(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nl(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function cD(l){this.Aa=0,this.i=[],this.j=new Tl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Nl("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Nl("baseRetryDelayMs",5e3,l),this.cb=Nl("retryDelaySeedMs",1e4,l),this.Wa=Nl("forwardChannelMaxRetries",2,l),this.wa=Nl("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Hb(l&&l.concurrentRequestLimit),this.Da=new VV,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=cD.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,g){_n(0),this.W=l,this.H=h||{},p&&g!==void 0&&(this.H.OSID=p,this.H.OAID=g),this.F=this.X,this.I=vD(this,null,this.W),ch(this)};function Pv(l){if(lD(l),l.G==3){var h=l.U++,p=ci(l.I);if(ot(p,"SID",l.K),ot(p,"RID",h),ot(p,"TYPE","terminate"),Ml(l,p),h=new Qi(l,l.j,h),h.L=2,h.v=ih(ci(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=yD(h.j,null),h.g.ea(h.v)),h.F=Date.now(),th(h)}gD(l)}function ah(l){l.g&&(Ov(l),l.g.cancel(),l.g=null)}function lD(l){ah(l),l.u&&(a.clearTimeout(l.u),l.u=null),lh(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function ch(l){if(!qb(l.h)&&!l.s){l.s=!0;var h=l.Ga;ml||Eb(),gl||(ml(),gl=!0),hv.add(h,l),l.B=0}}function HV(l,h){return Wb(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Il(m(l.Ga,l,h),mD(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let R=new Qi(this,this.j,l),O=this.o;if(this.S&&(O?(O=_(O),b(O,this.S)):O=this.S),this.m!==null||this.O||(R.H=O,O=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var g=this.i[p];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=dD(this,R,h),p=ci(this.I),ot(p,"RID",l),ot(p,"CVER",22),this.D&&ot(p,"X-HTTP-Session-Id",this.D),Ml(this,p),O&&(this.O?h="headers="+encodeURIComponent(String(nD(O)))+"&"+h:this.m&&Mv(p,this.m,O)),Nv(this.h,R),this.Ua&&ot(p,"TYPE","init"),this.P?(ot(p,"$req",h),ot(p,"SID","null"),R.T=!0,Sv(R,p,null)):Sv(R,p,h),this.G=2}}else this.G==3&&(l?uD(this,l):this.i.length==0||qb(this.h)||uD(this))};function uD(l,h){var p;h?p=h.l:p=l.U++;let g=ci(l.I);ot(g,"SID",l.K),ot(g,"RID",p),ot(g,"AID",l.T),Ml(l,g),l.m&&l.o&&Mv(g,l.m,l.o),p=new Qi(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=dD(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Nv(l.h,p),Sv(p,g,h)}function Ml(l,h){l.H&&le(l.H,function(p,g){ot(h,g,p)}),l.l&&Kb({},function(p,g){ot(h,g,p)})}function dD(l,h,p){p=Math.min(l.i.length,p);var g=l.l?m(l.l.Na,l.l,l):null;e:{var R=l.i;let O=-1;for(;;){let B=["count="+p];O==-1?0<p?(O=R[0].g,B.push("ofs="+O)):O=0:B.push("ofs="+O);let Qe=!0;for(let Xt=0;Xt<p;Xt++){let Be=R[Xt].g,an=R[Xt].map;if(Be-=O,0>Be)O=Math.max(0,R[Xt].g-100),Qe=!1;else try{UV(an,B,"req"+Be+"_")}catch{g&&g(an)}}if(Qe){g=B.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,g}function hD(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ml||Eb(),gl||(ml(),gl=!0),hv.add(h,l),l.v=0}}function kv(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Il(m(l.Fa,l),mD(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,fD(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Il(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_n(10),ah(this),fD(this))};function Ov(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function fD(l){l.g=new Qi(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=ci(l.qa);ot(h,"RID","rpc"),ot(h,"SID",l.K),ot(h,"AID",l.T),ot(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&ot(h,"TO",l.ja),ot(h,"TYPE","xmlhttp"),Ml(l,h),l.m&&l.o&&Mv(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=ih(ci(h)),p.m=null,p.P=!0,jb(p,l)}n.Za=function(){this.C!=null&&(this.C=null,ah(this),kv(this),_n(19))};function lh(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function pD(l,h){var p=null;if(l.g==h){lh(l),Ov(l),l.g=null;var g=2}else if(xv(l.h,h))p=h.D,zb(l.h,h),g=1;else return;if(l.G!=0){if(h.o)if(g==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var R=l.B;g=Jd(),yn(g,new Fb(g,p)),ch(l)}else hD(l);else if(R=h.s,R==3||R==0&&0<h.X||!(g==1&&HV(l,h)||g==2&&kv(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),R){case 1:Yo(l,5);break;case 4:Yo(l,10);break;case 3:Yo(l,6);break;default:Yo(l,2)}}}function mD(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Yo(l,h){if(l.j.info("Error code "+h),h==2){var p=m(l.fb,l),g=l.Xa;let R=!g;g=new Ko(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||nh(g,"https"),ih(g),R?FV(g.toString(),p):LV(g.toString(),p)}else _n(2);l.G=0,l.l&&l.l.sa(h),gD(l),lD(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),_n(2)):(this.j.info("Failed to ping google.com"),_n(1))};function gD(l){if(l.G=0,l.ka=[],l.l){let h=Gb(l.h);(h.length!=0||l.i.length!=0)&&(N(l.ka,h),N(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function vD(l,h,p){var g=p instanceof Ko?ci(p):new Ko(p);if(g.g!="")h&&(g.g=h+"."+g.g),rh(g,g.s);else{var R=a.location;g=R.protocol,h=h?h+"."+R.hostname:R.hostname,R=+R.port;var O=new Ko(null);g&&nh(O,g),h&&(O.g=h),R&&rh(O,R),p&&(O.l=p),g=O}return p=l.D,h=l.ya,p&&h&&ot(g,p,h),ot(g,"VER",l.la),Ml(l,g),g}function yD(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new wt(new Al({eb:p})):new wt(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _D(){}n=_D.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function uh(){}uh.prototype.g=function(l,h){return new qn(l,h)};function qn(l,h){sn.call(this),this.g=new cD(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!z(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!z(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new aa(this)}w(qn,sn),qn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){Pv(this.g)},qn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Ev(l),l=p);h.i.push(new DV(h.Ya++,l)),h.G==3&&ch(h)},qn.prototype.N=function(){this.g.l=null,delete this.j,Pv(this.g),delete this.g,qn.aa.N.call(this)};function wD(l){Tv.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}w(wD,Tv);function ED(){Cv.call(this),this.status=1}w(ED,Cv);function aa(l){this.g=l}w(aa,_D),aa.prototype.ua=function(){yn(this.g,"a")},aa.prototype.ta=function(l){yn(this.g,new wD(l))},aa.prototype.sa=function(l){yn(this.g,new ED)},aa.prototype.ra=function(){yn(this.g,"b")},uh.prototype.createWebChannel=uh.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,aI=Mi.createWebChannelTransport=function(){return new uh},sI=Mi.getStatEventTarget=function(){return Jd()},oI=Mi.Event=zo,nm=Mi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xd.NO_ERROR=0,Xd.TIMEOUT=8,Xd.HTTP_ERROR=6,Gu=Mi.ErrorCode=Xd,Lb.COMPLETE="complete",iI=Mi.EventType=Lb,Mb.EventType=wl,wl.OPEN="a",wl.CLOSE="b",wl.ERROR="c",wl.MESSAGE="d",sn.prototype.listen=sn.prototype.K,fc=Mi.WebChannel=Mb,N6=Mi.FetchXmlHttpFactory=Al,wt.prototype.listenOnce=wt.prototype.L,wt.prototype.getLastError=wt.prototype.Ka,wt.prototype.getLastErrorCode=wt.prototype.Ba,wt.prototype.getStatus=wt.prototype.Z,wt.prototype.getResponseJson=wt.prototype.Oa,wt.prototype.getResponseText=wt.prototype.oa,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Ha,rI=Mi.XhrIo=wt}).apply(typeof tm<"u"?tm:typeof self<"u"?self:typeof window<"u"?window:{});var iP="@firebase/firestore";var Yt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");var Pc="11.2.0";var Os=new nr("@firebase/firestore");function pc(){return Os.logLevel}function W(n,...e){if(Os.logLevel<=en.DEBUG){let t=e.map(zT);Os.debug(`Firestore (${Pc}): ${n}`,...t)}}function Pi(n,...e){if(Os.logLevel<=en.ERROR){let t=e.map(zT);Os.error(`Firestore (${Pc}): ${n}`,...t)}}function Ec(n,...e){if(Os.logLevel<=en.WARN){let t=e.map(zT);Os.warn(`Firestore (${Pc}): ${n}`,...t)}}function zT(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ae(n="Unexpected state"){let e=`FIRESTORE (${Pc}) INTERNAL ASSERTION FAILED: `+n;throw Pi(e),new Error(e)}function Ge(n,e){n||ae()}function ve(n,e){return n}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},K=class extends Wn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Xr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var lm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},hI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yt.UNAUTHENTICATED))}shutdown(){}},fI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},pI=class{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ge(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new Xr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Xr,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Xr)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string"),new lm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string"),new Yt(e)}},mI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},gI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new mI(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},vI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},yI=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ge(this.o===void 0);let r=o=>{o.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,W("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ge(typeof t.token=="string"),this.R=t.token,new vI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function M6(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var um=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=M6(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function ke(n,e){return n<e?-1:n>e?1:0}function Ic(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Nt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ke(this.nanoseconds,e.nanoseconds):ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var _e=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Nt(0,0))}static max(){return new n(new Nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var dm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ae(),r===void 0?r=e.length-t:r>e.length-t&&ae(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Math.sign(e.length-t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ni.fromString(e.substring(4,e.length-2))}},vt=class n extends dm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new K(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},P6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xn=class n extends dm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return P6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new K(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new K(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new K(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ne=class n{constructor(e){this.path=e}static fromPath(e){return new n(vt.fromString(e))}static fromName(e){return new n(vt.fromString(e).popFirst(5))}static empty(){return new n(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new vt(e.slice()))}};var _I=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};_I.UNKNOWN_ID=-1;function k6(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=_e.fromTimestamp(r===1e9?new Nt(t+1,0):new Nt(t,r));return new Fs(i,ne.empty(),e)}function O6(n){return new Fs(n.readTime,n.key,-1)}var Fs=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(_e.min(),ne.empty(),-1)}static max(){return new n(_e.max(),ne.empty(),-1)}};function F6(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ne.comparator(n.documentKey,e.documentKey),t!==0?t:ke(n.largestBatchId,e.largestBatchId))}var L6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",wI=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function kc(n){return y(this,null,function*(){if(n.code!==F.FAILED_PRECONDITION||n.message!==L6)throw n;W("LocalStore","Unexpectedly lost primary lease")})}var L=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let u=c;t(e[u]).next(d=>{s[u]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function V6(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Oc(n){return n.name==="IndexedDbTransactionError"}var GT=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function qm(n){return n==null}function Xu(n){return n===0&&1/n==-1/0}function U6(n){return typeof n=="number"&&Number.isInteger(n)&&!Xu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function j6(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oP(e)),e=B6(n.get(t),e);return oP(e)}function B6(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function oP(n){return n+""}var $6=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tue=[...$6,"documentOverlays"],H6=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],q6=H6,W6=[...q6,"indexConfiguration","indexState","indexEntries"];var nue=[...W6,"globals"];function sP(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hs(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Dt=class n{constructor(e,t){this.comparator=e,this.root=t||ei.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ei.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ei.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yc(this.root,e,this.comparator,!1)}getReverseIterator(){return new yc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yc(this.root,e,this.comparator,!0)}},yc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ei=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();let e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}};ei.EMPTY=null,ei.RED=!0,ei.BLACK=!1;ei.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,t,r,i,o){return this}insert(e,t,r){return new ei(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qt=class n{constructor(e){this.comparator=e,this.data=new Dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hm(this.data.getIterator())}getIteratorFrom(e){return new hm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},hm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Jr=class n{constructor(e){this.fields=e,e.sort(Xn.comparator)}static empty(){return new n([])}unionWith(e){let t=new Qt(Xn.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ic(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var fm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var fn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new fm("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};fn.EMPTY_BYTE_STRING=new fn("");var z6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(n){if(Ge(!!n),typeof n=="string"){let e=0,t=z6.exec(n);if(Ge(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ht(n.seconds),nanos:ht(n.nanos)}}function ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Oi(n){return typeof n=="string"?fn.fromBase64String(n):fn.fromUint8Array(n)}function KT(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Wm(n){let e=n.mapValue.fields.__previous_value__;return KT(e)?Wm(e):e}function ed(n){let e=ki(n.mapValue.fields.__local_write_time__.timestampValue);return new Nt(e.seconds,e.nanos)}var EI=class{constructor(e,t,r,i,o,s,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},pm=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var rm={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Po(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?KT(n)?4:$P(n)?9007199254740991:BP(n)?10:11:ae()}function ri(n,e){if(n===e)return!0;let t=Po(n);if(t!==Po(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ed(n).isEqual(ed(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=ki(i.timestampValue),a=ki(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Oi(i.bytesValue).isEqual(Oi(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ht(i.geoPointValue.latitude)===ht(o.geoPointValue.latitude)&&ht(i.geoPointValue.longitude)===ht(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ht(i.integerValue)===ht(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=ht(i.doubleValue),a=ht(o.doubleValue);return s===a?Xu(s)===Xu(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return Ic(n.arrayValue.values||[],e.arrayValue.values||[],ri);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(sP(s)!==sP(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!ri(s[c],a[c])))return!1;return!0}(n,e);default:return ae()}}function td(n,e){return(n.values||[]).find(t=>ri(t,e))!==void 0}function Tc(n,e){if(n===e)return 0;let t=Po(n),r=Po(e);if(t!==r)return ke(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ke(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=ht(o.integerValue||o.doubleValue),c=ht(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return aP(n.timestampValue,e.timestampValue);case 4:return aP(ed(n),ed(e));case 5:return ke(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Oi(o),c=Oi(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=ke(a[u],c[u]);if(d!==0)return d}return ke(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=ke(ht(o.latitude),ht(s.latitude));return a!==0?a:ke(ht(o.longitude),ht(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return cP(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,u,d;let f=o.fields||{},m=s.fields||{},v=(a=f.value)===null||a===void 0?void 0:a.arrayValue,w=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=ke(((u=v?.values)===null||u===void 0?void 0:u.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return P!==0?P:cP(v,w)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===rm.mapValue&&s===rm.mapValue)return 0;if(o===rm.mapValue)return 1;if(s===rm.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),u=s.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let m=ke(c[f],d[f]);if(m!==0)return m;let v=Tc(a[c[f]],u[d[f]]);if(v!==0)return v}return ke(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ae()}}function aP(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ke(n,e);let t=ki(n),r=ki(e),i=ke(t.seconds,r.seconds);return i!==0?i:ke(t.nanos,r.nanos)}function cP(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Tc(t[i],r[i]);if(o)return o}return ke(t.length,r.length)}function Cc(n){return II(n)}function II(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=ki(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Oi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=II(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${II(t.fields[s])}`;return i+"}"}(n.mapValue):ae()}function sm(n){switch(Po(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Wm(n);return e?16+sm(e):16;case 5:return 2*n.stringValue.length;case 6:return Oi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+sm(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Hs(r.fields,(o,s)=>{i+=o.length+sm(s)}),i}(n.mapValue);default:throw ae()}}function lP(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function TI(n){return!!n&&"integerValue"in n}function YT(n){return!!n&&"arrayValue"in n}function uP(n){return!!n&&"nullValue"in n}function dP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function am(n){return!!n&&"mapValue"in n}function BP(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Yu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Hs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Yu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $P(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var kr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!am(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yu(t)}setAll(e){let t=Xn.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Yu(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());am(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ri(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];am(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hs(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Yu(this.value))}};function HP(n){let e=[];return Hs(n.fields,(t,r)=>{let i=new Xn([t]);if(am(r)){let o=HP(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Jr(e)}var Or=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,_e.min(),_e.min(),_e.min(),kr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,_e.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,_e.min(),_e.min(),kr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,_e.min(),_e.min(),kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var bc=class{constructor(e,t){this.position=e,this.inclusive=t}};function hP(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=ne.comparator(ne.fromName(s.referenceValue),t.key):r=Tc(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function fP(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ri(n.position[t],e.position[t]))return!1;return!0}var Dc=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function G6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var mm=class{},Ut=class n extends mm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new bI(e,t,r):t==="array-contains"?new AI(e,r):t==="in"?new RI(e,r):t==="not-in"?new xI(e,r):t==="array-contains-any"?new NI(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new DI(e,r):new SI(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Tc(t,this.value)):t!==null&&Po(this.value)===Po(t)&&this.matchesComparison(Tc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fr=class n extends mm{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return qP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function qP(n){return n.op==="and"}function WP(n){return K6(n)&&qP(n)}function K6(n){for(let e of n.filters)if(e instanceof Fr)return!1;return!0}function CI(n){if(n instanceof Ut)return n.field.canonicalString()+n.op.toString()+Cc(n.value);if(WP(n))return n.filters.map(e=>CI(e)).join(",");{let e=n.filters.map(t=>CI(t)).join(",");return`${n.op}(${e})`}}function zP(n,e){return n instanceof Ut?function(r,i){return i instanceof Ut&&r.op===i.op&&r.field.isEqual(i.field)&&ri(r.value,i.value)}(n,e):n instanceof Fr?function(r,i){return i instanceof Fr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&zP(s,i.filters[a]),!0):!1}(n,e):void ae()}function GP(n){return n instanceof Ut?function(t){return`${t.field.canonicalString()} ${t.op} ${Cc(t.value)}`}(n):n instanceof Fr?function(t){return t.op.toString()+" {"+t.getFilters().map(GP).join(" ,")+"}"}(n):"Filter"}var bI=class extends Ut{constructor(e,t,r){super(e,t,r),this.key=ne.fromName(r.referenceValue)}matches(e){let t=ne.comparator(e.key,this.key);return this.matchesComparison(t)}},DI=class extends Ut{constructor(e,t){super(e,"in",t),this.keys=KP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},SI=class extends Ut{constructor(e,t){super(e,"not-in",t),this.keys=KP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function KP(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ne.fromName(r.referenceValue))}var AI=class extends Ut{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return YT(t)&&td(t.arrayValue,this.value)}},RI=class extends Ut{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&td(this.value.arrayValue,t)}},xI=class extends Ut{constructor(e,t){super(e,"not-in",t)}matches(e){if(td(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!td(this.value.arrayValue,t)}},NI=class extends Ut{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!YT(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>td(this.value.arrayValue,r))}};var MI=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function pP(n,e=null,t=[],r=[],i=null,o=null,s=null){return new MI(n,e,t,r,i,o,s)}function QT(n){let e=ve(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>CI(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),qm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Cc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Cc(r)).join(",")),e.ue=t}return e.ue}function ZT(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!G6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!fP(n.startAt,e.startAt)&&fP(n.endAt,e.endAt)}function PI(n){return ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ls=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Y6(n,e,t,r,i,o,s,a){return new Ls(n,e,t,r,i,o,s,a)}function JT(n){return new Ls(n)}function mP(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function YP(n){return n.collectionGroup!==null}function Qu(n){let e=ve(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Qt(Xn.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Dc(o,r))}),t.has(Xn.keyField().canonicalString())||e.ce.push(new Dc(Xn.keyField(),r))}return e.ce}function ti(n){let e=ve(n);return e.le||(e.le=Q6(e,Qu(n))),e.le}function Q6(n,e){if(n.limitType==="F")return pP(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Dc(i.field,o)});let t=n.endAt?new bc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new bc(n.startAt.position,n.startAt.inclusive):null;return pP(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function kI(n,e){let t=n.filters.concat([e]);return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function OI(n,e,t){return new Ls(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function zm(n,e){return ZT(ti(n),ti(e))&&n.limitType===e.limitType}function QP(n){return`${QT(ti(n))}|lt:${n.limitType}`}function mc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>GP(i)).join(", ")}]`),qm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Cc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Cc(i)).join(",")),`Target(${r})`}(ti(n))}; limitType=${n.limitType})`}function Gm(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ne.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Qu(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let u=hP(s,a,c);return s.inclusive?u<=0:u<0}(r.startAt,Qu(r),i)||r.endAt&&!function(s,a,c){let u=hP(s,a,c);return s.inclusive?u>=0:u>0}(r.endAt,Qu(r),i))}(n,e)}function Z6(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ZP(n){return(e,t)=>{let r=!1;for(let i of Qu(n)){let o=J6(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function J6(n,e,t){let r=n.field.isKeyField()?ne.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?Tc(c,u):ae()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}var Fi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hs(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return jP(this.inner)}size(){return this.innerSize}};var X6=new Dt(ne.comparator);function Li(){return X6}var JP=new Dt(ne.comparator);function Ku(...n){let e=JP;for(let t of n)e=e.insert(t.key,t);return e}function XP(n){let e=JP;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ns(){return Zu()}function ek(){return Zu()}function Zu(){return new Fi(n=>n.toString(),(n,e)=>n.isEqual(e))}var e5=new Dt(ne.comparator),t5=new Qt(ne.comparator);function Pe(...n){let e=t5;for(let t of n)e=e.add(t);return e}var n5=new Qt(ke);function r5(){return n5}function XT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xu(e)?"-0":e}}function tk(n){return{integerValue:""+n}}function i5(n,e){return U6(e)?tk(e):XT(n,e)}var Sc=class{constructor(){this._=void 0}};function o5(n,e,t){return n instanceof Ac?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&KT(o)&&(o=Wm(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof Vs?rk(n,e):n instanceof Us?ik(n,e):function(i,o){let s=nk(i,o),a=gP(s)+gP(i.Pe);return TI(s)&&TI(i.Pe)?tk(a):XT(i.serializer,a)}(n,e)}function s5(n,e,t){return n instanceof Vs?rk(n,e):n instanceof Us?ik(n,e):t}function nk(n,e){return n instanceof Rc?function(r){return TI(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Ac=class extends Sc{},Vs=class extends Sc{constructor(e){super(),this.elements=e}};function rk(n,e){let t=ok(e);for(let r of n.elements)t.some(i=>ri(i,r))||t.push(r);return{arrayValue:{values:t}}}var Us=class extends Sc{constructor(e){super(),this.elements=e}};function ik(n,e){let t=ok(e);for(let r of n.elements)t=t.filter(i=>!ri(i,r));return{arrayValue:{values:t}}}var Rc=class extends Sc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function gP(n){return ht(n.integerValue||n.doubleValue)}function ok(n){return YT(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function a5(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Vs&&i instanceof Vs||r instanceof Us&&i instanceof Us?Ic(r.elements,i.elements,ri):r instanceof Rc&&i instanceof Rc?ri(r.Pe,i.Pe):r instanceof Ac&&i instanceof Ac}(n.transform,e.transform)}var FI=class{constructor(e,t){this.version=e,this.transformResults=t}},ks=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function cm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var xc=class{};function sk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gm(n.key,ks.none()):new js(n.key,n.data,ks.none());{let t=n.data,r=kr.empty(),i=new Qt(Xn.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new Vi(n.key,r,new Jr(i.toArray()),ks.none())}}function c5(n,e,t){n instanceof js?function(i,o,s){let a=i.value.clone(),c=yP(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Vi?function(i,o,s){if(!cm(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=yP(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(ak(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Ju(n,e,t,r){return n instanceof js?function(o,s,a,c){if(!cm(o.precondition,s))return a;let u=o.value.clone(),d=_P(o.fieldTransforms,c,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Vi?function(o,s,a,c){if(!cm(o.precondition,s))return a;let u=_P(o.fieldTransforms,c,s),d=s.data;return d.setAll(ak(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(o,s,a){return cm(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function l5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=nk(r.transform,i||null);o!=null&&(t===null&&(t=kr.empty()),t.set(r.field,o))}return t||null}function vP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ic(r,i,(o,s)=>a5(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var js=class extends xc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Vi=class extends xc{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function ak(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function yP(n,e,t){let r=new Map;Ge(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,s5(s,a,t[i]))}return r}function _P(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,o5(o,s,e))}return r}var gm=class extends xc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},LI=class extends xc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var VI=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&c5(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ju(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ju(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=ek();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=sk(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&Ic(this.mutations,e.mutations,(t,r)=>vP(t,r))&&Ic(this.baseMutations,e.baseMutations,(t,r)=>vP(t,r))}},UI=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ge(e.mutations.length===r.length);let i=function(){return e5}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var jI=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var BI=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Lt,Ve;function u5(n){switch(n){default:return ae();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function ck(n){if(n===void 0)return Pi("GRPC error has no .code"),F.UNKNOWN;switch(n){case Lt.OK:return F.OK;case Lt.CANCELLED:return F.CANCELLED;case Lt.UNKNOWN:return F.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return F.INTERNAL;case Lt.UNAVAILABLE:return F.UNAVAILABLE;case Lt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Lt.NOT_FOUND:return F.NOT_FOUND;case Lt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Lt.ABORTED:return F.ABORTED;case Lt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Lt.DATA_LOSS:return F.DATA_LOSS;default:return ae()}}(Ve=Lt||(Lt={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";var wP=null;function d5(){return new TextEncoder}var h5=new Ni([4294967295,4294967295],0);function EP(n){let e=d5().encode(n),t=new nI;return t.update(e),new Uint8Array(t.digest())}function IP(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ni([t,r],0),new Ni([i,o],0)]}var $I=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ms(`Invalid padding: ${t}`);if(r<0)throw new Ms(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ms(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ms(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Ni.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Ni.fromNumber(r)));return i.compare(h5)===1&&(i=new Ni([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=EP(e),[r,i]=IP(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);if(!this.Ee(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Te===0)return;let t=EP(e),[r,i]=IP(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ms=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var vm=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,nd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(_e.min(),i,new Dt(ke),Li(),Pe())}},nd=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Pe(),Pe(),Pe())}};var _c=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},ym=class{constructor(e,t){this.targetId=e,this.me=t}},_m=class{constructor(e,t,r=fn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},wm=class{constructor(){this.fe=0,this.ge=TP(),this.pe=fn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Pe(),t=Pe(),r=Pe();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new nd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=TP()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},HI=class{constructor(e){this.Be=e,this.Le=new Map,this.ke=Li(),this.qe=im(),this.Qe=im(),this.Ke=new Dt(ke)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){let t=e.targetId,r=e.me.count,i=this.Ye(t);if(i){let o=i.target;if(PI(o))if(r===0){let s=new ne(o.path);this.We(t,s,Or.newNoDocument(s,_e.min()))}else Ge(r===1);else{let s=this.Ze(t);if(s!==r){let a=this.Xe(e),c=a?this.et(a,e,s):1;if(c!==0){this.He(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,u)}wP?.tt(function(d,f,m,v,w){var P,N,V,z,Y,re;let it={localCacheCount:d,existenceFilterCount:f.count,databaseId:m.database,projectId:m.projectId},le=f.unchangedNames;return le&&(it.bloomFilter={applied:w===0,hashCount:(P=le?.hashCount)!==null&&P!==void 0?P:0,bitmapLength:(z=(V=(N=le?.bits)===null||N===void 0?void 0:N.bitmap)===null||V===void 0?void 0:V.length)!==null&&z!==void 0?z:0,padding:(re=(Y=le?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&re!==void 0?re:0,mightContain:D=>{var _;return(_=v?.mightContain(D))!==null&&_!==void 0&&_}}),it}(s,e.me,this.Be.nt(),a,c))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Oi(r).toUint8Array()}catch(c){if(c instanceof fm)return Ec("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new $I(s,i,o)}catch(c){return Ec(c instanceof Ms?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){let r=this.Be.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Be.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.We(t,o,null),i++)}),i}it(e){let t=new Map;this.Le.forEach((o,s)=>{let a=this.Ye(s);if(a){if(o.current&&PI(a.target)){let c=new ne(a.target.path);this.st(c).has(s)||this.ot(s,c)||this.We(s,c,Or.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=Pe();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new vm(e,t,this.Ke,this.ke,r);return this.ke=Li(),this.qe=im(),this.Qe=im(),this.Ke=new Dt(ke),i}Ue(e,t){if(!this.je(e))return;let r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;let i=this.ze(e);this.ot(e,t)?i.Fe(t,1):i.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Le.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new wm,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new Qt(ke),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Qt(ke),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||W("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new wm),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}};function im(){return new Dt(ne.comparator)}function TP(){return new Dt(ne.comparator)}var f5={asc:"ASCENDING",desc:"DESCENDING"},p5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},m5={and:"AND",or:"OR"},qI=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function WI(n,e){return n.useProto3Json||qm(e)?e:{value:e}}function Em(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function g5(n,e){return Em(n,e.toTimestamp())}function ni(n){return Ge(!!n),_e.fromTimestamp(function(t){let r=ki(t);return new Nt(r.seconds,r.nanos)}(n))}function e0(n,e){return zI(n,e).canonicalString()}function zI(n,e){let t=function(i){return new vt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function uk(n){let e=vt.fromString(n);return Ge(mk(e)),e}function GI(n,e){return e0(n.databaseId,e.path)}function cI(n,e){let t=uk(e);if(t.get(1)!==n.databaseId.projectId)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(hk(t))}function dk(n,e){return e0(n.databaseId,e)}function v5(n){let e=uk(n);return e.length===4?vt.emptyPath():hk(e)}function KI(n){return new vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function hk(n){return Ge(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function CP(n,e,t){return{name:GI(n,e),fields:t.value.mapValue.fields}}function y5(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,d){return u.useProto3Json?(Ge(d===void 0||typeof d=="string"),fn.fromBase64String(d||"")):(Ge(d===void 0||d instanceof Buffer||d instanceof Uint8Array),fn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(u){let d=u.code===void 0?F.UNKNOWN:ck(u.code);return new K(d,u.message||"")}(s);t=new _m(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=cI(n,r.document.name),o=ni(r.document.updateTime),s=r.document.createTime?ni(r.document.createTime):_e.min(),a=new kr({mapValue:{fields:r.document.fields}}),c=Or.newFoundDocument(i,o,s,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new _c(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=cI(n,r.document),o=r.readTime?ni(r.readTime):_e.min(),s=Or.newNoDocument(i,o),a=r.removedTargetIds||[];t=new _c([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=cI(n,r.document),o=r.removedTargetIds||[];t=new _c([],o,i,null)}else{if(!("filter"in e))return ae();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new BI(i,o),a=r.targetId;t=new ym(a,s)}}return t}function _5(n,e){let t;if(e instanceof js)t={update:CP(n,e.key,e.value)};else if(e instanceof gm)t={delete:GI(n,e.key)};else if(e instanceof Vi)t={update:CP(n,e.key,e.data),updateMask:A5(e.fieldMask)};else{if(!(e instanceof LI))return ae();t={verify:GI(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Ac)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Vs)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Us)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Rc)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw ae()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:g5(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ae()}(n,e.precondition)),t}function w5(n,e){return n&&n.length>0?(Ge(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?ni(i.updateTime):ni(o);return s.isEqual(_e.min())&&(s=ni(o)),new FI(s,i.transformResults||[])}(t,e))):[]}function E5(n,e){return{documents:[dk(n,e.path)]}}function I5(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=dk(n,i);let o=function(u){if(u.length!==0)return pk(Fr.create(u,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:gc(m.field),direction:b5(m.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=WI(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ct:t,parent:i}}function T5(n){let e=v5(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Ge(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(f){let m=fk(f);return m instanceof Fr&&WP(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(m=>function(w){return new Dc(vc(w.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,qm(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(f){let m=!!f.before,v=f.values||[];return new bc(v,m)}(t.startAt));let u=null;return t.endAt&&(u=function(f){let m=!f.before,v=f.values||[];return new bc(v,m)}(t.endAt)),Y6(e,i,s,o,a,"F",c,u)}function C5(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fk(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=vc(t.unaryFilter.field);return Ut.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=vc(t.unaryFilter.field);return Ut.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=vc(t.unaryFilter.field);return Ut.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=vc(t.unaryFilter.field);return Ut.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(n):n.fieldFilter!==void 0?function(t){return Ut.create(vc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Fr.create(t.compositeFilter.filters.map(r=>fk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ae()}}(t.compositeFilter.op))}(n):ae()}function b5(n){return f5[n]}function D5(n){return p5[n]}function S5(n){return m5[n]}function gc(n){return{fieldPath:n.canonicalString()}}function vc(n){return Xn.fromServerFormat(n.fieldPath)}function pk(n){return n instanceof Ut?function(t){if(t.op==="=="){if(dP(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NAN"}};if(uP(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dP(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NAN"}};if(uP(t.value))return{unaryFilter:{field:gc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gc(t.field),op:D5(t.op),value:t.value}}}(n):n instanceof Fr?function(t){let r=t.getFilters().map(i=>pk(i));return r.length===1?r[0]:{compositeFilter:{op:S5(t.op),filters:r}}}(n):ae()}function A5(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function mk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var rd=class n{constructor(e,t,r,i,o=_e.min(),s=_e.min(),a=fn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var YI=class{constructor(e){this.ht=e}};function R5(n){let e=T5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?OI(e,e.limit,"L"):e}var Im=class{constructor(){}dt(e,t){this.Et(e,t),t.At()}Et(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(ht(e.integerValue));else if("doubleValue"in e){let r=ht(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),Xu(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),typeof r=="string"&&(r=ki(r)),t.ft(`${r.seconds||""}`),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(Oi(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?$P(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):BP(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):ae()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let r=e.fields||{};this.Rt(t,55);for(let i of Object.keys(r))this.gt(i,t),this.Et(r[i],t)}bt(e,t){var r,i;let o=e.fields||{};this.Rt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(t,15),t.Vt(ht(a)),this.gt(s,t),this.Et(o[s],t)}vt(e,t){let r=e.values||[];this.Rt(t,50);for(let i of r)this.Et(i,t)}St(e,t){this.Rt(t,37),ne.fromName(e).path.forEach(r=>{this.Rt(t,60),this.Ct(r,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};Im.Ft=new Im;var QI=class{constructor(){this.ln=new ZI}addToCollectionParentIndex(e,t){return this.ln.add(t),L.resolve()}getCollectionParents(e,t){return L.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return L.resolve()}deleteFieldIndex(e,t){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,t){return L.resolve()}getDocumentsMatchingTarget(e,t){return L.resolve(null)}getIndexType(e,t){return L.resolve(0)}getFieldIndexes(e,t){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,t){return L.resolve(Fs.min())}getMinOffsetFromCollectionGroup(e,t){return L.resolve(Fs.min())}updateCollectionGroup(e,t,r){return L.resolve()}updateIndexEntries(e,t){return L.resolve()}},ZI=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qt(vt.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(vt.comparator)).toArray()}};var iue=new Uint8Array(0);var bP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pr=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};pr.DEFAULT_COLLECTION_PERCENTILE=10,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pr.DEFAULT=new pr(41943040,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pr.DISABLED=new pr(-1,0,0);var id=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};function DP([n,e],[t,r]){let i=ke(n,t);return i===0?ke(e,r):i}var JI=class{constructor(e){this.Gn=e,this.buffer=new Qt(DP),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();DP(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},XI=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){W("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Oc(t)?W("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield kc(t)}yield this.Yn(3e5)}))}},eT=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return L.resolve(GT.oe);let r=new JI(t);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(bP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bP):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,i,o,s,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),pc()<=en.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function x5(n,e){return new eT(n,e)}var tT=class{constructor(){this.changes=new Fi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?L.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var nT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var rT=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ju(r.mutation,i,Jr.empty(),Nt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Pe()){let i=Ns();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Ku();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Ns();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Pe()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Li(),s=Zu(),a=function(){return Zu()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Vi)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),Ju(d.mutation,u,d.mutation.getFieldMask(),Nt.now())):s.set(u.key,Jr.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new nT(d,(f=s.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Zu(),i=new Dt((s,a)=>s-a),o=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||Jr.empty();d=a.applyToLocalView(u,d),r.set(c,d);let f=(i.get(a.batchId)||Pe()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,f=ek();d.forEach(m=>{if(!o.has(m)){let v=sk(t.get(m),r.get(m));v!==null&&f.set(m,v),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,f))}return L.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return ne.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):YP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):L.resolve(Ns()),a=-1,c=o;return s.next(u=>L.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?L.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Pe())).next(d=>({batchId:a,changes:XP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next(r=>{let i=Ku();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Ku();return this.indexManager.getCollectionParents(e,o).next(a=>L.forEach(a,c=>{let u=function(f,m){return new Ls(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,m)=>{s=s.insert(f,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,Or.newInvalidDocument(d)))});let a=Ku();return s.forEach((c,u)=>{let d=o.get(c);d!==void 0&&Ju(d.mutation,u,Jr.empty(),Nt.now()),Gm(t,u)&&(a=a.insert(c,u))}),a})}};var iT=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return L.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ni(i.createTime)}}(t)),L.resolve()}getNamedQuery(e,t){return L.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(i){return{name:i.name,query:R5(i.bundledQuery),readTime:ni(i.readTime)}}(t)),L.resolve()}};var oT=class{constructor(){this.overlays=new Dt(ne.comparator),this.dr=new Map}getOverlay(e,t){return L.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Ns();return L.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.Tt(e,t,o)}),L.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.dr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.dr.delete(r)),L.resolve()}getOverlaysForCollection(e,t,r){let i=Ns(),o=t.length+1,s=new ne(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Dt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=o.get(u.largestBatchId);d===null&&(d=Ns(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=Ns(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return L.resolve(a)}Tt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.dr.get(i.largestBatchId).delete(r.key);this.dr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new jI(t,r));let o=this.dr.get(t);o===void 0&&(o=Pe(),this.dr.set(t,o)),this.dr.set(t,o.add(r.key))}};var sT=class{constructor(){this.sessionToken=fn.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,L.resolve()}};var od=class{constructor(){this.Er=new Qt(Vt.Ar),this.Rr=new Qt(Vt.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){let r=new Vt(e,t);this.Er=this.Er.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.gr(new Vt(e,t))}pr(e,t){e.forEach(r=>this.removeReference(r,t))}yr(e){let t=new ne(new vt([])),r=new Vt(t,e),i=new Vt(t,e+1),o=[];return this.Rr.forEachInRange([r,i],s=>{this.gr(s),o.push(s.key)}),o}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new ne(new vt([])),r=new Vt(t,e),i=new Vt(t,e+1),o=Pe();return this.Rr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Vt(e,0),r=this.Er.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Vt=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return ne.comparator(e.key,t.key)||ke(e.br,t.br)}static Vr(e,t){return ke(e.br,t.br)||ne.comparator(e.key,t.key)}};var aT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new Qt(Vt.Ar)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new VI(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.vr=this.vr.add(new Vt(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(s)}lookupMutationBatch(e,t){return L.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Fr(r),o=i<0?0:i;return L.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Vt(t,0),i=new Vt(t,Number.POSITIVE_INFINITY),o=[];return this.vr.forEachInRange([r,i],s=>{let a=this.Cr(s.br);o.push(a)}),L.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qt(ke);return t.forEach(i=>{let o=new Vt(i,0),s=new Vt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([o,s],a=>{r=r.add(a.br)})}),L.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;ne.isDocumentKey(o)||(o=o.child(""));let s=new Vt(new ne(o),0),a=new Qt(ke);return this.vr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.br)),!0)},s),L.resolve(this.Mr(a))}Mr(e){let t=[];return e.forEach(r=>{let i=this.Cr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Ge(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return L.forEach(t.mutations,i=>{let o=new Vt(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Bn(e){}containsKey(e,t){let r=new Vt(t,0),i=this.vr.firstAfterOrEqual(r);return L.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var cT=class{constructor(e){this.Nr=e,this.docs=function(){return new Dt(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return L.resolve(r?r.document.mutableCopy():Or.newInvalidDocument(t))}getEntries(e,t){let r=Li();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Or.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Li(),s=t.path,a=new ne(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||F6(O6(d),r)<=0||(i.has(d.key)||Gm(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return L.resolve(o)}getAllFromCollectionGroup(e,t,r,i){ae()}Br(e,t){return L.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new lT(this)}getSize(e){return L.resolve(this.size)}},lT=class extends tT{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),L.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var uT=class{constructor(e){this.persistence=e,this.Lr=new Fi(t=>QT(t),ZT),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.kr=0,this.qr=new od,this.targetCount=0,this.Qr=id.qn()}forEachTarget(e,t){return this.Lr.forEach((r,i)=>t(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),L.resolve()}Un(e){this.Lr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new id(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,L.resolve()}updateTargetData(e,t){return this.Un(t),L.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Lr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Lr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),L.waitFor(o).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,t){let r=this.Lr.get(t)||null;return L.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),L.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),L.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),L.resolve()}getMatchingKeysForTargetId(e,t){let r=this.qr.Sr(t);return L.resolve(r)}containsKey(e,t){return L.resolve(this.qr.containsKey(t))}};var Tm=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new GT(0),this.Ur=!1,this.Ur=!0,this.Wr=new sT,this.referenceDelegate=e(this),this.Gr=new uT(this),this.indexManager=new QI,this.remoteDocumentCache=function(i){return new cT(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new YI(t),this.jr=new iT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new aT(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){W("MemoryPersistence","Starting transaction:",e);let i=new dT(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(o=>this.referenceDelegate.Jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Yr(e,t){return L.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,t)))}},dT=class extends wI{constructor(e){super(),this.currentSequenceNumber=e}},hT=class n{constructor(e){this.persistence=e,this.Zr=new od,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw ae()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),L.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),L.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(i=>this.ti.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.ti.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.ti,r=>{let i=ne.fromPath(r);return this.ni(e,i).next(o=>{o||t.removeEntry(i,_e.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(r=>{r?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return L.or([()=>L.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},Cm=class n{constructor(e,t){this.persistence=e,this.ri=new Fi(r=>j6(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=x5(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return L.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}er(e,t){return L.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(o=>o?L.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Br(e,s=>this.ir(e,s,t).next(a=>{a||(r++,o.removeEntry(s,_e.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),L.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),L.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),L.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sm(e.data.value)),t}ir(e,t,r){return L.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ri.get(t);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var fT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=i}static zi(e,t){let r=Pe(),i=Pe();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var pT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var mT=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return AD()?8:V6(ln())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Xi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.es(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new pT;return this.ts(e,t,s).next(a=>{if(o.result=a,this.Hi)return this.ns(e,t,s,a.size)})}).next(()=>o.result)}ns(e,t,r,i){return r.documentReadCount<this.Ji?(pc()<=en.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",mc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),L.resolve()):(pc()<=en.DEBUG&&W("QueryEngine","Query:",mc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(pc()<=en.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",mc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ti(t))):L.resolve())}Xi(e,t){if(mP(t))return L.resolve(null);let r=ti(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=OI(t,null,"F"),r=ti(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=Pe(...o);return this.Zi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.rs(t,a);return this.ss(t,u,s,c.readTime)?this.Xi(e,OI(t,null,"F")):this.os(e,u,t,c)}))})))}es(e,t,r,i){return mP(t)||i.isEqual(_e.min())?L.resolve(null):this.Zi.getDocuments(e,r).next(o=>{let s=this.rs(t,o);return this.ss(t,s,r,i)?L.resolve(null):(pc()<=en.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mc(t)),this.os(e,s,t,k6(i,-1)).next(a=>a))})}rs(e,t){let r=new Qt(ZP(e));return t.forEach((i,o)=>{Gm(e,o)&&(r=r.add(o))}),r}ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ts(e,t,r){return pc()<=en.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",mc(t)),this.Zi.getDocumentsMatchingQuery(e,t,Fs.min(),r)}os(e,t,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var gT=class{constructor(e,t,r,i){this.persistence=e,this._s=t,this.serializer=i,this.us=new Dt(ke),this.cs=new Fi(o=>QT(o),ZT),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rT(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function N5(n,e,t,r){return new gT(n,e,t,r)}function gk(n,e){return y(this,null,function*(){let t=ve(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ps(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=Pe();for(let u of i){s.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({Ts:u,removedBatchIds:s,addedBatchIds:a}))})})})}function M5(n,e){let t=ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let f=u.batch,m=f.keys(),v=L.resolve();return m.forEach(w=>{v=v.next(()=>d.getEntry(c,w)).next(P=>{let N=u.docVersions.get(w);Ge(N!==null),P.version.compareTo(N)<0&&(f.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),d.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function vk(n){let e=ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function P5(n,e){let t=ve(n),r=e.snapshotVersion,i=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.hs.newChangeBuffer({trackRemovals:!0});i=t.us;let a=[];e.targetChanges.forEach((d,f)=>{let m=i.get(f);if(!m)return;a.push(t.Gr.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.Gr.addMatchingKeys(o,d.addedDocuments,f)));let v=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(fn.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(f,v),function(P,N,V){return P.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(m,v,d)&&a.push(t.Gr.updateTargetData(o,v))});let c=Li(),u=Pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(k5(o,s,e.documentUpdates).next(d=>{c=d.Is,u=d.ds})),!r.isEqual(_e.min())){let d=t.Gr.getLastRemoteSnapshotVersion(o).next(f=>t.Gr.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return L.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(t.us=i,o))}function k5(n,e,t){let r=Pe(),i=Pe();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Li();return t.forEach((a,c)=>{let u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(_e.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):W("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Is:s,ds:i}})}function O5(n,e){let t=ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function F5(n,e){let t=ve(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Gr.getTargetData(r,e).next(o=>o?(i=o,L.resolve(i)):t.Gr.allocateTargetId(r).next(s=>(i=new rd(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.us=t.us.insert(r.targetId,r),t.cs.set(e,r.targetId)),r})}function vT(n,e,t){return y(this,null,function*(){let r=ve(n),i=r.us.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Oc(s))throw s;W("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.us=r.us.remove(e),r.cs.delete(i.target)})}function SP(n,e,t){let r=ve(n),i=_e.min(),o=Pe();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,d){let f=ve(c),m=f.cs.get(d);return m!==void 0?L.resolve(f.us.get(m)):f.Gr.getTargetData(u,d)}(r,s,ti(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r._s.getDocumentsMatchingQuery(s,e,t?i:_e.min(),t?o:Pe())).next(a=>(L5(r,Z6(e),a),{documents:a,Es:o})))}function L5(n,e,t){let r=n.ls.get(e)||_e.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.ls.set(e,r)}var bm=class{constructor(){this.activeTargetIds=r5()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var yT=class{constructor(){this._o=new bm,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new bm,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _T=class{uo(e){}shutdown(){}};var Dm=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){W("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){W("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var om=null;function lI(){return om===null?om=function(){return 268435456+Math.round(2147483648*Math.random())}():om++,"0x"+om.toString(16)}var V5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var wT=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var hn="WebChannelConnection",ET=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+t.host,this.Mo=`projects/${i}/databases/${o}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Oo(t,r,i,o,s){let a=lI(),c=this.No(t,r.toUriEncodedString());W("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(u,o,s),this.Lo(t,c,u,i).then(d=>(W("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Ec("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}ko(t,r,i,o,s,a){return this.Oo(t,r,i,o,s)}Bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}No(t,r){let i=V5[t];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,r,i){let o=lI();return new Promise((s,a)=>{let c=new rI;c.setWithCredentials(!0),c.listenOnce(iI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Gu.NO_ERROR:let d=c.getResponseJson();W(hn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),s(d);break;case Gu.TIMEOUT:W(hn,`RPC '${e}' ${o} timed out`),a(new K(F.DEADLINE_EXCEEDED,"Request time out"));break;case Gu.HTTP_ERROR:let f=c.getStatus();if(W(hn,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let w=function(N){let V=N.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(V)>=0?V:F.UNKNOWN}(v.status);a(new K(w,v.message))}else a(new K(F.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new K(F.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{W(hn,`RPC '${e}' ${o} completed.`)}});let u=JSON.stringify(i);W(hn,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",u,r,15)})}qo(e,t,r){let i=lI(),o=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=aI(),a=sI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Bo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=o.join("");W(hn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=s.createWebChannel(d,c),m=!1,v=!1,w=new wT({Eo:N=>{v?W(hn,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(W(hn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),W(hn,`RPC '${e}' stream ${i} sending:`,N),f.send(N))},Ao:()=>f.close()}),P=(N,V,z)=>{N.listen(V,Y=>{try{z(Y)}catch(re){setTimeout(()=>{throw re},0)}})};return P(f,fc.EventType.OPEN,()=>{v||(W(hn,`RPC '${e}' stream ${i} transport opened.`),w.So())}),P(f,fc.EventType.CLOSE,()=>{v||(v=!0,W(hn,`RPC '${e}' stream ${i} transport closed`),w.Do())}),P(f,fc.EventType.ERROR,N=>{v||(v=!0,Ec(hn,`RPC '${e}' stream ${i} transport errored:`,N),w.Do(new K(F.UNAVAILABLE,"The operation could not be completed")))}),P(f,fc.EventType.MESSAGE,N=>{var V;if(!v){let z=N.data[0];Ge(!!z);let Y=z,re=Y?.error||((V=Y[0])===null||V===void 0?void 0:V.error);if(re){W(hn,`RPC '${e}' stream ${i} received error:`,re);let it=re.status,le=function(E){let b=Lt[E];if(b!==void 0)return ck(b)}(it),D=re.message;le===void 0&&(le=F.INTERNAL,D="Unknown error status: "+it+" with message "+re.message),v=!0,w.Do(new K(le,D)),f.close()}else W(hn,`RPC '${e}' stream ${i} received:`,z),w.vo(z)}}),P(a,oI.STAT_EVENT,N=>{N.stat===nm.PROXY?W(hn,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===nm.NOPROXY&&W(hn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.bo()},0),w}};function uI(){return typeof document<"u"?document:null}function Km(n){return new qI(n,!0)}var Sm=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&W("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var Am=class{constructor(e,t,r,i,o,s,a,c){this.li=e,this.Yo=r,this.Zo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new Sm(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return y(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return y(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return y(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Pi(t.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===t&&this.I_(r,i)},r=>{e(()=>{let i=new K(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.d_(i)})})}I_(e,t){let r=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.d_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(()=>y(this,null,function*(){this.state=0,this.start()}))}d_(e){return W("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(W("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},IT=class extends Am{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=y5(this.serializer,e),r=function(o){if(!("targetChange"in o))return _e.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?_e.min():s.readTime?ni(s.readTime):_e.min()}(e);return this.listener.R_(t,r)}V_(e){let t={};t.database=KI(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=PI(c)?{documents:E5(o,c)}:{query:I5(o,c).ct},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=lk(o,s.resumeToken);let u=WI(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(_e.min())>0){a.readTime=Em(o,s.snapshotVersion.toTimestamp());let u=WI(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=C5(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){let t={};t.database=KI(this.serializer),t.removeTarget=e,this.c_(t)}},TT=class extends Am{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=w5(e.writeResults,e.commitTime),r=ni(e.commitTime);return this.listener.y_(r,t)}w_(){let e={};e.database=KI(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>_5(this.serializer,r))};this.c_(t)}};var CT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Oo(e,zI(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(F.UNKNOWN,o.toString())})}ko(e,t,r,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.ko(e,zI(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(F.UNKNOWN,s.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},bT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Pi(t),this.C_=!1):W("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var DT=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=o,this.Q_.uo(s=>{r.enqueueAndForget(()=>y(this,null,function*(){qs(this)&&(W("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let u=ve(c);u.k_.add(4),yield hd(u),u.K_.set("Unknown"),u.k_.delete(4),yield Ym(u)})}(this))}))}),this.K_=new bT(r,i)}};function Ym(n){return y(this,null,function*(){if(qs(n))for(let e of n.q_)yield e(!0)})}function hd(n){return y(this,null,function*(){for(let e of n.q_)yield e(!1)})}function yk(n,e){let t=ve(n);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),i0(t)?r0(t):Fc(t).s_()&&n0(t,e))}function t0(n,e){let t=ve(n),r=Fc(t);t.L_.delete(e),r.s_()&&_k(t,e),t.L_.size===0&&(r.s_()?r.a_():qs(t)&&t.K_.set("Unknown"))}function n0(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Fc(n).V_(e)}function _k(n,e){n.U_.xe(e),Fc(n).m_(e)}function r0(n){n.U_=new HI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.L_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Fc(n).start(),n.K_.F_()}function i0(n){return qs(n)&&!Fc(n).i_()&&n.L_.size>0}function qs(n){return ve(n).k_.size===0}function wk(n){n.U_=void 0}function U5(n){return y(this,null,function*(){n.K_.set("Online")})}function j5(n){return y(this,null,function*(){n.L_.forEach((e,t)=>{n0(n,e)})})}function B5(n,e){return y(this,null,function*(){wk(n),i0(n)?(n.K_.O_(e),r0(n)):n.K_.set("Unknown")})}function $5(n,e,t){return y(this,null,function*(){if(n.K_.set("Online"),e instanceof _m&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.L_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.L_.delete(a),i.U_.removeTarget(a))})}(n,e)}catch(r){W("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Rm(n,r)}else if(e instanceof _c?n.U_.$e(e):e instanceof ym?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(_e.min()))try{let r=yield vk(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.U_.it(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=o.L_.get(u);d&&o.L_.set(u,d.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{let d=o.L_.get(c);if(!d)return;o.L_.set(c,d.withResumeToken(fn.EMPTY_BYTE_STRING,d.snapshotVersion)),_k(o,c);let f=new rd(d.target,c,u,d.sequenceNumber);n0(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){W("RemoteStore","Failed to raise snapshot:",r),yield Rm(n,r)}})}function Rm(n,e,t){return y(this,null,function*(){if(!Oc(e))throw e;n.k_.add(1),yield hd(n),n.K_.set("Offline"),t||(t=()=>vk(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){W("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield Ym(n)}))})}function Ek(n,e){return e().catch(t=>Rm(n,t,e))}function Qm(n){return y(this,null,function*(){let e=ve(n),t=ko(e),r=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;H5(e);)try{let i=yield O5(e.localStore,r);if(i===null){e.B_.length===0&&t.a_();break}r=i.batchId,q5(e,i)}catch(i){yield Rm(e,i)}Ik(e)&&Tk(e)})}function H5(n){return qs(n)&&n.B_.length<10}function q5(n,e){n.B_.push(e);let t=ko(n);t.s_()&&t.f_&&t.g_(e.mutations)}function Ik(n){return qs(n)&&!ko(n).i_()&&n.B_.length>0}function Tk(n){ko(n).start()}function W5(n){return y(this,null,function*(){ko(n).w_()})}function z5(n){return y(this,null,function*(){let e=ko(n);for(let t of n.B_)e.g_(t.mutations)})}function G5(n,e,t){return y(this,null,function*(){let r=n.B_.shift(),i=UI.from(r,e,t);yield Ek(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Qm(n)})}function K5(n,e){return y(this,null,function*(){e&&ko(n).f_&&(yield function(r,i){return y(this,null,function*(){if(function(s){return u5(s)&&s!==F.ABORTED}(i.code)){let o=r.B_.shift();ko(r).__(),yield Ek(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Qm(r)}})}(n,e)),Ik(n)&&Tk(n)})}function AP(n,e){return y(this,null,function*(){let t=ve(n);t.asyncQueue.verifyOperationInProgress(),W("RemoteStore","RemoteStore received new credentials");let r=qs(t);t.k_.add(3),yield hd(t),r&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield Ym(t)})}function Y5(n,e){return y(this,null,function*(){let t=ve(n);e?(t.k_.delete(2),yield Ym(t)):e||(t.k_.add(2),yield hd(t),t.K_.set("Unknown"))})}function Fc(n){return n.W_||(n.W_=function(t,r,i){let o=ve(t);return o.b_(),new IT(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:U5.bind(null,n),mo:j5.bind(null,n),po:B5.bind(null,n),R_:$5.bind(null,n)}),n.q_.push(e=>y(this,null,function*(){e?(n.W_.__(),i0(n)?r0(n):n.K_.set("Unknown")):(yield n.W_.stop(),wk(n))}))),n.W_}function ko(n){return n.G_||(n.G_=function(t,r,i){let o=ve(t);return o.b_(),new TT(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:W5.bind(null,n),po:K5.bind(null,n),p_:z5.bind(null,n),y_:G5.bind(null,n)}),n.q_.push(e=>y(this,null,function*(){e?(n.G_.__(),yield Qm(n)):(yield n.G_.stop(),n.B_.length>0&&(W("RemoteStore",`Stopping write stream with ${n.B_.length} pending writes`),n.B_=[]))}))),n.G_}var ST=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Xr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function o0(n,e){if(Pi("AsyncQueue",`${e}: ${n}`),Oc(n))return new K(F.UNAVAILABLE,`${e}: ${n}`);throw n}var xm=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ne.comparator(t.key,r.key):(t,r)=>ne.comparator(t.key,r.key),this.keyedMap=Ku(),this.sortedSet=new Dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Nm=class{constructor(){this.z_=new Dt(ne.comparator)}track(e){let t=e.doc.key,r=this.z_.get(t);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(t,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(t):e.type===1&&r.type===2?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):ae():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,r)=>{e.push(r)}),e}},Nc=class n{constructor(e,t,r,i,o,s,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,xm.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var AT=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},RT=class{constructor(){this.queries=RP(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,r){let i=ve(t),o=i.queries;i.queries=RP(),o.forEach((s,a)=>{for(let c of a.J_)c.onError(r)})})(this,new K(F.ABORTED,"Firestore shutting down"))}};function RP(){return new Fi(n=>QP(n),zm)}function Ck(n,e){return y(this,null,function*(){let t=ve(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Y_()&&e.Z_()&&(r=2):(o=new AT,r=e.Z_()?0:1);try{switch(r){case 0:o.H_=yield t.onListen(i,!0);break;case 1:o.H_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=o0(s,`Initialization of query '${mc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.J_.push(e),e.ea(t.onlineState),o.H_&&e.ta(o.H_)&&s0(t)})}function bk(n,e){return y(this,null,function*(){let t=ve(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.J_.indexOf(e);s>=0&&(o.J_.splice(s,1),o.J_.length===0?i=e.Z_()?0:1:!o.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function Q5(n,e){let t=ve(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.J_)a.ta(i)&&(r=!0);s.H_=i}}r&&s0(t)}function Z5(n,e,t){let r=ve(n),i=r.queries.get(e);if(i)for(let o of i.J_)o.onError(t);r.queries.delete(e)}function s0(n){n.X_.forEach(e=>{e.next()})}var xT,xP;(xP=xT||(xT={})).na="default",xP.Cache="cache";var Mm=class{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Nc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let r=t!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=Nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==xT.Cache}};var Pm=class{constructor(e){this.key=e}},km=class{constructor(e){this.key=e}},NT=class{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Pe(),this.mutatedKeys=Pe(),this.Va=ZP(e),this.ma=new xm(this.Va)}get fa(){return this.Ea}ga(e,t){let r=t?t.pa:new Nm,i=t?t.ma:this.ma,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let m=i.get(d),v=Gm(this.query,f)?f:null,w=!!m&&this.mutatedKeys.has(m.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),N=!1;m&&v?m.data.isEqual(v.data)?w!==P&&(r.track({type:3,doc:v}),N=!0):this.ya(m,v)||(r.track({type:2,doc:v}),N=!0,(c&&this.Va(v,c)>0||u&&this.Va(v,u)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),N=!0):m&&!v&&(r.track({type:1,doc:m}),N=!0,(c||u)&&(a=!0)),N&&(v?(s=s.add(v),o=P?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{ma:s,pa:r,ss:a,mutatedKeys:o}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let s=e.pa.j_();s.sort((d,f)=>function(v,w){let P=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(v)-P(w)}(d.type,f.type)||this.Va(d.doc,f.doc)),this.wa(r),i=i!=null&&i;let a=t&&!i?this.Sa():[],c=this.Ra.size===0&&this.current&&!i?1:0,u=c!==this.Aa;return this.Aa=c,s.length!==0||u?{snapshot:new Nc(this.query,e.ma,o,s,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Nm,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=Pe(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let t=[];return e.forEach(r=>{this.Ra.has(r)||t.push(new km(r))}),this.Ra.forEach(r=>{e.has(r)||t.push(new Pm(r))}),t}va(e){this.Ea=e.Es,this.Ra=Pe();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return Nc.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},MT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},PT=class{constructor(e){this.key=e,this.Fa=!1}},kT=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new Fi(a=>QP(a),zm),this.Oa=new Map,this.Na=new Set,this.Ba=new Dt(ne.comparator),this.La=new Map,this.ka=new od,this.qa={},this.Qa=new Map,this.Ka=id.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function J5(n,e,t=!0){return y(this,null,function*(){let r=Nk(n),i,o=r.xa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Ca()):i=yield Dk(r,e,t,!0),i})}function X5(n,e){return y(this,null,function*(){let t=Nk(n);yield Dk(t,e,!0,!1)})}function Dk(n,e,t,r){return y(this,null,function*(){let i=yield F5(n.localStore,ti(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield e9(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&yk(n.remoteStore,i),a})}function e9(n,e,t,r,i){return y(this,null,function*(){n.Ua=(f,m,v)=>function(P,N,V,z){return y(this,null,function*(){let Y=N.view.ga(V);Y.ss&&(Y=yield SP(P.localStore,N.query,!1).then(({documents:D})=>N.view.ga(D,Y)));let re=z&&z.targetChanges.get(N.targetId),it=z&&z.targetMismatches.get(N.targetId)!=null,le=N.view.applyChanges(Y,P.isPrimaryClient,re,it);return MP(P,N.targetId,le.ba),le.snapshot})}(n,f,m,v);let o=yield SP(n.localStore,e,!0),s=new NT(e,o.Es),a=s.ga(o.documents),c=nd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=s.applyChanges(a,n.isPrimaryClient,c);MP(n,t,u.ba);let d=new MT(e,t,s);return n.xa.set(e,d),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),u.snapshot})}function t9(n,e,t){return y(this,null,function*(){let r=ve(n),i=r.xa.get(e),o=r.Oa.get(i.targetId);if(o.length>1)return r.Oa.set(i.targetId,o.filter(s=>!zm(s,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield vT(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&t0(r.remoteStore,i.targetId),OT(r,i.targetId)}).catch(kc))):(OT(r,i.targetId),yield vT(r.localStore,i.targetId,!0))})}function n9(n,e){return y(this,null,function*(){let t=ve(n),r=t.xa.get(e),i=t.Oa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),t0(t.remoteStore,r.targetId))})}function r9(n,e,t){return y(this,null,function*(){let r=u9(n);try{let i=yield function(s,a){let c=ve(s),u=Nt.now(),d=a.reduce((v,w)=>v.add(w.key),Pe()),f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let w=Li(),P=Pe();return c.hs.getEntries(v,d).next(N=>{w=N,w.forEach((V,z)=>{z.isValidDocument()||(P=P.add(V))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,w)).next(N=>{f=N;let V=[];for(let z of a){let Y=l5(z,f.get(z.key).overlayedDocument);Y!=null&&V.push(new Vi(z.key,Y,HP(Y.value.mapValue),ks.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,V,a)}).next(N=>{m=N;let V=N.applyToLocalDocumentSet(f,P);return c.documentOverlayCache.saveOverlays(v,N.batchId,V)})}).then(()=>({batchId:m.batchId,changes:XP(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let u=s.qa[s.currentUser.toKey()];u||(u=new Dt(ke)),u=u.insert(a,c),s.qa[s.currentUser.toKey()]=u}(r,i.batchId,t),yield fd(r,i.changes),yield Qm(r.remoteStore)}catch(i){let o=o0(i,"Failed to persist write");t.reject(o)}})}function Sk(n,e){return y(this,null,function*(){let t=ve(n);try{let r=yield P5(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.La.get(o);s&&(Ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Fa=!0:i.modifiedDocuments.size>0?Ge(s.Fa):i.removedDocuments.size>0&&(Ge(s.Fa),s.Fa=!1))}),yield fd(t,r,e)}catch(r){yield kc(r)}})}function NP(n,e,t){let r=ve(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xa.forEach((o,s)=>{let a=s.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=ve(s);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(let m of f.J_)m.ea(a)&&(u=!0)}),u&&s0(c)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function i9(n,e,t){return y(this,null,function*(){let r=ve(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.La.get(e),o=i&&i.key;if(o){let s=new Dt(ne.comparator);s=s.insert(o,Or.newNoDocument(o,_e.min()));let a=Pe().add(o),c=new vm(_e.min(),new Map,new Dt(ke),s,a);yield Sk(r,c),r.Ba=r.Ba.remove(o),r.La.delete(e),a0(r)}else yield vT(r.localStore,e,!1).then(()=>OT(r,e,t)).catch(kc)})}function o9(n,e){return y(this,null,function*(){let t=ve(n),r=e.batch.batchId;try{let i=yield M5(t.localStore,e);Rk(t,r,null),Ak(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield fd(t,i)}catch(i){yield kc(i)}})}function s9(n,e,t){return y(this,null,function*(){let r=ve(n);try{let i=yield function(s,a){let c=ve(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(Ge(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Rk(r,e,t),Ak(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield fd(r,i)}catch(i){yield kc(i)}})}function Ak(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function Rk(n,e,t){let r=ve(n),i=r.qa[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function OT(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Oa.get(e))n.xa.delete(r),t&&n.Ma.Wa(r,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(r=>{n.ka.containsKey(r)||xk(n,r)})}function xk(n,e){n.Na.delete(e.path.canonicalString());let t=n.Ba.get(e);t!==null&&(t0(n.remoteStore,t),n.Ba=n.Ba.remove(e),n.La.delete(t),a0(n))}function MP(n,e,t){for(let r of t)r instanceof Pm?(n.ka.addReference(r.key,e),a9(n,r)):r instanceof km?(W("SyncEngine","Document no longer in limbo: "+r.key),n.ka.removeReference(r.key,e),n.ka.containsKey(r.key)||xk(n,r.key)):ae()}function a9(n,e){let t=e.key,r=t.path.canonicalString();n.Ba.get(t)||n.Na.has(r)||(W("SyncEngine","New document in limbo: "+t),n.Na.add(r),a0(n))}function a0(n){for(;n.Na.size>0&&n.Ba.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new ne(vt.fromString(e)),r=n.Ka.next();n.La.set(r,new PT(t)),n.Ba=n.Ba.insert(t,r),yk(n.remoteStore,new rd(ti(JT(t.path)),r,"TargetPurposeLimboResolution",GT.oe))}}function fd(n,e,t){return y(this,null,function*(){let r=ve(n),i=[],o=[],s=[];r.xa.isEmpty()||(r.xa.forEach((a,c)=>{s.push(r.Ua(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){let f=u?!u.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);let f=fT.zi(c.targetId,u);o.push(f)}}))}),yield Promise.all(s),r.Ma.R_(i),yield function(c,u){return y(this,null,function*(){let d=ve(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>L.forEach(u,m=>L.forEach(m.Wi,v=>d.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>L.forEach(m.Gi,v=>d.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!Oc(f))throw f;W("LocalStore","Failed to update sequence numbers: "+f)}for(let f of u){let m=f.targetId;if(!f.fromCache){let v=d.us.get(m),w=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(w);d.us=d.us.insert(m,P)}}})}(r.localStore,o))})}function c9(n,e){return y(this,null,function*(){let t=ve(n);if(!t.currentUser.isEqual(e)){W("SyncEngine","User change. New user:",e.toKey());let r=yield gk(t.localStore,e);t.currentUser=e,function(o,s){o.Qa.forEach(a=>{a.forEach(c=>{c.reject(new K(F.CANCELLED,s))})}),o.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield fd(t,r.Ts)}})}function l9(n,e){let t=ve(n),r=t.La.get(e);if(r&&r.Fa)return Pe().add(r.key);{let i=Pe(),o=t.Oa.get(e);if(!o)return i;for(let s of o){let a=t.xa.get(s);i=i.unionWith(a.view.fa)}return i}}function Nk(n){let e=ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=i9.bind(null,e),e.Ma.R_=Q5.bind(null,e.eventManager),e.Ma.Wa=Z5.bind(null,e.eventManager),e}function u9(n){let e=ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s9.bind(null,e),e}var Mk=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Km(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,r){return null}Ya(t,r){return null}Ha(t){return N5(this.persistence,new mT,t.initialUser,this.serializer)}ja(t){return new Tm(hT.ei,this.serializer)}za(t){return new yT}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),FT=class extends Mk{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Ge(this.persistence.referenceDelegate instanceof Cm);let r=this.persistence.referenceDelegate.garbageCollector;return new XI(r,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Tm(r=>Cm.ei(r,t),this.serializer)}};var d9=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>NP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=c9.bind(null,this.syncEngine),yield Y5(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new RT}()}createDatastore(t){let r=Km(t.databaseInfo.databaseId),i=function(s){return new ET(s)}(t.databaseInfo);return function(s,a,c,u){return new CT(s,a,c,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new DT(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>NP(this.syncEngine,r,0),function(){return Dm.p()?new Dm:new _T}())}createSyncEngine(t,r){return function(o,s,a,c,u,d,f){let m=new kT(o,s,a,c,u,d);return f&&(m.$a=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(o){return y(this,null,function*(){let s=ve(o);W("RemoteStore","RemoteStore shutting down."),s.k_.add(5),yield hd(s),s.Q_.shutdown(),s.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Om=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Pi("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var LT=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Yt.UNAUTHENTICATED,this.clientId=um.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>y(this,null,function*(){W("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(W("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Xr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=o0(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function dI(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),W("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield gk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function PP(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield h9(n);W("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>AP(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>AP(e.remoteStore,i)),n._onlineComponents=e})}function h9(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){W("FirestoreClient","Using user provided OfflineComponentProvider");try{yield dI(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Ec("Error using user provided cache. Falling back to memory cache: "+t),yield dI(n,new Mk)}}else W("FirestoreClient","Using default OfflineComponentProvider"),yield dI(n,new FT(void 0));return n._offlineComponents})}function Pk(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(W("FirestoreClient","Using user provided OnlineComponentProvider"),yield PP(n,n._uninitializedComponentsProvider._online)):(W("FirestoreClient","Using default OnlineComponentProvider"),yield PP(n,new d9))),n._onlineComponents})}function f9(n){return Pk(n).then(e=>e.syncEngine)}function VT(n){return y(this,null,function*(){let e=yield Pk(n),t=e.eventManager;return t.onListen=J5.bind(null,e.syncEngine),t.onUnlisten=t9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=X5.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=n9.bind(null,e.syncEngine),t})}function p9(n,e,t={}){let r=new Xr;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(o,s,a,c,u){let d=new Om({next:m=>{d.eu(),s.enqueueAndForget(()=>bk(o,f)),m.fromCache&&c.source==="server"?u.reject(new K(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Mm(a,d,{includeMetadataChanges:!0,ua:!0});return Ck(o,f)}(yield VT(n),n.asyncQueue,e,t,r)})),r.promise}function kk(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var kP=new Map;function Ok(n,e,t){if(!t)throw new K(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function m9(n,e,t,r){if(e===!0&&r===!0)throw new K(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function OP(n){if(!ne.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function FP(n){if(ne.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Zm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ae()}function No(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new K(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Zm(n);throw new K(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Fm=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}m9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Mc=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new hI;switch(r.type){case"firstParty":return new gI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=kP.get(t);r&&(W("ComponentProvider","Removing Datastore"),kP.delete(t),r.terminate())}(this),Promise.resolve()}};function Fk(n,e,t,r={}){var i;let o=(n=No(n,Mc))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Yt.MOCK_USER;else{a=da(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new K(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Yt(u)}n._authCredentials=new fI(new lm(a,c))}}var Bs=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Bn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Mo=class n extends Bs{constructor(e,t,r){super(e,t,JT(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Bn(this.firestore,null,new ne(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Lk(n,e,...t){if(n=Fe(n),Ok("collection","path",e),n instanceof Mc){let r=vt.fromString(e,...t);return FP(r),new Mo(n,null,r)}{if(!(n instanceof Bn||n instanceof Mo))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(vt.fromString(e,...t));return FP(r),new Mo(n.firestore,null,r)}}function Vk(n,e,...t){if(n=Fe(n),arguments.length===1&&(e=um.newId()),Ok("doc","path",e),n instanceof Mc){let r=vt.fromString(e,...t);return OP(r),new Bn(n,null,new ne(r))}{if(!(n instanceof Bn||n instanceof Mo))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(vt.fromString(e,...t));return OP(r),new Bn(n.firestore,n instanceof Mo?n.converter:null,new ne(r))}}var Lm=class{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new Sm(this,"async_queue_retry"),this.fu=()=>{let r=uI();r&&W("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let t=uI();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;let t=uI();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});let t=new Xr;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return y(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!Oc(e))throw e;W("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Pi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let i=ST.createAndSchedule(this,e,t,r,o=>this.Su(o));return this.Eu.push(i),i}pu(){this.Au&&ae()}verifyOperationInProgress(){}bu(){return y(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.Eu.indexOf(e);this.Eu.splice(t,1)}};function LP(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var $s=class extends Mc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Lm,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Lm(e),this._firestoreClient=void 0,yield e}})}};function Uk(n,e){let t=typeof n=="object"?n:Ht(),r=typeof n=="string"?n:e||"(default)",i=$t(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=eo("firestore");o&&Fk(i,...o)}return i}function c0(n){if(n._terminated)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||g9(n),n._firestoreClient}function g9(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,u,d){return new EI(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,kk(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new LT(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}var sd=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(fn.fromBase64String(e))}catch(t){throw new K(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ad=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new K(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Vm=class{constructor(e){this._methodName=e}};var cd=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ke(this._lat,e._lat)||ke(this._long,e._long)}};var ld=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var v9=/^__.*__$/,UT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new js(e,this.data,t,this.fieldTransforms)}};function jk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}var jT=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Fu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Bu(e),i}Lu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Um(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(jk(this.Mu)&&v9.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},BT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Km(e)}$u(e,t,r,i=!1){return new jT({Mu:e,methodName:t,Ku:r,path:Xn.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Bk(n){let e=n._freezeSettings(),t=Km(n._databaseId);return new BT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function y9(n,e,t,r,i,o={}){let s=n.$u(o.merge||o.mergeFields?2:0,e,t,i);qk("Data must be an object, but it was:",s,r);let a=$k(r,s),c,u;if(o.merge)c=new Jr(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let m=w9(e,f,t);if(!s.contains(m))throw new K(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);I9(d,m)||d.push(m)}c=new Jr(d),u=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=s.fieldTransforms;return new UT(new kr(a),c,u)}function _9(n,e,t,r=!1){return l0(t,n.$u(r?4:3,e))}function l0(n,e){if(Hk(n=Fe(n)))return qk("Unsupported field value:",e,n),$k(n,e);if(n instanceof Vm)return function(r,i){if(!jk(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=l0(a,i.ku(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return i5(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Nt.fromDate(r);return{timestampValue:Em(i.serializer,o)}}if(r instanceof Nt){let o=new Nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Em(i.serializer,o)}}if(r instanceof cd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof sd)return{bytesValue:lk(i.serializer,r._byteString)};if(r instanceof Bn){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.qu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:e0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ld)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.qu("VectorValues must only contain numeric values.");return XT(a.serializer,c)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${Zm(r)}`)}(n,e)}function $k(n,e){let t={};return jP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hs(n,(r,i)=>{let o=l0(i,e.Ou(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Hk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Nt||n instanceof cd||n instanceof sd||n instanceof Bn||n instanceof Vm||n instanceof ld)}function qk(n,e,t){if(!Hk(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Zm(t);throw r==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+r)}}function w9(n,e,t){if((e=Fe(e))instanceof ad)return e._internalPath;if(typeof e=="string")return Wk(n,e);throw Um("Field path arguments must be of type string or ",n,!1,void 0,t)}var E9=new RegExp("[~\\*/\\[\\]]");function Wk(n,e,t){if(e.search(E9)>=0)throw Um(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ad(...e.split("."))._internalPath}catch{throw Um(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Um(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new K(F.INVALID_ARGUMENT,a+n+c)}function I9(n,e){return n.some(t=>t.isEqual(e))}var jm=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new $T(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(u0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},$T=class extends jm{data(){return super.data()}};function u0(n,e){return typeof e=="string"?Wk(n,e):e instanceof ad?e._internalPath:e._delegate._internalPath}function zk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new K(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ud=class{},HT=class extends ud{};function Gk(n,e,...t){let r=[];e instanceof ud&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof qT).length,a=o.filter(c=>c instanceof Bm).length;if(s>1||s>0&&a>0)throw new K(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Bm=class n extends HT{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Yk(e._query,t),new Bs(e.firestore,e.converter,kI(e._query,t))}_parse(e){let t=Bk(e.firestore);return function(o,s,a,c,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new K(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){UP(f,d);let v=[];for(let w of f)v.push(VP(c,o,w));m={arrayValue:{values:v}}}else m=VP(c,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||UP(f,d),m=_9(a,s,f,d==="in"||d==="not-in");return Ut.create(u,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Kk(n,e,t){let r=e,i=u0("where",n);return Bm._create(i,r,t)}var qT=class n extends ud{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Fr.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)Yk(s,c),s=kI(s,c)}(e._query,t),new Bs(e.firestore,e.converter,kI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function VP(n,e,t){if(typeof(t=Fe(t))=="string"){if(t==="")throw new K(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!YP(e)&&t.indexOf("/")!==-1)throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(vt.fromString(t));if(!ne.isDocumentKey(r))throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lP(n,new ne(r))}if(t instanceof Bn)return lP(n,t._key);throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zm(t)}.`)}function UP(n,e){if(!Array.isArray(n)||n.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yk(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var WT=class{convertValue(e,t="none"){switch(Po(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Hs(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>ht(s.doubleValue));return new ld(o)}convertGeoPoint(e){return new cd(ht(e.latitude),ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Wm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ed(e));default:return null}}convertTimestamp(e){let t=ki(e);return new Nt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=vt.fromString(e);Ge(mk(r));let i=new pm(r.get(1),r.get(3)),o=new ne(r.popFirst(5));return i.isEqual(t)||Pi(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function T9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Ps=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},$m=class extends jm{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new wc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(u0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},wc=class extends $m{data(e={}){return super.data(e)}},Hm=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ps(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wc(this._firestore,this._userDataWriter,r.key,r,new Ps(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new wc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ps(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new wc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ps(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:C9(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function C9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}var dd=class extends WT{constructor(e){super(),this.firestore=e}convertBytes(e){return new sd(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Bn(this.firestore,null,t)}};function Qk(n){n=No(n,Bs);let e=No(n.firestore,$s),t=c0(e),r=new dd(e);return zk(n._query),p9(t,n._query).then(i=>new Hm(e,r,n,i))}function Zk(n,e,t){n=No(n,Bn);let r=No(n.firestore,$s),i=T9(n.converter,e,t);return b9(r,[y9(Bk(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ks.none())])}function d0(n,...e){var t,r,i;n=Fe(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||LP(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(LP(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[s+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,u,d;if(n instanceof Bn)u=No(n.firestore,$s),d=JT(n._key.path),c={next:f=>{e[s]&&e[s](D9(u,n,f))},error:e[s+1],complete:e[s+2]};else{let f=No(n,Bs);u=No(f.firestore,$s),d=f._query;let m=new dd(u);c={next:v=>{e[s]&&e[s](new Hm(u,m,f,v))},error:e[s+1],complete:e[s+2]},zk(n._query)}return function(m,v,w,P){let N=new Om(P),V=new Mm(v,N,w);return m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Ck(yield VT(m),V)})),()=>{N.eu(),m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return bk(yield VT(m),V)}))}}(c0(u),d,a,c)}function b9(n,e){return function(r,i){let o=new Xr;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return r9(yield f9(r),i,o)})),o.promise}(c0(n),e)}function D9(n,e,t){let r=t.docs.get(e._key),i=new dd(n);return new $m(n,i,e._key,r,new Ps(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Pc=i})(xn),It(new Et("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new $s(new pI(r.getProvider("auth-internal")),new yI(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new K(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pm(u.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),te(iP,"4.7.6",e),te(iP,"4.7.6","esm2017")})();var Jm=function(){return Jm=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Jm.apply(this,arguments)};var R9={includeMetadataChanges:!1};function Jk(n,e){return e===void 0&&(e=R9),new fe(function(t){var r=d0(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function Xk(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Jm(Jm({},r),(t={},t[e.idField]=n.id,t))}function eO(n){return Jk(n,{includeMetadataChanges:!0}).pipe(X(function(e){return e.docs}))}function tO(n,e){return e===void 0&&(e={}),eO(n).pipe(X(function(t){return t.map(function(r){return Xk(r,e)})}))}var Ws=class{constructor(e){return e}},nO="firestore",h0=class{constructor(){return Ft(nO)}};var f0=new H("angularfire2.firestore-instances");function x9(n,e){let t=Wt(nO,n,e);return t&&new Ws(t)}function N9(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ws(r)}}var M9={provide:h0,deps:[[new Ee,f0]]},P9={provide:Ws,useFactory:x9,deps:[[new Ee,f0],gt]};function rO(n,...e){return te("angularfire",dt.full,"fst"),ut([P9,M9,{provide:f0,useFactory:N9(n),multi:!0,deps:[pe,De,bt,xt,[new Ee,Pr],[new Ee,fr],...e]}])}var mr=$e(tO,!0);var gr=$e(Lk,!0,2);var p0=$e(Vk,!0,2);var m0=$e(Qk,!0);var iO=$e(Uk,!0);var oO=$e(Gk,!0,2);var g0=$e(Zk,!0,2);var sO=$e(Kk,!0,2);var aO="@firebase/database",cO="1.0.11";var pC="";function k9(n){pC=n}var C0=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),zt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ph(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var b0=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return $r(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var jO=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new C0(e)}}catch{}return new b0},Gs=jO("localStorage"),D0=jO("sessionStorage");var jc=new nr("@firebase/database"),O9=function(){let n=1;return function(){return n++}}(),BO=function(n){let e=kD(n),t=new ND;t.update(e);let r=t.digest();return hh.encodeByteArray(r)},Dd=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Dd.apply(null,r):typeof r=="object"?e+=zt(r):e+=r,e+=" "}return e},Ks=null,lO=!0,F9=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(jc.logLevel=en.VERBOSE,Ks=jc.log.bind(jc),e&&D0.set("logging_enabled",!0)):typeof n=="function"?Ks=n:(Ks=null,D0.remove("logging_enabled"))},pn=function(...n){if(lO===!0&&(lO=!1,Ks===null&&D0.get("logging_enabled")===!0&&F9(!0)),Ks){let e=Dd.apply(null,n);Ks(e)}},Sd=function(n){return function(...e){pn(n,...e)}},S0=function(...n){let e="FIREBASE INTERNAL ERROR: "+Dd(...n);jc.error(e)},ji=function(...n){let e=`FIREBASE FATAL ERROR: ${Dd(...n)}`;throw jc.error(e),new Error(e)},er=function(...n){let e="FIREBASE WARNING: "+Dd(...n);jc.warn(e)},L9=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&er("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},$O=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},V9=function(n){if(jr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},$c="[MIN_NAME]",Ys="[MAX_NAME]",Yc=function(n,e){if(n===e)return 0;if(n===$c||e===Ys)return-1;if(e===$c||n===Ys)return 1;{let t=uO(n),r=uO(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},U9=function(n,e){return n===e?0:n<e?-1:1},pd=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+zt(e))},mC=function(n){if(typeof n!="object"||n===null)return zt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=zt(e[r]),t+=":",t+=mC(n[e[r]]);return t+="}",t},HO=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function _r(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var qO=function(n){$(!$O(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,s,a,c;n===0?(o=0,s=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=a+r,s=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,s=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);for(c=e;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(i?1:0),u.reverse();let d=u.join(""),f="";for(c=0;c<64;c+=8){let m=parseInt(d.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},j9=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},B9=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var $9=new RegExp("^-?(0*)\\d{1,10}$"),H9=-2147483648,q9=2147483647,uO=function(n){if($9.test(n)){let e=Number(n);if(e>=H9&&e<=q9)return e}return null},Ad=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw er("Exception was thrown by user callback.",t),e},Math.floor(0))}},W9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},_d=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var A0=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){er(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var R0=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(pn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',er(e)}},wd=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),eg="5",WO="v",zO="s",GO="r",KO="f",YO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,QO="ls",ZO="p",x0="ac",JO="websocket",XO="long_polling";var tg=class{constructor(e,t,r,i,o=!1,s="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Gs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Gs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function z9(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function e1(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let r;if(e===JO)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===XO)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);z9(n)&&(t.ns=n.namespace);let i=[];return _r(t,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}var N0=class{constructor(){this.counters_={}}incrementCounter(e,t=1){$r(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return CD(this.counters_)}};var v0={},y0={};function gC(n){let e=n.toString();return v0[e]||(v0[e]=new N0),v0[e]}function G9(n,e){let t=n.toString();return y0[t]||(y0[t]=e()),y0[t]}var M0=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Ad(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var dO="start",K9="close",Y9="pLPCommand",Q9="pRTLPCB",t1="id",n1="pw",r1="ser",Z9="cb",J9="seg",X9="ts",e8="d",t8="dframe",i1=1870,o1=30,n8=i1-o1,r8=25e3,i8=3e4,P0=class n{constructor(e,t,r,i,o,s,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Sd(e),this.stats_=gC(t),this.urlFn=c=>(this.appCheckToken&&(c[x0]=this.appCheckToken),e1(t,XO,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new M0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(i8)),V9(()=>{if(this.isClosed_)return;this.scriptTagHolder=new k0((...o)=>{let[s,a,c,u,d]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===dO)this.id=a,this.password=c;else if(s===K9)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{let[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[dO]="t",r[r1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Z9]=this.scriptTagHolder.uniqueCallbackIdentifier),r[WO]=eg,this.transportSessionId&&(r[zO]=this.transportSessionId),this.lastSessionId&&(r[QO]=this.lastSessionId),this.applicationId&&(r[ZO]=this.applicationId),this.appCheckToken&&(r[x0]=this.appCheckToken),typeof location<"u"&&location.hostname&&YO.test(location.hostname)&&(r[GO]=KO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return jr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!j9()&&!B9()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=zt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=ID(t),i=HO(r,n8);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(jr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[t8]="t",r[t1]=e,r[n1]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=zt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},k0=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,jr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=O9(),window[Y9+this.uniqueCallbackIdentifier]=e,window[Q9+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){pn("frame writing exception"),a.stack&&pn(a.stack),pn(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||pn("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[t1]=this.myID,e[n1]=this.myPW,e[r1]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+o1+r.length<=i1;){let s=this.pendingSegs.shift();r=r+"&"+J9+i+"="+s.seg+"&"+X9+i+"="+s.ts+"&"+e8+i+"="+s.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(r8)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){jr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{pn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var o8=16384,s8=45e3,ng=null;typeof MozWebSocket<"u"?ng=MozWebSocket:typeof WebSocket<"u"&&(ng=WebSocket);var md=(()=>{class n{constructor(t,r,i,o,s,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Sd(this.connId),this.stats_=gC(r),this.connURL=n.connectionURL_(r,a,c,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,s){let a={};return a[WO]=eg,!jr()&&typeof location<"u"&&location.hostname&&YO.test(location.hostname)&&(a[GO]=KO),r&&(a[zO]=r),i&&(a[QO]=i),o&&(a[x0]=o),s&&(a[ZO]=s),e1(t,JO,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Gs.set("previous_websocket_failure",!0);try{let i;if(jr()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${eg}/${pC}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new ng(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&ng!==null&&!n.forceDisallow_}static previouslyFailed(){return Gs.isInMemoryStorage||Gs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Gs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=ph(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=zt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=HO(r,o8);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(s8))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),a8=(()=>{class n{static get ALL_TRANSPORTS(){return[P0,md]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=md&&md.isAvailable(),i=r&&!md.previouslyFailed();if(t.webSocketOnly&&(r||er("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[md];else{let o=this.transports_=[];for(let s of n.ALL_TRANSPORTS)s&&s.isAvailable()&&o.push(s);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),c8=6e4,l8=5e3,u8=10*1024,d8=100*1024,_0="t",hO="d",h8="s",fO="r",f8="e",pO="o",mO="a",gO="n",vO="p",p8="h",O0=class{constructor(e,t,r,i,o,s,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Sd("c:"+this.id+":"),this.transportManager_=new a8(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=_d(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>d8?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>u8?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(_0 in e){let t=e[_0];t===mO?this.upgradeIfSecondaryHealthy_():t===fO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===pO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=pd("t",e),r=pd("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:vO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=pd("t",e),r=pd("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=pd(_0,e);if(hO in e){let r=e[hO];if(t===p8){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===gO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===h8?this.onConnectionShutdown_(r):t===fO?this.onReset_(r):t===f8?S0("Server Error: "+r):t===pO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S0("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),eg!==r&&er("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),_d(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(c8))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):_d(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(l8))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:vO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Gs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var rg=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ig=class{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var og=class n extends ig{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Pl()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var yO=32,_O=768,et=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ke(){return new et("")}function Ue(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Fo(n){return n.pieces_.length-n.pieceNum_}function ct(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new et(n.pieces_,e)}function s1(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function m8(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function a1(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function c1(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new et(e,0)}function Zt(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof et)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new et(t,0)}function Oe(n){return n.pieceNum_>=n.pieces_.length}function vr(n,e){let t=Ue(n),r=Ue(e);if(t===null)return e;if(t===r)return vr(ct(n),ct(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function l1(n,e){if(Fo(n)!==Fo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Vr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Fo(n)>Fo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var F0=class{constructor(e,t){this.errorPrefix_=t,this.parts_=a1(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ul(this.parts_[r]);u1(this)}};function g8(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ul(e),u1(n)}function v8(n){let e=n.parts_.pop();n.byteLength_-=Ul(e),n.parts_.length>0&&(n.byteLength_-=1)}function u1(n){if(n.byteLength_>_O)throw new Error(n.errorPrefix_+"has a key path longer than "+_O+" bytes ("+n.byteLength_+").");if(n.parts_.length>yO)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+yO+") or object contains a cycle "+zs(n))}function zs(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var L0=class n extends ig{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}};var gd=1e3,y8=60*5*1e3,wO=30*1e3,_8=1.3,w8=3e4,E8="server_kill",EO=3,vC=(()=>{class n extends rg{constructor(t,r,i,o,s,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Sd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=gd,this.maxReconnectDelay_=y8,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!jr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");L0.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&og.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,s={r:o,a:t,b:r};this.log_(zt(s)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new ua,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,i,o){this.initConnection_();let s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let c={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(a).set(s,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let s={p:i},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&$r(t,"w")){let i=Qo(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();er(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||xD(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wO)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=RD(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let s=o.s,a=o.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let s={p:t},a="n";o&&(s.q=i,s.t=o),this.sendRequest(a,s)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let s={p:r,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,s){this.initConnection_();let a={p:r,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:o}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(s.s,s.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+zt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):S0("Unrecognized action received from server: "+zt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>w8&&(this.reconnectDelay_=gd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*_8)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(m){$(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(m)};this.realtime_={close:u,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,v]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?pn("getToken() completed but was canceled"):(pn("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=v&&v.token,c=new O0(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{er(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(E8)},s))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&er(m),u())}}})}interrupt(t){pn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){pn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Fl(this.interruptReasons_)&&(this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(s=>mC(s)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new et(t).toString(),o;if(this.listens.has(i)){let s=this.listens.get(i);o=s.get(r),s.delete(r),s.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){pn("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=EO&&(this.reconnectDelay_=wO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){pn("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=EO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";jr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+pC.replace(/\./g,"-")]=1,Pl()?t["framework.cordova"]=1:fh()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=og.getInstance().currentlyOnline();return Fl(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),je=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Hc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new je($c,e),i=new je($c,t);return this.compare(r,i)!==0}minPost(){return je.MIN}};var Xm,sg=class extends Hc{static get __EMPTY_NODE(){return Xm}static set __EMPTY_NODE(e){Xm=e}compare(e,t){return Yc(e.name,t.name)}isDefinedOn(e){throw la("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return je.MIN}maxPost(){return new je(Ys,Xm)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new je(e,Xm)}toString(){return".key"}},Bc=new sg;var Vc=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?r(e.key,t):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Lr=(()=>{class n{constructor(t,r,i,o,s){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??yr.EMPTY_NODE,this.right=s??yr.EMPTY_NODE}copy(t,r,i,o,s){return new n(t??this.key,r??this.value,i??this.color,o??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,s=i(t,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):s===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return yr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return yr.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),V0=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new Lr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},yr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Lr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Lr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Vc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Vc(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Vc(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Vc(this.root_,null,this.comparator_,!0,e)}};yr.EMPTY_NODE=new V0;function I8(n,e){return Yc(n.name,e.name)}function yC(n,e){return Yc(n,e)}var U0;function T8(n){U0=n}var d1=function(n){return typeof n=="number"?"number:"+qO(n):"string:"+n},h1=function(n){if(n.isLeafNode()){let e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$r(e,".sv"),"Priority must be a string or number.")}else $(n===U0||n.isEmpty(),"priority of unexpected type.");$(n===U0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var IO,qc=(()=>{class n{static set __childrenNodeConstructor(t){IO=t}static get __childrenNodeConstructor(){return IO}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),h1(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Oe(t)?this:Ue(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Ue(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:($(i!==".priority"||Fo(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(ct(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+d1(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=qO(this.value_):t+=this.value_,this.lazyHash_=BO(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),s=n.VALUE_TYPE_ORDER.indexOf(i);return $(o>=0,"Unknown leaf type: "+r),$(s>=0,"Unknown leaf type: "+i),o===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),f1,p1;function C8(n){f1=n}function b8(n){p1=n}var j0=class extends Hc{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Yc(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return je.MIN}maxPost(){return new je(Ys,new qc("[PRIORITY-POST]",p1))}makePost(e,t){let r=f1(e);return new je(t,new qc("[PRIORITY-POST]",r))}toString(){return".priority"}},gn=new j0;var D8=Math.log(2),B0=class{constructor(e){let t=o=>parseInt(Math.log(o)/D8,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ag=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,f,m;if(d===0)return null;if(d===1)return f=n[c],m=t?t(f):f,new Lr(m,f.node,Lr.BLACK,null,null);{let v=parseInt(d/2,10)+c,w=i(c,v),P=i(v+1,u);return f=n[v],m=t?t(f):f,new Lr(m,f.node,Lr.BLACK,w,P)}},o=function(c){let u=null,d=null,f=n.length,m=function(w,P){let N=f-w,V=f;f-=w;let z=i(N+1,V),Y=n[N],re=t?t(Y):Y;v(new Lr(re,Y.node,P,null,z))},v=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<c.count;++w){let P=c.nextBitIsOne(),N=Math.pow(2,c.count-(w+1));P?m(N,Lr.BLACK):(m(N,Lr.BLACK),m(N,Lr.RED))}return d},s=new B0(n.length),a=o(s);return new yr(r||e,a)};var w0,Lc={},Wc=class n{static get Default(){return $(Lc&&gn,"ChildrenNode.ts has not been loaded"),w0=w0||new n({".priority":Lc},{".priority":gn}),w0}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Qo(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof yr?t:null}hasIndex(e){return $r(this.indexSet_,e.toString())}addIndex(e,t){$(e!==Bc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(je.Wrap),s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=ag(r,e.getCompare()):a=Lc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Ll(this.indexes_,(i,o)=>{let s=Qo(this.indexSet_,o);if($(s,"Missing index implementation for "+o),i===Lc)if(s.isDefinedOn(e.node)){let a=[],c=t.getIterator(je.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),ag(a,s.getCompare())}else return Lc;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new je(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ll(this.indexes_,i=>{if(i===Lc)return i;{let o=t.get(e.name);return o?i.remove(new je(e.name,o)):i}});return new n(r,this.indexSet_)}};var vd,yt=(()=>{class n{static get EMPTY_NODE(){return vd||(vd=new n(new yr(yC),null,Wc.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&h1(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||vd}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?vd:r}}getChild(t){let r=Ue(t);return r===null?this:this.getImmediateChild(r).getChild(ct(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if($(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new je(t,r),o,s;r.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(i,this.children_));let a=o.isEmpty()?vd:this.priorityNode_;return new n(o,a,s)}}updateChild(t,r){let i=Ue(t);if(i===null)return r;{$(Ue(t)!==".priority"||Fo(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(ct(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,s=!0;if(this.forEachChild(gn,(a,c)=>{r[a]=c.val(t),i++,s&&n.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):s=!1}),!t&&s&&o<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+d1(this.getPriority().val())+":"),this.forEachChild(gn,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":BO(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let s=o.getPredecessorKey(new je(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new je(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new je(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,je.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)<0;)o.getNext(),s=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,je.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)>0;)o.getNext(),s=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Rd?-1:0}withIndex(t){if(t===Bc||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Bc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(gn),o=r.getIterator(gn),s=i.getNext(),a=o.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=o.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Bc?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),$0=class extends yt{constructor(){super(new yr(yC),yt.EMPTY_NODE,Wc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return yt.EMPTY_NODE}isEmpty(){return!1}},Rd=new $0;Object.defineProperties(je,{MIN:{value:new je($c,yt.EMPTY_NODE)},MAX:{value:new je(Ys,Rd)}});sg.__EMPTY_NODE=yt.EMPTY_NODE;qc.__childrenNodeConstructor=yt;T8(Rd);b8(Rd);var S8=!0;function mn(n,e=null){if(n===null)return yt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new qc(t,mn(e))}if(!(n instanceof Array)&&S8){let t=[],r=!1;if(_r(n,(s,a)=>{if(s.substring(0,1)!=="."){let c=mn(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new je(s,c)))}}),t.length===0)return yt.EMPTY_NODE;let o=ag(t,I8,s=>s.name,yC);if(r){let s=ag(t,gn.getCompare());return new yt(o,mn(e),new Wc({".priority":s},{".priority":gn}))}else return new yt(o,mn(e),Wc.Default)}else{let t=yt.EMPTY_NODE;return _r(n,(r,i)=>{if($r(n,r)&&r.substring(0,1)!=="."){let o=mn(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(mn(e))}}C8(mn);var H0=class extends Hc{constructor(e){super(),this.indexPath_=e,$(!Oe(e)&&Ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Yc(e.name,t.name):o}makePost(e,t){let r=mn(e),i=yt.EMPTY_NODE.updateChild(this.indexPath_,r);return new je(t,i)}maxPost(){let e=yt.EMPTY_NODE.updateChild(this.indexPath_,Rd);return new je(Ys,e)}toString(){return a1(this.indexPath_,0).join("/")}};var q0=class extends Hc{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Yc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return je.MIN}maxPost(){return je.MAX}makePost(e,t){let r=mn(e);return new je(t,r)}toString(){return".value"}},A8=new q0;function R8(n){return{type:"value",snapshotNode:n}}function x8(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function N8(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function TO(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function M8(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var W0=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=gn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:$c}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ys}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===gn}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function CO(n){let e={};if(n.isDefault())return e;let t;if(n.index_===gn?t="$priority":n.index_===A8?t="$value":n.index_===Bc?t="$key":($(n.index_ instanceof H0,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=zt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=zt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+zt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=zt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+zt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function bO(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==gn&&(e.i=n.index_.toString()),e}var z0=class n extends rg{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Sd("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let s=n.getListenId_(e,r),a={};this.listens_[s]=a;let c=CO(e._queryParams);this.restRequest_(o+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(o,f,!1,r),Qo(this.listens_,s)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=CO(e._queryParams),r=e._path.toString(),i=new ua;return this.restRequest_(r+".json",t,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Zo(t);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=ph(a.responseText)}catch{er("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&er("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var G0=class{constructor(){this.rootNode_=yt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function cg(){return{value:null,children:new Map}}function m1(n,e,t){if(Oe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Ue(e);n.children.has(r)||n.children.set(r,cg());let i=n.children.get(r);e=ct(e),m1(i,e,t)}}function K0(n,e,t){n.value!==null?t(e,n.value):P8(n,(r,i)=>{let o=new et(e.toString()+"/"+r);K0(i,o,t)})}function P8(n,e){n.children.forEach((t,r)=>{e(r,t)})}var Y0=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&_r(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var DO=10*1e3,k8=30*1e3,O8=5*60*1e3,Q0=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Y0(e);let r=DO+(k8-DO)*Math.random();_d(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;_r(e,(i,o)=>{o>0&&$r(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),_d(this.reportStats_.bind(this),Math.floor(Math.random()*2*O8))}};var Ui=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ui||{});function g1(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function v1(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function y1(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Z0=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ui.ACK_USER_WRITE,this.source=g1()}operationForChild(e){if(Oe(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new et(e));return new n(Ke(),t,this.revert)}}else return $(Ue(this.path)===e,"operationForChild called for unrelated child."),new n(ct(this.path),this.affectedTree,this.revert)}};var zc=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ui.OVERWRITE}operationForChild(e){return Oe(this.path)?new n(this.source,Ke(),this.snap.getImmediateChild(e)):new n(this.source,ct(this.path),this.snap)}};var lg=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ui.MERGE}operationForChild(e){if(Oe(this.path)){let t=this.children.subtree(new et(e));return t.isEmpty()?null:t.value?new zc(this.source,Ke(),t.value):new n(this.source,Ke(),t)}else return $(Ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,ct(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Td=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Oe(e))return this.isFullyInitialized()&&!this.filtered_;let t=Ue(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function F8(n,e,t,r){let i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&n.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(M8(s.childName,s.snapshotNode))}),yd(n,i,"child_removed",e,r,t),yd(n,i,"child_added",e,r,t),yd(n,i,"child_moved",o,r,t),yd(n,i,"child_changed",e,r,t),yd(n,i,"value",e,r,t),i}function yd(n,e,t,r,i,o){let s=r.filter(a=>a.type===t);s.sort((a,c)=>V8(n,a,c)),s.forEach(a=>{let c=L8(n,a,o);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function L8(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function V8(n,e,t){if(e.childName==null||t.childName==null)throw la("Should only compare child_ events.");let r=new je(e.childName,e.snapshotNode),i=new je(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function _1(n,e){return{eventCache:n,serverCache:e}}function Ed(n,e,t,r){return _1(new Td(e,t,r),n.serverCache)}function w1(n,e,t,r){return _1(n.eventCache,new Td(e,t,r))}function J0(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Qs(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var E0,U8=()=>(E0||(E0=new yr(U9)),E0),$n=class n{static fromObject(e){let t=new n(null);return _r(e,(r,i)=>{t=t.set(new et(r),i)}),t}constructor(e,t=U8()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ke(),value:this.value};if(Oe(e))return null;{let r=Ue(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(ct(e),t);return o!=null?{path:Zt(new et(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Oe(e))return this;{let t=Ue(e),r=this.children.get(t);return r!==null?r.subtree(ct(e)):new n(null)}}set(e,t){if(Oe(e))return new n(t,this.children);{let r=Ue(e),o=(this.children.get(r)||new n(null)).set(ct(e),t),s=this.children.insert(r,o);return new n(this.value,s)}}remove(e){if(Oe(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Ue(e),r=this.children.get(t);if(r){let i=r.remove(ct(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(Oe(e))return this.value;{let t=Ue(e),r=this.children.get(t);return r?r.get(ct(e)):null}}setTree(e,t){if(Oe(e))return t;{let r=Ue(e),o=(this.children.get(r)||new n(null)).setTree(ct(e),t),s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new n(this.value,s)}}fold(e){return this.fold_(Ke(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Zt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ke(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Oe(e))return null;{let o=Ue(e),s=this.children.get(o);return s?s.findOnPath_(ct(e),Zt(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ke(),t)}foreachOnPath_(e,t,r){if(Oe(e))return this;{this.value&&r(t,this.value);let i=Ue(e),o=this.children.get(i);return o?o.foreachOnPath_(ct(e),Zt(t,i),r):new n(null)}}foreach(e){this.foreach_(Ke(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Zt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Ur=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new $n(null))}};function Id(n,e,t){if(Oe(e))return new Ur(new $n(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,s=vr(i,e);return o=o.updateChild(s,t),new Ur(n.writeTree_.set(i,o))}else{let i=new $n(t),o=n.writeTree_.setTree(e,i);return new Ur(o)}}}function SO(n,e,t){let r=n;return _r(t,(i,o)=>{r=Id(r,Zt(e,i),o)}),r}function AO(n,e){if(Oe(e))return Ur.empty();{let t=n.writeTree_.setTree(e,new $n(null));return new Ur(t)}}function X0(n,e){return Zs(n,e)!=null}function Zs(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(vr(t.path,e)):null}function RO(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(gn,(r,i)=>{e.push(new je(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new je(r,i.value))}),e}function Oo(n,e){if(Oe(e))return n;{let t=Zs(n,e);return t!=null?new Ur(new $n(t)):new Ur(n.writeTree_.subtree(e))}}function eC(n){return n.writeTree_.isEmpty()}function Gc(n,e){return E1(Ke(),n.writeTree_,e)}function E1(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?($(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=E1(Zt(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Zt(n,".priority"),r)),t}}function I1(n,e){return S1(e,n)}function j8(n,e,t,r,i){$(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Id(n.visibleWrites,e,t)),n.lastWriteId=r}function B8(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function $8(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,s=n.allWrites.length-1;for(;i&&s>=0;){let a=n.allWrites[s];a.visible&&(s>=t&&H8(a,r.path)?i=!1:Vr(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return q8(n),!0;if(r.snap)n.visibleWrites=AO(n.visibleWrites,r.path);else{let a=r.children;_r(a,c=>{n.visibleWrites=AO(n.visibleWrites,Zt(r.path,c))})}return!0}else return!1}function H8(n,e){if(n.snap)return Vr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Vr(Zt(n.path,t),e))return!0;return!1}function q8(n){n.visibleWrites=T1(n.allWrites,W8,Ke()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function W8(n){return n.visible}function T1(n,e,t){let r=Ur.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let s=o.path,a;if(o.snap)Vr(t,s)?(a=vr(t,s),r=Id(r,a,o.snap)):Vr(s,t)&&(a=vr(s,t),r=Id(r,Ke(),o.snap.getChild(a)));else if(o.children){if(Vr(t,s))a=vr(t,s),r=SO(r,a,o.children);else if(Vr(s,t))if(a=vr(s,t),Oe(a))r=SO(r,Ke(),o.children);else{let c=Qo(o.children,Ue(a));if(c){let u=c.getChild(ct(a));r=Id(r,Ke(),u)}}}else throw la("WriteRecord should have .snap or .children")}}return r}function C1(n,e,t,r,i){if(!r&&!i){let o=Zs(n.visibleWrites,e);if(o!=null)return o;{let s=Oo(n.visibleWrites,e);if(eC(s))return t;if(t==null&&!X0(s,Ke()))return null;{let a=t||yt.EMPTY_NODE;return Gc(s,a)}}}else{let o=Oo(n.visibleWrites,e);if(!i&&eC(o))return t;if(!i&&t==null&&!X0(o,Ke()))return null;{let s=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Vr(u.path,e)||Vr(e,u.path))},a=T1(n.allWrites,s,e),c=t||yt.EMPTY_NODE;return Gc(a,c)}}}function z8(n,e,t){let r=yt.EMPTY_NODE,i=Zs(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(gn,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(t){let o=Oo(n.visibleWrites,e);return t.forEachChild(gn,(s,a)=>{let c=Gc(Oo(o,new et(s)),a);r=r.updateImmediateChild(s,c)}),RO(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let o=Oo(n.visibleWrites,e);return RO(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function G8(n,e,t,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=Zt(e,t);if(X0(n.visibleWrites,o))return null;{let s=Oo(n.visibleWrites,o);return eC(s)?i.getChild(t):Gc(s,i.getChild(t))}}function K8(n,e,t,r){let i=Zt(e,t),o=Zs(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let s=Oo(n.visibleWrites,i);return Gc(s,r.getNode().getImmediateChild(t))}else return null}function Y8(n,e){return Zs(n.visibleWrites,e)}function Q8(n,e,t,r,i,o,s){let a,c=Oo(n.visibleWrites,e),u=Zs(c,Ke());if(u!=null)a=u;else if(t!=null)a=Gc(c,t);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=s.getCompare(),m=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),v=m.getNext();for(;v&&d.length<i;)f(v,r)!==0&&d.push(v),v=m.getNext();return d}else return[]}function Z8(){return{visibleWrites:Ur.empty(),allWrites:[],lastWriteId:-1}}function tC(n,e,t,r){return C1(n.writeTree,n.treePath,e,t,r)}function b1(n,e){return z8(n.writeTree,n.treePath,e)}function xO(n,e,t,r){return G8(n.writeTree,n.treePath,e,t,r)}function ug(n,e){return Y8(n.writeTree,Zt(n.treePath,e))}function J8(n,e,t,r,i,o){return Q8(n.writeTree,n.treePath,e,t,r,i,o)}function _C(n,e,t){return K8(n.writeTree,n.treePath,e,t)}function D1(n,e){return S1(Zt(n.treePath,e),n.writeTree)}function S1(n,e){return{treePath:n,writeTree:e}}var nC=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,TO(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,N8(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,x8(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,TO(r,e.snapshotNode,i.oldSnap));else throw la("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var rC=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},A1=new rC,Cd=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Td(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _C(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Qs(this.viewCache_),o=J8(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function X8(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function eK(n,e,t,r,i){let o=new nC,s,a;if(t.type===Ui.OVERWRITE){let u=t;u.source.fromUser?s=iC(n,e,u.path,u.snap,r,i,o):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Oe(u.path),s=dg(n,e,u.path,u.snap,r,i,a,o))}else if(t.type===Ui.MERGE){let u=t;u.source.fromUser?s=nK(n,e,u.path,u.children,r,i,o):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),s=oC(n,e,u.path,u.children,r,i,a,o))}else if(t.type===Ui.ACK_USER_WRITE){let u=t;u.revert?s=oK(n,e,u.path,r,i,o):s=rK(n,e,u.path,u.affectedTree,r,i,o)}else if(t.type===Ui.LISTEN_COMPLETE)s=iK(n,e,t.path,r,o);else throw la("Unknown operation type: "+t.type);let c=o.getChanges();return tK(e,s,c),{viewCache:s,changes:c}}function tK(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=J0(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(R8(J0(e)))}}function R1(n,e,t,r,i,o){let s=e.eventCache;if(ug(r,t)!=null)return e;{let a,c;if(Oe(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Qs(e),d=u instanceof yt?u:yt.EMPTY_NODE,f=b1(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{let u=tC(r,Qs(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{let u=Ue(t);if(u===".priority"){$(Fo(t)===1,"Can't have a priority with additional path components");let d=s.getNode();c=e.serverCache.getNode();let f=xO(r,t,d,c);f!=null?a=n.filter.updatePriority(d,f):a=s.getNode()}else{let d=ct(t),f;if(s.isCompleteForChild(u)){c=e.serverCache.getNode();let m=xO(r,t,s.getNode(),c);m!=null?f=s.getNode().getImmediateChild(u).updateChild(d,m):f=s.getNode().getImmediateChild(u)}else f=_C(r,u,e.serverCache);f!=null?a=n.filter.updateChild(s.getNode(),u,f,d,i,o):a=s.getNode()}}return Ed(e,a,s.isFullyInitialized()||Oe(t),n.filter.filtersNodes())}}function dg(n,e,t,r,i,o,s,a){let c=e.serverCache,u,d=s?n.filter:n.filter.getIndexedFilter();if(Oe(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let v=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),v,null)}else{let v=Ue(t);if(!c.isCompleteForPath(t)&&Fo(t)>1)return e;let w=ct(t),N=c.getNode().getImmediateChild(v).updateChild(w,r);v===".priority"?u=d.updatePriority(c.getNode(),N):u=d.updateChild(c.getNode(),v,N,w,A1,null)}let f=w1(e,u,c.isFullyInitialized()||Oe(t),d.filtersNodes()),m=new Cd(i,f,o);return R1(n,f,t,i,m,a)}function iC(n,e,t,r,i,o,s){let a=e.eventCache,c,u,d=new Cd(i,e,o);if(Oe(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,s),c=Ed(e,u,!0,n.filter.filtersNodes());else{let f=Ue(t);if(f===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=Ed(e,u,a.isFullyInitialized(),a.isFiltered());else{let m=ct(t),v=a.getNode().getImmediateChild(f),w;if(Oe(m))w=r;else{let P=d.getCompleteChild(f);P!=null?s1(m)===".priority"&&P.getChild(c1(m)).isEmpty()?w=P:w=P.updateChild(m,r):w=yt.EMPTY_NODE}if(v.equals(w))c=e;else{let P=n.filter.updateChild(a.getNode(),f,w,m,d,s);c=Ed(e,P,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function NO(n,e){return n.eventCache.isCompleteForChild(e)}function nK(n,e,t,r,i,o,s){let a=e;return r.foreach((c,u)=>{let d=Zt(t,c);NO(e,Ue(d))&&(a=iC(n,a,d,u,i,o,s))}),r.foreach((c,u)=>{let d=Zt(t,c);NO(e,Ue(d))||(a=iC(n,a,d,u,i,o,s))}),a}function MO(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function oC(n,e,t,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Oe(t)?u=r:u=new $n(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){let v=e.serverCache.getNode().getImmediateChild(f),w=MO(n,v,m);c=dg(n,c,new et(f),w,i,o,s,a)}}),u.children.inorderTraversal((f,m)=>{let v=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!d.hasChild(f)&&!v){let w=e.serverCache.getNode().getImmediateChild(f),P=MO(n,w,m);c=dg(n,c,new et(f),P,i,o,s,a)}}),c}function rK(n,e,t,r,i,o,s){if(ug(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Oe(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return dg(n,e,t,c.getNode().getChild(t),i,o,a,s);if(Oe(t)){let u=new $n(null);return c.getNode().forEachChild(Bc,(d,f)=>{u=u.set(new et(d),f)}),oC(n,e,t,u,i,o,a,s)}else return e}else{let u=new $n(null);return r.foreach((d,f)=>{let m=Zt(t,d);c.isCompleteForPath(m)&&(u=u.set(d,c.getNode().getChild(m)))}),oC(n,e,t,u,i,o,a,s)}}function iK(n,e,t,r,i){let o=e.serverCache,s=w1(e,o.getNode(),o.isFullyInitialized()||Oe(t),o.isFiltered());return R1(n,s,t,r,A1,i)}function oK(n,e,t,r,i,o){let s;if(ug(r,t)!=null)return e;{let a=new Cd(r,e,i),c=e.eventCache.getNode(),u;if(Oe(t)||Ue(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=tC(r,Qs(e));else{let f=e.serverCache.getNode();$(f instanceof yt,"serverChildren would be complete if leaf node"),d=b1(r,f)}d=d,u=n.filter.updateFullNode(c,d,o)}else{let d=Ue(t),f=_C(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=n.filter.updateChild(c,d,f,ct(t),a,o):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,yt.EMPTY_NODE,ct(t),a,o):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=tC(r,Qs(e)),s.isLeafNode()&&(u=n.filter.updateFullNode(u,s,o)))}return s=e.serverCache.isFullyInitialized()||ug(r,Ke())!=null,Ed(e,u,s,n.filter.filtersNodes())}}function sK(n,e){let t=Qs(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Oe(e)&&!t.getImmediateChild(Ue(e)).isEmpty())?t.getChild(e):null}function PO(n,e,t,r){e.type===Ui.MERGE&&e.source.queryId!==null&&($(Qs(n.viewCache_),"We should always have a full cache before handling merges"),$(J0(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=eK(n.processor_,i,e,t,r);return X8(n.processor_,o.viewCache),$(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,aK(n,o.changes,o.viewCache.eventCache.getNode(),null)}function aK(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return F8(n.eventGenerator_,e,t,i)}var kO;function cK(n){$(!kO,"__referenceConstructor has already been defined"),kO=n}function wC(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return $(o!=null,"SyncTree gave us an op for an invalid query."),PO(o,e,t,r)}else{let o=[];for(let s of n.views.values())o=o.concat(PO(s,e,t,r));return o}}function EC(n,e){let t=null;for(let r of n.views.values())t=t||sK(r,e);return t}var OO;function lK(n){$(!OO,"__referenceConstructor has already been defined"),OO=n}var hg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new $n(null),this.pendingWriteTree_=Z8(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function uK(n,e,t,r,i){return j8(n.pendingWriteTree_,e,t,r,i),i?pg(n,new zc(g1(),e,t)):[]}function Uc(n,e,t=!1){let r=B8(n.pendingWriteTree_,e);if($8(n.pendingWriteTree_,e)){let o=new $n(null);return r.snap!=null?o=o.set(Ke(),!0):_r(r.children,s=>{o=o.set(new et(s),!0)}),pg(n,new Z0(r.path,o,t))}else return[]}function fg(n,e,t){return pg(n,new zc(v1(),e,t))}function dK(n,e,t){let r=$n.fromObject(t);return pg(n,new lg(v1(),e,r))}function hK(n,e,t,r){let i=P1(n,r);if(i!=null){let o=k1(i),s=o.path,a=o.queryId,c=vr(s,e),u=new zc(y1(a),c,t);return O1(n,s,u)}else return[]}function fK(n,e,t,r){let i=P1(n,r);if(i){let o=k1(i),s=o.path,a=o.queryId,c=vr(s,e),u=$n.fromObject(t),d=new lg(y1(a),c,u);return O1(n,s,d)}else return[]}function x1(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(s,a)=>{let c=vr(s,e),u=EC(a,c);if(u)return u});return C1(i,e,o,t,!0)}function pg(n,e){return N1(e,n.syncPointTree_,null,I1(n.pendingWriteTree_,Ke()))}function N1(n,e,t,r){if(Oe(n.path))return M1(n,e,t,r);{let i=e.get(Ke());t==null&&i!=null&&(t=EC(i,Ke()));let o=[],s=Ue(n.path),a=n.operationForChild(s),c=e.children.get(s);if(c&&a){let u=t?t.getImmediateChild(s):null,d=D1(r,s);o=o.concat(N1(a,c,u,d))}return i&&(o=o.concat(wC(i,n,r,t))),o}}function M1(n,e,t,r){let i=e.get(Ke());t==null&&i!=null&&(t=EC(i,Ke()));let o=[];return e.children.inorderTraversal((s,a)=>{let c=t?t.getImmediateChild(s):null,u=D1(r,s),d=n.operationForChild(s);d&&(o=o.concat(M1(d,a,c,u)))}),i&&(o=o.concat(wC(i,n,r,t))),o}function P1(n,e){return n.tagToQueryMap.get(e)}function k1(n){let e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new et(n.substr(0,e))}}function O1(n,e,t){let r=n.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");let i=I1(n.pendingWriteTree_,e);return wC(r,t,i,null)}var sC=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},aC=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Zt(this.path_,e);return new n(this.syncTree_,t)}node(){return x1(this.syncTree_,this.path_)}},pK=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},FO=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return mK(n[".sv"],e,t);if(typeof n[".sv"]=="object")return gK(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},mK=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},gK=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);let i=e.node();if($(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return typeof s!="number"?r:s+r},vK=function(n,e,t,r){return IC(e,new aC(t,n),r)},yK=function(n,e,t){return IC(n,new sC(e),t)};function IC(n,e,t){let r=n.getPriority().val(),i=FO(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let s=n,a=FO(s.getValue(),e,t);return a!==s.getValue()||i!==s.getPriority().val()?new qc(a,mn(i)):n}else{let s=n;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new qc(i))),s.forEachChild(gn,(a,c)=>{let u=IC(c,e.getImmediateChild(a),t);u!==c&&(o=o.updateImmediateChild(a,u))}),o}}var bd=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function TC(n,e){let t=e instanceof et?e:new et(e),r=n,i=Ue(t);for(;i!==null;){let o=Qo(r.node.children,i)||{children:{},childCount:0};r=new bd(i,r,o),t=ct(t),i=Ue(t)}return r}function Qc(n){return n.node.value}function F1(n,e){n.node.value=e,cC(n)}function L1(n){return n.node.childCount>0}function _K(n){return Qc(n)===void 0&&!L1(n)}function mg(n,e){_r(n.node.children,(t,r)=>{e(new bd(t,n,r))})}function V1(n,e,t,r){t&&!r&&e(n),mg(n,i=>{V1(i,e,!0,r)}),t&&r&&e(n)}function wK(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function xd(n){return new et(n.parent===null?n.name:xd(n.parent)+"/"+n.name)}function cC(n){n.parent!==null&&EK(n.parent,n.name,n)}function EK(n,e,t){let r=_K(t),i=$r(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,cC(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,cC(n))}var IK=/[\[\].#$\/\u0000-\u001F\u007F]/,TK=/[\[\].#$\u0000-\u001F\u007F]/,I0=10*1024*1024,U1=function(n){return typeof n=="string"&&n.length!==0&&!IK.test(n)},CK=function(n){return typeof n=="string"&&n.length!==0&&!TK.test(n)},bK=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),CK(n)};var j1=function(n,e,t){let r=t instanceof et?new F0(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+zs(r));if(typeof e=="function")throw new Error(n+"contains a function "+zs(r)+" with contents = "+e.toString());if($O(e))throw new Error(n+"contains "+e.toString()+" "+zs(r));if(typeof e=="string"&&e.length>I0/3&&Ul(e)>I0)throw new Error(n+"contains a string greater than "+I0+" utf8 bytes "+zs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(_r(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!U1(s)))throw new Error(n+" contains an invalid key ("+s+") "+zs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);g8(r,s),j1(n,a,r),v8(r)}),i&&o)throw new Error(n+' contains ".value" child '+zs(r)+" in addition to actual children.")}};var DK=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!U1(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!bK(t))throw new Error(PD(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var lC=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function SK(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!l1(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function Js(n,e,t){SK(n,t),AK(n,r=>Vr(r,e)||Vr(e,r))}function AK(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(RK(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function RK(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Ks&&pn("event: "+t.toString()),Ad(r)}}}var xK="repo_interrupt",NK=25,uC=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new lC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=cg(),this.transactionQueueTree_=new bd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function MK(n,e,t){if(n.stats_=gC(n.repoInfo_),n.forceRestClient_||W9())n.server_=new z0(n.repoInfo_,(r,i,o,s)=>{LO(n,r,i,o,s)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>VO(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{zt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new vC(n.repoInfo_,e,(r,i,o,s)=>{LO(n,r,i,o,s)},r=>{VO(n,r)},r=>{kK(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=G9(n.repoInfo_,()=>new Q0(n.stats_,n.server_)),n.infoData_=new G0,n.infoSyncTree_=new hg({startListening:(r,i,o,s)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=fg(n.infoSyncTree_,r._path,c),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),CC(n,"connected",!1),n.serverSyncTree_=new hg({startListening:(r,i,o,s)=>(n.server_.listen(r,o,i,(a,c)=>{let u=s(a,c);Js(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function PK(n){let t=n.infoData_.getNode(new et(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function B1(n){return pK({timestamp:PK(n)})}function LO(n,e,t,r,i){n.dataUpdateCount++;let o=new et(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let s=[];if(i)if(r){let c=Ll(t,u=>mn(u));s=fK(n.serverSyncTree_,o,c,i)}else{let c=mn(t);s=hK(n.serverSyncTree_,o,c,i)}else if(r){let c=Ll(t,u=>mn(u));s=dK(n.serverSyncTree_,o,c)}else{let c=mn(t);s=fg(n.serverSyncTree_,o,c)}let a=o;s.length>0&&(a=DC(n,o)),Js(n.eventQueue_,a,s)}function VO(n,e){CC(n,"connected",e),e===!1&&FK(n)}function kK(n,e){_r(e,(t,r)=>{CC(n,t,r)})}function CC(n,e,t){let r=new et("/.info/"+e),i=mn(t);n.infoData_.updateSnapshot(r,i);let o=fg(n.infoSyncTree_,r,i);Js(n.eventQueue_,r,o)}function OK(n){return n.nextWriteId_++}function FK(n){$1(n,"onDisconnectEvents");let e=B1(n),t=cg();K0(n.onDisconnect_,Ke(),(i,o)=>{let s=vK(i,o,n.serverSyncTree_,e);m1(t,i,s)});let r=[];K0(t,Ke(),(i,o)=>{r=r.concat(fg(n.serverSyncTree_,i,o));let s=jK(n,i);DC(n,s)}),n.onDisconnect_=cg(),Js(n.eventQueue_,Ke(),r)}function LK(n){n.persistentConnection_&&n.persistentConnection_.interrupt(xK)}function $1(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),pn(t,...e)}function H1(n,e,t){return x1(n.serverSyncTree_,e,t)||yt.EMPTY_NODE}function bC(n,e=n.transactionQueueTree_){if(e||gg(n,e),Qc(e)){let t=W1(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&VK(n,xd(e),t)}else L1(e)&&mg(e,t=>{bC(n,t)})}function VK(n,e,t){let r=t.map(u=>u.currentWriteId),i=H1(n,e,r),o=i,s=i.hash();for(let u=0;u<t.length;u++){let d=t[u];$(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=vr(e,d.path);o=o.updateChild(f,d.currentOutputSnapshotRaw)}let a=o.val(!0),c=e;n.server_.put(c.toString(),a,u=>{$1(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let f=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat(Uc(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&f.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();gg(n,TC(n.transactionQueueTree_,e)),bC(n,n.transactionQueueTree_),Js(n.eventQueue_,e,d);for(let m=0;m<f.length;m++)Ad(f[m])}else{if(u==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{er("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=u}DC(n,e)}},s)}function DC(n,e){let t=q1(n,e),r=xd(t),i=W1(n,t);return UK(n,i,r),r}function UK(n,e,t){if(e.length===0)return;let r=[],i=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=vr(t,c.path),d=!1,f;if($(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(Uc(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=NK)d=!0,f="maxretry",i=i.concat(Uc(n.serverSyncTree_,c.currentWriteId,!0));else{let m=H1(n,c.path,s);c.currentInputSnapshot=m;let v=e[a].update(m.val());if(v!==void 0){j1("transaction failed: Data returned ",v,c.path);let w=mn(v);typeof v=="object"&&v!=null&&$r(v,".priority")||(w=w.updatePriority(m.getPriority()));let N=c.currentWriteId,V=B1(n),z=yK(w,m,V);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=z,c.currentWriteId=OK(n),s.splice(s.indexOf(N),1),i=i.concat(uK(n.serverSyncTree_,c.path,z,c.currentWriteId,c.applyLocally)),i=i.concat(Uc(n.serverSyncTree_,N,!0))}else d=!0,f="nodata",i=i.concat(Uc(n.serverSyncTree_,c.currentWriteId,!0))}Js(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}gg(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Ad(r[a]);bC(n,n.transactionQueueTree_)}function q1(n,e){let t,r=n.transactionQueueTree_;for(t=Ue(e);t!==null&&Qc(r)===void 0;)r=TC(r,t),e=ct(e),t=Ue(e);return r}function W1(n,e){let t=[];return z1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function z1(n,e,t){let r=Qc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);mg(e,i=>{z1(n,i,t)})}function gg(n,e){let t=Qc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,F1(e,t.length>0?t:void 0)}mg(e,r=>{gg(n,r)})}function jK(n,e){let t=xd(q1(n,e)),r=TC(n.transactionQueueTree_,e);return wK(r,i=>{T0(n,i)}),T0(n,r),V1(r,i=>{T0(n,i)}),t}function T0(n,e){let t=Qc(e);if(t){let r=[],i=[],o=-1;for(let s=0;s<t.length;s++)t[s].status===3||(t[s].status===1?($(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=3,t[s].abortReason="set"):($(t[s].status===0,"Unexpected transaction status in abort"),t[s].unwatcher(),i=i.concat(Uc(n.serverSyncTree_,t[s].currentWriteId,!0)),t[s].onComplete&&r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?F1(e,void 0):t.length=o+1,Js(n.eventQueue_,xd(e),i);for(let s=0;s<r.length;s++)Ad(r[s])}}function BK(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function $K(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):er(`Invalid query segment '${t}' in query '${n}'`)}return e}var UO=function(n,e){let t=HK(n),r=t.namespace;t.domain==="firebase.com"&&ji(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ji("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||L9();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new tg(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new et(t.pathString)}},HK=function(n){let e="",t="",r="",i="",o="",s=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=BK(n.substring(d,f)));let m=$K(n.substring(Math.min(n.length,f)));u=e.indexOf(":"),u>=0?(s=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let v=e.slice(0,u);if(v.toLowerCase()==="localhost")t="localhost";else if(v.split(".").length<=2)t=v;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),o=r}"ns"in m&&(o=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};var dC=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Oe(this._path)?null:s1(this._path)}get ref(){return new Kc(this._repo,this._path)}get _queryIdentifier(){let e=bO(this._queryParams),t=mC(e);return t==="{}"?"default":t}get _queryObject(){return bO(this._queryParams)}isEqual(e){if(e=Fe(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=l1(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+m8(this._path)}};var Kc=class n extends dC{constructor(e,t){super(e,t,new W0,!1)}get parent(){let e=c1(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};cK(Kc);lK(Kc);var qK="FIREBASE_DATABASE_EMULATOR_HOST",hC={},WK=!1;function zK(n,e,t,r){n.repoInfo_=new tg(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function GK(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||ji("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),pn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let s=UO(o,i),a=s.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[qK]),u?(c=!0,o=`http://${u}?ns=${a.namespace}`,s=UO(o,i),a=s.repoInfo):c=!s.repoInfo.secure;let d=i&&c?new wd(wd.OWNER):new R0(n.name,n.options,e);DK("Invalid Firebase Database URL",s),Oe(s.path)||ji("Database URL must point to the root of a Firebase Database (not including a child path).");let f=YK(a,n,d,new A0(n.name,t));return new fC(f,n)}function KK(n,e){let t=hC[e];(!t||t[n.key]!==n)&&ji(`Database ${e}(${n.repoInfo_}) has already been deleted.`),LK(n),delete t[n.key]}function YK(n,e,t,r){let i=hC[e.name];i||(i={},hC[e.name]=i);let o=i[n.toURLString()];return o&&ji("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new uC(n,WK,t,r),i[n.toURLString()]=o,o}var fC=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(MK(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Kc(this._repo,Ke())),this._rootInternal}_delete(){return this._rootInternal!==null&&(KK(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ji("Cannot call "+e+" on a deleted database.")}};function G1(n=Ht(),e){let t=$t(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=eo("database");r&&K1(t,...r)}return t}function K1(n,e,t,r={}){n=Fe(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ji("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ji('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new wd(wd.OWNER);else if(r.mockUserToken){let s=typeof r.mockUserToken=="string"?r.mockUserToken:da(r.mockUserToken,n.app.options.projectId);o=new wd(s)}zK(i,e,t,o)}function QK(n){k9(xn),It(new Et("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return GK(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),te(aO,cO,n),te(aO,cO,"esm2017")}vC.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};vC.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};QK();var Nd=class{constructor(e){return e}},Y1="database",SC=class{constructor(){return Ft(Y1)}};var AC=new H("angularfire2.database-instances");function ZK(n,e){let t=Wt(Y1,n,e);return t&&new Nd(t)}function JK(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Nd(r)}}var XK={provide:SC,deps:[[new Ee,AC]]},e7={provide:Nd,useFactory:ZK,deps:[[new Ee,AC],gt]};function Q1(n,...e){return te("angularfire",dt.full,"rtdb"),ut([e7,XK,{provide:AC,useFactory:JK(n),multi:!0,deps:[pe,De,bt,xt,[new Ee,Pr],[new Ee,fr],...e]}])}var Z1=$e(G1,!0);var eF="functions";var RC=class{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||t.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return y(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return y(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return y(this,null,function*(){if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return y(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var xC="us-central1";var NC=class{constructor(e,t,r,i,o=xC,s=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new RC(t,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(o);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=xC}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function t7(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var J1="@firebase/functions",X1="0.12.1";var n7="auth-internal",r7="app-check-internal",i7="messaging-internal";function o7(n){let e=(t,{instanceIdentifier:r})=>{let i=t.getProvider("app").getImmediate(),o=t.getProvider(n7),s=t.getProvider(i7),a=t.getProvider(r7);return new NC(i,o,s,a,r)};It(new Et(eF,e,"PUBLIC").setMultipleInstances(!0)),te(J1,X1,n),te(J1,X1,"esm2017")}function tF(n=Ht(),e=xC){let r=$t(Fe(n),eF).getImmediate({identifier:e}),i=eo("functions");return i&&nF(r,...i),r}function nF(n,e,t){t7(Fe(n),e,t)}o7();var Md=class{constructor(e){return e}},rF="functions",MC=class{constructor(){return Ft(rF)}};var PC=new H("angularfire2.functions-instances");function s7(n,e){let t=Wt(rF,n,e);return t&&new Md(t)}function a7(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Md(r)}}var c7={provide:MC,deps:[[new Ee,PC]]},l7={provide:Md,useFactory:s7,deps:[[new Ee,PC],gt]};function iF(n,...e){return te("angularfire",dt.full,"fn"),ut([l7,c7,{provide:PC,useFactory:a7(n),multi:!0,deps:[pe,De,bt,xt,[new Ee,Pr],[new Ee,fr],...e]}])}var oF=$e(tF,!0);var u7="/firebase-messaging-sw.js",d7="/firebase-cloud-messaging-push-scope",hF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",h7="https://fcmregistrations.googleapis.com/v1",fF="google.c.a.c_id",f7="google.c.a.c_l",p7="google.c.a.ts",m7="google.c.a.e",sF=1e4;var vg=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}(vg||{});function Bi(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function g7(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}var kC="fcm_token_details_db",v7=5,aF="fcm_token_object_Store";function y7(n){return y(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(kC))return null;let e=null;return(yield Vv(kC,v7,{upgrade:(r,i,o,s)=>y(this,null,function*(){var a;if(i<2||!r.objectStoreNames.contains(aF))return;let c=s.objectStore(aF),u=yield c.index("fcmSenderId").get(n);if(yield c.clear(),!!u){if(i===2){let d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Bi(d.vapidKey)}}}else if(i===3){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bi(d.auth),p256dh:Bi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bi(d.vapidKey)}}}else if(i===4){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bi(d.auth),p256dh:Bi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bi(d.vapidKey)}}}}})})).close(),yield mh(kC),yield mh("fcm_vapid_details_db"),yield mh("undefined"),_7(e)?e:null})}function _7(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var w7="firebase-messaging-database",E7=1,Pd="firebase-messaging-store",OC=null;function pF(){return OC||(OC=Vv(w7,E7,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Pd)}}})),OC}function I7(n){return y(this,null,function*(){let e=mF(n),r=yield(yield pF()).transaction(Pd).objectStore(Pd).get(e);if(r)return r;{let i=yield y7(n.appConfig.senderId);if(i)return yield VC(n,i),i}})}function VC(n,e){return y(this,null,function*(){let t=mF(n),i=(yield pF()).transaction(Pd,"readwrite");return yield i.objectStore(Pd).put(e,t),yield i.done,e})}function mF({appConfig:n}){return n.appId}var T7={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Sn=new tr("messaging","Messaging",T7);function C7(n,e){return y(this,null,function*(){let t=yield jC(n),r=gF(e),i={method:"POST",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(UC(n.appConfig),i)).json()}catch(s){throw Sn.create("token-subscribe-failed",{errorInfo:s?.toString()})}if(o.error){let s=o.error.message;throw Sn.create("token-subscribe-failed",{errorInfo:s})}if(!o.token)throw Sn.create("token-subscribe-no-token");return o.token})}function b7(n,e){return y(this,null,function*(){let t=yield jC(n),r=gF(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(`${UC(n.appConfig)}/${e.token}`,i)).json()}catch(s){throw Sn.create("token-update-failed",{errorInfo:s?.toString()})}if(o.error){let s=o.error.message;throw Sn.create("token-update-failed",{errorInfo:s})}if(!o.token)throw Sn.create("token-update-no-token");return o.token})}function D7(n,e){return y(this,null,function*(){let r={method:"DELETE",headers:yield jC(n)};try{let o=yield(yield fetch(`${UC(n.appConfig)}/${e}`,r)).json();if(o.error){let s=o.error.message;throw Sn.create("token-unsubscribe-failed",{errorInfo:s})}}catch(i){throw Sn.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function UC({projectId:n}){return`${h7}/projects/${n}/registrations`}function jC(t){return y(this,arguments,function*({appConfig:n,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function gF({p256dh:n,auth:e,endpoint:t,vapidKey:r}){let i={web:{endpoint:t,auth:e,p256dh:n}};return r!==hF&&(i.web.applicationPubKey=r),i}var S7=7*24*60*60*1e3;function A7(n){return y(this,null,function*(){let e=yield x7(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Bi(e.getKey("auth")),p256dh:Bi(e.getKey("p256dh"))},r=yield I7(n.firebaseDependencies);if(r){if(N7(r.subscriptionOptions,t))return Date.now()>=r.createTime+S7?R7(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield D7(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return cF(n.firebaseDependencies,t)}else return cF(n.firebaseDependencies,t)})}function R7(n,e){return y(this,null,function*(){try{let t=yield b7(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield VC(n.firebaseDependencies,r),t}catch(t){throw t}})}function cF(n,e){return y(this,null,function*(){let r={token:yield C7(n,e),createTime:Date.now(),subscriptionOptions:e};return yield VC(n,r),r.token})}function x7(n,e){return y(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:g7(e)})})}function N7(n,e){let t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&r&&i&&o}function lF(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return M7(e,n),P7(e,n),k7(e,n),e}function M7(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let r=e.notification.body;r&&(n.notification.body=r);let i=e.notification.image;i&&(n.notification.image=i);let o=e.notification.icon;o&&(n.notification.icon=o)}function P7(n,e){e.data&&(n.data=e.data)}function k7(n,e){var t,r,i,o,s;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;a&&(n.fcmOptions.link=a);let c=(s=e.fcmOptions)===null||s===void 0?void 0:s.analytics_label;c&&(n.fcmOptions.analyticsLabel=c)}function O7(n){return typeof n=="object"&&!!n&&fF in n}F7("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function F7(n,e){let t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function L7(n){if(!n||!n.options)throw FC("App Configuration Object");if(!n.name)throw FC("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let r of e)if(!t[r])throw FC(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function FC(n){return Sn.create("missing-app-config-values",{valueName:n})}var LC=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=L7(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};function V7(n){return y(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(u7,{scope:d7}),n.swRegistration.update().catch(()=>{}),yield U7(n.swRegistration)}catch(e){throw Sn.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function U7(n){return y(this,null,function*(){return new Promise((e,t)=>{let r=setTimeout(()=>t(new Error(`Service worker not registered after ${sF} ms`)),sF),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=o=>{var s;((s=o.target)===null||s===void 0?void 0:s.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})})}function j7(n,e){return y(this,null,function*(){if(!e&&!n.swRegistration&&(yield V7(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Sn.create("invalid-sw-registration");n.swRegistration=e}})}function B7(n,e){return y(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=hF)})}function $7(n,e){return y(this,null,function*(){if(!navigator)throw Sn.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw Sn.create("permission-blocked");return yield B7(n,e?.vapidKey),yield j7(n,e?.serviceWorkerRegistration),A7(n)})}function H7(n,e,t){return y(this,null,function*(){let r=q7(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[fF],message_name:t[f7],message_time:t[p7],message_device_time:Math.floor(Date.now()/1e3)})})}function q7(n){switch(n){case vg.NOTIFICATION_CLICKED:return"notification_open";case vg.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function W7(n,e){return y(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===vg.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(lF(t)):n.onMessageHandler.next(lF(t)));let r=t.data;O7(r)&&r[m7]==="1"&&(yield H7(n,t.messageType,r))})}var uF="@firebase/messaging",dF="0.12.16";var z7=n=>{let e=new LC(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>W7(e,t)),e},G7=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:r=>$7(e,r)}};function K7(){It(new Et("messaging",z7,"PUBLIC")),It(new Et("messaging-internal",G7,"PRIVATE")),te(uF,dF),te(uF,dF,"esm2017")}function vF(){return y(this,null,function*(){try{yield ha()}catch{return!1}return typeof window<"u"&&Br()&&Ol()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function yF(n=Ht()){return vF().then(e=>{if(!e)throw Sn.create("unsupported-browser")},e=>{throw Sn.create("indexed-db-unsupported")}),$t(Fe(n),"messaging").getImmediate()}K7();var kd=class{constructor(e){return e}},_F="messaging",BC=class{constructor(){return Ft(_F)}};var $C=new H("angularfire2.messaging-instances");function Y7(n,e,t){if(Di(t))return null;let r=Wt(_F,n,e);return r&&new kd(r)}function Q7(n){return(e,t,r)=>{if(Di(r))return null;let i=e.runOutsideAngular(()=>n(t));return new kd(i)}}var Z7={provide:BC,deps:[[new Ee,$C]]},J7={provide:kd,useFactory:Y7,deps:[[new Ee,$C],gt,kt]};function wF(n,...e){return te("angularfire",dt.full,"fcm"),ut([J7,Z7,{provide:$C,useFactory:Q7(n),multi:!0,deps:[pe,De,kt,bt,xt,...e]}])}var EF=$e(yF,!0);var Od=class{constructor(e){return e}},IF="performance",HC=class{constructor(){return Ft(IF)}};var qC=new H("angularfire2.performance-instances");function X7(n,e,t){if(!Ja(t))return null;let r=Wt(IF,n,e);return r&&new Od(r)}function eY(n){return(e,t,r)=>{if(!Ja(t))return null;let i=e.runOutsideAngular(()=>n(r));return new Od(i)}}var tY={provide:HC,deps:[[new Ee,qC]]},nY={provide:Od,useFactory:X7,deps:[[new Ee,qC],gt,kt]};function TF(n,...e){return te("angularfire",dt.full,"perf"),ut([nY,tY,{provide:qC,useFactory:eY(n),multi:!0,deps:[pe,kt,De,bt,xt,...e]}])}var CF=$e(FD,!0);var xF="firebasestorage.googleapis.com",rY="storageBucket",iY=2*60*1e3,oY=10*60*1e3;var ii=class n extends Wn{constructor(e,t,r=0){super(WC(e),`Firebase Storage: ${t} (${WC(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return WC(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Hi=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Hi||{});function WC(n){return"storage/"+n}function sY(){let n="An unknown error occurred, please check the error payload for server response.";return new ii(Hi.UNKNOWN,n)}function aY(){return new ii(Hi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cY(){return new ii(Hi.CANCELED,"User canceled the upload/download.")}function lY(n){return new ii(Hi.INVALID_URL,"Invalid URL '"+n+"'.")}function uY(n){return new ii(Hi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function bF(n){return new ii(Hi.INVALID_ARGUMENT,n)}function NF(){return new ii(Hi.APP_DELETED,"The Firebase app was deleted.")}function dY(n){return new ii(Hi.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var $i=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw uY(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function o(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}let s="(/(.*))?$",a=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function u(re){re.path_=decodeURIComponent(re.path)}let d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${d}/b/${i}/o${m}`,"i"),w={bucket:1,path:3},P=t===xF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",V=new RegExp(`^https?://${P}/${i}/${N}`,"i"),Y=[{regex:a,indices:c,postModify:o},{regex:v,indices:w,postModify:u},{regex:V,indices:{bucket:1,path:2},postModify:u}];for(let re=0;re<Y.length;re++){let it=Y[re],le=it.regex.exec(e);if(le){let D=le[it.indices.bucket],_=le[it.indices.path];_||(_=""),r=new n(D,_),it.postModify(r);break}}if(r==null)throw lY(e);return r}},zC=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function hY(n,e,t){let r=1,i=null,o=null,s=!1,a=0;function c(){return a===2}let u=!1;function d(...N){u||(u=!0,e.apply(null,N))}function f(N){i=setTimeout(()=>{i=null,n(v,c())},N)}function m(){o&&clearTimeout(o)}function v(N,...V){if(u){m();return}if(N){m(),d.call(null,N,...V);return}if(c()||s){m(),d.call(null,N,...V);return}r<64&&(r*=2);let Y;a===1?(a=2,Y=0):Y=(r+Math.random())*1e3,f(Y)}let w=!1;function P(N){w||(w=!0,m(),!u&&(i!==null?(N||(a=2),clearTimeout(i),f(0)):N||(a=1)))}return f(0),o=setTimeout(()=>{s=!0,P(!0)},t),P}function fY(n){n(!1)}function pY(n){return n!==void 0}function DF(n,e,t,r){if(r<e)throw bF(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw bF(`Invalid value for '${n}'. Expected ${t} or less.`)}function mY(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var GC=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(GC||{});function gY(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}var KC=class{constructor(e,t,r,i,o,s,a,c,u,d,f,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,w)=>{this.resolve_=v,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Zc(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let s=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;let a=o.getErrorCode()===GC.NO_ERROR,c=o.getStatus();if(!a||gY(c,this.additionalRetryCodes_)&&this.retry){let d=o.getErrorCode()===GC.ABORT;r(!1,new Zc(!1,null,d));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new Zc(u,o))})},t=(r,i)=>{let o=this.resolve_,s=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());pY(c)?o(c):o()}catch(c){s(c)}else if(a!==null){let c=sY();c.serverResponse=a.getErrorText(),this.errorCallback_?s(this.errorCallback_(a,c)):s(c)}else if(i.canceled){let c=this.appDelete_?NF():cY();s(c)}else{let c=aY();s(c)}};this.canceled_?t(!1,new Zc(!1,null,!0)):this.backoffId_=hY(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&fY(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Zc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function vY(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function yY(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _Y(n,e){e&&(n["X-Firebase-GMPID"]=e)}function wY(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function EY(n,e,t,r,i,o,s=!0){let a=mY(n.urlParams),c=n.url+a,u=Object.assign({},n.headers);return _Y(u,e),vY(u,t),yY(u,o),wY(u,r),new KC(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,s)}function IY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function TY(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var Afe=256*1024;var YC=class n{constructor(e,t){this._service=e,t instanceof $i?this._location=t:this._location=$i.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new $i(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TY(this._location.path)}get storage(){return this._service}get parent(){let e=IY(this._location.path);if(e===null)return null;let t=new $i(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw dY(e)}};function SF(n,e){let t=e?.[rY];return t==null?null:$i.makeFromBucketSpec(t,n)}function CY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:da(i,n.app.options.projectId))}var QC=class{constructor(e,t,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=xF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=iY,this._maxUploadRetryTime=oY,this._requests=new Set,i!=null?this._bucket=$i.makeFromBucketSpec(i,this._host):this._bucket=SF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=$i.makeFromBucketSpec(this._url,e):this._bucket=SF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){DF("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){DF("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new YC(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new zC(NF());{let s=EY(e,this._appId,r,i,t,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},AF="@firebase/storage",RF="0.13.5";var MF="storage";function PF(n=Ht(),e){n=Fe(n);let r=$t(n,MF).getImmediate({identifier:e}),i=eo("storage");return i&&kF(r,...i),r}function kF(n,e,t,r={}){CY(n,e,t,r)}function bY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new QC(t,r,i,e,xn)}function DY(){It(new Et(MF,bY,"PUBLIC").setMultipleInstances(!0)),te(AF,RF,""),te(AF,RF,"esm2017")}DY();var Fd=class{constructor(e){return e}},OF="storage",ZC=class{constructor(){return Ft(OF)}};var JC=new H("angularfire2.storage-instances");function SY(n,e){let t=Wt(OF,n,e);return t&&new Fd(t)}function AY(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Fd(r)}}var RY={provide:ZC,deps:[[new Ee,JC]]},xY={provide:Fd,useFactory:SY,deps:[[new Ee,JC],gt]};function FF(n,...e){return te("angularfire",dt.full,"gcs"),ut([xY,RY,{provide:JC,useFactory:AY(n),multi:!0,deps:[pe,De,bt,xt,[new Ee,Pr],[new Ee,fr],...e]}])}var LF=$e(PF,!0);var XC="@firebase/remote-config",VF="0.5.0";var jF="remote-config",UF=100;var NY={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser","custom-signal-max-allowed-signals":"Setting more than {$maxSignals} custom signals is not supported."},An=new tr("remoteconfig","Remote Config",NY);function BF(n=Ht()){return n=Fe(n),$t(n,jF).getImmediate()}function $F(n){let e=Fe(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var eb=class{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})}};function MY(n=navigator){return n.languages&&n.languages[0]||n.language}var tb=class{constructor(e,t,r,i,o,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=o,this.appId=s}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:MY(),custom_signals:e.customSignals},c={method:"POST",headers:s,body:JSON.stringify(a)},u=fetch(o,c),d=new Promise((N,V)=>{e.signal.addEventListener(()=>{let z=new Error("The operation was aborted.");z.name="AbortError",V(z)})}),f;try{yield Promise.race([u,d]),f=yield u}catch(N){let V="fetch-client-network";throw N?.name==="AbortError"&&(V="fetch-timeout"),An.create(V,{originalErrorMessage:N?.message})}let m=f.status,v=f.headers.get("ETag")||void 0,w,P;if(f.status===200){let N;try{N=yield f.json()}catch(V){throw An.create("fetch-client-parse",{originalErrorMessage:V?.message})}w=N.entries,P=N.state}if(P==="INSTANCE_STATE_UNSPECIFIED"?m=500:P==="NO_CHANGE"?m=304:(P==="NO_TEMPLATE"||P==="EMPTY_CONFIG")&&(w={}),m!==304&&m!==200)throw An.create("fetch-status",{httpStatus:m});return{status:m,eTag:v,config:w}})}};function PY(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(An.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function kY(n){if(!(n instanceof Wn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var nb=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return y(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(i,o){return y(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:r}){yield PY(e.signal,t);try{let s=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),s}catch(s){if(!kY(s))throw s;let a={throttleEndTimeMillis:Date.now()+fa(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(a),this.attemptFetch(e,a)}})}};var OY=60*1e3,FY=12*60*60*1e3,rb=class{get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}constructor(e,t,r,i,o){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:OY,minimumFetchIntervalMillis:FY},this.defaultConfig={}}};function yg(n,e){let t=n.target.error||void 0;return An.create(e,{originalErrorMessage:t&&t?.message})}var Lo="app_namespace_store",LY="firebase_remote_config",VY=1;function UY(){return new Promise((n,e)=>{try{let t=indexedDB.open(LY,VY);t.onerror=r=>{e(yg(r,"storage-open"))},t.onsuccess=r=>{n(r.target.result)},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Lo,{keyPath:"compositeKey"})}}}catch(t){e(An.create("storage-open",{originalErrorMessage:t?.message}))}})}var ib=class{constructor(e,t,r,i=UY()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}getCustomSignals(){return this.get("custom_signals")}setCustomSignals(e){return y(this,null,function*(){let r=(yield this.openDbPromise).transaction([Lo],"readwrite"),i=yield this.getWithTransaction("custom_signals",r),o=Object.assign(Object.assign({},i),e),s=Object.fromEntries(Object.entries(o).filter(([a,c])=>c!==null).map(([a,c])=>typeof c=="number"?[a,c.toString()]:[a,c]));if(Object.keys(s).length>UF)throw An.create("custom-signal-max-allowed-signals",{maxSignals:UF});return yield this.setWithTransaction("custom_signals",s,r),s})}getWithTransaction(e,t){return y(this,null,function*(){return new Promise((r,i)=>{let o=t.objectStore(Lo),s=this.createCompositeKey(e);try{let a=o.get(s);a.onerror=c=>{i(yg(c,"storage-get"))},a.onsuccess=c=>{let u=c.target.result;r(u?u.value:void 0)}}catch(a){i(An.create("storage-get",{originalErrorMessage:a?.message}))}})})}setWithTransaction(e,t,r){return y(this,null,function*(){return new Promise((i,o)=>{let s=r.objectStore(Lo),a=this.createCompositeKey(e);try{let c=s.put({compositeKey:a,value:t});c.onerror=u=>{o(yg(u,"storage-set"))},c.onsuccess=()=>{i()}}catch(c){o(An.create("storage-set",{originalErrorMessage:c?.message}))}})})}get(e){return y(this,null,function*(){let r=(yield this.openDbPromise).transaction([Lo],"readonly");return this.getWithTransaction(e,r)})}set(e,t){return y(this,null,function*(){let i=(yield this.openDbPromise).transaction([Lo],"readwrite");return this.setWithTransaction(e,t,i)})}delete(e){return y(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let s=t.transaction([Lo],"readwrite").objectStore(Lo),a=this.createCompositeKey(e);try{let c=s.delete(a);c.onerror=u=>{i(yg(u,"storage-delete"))},c.onsuccess=()=>{r()}}catch(c){i(An.create("storage-delete",{originalErrorMessage:c?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};var ob=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}getCustomSignals(){return this.customSignals}loadFromStorage(){return y(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=this.storage.getCustomSignals(),o=yield e;o&&(this.lastFetchStatus=o);let s=yield t;s&&(this.lastSuccessfulFetchTimestampMillis=s);let a=yield r;a&&(this.activeConfig=a);let c=yield i;c&&(this.customSignals=c)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}setCustomSignals(e){return y(this,null,function*(){this.customSignals=yield this.storage.setCustomSignals(e)})}};function jY(){It(new Et(jF,n,"PUBLIC").setMultipleInstances(!0)),te(XC,VF),te(XC,VF,"esm2017");function n(e,{instanceIdentifier:t}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw An.create("registration-window");if(!Br())throw An.create("indexed-db-unavailable");let{projectId:o,apiKey:s,appId:a}=r.options;if(!o)throw An.create("registration-project-id");if(!s)throw An.create("registration-api-key");if(!a)throw An.create("registration-app-id");t=t||"firebase";let c=new ib(a,r.name,t),u=new ob(c),d=new nr(XC);d.logLevel=en.ERROR;let f=new tb(i,xn,t,o,s,a),m=new nb(f,c),v=new eb(m,c,u,d),w=new rb(r,v,u,c,d);return $F(w),w}}jY();var Ld=class{constructor(e){return e}},HF="remote-config",sb=class{constructor(){return Ft(HF)}};var ab=new H("angularfire2.remote-config-instances");function BY(n,e,t){if(Di(t))return null;let r=Wt(HF,n,e);return r&&new Ld(r)}function $Y(n){return(e,t,r)=>{if(Di(r))return null;let i=e.runOutsideAngular(()=>n(t));return new Ld(i)}}var HY={provide:sb,deps:[[new Ee,ab]]},qY={provide:Ld,useFactory:BY,deps:[[new Ee,ab],gt,kt]};function qF(n,...e){return te("angularfire",dt.full,"rc"),ut([qY,HY,{provide:ab,useFactory:$Y(n),multi:!0,deps:[pe,De,kt,bt,xt,...e]}])}var WF=$e(BF,!0);var zF={firebaseConfig:{apiKey:"AIzaSyCaMopW6HWBwUEvvtDZUQ7UemvGdT7xGEA",authDomain:"dash-boar-7ee0d.firebaseapp.com",projectId:"dash-boar-7ee0d",storageBucket:"dash-boar-7ee0d.firebasestorage.app",messagingSenderId:"325394396819",appId:"1:325394396819:web:82c3741552a46bb149bf66",measurementId:"G-LXRMSZ5ZSH"},production:!0};var GF={providers:[fx({eventCoalescing:!0}),bN(DN),RN(()=>xN(zF.firebaseConfig)),PM(()=>OM()),tP(()=>JM()),eP,eI,rO(()=>iO()),Q1(()=>Z1()),iF(()=>oF()),wF(()=>EF()),TF(()=>CF()),FF(()=>LF()),qF(()=>WF())]};var Hn=class n{destroyRef=S(_i);firestore=S(Ws);destroyed=new st;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed.next(),this.destroyed.complete()})}generateNextId(){return y(this,null,function*(){let e=yield m0(this.collectionRef),t=0;return e.forEach(r=>{let i=r.data(),o=parseInt(i.id,10);!isNaN(o)&&o>t&&(t=o)}),(t+1).toString()})}createData(e,t){let r=p0(this.collectionRef,e);return g0(r,t)}updateData(e,t){return g0(p0(this.collectionRef,e),t,{merge:!0})}getDataById(e){return y(this,null,function*(){let t=oO(this.collectionRef,sO("id","==",e)),r=yield m0(t);if(!r.empty)return r.docs[0].data()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ye=class n extends Hn{collectionPath="/race-configs";collectionRef=gr(this.firestore,this.collectionPath);activeRaceConfig=J(void 0);constructor(){super(),this.getAll().pipe(Xe()).subscribe(e=>{e.length>0&&this.activeRaceConfig.set(e.at(0))})}updateFuelDurationMinute(e){let t=this.activeRaceConfig();return t?(t.fuelDurationMinute=e,this.updateData(t.id,t)):Promise.resolve()}updateStartRaceDriverId(e){let t=this.activeRaceConfig();return t?(t.startRaceDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitDriverId(e){let t=this.activeRaceConfig();return t?(t.nextPitDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitRefueling(e){let t=this.activeRaceConfig();return t?(t.nextPitRefueling=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitTyreChange(e){let t=this.activeRaceConfig();return t?(t.nextPitTyreChange=e,this.updateData(t.id,t)):Promise.resolve()}updateReferenceLapTime(e){let t=this.activeRaceConfig();return t?(t.referenceLapTimeMillisecond=e,this.updateData(t.id,t)):Promise.resolve()}getAll(){return mr(this.collectionRef).pipe(Gt(this.destroyed),X(e=>e.map(t=>t).filter(t=>!t.deleted)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var WY=Math.pow(10,8)*24*60*60*1e3,lme=-WY,_g=6048e5,KF=864e5,Jc=6e4,Xc=36e5,YF=1e3;var zY=3600;var QF=zY*24,ume=QF*7,GY=QF*365.2425,KY=GY/12,dme=KY*3,cb=Symbol.for("constructDateFrom");function _t(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&cb in n?n[cb](e):n instanceof Date?new n.constructor(e):new Date(e)}function ie(n,e){return _t(e||n,n)}function ZF(n,e,t){let r=ie(n,t?.in);return isNaN(e)?_t(t?.in||n,NaN):(e&&r.setDate(r.getDate()+e),r)}function JF(n,e,t){let r=ie(n,t?.in);if(isNaN(e))return _t(t?.in||n,NaN);if(!e)return r;let i=r.getDate(),o=_t(t?.in||n,r.getTime());o.setMonth(r.getMonth()+e+1,0);let s=o.getDate();return i>=s?o:(r.setFullYear(o.getFullYear(),o.getMonth(),i),r)}function el(n,e,t){let{years:r=0,months:i=0,weeks:o=0,days:s=0,hours:a=0,minutes:c=0,seconds:u=0}=e,d=ie(n,t?.in),f=i||r?JF(d,i+r*12):d,m=s||o?ZF(f,s+o*7):f,v=c+a*60,P=(u+v*60)*1e3;return _t(t?.in||n,+m+P)}function Vo(n,e,t){return _t(t?.in||n,+ie(n)+e)}function Uo(n,e,t){return Vo(n,e*Xc,t)}var YY={};function jo(){return YY}function qi(n,e){let t=jo(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=ie(n,e?.in),o=i.getDay(),s=(o<r?7:0)+o-r;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function Xs(n,e){return qi(n,he(U({},e),{weekStartsOn:1}))}function wg(n,e){let t=ie(n,e?.in),r=t.getFullYear(),i=_t(t,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);let o=Xs(i),s=_t(t,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);let a=Xs(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function lb(n){let e=ie(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function vn(n,...e){let t=_t.bind(null,n||e.find(r=>typeof r=="object"));return e.map(t)}function ub(n,e){let t=ie(n,e?.in);return t.setHours(0,0,0,0),t}function Eg(n,e,t){let[r,i]=vn(t?.in,n,e),o=ub(r),s=ub(i),a=+o-lb(o),c=+s-lb(s);return Math.round((a-c)/KF)}function XF(n,e){let t=wg(n,e),r=_t(e?.in||n,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Xs(r)}function ea(n,e,t){let r=ie(n,t?.in);return r.setTime(r.getTime()+e*Jc),r}function ta(n,e,t){return Vo(n,e*1e3,t)}function na(n,e){let t=+ie(n)-+ie(e);return t<0?-1:t>0?1:t}function eL(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function tL(n){return!(!eL(n)&&typeof n!="number"||isNaN(+ie(n)))}function nL(n,e,t){let[r,i]=vn(t?.in,n,e),o=r.getFullYear()-i.getFullYear(),s=r.getMonth()-i.getMonth();return o*12+s}function rL(n,e,t){let[r,i]=vn(t?.in,n,e);return r.getFullYear()-i.getFullYear()}function oL(n,e,t){let[r,i]=vn(t?.in,n,e),o=iL(r,i),s=Math.abs(Eg(r,i));r.setDate(r.getDate()-o*s);let a=+(iL(r,i)===-o),c=o*(s-a);return c===0?0:c}function iL(n,e){let t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function tl(n){return e=>{let r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function sL(n,e,t){let[r,i]=vn(t?.in,n,e),o=(+r-+i)/Xc;return tl(t?.roundingMethod)(o)}function Wi(n,e){return+ie(n)-+ie(e)}function Ig(n,e,t){let r=Wi(n,e)/Jc;return tl(t?.roundingMethod)(r)}function aL(n,e){let t=ie(n,e?.in);return t.setHours(23,59,59,999),t}function cL(n,e){let t=ie(n,e?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function lL(n,e){let t=ie(n,e?.in);return+aL(t,e)==+cL(t,e)}function uL(n,e,t){let[r,i,o]=vn(t?.in,n,n,e),s=na(i,o),a=Math.abs(nL(i,o));if(a<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-s*a);let c=na(i,o)===-s;lL(r)&&a===1&&na(r,o)===1&&(c=!1);let u=s*(a-+c);return u===0?0:u}function dL(n,e,t){let r=Wi(n,e)/1e3;return tl(t?.roundingMethod)(r)}function hL(n,e,t){let[r,i]=vn(t?.in,n,e),o=na(r,i),s=Math.abs(rL(r,i));r.setFullYear(1584),i.setFullYear(1584);let a=na(r,i)===-o,c=o*(s-+a);return c===0?0:c}function fL(n,e){let[t,r]=vn(n,e.start,e.end);return{start:t,end:r}}function pL(n,e){let t=ie(n,e?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}var QY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},mL=(n,e,t)=>{let r,i=QY[n];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Tg(n){return(e={})=>{let t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}var ZY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},JY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},XY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gL={date:Tg({formats:ZY,defaultWidth:"full"}),time:Tg({formats:JY,defaultWidth:"full"}),dateTime:Tg({formats:XY,defaultWidth:"full"})};var eQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vL=(n,e,t,r)=>eQ[n];function nl(n){return(e,t)=>{let r=t?.context?String(t.context):"standalone",i;if(r==="formatting"&&n.formattingValues){let s=n.defaultFormattingWidth||n.defaultWidth,a=t?.width?String(t.width):s;i=n.formattingValues[a]||n.formattingValues[s]}else{let s=n.defaultWidth,a=t?.width?String(t.width):n.defaultWidth;i=n.values[a]||n.values[s]}let o=n.argumentCallback?n.argumentCallback(e):e;return i[o]}}var tQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},nQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},iQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},oQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},aQ=(n,e)=>{let t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},yL={ordinalNumber:aQ,era:nl({values:tQ,defaultWidth:"wide"}),quarter:nl({values:nQ,defaultWidth:"wide",argumentCallback:n=>n-1}),month:nl({values:rQ,defaultWidth:"wide"}),day:nl({values:iQ,defaultWidth:"wide"}),dayPeriod:nl({values:oQ,defaultWidth:"wide",formattingValues:sQ,defaultFormattingWidth:"wide"})};function rl(n){return(e,t={})=>{let r=t.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],o=e.match(i);if(!o)return null;let s=o[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?lQ(a,f=>f.test(s)):cQ(a,f=>f.test(s)),u;u=n.valueCallback?n.valueCallback(c):c,u=t.valueCallback?t.valueCallback(u):u;let d=e.slice(s.length);return{value:u,rest:d}}}function cQ(n,e){for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function lQ(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function _L(n){return(e,t={})=>{let r=e.match(n.matchPattern);if(!r)return null;let i=r[0],o=e.match(n.parsePattern);if(!o)return null;let s=n.valueCallback?n.valueCallback(o[0]):o[0];s=t.valueCallback?t.valueCallback(s):s;let a=e.slice(i.length);return{value:s,rest:a}}}var uQ=/^(\d+)(th|st|nd|rd)?/i,dQ=/\d+/i,hQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},fQ={any:[/^b/i,/^(a|c)/i]},pQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},mQ={any:[/1/i,/2/i,/3/i,/4/i]},gQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},yQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_Q={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},wQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},EQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},wL={ordinalNumber:_L({matchPattern:uQ,parsePattern:dQ,valueCallback:n=>parseInt(n,10)}),era:rl({matchPatterns:hQ,defaultMatchWidth:"wide",parsePatterns:fQ,defaultParseWidth:"any"}),quarter:rl({matchPatterns:pQ,defaultMatchWidth:"wide",parsePatterns:mQ,defaultParseWidth:"any",valueCallback:n=>n+1}),month:rl({matchPatterns:gQ,defaultMatchWidth:"wide",parsePatterns:vQ,defaultParseWidth:"any"}),day:rl({matchPatterns:yQ,defaultMatchWidth:"wide",parsePatterns:_Q,defaultParseWidth:"any"}),dayPeriod:rl({matchPatterns:wQ,defaultMatchWidth:"any",parsePatterns:EQ,defaultParseWidth:"any"})};var db={code:"en-US",formatDistance:mL,formatLong:gL,formatRelative:vL,localize:yL,match:wL,options:{weekStartsOn:0,firstWeekContainsDate:1}};function EL(n,e){let t=ie(n,e?.in);return Eg(t,pL(t))+1}function IL(n,e){let t=ie(n,e?.in),r=+Xs(t)-+XF(t);return Math.round(r/_g)+1}function Cg(n,e){let t=ie(n,e?.in),r=t.getFullYear(),i=jo(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=_t(e?.in||n,0);s.setFullYear(r+1,0,o),s.setHours(0,0,0,0);let a=qi(s,e),c=_t(e?.in||n,0);c.setFullYear(r,0,o),c.setHours(0,0,0,0);let u=qi(c,e);return+t>=+a?r+1:+t>=+u?r:r-1}function TL(n,e){let t=jo(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=Cg(n,e),o=_t(e?.in||n,0);return o.setFullYear(i,0,r),o.setHours(0,0,0,0),qi(o,e)}function CL(n,e){let t=ie(n,e?.in),r=+qi(t,e)-+TL(t,e);return Math.round(r/_g)+1}function We(n,e){let t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}var zi={y(n,e){let t=n.getFullYear(),r=t>0?t:1-t;return We(e==="yy"?r%100:r,e.length)},M(n,e){let t=n.getMonth();return e==="M"?String(t+1):We(t+1,2)},d(n,e){return We(n.getDate(),e.length)},a(n,e){let t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return We(n.getHours()%12||12,e.length)},H(n,e){return We(n.getHours(),e.length)},m(n,e){return We(n.getMinutes(),e.length)},s(n,e){return We(n.getSeconds(),e.length)},S(n,e){let t=e.length,r=n.getMilliseconds(),i=Math.trunc(r*Math.pow(10,t-3));return We(i,e.length)}};var il={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},hb={G:function(n,e,t){let r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){let r=n.getFullYear(),i=r>0?r:1-r;return t.ordinalNumber(i,{unit:"year"})}return zi.y(n,e)},Y:function(n,e,t,r){let i=Cg(n,r),o=i>0?i:1-i;if(e==="YY"){let s=o%100;return We(s,2)}return e==="Yo"?t.ordinalNumber(o,{unit:"year"}):We(o,e.length)},R:function(n,e){let t=wg(n);return We(t,e.length)},u:function(n,e){let t=n.getFullYear();return We(t,e.length)},Q:function(n,e,t){let r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return We(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){let r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return We(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){let r=n.getMonth();switch(e){case"M":case"MM":return zi.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){let r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return We(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){let i=CL(n,r);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):We(i,e.length)},I:function(n,e,t){let r=IL(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):We(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):zi.d(n,e)},D:function(n,e,t){let r=EL(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):We(r,e.length)},E:function(n,e,t){let r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){let i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return We(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){let i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return We(o,e.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){let r=n.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return We(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){let i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){let r=n.getHours(),i;switch(r===12?i=il.noon:r===0?i=il.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){let r=n.getHours(),i;switch(r>=17?i=il.evening:r>=12?i=il.afternoon:r>=4?i=il.morning:i=il.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return zi.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):zi.H(n,e)},K:function(n,e,t){let r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):We(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):We(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):zi.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):zi.s(n,e)},S:function(n,e){return zi.S(n,e)},X:function(n,e,t){let r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return DL(r);case"XXXX":case"XX":return ra(r);case"XXXXX":case"XXX":default:return ra(r,":")}},x:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"x":return DL(r);case"xxxx":case"xx":return ra(r);case"xxxxx":case"xxx":default:return ra(r,":")}},O:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+bL(r,":");case"OOOO":default:return"GMT"+ra(r,":")}},z:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+bL(r,":");case"zzzz":default:return"GMT"+ra(r,":")}},t:function(n,e,t){let r=Math.trunc(+n/1e3);return We(r,e.length)},T:function(n,e,t){return We(+n,e.length)}};function bL(n,e=""){let t=n>0?"-":"+",r=Math.abs(n),i=Math.trunc(r/60),o=r%60;return o===0?t+String(i):t+String(i)+e+We(o,2)}function DL(n,e){return n%60===0?(n>0?"-":"+")+We(Math.abs(n)/60,2):ra(n,e)}function ra(n,e=""){let t=n>0?"-":"+",r=Math.abs(n),i=We(Math.trunc(r/60),2),o=We(r%60,2);return t+i+e+o}var SL=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},AL=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},IQ=(n,e)=>{let t=n.match(/(P+)(p+)?/)||[],r=t[1],i=t[2];if(!i)return SL(n,e);let o;switch(r){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",SL(r,e)).replace("{{time}}",AL(i,e))},RL={p:AL,P:IQ};var TQ=/^D+$/,CQ=/^Y+$/,bQ=["D","DD","YY","YYYY"];function xL(n){return TQ.test(n)}function NL(n){return CQ.test(n)}function ML(n,e,t){let r=DQ(n,e,t);if(console.warn(r),bQ.includes(n))throw new RangeError(r)}function DQ(n,e,t){let r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var SQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,AQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,RQ=/^'([^]*?)'?$/,xQ=/''/g,NQ=/[a-zA-Z]/;function bg(n,e,t){let r=jo(),i=t?.locale??r.locale??db,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ie(n,t?.in);if(!tL(a))throw new RangeError("Invalid time value");let c=e.match(AQ).map(d=>{let f=d[0];if(f==="p"||f==="P"){let m=RL[f];return m(d,i.formatLong)}return d}).join("").match(SQ).map(d=>{if(d==="''")return{isToken:!1,value:"'"};let f=d[0];if(f==="'")return{isToken:!1,value:MQ(d)};if(hb[f])return{isToken:!0,value:d};if(f.match(NQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:d}});i.localize.preprocessor&&(c=i.localize.preprocessor(a,c));let u={firstWeekContainsDate:o,weekStartsOn:s,locale:i};return c.map(d=>{if(!d.isToken)return d.value;let f=d.value;(!t?.useAdditionalWeekYearTokens&&NL(f)||!t?.useAdditionalDayOfYearTokens&&xL(f))&&ML(f,e,String(n));let m=hb[f[0]];return m(a,f,i.localize,u)}).join("")}function MQ(n){let e=n.match(RQ);return e?e[1].replace(xQ,"'"):n}function fb(n){return Math.trunc(n*Xc)}function pb(n,e){let{start:t,end:r}=fL(e?.in,n),i={},o=hL(r,t);o&&(i.years=o);let s=el(t,{years:i.years}),a=uL(r,s);a&&(i.months=a);let c=el(s,{months:i.months}),u=oL(r,c);u&&(i.days=u);let d=el(c,{days:i.days}),f=sL(r,d);f&&(i.hours=f);let m=el(d,{hours:i.hours}),v=Ig(r,m);v&&(i.minutes=v);let w=el(m,{minutes:i.minutes}),P=dL(r,w);return P&&(i.seconds=P),i}function PL(n,e){return+ie(n)>+ie(e)}function kL(n,e){return+ie(n)<+ie(e)}function Dg(n){return Math.trunc(n*Jc)}function Sg(n){return n*YF}function OL(n,e,t){return ea(n,-e,t)}var jt=class n extends Hn{collectionPath="/races";collectionRef=gr(this.firestore,this.collectionPath);raceConfigService=S(Ye);activeRace=J(void 0);endRaceDate=J(void 0);constructor(){super(),He({races:this.getAll(),raceConfig:me(this.raceConfigService.activeRaceConfig)}).pipe(Xe(),X(({races:e,raceConfig:t})=>{if(e&&t){let r=this.getActiveRace(e,t),i=r?Uo(r.start.toDate(),t.durationHour):void 0;return{activeRace:r,endRaceDate:i}}return{activeRace:void 0,endRaceDate:void 0}})).subscribe(e=>{this.activeRace.set(e.activeRace),this.endRaceDate.set(e.endRaceDate)})}create(e){return y(this,null,function*(){return this.activeRace()!==void 0?(console.warn("Race already active -> "+this.activeRace()),Promise.resolve()):(e.id=yield this.generateNextId(),yield this.createData(e.id,e),e)})}getAll(){return mr(this.collectionRef).pipe(Gt(this.destroyed),X(e=>e.map(t=>t).filter(t=>!t.deleted)))}getActiveRace(e,t){let r=new Date,i=e.sort((o,s)=>s.start.toDate().getTime()-o.start.toDate().getTime());for(let o of i)if(Uo(o.start.toDate(),t.durationHour)>=r)return o}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function Bo(n,e){if(!n||!e)return"--:--:--";let t=pb({end:e,start:n});return Ag(t)}function ia(n){if(!n)return"--:--:--";let e=pb({end:n,start:new Date});return Ag(e)}function Mt(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={hours:Math.floor(e/3600),minutes:Math.floor(e%3600/60),seconds:e%60};return Ag(t)}function FL(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={minutes:Math.floor(e%3600/60),seconds:e%60};return Ag(t)}function LL(n){if(!n||n<0)return"--:--:---";let e=Math.floor(n/1e3),t=n%1e3,r={minutes:Math.floor(e/60),seconds:e%60};return PQ(r,t)}function PQ(n,e){return n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:---":[Vd(n.minutes),Vd(n.seconds),kQ(e)].join(":")}function Ag(n){return n.hours&&n.hours<0||n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:--":[Vd(n.hours),Vd(n.minutes),Vd(n.seconds)].join(":")}function Vd(n){return n?n<10?`0${n}`:`${n}`:"00"}function kQ(n){return n<10?`00${n}`:n<100?`0${n}`:`${n}`}var Jt=class n extends Hn{collectionPath="/pits";collectionRef=gr(this.firestore,this.collectionPath);raceService=S(jt);raceConfigService=S(Ye);activePit=J(void 0);activePitRemainingMilliseconds=J(0);lastRefuelPit=J(void 0);pits=J([]);completedDriverChanges=J(0);lastDriverChangePit=J(void 0);remainingDriverChanges=J(0);constructor(){super(),He({pits:this.getRacePits(),activeRaceConfig:me(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({pits:e,activeRaceConfig:t})=>{this.pits.set(e),this.activePit.set(this.getActivePit(e)),this.activePitRemainingMilliseconds.set(this.calculateActivePitRemainingMilliseconds(e,t)),this.lastRefuelPit.set(this.getLastRefuelPit(e)),this.lastDriverChangePit.set(this.getLastDriverChangePit(e)),this.completedDriverChanges.set(this.calculateCompletedDriverChanges(e)),this.remainingDriverChanges.set(this.calculateRemainingDriverChanges(e,t))})}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return this.updateData(e.id,e)}getRacePits(){return He({pits:mr(this.collectionRef),activeRace:me(this.raceService.activeRace)}).pipe(Gt(this.destroyed),X(({pits:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()):[]))}getActivePit(e){for(let t of e)if(!t.exitTime)return t}calculateActivePitRemainingMilliseconds(e,t){if(!t)return 0;let r=this.getActivePit(e);if(r){let i=new Date().getTime();return ta(r.entryTime.toDate(),t.minPitSeconds).getTime()-i}return 0}getLastRefuelPit(e){return e.filter(r=>r.refuel&&r.exitTime).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()).at(0)}getLastDriverChangePit(e){if(e.length===0)return;let t=e.sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime());for(let r of t)if(r.entryDriverId!==r.exitDriverId)return r}calculateCompletedDriverChanges(e){return e.reduce((t,r)=>t+(r.entryDriverId!==r.exitDriverId?1:0),0)}calculateRemainingDriverChanges(e,t){return t?Math.max(0,t.minDriverChange-this.calculateCompletedDriverChanges(e)):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var oi=class n{raceService=S(jt);pitService=S(Jt);raceConfigService=S(Ye);optimizedStint=J(void 0);constructor(){He({activeRace:me(this.raceService.activeRace),endRaceDate:me(this.raceService.endRaceDate),activeRaceConfig:me(this.raceConfigService.activeRaceConfig),remainingDriverChanges:me(this.pitService.remainingDriverChanges),lastDriverChangePit:me(this.pitService.lastDriverChangePit),ping:At(1e3)}).pipe(Xe()).subscribe(({activeRace:e,endRaceDate:t,activeRaceConfig:r,remainingDriverChanges:i,lastDriverChangePit:o})=>{r?this.optimizedStint.set(this.calculateOptimizedStint(e?e.start.toDate():new Date,t||Uo(new Date,r.durationHour),r,i,o)):this.optimizedStint.set(void 0)})}calculateOptimizedStint(e,t,r,i,o){let s=new Date;if(s>=t)return;let a=Sg(r.minPitSeconds*i),c=Wi(t,s)-a,u;o&&(o.exitTime?u=o.exitTime.toDate():u=ta(o.entryTime.toDate(),r.minPitSeconds));let m=(Wi(t,u||e)-a)/(i+1),v=c/i;return{avgStintMillisecondsTime:m,laps:Math.floor(m/r.referenceLapTimeMillisecond),avgStintMillisecondsIfDriverChangedNow:v,lapsIfDriverChangeNow:Math.floor(v/r.referenceLapTimeMillisecond)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Bt=class n extends Hn{collectionPath="/stints";collectionRef=gr(this.firestore,this.collectionPath);raceService=S(jt);raceConfigService=S(Ye);stintOptimizerService=S(oi);activeRace=this.raceService.activeRace;stints=J([]);activeStint=J(void 0);activeStintTimeOnTrack=J(0);activeStintLaps=J(0);activeStintRemainingTimeOnTrack=J(0);activeStintRemainingLaps=J(0);activeStintGainedTimeOnTrack=J(0);activeStintGainedLaps=J(0);constructor(){super(),He({stints:this.getRaceStints(),activeRaceConfig:me(this.raceConfigService.activeRaceConfig),optimizedStint:me(this.stintOptimizerService.optimizedStint),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e,activeRaceConfig:t,optimizedStint:r})=>{this.stints.set(e),this.activeStint.set(this.getActiveStint(e)),this.activeStintTimeOnTrack.set(this.calculateActiveStintTimeOnTrack(this.activeStint())),this.activeStintLaps.set(this.calculateActiveStintLaps(this.activeStintTimeOnTrack(),t)),this.activeStintRemainingTimeOnTrack.set(this.calculateActiveStintRemainingTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintRemainingLaps.set(this.calculateActiveStintRemainingLaps(this.activeStintLaps(),r)),this.activeStintGainedTimeOnTrack.set(this.calculateActiveStintGainedTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintGainedLaps.set(this.calculateActiveStintGainedLaps(this.activeStintLaps(),r))})}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return y(this,null,function*(){return yield this.updateData(e.id,e),e})}getRaceStints(){return He({stints:mr(this.collectionRef),activeRace:me(this.activeRace)}).pipe(Gt(this.destroyed),X(({stints:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.startDate.toDate().getTime()-r.startDate.toDate().getTime()):[]))}getActiveStint(e){for(let t of e)if(!t.endDate)return t}calculateActiveStintTimeOnTrack(e){return e?new Date().getTime()-e.startDate.toDate().getTime():0}calculateActiveStintLaps(e,t){return e>=0&&t?Math.floor(e/t.referenceLapTimeMillisecond):0}calculateActiveStintRemainingTimeOnTrack(e,t){return e>=0&&t?t.avgStintMillisecondsTime-e:0}calculateActiveStintRemainingLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r>0?r:0}calculateActiveStintGainedTimeOnTrack(e,t){let r=0;return e>=0&&t&&(r=t.avgStintMillisecondsTime-e),r<0?Math.abs(r):0}calculateActiveStintGainedLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r<0?Math.abs(r):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var ol=class n{raceService=S(jt);stintService=S(Bt);pitService=S(Jt);stintOptimizerService=S(oi);activeRace=this.raceService.activeRace;activeStint=this.stintService.activeStint;activePit=this.pitService.activePit;optimizedStintMilliseconds=Ae(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.avgStintMillisecondsTime:0});startRace(e){return y(this,null,function*(){let t=this.createRace(),r=yield this.raceService.create(t);r&&(yield this.startStint(r.id,e,r.start))})}pitIn(e,t,r){return y(this,null,function*(){let i=this.activeRace(),o=this.activeStint();if(i&&o){let s=this.createPit(o.driverId,e,i.id,t,r),a=yield this.pitService.create(s);yield this.closeActiveStint(a.entryTime)}})}pitOut(){return y(this,null,function*(){let e=this.activeRace(),t=this.activePit();if(e&&t){let r=Nt.now();yield this.closeActivePit(r),yield this.startStint(e.id,t.exitDriverId,r)}})}startStint(e,t,r){return y(this,null,function*(){let i=this.createStint(e,t,r);return yield this.stintService.create(i),i})}closeActiveStint(e){return y(this,null,function*(){let t=this.activeStint();t&&(t.endDate=e,yield this.stintService.update(t))})}closeActivePit(e){return y(this,null,function*(){let t=this.activePit();t&&(t.exitTime=e,yield this.pitService.update(t))})}createRace(){return{id:"1",start:Nt.now(),deleted:!1}}createStint(e,t,r){return{id:"1",deleted:!1,driverId:t,endDate:null,optimumMilliseconds:this.optimizedStintMilliseconds(),raceId:e,startDate:r}}createPit(e,t,r,i,o){return{id:"1",entryDriverId:e,entryTime:Nt.now(),exitDriverId:t,exitTime:null,raceId:r,refuel:i,tyreChange:o,deleted:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var GL=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Ne(wi),Ne(cr))};static \u0275dir=at({type:n})}return n})(),Wd=(()=>{class n extends GL{static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,features:[Vn]})}return n})(),ul=new H(""),OQ={provide:ul,useExisting:sr(()=>vb),multi:!0},vb=(()=>{class n extends Wd{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Yr([OQ]),Vn]})}return n})(),FQ={provide:ul,useExisting:sr(()=>dl),multi:!0};function LQ(){let n=bi()?bi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var VQ=new H(""),dl=(()=>{class n extends GL{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!LQ())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Ne(wi),Ne(cr),Ne(VQ,8))};static \u0275dir=at({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&ce("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[Yr([FQ]),Vn]})}return n})();function mb(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var Fg=new H(""),KL=new H("");function UQ(n){return e=>{if(mb(e.value)||mb(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function jQ(n){return mb(n.value)?{required:!0}:null}function VL(n){return null}function YL(n){return n!=null}function QL(n){return ys(n)?lt(n):n}function ZL(n){let e={};return n.forEach(t=>{e=t!=null?U(U({},e),t):e}),Object.keys(e).length===0?null:e}function JL(n,e){return e.map(t=>t(n))}function BQ(n){return!n.validate}function XL(n){return n.map(e=>BQ(e)?e:t=>e.validate(t))}function $Q(n){if(!n)return null;let e=n.filter(YL);return e.length==0?null:function(t){return ZL(JL(t,e))}}function yb(n){return n!=null?$Q(XL(n)):null}function HQ(n){if(!n)return null;let e=n.filter(YL);return e.length==0?null:function(t){let r=JL(t,e).map(QL);return oy(r).pipe(X(ZL))}}function _b(n){return n!=null?HQ(XL(n)):null}function UL(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function qQ(n){return n._rawValidators}function WQ(n){return n._rawAsyncValidators}function gb(n){return n?Array.isArray(n)?n:[n]:[]}function xg(n,e){return Array.isArray(n)?n.includes(e):n===e}function jL(n,e){let t=gb(e);return gb(n).forEach(i=>{xg(t,i)||t.push(i)}),t}function BL(n,e){return gb(e).filter(t=>!xg(n,t))}var Ng=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=yb(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=_b(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},cl=class extends Ng{name;get formDirective(){return null}get path(){return null}},qd=class extends Ng{_parent=null;name=null;valueAccessor=null},Mg=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},zQ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},awe=he(U({},zQ),{"[class.ng-submitted]":"isSubmitted"}),$o=(()=>{class n extends Mg{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Ne(qd,2))};static \u0275dir=at({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Zf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Vn]})}return n})(),Ho=(()=>{class n extends Mg{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Ne(cl,10))};static \u0275dir=at({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Zf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Vn]})}return n})();var Ud="VALID",Rg="INVALID",sl="PENDING",jd="DISABLED",ll=class{},Pg=class extends ll{value;source;constructor(e,t){super(),this.value=e,this.source=t}},$d=class extends ll{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Hd=class extends ll{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},al=class extends ll{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function eV(n){return(Lg(n)?n.validators:n)||null}function GQ(n){return Array.isArray(n)?yb(n):n||null}function tV(n,e){return(Lg(e)?e.asyncValidators:n)||null}function KQ(n){return Array.isArray(n)?_b(n):n||null}function Lg(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function YQ(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Z(1e3,"");if(!r[t])throw new Z(1001,"")}function QQ(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Z(1002,"")})}var kg=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return ur(this.statusReactive)}set status(e){ur(()=>this.statusReactive.set(e))}_status=Ae(()=>this.statusReactive());statusReactive=J(void 0);get valid(){return this.status===Ud}get invalid(){return this.status===Rg}get pending(){return this.status==sl}get disabled(){return this.status===jd}get enabled(){return this.status!==jd}errors;get pristine(){return ur(this.pristineReactive)}set pristine(e){ur(()=>this.pristineReactive.set(e))}_pristine=Ae(()=>this.pristineReactive());pristineReactive=J(!0);get dirty(){return!this.pristine}get touched(){return ur(this.touchedReactive)}set touched(e){ur(()=>this.touchedReactive.set(e))}_touched=Ae(()=>this.touchedReactive());touchedReactive=J(!1);get untouched(){return!this.touched}_events=new st;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(jL(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(jL(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(BL(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(BL(e,this._rawAsyncValidators))}hasValidator(e){return xg(this._rawValidators,e)}hasAsyncValidator(e){return xg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(he(U({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Hd(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Hd(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(he(U({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new $d(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new $d(!0,r))}markAsPending(e={}){this.status=sl;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new al(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(he(U({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=jd,this.errors=null,this._forEachChild(i=>{i.disable(he(U({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pg(this.value,r)),this._events.next(new al(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(he(U({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ud,this._forEachChild(r=>{r.enable(he(U({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(he(U({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ud||this.status===sl)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pg(this.value,t)),this._events.next(new al(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(he(U({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?jd:Ud}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=sl,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=QL(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new al(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Kt,this.statusChanges=new Kt}_calculateStatus(){return this._allControlsDisabled()?jd:this.errors?Rg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(sl)?sl:this._anyControlsHaveStatus(Rg)?Rg:Ud}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new $d(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Hd(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Lg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=GQ(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=KQ(this._rawAsyncValidators)}},Og=class extends kg{constructor(e,t,r){super(eV(t),tV(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){QQ(this,!0,e),Object.keys(e).forEach(r=>{YQ(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Vg=new H("",{providedIn:"root",factory:()=>Ug}),Ug="always";function ZQ(n,e){return[...e.path,n]}function nV(n,e,t=Ug){rV(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),XQ(n,e),tZ(n,e),eZ(n,e),JQ(n,e)}function $L(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function JQ(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function rV(n,e){let t=qQ(n);e.validator!==null?n.setValidators(UL(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=WQ(n);e.asyncValidator!==null?n.setAsyncValidators(UL(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();$L(e._rawValidators,i),$L(e._rawAsyncValidators,i)}function XQ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&iV(n,e)})}function eZ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&iV(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function iV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function tZ(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function nZ(n,e){n==null,rV(n,e)}function rZ(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function iZ(n){return Object.getPrototypeOf(n.constructor)===Wd}function oZ(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function sZ(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===dl?t=o:iZ(o)?r=o:i=o}),i||r||t||null}var aZ={provide:cl,useExisting:sr(()=>Gi)},Bd=Promise.resolve(),Gi=(()=>{class n extends cl{callSetDisabledState;get submitted(){return ur(this.submittedReactive)}_submitted=Ae(()=>this.submittedReactive());submittedReactive=J(!1);_directives=new Set;form;ngSubmit=new Kt;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new Og({},yb(t),_b(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Bd.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),nV(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Bd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Bd.then(()=>{let r=this._findContainer(t.path),i=new Og({});nZ(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Bd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Bd.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),oZ(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(Ne(Fg,10),Ne(KL,10),Ne(Vg,8))};static \u0275dir=at({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&ce("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Yr([aZ]),Vn]})}return n})();function HL(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function qL(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var cZ=class extends kg{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(eV(t),tV(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Lg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(qL(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){HL(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){HL(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){qL(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var lZ={provide:qd,useExisting:sr(()=>Ki)},WL=Promise.resolve(),Ki=(()=>{class n extends qd{_changeDetectorRef;callSetDisabledState;control=new cZ;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Kt;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=sZ(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),rZ(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){nV(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){WL.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&mu(r);WL.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?ZQ(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Ne(cl,9),Ne(Fg,10),Ne(KL,10),Ne(ul,10),Ne(Co,8),Ne(Vg,8))};static \u0275dir=at({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Yr([lZ]),Vn,yo]})}return n})(),qo=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),uZ={provide:ul,useExisting:sr(()=>zd),multi:!0},zd=(()=>{class n extends Wd{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&ce("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Yr([uZ]),Vn]})}return n})();var dZ=new H("");var hZ={provide:ul,useExisting:sr(()=>hl),multi:!0};function oV(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function fZ(n){return n.split(":")[0]}var hl=(()=>{class n extends Wd{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=oV(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=fZ(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yr([hZ]),Vn]})}return n})(),jg=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(oV(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Ne(cr),Ne(wi),Ne(hl,9))};static \u0275dir=at({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),pZ={provide:ul,useExisting:sr(()=>sV),multi:!0};function zL(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function mZ(n){return n.split(":")[0]}var sV=(()=>{class n extends Wd{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],u=this._getOptionValue(c.value);i.push(u)}}else{let s=r.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let u=this._getOptionValue(c.value);i.push(u)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=mZ(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yr([pZ]),Vn]})}return n})(),Bg=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(zL(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(zL(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Ne(cr),Ne(wi),Ne(sV,9))};static \u0275dir=at({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function gZ(n){return typeof n=="number"?n:parseFloat(n)}var aV=(()=>{class n{_validator=VL;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):VL,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,features:[yo]})}return n})();var vZ={provide:Fg,useExisting:sr(()=>Gd),multi:!0},Gd=(()=>{class n extends aV{min;inputName="min";normalizeInput=t=>gZ(t);createValidator=t=>UQ(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&pu("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[Yr([vZ]),Vn]})}return n})(),yZ={provide:Fg,useExisting:sr(()=>Kd),multi:!0};var Kd=(()=>{class n extends aV{required;inputName="required";normalizeInput=mu;createValidator=t=>jQ;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=br(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&pu("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Yr([yZ]),Vn]})}return n})();var cV=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=To({type:n});static \u0275inj=vo({})}return n})();var Wo=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Vg,useValue:t.callSetDisabledState??Ug}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=To({type:n});static \u0275inj=vo({imports:[cV]})}return n})(),lV=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:dZ,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Vg,useValue:t.callSetDisabledState??Ug}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=To({type:n});static \u0275inj=vo({imports:[cV]})}return n})();var Hg=class n extends Hn{collectionPath="/laps";collectionRef=gr(this.firestore,this.collectionPath);raceService=S(jt);laps=J([]);constructor(){super(),He({laps:this.getRaceLaps(),activeRace:me(this.raceService.activeRace)}).pipe(Xe()).subscribe(e=>this.laps.set(e.laps))}getRaceLaps(){return He({laps:mr(this.collectionRef),activeRace:me(this.raceService.activeRace)}).pipe(Gt(this.destroyed),X(({laps:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id):[]))}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var si=class n extends Hn{collectionPath="/drivers";collectionRef=gr(this.firestore,this.collectionPath);lapService=S(Hg);stintService=S(Bt);raceConfigService=S(Ye);drivers=J([]);driversReferenceLapTimeMap=J(new Map);driversTimeOnTrackMap=J(new Map);driversTimeOnTrackWarningMap=J(new Map);driversStintCountMap=J(new Map);driverWithMoreTimeFromLastStint=J(void 0);driversTimeFromLastStintMap=J(new Map);driversTimeOnTrackWarningCount=Ae(()=>{let e=this.driversTimeOnTrackWarningMap(),t=0;return e.forEach(r=>{r&&t++}),t});constructor(){super(),He({drivers:this.getAll(),laps:me(this.lapService.laps),stints:me(this.stintService.stints),activeRaceConfig:me(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({drivers:e,laps:t,stints:r,activeRaceConfig:i})=>{this.drivers.set(e),this.driversReferenceLapTimeMap.set(this.createDriverReferenceLapTimeMap(t,e)),this.driversTimeOnTrackMap.set(this.createDriverTrackTimeMap(r,e)),this.driversTimeOnTrackWarningMap.set(this.createDriversTimeOnTrackWarningMap(this.driversTimeOnTrackMap(),i)),this.driversStintCountMap.set(this.createDriverStintCountMap(r,e)),this.driverWithMoreTimeFromLastStint.set(this.getDriverWithMoreTimeFromLastStint(r,e)),this.driversTimeFromLastStintMap.set(this.createDriversTimeFromLastStintMap(r,e))})}getAll(){return mr(this.collectionRef).pipe(Gt(this.destroyed),X(e=>e.map(t=>t).filter(t=>!t.deleted)))}createDriverReferenceLapTimeMap(e,t){let r=new Map;t.forEach(o=>{r.set(o.id,0)});let i=e.reduce((o,s)=>(o[s.driverId]||(o[s.driverId]=[]),o[s.driverId].push(s.millisecondsTime),o),{});for(let o in i){let s=i[o],a=s.reduce((c,u)=>c+u,0)/s.length;r.set(o,a)}return r}createDriverTrackTimeMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{let o;i.endDate?o=i.endDate.toDate().getTime()-i.startDate.toDate().getTime():o=new Date().getTime()-i.startDate.toDate().getTime(),r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+o):r.set(i.driverId,o)}),r}createDriversTimeOnTrackWarningMap(e,t){let r=new Map;if(t){let i=fb(t.minDriverOnTrackHour),o=fb(t.maxDriverOnTrackHour),s=Dg(t.warningDriverOnTrackThresholdMinute);e.forEach((a,c)=>{let u=a<i,d=o-a<=s;r.set(c,u||d)})}return r}createDriverStintCountMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+1):r.set(i.driverId,1)}),r}getDriverWithMoreTimeFromLastStint(e,t){if(t.length===0)return;let r,i=this.createDriversTimeFromLastStintMap(e,t),o=e.find(u=>u.endDate===null)?.driverId,s=new Map(t.map(u=>[u.id,u])),a=-1,c=!1;return i.forEach((u,d)=>{d!==o&&(u===0?(!c||c&&u>a)&&(a=u,r=s.get(d),c=!0):!c&&u>a&&(a=u,r=s.get(d)))}),r}createDriversTimeFromLastStintMap(e,t){let r=new Map;return t.forEach(i=>{let o=e.filter(s=>s.driverId===i.id).sort((s,a)=>a.startDate.toDate().getTime()-s.startDate.toDate().getTime()).at(0);o&&o.endDate?r.set(i.id,new Date().getTime()-o.endDate.toDate().getTime()):r.set(i.id,0)}),r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function _Z(n,e){if(n&1&&(T(0,"option",7),x(1),C()),n&2){let t=e.$implicit;Q("value",t.id),k(),G(" ",t.raceName," ")}}function wZ(n,e){if(n&1){let t=Ei();T(0,"div",0)(1,"div",2)(2,"form")(3,"label",3),x(4,"Start driver"),C(),T(5,"select",4),Sr("ngModelChange",function(i){ft(t);let o=q();return Kr(o.selectedDriver,i)||(o.selectedDriver=i),pt(i)}),ce("change",function(){ft(t);let i=q();return pt(i.updateDriverId())}),ee(6,_Z,2,2,"option",5),C()()(),T(7,"button",6),ce("click",function(){ft(t);let i=q();return pt(i.startRace())}),x(8," Start race "),C()()}if(n&2){let t=q();k(5),Dr("ngModel",t.selectedDriver),k(),Q("ngForOf",t.drivers())}}function EZ(n,e){if(n&1&&(T(0,"div",1),x(1),C()),n&2){let t=q();k(),G(" ",t.endRaceCountdown," ")}}var qg=class n{raceService=S(jt);raceConfigService=S(Ye);raceManagerService=S(ol);driverService=S(si);drivers=this.driverService.drivers;endRaceDate=this.raceService.endRaceDate;endRaceCountdown="--:--:--";selectedDriver="1";constructor(){He({endRaceDate:me(this.endRaceDate),ping:At(1e3)}).pipe(Xe()).subscribe(e=>{this.endRaceCountdown=ia(e.endRaceDate)}),Rr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.startRaceDriverId)})}startRace(){this.raceManagerService.startRace(this.selectedDriver)}updateDriverId(){this.raceConfigService.updateStartRaceDriverId(this.selectedDriver)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-race"]],decls:2,vars:1,consts:[[1,"flex","items-center","justify-center"],[1,"text-2xl","md:text-4xl","font-bold","font-mono","dark:text-white"],[1,"font-bold","mr-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded",3,"click"],[3,"value"]],template:function(t,r){t&1&&ee(0,wZ,9,2,"div",0)(1,EZ,2,1,"div",1),t&2&&se(r.endRaceDate()?1:0)},dependencies:[Wo,qo,jg,Bg,hl,$o,Ho,Ki,Gi,jn],encapsulation:2})};var fl=class n{raceService=S(jt);raceConfigService=S(Ye);pitService=S(Jt);openingTime=J(void 0);closingTime=J(void 0);tyreChangeWindowOpen=J(!1);remainingTyreChange=J(0);constructor(){He({pits:me(this.pitService.pits),activeRace:me(this.raceService.activeRace),raceConfig:me(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({pits:e,activeRace:t,raceConfig:r})=>{t&&r?(this.openingTime.set(Uo(t.start.toDate(),r.startTyreChangeWindowHour)),this.closingTime.set(Uo(t.start.toDate(),r.endTyreChangeWindowHour)),this.tyreChangeWindowOpen.set(this.isTyreChangeWindowOpen(this.openingTime(),this.closingTime()))):(this.openingTime.set(void 0),this.closingTime.set(void 0),this.tyreChangeWindowOpen.set(!1)),r&&this.remainingTyreChange.set(this.calculateRemainingTyreChange(e,r.minTyreChange))})}isTyreChangeWindowOpen(e,t){if(e&&t){let r=new Date;return r>=e&&r<=t}return!1}calculateRemainingTyreChange(e,t){let r=e.filter(i=>i.tyreChange&&i.exitTime).length;return t-r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var IZ=n=>({"mb-2":n}),TZ=n=>({"animate-bounce":n});function CZ(n,e){if(n&1&&(T(0,"div",4),x(1),C()),n&2){let t=q();k(),G(" Remaining: ",t.remainingTyreChange()," ")}}function bZ(n,e){n&1&&(T(0,"div",5),x(1," Completed! "),C())}function DZ(n,e){if(n&1&&(T(0,"div",6),x(1," Window open "),C()),n&2){let t=q();Q("ngClass",tt(1,TZ,t.remainingTyreChange()>0))}}function SZ(n,e){n&1&&(T(0,"div",7),x(1," Window closed "),C())}function AZ(n,e){if(n&1&&(x(0),Ii(1,"date")),n&2){let t=q(2);G(" ",Ti(1,1,t.openingTime(),"HH:mm:ss")," ")}}function RZ(n,e){n&1&&x(0," --:--:-- ")}function xZ(n,e){if(n&1&&(x(0),Ii(1,"date")),n&2){let t=q(2);G(" ",Ti(1,1,t.closingTime(),"HH:mm:ss")," ")}}function NZ(n,e){n&1&&x(0," --:--:-- ")}function MZ(n,e){if(n&1&&(T(0,"div",8)(1,"div")(2,"div",9),x(3,"Opening time"),C(),T(4,"div",10),ee(5,AZ,2,4)(6,RZ,1,0),C()(),T(7,"div")(8,"div",11),x(9,"Opening in"),C(),T(10,"div",12),x(11),C()()(),Ce(12,"hr",13),T(13,"div",14)(14,"div")(15,"div",9),x(16,"Closing time"),C(),T(17,"div",10),ee(18,xZ,2,4)(19,NZ,1,0),C()(),T(20,"div")(21,"div",11),x(22,"Closing in"),C(),T(23,"div",12),x(24),C()()()),n&2){let t=q();k(5),se(t.openingTime()?5:6),k(6),G(" ",t.countdownOpeningTime()," "),k(7),se(t.closingTime()?18:19),k(6),G(" ",t.countdownClosingTime()," ")}}var Wg=class n{tyreService=S(fl);openingTime=this.tyreService.openingTime;closingTime=this.tyreService.closingTime;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;countdownOpeningTime=Ae(()=>ia(this.tyreService.openingTime()));countdownClosingTime=Ae(()=>ia(this.tyreService.closingTime()));isOpen=!1;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-tyre-change-window"]],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default",3,"ngClass"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F6DE} \u{1F504} Tyre change"),C(),T(4,"div",3),ee(5,CZ,2,1,"div",4)(6,bZ,2,0,"div",5)(7,DZ,2,3,"div",6)(8,SZ,2,0,"div",7),C()(),ee(9,MZ,25,4),C()),t&2&&(k(),Q("ngClass",tt(4,IZ,r.isOpen)),k(4),se(r.remainingTyreChange()>0?5:6),k(2),se(r.tyreChangeWindowOpen()?7:8),k(2),se(r.isOpen?9:-1))},dependencies:[Za,rt],encapsulation:2})};var zg=class n{charge=100;batteryColor="bg-green-500";batteryBorderColor="border-gray-200";ngOnChanges(e){this.batteryColor=this.getBackgroundColor(this.charge),this.batteryBorderColor=this.getBorderColor(this.charge)}getBackgroundColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}getBorderColor(e){return e<=10?"border-red-500":e<=25?"border-orange-500":"border-gray-200"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-battery"]],inputs:{charge:"charge"},features:[yo],decls:6,vars:6,consts:[[1,"w-16","lg:w-20","h-8","grid","grid-cols-6","items-center"],[1,"shadow","col-span-5","rounded","border-2","flex","relative",3,"ngClass"],[1,"cursor-default","leading-none","rounded-sm","flex","items-center","m-0.5","py-3",3,"ngClass"],[1,"absolute","right-2","text-black","font-semibold","font-mono"],[1,"ml-0.5","border-r-8","w-1","h-4","rounded-r",3,"ngClass"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),x(4),C()()(),Ce(5,"div",4),C()),t&2&&(k(),Q("ngClass",r.batteryBorderColor),k(),Qa("width",r.charge,"%"),Q("ngClass",r.batteryColor),k(2),mt(r.charge),k(),Q("ngClass",r.batteryBorderColor))},dependencies:[rt],encapsulation:2,changeDetection:0})};var Gg=class n{raceService=S(jt);pitService=S(Jt);raceConfigService=S(Ye);lastRefuelTime=J(void 0);emptyFuelTime=J(void 0);remainingFuelPercentage=J(100);remainingFuelLap=J(0);constructor(){He({lastRefuelPit:me(this.pitService.lastRefuelPit),activeRace:me(this.raceService.activeRace),raceConfig:me(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({lastRefuelPit:e,activeRace:t,raceConfig:r})=>{this.lastRefuelTime.set(this.getLastRefuelDate(e,t)),this.emptyFuelTime.set(this.calculateEmptyFuelTime(this.lastRefuelTime(),r)),this.remainingFuelLap.set(this.calculateRemainingFuelLaps(this.emptyFuelTime(),r)),this.remainingFuelPercentage.set(this.calculateRemainingFuelPercentage(this.emptyFuelTime(),r))})}getLastRefuelDate(e,t){if(e&&e.exitTime)return e.exitTime.toDate();if(t)return t.start.toDate()}calculateEmptyFuelTime(e,t){if(e&&t)return ea(e,t.fuelDurationMinute)}calculateRemainingFuelPercentage(e,t){if(e&&t){let i=Ig(e,new Date)/t.fuelDurationMinute*100,o=Math.max(0,Math.min(i,100));return parseFloat(o.toFixed(0))}return 100}calculateRemainingFuelLaps(e,t){if(e&&t){let r=Wi(e,new Date);return Math.floor(r/t.referenceLapTimeMillisecond)}if(!e&&t){let r=Dg(t.fuelDurationMinute);return Math.floor(r/t.referenceLapTimeMillisecond)}return 0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var PZ=n=>({"mb-2":n}),kZ=n=>({"animate-bounce":n});function OZ(n,e){if(n&1&&(x(0),Ii(1,"date")),n&2){let t=q(2);G(" ",Ti(1,1,t.lastRefuelTime(),"HH:mm:ss")," ")}}function FZ(n,e){n&1&&x(0," --:--:-- ")}function LZ(n,e){if(n&1&&(x(0),Ii(1,"date")),n&2){let t=q(2);G(" ",Ti(1,1,t.emptyFuelTime(),"HH:mm:ss")," ")}}function VZ(n,e){n&1&&x(0," --:--:-- ")}function UZ(n,e){if(n&1){let t=Ei();T(0,"div",7)(1,"div")(2,"div",8),x(3,"Last refuel time"),C(),T(4,"div",9),ee(5,OZ,2,4)(6,FZ,1,0),C()(),T(7,"div")(8,"div",10),x(9,"Since last refuel"),C(),T(10,"div",11),x(11),C()()(),Ce(12,"hr",12),T(13,"div",7)(14,"div")(15,"div",8),x(16,"Empty time"),C(),T(17,"div",9),ee(18,LZ,2,4)(19,VZ,1,0),C()(),T(20,"div")(21,"div",10),x(22,"Empty in"),C(),T(23,"div",11),x(24),C()()(),Ce(25,"hr",12),T(26,"div",13)(27,"div")(28,"div",8),x(29,"Remaining laps"),C(),T(30,"div",9),x(31),C()(),T(32,"div")(33,"div",10),x(34,"Fuel duration (min)"),C(),T(35,"div",14)(36,"button",15),ce("click",function(){ft(t);let i=q();return pt(i.increaseFuelDuration())}),x(37,"+"),C(),T(38,"form",16),ce("ngSubmit",function(){ft(t);let i=q();return pt(i.onSubmit())}),T(39,"input",17),Sr("ngModelChange",function(i){ft(t);let o=q();return Kr(o.fuelDurationMinute,i)||(o.fuelDurationMinute=i),pt(i)}),C()(),T(40,"button",18),ce("click",function(){ft(t);let i=q();return pt(i.decreaseFuelDuration())}),x(41,"-"),C()()()()}if(n&2){let t=q();k(5),se(t.lastRefuelTime()?5:6),k(6),G(" ",t.sinceLastRefuel()," "),k(7),se(t.emptyFuelTime()?18:19),k(6),G(" ",t.emptyFuelCountdown()," "),k(7),G(" ",t.remainingFuelLap()," "),k(8),Dr("ngModel",t.fuelDurationMinute)}}var Kg=class n{raceConfigService=S(Ye);fuelService=S(Gg);remainingFuelPercentage=this.fuelService.remainingFuelPercentage;remainingFuelLap=this.fuelService.remainingFuelLap;emptyFuelTime=this.fuelService.emptyFuelTime;lastRefuelTime=this.fuelService.lastRefuelTime;emptyFuelCountdown=Ae(()=>ia(this.emptyFuelTime()));sinceLastRefuel=Ae(()=>Bo(this.lastRefuelTime(),new Date));warning=Ae(()=>this.remainingFuelPercentage()<=20);remainingColor=Ae(()=>this.getRemainingColor(this.remainingFuelPercentage()));isOpen=!0;fuelDurationMinute=0;constructor(){Rr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.fuelDurationMinute=e.fuelDurationMinute)})}onSubmit(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute)}increaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute+1)}decreaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute-1)}getRemainingColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-fuel"]],decls:11,vars:12,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center",3,"ngClass"],[1,"px-2","py-1","w-36","rounded-lg","text-left","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[1,"px-2","py-1","rounded-lg","text-center","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[3,"charge"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"],[1,"flex","justify-end"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","mr-1","rounded",3,"click"],[1,"text-right",3,"ngSubmit"],["type","number","id","fuelDuration","name","fuelDuration","required","","min","1",1,"border","rounded-lg","px-2","py-1","w-20","text-right",3,"ngModelChange","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","ml-1","rounded",3,"click"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u26FD\uFE0F Fuel"),C(),T(4,"div",3)(5,"div",4),x(6),C(),T(7,"div",5),x(8),C(),Ce(9,"app-battery",6),C()(),ee(10,UZ,42,6),C()),t&2&&(k(),Q("ngClass",tt(8,PZ,r.isOpen)),k(3),Q("ngClass",tt(10,kZ,r.warning())),k(),Q("ngClass",r.remainingColor()),k(),G(" Empty: ",r.emptyFuelCountdown()," "),k(),Q("ngClass",r.remainingColor()),k(),G(" Laps: ",r.remainingFuelLap()," "),k(),Q("charge",r.remainingFuelPercentage()),k(),se(r.isOpen?10:-1))},dependencies:[rt,Za,zg,Wo,qo,dl,zd,$o,Ho,Kd,Gd,Ki,Gi],encapsulation:2})};var jZ=n=>({"mb-2":n});function BZ(n,e){if(n&1&&(T(0,"div",6)(1,"div")(2,"div",7),x(3,"Optimized AVG time"),C(),T(4,"div",8),x(5),C()(),T(6,"div")(7,"div",9),x(8,"Laps"),C(),T(9,"div",10),x(10),C()()(),Ce(11,"hr",11),T(12,"div",12)(13,"div")(14,"div",7),x(15," Optimized AVG time "),T(16,"strong"),x(17,"if driver change now"),C()(),T(18,"div",8),x(19),C()(),T(20,"div")(21,"div",9),x(22,"Laps"),C(),T(23,"div",10),x(24),C()()()),n&2){let t=q();k(5),G(" ",t.AVGStintTime()," "),k(5),G(" ",t.laps()," "),k(9),G(" ",t.AVGStintTimeIfDriverChangeNow()," "),k(5),G(" ",t.lapsIfDriverChangeNow()," ")}}var Yg=class n{stintOptimizerService=S(oi);AVGStintTime=Ae(()=>{let e=this.stintOptimizerService.optimizedStint();return e?Mt(e.avgStintMillisecondsTime):"--:--:--"});laps=Ae(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.laps:0});AVGStintTimeIfDriverChangeNow=Ae(()=>{let e=this.stintOptimizerService.optimizedStint();return e?Mt(e.avgStintMillisecondsIfDriverChangedNow):"--:--:--"});lapsIfDriverChangeNow=Ae(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.lapsIfDriverChangeNow:0});isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-stint-optimizer"]],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F9E0} Stint optimizer"),C(),T(4,"div",3)(5,"div",4),x(6),C(),T(7,"div",5),x(8),C()()(),ee(9,BZ,25,4),C()),t&2&&(k(),Q("ngClass",tt(4,jZ,r.isOpen)),k(5),G(" Optimum: ",r.AVGStintTime()," "),k(2),G(" Laps: ",r.laps()," "),k(),se(r.isOpen?9:-1))},dependencies:[rt],encapsulation:2})};var $Z=n=>({"mb-2":n}),HZ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e}),qZ=n=>({"bg-yellow-500 text-white":n});function WZ(n,e){if(n&1&&(T(0,"div",4),x(1),C()),n&2){let t=q();k(),G(" Warning: ",t.driversTimeOnTrackWarningCount()," ")}}function zZ(n,e){n&1&&(T(0,"div",5),x(1," Completed! "),C())}function GZ(n,e){if(n&1&&(T(0,"tr",17)(1,"td",18),x(2),C(),T(3,"td",19),x(4),C(),T(5,"td",20),x(6),C(),T(7,"td",21)(8,"div",22),x(9),C()(),T(10,"td",23),x(11),C()()),n&2){let t=e.$implicit,r=q(2);Q("ngClass",Ar(7,HZ,t.id===r.activeStintDriverId(),t.id!==r.activeStintDriverId())),k(2),mt(t.id),k(2),mt(t.raceName),k(2),G(" ",r.getDriverStintCount(t.id)," "),k(2),Q("ngClass",tt(10,qZ,r.getDriverTimeOnTrackWarning(t.id))),k(),G(" ",r.getDriverTimeOnTrack(t.id)," "),k(2),G("",r.getDriverTimeFromLastStint(t.id)," ")}}function KZ(n,e){if(n&1&&(T(0,"div",6)(1,"table",7)(2,"thead",8)(3,"tr"),Ce(4,"th",9),T(5,"th",10),x(6," Name "),C(),T(7,"th",11),x(8," Stint "),C(),T(9,"th",12),x(10," On track "),C(),T(11,"th",13),x(12," From last stint "),C()()()(),T(13,"div",14)(14,"table",15)(15,"tbody"),ee(16,GZ,12,12,"tr",16),C()()()()),n&2){let t=q();k(16),Q("ngForOf",t.drivers())}}var Qg=class n{driverService=S(si);stintService=S(Bt);drivers=this.driverService.drivers;driversTimeOnTrackWarningCount=this.driverService.driversTimeOnTrackWarningCount;activeStintDriverId=Ae(()=>{let e=this.stintService.activeStint();if(e)return e.driverId});isOpen=!0;getDriverTimeOnTrack(e){return Mt(this.driverService.driversTimeOnTrackMap().get(e))}getDriverTimeOnTrackWarning(e){return this.driverService.driversTimeOnTrackWarningMap().get(e)||!1}getDriverStintCount(e){return this.driverService.driversStintCountMap().get(e)??0}getDriverTimeFromLastStint(e){return Mt(this.driverService.driversTimeFromLastStintMap().get(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-driver"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[1,"p-1","text-center","rounded",3,"ngClass"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F417} Driver"),C(),T(4,"div",3),ee(5,WZ,2,1,"div",4)(6,zZ,2,0,"div",5),C()(),ee(7,KZ,17,1,"div",6),C()),t&2&&(k(),Q("ngClass",tt(3,$Z,r.isOpen)),k(4),se(r.driversTimeOnTrackWarningCount()>0?5:6),k(2),se(r.isOpen?7:-1))},dependencies:[rt,jn],encapsulation:2})};var Zg=class n{raceService=S(jt);stintService=S(Bt);raceConfigService=S(Ye);open=J(!1);openInMilliseconds=J(0);constructor(){He({endRaceDate:me(this.raceService.endRaceDate),activeStint:me(this.stintService.activeStint),activeRaceConfig:me(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({endRaceDate:e,activeStint:t,activeRaceConfig:r})=>{e&&t&&r?(this.open.set(this.calculatePitLaneOpen(e,t,r)),this.openInMilliseconds.set(this.calculatePitLaneOpenInMilliseconds(t,r))):(this.open.set(!1),this.openInMilliseconds.set(0))})}calculatePitLaneOpenInMilliseconds(e,t){let r=new Date().getTime();return ea(e.startDate.toDate(),t.minStintMinute).getTime()-r}calculatePitLaneOpen(e,t,r){let i=new Date,o=OL(e,r.pitLaneCloseBeforeEndRaceMinute),s=kL(i,o),a=ea(t.startDate.toDate(),r.minStintMinute),c=PL(i,a);return s&&c}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Jg=class n{audio=new Audio;constructor(){this.audio.addEventListener("error",e=>console.error("Audio error:",e))}play(){this.audio.play()}playFile(e){this.audio=new Audio(e),this.audio.play()}pause(){this.audio.pause()}stop(){this.audio.pause(),this.audio.currentTime=0}seek(e){this.audio.currentTime=e}setVolume(e){this.audio.volume=e}setLoop(e){this.audio.loop=e}on(e,t){this.audio.addEventListener(e,t)}off(e,t){this.audio.removeEventListener(e,t)}getCurrentTime(){return this.audio.currentTime}getDuration(){return this.audio.duration}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var YZ=n=>({"mb-4":n}),QZ=n=>({"animate-bounce":n});function ZZ(n,e){if(n&1&&(T(0,"div",3),x(1),C()),n&2){let t=q();k(),G(" Open in: ",t.pitLaneOpenInMillisecondsString()," ")}}function JZ(n,e){n&1&&(T(0,"div",5),x(1," Open "),C())}function XZ(n,e){n&1&&(T(0,"div",6),x(1," Closed "),C())}function eJ(n,e){if(n&1&&(T(0,"option",20),x(1),C()),n&2){let t=e.$implicit;Q("value",t.id),k(),G(" ",t.raceName," ")}}function tJ(n,e){if(n&1){let t=Ei();T(0,"div",11),x(1,"PIT SETTINGS"),C(),T(2,"form")(3,"div",12)(4,"label",13),x(5,"\u{1F417} Driver"),C(),T(6,"select",14),Sr("ngModelChange",function(i){ft(t);let o=q(2);return Kr(o.selectedDriver,i)||(o.selectedDriver=i),pt(i)}),ce("change",function(){ft(t);let i=q(2);return pt(i.updateDriverId())}),ee(7,eJ,2,2,"option",15),C()(),T(8,"div",12)(9,"label",16),x(10,"\u26FD\uFE0F Refueling"),C(),T(11,"input",17),ce("change",function(){ft(t);let i=q(2);return pt(i.updateRefueling())}),Sr("ngModelChange",function(i){ft(t);let o=q(2);return Kr(o.refueling,i)||(o.refueling=i),pt(i)}),C()(),T(12,"div",12)(13,"label",18),x(14,"\u{1F6DE} Tyre change"),C(),T(15,"input",19),Sr("ngModelChange",function(i){ft(t);let o=q(2);return Kr(o.tyreChange,i)||(o.tyreChange=i),pt(i)}),ce("change",function(){ft(t);let i=q(2);return pt(i.updateTyreChange())}),C()()()}if(n&2){let t=q(2);k(6),Q("disabled",t.activePit()!==void 0),Dr("ngModel",t.selectedDriver),k(),Q("ngForOf",t.drivers()),k(4),Q("disabled",t.activePit()!==void 0),Dr("ngModel",t.refueling),k(4),Q("disabled",t.activePit()!==void 0||!t.tyreChangeWindowOpen()||t.remainingTyreChange()<=0),Dr("ngModel",t.tyreChange)}}function nJ(n,e){if(n&1&&(T(0,"div",21),x(1),C()),n&2){let t=q(3);Q("ngClass",tt(2,QZ,t.activePitRemainingMilliseconds()<1e4)),k(),G(" Pit out enabled in: ",t.activePitRemainingMillisecondsString()," ")}}function rJ(n,e){n&1&&(T(0,"div",22),x(1," Pit out ready! "),C())}function iJ(n,e){if(n&1&&ee(0,nJ,2,4,"div",21)(1,rJ,2,0,"div",22),n&2){let t=q(2);se(t.activePitRemainingMilliseconds()>0?0:1)}}function oJ(n,e){if(n&1){let t=Ei();T(0,"div",7),ee(1,tJ,16,7)(2,iJ,2,1),C(),T(3,"div",8)(4,"button",9),ce("click",function(){ft(t);let i=q();return pt(i.pitIn())}),x(5," Pit in "),C(),T(6,"button",10),ce("click",function(){ft(t);let i=q();return pt(i.pitOut())}),x(7," Pit out "),C()()}if(n&2){let t=q();k(),se(t.activePit()?2:1),k(3),Q("disabled",!t.pitLaneOpen()),k(2),Q("disabled",!t.activePit()||t.activePit()&&t.activePitRemainingMilliseconds()>0)}}var Xg=class n{pitLaneService=S(Zg);pitService=S(Jt);driverService=S(si);raceManagerService=S(ol);tyreService=S(fl);raceConfigService=S(Ye);audioService=S(Jg);pitLaneOpen=this.pitLaneService.open;pitLaneOpenInMilliseconds=this.pitLaneService.openInMilliseconds;pitLaneOpenInMillisecondsString=Ae(()=>Mt(this.pitLaneService.openInMilliseconds()));activePit=this.pitService.activePit;activePitRemainingMilliseconds=this.pitService.activePitRemainingMilliseconds;activePitRemainingMillisecondsString=Ae(()=>FL(this.pitService.activePitRemainingMilliseconds()));drivers=this.driverService.drivers;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;isOpen=!0;refueling=!1;tyreChange=!1;selectedDriver="1";constructor(){Rr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.nextPitDriverId,this.refueling=e.nextPitRefueling,this.tyreChange=e.nextPitTyreChange)})}pitIn(){return y(this,null,function*(){this.audioService.playFile("assets/box_box_box_box.mp3"),yield this.raceManagerService.pitIn(this.selectedDriver,this.refueling,this.tyreChange)})}pitOut(){return y(this,null,function*(){yield this.raceManagerService.pitOut(),this.raceConfigService.updateNextPitRefueling(!1),this.raceConfigService.updateNextPitTyreChange(!1);let e=this.driverService.driverWithMoreTimeFromLastStint();e&&this.raceConfigService.updateNextPitDriverId(e.id)})}updateDriverId(){this.raceConfigService.updateNextPitDriverId(this.selectedDriver)}updateTyreChange(){this.raceConfigService.updateNextPitTyreChange(this.tyreChange)}updateRefueling(){this.raceConfigService.updateNextPitRefueling(this.refueling)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-pit-lane"]],decls:9,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"flex","items-center"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","items-center","mb-2"],[1,"flex","justify-between"],[1,"bg-green-500","hover:bg-green-700","disabled:bg-green-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"bg-red-500","hover:bg-red-700","disabled:bg-red-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"font-semibold","mb-2"],[1,"mb-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","disabled","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","refueling",1,"mr-2"],["type","checkbox","id","refueling","name","refueling",3,"change","ngModelChange","disabled","ngModel"],["for","tyreChange",1,"mr-2"],["type","checkbox","id","tyreChange","name","tyreChange",3,"ngModelChange","change","disabled","ngModel"],[3,"value"],[1,"bg-yellow-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default",3,"ngClass"],[1,"bg-green-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F17F}\uFE0F Pit Lane"),C(),ee(4,ZZ,2,1,"div",3),T(5,"div",4),ee(6,JZ,2,0,"div",5)(7,XZ,2,0,"div",6),C()(),ee(8,oJ,8,3),C()),t&2&&(k(),Q("ngClass",tt(4,YZ,r.isOpen)),k(3),se(r.pitLaneOpenInMilliseconds()>0?4:-1),k(2),se(r.pitLaneOpen()?6:7),k(2),se(r.isOpen?8:-1))},dependencies:[rt,Wo,qo,jg,Bg,vb,hl,$o,Ho,Ki,Gi,jn],encapsulation:2})};var sJ=n=>({"mb-2":n});function aJ(n,e){if(n&1&&(T(0,"div",4),x(1),C()),n&2){let t=q();k(),G(" Remaining: ",t.remainingDriverChanges()," ")}}function cJ(n,e){n&1&&(T(0,"div",5),x(1," Completed! "),C())}function lJ(n,e){if(n&1&&(T(0,"div",6)(1,"div")(2,"div",7),x(3,"Competed"),C(),T(4,"div",8),x(5),C()(),T(6,"div")(7,"div",9),x(8,"Remaining"),C(),T(9,"div",10),x(10),C()()()),n&2){let t=q();k(5),G(" ",t.completedDriverChanges()," "),k(5),G(" ",t.remainingDriverChanges()," ")}}var ev=class n{pitService=S(Jt);remainingDriverChanges=this.pitService.remainingDriverChanges;completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!1;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-driver-change"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F417} \u{1F504} Driver change"),C(),T(4,"div",3),ee(5,aJ,2,1,"div",4)(6,cJ,2,0,"div",5),C()(),ee(7,lJ,11,2,"div",6),C()),t&2&&(k(),Q("ngClass",tt(3,sJ,r.isOpen)),k(4),se(r.remainingDriverChanges()>0?5:6),k(2),se(r.isOpen?7:-1))},dependencies:[rt],encapsulation:2})};var uJ=n=>({"mb-2":n});function dJ(n,e){if(n&1&&(T(0,"div",4),x(1),C(),T(2,"div",5),x(3),C()),n&2){let t=q(2);k(),G(" Remaining: ",t.activeStintRemainingTimeOnTrackString()," "),k(2),G(" Laps: ",t.activeStintRemainingLaps()," ")}}function hJ(n,e){if(n&1&&(T(0,"div",6),x(1),C(),T(2,"div",7),x(3),C()),n&2){let t=q(2);k(),G(" Gaining: ",t.activeStintGainedTimeOnTrackString()," "),k(2),G(" Laps: ",t.activeStintGainedLaps()," ")}}function fJ(n,e){if(n&1&&ee(0,dJ,4,2)(1,hJ,4,2),n&2){let t=q();se(t.activeStintRemainingTimeOnTrack()>0?0:1)}}function pJ(n,e){if(n&1&&x(0),n&2){let t=q(2);G(" ",t.activeStintRemainingTimeOnTrackString()," ")}}function mJ(n,e){n&1&&x(0," --:--:-- ")}function gJ(n,e){if(n&1&&x(0),n&2){let t=q(2);G(" ",t.activeStintRemainingLaps()," ")}}function vJ(n,e){n&1&&x(0," 0 ")}function yJ(n,e){if(n&1&&(T(0,"div",8)(1,"div")(2,"div",9),x(3,"Time on track"),C(),T(4,"div",10),x(5),C()(),T(6,"div")(7,"div",11),x(8,"Laps"),C(),T(9,"div",12),x(10),C()()(),Ce(11,"hr",13),T(12,"div",8)(13,"div")(14,"div",9),x(15,"Remaining time on track"),C(),T(16,"div",10),ee(17,pJ,1,1)(18,mJ,1,0),C()(),T(19,"div")(20,"div",11),x(21,"Remaining laps"),C(),T(22,"div",12),ee(23,gJ,1,1)(24,vJ,1,0),C()()(),Ce(25,"hr",13),T(26,"div",14)(27,"div")(28,"div",9),x(29,"Gained time on track"),C(),T(30,"div",10),x(31),C()(),T(32,"div")(33,"div",11),x(34,"Gained laps"),C(),T(35,"div",12),x(36),C()()()),n&2){let t=q();k(5),G(" ",t.activeStintTimeOnTrackString()," "),k(5),G(" ",t.activeStintLaps()," "),k(7),se(t.activeStint()?17:18),k(6),se(t.activeStint()?23:24),k(8),G(" ",t.activeStintGainedTimeOnTrackString()," "),k(5),G(" ",t.activeStintGainedLaps()," ")}}var tv=class n{stintService=S(Bt);activeStint=this.stintService.activeStint;activeStintRemainingTimeOnTrack=this.stintService.activeStintRemainingTimeOnTrack;activeStintTimeOnTrackString=Ae(()=>Mt(this.stintService.activeStintTimeOnTrack()));activeStintRemainingTimeOnTrackString=Ae(()=>Mt(this.stintService.activeStintRemainingTimeOnTrack()));activeStintGainedTimeOnTrackString=Ae(()=>Mt(this.stintService.activeStintGainedTimeOnTrack()));activeStintLaps=this.stintService.activeStintLaps;activeStintRemainingLaps=this.stintService.activeStintRemainingLaps;activeStintGainedLaps=this.stintService.activeStintGainedLaps;isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-active-stint"]],decls:7,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F3CE}\uFE0F \u{1F4A8} Active stint"),C(),T(4,"div",3),ee(5,fJ,2,1),C()(),ee(6,yJ,37,6),C()),t&2&&(k(),Q("ngClass",tt(3,uJ,r.isOpen)),k(4),se(r.activeStint()?5:-1),k(),se(r.isOpen?6:-1))},dependencies:[rt],encapsulation:2})};var _J=n=>({"mb-2":n}),wJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function EJ(n,e){if(n&1&&(x(0),Ii(1,"date")),n&2){let t=q().$implicit;G(" ",Ti(1,1,t.endDate.toDate(),"HH:mm:ss")," ")}}function IJ(n,e){if(n&1&&(T(0,"tr",19)(1,"td",20),x(2),C(),T(3,"td",21),x(4),C(),T(5,"td",18),x(6),Ii(7,"date"),C(),T(8,"td",18),ee(9,EJ,2,4),C(),T(10,"td",18),x(11),C()()),n&2){let t=e.$implicit,r=q(2);Q("ngClass",Ar(9,wJ,t.id===r.activeStintId(),t.id!==r.activeStintId())),k(2),mt(t.id),k(2),G("",r.getDriverRacingName(t.driverId)," "),k(2),mt(Ti(7,6,t.startDate.toDate(),"HH:mm:ss")),k(3),se(t.endDate?9:-1),k(2),G(" ",r.calculateTimeOnTrack(t.startDate.toDate(),t.endDate==null?null:t.endDate.toDate())," ")}}function TJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),Ce(4,"th",8),T(5,"th",9),x(6,"Driver"),C(),T(7,"th",10),x(8,"Start"),C(),T(9,"th",10),x(10,"End"),C(),T(11,"th",10),x(12,"On track"),C()()()(),T(13,"div",11)(14,"table",12)(15,"tbody"),ee(16,IJ,12,12,"tr",13),C()()(),T(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),x(22,"Totals"),C(),T(23,"td",18),x(24),C()()()()()()),n&2){let t=q();k(16),Q("ngForOf",t.stints()),k(8),mt(t.calculateTotalTimeOnTrack())}}var nv=class n{stintService=S(Bt);driverService=S(si);stints=this.stintService.stints;activeStintId=Ae(()=>{let e=this.stintService.activeStint();if(e)return e.id});isOpen=!0;getDriverRacingName(e){let r=this.driverService.drivers().find(i=>i.id===e);return r?r.raceName:""}calculateTimeOnTrack(e,t){return t?Bo(e,t):Bo(e,new Date)}calculateTotalTimeOnTrack(){let e=this.stintService.stints(),t=0;return e.forEach(r=>{r.endDate?t+=r.endDate.toDate().getTime()-r.startDate.toDate().getTime():t+=new Date().getTime()-r.startDate.toDate().getTime()}),Mt(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-stint"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],["colspan","6",1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-xs","xl:text-base","text-black"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u23F3 Stint"),C(),T(4,"div",3)(5,"div",4),x(6),C()()(),ee(7,TJ,25,2,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,_J,r.isOpen)),k(5),G(" Total: ",r.stints().length," "),k(),se(r.isOpen?7:-1))},dependencies:[rt,jn,Za],encapsulation:2})};var CJ=n=>({"mb-2":n});function bJ(n,e){if(n&1){let t=Ei();T(0,"div",5)(1,"div")(2,"div",6),x(3,"Reference time (mills)"),C(),T(4,"div",7)(5,"button",8),ce("click",function(){ft(t);let i=q();return pt(i.increaseReferenceLapTime())}),x(6,"+"),C(),T(7,"form",9),ce("ngSubmit",function(){ft(t);let i=q();return pt(i.onSubmit())}),T(8,"input",10),Sr("ngModelChange",function(i){ft(t);let o=q();return Kr(o.referenceLapTime,i)||(o.referenceLapTime=i),pt(i)}),C()(),T(9,"button",11),ce("click",function(){ft(t);let i=q();return pt(i.decreaseReferenceLapTime())}),x(10,"-"),C()()()()}if(n&2){let t=q();k(8),Dr("ngModel",t.referenceLapTime)}}var rv=class n{raceConfigService=S(Ye);isOpen=!0;referenceLapTime=0;referenceLapTimeString="--:--:---";constructor(){Rr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.referenceLapTime=e.referenceLapTimeMillisecond,this.referenceLapTimeString=LL(e.referenceLapTimeMillisecond))})}onSubmit(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime)}increaseReferenceLapTime(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime+1)}decreaseReferenceLapTime(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime-1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-lap"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-center"],[1,"text-gray-600","text-center"],[1,"flex","justify-end"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","mr-1","rounded",3,"click"],[1,"text-right",3,"ngSubmit"],["type","number","id","referenceLapTime","name","referenceLapTime","required","","min","1",1,"border","rounded-lg","px-2","py-1","w-36","text-right",3,"ngModelChange","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","ml-1","rounded",3,"click"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u23F1\uFE0F Lap"),C(),T(4,"div",3)(5,"div",4),x(6),C()()(),ee(7,bJ,11,1,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,CJ,r.isOpen)),k(5),G(" Reference: ",r.referenceLapTimeString," "),k(),se(r.isOpen?7:-1))},dependencies:[rt,Wo,qo,dl,zd,$o,Ho,Kd,Gd,Ki,Gi,lV],encapsulation:2})};var DJ=n=>({"mb-2":n}),SJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function AJ(n,e){n&1&&x(0," \u2705 ")}function RJ(n,e){n&1&&x(0," \u2705 ")}function xJ(n,e){n&1&&x(0," \u2705 ")}function NJ(n,e){if(n&1&&(T(0,"tr",20)(1,"td",17),x(2),C(),T(3,"td",21),ee(4,AJ,1,0),C(),T(5,"td",22),ee(6,RJ,1,0),C(),T(7,"td",22),ee(8,xJ,1,0),C(),T(9,"td",23),x(10),C()()),n&2){let t=e.$implicit,r=q(2);Q("ngClass",Ar(6,SJ,t.id===r.activePitId(),t.id!==r.activePitId())),k(2),mt(t.id),k(2),se(t.entryDriverId!==t.exitDriverId?4:-1),k(2),se(t.refuel?6:-1),k(2),se(t.tyreChange?8:-1),k(2),G(" ",r.calculatePitTime(t.entryTime.toDate(),t.exitTime==null?null:t.exitTime.toDate())," ")}}function MJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),Ce(4,"th",8),T(5,"th",9),x(6,"\u{1F417} \u{1F504}"),C(),T(7,"th",9),x(8,"\u26FD\uFE0F"),C(),T(9,"th",9),x(10,"\u{1F6DE} \u{1F504}"),C(),T(11,"th",10),x(12,"Time"),C()()()(),T(13,"div",11)(14,"table",12)(15,"tbody"),ee(16,NJ,11,9,"tr",13),C()()(),T(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),x(22,"Totals"),C(),T(23,"td",18),x(24),C(),T(25,"td",18),x(26),C(),T(27,"td",18),x(28),C(),T(29,"td",19),x(30),C()()()()()()),n&2){let t=q();k(16),Q("ngForOf",t.pits()),k(8),mt(t.completedDriverChanges()),k(2),mt(t.calculateTotalRefueling()),k(2),mt(t.calculateTotalTyreChanges()),k(2),mt(t.calculateTotalPitTime())}}var iv=class n{pitService=S(Jt);pits=this.pitService.pits;activePitId=Ae(()=>{let e=this.pitService.activePit();if(e)return e.id});completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!0;calculatePitTime(e,t){return t?Bo(e,t):Bo(e,new Date)}calculateTotalPitTime(){let e=this.pitService.pits(),t=0;return e.forEach(r=>{r.exitTime?t+=r.exitTime.toDate().getTime()-r.entryTime.toDate().getTime():t+=new Date().getTime()-r.entryTime.toDate().getTime()}),Mt(t)}calculateTotalRefueling(){return this.pitService.pits().filter(e=>e.refuel).length}calculateTotalTyreChanges(){return this.pitService.pits().filter(e=>e.tyreChange).length}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-pit"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],[1,"py-2","px-3","border-b","border-gray-200","text-sm","xl:text-base","text-black"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F468}\u{1F3FB}\u200D\u{1F527} Pit"),C(),T(4,"div",3)(5,"div",4),x(6),C()()(),ee(7,MJ,31,5,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,DJ,r.isOpen)),k(5),G(" Total: ",r.pits().length," "),k(),se(r.isOpen?7:-1))},dependencies:[rt,jn],encapsulation:2})};var ov=class n{stintService=S(Bt);deltaStints=J([]);totalDeltaMilliseconds=J(0);constructor(){He({stints:me(this.stintService.stints),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e})=>{let t=this.createDeltaStints(e);this.deltaStints.set(t),this.totalDeltaMilliseconds.set(t.reduce((r,i)=>r+i.delta,0))})}createDeltaStints(e){let t=[];return e.forEach(r=>{t.push(this.createDeltaStint(r))}),t}createDeltaStint(e){let r=(e.endDate?e.endDate.toDate():new Date).getTime()-e.startDate.toDate().getTime(),i=r-e.optimumMilliseconds;return{id:e.id,delta:i,optimum:e.optimumMilliseconds,timeOnTrack:r}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var PJ=n=>({"mb-2":n}),wb=(n,e)=>({"bg-yellow-500":n,"bg-green-500":e}),kJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function OJ(n,e){n&1&&x(0," Losing: ")}function FJ(n,e){n&1&&x(0," Gaining: ")}function LJ(n,e){if(n&1&&(T(0,"tr",19)(1,"td",20),x(2),C(),T(3,"td",17),x(4),C(),T(5,"td",17),x(6),C(),T(7,"td",21)(8,"div",18),x(9),C()()()),n&2){let t=e.$implicit,r=q(2);Q("ngClass",Ar(6,kJ,t.id===r.activeStintId(),t.id!==r.activeStintId())),k(2),mt(t.id),k(2),mt(r.getMillisecondsToTimeString(t.timeOnTrack)),k(2),mt(r.getMillisecondsToTimeString(t.optimum)),k(2),Q("ngClass",Ar(9,wb,t.delta<0,t.delta>=0)),k(),G(" ",r.getMillisecondsToTimeString(t.delta)," ")}}function VJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),Ce(4,"th",8),T(5,"th",9),x(6,"On track"),C(),T(7,"th",9),x(8,"Optimum"),C(),T(9,"th",9),x(10,"Delta"),C()()()(),T(11,"div",10)(12,"table",11)(13,"tbody"),ee(14,LJ,10,12,"tr",12),C()()(),T(15,"div",13)(16,"table",11)(17,"tfoot",14)(18,"tr",15)(19,"td",16),x(20,"Totals"),C(),T(21,"td",17)(22,"div",18),x(23),C()()()()()()()),n&2){let t=q();k(14),Q("ngForOf",t.deltaStints()),k(8),Q("ngClass",Ar(3,wb,t.totalDeltaMilliseconds()<0,t.totalDeltaMilliseconds()>=0)),k(),G(" ",t.getMillisecondsToTimeString(t.totalDeltaMilliseconds())," ")}}var sv=class n{stintService=S(Bt);deltaStintService=S(ov);deltaStints=this.deltaStintService.deltaStints;totalDeltaMilliseconds=this.deltaStintService.totalDeltaMilliseconds;activeStintId=Ae(()=>{let e=this.stintService.activeStint();if(e)return e.id});isOpen=!0;getMillisecondsToTimeString(e){return Mt(Math.abs(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-delta-stint"]],decls:10,vars:10,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default",3,"ngClass"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],["colspan","5",1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","text-black","font-mono"],[1,"p-1","text-center","text-white","rounded",3,"ngClass"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),x(3,"\u{1F9D0} Delta stint"),C(),T(4,"div",3)(5,"div",4),ee(6,OJ,1,0)(7,FJ,1,0),x(8),C()()(),ee(9,VJ,24,6,"div",5),C()),t&2&&(k(),Q("ngClass",tt(5,PJ,r.isOpen)),k(4),Q("ngClass",Ar(7,wb,r.totalDeltaMilliseconds()<0,r.totalDeltaMilliseconds()>=0)),k(),se(r.totalDeltaMilliseconds()<0?6:7),k(2),G(" ",r.getMillisecondsToTimeString(r.totalDeltaMilliseconds())," "),k(),se(r.isOpen?9:-1))},dependencies:[jn,rt],encapsulation:2})};var av=class n{stintService=S(Bt);pitService=S(Jt);stintOptimizerService=S(oi);raceConfigService=S(Ye);timelineSteps=J([]);constructor(){He({stints:me(this.stintService.stints),pits:me(this.pitService.pits),remainingDriverChanges:me(this.pitService.remainingDriverChanges),raceConfig:me(this.raceConfigService.activeRaceConfig),optimizedStint:me(this.stintOptimizerService.optimizedStint),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e,pits:t,remainingDriverChanges:r,raceConfig:i,optimizedStint:o})=>{let s=this.createRealSteps(e,t);if(s=s.sort((a,c)=>a.start.getTime()-c.start.getTime()),r>0&&o&&i){let a=this.createFutureSteps(s.at(s.length-1),r,o,i);s.push(...a)}s=s.sort((a,c)=>a.start.getTime()-c.start.getTime()),this.timelineSteps.set(s)})}createRealSteps(e,t){let r=[];return e.forEach(i=>{r.push(this.createTimelineStepFromStint(i))}),t.forEach(i=>{r.push(this.createTimelineStepFromPit(i))}),r}createTimelineStepFromPit(e){return{durationMills:e.exitTime?e.exitTime.toDate().getTime()-e.entryTime.toDate().getTime():void 0,end:e.exitTime?.toDate(),pit:e,start:e.entryTime.toDate(),status:e.exitTime?"DONE":"ACTIVE",stint:void 0,type:"PIT"}}createTimelineStepFromStint(e){return{durationMills:e.endDate?e.endDate.toDate().getTime()-e.startDate.toDate().getTime():void 0,end:e.endDate?.toDate(),pit:void 0,start:e.startDate.toDate(),status:e.endDate?"DONE":"ACTIVE",stint:e,type:"STINT"}}createFutureSteps(e,t,r,i){let o=[],s=this.calculateLastEndDateFromRealStep(e,r,i);if(e===void 0||e.type==="PIT"){let a=Vo(s,r.avgStintMillisecondsTime);o.push(this.createFutureStintStep(s,a,r.avgStintMillisecondsTime)),s=a}for(let a=0;a<t;a++){let c=ta(s,i.minPitSeconds);o.push(this.createFuturePitStep(s,c,Sg(i.minPitSeconds)));let u=Vo(c,r.avgStintMillisecondsTime);o.push(this.createFutureStintStep(c,u,r.avgStintMillisecondsTime)),s=u}return o}createFutureStintStep(e,t,r){return{durationMills:r,end:t,pit:void 0,start:e,status:"FUTURE",stint:void 0,type:"STINT"}}createFuturePitStep(e,t,r){return{durationMills:r,end:t,pit:void 0,start:e,status:"FUTURE",stint:void 0,type:"PIT"}}calculateLastEndDateFromRealStep(e,t,r){if(e===void 0)return new Date;let i;return e.type==="PIT"?i=ta(e.start,r.minPitSeconds):i=Vo(e.start,t.avgStintMillisecondsTime),i>new Date?i:new Date}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var cv=class n{text="";left=0;top=0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["tooltip"]],inputs:{text:"text",left:"left",top:"top"},decls:2,vars:5,consts:[[1,"fixed","whitespace-pre-line","bg-black","rounded","p-1","text-white","max-w-48","-translate-x-1/2","tooltip","mt-1"]],template:function(t,r){t&1&&(T(0,"div",0),x(1),C()),t&2&&(Qa("left",r.left+"px")("top",r.top+"px"),k(),G(" ",r.text,`
`))},styles:['.tooltip[_ngcontent-%COMP%]:before{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:5px solid black;position:absolute;left:calc(50% - 5px);top:-5px}']})};var lv=class n{elementRef=S(cr);viewContainerRef=S(vs);document=S(Un);tooltipText="";tooltipComponent;hideTooltipTimeout;onMouseEnter(){this.tooltipComponent||(this.tooltipComponent=this.viewContainerRef.createComponent(cv),this.document.body.appendChild(this.tooltipComponent.location.nativeElement),this.setTooltipComponentProperties(),this.tooltipComponent.hostView.detectChanges(),this.hideTooltipTimeout=setTimeout(()=>{this.removeTooltip()},1e3))}onMouseLeave(){this.removeTooltip()}removeTooltip(){this.tooltipComponent&&(this.tooltipComponent.destroy(),this.tooltipComponent=void 0,this.hideTooltipTimeout&&(clearTimeout(this.hideTooltipTimeout),this.hideTooltipTimeout=void 0))}setTooltipComponentProperties(){if(!this.tooltipComponent)return;this.tooltipComponent.instance.text=this.tooltipText;let e=this.elementRef.nativeElement.getBoundingClientRect(),r=this.tooltipComponent.location.nativeElement.getBoundingClientRect(),i=(e.right-e.left)/2+e.left-r.width/2,o=e.bottom;i+r.width>window.innerWidth&&(i=window.innerWidth-r.width),i<0&&(i=0),o+r.height>window.innerHeight&&(o=e.top-r.height),this.tooltipComponent.instance.left=i,this.tooltipComponent.instance.top=o}static \u0275fac=function(t){return new(t||n)};static \u0275dir=at({type:n,selectors:[["","tooltip",""]],hostBindings:function(t,r){t&1&&ce("mouseenter",function(){return r.onMouseEnter()})("mouseleave",function(){return r.onMouseLeave()})},inputs:{tooltipText:"tooltipText"}})};function UJ(n,e){if(n&1&&(T(0,"div",2),x(1),C()),n&2){let t=q().$implicit,r=q(2);Q("ngClass",r.getStintColor(t))("tooltipText",r.getStintTooltipInfo(t)),k(),mt(r.getStintText(t))}}function jJ(n,e){if(n&1&&(T(0,"div",3),x(1),C()),n&2){let t=q().$implicit,r=q(2);Q("ngClass",r.getPitColor(t))("tooltipText",r.getPitTooltipInfo(t)),k(),mt(r.getPitText(t))}}function BJ(n,e){if(n&1&&(Z_(0),ee(1,UJ,2,3,"div",2)(2,jJ,2,3,"div",3),J_()),n&2){let t=e.$implicit;k(),se(t.type==="STINT"?1:2)}}function $J(n,e){if(n&1&&(T(0,"div",0),ee(1,BJ,3,1,"ng-container",1),C()),n&2){let t=q();k(),Q("ngForOf",t.timelineSteps())}}var uv=class n{timelineService=S(av);timelineSteps=this.timelineService.timelineSteps;hide=!1;constructor(){window.addEventListener("resize",this.onResize.bind(this))}onResize(){this.hide=window.innerWidth<=1460}getStintColor(e){return e.status==="DONE"?"bg-blue-400":e.status==="FUTURE"?"bg-blue-100":"bg-green-500"}getStintText(e){return e.status==="ACTIVE"?"\u{1F3CE}\uFE0F":"\u23F3"}getStintTooltipInfo(e){let t="Start: "+bg(e.start,"HH:mm:ss"),r=e.end?"End: "+bg(e.end,"HH:mm:ss"):"",i=e.durationMills?"On Track: "+Mt(e.durationMills):"";return r.length>0&&(t+=`
`),i.length>0&&(r+=`
`),t+r+i}getPitColor(e){return e.status==="DONE"?"bg-amber-400":e.status==="FUTURE"?"bg-amber-100":"bg-green-500"}getPitText(e){return e.status==="ACTIVE"?"\u{1F17F}\uFE0F":"\u{1F468}\u{1F3FB}\u200D\u{1F527}"}getPitTooltipInfo(e){let t="Enter: "+bg(e.start,"HH:mm:ss"),r=e.durationMills?"Time: "+Mt(e.durationMills):"",i="";return e.pit&&(i+="\u{1F417} -> "+(e.pit.entryDriverId!==e.pit.exitDriverId?"\u2705":"")+`
`,i+="\u26FD\uFE0F -> "+(e.pit.refuel?"\u2705":"")+`
`,i+="\u{1F6DE} -> "+(e.pit.tyreChange?"\u2705":"")),r.length>0&&(t+=`
`),i.length>0&&(r+=`
`),t+r+i}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-timeline"]],decls:1,vars:1,consts:[[1,"mb-3","flex","justify-center","items-center"],[4,"ngFor","ngForOf"],["tooltip","",1,"flex-1","flex","px-1","py-3","justify-center","items-center",3,"ngClass","tooltipText"],["tooltip","",1,"flex-0","flex","px-1","py-3","justify-center","items-center",3,"ngClass","tooltipText"]],template:function(t,r){t&1&&ee(0,$J,2,1,"div",0),t&2&&se(r.hide?-1:0)},dependencies:[jn,rt,lv],encapsulation:2})};var dv=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Le({type:n,selectors:[["app-root"]],decls:38,vars:0,consts:[[1,"w-full","h-full","min-h-full","dark:bg-black"],[1,"p-4","grid","grid-cols-2","lg:grid-cols-3","gap-3"],[1,"text-xl","md:text-3xl","dark:text-white","font-semibold"],[1,"text-right","lg:text-center"],[1,"mx-4","grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3","mb-4"],[1,"flex-col","md:h-fit"],[1,"mb-3","lg:mb-4"],[1,"lg:mb-4"],[1,"flex-col"],[1,"flex","flex-col","justify-center","items-center"],["src","assets/cremona_circuit.jpg","alt","Circuito",1,"max-w-sm","md:max-w-md"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1)(2,"div",2),x(3,"\u{1F3CE}\uFE0F dash-boar \u{1F417}"),C(),T(4,"div",3),Ce(5,"app-race"),C()(),Ce(6,"app-timeline"),T(7,"div",4)(8,"div",5)(9,"div",6),Ce(10,"app-pit-lane"),C(),T(11,"div",6),Ce(12,"app-driver-change"),C(),T(13,"div",6),Ce(14,"app-tyre-change-window"),C(),T(15,"div",7),Ce(16,"app-pit"),C()(),T(17,"div",8)(18,"div",6),Ce(19,"app-fuel"),C(),T(20,"div",6),Ce(21,"app-stint-optimizer"),C(),T(22,"div",6),Ce(23,"app-lap"),C(),T(24,"div",7),Ce(25,"app-driver"),C()(),T(26,"div",8)(27,"div",6),Ce(28,"app-active-stint"),C(),T(29,"div",6),Ce(30,"app-stint"),C(),T(31,"div",7),Ce(32,"app-delta-stint"),C()()(),T(33,"div",9)(34,"div",2),x(35,"Cremona kart circuit"),C(),Ce(36,"img",10),C()(),Ce(37,"router-outlet"))},dependencies:[Gw,qg,Wg,Kg,Yg,Qg,Xg,ev,tv,nv,rv,iv,sv,uv],encapsulation:2})};$x(dv,GF).catch(n=>console.error(n));
