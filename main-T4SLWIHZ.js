import{$ as zt,A as qt,B as Bn,C as ul,D as mt,E as XT,F as eC,G as $n,H as Ai,I as Ha,J as qa,K as za,L as Ri,M as tC,N as nC,O as rC,P as iC,Q as Ga,R as Wa,S as fe,T as Je,U as At,V as Hn,W as Lp,X as ll,Y as Xe,Z as rt,_ as fr,a as V,aa as sC,b as Ae,ba as it,c as Hr,ca as dl,d as y,da as q,e as F,ea as oC,f as Ls,g as zT,h as GT,i as WT,j as KT,k as QT,l as qr,m as Op,n as Fp,o as Vs,p as St,q as ja,r as YT,s as Ba,t as cl,u as ZT,v as jn,w as JT,x as hr,y as Si,z as $a}from"./chunk-VUN4IAWB.js";function aC(t,e){return Object.is(t,e)}var ht=null,Ka=!1,hl=1,pr=Symbol("SIGNAL");function pe(t){let e=ht;return ht=t,e}function cC(){return ht}function Gk(){return Ka}var Us={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Bp(t){if(Ka)throw new Error("");if(ht===null)return;ht.consumerOnSignalRead(t);let e=ht.nextProducerIndex++;if(yl(ht),e<ht.producerNode.length&&ht.producerNode[e]!==t&&Qa(ht)){let n=ht.producerNode[e];_l(n,ht.producerIndexOfThis[e])}ht.producerNode[e]!==t&&(ht.producerNode[e]=t,ht.producerIndexOfThis[e]=Qa(ht)?fC(t,ht,e):0),ht.producerLastReadVersion[e]=t.version}function Wk(){hl++}function uC(t){if(!(Qa(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===hl)){if(!t.producerMustRecompute(t)&&!gl(t)){t.dirty=!1,t.lastCleanEpoch=hl;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=hl}}function lC(t){if(t.liveConsumerNode===void 0)return;let e=Ka;Ka=!0;try{for(let n of t.liveConsumerNode)n.dirty||hC(n)}finally{Ka=e}}function dC(){return ht?.consumerAllowSignalWrites!==!1}function hC(t){t.dirty=!0,lC(t),t.consumerMarkedDirty?.(t)}function Ya(t){return t&&(t.nextProducerIndex=0),pe(t)}function pl(t,e){if(pe(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Qa(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)_l(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function gl(t){yl(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(uC(n),r!==n.version))return!0}return!1}function ml(t){if(yl(t),Qa(t))for(let e=0;e<t.producerNode.length;e++)_l(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function fC(t,e,n){if(pC(t),t.liveConsumerNode.length===0&&gC(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=fC(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(n),t.liveConsumerNode.push(e)-1}function _l(t,e){if(pC(t),t.liveConsumerNode.length===1&&gC(t))for(let r=0;r<t.producerNode.length;r++)_l(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];yl(i),i.producerIndexOfThis[r]=e}}function Qa(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function yl(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function pC(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function gC(t){return t.producerNode!==void 0}function mC(t){let e=Object.create(Kk);e.computation=t;let n=()=>{if(uC(e),Bp(e),e.value===fl)throw e.error;return e.value};return n[pr]=e,n}var Vp=Symbol("UNSET"),Up=Symbol("COMPUTING"),fl=Symbol("ERRORED"),Kk=Ae(V({},Us),{value:Vp,dirty:!0,error:null,equal:aC,producerMustRecompute(t){return t.value===Vp||t.value===Up},producerRecomputeValue(t){if(t.value===Up)throw new Error("Detected cycle in computations.");let e=t.value;t.value=Up;let n=Ya(t),r;try{r=t.computation()}catch(i){r=fl,t.error=i}finally{pl(t,n)}if(e!==Vp&&e!==fl&&r!==fl&&t.equal(e,r)){t.value=e;return}t.value=r,t.version++}});function Qk(){throw new Error}var _C=Qk;function yC(){_C()}function vC(t){_C=t}var Yk=null;function IC(t){let e=Object.create(EC);e.value=t;let n=()=>(Bp(e),e.value);return n[pr]=e,n}function $p(t,e){dC()||yC(),t.equal(t.value,e)||(t.value=e,Zk(t))}function wC(t,e){dC()||yC(),$p(t,e(t.value))}var EC=Ae(V({},Us),{equal:aC,value:void 0});function Zk(t){t.version++,Wk(),lC(t),Yk?.()}function TC(t,e,n){let r=Object.create(Jk);n&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=e;let i=c=>{r.cleanupFn=c};function s(c){return c.fn===null&&c.schedule===null}function o(c){s(c)||(ml(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=jp)}let a=()=>{if(r.fn===null)return;if(Gk())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!gl(r))return;r.hasRun=!0;let c=Ya(r);try{r.cleanupFn(),r.cleanupFn=jp,r.fn(i)}finally{pl(r,c)}};return r.ref={notify:()=>hC(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>o(r),[pr]:r},r.ref}var jp=()=>{},Jk=Ae(V({},Us),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule!==null&&t.schedule(t.ref)},hasRun:!1,cleanupFn:jp});function ie(t){return typeof t=="function"}function js(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var vl=js(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Ni(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var We=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(ie(r))try{r()}catch(s){e=s instanceof vl?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{CC(s)}catch(o){e=e??[],o instanceof vl?e=[...e,...o.errors]:e.push(o)}}if(e)throw new vl(e)}}add(e){var n;if(e&&e!==this)if(this.closed)CC(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Ni(n,e)}remove(e){let{_finalizers:n}=this;n&&Ni(n,e),e instanceof t&&e._removeParent(this)}};We.EMPTY=(()=>{let t=new We;return t.closed=!0,t})();var Hp=We.EMPTY;function Il(t){return t instanceof We||t&&"closed"in t&&ie(t.remove)&&ie(t.add)&&ie(t.unsubscribe)}function CC(t){ie(t)?t():t.unsubscribe()}var Dn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Bs={setTimeout(t,e,...n){let{delegate:r}=Bs;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Bs;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function wl(t){Bs.setTimeout(()=>{let{onUnhandledError:e}=Dn;if(e)e(t);else throw t})}function Za(){}var bC=qp("C",void 0,void 0);function DC(t){return qp("E",void 0,t)}function SC(t){return qp("N",t,void 0)}function qp(t,e,n){return{kind:t,value:e,error:n}}var Pi=null;function $s(t){if(Dn.useDeprecatedSynchronousErrorHandling){let e=!Pi;if(e&&(Pi={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Pi;if(Pi=null,n)throw r}}else t()}function AC(t){Dn.useDeprecatedSynchronousErrorHandling&&Pi&&(Pi.errorThrown=!0,Pi.error=t)}var Mi=class extends We{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Il(e)&&e.add(this)):this.destination=tO}static create(e,n,r){return new Hs(e,n,r)}next(e){this.isStopped?Gp(SC(e),this):this._next(e)}error(e){this.isStopped?Gp(DC(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Gp(bC,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Xk=Function.prototype.bind;function zp(t,e){return Xk.call(t,e)}var Wp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){El(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){El(r)}else El(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){El(n)}}},Hs=class extends Mi{constructor(e,n,r){super();let i;if(ie(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Dn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&zp(e.next,s),error:e.error&&zp(e.error,s),complete:e.complete&&zp(e.complete,s)}):i=e}this.destination=new Wp(i)}};function El(t){Dn.useDeprecatedSynchronousErrorHandling?AC(t):wl(t)}function eO(t){throw t}function Gp(t,e){let{onStoppedNotification:n}=Dn;n&&Bs.setTimeout(()=>n(t,e))}var tO={closed:!0,next:Za,error:eO,complete:Za};var qs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Lt(t){return t}function Tl(...t){return Kp(t)}function Kp(t){return t.length===0?Lt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ae=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=rO(n)?n:new Hs(n,r,i);return $s(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=RC(r),new r((i,s)=>{let o=new Hs({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[qs](){return this}pipe(...n){return Kp(n)(this)}toPromise(n){return n=RC(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function RC(t){var e;return(e=t??Dn.Promise)!==null&&e!==void 0?e:Promise}function nO(t){return t&&ie(t.next)&&ie(t.error)&&ie(t.complete)}function rO(t){return t&&t instanceof Mi||nO(t)&&Il(t)}function Qp(t){return ie(t?.lift)}function ce(t){return e=>{if(Qp(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(t,e,n,r,i){return new Ja(t,e,n,r,i)}var Ja=class extends Mi{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function zs(){return ce((t,e)=>{let n=null;t._refCount++;let r=ue(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Gs=class extends ae{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Qp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new We;let n=this.getSubject();e.add(this.source.subscribe(ue(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=We.EMPTY)}return e}refCount(){return zs()(this)}};var NC=js(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $e=(()=>{class t extends ae{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Cl(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new NC}next(n){$s(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){$s(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){$s(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Hp:(this.currentObservers=null,s.push(n),new We(()=>{this.currentObservers=null,Ni(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ae;return n.source=this,n}}return t.create=(e,n)=>new Cl(e,n),t})(),Cl=class extends $e{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Hp}};var It=class extends $e{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Xa={now(){return(Xa.delegate||Date).now()},delegate:void 0};var ec=class extends $e{constructor(e=1/0,n=1/0,r=Xa){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var bl=class extends We{constructor(e,n){super()}schedule(e,n=0){return this}};var tc={setInterval(t,e,...n){let{delegate:r}=tc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=tc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Ws=class extends bl{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return tc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&tc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Ni(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Ks=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Ks.now=Xa.now;var Qs=class extends Ks{constructor(e,n=Ks.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Yp=new Qs(Ws);var Dl=class extends Ws{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Sl=class extends Qs{};var Zp=new Sl(Dl);var en=new ae(t=>t.complete());function PC(t){return t&&ie(t.schedule)}function MC(t){return t[t.length-1]}function xC(t){return ie(MC(t))?t.pop():void 0}function zr(t){return PC(MC(t))?t.pop():void 0}function Jp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function OC(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(p){o(p)}}function c(d){try{l(r.throw(d))}catch(p){o(p)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function kC(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xi(t){return this instanceof xi?(this.v=t,this):new xi(t)}function FC(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,p)}}function a(_,E){r[_]&&(i[_]=function(R){return new Promise(function(A,x){s.push([_,R,A,x])>1||c(_,R)})},E&&(i[_]=E(i[_])))}function c(_,E){try{l(r[_](E))}catch(R){g(s[0][3],R)}}function l(_){_.value instanceof xi?Promise.resolve(_.value.v).then(d,p):g(s[0][2],_)}function d(_){c("next",_)}function p(_){c("throw",_)}function g(_,E){_(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function LC(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof kC=="function"?kC(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Al=t=>t&&typeof t.length=="number"&&typeof t!="function";function Rl(t){return ie(t?.then)}function Nl(t){return ie(t[qs])}function Pl(t){return Symbol.asyncIterator&&ie(t?.[Symbol.asyncIterator])}function Ml(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function iO(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var xl=iO();function kl(t){return ie(t?.[xl])}function Ol(t){return FC(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield xi(n.read());if(i)return yield xi(void 0);yield yield xi(r)}}finally{n.releaseLock()}})}function Fl(t){return ie(t?.getReader)}function st(t){if(t instanceof ae)return t;if(t!=null){if(Nl(t))return sO(t);if(Al(t))return oO(t);if(Rl(t))return aO(t);if(Pl(t))return VC(t);if(kl(t))return cO(t);if(Fl(t))return uO(t)}throw Ml(t)}function sO(t){return new ae(e=>{let n=t[qs]();if(ie(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function oO(t){return new ae(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function aO(t){return new ae(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,wl)})}function cO(t){return new ae(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function VC(t){return new ae(e=>{lO(t,e).catch(n=>e.error(n))})}function uO(t){return VC(Ol(t))}function lO(t,e){var n,r,i,s;return OC(this,void 0,void 0,function*(){try{for(n=LC(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Gt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Gr(t,e=0){return ce((n,r)=>{n.subscribe(ue(r,i=>Gt(r,t,()=>r.next(i),e),()=>Gt(r,t,()=>r.complete(),e),i=>Gt(r,t,()=>r.error(i),e)))})}function Wr(t,e=0){return ce((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function UC(t,e){return st(t).pipe(Wr(e),Gr(e))}function jC(t,e){return st(t).pipe(Wr(e),Gr(e))}function BC(t,e){return new ae(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function $C(t,e){return new ae(n=>{let r;return Gt(n,e,()=>{r=t[xl](),Gt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>ie(r?.return)&&r.return()})}function Ll(t,e){if(!t)throw new Error("Iterable cannot be null");return new ae(n=>{Gt(n,e,()=>{let r=t[Symbol.asyncIterator]();Gt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function HC(t,e){return Ll(Ol(t),e)}function qC(t,e){if(t!=null){if(Nl(t))return UC(t,e);if(Al(t))return BC(t,e);if(Rl(t))return jC(t,e);if(Pl(t))return Ll(t,e);if(kl(t))return $C(t,e);if(Fl(t))return HC(t,e)}throw Ml(t)}function Ke(t,e){return e?qC(t,e):st(t)}function K(...t){let e=zr(t);return Ke(t,e)}function Ys(t,e){let n=ie(t)?t:()=>t,r=i=>i.error(n());return new ae(e?i=>e.schedule(r,0,i):r)}function Xp(t){return!!t&&(t instanceof ae||ie(t.lift)&&ie(t.subscribe))}var gr=js(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Q(t,e){return ce((n,r)=>{let i=0;n.subscribe(ue(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:dO}=Array;function hO(t,e){return dO(e)?t(...e):t(e)}function zC(t){return Q(e=>hO(t,e))}var{isArray:fO}=Array,{getPrototypeOf:pO,prototype:gO,keys:mO}=Object;function GC(t){if(t.length===1){let e=t[0];if(fO(e))return{args:e,keys:null};if(_O(e)){let n=mO(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function _O(t){return t&&typeof t=="object"&&pO(t)===gO}function WC(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Zs(...t){let e=zr(t),n=xC(t),{args:r,keys:i}=GC(t);if(r.length===0)return Ke([],e);let s=new ae(yO(r,e,i?o=>WC(i,o):Lt));return n?s.pipe(zC(n)):s}function yO(t,e,n=Lt){return r=>{KC(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)KC(e,()=>{let l=Ke(t[c],e),d=!1;l.subscribe(ue(r,p=>{s[c]=p,d||(d=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function KC(t,e,n){t?Gt(n,t,e):e()}function QC(t,e,n,r,i,s,o,a){let c=[],l=0,d=0,p=!1,g=()=>{p&&!c.length&&!l&&e.complete()},_=R=>l<r?E(R):c.push(R),E=R=>{s&&e.next(R),l++;let A=!1;st(n(R,d++)).subscribe(ue(e,x=>{i?.(x),s?_(x):e.next(x)},()=>{A=!0},void 0,()=>{if(A)try{for(l--;c.length&&l<r;){let x=c.shift();o?Gt(e,o,()=>E(x)):E(x)}g()}catch(x){e.error(x)}}))};return t.subscribe(ue(e,_,()=>{p=!0,g()})),()=>{a?.()}}function et(t,e,n=1/0){return ie(e)?et((r,i)=>Q((s,o)=>e(r,s,i,o))(st(t(r,i))),n):(typeof e=="number"&&(n=e),ce((r,i)=>QC(r,i,t,n)))}function eg(t=1/0){return et(Lt,t)}function YC(){return eg(1)}function Js(...t){return YC()(Ke(t,zr(t)))}function Vl(t){return new ae(e=>{st(t()).subscribe(e)})}function Vt(t,e){return ce((n,r)=>{let i=0;n.subscribe(ue(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Kr(t){return ce((e,n)=>{let r=null,i=!1,s;r=e.subscribe(ue(n,void 0,void 0,o=>{s=st(t(o,Kr(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function ZC(t,e,n,r,i){return(s,o)=>{let a=n,c=e,l=0;s.subscribe(ue(o,d=>{let p=l++;c=a?t(c,d,p):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ki(t,e){return ie(e)?et(t,e,1):et(t,1)}function Qr(t){return ce((e,n)=>{let r=!1;e.subscribe(ue(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function mr(t){return t<=0?()=>en:ce((e,n)=>{let r=0;e.subscribe(ue(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function tg(t){return Q(()=>t)}function Ul(t,e=Lt){return t=t??vO,ce((n,r)=>{let i,s=!0;n.subscribe(ue(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function vO(t,e){return t===e}function jl(t=IO){return ce((e,n)=>{let r=!1;e.subscribe(ue(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function IO(){return new gr}function nc(t){return ce((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function qn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Vt((i,s)=>t(i,s,r)):Lt,mr(1),n?Qr(e):jl(()=>new gr))}function ng(t,e,n,r){return ce((i,s)=>{let o;!e||typeof e=="function"?o=e:{duration:n,element:o,connector:r}=e;let a=new Map,c=E=>{a.forEach(E),E(s)},l=E=>c(R=>R.error(E)),d=0,p=!1,g=new Ja(s,E=>{try{let R=t(E),A=a.get(R);if(!A){a.set(R,A=r?r():new $e);let x=_(R,A);if(s.next(x),n){let L=ue(A,()=>{A.complete(),L?.unsubscribe()},void 0,void 0,()=>a.delete(R));g.add(st(n(x)).subscribe(L))}}A.next(o?o(E):E)}catch(R){l(R)}},()=>c(E=>E.complete()),l,()=>a.clear(),()=>(p=!0,d===0));i.subscribe(g);function _(E,R){let A=new ae(x=>{d++;let L=R.subscribe(x);return()=>{L.unsubscribe(),--d===0&&p&&g.unsubscribe()}});return A.key=E,A}})}function Xs(t){return t<=0?()=>en:ce((e,n)=>{let r=[];e.subscribe(ue(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function rg(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Vt((i,s)=>t(i,s,r)):Lt,Xs(1),n?Qr(e):jl(()=>new gr))}function Bl(){return ce((t,e)=>{let n,r=!1;t.subscribe(ue(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function $l(t,e){return ce(ZC(t,e,arguments.length>=2,!0))}function eo(...t){let e=zr(t);return ce((n,r)=>{(e?Js(t,n,e):Js(t,n)).subscribe(r)})}function Wt(t,e){return ce((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(ue(r,c=>{i?.unsubscribe();let l=0,d=s++;st(t(c,d)).subscribe(i=ue(r,p=>r.next(e?e(c,p,d,l++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function tn(t){return ce((e,n)=>{st(t).subscribe(ue(n,()=>n.complete(),Za)),!n.closed&&e.subscribe(n)})}function ft(t,e,n){let r=ie(t)||e||n?{next:t,error:e,complete:n}:t;return r?ce((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ue(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Lt}var W=class extends Error{constructor(e,n){super(Qg(e,n)),this.code=e}};function Qg(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function Id(t){return{toString:t}.toString()}var Hl="__parameters__";function wO(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function EO(t,e,n){return Id(()=>{let r=wO(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let p=c.hasOwnProperty(Hl)?c[Hl]:Object.defineProperty(c,Hl,{value:[]})[Hl];for(;p.length<=d;)p.push(null);return(p[d]=p[d]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var rc=globalThis;function Me(t){for(let e in t)if(t[e]===Me)return e;throw Error("Could not find renamed property on target object.")}function nn(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(nn).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function JC(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var TO=Me({__forward_ref__:Me});function Mb(t){return t.__forward_ref__=Mb,t.toString=function(){return nn(this())},t}function fn(t){return xb(t)?t():t}function xb(t){return typeof t=="function"&&t.hasOwnProperty(TO)&&t.__forward_ref__===Mb}function H(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function wd(t){return XC(t,Ob)||XC(t,Fb)}function kb(t){return wd(t)!==null}function XC(t,e){return t.hasOwnProperty(e)?t[e]:null}function CO(t){let e=t&&(t[Ob]||t[Fb]);return e||null}function eb(t){return t&&(t.hasOwnProperty(tb)||t.hasOwnProperty(bO))?t[tb]:null}var Ob=Me({\u0275prov:Me}),tb=Me({\u0275inj:Me}),Fb=Me({ngInjectableDef:Me}),bO=Me({ngInjectorDef:Me}),U=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=H({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Lb(t){return t&&!!t.\u0275providers}var DO=Me({\u0275cmp:Me}),SO=Me({\u0275dir:Me}),AO=Me({\u0275pipe:Me}),RO=Me({\u0275mod:Me}),Zl=Me({\u0275fac:Me}),oc=Me({__NG_ELEMENT_ID__:Me}),nb=Me({__NG_ENV_ID__:Me});function Vb(t){return typeof t=="string"?t:t==null?"":String(t)}function NO(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Vb(t)}function PO(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new W(-200,t)}function Yg(t,e){throw new W(-201,!1)}var le=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(le||{}),hg;function Ub(){return hg}function Kt(t){let e=hg;return hg=t,e}function jb(t,e,n){let r=wd(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&le.Optional)return null;if(e!==void 0)return e;Yg(t,"Injector")}var MO={},ac=MO,fg="__NG_DI_FLAG__",Jl="ngTempTokenPath",xO="ngTokenPath",kO=/\n/gm,OO="\u0275",rb="__source",io;function FO(){return io}function Yr(t){let e=io;return io=t,e}function LO(t,e=le.Default){if(io===void 0)throw new W(-203,!1);return io===null?jb(t,void 0,e):io.get(t,e&le.Optional?null:void 0,e)}function J(t,e=le.Default){return(Ub()||LO)(fn(t),e)}function M(t,e=le.Default){return J(t,Ed(e))}function Ed(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function pg(t){let e=[];for(let n=0;n<t.length;n++){let r=fn(t[n]);if(Array.isArray(r)){if(r.length===0)throw new W(900,!1);let i,s=le.Default;for(let o=0;o<r.length;o++){let a=r[o],c=UO(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(J(i,s))}else e.push(J(r))}return e}function VO(t,e){return t[fg]=e,t.prototype[fg]=e,t}function UO(t){return t[fg]}function jO(t,e,n,r){let i=t[Jl];throw e[rb]&&i.unshift(e[rb]),t.message=BO(`
`+t.message,i,n,r),t[xO]=i,t[Jl]=null,t}function BO(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==OO?t.slice(2):t;let i=nn(e);if(Array.isArray(e))i=e.map(nn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):nn(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(kO,`
  `)}`}var ee=VO(EO("Optional"),8);function Vi(t,e){let n=t.hasOwnProperty(Zl);return n?t[Zl]:null}function Zg(t,e){t.forEach(n=>Array.isArray(n)?Zg(n,e):e(n))}function Bb(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Xl(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var cc={},oo=[],ao=new U(""),$b=new U("",-1),Hb=new U(""),ed=class{get(e,n=ac){if(n===ac){let r=new Error(`NullInjectorError: No provider for ${nn(e)}!`);throw r.name="NullInjectorError",r}return n}},qb=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(qb||{}),Wn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Wn||{}),Jr=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Jr||{});function $O(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function gg(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];qO(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function HO(t){return t===3||t===4||t===6}function qO(t){return t.charCodeAt(0)===64}function Jg(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?ib(t,n,i,null,e[++r]):ib(t,n,i,null,null))}}return t}function ib(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var zb="ng-template";function zO(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&$O(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(Xg(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function Xg(t){return t.type===4&&t.value!==zb}function GO(t,e,n){let r=t.type===4&&!n?zb:t.value;return e===r}function WO(t,e,n){let r=4,i=t.attrs,s=i!==null?YO(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Sn(r)&&!Sn(c))return!1;if(o&&Sn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!GO(t,c,n)||c===""&&e.length===1){if(Sn(r))return!1;o=!0}}else if(r&8){if(i===null||!zO(t,i,c,n)){if(Sn(r))return!1;o=!0}}else{let l=e[++a],d=KO(c,i,Xg(t),n);if(d===-1){if(Sn(r))return!1;o=!0;continue}if(l!==""){let p;if(d>s?p="":p=i[d+1].toLowerCase(),r&2&&l!==p){if(Sn(r))return!1;o=!0}}}}return Sn(r)||o}function Sn(t){return(t&1)===0}function KO(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return ZO(e,t)}function QO(t,e,n=!1){for(let r=0;r<e.length;r++)if(WO(t,e[r],n))return!0;return!1}function YO(t){for(let e=0;e<t.length;e++){let n=t[e];if(HO(n))return e}return t.length}function ZO(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function sb(t,e){return t?":not("+e.trim()+")":e}function JO(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Sn(o)&&(e+=sb(s,i),i=""),r=o,s=s||!Sn(r);n++}return i!==""&&(e+=sb(s,i)),e}function XO(t){return t.map(JO).join(",")}function e1(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Sn(i))break;i=s}r++}return{attrs:e,classes:n}}function ni(t){return Id(()=>{let e=Zb(t),n=Ae(V({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===qb.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Wn.Emulated,styles:t.styles||oo,_:null,schemas:t.schemas||null,tView:null,id:""});Jb(n);let r=t.dependencies;return n.directiveDefs=ab(r,!1),n.pipeDefs=ab(r,!0),n.id=r1(n),n})}function t1(t){return Ui(t)||Wb(t)}function n1(t){return t!==null}function ob(t,e){if(t==null)return cc;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Jr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Jr.None?[r,a]:r,e[s]=o):n[s]=r}return n}function em(t){return Id(()=>{let e=Zb(t);return Jb(e),e})}function Gb(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone===!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function Ui(t){return t[DO]||null}function Wb(t){return t[SO]||null}function Kb(t){return t[AO]||null}function Qb(t){let e=Ui(t)||Wb(t)||Kb(t);return e!==null?e.standalone:!1}function Yb(t,e){let n=t[RO]||null;if(!n&&e===!0)throw new Error(`Type ${nn(t)} does not have '\u0275mod' property.`);return n}function Zb(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||cc,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||oo,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ob(t.inputs,e),outputs:ob(t.outputs),debugInfo:null}}function Jb(t){t.features?.forEach(e=>e(t))}function ab(t,e){if(!t)return null;let n=e?Kb:t1;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(n1)}function r1(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Oe(t){return{\u0275providers:t}}function i1(...t){return{\u0275providers:Xb(!0,t),\u0275fromNgModule:!0}}function Xb(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Zg(e,o=>{let a=o;mg(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&eD(i,s),n}function eD(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];tm(i,s=>{e(s,r)})}}function mg(t,e,n,r){if(t=fn(t),!t)return!1;let i=null,s=eb(t),o=!s&&Ui(t);if(!s&&!o){let c=t.ngModule;if(s=eb(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)mg(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Zg(s.imports,d=>{mg(d,e,n,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&eD(l,e)}if(!a){let l=Vi(i)||(()=>new i);e({provide:i,useFactory:l,deps:oo},i),e({provide:Hb,useValue:i,multi:!0},i),e({provide:ao,useValue:()=>J(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=t;tm(c,d=>{e(d,l)})}}else return!1;return i!==t&&t.providers!==void 0}function tm(t,e){for(let n of t)Lb(n)&&(n=n.\u0275providers),Array.isArray(n)?tm(n,e):e(n)}var s1=Me({provide:String,useValue:Me});function tD(t){return t!==null&&typeof t=="object"&&s1 in t}function o1(t){return!!(t&&t.useExisting)}function a1(t){return!!(t&&t.useFactory)}function _g(t){return typeof t=="function"}var Td=new U(""),zl={},c1={},ig;function nm(){return ig===void 0&&(ig=new ed),ig}var gn=class{},uc=class extends gn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,vg(e,o=>this.processProvider(o)),this.records.set($b,to(void 0,this)),i.has("environment")&&this.records.set(gn,to(void 0,this));let s=this.records.get(Td);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Hb,oo,le.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=pe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),pe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Yr(this),r=Kt(void 0),i;try{return e()}finally{Yr(n),Kt(r)}}get(e,n=ac,r=le.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(nb))return e[nb](this);r=Ed(r);let i,s=Yr(this),o=Kt(void 0);try{if(!(r&le.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=p1(e)&&wd(e);l&&this.injectableDefInScope(l)?c=to(yg(e),zl):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&le.Self?nm():this.parent;return n=r&le.Optional&&n===ac?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Jl]=a[Jl]||[]).unshift(nn(e)),s)throw a;return jO(a,e,"R3InjectorError",this.source)}else throw a}finally{Kt(o),Yr(s)}}resolveInjectorInitializers(){let e=pe(null),n=Yr(this),r=Kt(void 0),i;try{let s=this.get(ao,oo,le.Self);for(let o of s)o()}finally{Yr(n),Kt(r),pe(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(nn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new W(205,!1)}processProvider(e){e=fn(e);let n=_g(e)?e:fn(e&&e.provide),r=l1(e);if(!_g(e)&&e.multi===!0){let i=this.records.get(n);i||(i=to(void 0,zl,!0),i.factory=()=>pg(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=pe(null);try{return n.value===zl&&(n.value=c1,n.value=n.factory()),typeof n.value=="object"&&n.value&&f1(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{pe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=fn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function yg(t){let e=wd(t),n=e!==null?e.factory:Vi(t);if(n!==null)return n;if(t instanceof U)throw new W(204,!1);if(t instanceof Function)return u1(t);throw new W(204,!1)}function u1(t){if(t.length>0)throw new W(204,!1);let n=CO(t);return n!==null?()=>n.factory(t):()=>new t}function l1(t){if(tD(t))return to(void 0,t.useValue);{let e=d1(t);return to(e,zl)}}function d1(t,e,n){let r;if(_g(t)){let i=fn(t);return Vi(i)||yg(i)}else if(tD(t))r=()=>fn(t.useValue);else if(a1(t))r=()=>t.useFactory(...pg(t.deps||[]));else if(o1(t))r=()=>J(fn(t.useExisting));else{let i=fn(t&&(t.useClass||t.provide));if(h1(t))r=()=>new i(...pg(t.deps));else return Vi(i)||yg(i)}return r}function to(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function h1(t){return!!t.deps}function f1(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function p1(t){return typeof t=="function"||typeof t=="object"&&t instanceof U}function vg(t,e){for(let n of t)Array.isArray(n)?vg(n,e):n&&Lb(n)?vg(n.\u0275providers,e):e(n)}function yr(t,e){t instanceof uc&&t.assertNotDestroyed();let n,r=Yr(t),i=Kt(void 0);try{return e()}finally{Yr(r),Kt(i)}}function nD(){return Ub()!==void 0||FO()!=null}function Cd(t){if(!nD())throw new W(-203,!1)}function g1(t){return typeof t=="function"}var vr=0,de=1,ne=2,jt=3,An=4,Rn=5,td=6,nd=7,mn=8,co=9,_r=10,sn=11,lc=12,cb=13,go=14,Kn=15,uo=16,no=17,lo=18,bd=19,rD=20,Zr=21,Gl=22,pn=23,_n=25,iD=1;var ji=7,rd=8,id=9,rn=10,sd=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(sd||{});function Fi(t){return Array.isArray(t)&&typeof t[iD]=="object"}function Ir(t){return Array.isArray(t)&&t[iD]===!0}function sD(t){return(t.flags&4)!==0}function rm(t){return t.componentOffset>-1}function im(t){return(t.flags&1)===1}function gc(t){return!!t.template}function Ig(t){return(t[ne]&512)!==0}var wg=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function oD(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Dd(){return aD}function aD(t){return t.type.prototype.ngOnChanges&&(t.setInput=_1),m1}Dd.ngInherit=!0;function m1(){let t=uD(this),e=t?.current;if(e){let n=t.previous;if(n===cc)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function _1(t,e,n,r,i){let s=this.declaredInputs[r],o=uD(t)||y1(t,{previous:cc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new wg(l&&l.currentValue,n,c===cc),oD(t,e,i,n)}var cD="__ngSimpleChanges__";function uD(t){return t[cD]||null}function y1(t,e){return t[cD]=e}var ub=null;var zn=function(t,e,n){ub?.(t,e,n)},v1="svg",I1="math";function Qn(t){for(;Array.isArray(t);)t=t[vr];return t}function w1(t,e){return Qn(e[t])}function Zn(t,e){return Qn(e[t.index])}function lD(t,e){return t.data[e]}function E1(t,e){return t[e]}function mo(t,e){let n=e[t];return Fi(n)?n:n[vr]}function sm(t){return(t[ne]&128)===128}function T1(t){return Ir(t[jt])}function od(t,e){return e==null?null:t[e]}function dD(t){t[no]=0}function hD(t){t[ne]&1024||(t[ne]|=1024,sm(t)&&Ad(t))}function C1(t,e){for(;t>0;)e=e[go],t--;return e}function Sd(t){return!!(t[ne]&9216||t[pn]?.dirty)}function Eg(t){t[_r].changeDetectionScheduler?.notify(8),t[ne]&64&&(t[ne]|=1024),Sd(t)&&Ad(t)}function Ad(t){t[_r].changeDetectionScheduler?.notify(0);let e=Bi(t);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!sm(e)));)e=Bi(e)}function fD(t,e){if((t[ne]&256)===256)throw new W(911,!1);t[Zr]===null&&(t[Zr]=[]),t[Zr].push(e)}function b1(t,e){if(t[Zr]===null)return;let n=t[Zr].indexOf(e);n!==-1&&t[Zr].splice(n,1)}function Bi(t){let e=t[jt];return Ir(e)?e[jt]:e}var _e={lFrame:bD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var pD=!1;function D1(){return _e.lFrame.elementDepthCount}function S1(){_e.lFrame.elementDepthCount++}function A1(){_e.lFrame.elementDepthCount--}function gD(){return _e.bindingsEnabled}function R1(){return _e.skipHydrationRootTNode!==null}function N1(t){return _e.skipHydrationRootTNode===t}function P1(){_e.skipHydrationRootTNode=null}function pt(){return _e.lFrame.lView}function qi(){return _e.lFrame.tView}function mD(t){return _e.lFrame.contextLView=t,t[mn]}function _D(t){return _e.lFrame.contextLView=null,t}function Jn(){let t=yD();for(;t!==null&&t.type===64;)t=t.parent;return t}function yD(){return _e.lFrame.currentTNode}function M1(){let t=_e.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function mc(t,e){let n=_e.lFrame;n.currentTNode=t,n.isParent=e}function vD(){return _e.lFrame.isParent}function x1(){_e.lFrame.isParent=!1}function ID(){return pD}function lb(t){pD=t}function k1(){let t=_e.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function O1(t){return _e.lFrame.bindingIndex=t}function wD(){return _e.lFrame.bindingIndex++}function F1(){return _e.lFrame.inI18n}function L1(t,e){let n=_e.lFrame;n.bindingIndex=n.bindingRootIndex=t,Tg(e)}function V1(){return _e.lFrame.currentDirectiveIndex}function Tg(t){_e.lFrame.currentDirectiveIndex=t}function ED(t){_e.lFrame.currentQueryIndex=t}function U1(t){let e=t[de];return e.type===2?e.declTNode:e.type===1?t[Rn]:null}function TD(t,e,n){if(n&le.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&le.Host);)if(i=U1(s),i===null||(s=s[go],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=_e.lFrame=CD();return r.currentTNode=e,r.lView=t,!0}function om(t){let e=CD(),n=t[de];_e.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function CD(){let t=_e.lFrame,e=t===null?null:t.child;return e===null?bD(t):e}function bD(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function DD(){let t=_e.lFrame;return _e.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var SD=DD;function am(){let t=DD();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function j1(t){return(_e.lFrame.contextLView=C1(t,_e.lFrame.contextLView))[mn]}function cm(){return _e.lFrame.selectedIndex}function $i(t){_e.lFrame.selectedIndex=t}function B1(){return _e.lFrame.currentNamespace}var AD=!0;function um(){return AD}function lm(t){AD=t}function $1(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=aD(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function dm(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),d!=null&&(t.destroyHooks??=[]).push(n,d)}}function Wl(t,e,n){RD(t,e,3,n)}function Kl(t,e,n,r){(t[ne]&3)===n&&RD(t,e,n,r)}function sg(t,e){let n=t[ne];(n&3)===e&&(n&=16383,n+=1,t[ne]=n)}function RD(t,e,n,r){let i=r!==void 0?t[no]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[no]+=65536),(a<s||s==-1)&&(H1(t,n,e,c),t[no]=(t[no]&4294901760)+c+2),c++}function db(t,e){zn(4,t,e);let n=pe(null);try{e.call(t)}finally{pe(n),zn(5,t,e)}}function H1(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[ne]>>14<t[no]>>16&&(t[ne]&3)===e&&(t[ne]+=16384,db(a,s)):db(a,s)}var so=-1,dc=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function q1(t){return t instanceof dc}function z1(t){return(t.flags&8)!==0}function G1(t){return(t.flags&16)!==0}var og={},Cg=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ed(r);let i=this.injector.get(e,og,r);return i!==og||n===og?i:this.parentInjector.get(e,n,r)}};function ND(t){return t!==so}function ad(t){return t&32767}function W1(t){return t>>16}function cd(t,e){let n=W1(t),r=e;for(;n>0;)r=r[go],n--;return r}var bg=!0;function ud(t){let e=bg;return bg=t,e}var K1=256,PD=K1-1,MD=5,Q1=0,Gn={};function Y1(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(oc)&&(r=n[oc]),r==null&&(r=n[oc]=Q1++);let i=r&PD,s=1<<i;e.data[t+(i>>MD)]|=s}function xD(t,e){let n=kD(t,e);if(n!==-1)return n;let r=e[de];r.firstCreatePass&&(t.injectorIndex=e.length,ag(r.data,t),ag(e,null),ag(r.blueprint,null));let i=hm(t,e),s=t.injectorIndex;if(ND(i)){let o=ad(i),a=cd(i,e),c=a[de].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function ag(t,e){t.push(0,0,0,0,0,0,0,0,e)}function kD(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function hm(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=UD(i),r===null)return so;if(n++,i=i[go],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return so}function Z1(t,e,n){Y1(t,e,n)}function OD(t,e,n){if(n&le.Optional||t!==void 0)return t;Yg(e,"NodeInjector")}function FD(t,e,n,r){if(n&le.Optional&&r===void 0&&(r=null),!(n&(le.Self|le.Host))){let i=t[co],s=Kt(void 0);try{return i?i.get(e,r,n&le.Optional):jb(e,r,n&le.Optional)}finally{Kt(s)}}return OD(r,e,n)}function LD(t,e,n,r=le.Default,i){if(t!==null){if(e[ne]&2048&&!(r&le.Self)){let o=nF(t,e,n,r,Gn);if(o!==Gn)return o}let s=VD(t,e,n,r,Gn);if(s!==Gn)return s}return FD(e,n,r,i)}function VD(t,e,n,r,i){let s=eF(n);if(typeof s=="function"){if(!TD(e,t,r))return r&le.Host?OD(i,n,r):FD(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&le.Optional))Yg(n);else return o}finally{SD()}}else if(typeof s=="number"){let o=null,a=kD(t,e),c=so,l=r&le.Host?e[Kn][Rn]:null;for((a===-1||r&le.SkipSelf)&&(c=a===-1?hm(t,e):e[a+8],c===so||!fb(r,!1)?a=-1:(o=e[de],a=ad(c),e=cd(c,e)));a!==-1;){let d=e[de];if(hb(s,a,d.data)){let p=J1(a,e,n,o,r,l);if(p!==Gn)return p}c=e[a+8],c!==so&&fb(r,e[de].data[a+8]===l)&&hb(s,a,e)?(o=d,a=ad(c),e=cd(c,e)):a=-1}}return i}function J1(t,e,n,r,i,s){let o=e[de],a=o.data[t+8],c=r==null?rm(a)&&bg:r!=o&&(a.type&3)!==0,l=i&le.Host&&s===a,d=X1(a,o,n,c,l);return d!==null?hc(e,o,d,a):Gn}function X1(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,l=t.directiveEnd,d=s>>20,p=r?a:a+d,g=i?a+d:l;for(let _=p;_<g;_++){let E=o[_];if(_<c&&n===E||_>=c&&E.type===n)return _}if(i){let _=o[c];if(_&&gc(_)&&_.type===n)return c}return null}function hc(t,e,n,r){let i=t[n],s=e.data;if(q1(i)){let o=i;o.resolving&&PO(NO(s[n]));let a=ud(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Kt(o.injectImpl):null,d=TD(t,r,le.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&$1(n,s[n],e)}finally{l!==null&&Kt(l),ud(a),o.resolving=!1,SD()}}return i}function eF(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(oc)?t[oc]:void 0;return typeof e=="number"?e>=0?e&PD:tF:e}function hb(t,e,n){let r=1<<t;return!!(n[e+(t>>MD)]&r)}function fb(t,e){return!(t&le.Self)&&!(t&le.Host&&e)}var Li=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return LD(this._tNode,this._lView,e,Ed(r),n)}};function tF(){return new Li(Jn(),pt())}function fm(t){return Id(()=>{let e=t.prototype.constructor,n=e[Zl]||Dg(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Zl]||Dg(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Dg(t){return xb(t)?()=>{let e=Dg(fn(t));return e&&e()}:Vi(t)}function nF(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[ne]&2048&&!(o[ne]&512);){let a=VD(s,o,n,r|le.Self,Gn);if(a!==Gn)return a;let c=s.parent;if(!c){let l=o[rD];if(l){let d=l.get(n,Gn,r);if(d!==Gn)return d}c=UD(o),o=o[go]}s=c}return i}function UD(t){let e=t[de],n=e.type;return n===2?e.declTNode:n===1?t[Rn]:null}function pb(t,e=null,n=null,r){let i=jD(t,e,n,r);return i.resolveInjectorInitializers(),i}function jD(t,e=null,n=null,r,i=new Set){let s=[n||oo,i1(t)];return r=r||(typeof t=="object"?void 0:nn(t)),new uc(s,e||nm(),r||null,i)}var ge=class t{static{this.THROW_IF_NOT_FOUND=ac}static{this.NULL=new ed}static create(e,n){if(Array.isArray(e))return pb({name:""},n,e,"");{let r=e.name??"";return pb({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=H({token:t,providedIn:"any",factory:()=>J($b)})}static{this.__NG_ELEMENT_ID__=-1}};var rF=new U("");rF.__NG_ELEMENT_ID__=t=>{let e=Jn();if(e===null)throw new W(204,!1);if(e.type&2)return e.value;if(t&le.Optional)return null;throw new W(204,!1)};var iF="ngOriginalError";function cg(t){return t[iF]}var BD=!0,_o=(()=>{class t{static{this.__NG_ELEMENT_ID__=sF}static{this.__NG_ENV_ID__=n=>n}}return t})(),Sg=class extends _o{constructor(e){super(),this._lView=e}onDestroy(e){return fD(this._lView,e),()=>b1(this._lView,e)}};function sF(){return new Sg(pt())}var zi=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new It(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}}return t})();var Ag=class extends $e{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,nD()&&(this.destroyRef=M(_o,{optional:!0})??void 0,this.pendingTasks=M(zi,{optional:!0})??void 0)}emit(e){let n=pe(null);try{super.next(e)}finally{pe(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof We&&e.add(a),a}wrapInTimeout(e){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(n),r!==void 0&&this.pendingTasks?.remove(r)})}}},Ut=Ag;function ld(...t){}function $D(t){let e,n;function r(){t=ld;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function gb(t){return queueMicrotask(()=>t()),()=>{t=ld}}var pm="isAngularZone",dd=pm+"_ID",oF=0,Z=class t{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ut(!1),this.onMicrotaskEmpty=new Ut(!1),this.onStable=new Ut(!1),this.onError=new Ut(!1);let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=BD}=e;if(typeof Zone>"u")throw new W(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,uF(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(pm)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new W(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new W(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,aF,ld,ld);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},aF={};function gm(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function cF(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function e(){$D(()=>{t.callbackScheduled=!1,Rg(t),t.isCheckStableRunning=!0,gm(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),Rg(t)}function uF(t){let e=()=>{cF(t)},n=oF++;t._inner=t._inner.fork({name:"angular",properties:{[pm]:!0,[dd]:n,[dd+n]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(lF(c))return r.invokeTask(s,o,a,c);try{return mb(t),r.invokeTask(s,o,a,c)}finally{(t.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),_b(t)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return mb(t),r.invoke(s,o,a,c,l)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!dF(c)&&e(),_b(t)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(t._hasPendingMicrotasks=o.microTask,Rg(t),gm(t)):o.change=="macroTask"&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}function Rg(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function mb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function _b(t){t._nesting--,gm(t)}var Ng=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ut,this.onMicrotaskEmpty=new Ut,this.onStable=new Ut,this.onError=new Ut}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function lF(t){return HD(t,"__ignore_ng_zone__")}function dF(t){return HD(t,"__scheduler_tick__")}function HD(t,e){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[e]===!0}var Yn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&cg(e);for(;n&&cg(n);)n=cg(n);return n||null}},hF=new U("",{providedIn:"root",factory:()=>{let t=M(Z),e=M(Yn);return n=>t.runOutsideAngular(()=>e.handleError(n))}});function fF(){return mm(Jn(),pt())}function mm(t,e){return new Rd(Zn(t,e))}var Rd=(()=>{class t{constructor(n){this.nativeElement=n}static{this.__NG_ELEMENT_ID__=fF}}return t})();function qD(t){return(t.flags&128)===128}var zD=new Map,pF=0;function gF(){return pF++}function mF(t){zD.set(t[bd],t)}function Pg(t){zD.delete(t[bd])}var yb="__ngContext__";function Hi(t,e){Fi(e)?(t[yb]=e[bd],mF(e)):t[yb]=e}function GD(t){return KD(t[lc])}function WD(t){return KD(t[An])}function KD(t){for(;t!==null&&!Ir(t);)t=t[An];return t}var Mg;function QD(t){Mg=t}function _F(){if(Mg!==void 0)return Mg;if(typeof document<"u")return document;throw new W(210,!1)}var _m=new U("",{providedIn:"root",factory:()=>yF}),yF="ng",ym=new U(""),Nn=new U("",{providedIn:"platform",factory:()=>"unknown"});var vm=new U("",{providedIn:"root",factory:()=>_F().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var vF="h",IF="b";var wF=()=>null;function Im(t,e,n=!1){return wF(t,e,n)}var YD=!1,EF=new U("",{providedIn:"root",factory:()=>YD});function ZD(t){return t instanceof Function?t():t}var Gi=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Gi||{}),TF;function wm(t,e){return TF(t,e)}function ro(t,e,n,r,i){if(r!=null){let s,o=!1;Ir(r)?s=r:Fi(r)&&(o=!0,r=r[vr]);let a=Qn(r);t===0&&n!==null?i==null?tS(e,n,a):fd(e,n,a,i||null,!0):t===1&&n!==null?fd(e,n,a,i||null,!0):t===2?VF(e,a,o):t===3&&e.destroyNode(a),s!=null&&jF(e,t,s,n,i)}}function CF(t,e){return t.createText(e)}function bF(t,e,n){t.setValue(e,n)}function JD(t,e,n){return t.createElement(e,n)}function DF(t,e){XD(t,e),e[vr]=null,e[Rn]=null}function SF(t,e,n,r,i,s){r[vr]=i,r[Rn]=e,Nd(t,r,n,1,i,s)}function XD(t,e){e[_r].changeDetectionScheduler?.notify(9),Nd(t,e,e[sn],2,null,null)}function AF(t){let e=t[lc];if(!e)return ug(t[de],t);for(;e;){let n=null;if(Fi(e))n=e[lc];else{let r=e[rn];r&&(n=r)}if(!n){for(;e&&!e[An]&&e!==t;)Fi(e)&&ug(e[de],e),e=e[jt];e===null&&(e=t),Fi(e)&&ug(e[de],e),n=e&&e[An]}e=n}}function RF(t,e,n,r){let i=rn+r,s=n.length;r>0&&(n[i-1][An]=e),r<s-rn?(e[An]=n[i],Bb(n,rn+r,e)):(n.push(e),e[An]=null),e[jt]=n;let o=e[uo];o!==null&&n!==o&&eS(o,e);let a=e[lo];a!==null&&a.insertView(t),Eg(e),e[ne]|=128}function eS(t,e){let n=t[id],r=e[jt];if(Fi(r))t[ne]|=sd.HasTransplantedViews;else{let i=r[jt][Kn];e[Kn]!==i&&(t[ne]|=sd.HasTransplantedViews)}n===null?t[id]=[e]:n.push(e)}function Em(t,e){let n=t[id],r=n.indexOf(e);n.splice(r,1)}function hd(t,e){if(t.length<=rn)return;let n=rn+e,r=t[n];if(r){let i=r[uo];i!==null&&i!==t&&Em(i,r),e>0&&(t[n-1][An]=r[An]);let s=Xl(t,rn+e);DF(r[de],r);let o=s[lo];o!==null&&o.detachView(s[de]),r[jt]=null,r[An]=null,r[ne]&=-129}return r}function Tm(t,e){if(!(e[ne]&256)){let n=e[sn];n.destroyNode&&Nd(t,e,n,3,null,null),AF(e)}}function ug(t,e){if(e[ne]&256)return;let n=pe(null);try{e[ne]&=-129,e[ne]|=256,e[pn]&&ml(e[pn]),PF(t,e),NF(t,e),e[de].type===1&&e[sn].destroy();let r=e[uo];if(r!==null&&Ir(e[jt])){r!==e[jt]&&Em(r,e);let i=e[lo];i!==null&&i.detachView(t)}Pg(e)}finally{pe(n)}}function NF(t,e){let n=t.cleanup,r=e[nd];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[nd]=null);let i=e[Zr];if(i!==null){e[Zr]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function PF(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof dc)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];zn(4,a,c);try{c.call(a)}finally{zn(5,a,c)}}else{zn(4,i,s);try{s.call(i)}finally{zn(5,i,s)}}}}}function MF(t,e,n){return xF(t,e.parent,n)}function xF(t,e,n){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return n[vr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Wn.None||s===Wn.Emulated)return null}return Zn(r,n)}}function fd(t,e,n,r,i){t.insertBefore(e,n,r,i)}function tS(t,e,n){t.appendChild(e,n)}function vb(t,e,n,r,i){r!==null?fd(t,e,n,r,i):tS(t,e,n)}function nS(t,e){return t.parentNode(e)}function kF(t,e){return t.nextSibling(e)}function OF(t,e,n){return LF(t,e,n)}function FF(t,e,n){return t.type&40?Zn(t,n):null}var LF=FF,Ib;function Cm(t,e,n,r){let i=MF(t,r,e),s=e[sn],o=r.parent||e[Rn],a=OF(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)vb(s,i,n[c],a,!1);else vb(s,i,n,a,!1);Ib!==void 0&&Ib(s,r,e,n,i)}function ic(t,e){if(e!==null){let n=e.type;if(n&3)return Zn(e,t);if(n&4)return xg(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return ic(t,r);{let i=t[e.index];return Ir(i)?xg(-1,i):Qn(i)}}else{if(n&128)return ic(t,e.next);if(n&32)return wm(e,t)()||Qn(t[e.index]);{let r=rS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Bi(t[Kn]);return ic(i,r)}else return ic(t,e.next)}}}return null}function rS(t,e){if(e!==null){let r=t[Kn][Rn],i=e.projection;return r.projection[i]}return null}function xg(t,e){let n=rn+t+1;if(n<e.length){let r=e[n],i=r[de].firstChild;if(i!==null)return ic(r,i)}return e[ji]}function VF(t,e,n){t.removeChild(null,e,n)}function bm(t,e,n,r,i,s,o){for(;n!=null;){if(n.type===128){n=n.next;continue}let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Hi(Qn(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)bm(t,e,n.child,r,i,s,!1),ro(e,t,i,a,s);else if(c&32){let l=wm(n,r),d;for(;d=l();)ro(e,t,i,d,s);ro(e,t,i,a,s)}else c&16?UF(t,e,r,n,i,s):ro(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Nd(t,e,n,r,i,s){bm(n,r,t.firstChild,e,i,s,!1)}function UF(t,e,n,r,i,s){let o=n[Kn],c=o[Rn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];ro(e,t,i,d,s)}else{let l=c,d=o[jt];qD(r)&&(l.flags|=128),bm(t,e,l,d,i,s,!0)}}function jF(t,e,n,r,i){let s=n[ji],o=Qn(n);s!==o&&ro(e,t,r,s,i);for(let a=rn;a<n.length;a++){let c=n[a];Nd(c[de],c,t,e,r,s)}}function BF(t,e,n){t.setAttribute(e,"style",n)}function iS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function sS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&gg(t,e,r),i!==null&&iS(t,e,i),s!==null&&BF(t,e,s)}var yo={};function wr(t=1){oS(qi(),pt(),cm()+t,!1)}function oS(t,e,n,r){if(!r)if((e[ne]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Wl(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Kl(e,s,0,n)}$i(n)}function Wi(t,e=le.Default){let n=pt();if(n===null)return J(t,e);let r=Jn();return LD(r,n,fn(t),e)}function aS(t,e,n,r,i,s){let o=pe(null);try{let a=null;i&Jr.SignalBased&&(a=e[r][pr]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Jr.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):oD(e,a,r,s)}finally{pe(o)}}function $F(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)$i(~i);else{let s=i,o=n[++r],a=n[++r];L1(o,s);let c=e[s];a(2,c)}}}finally{$i(-1)}}function Pd(t,e,n,r,i,s,o,a,c,l,d){let p=e.blueprint.slice();return p[vr]=i,p[ne]=r|4|128|8|64,(l!==null||t&&t[ne]&2048)&&(p[ne]|=2048),dD(p),p[jt]=p[go]=t,p[mn]=n,p[_r]=o||t&&t[_r],p[sn]=a||t&&t[sn],p[co]=c||t&&t[co]||null,p[Rn]=s,p[bd]=gF(),p[td]=d,p[rD]=l,p[Kn]=e.type==2?t[Kn]:p,p}function Md(t,e,n,r,i){let s=t.data[e];if(s===null)s=HF(t,e,n,r,i),F1()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=M1();s.injectorIndex=o===null?-1:o.injectorIndex}return mc(s,!0),s}function HF(t,e,n,r,i){let s=yD(),o=vD(),a=o?s:s&&s.parent,c=t.data[e]=KF(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function cS(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function uS(t,e,n,r,i){let s=cm(),o=r&2;try{$i(-1),o&&e.length>_n&&oS(t,e,_n,!1),zn(o?2:0,i),n(r,i)}finally{$i(s),zn(o?3:1,i)}}function lS(t,e,n){if(sD(e)){let r=pe(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{pe(r)}}}function dS(t,e,n){gD()&&(JF(t,e,n,Zn(n,e)),(n.flags&64)===64&&mS(t,e,n))}function hS(t,e,n=Zn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function fS(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=Dm(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Dm(t,e,n,r,i,s,o,a,c,l,d){let p=_n+r,g=p+i,_=qF(p,g),E=typeof l=="function"?l():l;return _[de]={type:t,blueprint:_,template:n,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function qF(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:yo);return n}function zF(t,e,n,r){let s=r.get(EF,YD)||n===Wn.ShadowDom,o=t.selectRootElement(e,s);return GF(o),o}function GF(t){WF(t)}var WF=()=>null;function KF(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return R1()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function wb(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Jr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}t===0?Eb(r,n,l,a,c):Eb(r,n,l,a)}return r}function Eb(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function QF(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let p=s[d],g=n?n.get(p):null,_=g?g.inputs:null,E=g?g.outputs:null;c=wb(0,p.inputs,d,c,_),l=wb(1,p.outputs,d,l,E);let R=c!==null&&o!==null&&!Xg(e)?aL(c,d,o):null;a.push(R)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function pS(t,e,n,r){if(gD()){let i=r===null?null:{"":-1},s=eL(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&gS(t,e,n,o,i,a),i&&tL(n,r,i)}n.mergedAttrs=Jg(n.mergedAttrs,n.attrs)}function gS(t,e,n,r,i,s){for(let l=0;l<r.length;l++)Z1(xD(n,e),t,r[l].type);rL(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=cS(t,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];n.mergedAttrs=Jg(n.mergedAttrs,d.hostAttrs),iL(t,n,e,c,d),nL(c,d,i),d.contentQueries!==null&&(n.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(n.flags|=64);let p=d.type.prototype;!o&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}QF(t,n,s)}function YF(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;ZF(o)!=a&&o.push(a),o.push(n,r,s)}}function ZF(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function JF(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;rm(n)&&sL(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||xD(n,e),Hi(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],l=hc(e,t,a,n);if(Hi(l,e),o!==null&&oL(e,a-i,l,c,n,o),gc(c)){let d=mo(n.index,e);d[mn]=hc(e,t,a,n)}}}function mS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=V1();try{$i(s);for(let a=r;a<i;a++){let c=t.data[a],l=e[a];Tg(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&XF(c,l)}}finally{$i(-1),Tg(o)}}function XF(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function eL(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(QO(e,o.selectors,!1))if(r||(r=[]),gc(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;kg(t,e,c)}else r.unshift(o),kg(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function kg(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function tL(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new W(-301,!1);r.push(e[i],s)}}}function nL(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;gc(e)&&(n[""]=t)}}function rL(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function iL(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Vi(i.type,!0)),o=new dc(s,gc(i),Wi);t.blueprint[r]=o,n[r]=o,YF(t,e,r,cS(t,n,i.hostVars,yo),i)}function sL(t,e,n){let r=Zn(e,t),i=fS(n),s=t[_r].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=xd(t,Pd(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function oL(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],p=o[a++];aS(r,n,c,l,d,p)}}function aL(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function _S(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function yS(t,e){let n=t.contentQueries;if(n!==null){let r=pe(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];ED(s),a.contentQueries(2,e[o],o)}}}finally{pe(r)}}}function xd(t,e){return t[lc]?t[cb][An]=e:t[lc]=e,t[cb]=e,e}function Og(t,e,n){ED(0);let r=pe(null);try{e(t,n)}finally{pe(r)}}function cL(t){return t[nd]??=[]}function uL(t){return t.cleanup??=[]}function vS(t,e){let n=t[co],r=n?n.get(Yn,null):null;r&&r.handleError(e)}function IS(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],l=e[o],d=t.data[o];aS(d,l,r,a,c,i)}}function lL(t,e,n){let r=w1(e,t);bF(t[sn],r,n)}function dL(t,e){let n=mo(e,t),r=n[de];hL(r,n);let i=n[vr];i!==null&&n[td]===null&&(n[td]=Im(i,n[co])),Sm(r,n,n[mn])}function hL(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function Sm(t,e,n){om(e);try{let r=t.viewQuery;r!==null&&Og(1,r,n);let i=t.template;i!==null&&uS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[lo]?.finishViewCreation(t),t.staticContentQueries&&yS(t,e),t.staticViewQueries&&Og(2,t.viewQuery,n);let s=t.components;s!==null&&fL(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[ne]&=-5,am()}}function fL(t,e){for(let n=0;n<e.length;n++)dL(t,e[n])}function pL(t,e,n,r){let i=pe(null);try{let s=e.tView,a=t[ne]&4096?4096:16,c=Pd(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=t[e.index];c[uo]=l;let d=t[lo];return d!==null&&(c[lo]=d.createEmbeddedView(s)),Sm(s,c,n),c}finally{pe(i)}}function gL(t,e){let n=rn+e;if(n<t.length)return t[n]}function Fg(t,e){return!e||e.firstChild===null||qD(t)}function wS(t,e,n,r=!0){let i=e[de];if(RF(i,e,t,n),r){let o=xg(n,t),a=e[sn],c=nS(a,t[ji]);c!==null&&SF(i,t[Rn],a,e,c,o)}let s=e[td];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function mL(t,e){let n=hd(t,e);return n!==void 0&&Tm(n[de],n),n}function pd(t,e,n,r,i=!1){for(;n!==null;){if(n.type===128){n=i?n.projectionNext:n.next;continue}let s=e[n.index];s!==null&&r.push(Qn(s)),Ir(s)&&_L(s,r);let o=n.type;if(o&8)pd(t,e,n.child,r);else if(o&32){let a=wm(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=rS(e,n);if(Array.isArray(a))r.push(...a);else{let c=Bi(e[Kn]);pd(c[de],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function _L(t,e){for(let n=rn;n<t.length;n++){let r=t[n],i=r[de].firstChild;i!==null&&pd(r[de],r,i,e)}t[ji]!==t[vr]&&e.push(t[ji])}var ES=[];function yL(t){return t[pn]??vL(t)}function vL(t){let e=ES.pop()??Object.create(wL);return e.lView=t,e}function IL(t){t.lView[pn]!==t&&(t.lView=null,ES.push(t))}var wL=Ae(V({},Us),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Ad(t.lView)},consumerOnSignalRead(){this.lView[pn]=this}});function EL(t){let e=t[pn]??Object.create(TL);return e.lView=t,e}var TL=Ae(V({},Us),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{let e=Bi(t.lView);for(;e&&!TS(e[de]);)e=Bi(e);e&&hD(e)},consumerOnSignalRead(){this.lView[pn]=this}});function TS(t){return t.type!==2}var CL=100;function CS(t,e=!0,n=0){let r=t[_r],i=r.rendererFactory,s=!1;s||i.begin?.();try{bL(t,n)}catch(o){throw e&&vS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function bL(t,e){let n=ID();try{lb(!0),Lg(t,e);let r=0;for(;Sd(t);){if(r===CL)throw new W(103,!1);r++,Lg(t,1)}}finally{lb(n)}}function DL(t,e,n,r){let i=e[ne];if((i&256)===256)return;let s=!1,o=!1;!s&&e[_r].inlineEffectRunner?.flush(),om(e);let a=!0,c=null,l=null;s||(TS(t)?(l=yL(e),c=Ya(l)):cC()===null?(a=!1,l=EL(e),c=Ya(l)):e[pn]&&(ml(e[pn]),e[pn]=null));try{dD(e),O1(t.bindingStartIndex),n!==null&&uS(t,e,n,2,r);let d=(i&3)===3;if(!s)if(d){let _=t.preOrderCheckHooks;_!==null&&Wl(e,_,null)}else{let _=t.preOrderHooks;_!==null&&Kl(e,_,0,null),sg(e,0)}if(o||SL(e),bS(e,0),t.contentQueries!==null&&yS(t,e),!s)if(d){let _=t.contentCheckHooks;_!==null&&Wl(e,_)}else{let _=t.contentHooks;_!==null&&Kl(e,_,1),sg(e,1)}$F(t,e);let p=t.components;p!==null&&SS(e,p,0);let g=t.viewQuery;if(g!==null&&Og(2,g,r),!s)if(d){let _=t.viewCheckHooks;_!==null&&Wl(e,_)}else{let _=t.viewHooks;_!==null&&Kl(e,_,2),sg(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Gl]){for(let _ of e[Gl])_();e[Gl]=null}s||(e[ne]&=-73)}catch(d){throw s||Ad(e),d}finally{l!==null&&(pl(l,c),a&&IL(l)),am()}}function bS(t,e){for(let n=GD(t);n!==null;n=WD(n))for(let r=rn;r<n.length;r++){let i=n[r];DS(i,e)}}function SL(t){for(let e=GD(t);e!==null;e=WD(e)){if(!(e[ne]&sd.HasTransplantedViews))continue;let n=e[id];for(let r=0;r<n.length;r++){let i=n[r];hD(i)}}}function AL(t,e,n){let r=mo(e,t);DS(r,n)}function DS(t,e){sm(t)&&Lg(t,e)}function Lg(t,e){let r=t[de],i=t[ne],s=t[pn],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&gl(s)),o||=!1,s&&(s.dirty=!1),t[ne]&=-9217,o)DL(r,t,r.template,t[mn]);else if(i&8192){bS(t,1);let a=r.components;a!==null&&SS(t,a,1)}}function SS(t,e,n){for(let r=0;r<e.length;r++)AL(t,e[r],n)}function Am(t,e){let n=ID()?64:1088;for(t[_r].changeDetectionScheduler?.notify(e);t;){t[ne]|=n;let r=Bi(t);if(Ig(t)&&!r)return t;t=r}return null}var ho=class{get rootNodes(){let e=this._lView,n=e[de];return pd(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[mn]}set context(e){this._lView[mn]=e}get destroyed(){return(this._lView[ne]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[jt];if(Ir(e)){let n=e[rd],r=n?n.indexOf(this):-1;r>-1&&(hd(e,r),Xl(n,r))}this._attachedToViewContainer=!1}Tm(this._lView[de],this._lView)}onDestroy(e){fD(this._lView,e)}markForCheck(){Am(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ne]&=-129}reattach(){Eg(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,CS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new W(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Ig(this._lView),n=this._lView[uo];n!==null&&!e&&Em(n,this._lView),XD(this._lView[de],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new W(902,!1);this._appRef=e;let n=Ig(this._lView),r=this._lView[uo];r!==null&&!n&&eS(r,this._lView),Eg(this._lView)}};var l7=new RegExp(`^(\\d+)*(${IF}|${vF})*(.*)`);var RL=()=>null;function Vg(t,e){return RL(t,e)}var fo=class{},kd=new U("",{providedIn:"root",factory:()=>!1});var AS=new U(""),RS=new U(""),Ug=class{},gd=class{};function NL(t){let e=Error(`No component factory found for ${nn(t)}.`);return e[PL]=t,e}var PL="ngComponent";var jg=class{resolveComponentFactory(e){throw NL(e)}},Xr=class{static{this.NULL=new jg}},po=class{};var ML=(()=>{class t{static{this.\u0275prov=H({token:t,providedIn:"root",factory:()=>null})}}return t})();function Bg(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=JC(i,a);else if(s==2){let c=a,l=e[++o];r=JC(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var md=class extends Xr{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Ui(e);return new fc(n,this.ngModule)}};function Tb(t,e){let n=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let i=t[r];if(i===void 0)continue;let s=Array.isArray(i),o=s?i[0]:i,a=s?i[1]:Jr.None;e?n.push({propName:o,templateName:r,isSignal:(a&Jr.SignalBased)!==0}):n.push({propName:o,templateName:r})}return n}function xL(t){let e=t.toLowerCase();return e==="svg"?v1:e==="math"?I1:null}var fc=class extends gd{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=Tb(e.inputs,!0);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return Tb(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=XO(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=pe(null);try{i=i||this.ngModule;let o=i instanceof gn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Cg(e,o):e,c=a.get(po,null);if(c===null)throw new W(407,!1);let l=a.get(ML,null),d=a.get(fo,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:d},g=c.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",E=r?zF(g,r,this.componentDef.encapsulation,a):JD(g,_,xL(_)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let A=null;E!==null&&(A=Im(E,a,!0));let x=Dm(0,null,null,1,0,null,null,null,null,null,null),L=Pd(null,x,null,R,null,null,p,g,a,null,A);om(L);let $,G,Ne=null;try{let Y=this.componentDef,T,v=null;Y.findHostDirectiveDefs?(T=[],v=new Map,Y.findHostDirectiveDefs(Y,T,v),T.push(Y)):T=[Y];let I=kL(L,E);Ne=OL(I,E,Y,T,L,p,g),G=lD(x,_n),E&&VL(g,Y,E,r),n!==void 0&&UL(G,this.ngContentSelectors,n),$=LL(Ne,Y,T,v,L,[jL]),Sm(x,L,null)}catch(Y){throw Ne!==null&&Pg(Ne),Pg(L),Y}finally{am()}return new $g(this.componentType,$,mm(G,L),L,G)}finally{pe(s)}}},$g=class extends Ug{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new ho(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;IS(s[de],s,i,e,n),this.previousInputValues.set(e,n);let o=mo(this._tNode.index,s);Am(o,1)}}get injector(){return new Li(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function kL(t,e){let n=t[de],r=_n;return t[r]=e,Md(n,r,2,"#host",null)}function OL(t,e,n,r,i,s,o){let a=i[de];FL(r,t,e,o);let c=null;e!==null&&(c=Im(e,i[co]));let l=s.rendererFactory.createRenderer(e,n),d=16;n.signals?d=4096:n.onPush&&(d=64);let p=Pd(i,fS(n),null,d,i[t.index],t,s,l,null,null,c);return a.firstCreatePass&&kg(a,t,r.length-1),xd(i,p),i[t.index]=p}function FL(t,e,n,r){for(let i of t)e.mergedAttrs=Jg(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Bg(e,e.mergedAttrs,!0),n!==null&&sS(r,n,e))}function LL(t,e,n,r,i,s){let o=Jn(),a=i[de],c=Zn(o,i);gS(a,i,o,n,null,r);for(let d=0;d<n.length;d++){let p=o.directiveStart+d,g=hc(i,a,p,o);Hi(g,i)}mS(a,i,o),c&&Hi(c,i);let l=hc(i,a,o.directiveStart+o.componentOffset,o);if(t[mn]=i[mn]=l,s!==null)for(let d of s)d(l,e);return lS(a,o,i),l}function VL(t,e,n,r){if(r)gg(t,n,["ng-version","18.2.13"]);else{let{attrs:i,classes:s}=e1(e.selectors[0]);i&&gg(t,n,i),s&&s.length>0&&iS(t,n,s.join(" "))}}function UL(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function jL(){let t=Jn();dm(pt()[de],t)}var Od=(()=>{class t{static{this.__NG_ELEMENT_ID__=BL}}return t})();function BL(){let t=Jn();return HL(t,pt())}var $L=Od,NS=class extends $L{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return mm(this._hostTNode,this._hostLView)}get injector(){return new Li(this._hostTNode,this._hostLView)}get parentInjector(){let e=hm(this._hostTNode,this._hostLView);if(ND(e)){let n=cd(e,this._hostLView),r=ad(e),i=n[de].data[r+8];return new Li(i,n)}else return new Li(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=Cb(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-rn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Vg(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Fg(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!g1(e),a;if(o)a=n;else{let E=n||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new fc(Ui(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let R=(o?l:this.parentInjector).get(gn,null);R&&(s=R)}let d=Ui(c.componentType??{}),p=Vg(this._lContainer,d?.id??null),g=p?.firstChild??null,_=c.create(l,i,g,s);return this.insertImpl(_.hostView,a,Fg(this._hostTNode,p)),_}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(T1(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[jt],l=new NS(c,c[Rn],c[jt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return wS(o,i,s,r),e.attachToViewContainerRef(),Bb(lg(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=Cb(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=hd(this._lContainer,n);r&&(Xl(lg(this._lContainer),n),Tm(r[de],r))}detach(e){let n=this._adjustIndex(e,-1),r=hd(this._lContainer,n);return r&&Xl(lg(this._lContainer),n)!=null?new ho(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function Cb(t){return t[rd]}function lg(t){return t[rd]||(t[rd]=[])}function HL(t,e){let n,r=e[t.index];return Ir(r)?n=r:(n=_S(r,e,null,t),e[t.index]=n,xd(e,n)),zL(n,e,t,r),new NS(n,t,e)}function qL(t,e){let n=t[sn],r=n.createComment(""),i=Zn(e,t),s=nS(n,i);return fd(n,s,r,kF(n,i),!1),r}var zL=KL,GL=()=>!1;function WL(t,e,n){return GL(t,e,n)}function KL(t,e,n,r){if(t[ji])return;let i;n.type&8?i=Qn(r):i=qL(e,n),t[ji]=i}var bb=new Set;function Ki(t){bb.has(t)||(bb.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function Rm(t,e){Ki("NgSignals");let n=IC(t),r=n[pr];return e?.equal&&(r.equal=e.equal),n.set=i=>$p(r,i),n.update=i=>wC(r,i),n.asReadonly=QL.bind(n),n}function QL(){let t=this[pr];if(t.readonlyFn===void 0){let e=()=>this();e[pr]=t,t.readonlyFn=e}return t.readonlyFn}var ei=class{},pc=class{};var Hg=class extends ei{constructor(e,n,r,i=!0){super(),this.ngModuleType=e,this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new md(this);let s=Yb(e);this._bootstrapComponents=ZD(s.bootstrap),this._r3Injector=jD(e,n,[{provide:ei,useValue:this},{provide:Xr,useValue:this.componentFactoryResolver},...r],nn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},qg=class extends pc{constructor(e){super(),this.moduleType=e}create(e){return new Hg(this.moduleType,e,[])}};var _d=class extends ei{constructor(e){super(),this.componentFactoryResolver=new md(this),this.instance=null;let n=new uc([...e.providers,{provide:ei,useValue:this},{provide:Xr,useValue:this.componentFactoryResolver}],e.parent||nm(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Nm(t,e,n=null){return new _d({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}function YL(t,e,n){return t[e]=n}function yd(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function ZL(t,e,n,r){let i=yd(t,e,n);return yd(t,e+1,r)||i}function JL(t){return(t.flags&32)===32}function XL(t,e,n,r,i,s,o,a,c){let l=e.consts,d=Md(e,t,4,o||null,a||null);pS(e,n,d,od(l,c)),dm(e,d);let p=d.tView=Dm(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),p.queries=e.queries.embeddedTView(d)),d}function eV(t,e,n,r,i,s,o,a,c,l){let d=n+_n,p=e.firstCreatePass?XL(d,e,t,r,i,s,o,a,c):e.data[d];mc(p,!1);let g=tV(e,t,p,n);um()&&Cm(e,t,g,p),Hi(g,t);let _=_S(g,t,g,p);return t[d]=_,xd(t,_),WL(_,p,t),im(p)&&dS(e,t,p),c!=null&&hS(t,p,l),p}function ri(t,e,n,r,i,s,o,a){let c=pt(),l=qi(),d=od(l.consts,s);return eV(c,l,t,e,n,r,i,d,o,a),ri}var tV=nV;function nV(t,e,n,r){return lm(!0),e[sn].createComment("")}var sc=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(sc||{}),rV=(()=>{class t{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}}return t})(),Db=class t{constructor(){this.ngZone=M(Z),this.scheduler=M(fo),this.errorHandler=M(Yn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[sc.EarlyRead,sc.Write,sc.MixedReadWrite,sc.Read]}execute(){this.executing=!0;for(let e of t.PHASES)for(let n of this.sequences)if(!(n.erroredOrDestroyed||!n.hooks[e]))try{n.pipelinedValue=this.ngZone.runOutsideAngular(()=>n.hooks[e](n.pipelinedValue))}catch(r){n.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=H({token:t,providedIn:"root",factory:()=>new t})}};function iV(t,e,n,r){return yd(t,wD(),n)?e+Vb(n)+r:yo}function Sb(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";IS(t,n,s[o],o,r)}function Qi(t,e){Ki("NgControlFlow");let n=pt(),r=wD(),i=n[r]!==yo?n[r]:-1,s=i!==-1?Ab(n,_n+i):void 0,o=0;if(yd(n,r,t)){let a=pe(null);try{if(s!==void 0&&mL(s,o),t!==-1){let c=_n+t,l=Ab(n,c),d=sV(n[de],c),p=Vg(l,d.tView.ssrId),g=pL(n,d,e,{dehydratedView:p});wS(l,g,o,Fg(d,p))}}finally{pe(a)}}else if(s!==void 0){let a=gL(s,o);a!==void 0&&(a[mn]=e)}}function Ab(t,e){return t[e]}function sV(t,e){return lD(t,e)}function oV(t,e,n,r,i,s){let o=e.consts,a=od(o,i),c=Md(e,t,2,r,a);return pS(e,n,c,od(o,s)),c.attrs!==null&&Bg(c,c.attrs,!1),c.mergedAttrs!==null&&Bg(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function ot(t,e,n,r){let i=pt(),s=qi(),o=_n+t,a=i[sn],c=s.firstCreatePass?oV(o,s,i,e,n,r):s.data[o],l=aV(s,i,c,a,e,t);i[o]=l;let d=im(c);return mc(c,!0),sS(a,l,c),!JL(c)&&um()&&Cm(s,i,l,c),D1()===0&&Hi(l,i),S1(),d&&(dS(s,i,c),lS(s,c,i)),r!==null&&hS(i,c),ot}function Qe(){let t=Jn();vD()?x1():(t=t.parent,mc(t,!1));let e=t;N1(e)&&P1(),A1();let n=qi();return n.firstCreatePass&&(dm(n,t),sD(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&z1(e)&&Sb(n,e,pt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&G1(e)&&Sb(n,e,pt(),e.stylesWithoutHost,!1),Qe}function Yi(t,e,n,r){return ot(t,e,n,r),Qe(),Yi}var aV=(t,e,n,r,i,s)=>(lm(!0),JD(r,i,B1()));function PS(){return pt()}var Oi=void 0;function cV(t){let e=t,n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return n===1&&r===0?1:5}var uV=["en",[["a","p"],["AM","PM"],Oi],[["AM","PM"],Oi,Oi],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Oi,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Oi,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Oi,"{1} 'at' {0}",Oi],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",cV],dg={};function yn(t){let e=lV(t),n=Rb(e);if(n)return n;let r=e.split("-")[0];if(n=Rb(r),n)return n;if(r==="en")return uV;throw new W(701,!1)}function Rb(t){return t in dg||(dg[t]=rc.ng&&rc.ng.common&&rc.ng.common.locales&&rc.ng.common.locales[t]),dg[t]}var tt=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(tt||{});function lV(t){return t.toLowerCase().replace(/_/g,"-")}var vd="en-US";var dV=vd;function hV(t){typeof t=="string"&&(dV=t.toLowerCase().replace(/_/g,"-"))}var fV=(t,e,n)=>{};function Fd(t,e,n,r){let i=pt(),s=qi(),o=Jn();return gV(s,i,i[sn],o,t,e,r),Fd}function pV(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[nd],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function gV(t,e,n,r,i,s,o){let a=im(r),l=t.firstCreatePass&&uL(t),d=e[mn],p=cL(e),g=!0;if(r.type&3||o){let R=Zn(r,e),A=o?o(R):R,x=p.length,L=o?G=>o(Qn(G[r.index])):r.index,$=null;if(!o&&a&&($=pV(t,e,i,r.index)),$!==null){let G=$.__ngLastListenerFn__||$;G.__ngNextListenerFn__=s,$.__ngLastListenerFn__=s,g=!1}else{s=Pb(r,e,d,s),fV(R,i,s);let G=n.listen(A,i,s);p.push(s,G),l&&l.push(i,L,x,x+1)}}else s=Pb(r,e,d,s);let _=r.outputs,E;if(g&&_!==null&&(E=_[i])){let R=E.length;if(R)for(let A=0;A<R;A+=2){let x=E[A],L=E[A+1],Ne=e[x][L].subscribe(s),Y=p.length;p.push(s,Ne),l&&l.push(i,r.index,Y,-(Y+1))}}}function Nb(t,e,n,r){let i=pe(null);try{return zn(6,e,n),n(r)!==!1}catch(s){return vS(t,s),!1}finally{zn(7,e,n),pe(i)}}function Pb(t,e,n,r){return function i(s){if(s===Function)return r;let o=t.componentOffset>-1?mo(t.index,e):e;Am(o,5);let a=Nb(e,n,r,s),c=i.__ngNextListenerFn__;for(;c;)a=Nb(e,n,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Zi(t=1){return j1(t)}function mV(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}function wt(t,e=""){let n=pt(),r=qi(),i=t+_n,s=r.firstCreatePass?Md(r,i,1,e,null):r.data[i],o=_V(r,n,s,e,t);n[i]=o,um()&&Cm(r,n,o,s),mc(s,!1)}var _V=(t,e,n,r,i)=>(lm(!0),CF(e[sn],r));function Ji(t,e,n){let r=pt(),i=iV(r,t,e,n);return i!==yo&&lL(r,cm(),i),Ji}var yV=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=Xb(!1,n.type),i=r.length>0?Nm([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=H({token:t,providedIn:"environment",factory:()=>new t(J(gn))})}}return t})();function ii(t){Ki("NgStandalone"),t.getStandaloneInjector=e=>e.get(yV).getOrCreateStandaloneInjector(t)}function vV(t,e){let n=t[e];return n===yo?void 0:n}function IV(t,e,n,r,i,s,o){let a=e+n;return ZL(t,a,i,s)?YL(t,a+2,o?r.call(o,i,s):r(i,s)):vV(t,a+2)}function Pm(t,e){let n=qi(),r,i=t+_n;n.firstCreatePass?(r=wV(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];let s=r.factory||(r.factory=Vi(r.type,!0)),o,a=Kt(Wi);try{let c=ud(!1),l=s();return ud(c),mV(n,pt(),i,l),l}finally{Kt(a)}}function wV(t,e){if(e)for(let n=e.length-1;n>=0;n--){let r=e[n];if(t===r.name)return r}}function Mm(t,e,n,r){let i=t+_n,s=pt(),o=E1(s,i);return EV(s,i)?IV(s,k1(),e,o.transform,n,r,o):o.transform(n,r)}function EV(t,e){return t[de].data[e].pure}var ti=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},MS=new ti("18.2.13");var Ld=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();var xS=new U("");function _c(t){return!!t&&typeof t.then=="function"}function kS(t){return!!t&&typeof t.subscribe=="function"}var si=new U(""),OS=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=M(si,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let n=[];for(let i of this.appInits){let s=i();if(_c(s))n.push(s);else if(kS(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});n.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),n.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),xm=new U("");function TV(){vC(()=>{throw new W(600,!1)})}function CV(t){return t.isBoundToModule}var bV=10;function DV(t,e,n){try{let r=n();return _c(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Xi=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=M(hF),this.afterRenderManager=M(rV),this.zonelessEnabled=M(kd),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new $e,this.afterTick=new $e,this.componentTypes=[],this.components=[],this.isStable=M(zi).hasPendingTasks.pipe(Q(n=>!n)),this._injector=M(gn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{n.unsubscribe()})}get injector(){return this._injector}bootstrap(n,r){let i=n instanceof gd;if(!this._injector.get(OS).done){let g=!i&&Qb(n),_=!1;throw new W(405,_)}let o;i?o=n:o=this._injector.get(Xr).resolveComponentFactory(n),this.componentTypes.push(o.componentType);let a=CV(o)?void 0:this._injector.get(ei),c=r||o.selector,l=o.create(ge.NULL,[],c,a),d=l.location.nativeElement,p=l.injector.get(xS,null);return p?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Ql(this.components,l),p?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new W(101,!1);let n=pe(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,pe(n),this.afterTick.next()}}synchronize(){let n=null;this._injector.destroyed||(n=this._injector.get(po,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<bV;)this.synchronizeOnce(n)}synchronizeOnce(n){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:s}of this._views)SV(i,s,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else n?.begin?.(),n?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>Sd(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Ql(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);let r=this._injector.get(xm,[]);[...this._bootstrapListeners,...r].forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Ql(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new W(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Ql(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function SV(t,e,n,r){if(!n&&!Sd(t))return;CS(t,e,n&&!r?0:1)}var zg=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},km=(()=>{class t{compileModuleSync(n){return new qg(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),i=Yb(n),s=ZD(i.declarations).reduce((o,a)=>{let c=Ui(a);return c&&o.push(new fc(c)),o},[]);return new zg(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var AV=(()=>{class t{constructor(){this.zone=M(Z),this.changeDetectionScheduler=M(fo),this.applicationRef=M(Xi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),RV=new U("",{factory:()=>!1});function FS({ngZoneFactory:t,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return t??=()=>new Z(Ae(V({},VS()),{scheduleInRootZone:n})),[{provide:Z,useFactory:t},{provide:ao,multi:!0,useFactory:()=>{let r=M(AV,{optional:!0});return()=>r.initialize()}},{provide:ao,multi:!0,useFactory:()=>{let r=M(NV);return()=>{r.initialize()}}},e===!0?{provide:AS,useValue:!0}:[],{provide:RS,useValue:n??BD}]}function LS(t){let e=t?.ignoreChangesOutsideZone,n=t?.scheduleInRootZone,r=FS({ngZoneFactory:()=>{let i=VS(t);return i.scheduleInRootZone=n,i.shouldCoalesceEventChangeDetection&&Ki("NgZone_CoalesceEvent"),new Z(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:n});return Oe([{provide:RV,useValue:!0},{provide:kd,useValue:!1},r])}function VS(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var NV=(()=>{class t{constructor(){this.subscription=new We,this.initialized=!1,this.zone=M(Z),this.pendingTasks=M(zi)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Z.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Z.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var PV=(()=>{class t{constructor(){this.appRef=M(Xi),this.taskService=M(zi),this.ngZone=M(Z),this.zonelessEnabled=M(kd),this.disableScheduling=M(AS,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new We,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(dd):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(M(RS,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ng||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?gb:$D;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(dd+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(n),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,gb(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function MV(){return typeof $localize<"u"&&$localize.locale||vd}var Vd=new U("",{providedIn:"root",factory:()=>M(Vd,le.Optional|le.SkipSelf)||MV()});var Gg=new U("");function ql(t){return!t.moduleRef}function xV(t){let e=ql(t)?t.r3Injector:t.moduleRef.injector,n=e.get(Z);return n.run(()=>{ql(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=e.get(Yn,null),i;if(n.runOutsideAngular(()=>{i=n.onError.subscribe({next:s=>{r.handleError(s)}})}),ql(t)){let s=()=>e.destroy(),o=t.platformInjector.get(Gg);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>t.moduleRef.destroy(),o=t.platformInjector.get(Gg);o.add(s),t.moduleRef.onDestroy(()=>{Ql(t.allPlatformModules,t.moduleRef),i.unsubscribe(),o.delete(s)})}return DV(r,n,()=>{let s=e.get(OS);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(Vd,vd);if(hV(o||vd),ql(t)){let a=e.get(Xi);return t.rootComponent!==void 0&&a.bootstrap(t.rootComponent),a}else return kV(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}function kV(t,e){let n=t.injector.get(Xi);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(n);else throw new W(-403,!1);e.push(t)}var Yl=null;function OV(t=[],e){return ge.create({name:e,providers:[{provide:Td,useValue:"platform"},{provide:Gg,useValue:new Set([()=>Yl=null])},...t]})}function FV(t=[]){if(Yl)return Yl;let e=OV(t);return Yl=e,TV(),LV(e),e}function LV(t){t.get(ym,null)?.forEach(n=>n())}var vo=(()=>{class t{static{this.__NG_ELEMENT_ID__=VV}}return t})();function VV(t){return UV(Jn(),pt(),(t&16)===16)}function UV(t,e,n){if(rm(t)&&!n){let r=mo(t.index,e);return new ho(r,r)}else if(t.type&175){let r=e[Kn];return new ho(r,e)}return null}function US(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=FV(r),s=[FS({}),{provide:fo,useExisting:PV},...n||[]],o=new _d({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return xV({r3Injector:o.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function Ud(t,e){Ki("NgSignals");let n=mC(t);return e?.equal&&(n[pr].equal=e.equal),n}function jd(t){let e=pe(null);try{return t()}finally{pe(e)}}var jV=new U("",{providedIn:"root",factory:()=>M(BV)}),BV=(()=>{class t{static{this.\u0275prov=H({token:t,providedIn:"root",factory:()=>new Wg})}}return t})(),Wg=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=M(zi),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),this.taskId===null){let n=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(n),this.taskId=null})}}enqueue(e){let n=e.creationZone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,n]of this.queues)e===null?this.flushQueue(n):e.run(()=>this.flushQueue(n))}flushQueue(e){for(let n of e)e.delete(n),this.queuedEffectCount--,n.run()}},Kg=class{constructor(e,n,r,i,s,o){this.scheduler=e,this.effectFn=n,this.creationZone=r,this.injector=s,this.watcher=TC(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(n){this.injector.get(Yn,null,{optional:!0})?.handleError(n)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function Om(t,e){Ki("NgSignals"),!e?.injector&&Cd(Om);let n=e?.injector??M(ge),r=e?.manualCleanup!==!0?n.get(_o):null,i=new Kg(n.get(jV),t,typeof Zone>"u"?null:Zone.current,r,n,e?.allowSignalWrites??!1),s=n.get(vo,null,{optional:!0});return!s||!(s._lView[ne]&8)?i.watcher.notify():(s._lView[Gl]??=[]).push(i.watcher.notify),i}var qS=null;function Io(){return qS}function zS(t){qS??=t}var Qd=class{};var In=new U(""),GS=(()=>{class t{historyGo(n){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(GV),providedIn:"platform"})}}return t})();var GV=(()=>{class t extends GS{constructor(){super(),this._doc=M(In),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Io().getBaseHref(this._doc)}onPopState(n){let r=Io().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=Io().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>new t,providedIn:"platform"})}}return t})();function WS(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function jS(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function es(t){return t&&t[0]!=="?"?"?"+t:t}var Jd=(()=>{class t{historyGo(n){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(KS),providedIn:"root"})}}return t})(),WV=new U(""),KS=(()=>{class t extends Jd{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??M(In).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return WS(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+es(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+es(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+es(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static{this.\u0275fac=function(r){return new(r||t)(J(GS),J(WV,8))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var yc=(()=>{class t{constructor(n){this._subject=new Ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=YV(jS(BS(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+es(r))}normalize(n){return t.stripTrailingSlash(QV(this._basePath,BS(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+es(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+es(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}static{this.normalizeQueryParams=es}static{this.joinWithSlash=WS}static{this.stripTrailingSlash=jS}static{this.\u0275fac=function(r){return new(r||t)(J(Jd))}}static{this.\u0275prov=H({token:t,factory:()=>KV(),providedIn:"root"})}}return t})();function KV(){return new yc(J(Jd))}function QV(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function BS(t){return t.replace(/\/index.html$/,"")}function YV(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}var Bt=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(Bt||{}),xe=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(xe||{}),an=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(an||{}),oi={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function ZV(t){return yn(t)[tt.LocaleId]}function JV(t,e,n){let r=yn(t),i=[r[tt.DayPeriodsFormat],r[tt.DayPeriodsStandalone]],s=vn(i,e);return vn(s,n)}function XV(t,e,n){let r=yn(t),i=[r[tt.DaysFormat],r[tt.DaysStandalone]],s=vn(i,e);return vn(s,n)}function eU(t,e,n){let r=yn(t),i=[r[tt.MonthsFormat],r[tt.MonthsStandalone]],s=vn(i,e);return vn(s,n)}function tU(t,e){let r=yn(t)[tt.Eras];return vn(r,e)}function Bd(t,e){let n=yn(t);return vn(n[tt.DateFormat],e)}function $d(t,e){let n=yn(t);return vn(n[tt.TimeFormat],e)}function Hd(t,e){let r=yn(t)[tt.DateTimeFormat];return vn(r,e)}function Xd(t,e){let n=yn(t),r=n[tt.NumberSymbols][e];if(typeof r>"u"){if(e===oi.CurrencyDecimal)return n[tt.NumberSymbols][oi.Decimal];if(e===oi.CurrencyGroup)return n[tt.NumberSymbols][oi.Group]}return r}function QS(t){if(!t[tt.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[tt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function nU(t){let e=yn(t);return QS(e),(e[tt.ExtraData][2]||[]).map(r=>typeof r=="string"?Fm(r):[Fm(r[0]),Fm(r[1])])}function rU(t,e,n){let r=yn(t);QS(r);let i=[r[tt.ExtraData][0],r[tt.ExtraData][1]],s=vn(i,e)||[];return vn(s,n)||[]}function vn(t,e){for(let n=e;n>-1;n--)if(typeof t[n]<"u")return t[n];throw new Error("Locale data API: locale data undefined")}function Fm(t){let[e,n]=t.split(":");return{hours:+e,minutes:+n}}var iU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,qd={},sU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Tr=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(Tr||{}),be=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(be||{}),Ce=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(Ce||{});function oU(t,e,n,r){let i=gU(t);e=Er(n,e)||e;let o=[],a;for(;e;)if(a=sU.exec(e),a){o=o.concat(a.slice(1));let d=o.pop();if(!d)break;e=d}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=ZS(r,c),i=pU(i,r,!0));let l="";return o.forEach(d=>{let p=hU(d);l+=p?p(i,n,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Yd(t,e,n){let r=new Date(0);return r.setFullYear(t,e,n),r.setHours(0,0,0),r}function Er(t,e){let n=ZV(t);if(qd[n]??={},qd[n][e])return qd[n][e];let r="";switch(e){case"shortDate":r=Bd(t,an.Short);break;case"mediumDate":r=Bd(t,an.Medium);break;case"longDate":r=Bd(t,an.Long);break;case"fullDate":r=Bd(t,an.Full);break;case"shortTime":r=$d(t,an.Short);break;case"mediumTime":r=$d(t,an.Medium);break;case"longTime":r=$d(t,an.Long);break;case"fullTime":r=$d(t,an.Full);break;case"short":let i=Er(t,"shortTime"),s=Er(t,"shortDate");r=zd(Hd(t,an.Short),[i,s]);break;case"medium":let o=Er(t,"mediumTime"),a=Er(t,"mediumDate");r=zd(Hd(t,an.Medium),[o,a]);break;case"long":let c=Er(t,"longTime"),l=Er(t,"longDate");r=zd(Hd(t,an.Long),[c,l]);break;case"full":let d=Er(t,"fullTime"),p=Er(t,"fullDate");r=zd(Hd(t,an.Full),[d,p]);break}return r&&(qd[n][e]=r),r}function zd(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(n,r){return e!=null&&r in e?e[r]:n})),t}function Pn(t,e,n="-",r,i){let s="";(t<0||i&&t<=0)&&(i?t=-t+1:(t=-t,s=n));let o=String(t);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function aU(t,e){return Pn(t,3).substring(0,e)}function at(t,e,n=0,r=!1,i=!1){return function(s,o){let a=cU(t,s);if((n>0||a>-n)&&(a+=n),t===be.Hours)a===0&&n===-12&&(a=12);else if(t===be.FractionalSeconds)return aU(a,e);let c=Xd(o,oi.MinusSign);return Pn(a,e,c,r,i)}}function cU(t,e){switch(t){case be.FullYear:return e.getFullYear();case be.Month:return e.getMonth();case be.Date:return e.getDate();case be.Hours:return e.getHours();case be.Minutes:return e.getMinutes();case be.Seconds:return e.getSeconds();case be.FractionalSeconds:return e.getMilliseconds();case be.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}function Fe(t,e,n=Bt.Format,r=!1){return function(i,s){return uU(i,s,t,e,n,r)}}function uU(t,e,n,r,i,s){switch(n){case Ce.Months:return eU(e,i,r)[t.getMonth()];case Ce.Days:return XV(e,i,r)[t.getDay()];case Ce.DayPeriods:let o=t.getHours(),a=t.getMinutes();if(s){let l=nU(e),d=rU(e,i,r),p=l.findIndex(g=>{if(Array.isArray(g)){let[_,E]=g,R=o>=_.hours&&a>=_.minutes,A=o<E.hours||o===E.hours&&a<E.minutes;if(_.hours<E.hours){if(R&&A)return!0}else if(R||A)return!0}else if(g.hours===o&&g.minutes===a)return!0;return!1});if(p!==-1)return d[p]}return JV(e,i,r)[o<12?0:1];case Ce.Eras:return tU(e,r)[t.getFullYear()<=0?0:1];default:let c=n;throw new Error(`unexpected translation type ${c}`)}}function Gd(t){return function(e,n,r){let i=-1*r,s=Xd(n,oi.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case Tr.Short:return(i>=0?"+":"")+Pn(o,2,s)+Pn(Math.abs(i%60),2,s);case Tr.ShortGMT:return"GMT"+(i>=0?"+":"")+Pn(o,1,s);case Tr.Long:return"GMT"+(i>=0?"+":"")+Pn(o,2,s)+":"+Pn(Math.abs(i%60),2,s);case Tr.Extended:return r===0?"Z":(i>=0?"+":"")+Pn(o,2,s)+":"+Pn(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}var lU=0,Kd=4;function dU(t){let e=Yd(t,lU,1).getDay();return Yd(t,0,1+(e<=Kd?Kd:Kd+7)-e)}function YS(t){let e=t.getDay(),n=e===0?-3:Kd-e;return Yd(t.getFullYear(),t.getMonth(),t.getDate()+n)}function Lm(t,e=!1){return function(n,r){let i;if(e){let s=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+s)/7)}else{let s=YS(n),o=dU(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Pn(i,t,Xd(r,oi.MinusSign))}}function Wd(t,e=!1){return function(n,r){let s=YS(n).getFullYear();return Pn(s,t,Xd(r,oi.MinusSign),e)}}var Vm={};function hU(t){if(Vm[t])return Vm[t];let e;switch(t){case"G":case"GG":case"GGG":e=Fe(Ce.Eras,xe.Abbreviated);break;case"GGGG":e=Fe(Ce.Eras,xe.Wide);break;case"GGGGG":e=Fe(Ce.Eras,xe.Narrow);break;case"y":e=at(be.FullYear,1,0,!1,!0);break;case"yy":e=at(be.FullYear,2,0,!0,!0);break;case"yyy":e=at(be.FullYear,3,0,!1,!0);break;case"yyyy":e=at(be.FullYear,4,0,!1,!0);break;case"Y":e=Wd(1);break;case"YY":e=Wd(2,!0);break;case"YYY":e=Wd(3);break;case"YYYY":e=Wd(4);break;case"M":case"L":e=at(be.Month,1,1);break;case"MM":case"LL":e=at(be.Month,2,1);break;case"MMM":e=Fe(Ce.Months,xe.Abbreviated);break;case"MMMM":e=Fe(Ce.Months,xe.Wide);break;case"MMMMM":e=Fe(Ce.Months,xe.Narrow);break;case"LLL":e=Fe(Ce.Months,xe.Abbreviated,Bt.Standalone);break;case"LLLL":e=Fe(Ce.Months,xe.Wide,Bt.Standalone);break;case"LLLLL":e=Fe(Ce.Months,xe.Narrow,Bt.Standalone);break;case"w":e=Lm(1);break;case"ww":e=Lm(2);break;case"W":e=Lm(1,!0);break;case"d":e=at(be.Date,1);break;case"dd":e=at(be.Date,2);break;case"c":case"cc":e=at(be.Day,1);break;case"ccc":e=Fe(Ce.Days,xe.Abbreviated,Bt.Standalone);break;case"cccc":e=Fe(Ce.Days,xe.Wide,Bt.Standalone);break;case"ccccc":e=Fe(Ce.Days,xe.Narrow,Bt.Standalone);break;case"cccccc":e=Fe(Ce.Days,xe.Short,Bt.Standalone);break;case"E":case"EE":case"EEE":e=Fe(Ce.Days,xe.Abbreviated);break;case"EEEE":e=Fe(Ce.Days,xe.Wide);break;case"EEEEE":e=Fe(Ce.Days,xe.Narrow);break;case"EEEEEE":e=Fe(Ce.Days,xe.Short);break;case"a":case"aa":case"aaa":e=Fe(Ce.DayPeriods,xe.Abbreviated);break;case"aaaa":e=Fe(Ce.DayPeriods,xe.Wide);break;case"aaaaa":e=Fe(Ce.DayPeriods,xe.Narrow);break;case"b":case"bb":case"bbb":e=Fe(Ce.DayPeriods,xe.Abbreviated,Bt.Standalone,!0);break;case"bbbb":e=Fe(Ce.DayPeriods,xe.Wide,Bt.Standalone,!0);break;case"bbbbb":e=Fe(Ce.DayPeriods,xe.Narrow,Bt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Fe(Ce.DayPeriods,xe.Abbreviated,Bt.Format,!0);break;case"BBBB":e=Fe(Ce.DayPeriods,xe.Wide,Bt.Format,!0);break;case"BBBBB":e=Fe(Ce.DayPeriods,xe.Narrow,Bt.Format,!0);break;case"h":e=at(be.Hours,1,-12);break;case"hh":e=at(be.Hours,2,-12);break;case"H":e=at(be.Hours,1);break;case"HH":e=at(be.Hours,2);break;case"m":e=at(be.Minutes,1);break;case"mm":e=at(be.Minutes,2);break;case"s":e=at(be.Seconds,1);break;case"ss":e=at(be.Seconds,2);break;case"S":e=at(be.FractionalSeconds,1);break;case"SS":e=at(be.FractionalSeconds,2);break;case"SSS":e=at(be.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Gd(Tr.Short);break;case"ZZZZZ":e=Gd(Tr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Gd(Tr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Gd(Tr.Long);break;default:return null}return Vm[t]=e,e}function ZS(t,e){t=t.replace(/:/g,"");let n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function fU(t,e){return t=new Date(t.getTime()),t.setMinutes(t.getMinutes()+e),t}function pU(t,e,n){let r=n?-1:1,i=t.getTimezoneOffset(),s=ZS(e,i);return fU(t,r*(s-i))}function gU(t){if($S(t))return t;if(typeof t=="number"&&!isNaN(t))return new Date(t);if(typeof t=="string"){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){let[i,s=1,o=1]=t.split("-").map(a=>+a);return Yd(i,s-1,o)}let n=parseFloat(t);if(!isNaN(t-n))return new Date(n);let r;if(r=t.match(iU))return mU(r)}let e=new Date(t);if(!$S(e))throw new Error(`Unable to convert "${t}" into a date`);return e}function mU(t){let e=new Date(0),n=0,r=0,i=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));let o=Number(t[4]||0)-n,a=Number(t[5]||0)-r,c=Number(t[6]||0),l=Math.floor(parseFloat("0."+(t[7]||0))*1e3);return s.call(e,o,a,c,l),e}function $S(t){return t instanceof Date&&!isNaN(t.valueOf())}function JS(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}function _U(t,e){return new W(2100,!1)}var yU="mediumDate",vU=new U(""),IU=new U(""),XS=(()=>{class t{constructor(n,r,i){this.locale=n,this.defaultTimezone=r,this.defaultOptions=i}transform(n,r,i,s){if(n==null||n===""||n!==n)return null;try{let o=r??this.defaultOptions?.dateFormat??yU,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return oU(n,o,s||this.locale,a)}catch(o){throw _U(t,o.message)}}static{this.\u0275fac=function(r){return new(r||t)(Wi(Vd,16),Wi(vU,24),Wi(IU,24))}}static{this.\u0275pipe=Gb({name:"date",type:t,pure:!0,standalone:!0})}}return t})();var Bm="browser",wU="server";function $m(t){return t===Bm}function Hm(t){return t===wU}var Zd=class{};var Gm=class extends Qd{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Wm=class t extends Gm{static makeCurrent(){zS(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=EU();return n==null?null:TU(n)}resetBaseElement(){vc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return JS(document.cookie,e)}},vc=null;function EU(){return vc=vc||document.querySelector("base"),vc?vc.getAttribute("href"):null}function TU(t){return new URL(t,document.baseURI).pathname}var CU=(()=>{class t{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})(),Km=new U(""),rA=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new W(5101,!1);return this._eventNameToPlugin.set(n,r),r}static{this.\u0275fac=function(r){return new(r||t)(J(Km),J(Z))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})(),eh=class{constructor(e){this._doc=e}},qm="ng-app-id",iA=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Hm(s),this.resetHostNodes()}addStyles(n){for(let r of n)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(n){for(let r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){let r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${qm}="${this.appId}"]`);if(n?.length){let r=new Map;return n.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){let i=this.styleRef;if(i.has(n)){let s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(qm),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(qm,this.appId),n.appendChild(o),o}}addStyleToHost(n,r){let i=this.getStyleElement(n,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||t)(J(In),J(_m),J(vm,8),J(Nn))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})(),zm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ym=/%COMP%/g,sA="%COMP%",bU=`_nghost-${sA}`,DU=`_ngcontent-${sA}`,SU=!0,AU=new U("",{providedIn:"root",factory:()=>SU});function RU(t){return DU.replace(Ym,t)}function NU(t){return bU.replace(Ym,t)}function oA(t,e){return e.map(n=>n.replace(Ym,t))}var eA=(()=>{class t{constructor(n,r,i,s,o,a,c,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Hm(a),this.defaultRenderer=new Ic(n,o,c,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Wn.ShadowDom&&(r=Ae(V({},r),{encapsulation:Wn.Emulated}));let i=this.getOrCreateRenderer(n,r);return i instanceof th?i.applyToHost(n):i instanceof wc&&i.applyStyles(),i}getOrCreateRenderer(n,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case Wn.Emulated:s=new th(c,l,r,this.appId,d,o,a,p);break;case Wn.ShadowDom:return new Qm(c,l,n,r,o,a,this.nonce,p);default:s=new wc(c,l,r,d,o,a,p);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||t)(J(rA),J(iA),J(_m),J(AU),J(In),J(Nn),J(Z),J(vm))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})(),Ic=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(zm[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(tA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(tA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){n.remove()}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new W(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=zm[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=zm[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Gi.DashCase|Gi.Important)?e.style.setProperty(n,r,i&Gi.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Gi.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Io().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function tA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Qm=class extends Ic{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=oA(i.id,i.styles);for(let d of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=d,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},wc=class extends Ic{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?oA(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},th=class extends wc{constructor(e,n,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,n,r,s,o,a,c,l),this.contentAttr=RU(l),this.hostAttr=NU(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},PU=(()=>{class t extends eh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||t)(J(In))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})(),nA=["alt","control","meta","shift"],MU={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xU={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},kU=(()=>{class t extends eh{constructor(n){super(n)}supports(n){return t.parseEventName(n)!=null}addEventListener(n,r,i){let s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Io().onAndCancel(n,s.domEventName,o))}static parseEventName(n){let r=n.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=t._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),nA.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(n,r){let i=MU[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),nA.forEach(o=>{if(o!==i){let a=xU[o];a(n)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return n==="esc"?"escape":n}static{this.\u0275fac=function(r){return new(r||t)(J(In))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac})}}return t})();function aA(t,e){return US(V({rootComponent:t},OU(e)))}function OU(t){return{appProviders:[...jU,...t?.providers??[]],platformProviders:UU}}function FU(){Wm.makeCurrent()}function LU(){return new Yn}function VU(){return QD(document),document}var UU=[{provide:Nn,useValue:Bm},{provide:ym,useValue:FU,multi:!0},{provide:In,useFactory:VU,deps:[]}];var jU=[{provide:Td,useValue:"root"},{provide:Yn,useFactory:LU,deps:[]},{provide:Km,useClass:PU,multi:!0,deps:[In,Z,Nn]},{provide:Km,useClass:kU,multi:!0,deps:[In]},eA,iA,rA,{provide:po,useExisting:eA},{provide:Zd,useClass:CU,deps:[]},[]];var nh=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static{this.\u0275fac=function(r){return new(r||t)(J(In))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var oe="primary",Uc=Symbol("RouteTitle"),t_=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Do(t){return new t_(t)}function BU(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function $U(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Xn(t[n],e[n]))return!1;return!0}function Xn(t,e){let n=t?n_(t):void 0,r=e?n_(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!mA(t[i],e[i]))return!1;return!0}function n_(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function mA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function _A(t){return t.length>0?t[t.length-1]:null}function ai(t){return Xp(t)?t:_c(t)?Ke(Promise.resolve(t)):K(t)}var HU={exact:vA,subset:IA},yA={exact:qU,subset:zU,ignored:()=>!0};function uA(t,e,n){return HU[n.paths](t.root,e.root,n.matrixParams)&&yA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function qU(t,e){return Xn(t,e)}function vA(t,e,n){if(!ns(t.segments,e.segments)||!sh(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!vA(t.children[r],e.children[r],n))return!1;return!0}function zU(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>mA(t[n],e[n]))}function IA(t,e,n){return wA(t,e,e.segments,n)}function wA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!ns(i,n)||e.hasChildren()||!sh(i,n,r))}else if(t.segments.length===n.length){if(!ns(t.segments,n)||!sh(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!IA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!ns(t.segments,i)||!sh(t.segments,i,r)||!t.children[oe]?!1:wA(t.children[oe],e,s,r)}}function sh(t,e,n){return e.every((r,i)=>yA[n](t[i].parameters,r.parameters))}var br=class{constructor(e=new De([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Do(this.queryParams),this._queryParamMap}toString(){return KU.serialize(this)}},De=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return oh(this)}},ts=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Do(this.parameters),this._parameterMap}toString(){return TA(this)}};function GU(t,e){return ns(t,e)&&t.every((n,r)=>Xn(n.parameters,e[r].parameters))}function ns(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function WU(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===oe&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==oe&&(n=n.concat(e(i,r)))}),n}var S_=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>new Ac,providedIn:"root"})}}return t})(),Ac=class{parse(e){let n=new i_(e);return new br(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Ec(e.root,!0)}`,r=ZU(e.queryParams),i=typeof e.fragment=="string"?`#${QU(e.fragment)}`:"";return`${n}${r}${i}`}},KU=new Ac;function oh(t){return t.segments.map(e=>TA(e)).join("/")}function Ec(t,e){if(!t.hasChildren())return oh(t);if(e){let n=t.children[oe]?Ec(t.children[oe],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==oe&&r.push(`${i}:${Ec(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=WU(t,(r,i)=>i===oe?[Ec(t.children[oe],!1)]:[`${i}:${Ec(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[oe]!=null?`${oh(t)}/${n[0]}`:`${oh(t)}/(${n.join("//")})`}}function EA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function rh(t){return EA(t).replace(/%3B/gi,";")}function QU(t){return encodeURI(t)}function r_(t){return EA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ah(t){return decodeURIComponent(t)}function lA(t){return ah(t.replace(/\+/g,"%20"))}function TA(t){return`${r_(t.path)}${YU(t.parameters)}`}function YU(t){return Object.entries(t).map(([e,n])=>`;${r_(e)}=${r_(n)}`).join("")}function ZU(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${rh(n)}=${rh(i)}`).join("&"):`${rh(n)}=${rh(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var JU=/^[^\/()?;#]+/;function Zm(t){let e=t.match(JU);return e?e[0]:""}var XU=/^[^\/()?;=#]+/;function ej(t){let e=t.match(XU);return e?e[0]:""}var tj=/^[^=?&#]+/;function nj(t){let e=t.match(tj);return e?e[0]:""}var rj=/^[^&#]+/;function ij(t){let e=t.match(rj);return e?e[0]:""}var i_=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new De([],{}):new De([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[oe]=new De(e,n)),r}parseSegment(){let e=Zm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new W(4009,!1);return this.capture(e),new ts(ah(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=ej(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Zm(this.remaining);i&&(r=i,this.capture(r))}e[ah(n)]=ah(r)}parseQueryParam(e){let n=nj(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=ij(this.remaining);o&&(r=o,this.capture(r))}let i=lA(n),s=lA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Zm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new W(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=oe);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[oe]:new De([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new W(4011,!1)}};function CA(t){return t.segments.length>0?new De([],{[oe]:t}):t}function bA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=bA(i);if(r===oe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new De(t.segments,e);return sj(n)}function sj(t){if(t.numberOfChildren===1&&t.children[oe]){let e=t.children[oe];return new De(t.segments.concat(e.segments),e.children)}return t}function Rc(t){return t instanceof br}function oj(t,e,n=null,r=null){let i=DA(t);return SA(i,e,n,r)}function DA(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new De(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=CA(r);return e??i}function SA(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Jm(i,i,i,n,r);let s=aj(e);if(s.toRoot())return Jm(i,i,new De([],{}),n,r);let o=cj(s,i,t),a=o.processChildren?bc(o.segmentGroup,o.index,s.commands):RA(o.segmentGroup,o.index,s.commands);return Jm(i,o.segmentGroup,a,n,r)}function ch(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Nc(t){return typeof t=="object"&&t!=null&&t.outlets}function Jm(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;t===e?o=n:o=AA(t,e,n);let a=CA(bA(o));return new br(a,s,i)}function AA(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=AA(s,e,n)}),new De(t.segments,r)}var uh=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&ch(r[0]))throw new W(4003,!1);let i=r.find(Nc);if(i&&i!==_A(r))throw new W(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function aj(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new uh(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new uh(n,e,r)}var To=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function cj(t,e,n){if(t.isAbsolute)return new To(e,!0,0);if(!n)return new To(e,!1,NaN);if(n.parent===null)return new To(n,!0,0);let r=ch(t.commands[0])?0:1,i=n.segments.length-1+r;return uj(n,i,t.numberOfDoubleDots)}function uj(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new W(4005,!1);i=r.segments.length}return new To(r,!1,i-s)}function lj(t){return Nc(t[0])?t[0].outlets:{[oe]:t}}function RA(t,e,n){if(t??=new De([],{}),t.segments.length===0&&t.hasChildren())return bc(t,e,n);let r=dj(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new De(t.segments.slice(0,r.pathIndex),{});return s.children[oe]=new De(t.segments.slice(r.pathIndex),t.children),bc(s,0,i)}else return r.match&&i.length===0?new De(t.segments,{}):r.match&&!t.hasChildren()?s_(t,e,n):r.match?bc(t,0,i):s_(t,e,n)}function bc(t,e,n){if(n.length===0)return new De(t.segments,{});{let r=lj(n),i={};if(Object.keys(r).some(s=>s!==oe)&&t.children[oe]&&t.numberOfChildren===1&&t.children[oe].segments.length===0){let s=bc(t.children[oe],e,n);return new De(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=RA(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new De(t.segments,i)}}function dj(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Nc(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!hA(c,l,o))return s;r+=2}else{if(!hA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function s_(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Nc(s)){let c=hj(s.outlets);return new De(r,c)}if(i===0&&ch(n[0])){let c=t.segments[e];r.push(new ts(c.path,dA(n[0]))),i++;continue}let o=Nc(s)?s.outlets[oe]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&ch(a)?(r.push(new ts(o,dA(a))),i+=2):(r.push(new ts(o,{})),i++)}return new De(r,{})}function hj(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=s_(new De([],{}),0,r))}),e}function dA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function hA(t,e,n){return t==n.path&&Xn(e,n.parameters)}var Dc="imperative",Et=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Et||{}),wn=class{constructor(e,n){this.id=e,this.url=n}},Pc=class extends wn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=Et.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},rs=class extends wn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=Et.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},un=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(un||{}),o_=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(o_||{}),Cr=class extends wn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Et.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},is=class extends wn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Et.NavigationSkipped}},Mc=class extends wn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=Et.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lh=class extends wn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Et.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},a_=class extends wn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Et.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},c_=class extends wn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Et.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},u_=class extends wn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Et.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},l_=class extends wn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Et.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},d_=class{constructor(e){this.route=e,this.type=Et.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},h_=class{constructor(e){this.route=e,this.type=Et.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},f_=class{constructor(e){this.snapshot=e,this.type=Et.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},p_=class{constructor(e){this.snapshot=e,this.type=Et.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},g_=class{constructor(e){this.snapshot=e,this.type=Et.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xc=class{constructor(e){this.snapshot=e,this.type=Et.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var kc=class{},So=class{constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}};function fj(t,e){return t.providers&&!t._injector&&(t._injector=Nm(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Mn(t){return t.outlet||oe}function pj(t,e){let n=t.filter(r=>Mn(r)===e);return n.push(...t.filter(r=>Mn(r)!==e)),n}function jc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var m_=class{get injector(){return jc(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new _h(this.rootInjector),this.attachRef=null}},_h=(()=>{class t{constructor(n){this.rootInjector=n,this.contexts=new Map}onChildOutletCreated(n,r){let i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new m_(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static{this.\u0275fac=function(r){return new(r||t)(J(gn))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),dh=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=__(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=__(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=y_(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return y_(e,this._root).map(n=>n.value)}};function __(t,e){if(t===e.value)return e;for(let n of e.children){let r=__(t,n);if(r)return r}return null}function y_(t,e){if(t===e.value)return[e];for(let n of e.children){let r=y_(t,n);if(r.length)return r.unshift(e),r}return[]}var cn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Eo(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var hh=class extends dh{constructor(e,n){super(e),this.snapshot=n,A_(this,e)}toString(){return this.snapshot.toString()}};function NA(t){let e=gj(t),n=new It([new ts("",{})]),r=new It({}),i=new It({}),s=new It({}),o=new It(""),a=new Ao(n,r,s,o,i,oe,t,e.root);return a.snapshot=e.root,new hh(new cn(a,[]),e)}function gj(t){let e={},n={},r={},i="",s=new Co([],e,r,i,n,oe,t,null,{});return new ph("",new cn(s,[]))}var Ao=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Q(l=>l[Uc]))??K(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Q(e=>Do(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Q(e=>Do(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function fh(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),t.params),data:V(V({},e.data),t.data),resolve:V(V(V(V({},t.data),e.data),i?.data),t._resolvedData)}:r={params:V({},t.params),data:V({},t.data),resolve:V(V({},t.data),t._resolvedData??{})},i&&MA(i)&&(r.resolve[Uc]=i.title),r}var Co=class{get title(){return this.data?.[Uc]}constructor(e,n,r,i,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Do(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Do(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},ph=class extends dh{constructor(e,n){super(n),this.url=e,A_(this,n)}toString(){return PA(this._root)}};function A_(t,e){e.value._routerState=t,e.children.forEach(n=>A_(t,n))}function PA(t){let e=t.children.length>0?` { ${t.children.map(PA).join(", ")} } `:"";return`${t.value}${e}`}function Xm(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Xn(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Xn(e.params,n.params)||t.paramsSubject.next(n.params),$U(e.url,n.url)||t.urlSubject.next(n.url),Xn(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function v_(t,e){let n=Xn(t.params,e.params)&&GU(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||v_(t.parent,e.parent))}function MA(t){return typeof t.title=="string"||t.title===null}var R_=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new Ut,this.deactivateEvents=new Ut,this.attachEvents=new Ut,this.detachEvents=new Ut,this.parentContexts=M(_h),this.location=M(Od),this.changeDetector=M(vo),this.inputBinder=M(N_,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new W(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new W(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new W(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new W(4013,!1);this._activatedRoute=n;let i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new I_(n,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275dir=em({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Dd]})}}return t})(),I_=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ao?this.route:e===_h?this.childContexts:this.parent.get(e,n)}},N_=new U("");function mj(t,e,n){let r=Oc(t,e._root,n?n._root:void 0);return new hh(r,e)}function Oc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=_j(t,e,n);return new cn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Oc(t,a)),o}}let r=yj(e.value),i=e.children.map(s=>Oc(t,s));return new cn(r,i)}}function _j(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Oc(t,r,i);return Oc(t,r)})}function yj(t){return new Ao(new It(t.url),new It(t.params),new It(t.queryParams),new It(t.fragment),new It(t.data),t.outlet,t.component,t)}var Fc=class{constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}},xA="ngNavigationCancelingError";function gh(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Rc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=kA(!1,un.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function kA(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[xA]=!0,n.cancellationCode=e,n}function vj(t){return OA(t)&&Rc(t.url)}function OA(t){return!!t&&t[xA]}var Ij=(t,e,n,r)=>Q(i=>(new w_(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),w_=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Xm(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Eo(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Eo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Eo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Eo(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new xc(s.value.snapshot))}),e.children.length&&this.forwardEvent(new p_(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Xm(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Xm(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},mh=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},bo=class{constructor(e,n){this.component=e,this.route=n}};function wj(t,e,n){let r=t._root,i=e?e._root:null;return Tc(r,i,n,[r.value])}function Ej(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function No(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!kb(t)?t:e.get(t):r}function Tc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Eo(e);return t.children.forEach(o=>{Tj(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Sc(a,n.getContext(o),i)),i}function Tj(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=Cj(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new mh(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Tc(t,e,a?a.children:null,r,i):Tc(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new bo(a.outlet.component,o))}else o&&Sc(e,a,i),i.canActivateChecks.push(new mh(r)),s.component?Tc(t,null,a?a.children:null,r,i):Tc(t,null,n,r,i);return i}function Cj(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!ns(t.url,e.url);case"pathParamsOrQueryParamsChange":return!ns(t.url,e.url)||!Xn(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!v_(t,e)||!Xn(t.queryParams,e.queryParams);case"paramsChange":default:return!v_(t,e)}}function Sc(t,e,n){let r=Eo(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Sc(o,e.children.getContext(s),n):Sc(o,null,n):Sc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new bo(e.outlet.component,i)):n.canDeactivateChecks.push(new bo(null,i)):n.canDeactivateChecks.push(new bo(null,i))}function Bc(t){return typeof t=="function"}function bj(t){return typeof t=="boolean"}function Dj(t){return t&&Bc(t.canLoad)}function Sj(t){return t&&Bc(t.canActivate)}function Aj(t){return t&&Bc(t.canActivateChild)}function Rj(t){return t&&Bc(t.canDeactivate)}function Nj(t){return t&&Bc(t.canMatch)}function FA(t){return t instanceof gr||t?.name==="EmptyError"}var ih=Symbol("INITIAL_VALUE");function Ro(){return Wt(t=>Zs(t.map(e=>e.pipe(mr(1),eo(ih)))).pipe(Q(e=>{for(let n of e)if(n!==!0){if(n===ih)return ih;if(n===!1||Pj(n))return n}return!0}),Vt(e=>e!==ih),mr(1)))}function Pj(t){return Rc(t)||t instanceof Fc}function Mj(t,e){return et(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?K(Ae(V({},n),{guardsResult:!0})):xj(o,r,i,t).pipe(et(a=>a&&bj(a)?kj(r,s,t,e):K(a)),Q(a=>Ae(V({},n),{guardsResult:a})))})}function xj(t,e,n,r){return Ke(t).pipe(et(i=>Uj(i.component,i.route,n,e,r)),qn(i=>i!==!0,!0))}function kj(t,e,n,r){return Ke(e).pipe(ki(i=>Js(Fj(i.route.parent,r),Oj(i.route,r),Vj(t,i.path,n),Lj(t,i.route,n))),qn(i=>i!==!0,!0))}function Oj(t,e){return t!==null&&e&&e(new g_(t)),K(!0)}function Fj(t,e){return t!==null&&e&&e(new f_(t)),K(!0)}function Lj(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return K(!0);let i=r.map(s=>Vl(()=>{let o=jc(e)??n,a=No(s,o),c=Sj(a)?a.canActivate(e,t):yr(o,()=>a(e,t));return ai(c).pipe(qn())}));return K(i).pipe(Ro())}function Vj(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Ej(o)).filter(o=>o!==null).map(o=>Vl(()=>{let a=o.guards.map(c=>{let l=jc(o.node)??n,d=No(c,l),p=Aj(d)?d.canActivateChild(r,t):yr(l,()=>d(r,t));return ai(p).pipe(qn())});return K(a).pipe(Ro())}));return K(s).pipe(Ro())}function Uj(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(a=>{let c=jc(e)??i,l=No(a,c),d=Rj(l)?l.canDeactivate(t,e,n,r):yr(c,()=>l(t,e,n,r));return ai(d).pipe(qn())});return K(o).pipe(Ro())}function jj(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let s=i.map(o=>{let a=No(o,t),c=Dj(a)?a.canLoad(e,n):yr(t,()=>a(e,n));return ai(c)});return K(s).pipe(Ro(),LA(r))}function LA(t){return Tl(ft(e=>{if(typeof e!="boolean")throw gh(t,e)}),Q(e=>e===!0))}function Bj(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return K(!0);let s=i.map(o=>{let a=No(o,t),c=Nj(a)?a.canMatch(e,n):yr(t,()=>a(e,n));return ai(c)});return K(s).pipe(Ro(),LA(r))}var Lc=class{constructor(e){this.segmentGroup=e||null}},Vc=class extends Error{constructor(e){super(),this.urlTree=e}};function wo(t){return Ys(new Lc(t))}function $j(t){return Ys(new W(4e3,!1))}function Hj(t){return Ys(kA(!1,un.GuardRejected))}var E_=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return K(r);if(i.numberOfChildren>1||!i.children[oe])return $j(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,n,r,i,s){if(typeof n!="string"){let a=n,{queryParams:c,fragment:l,routeConfig:d,url:p,outlet:g,params:_,data:E,title:R}=i,A=yr(s,()=>a({params:_,data:E,queryParams:c,fragment:l,routeConfig:d,url:p,outlet:g,title:R}));if(A instanceof br)throw new Vc(A);n=A}let o=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n[0]==="/")throw new Vc(o);return o}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new br(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new De(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new W(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},T_={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qj(t,e,n,r,i){let s=VA(t,e,n);return s.matched?(r=fj(e,r),Bj(r,e,n,i).pipe(Q(o=>o===!0?s:V({},T_)))):K(s)}function VA(t,e,n){if(e.path==="**")return zj(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?V({},T_):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||BU)(n,t,e);if(!i)return V({},T_);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function zj(t){return{matched:!0,parameters:t.length>0?_A(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function fA(t,e,n,r){return n.length>0&&Kj(t,n,r)?{segmentGroup:new De(e,Wj(r,new De(n,t.children))),slicedSegments:[]}:n.length===0&&Qj(t,n,r)?{segmentGroup:new De(t.segments,Gj(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new De(t.segments,t.children),slicedSegments:n}}function Gj(t,e,n,r){let i={};for(let s of n)if(yh(t,e,s)&&!r[Mn(s)]){let o=new De([],{});i[Mn(s)]=o}return V(V({},r),i)}function Wj(t,e){let n={};n[oe]=e;for(let r of t)if(r.path===""&&Mn(r)!==oe){let i=new De([],{});n[Mn(r)]=i}return n}function Kj(t,e,n){return n.some(r=>yh(t,e,r)&&Mn(r)!==oe)}function Qj(t,e,n){return n.some(r=>yh(t,e,r))}function yh(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Yj(t,e,n){return e.length===0&&!t.children[n]}var C_=class{};function Zj(t,e,n,r,i,s,o="emptyOnly"){return new b_(t,e,n,r,i,o,s).recognize()}var Jj=31,b_=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new E_(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new W(4002,`'${e.segmentGroup}'`)}recognize(){let e=fA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Q(({children:n,rootSnapshot:r})=>{let i=new cn(r,n),s=new ph("",i),o=oj(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let n=new Co([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,n).pipe(Q(r=>({children:r,rootSnapshot:n})),Kr(r=>{if(r instanceof Vc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Lc?this.noMatchError(r):r}))}processSegmentGroup(e,n,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r,s):this.processSegment(e,n,r,r.segments,i,!0,s).pipe(Q(o=>o instanceof cn?[o]:[]))}processChildren(e,n,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return Ke(s).pipe(ki(o=>{let a=r.children[o],c=pj(n,o);return this.processSegmentGroup(e,c,a,o,i)}),$l((o,a)=>(o.push(...a),o)),Qr(null),rg(),et(o=>{if(o===null)return wo(r);let a=UA(o);return Xj(a),K(a)}))}processSegment(e,n,r,i,s,o,a){return Ke(n).pipe(ki(c=>this.processSegmentAgainstRoute(c._injector??e,n,c,r,i,s,o,a).pipe(Kr(l=>{if(l instanceof Lc)return K(null);throw l}))),qn(c=>!!c),Kr(c=>{if(FA(c))return Yj(r,i,s)?K(new C_):wo(r);throw c}))}processSegmentAgainstRoute(e,n,r,i,s,o,a,c){return Mn(r)!==o&&(o===oe||!yh(i,s,r))?wo(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o,c):wo(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:d,positionalParamSegments:p,remainingSegments:g}=VA(n,i,s);if(!c)return wo(n);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Jj&&(this.allowRedirects=!1));let _=new Co(s,l,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,pA(i),Mn(i),i.component??i._loadedComponent??null,i,gA(i)),E=fh(_,a,this.paramsInheritanceStrategy);_.params=Object.freeze(E.params),_.data=Object.freeze(E.data);let R=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,p,_,e);return this.applyRedirects.lineralizeSegments(i,R).pipe(et(A=>this.processSegment(e,r,n,A.concat(g),o,!1,a)))}matchSegmentAgainstRoute(e,n,r,i,s,o){let a=qj(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),a.pipe(Wt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Wt(({routes:l})=>{let d=r._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:_}=c,E=new Co(g,p,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,pA(r),Mn(r),r.component??r._loadedComponent??null,r,gA(r)),R=fh(E,o,this.paramsInheritanceStrategy);E.params=Object.freeze(R.params),E.data=Object.freeze(R.data);let{segmentGroup:A,slicedSegments:x}=fA(n,g,_,l);if(x.length===0&&A.hasChildren())return this.processChildren(d,l,A,E).pipe(Q($=>new cn(E,$)));if(l.length===0&&x.length===0)return K(new cn(E,[]));let L=Mn(r)===s;return this.processSegment(d,l,A,x,L?oe:s,!0,E).pipe(Q($=>new cn(E,$ instanceof cn?[$]:[])))}))):wo(n)))}getChildConfig(e,n,r){return n.children?K({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?K({routes:n._loadedRoutes,injector:n._loadedInjector}):jj(e,n,r,this.urlSerializer).pipe(et(i=>i?this.configLoader.loadChildren(e,n).pipe(ft(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):Hj(n))):K({routes:[],injector:e})}};function Xj(t){t.sort((e,n)=>e.value.outlet===oe?-1:n.value.outlet===oe?1:e.value.outlet.localeCompare(n.value.outlet))}function e2(t){let e=t.value.routeConfig;return e&&e.path===""}function UA(t){let e=[],n=new Set;for(let r of t){if(!e2(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=UA(r.children);e.push(new cn(r.value,i))}return e.filter(r=>!n.has(r))}function pA(t){return t.data||{}}function gA(t){return t.resolve||{}}function t2(t,e,n,r,i,s){return et(o=>Zj(t,e,n,r,o.extractedUrl,i,s).pipe(Q(({state:a,tree:c})=>Ae(V({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function n2(t,e){return et(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return K(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of jA(c))o.add(l);let a=0;return Ke(o).pipe(ki(c=>s.has(c)?r2(c,r,t,e):(c.data=fh(c,c.parent,t).resolve,K(void 0))),ft(()=>a++),Xs(1),et(c=>a===o.size?K(n):en))})}function jA(t){let e=t.children.map(n=>jA(n)).flat();return[t,...e]}function r2(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!MA(i)&&(s[Uc]=i.title),i2(s,t,e,r).pipe(Q(o=>(t._resolvedData=o,t.data=fh(t,t.parent,n).resolve,null)))}function i2(t,e,n,r){let i=n_(t);if(i.length===0)return K({});let s={};return Ke(i).pipe(et(o=>s2(t[o],e,n,r).pipe(qn(),ft(a=>{if(a instanceof Fc)throw gh(new Ac,a);s[o]=a}))),Xs(1),tg(s),Kr(o=>FA(o)?en:Ys(o)))}function s2(t,e,n,r){let i=jc(e)??r,s=No(t,i),o=s.resolve?s.resolve(e,n):yr(i,()=>s(e,n));return ai(o)}function e_(t){return Wt(e=>{let n=t(e);return n?Ke(n).pipe(Q(()=>e)):K(e)})}var BA=(()=>{class t{buildTitle(n){let r,i=n.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===oe);return r}getResolvedTitleForRoute(n){return n.data[Uc]}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(o2),providedIn:"root"})}}return t})(),o2=(()=>{class t extends BA{constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||t)(J(nh))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),P_=new U("",{providedIn:"root",factory:()=>({})}),M_=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=ni({type:t,selectors:[["ng-component"]],standalone:!0,features:[ii],decls:1,vars:0,template:function(r,i){r&1&&Yi(0,"router-outlet")},dependencies:[R_],encapsulation:2})}}return t})();function x_(t){let e=t.children&&t.children.map(x_),n=e?Ae(V({},t),{children:e}):V({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==oe&&(n.component=M_),n}var k_=new U(""),a2=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=M(km)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return K(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=ai(n.loadComponent()).pipe(Q($A),ft(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),nc(()=>{this.componentLoaders.delete(n)})),i=new Gs(r,()=>new $e).pipe(zs());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return K({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=c2(r,this.compiler,n,this.onLoadEndListener).pipe(nc(()=>{this.childrenLoaders.delete(r)})),o=new Gs(s,()=>new $e).pipe(zs());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function c2(t,e,n,r){return ai(t.loadChildren()).pipe(Q($A),et(i=>i instanceof pc||Array.isArray(i)?K(i):Ke(e.compileModuleAsync(i))),Q(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(k_,[],{optional:!0,self:!0}).flat()),{routes:o.map(x_),injector:s}}))}function u2(t){return t&&typeof t=="object"&&"default"in t}function $A(t){return u2(t)?t.default:t}var O_=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(l2),providedIn:"root"})}}return t})(),l2=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),d2=new U("");var h2=new U(""),f2=(()=>{class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new $e,this.transitionAbortSubject=new $e,this.configLoader=M(a2),this.environmentInjector=M(gn),this.urlSerializer=M(S_),this.rootContexts=M(_h),this.location=M(yc),this.inputBindingEnabled=M(N_,{optional:!0})!==null,this.titleStrategy=M(BA),this.options=M(P_,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=M(O_),this.createViewTransition=M(d2,{optional:!0}),this.navigationErrorHandler=M(h2,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let n=i=>this.events.next(new d_(i)),r=i=>this.events.next(new h_(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;this.transitions?.next(Ae(V(V({},this.transitions.value),n),{id:r}))}setupNavigations(n,r,i){return this.transitions=new It({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Dc,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(s=>s.id!==0),Q(s=>Ae(V({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Wt(s=>{let o=!1,a=!1;return K(s).pipe(Wt(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",un.SupersededByNewNavigation),en;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Ae(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!l&&d!=="reload"){let p="";return this.events.next(new is(c.id,this.urlSerializer.serialize(c.rawUrl),p,o_.IgnoredSameUrlNavigation)),c.resolve(!1),en}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return K(c).pipe(Wt(p=>{let g=this.transitions?.getValue();return this.events.next(new Pc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?en:Promise.resolve(p)}),t2(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),ft(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Ae(V({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new lh(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:p,extractedUrl:g,source:_,restoredState:E,extras:R}=c,A=new Pc(p,this.urlSerializer.serialize(g),_,E);this.events.next(A);let x=NA(this.rootComponentType).snapshot;return this.currentTransition=s=Ae(V({},c),{targetSnapshot:x,urlAfterRedirects:g,extras:Ae(V({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,K(s)}else{let p="";return this.events.next(new is(c.id,this.urlSerializer.serialize(c.extractedUrl),p,o_.IgnoredByUrlHandlingStrategy)),c.resolve(!1),en}}),ft(c=>{let l=new a_(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Q(c=>(this.currentTransition=s=Ae(V({},c),{guards:wj(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),Mj(this.environmentInjector,c=>this.events.next(c)),ft(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw gh(this.urlSerializer,c.guardsResult);let l=new c_(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Vt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",un.GuardRejected),!1)),e_(c=>{if(c.guards.canActivateChecks.length)return K(c).pipe(ft(l=>{let d=new u_(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Wt(l=>{let d=!1;return K(l).pipe(n2(this.paramsInheritanceStrategy,this.environmentInjector),ft({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",un.NoDataFromResolver)}}))}),ft(l=>{let d=new l_(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),e_(c=>{let l=d=>{let p=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(d.routeConfig).pipe(ft(g=>{d.component=g}),Q(()=>{})));for(let g of d.children)p.push(...l(g));return p};return Zs(l(c.targetSnapshot.root)).pipe(Qr(null),mr(1))}),e_(()=>this.afterPreactivation()),Wt(()=>{let{currentSnapshot:c,targetSnapshot:l}=s,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?Ke(d).pipe(Q(()=>s)):K(s)}),Q(c=>{let l=mj(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=Ae(V({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),ft(()=>{this.events.next(new kc)}),Ij(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),mr(1),ft({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new rs(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),tn(this.transitionAbortSubject.pipe(ft(c=>{throw c}))),nc(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",un.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Kr(c=>{if(a=!0,OA(c))this.events.next(new Cr(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),vj(c)?this.events.next(new So(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let l=new Mc(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let d=yr(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(d instanceof Fc){let{message:p,cancellationCode:g}=gh(this.urlSerializer,d);this.events.next(new Cr(s.id,this.urlSerializer.serialize(s.extractedUrl),p,g)),this.events.next(new So(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(l);let p=n.errorHandler(c);s.resolve(!!p)}}catch(d){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(d)}}return en}))}))}cancelNavigationTransition(n,r,i){let s=new Cr(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function p2(t){return t!==Dc}var g2=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(m2),providedIn:"root"})}}return t})(),D_=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},m2=(()=>{class t extends D_{static{this.\u0275fac=(()=>{let n;return function(i){return(n||(n=fm(t)))(i||t)}})()}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),HA=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:()=>M(_2),providedIn:"root"})}}return t})(),_2=(()=>{class t extends HA{constructor(){super(...arguments),this.location=M(yc),this.urlSerializer=M(S_),this.options=M(P_,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=M(O_),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new br,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=NA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof Pc)this.stateMemento=this.createStateMemento();else if(n instanceof is)this.rawUrlTree=r.initialUrl;else if(n instanceof lh){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else n instanceof kc?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):n instanceof Cr&&(n.code===un.GuardRejected||n.code===un.NoDataFromResolver)?this.restoreHistory(r):n instanceof Mc?this.restoreHistory(r,!0):n instanceof rs&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){let i=n instanceof br?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=V(V({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=V(V({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&s===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static{this.\u0275fac=(()=>{let n;return function(i){return(n||(n=fm(t)))(i||t)}})()}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Cc=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Cc||{});function y2(t,e){t.events.pipe(Vt(n=>n instanceof rs||n instanceof Cr||n instanceof Mc||n instanceof is),Q(n=>n instanceof rs||n instanceof is?Cc.COMPLETE:(n instanceof Cr?n.code===un.Redirect||n.code===un.SupersededByNewNavigation:!1)?Cc.REDIRECTING:Cc.FAILED),Vt(n=>n!==Cc.REDIRECTING),mr(1)).subscribe(()=>{e()})}function v2(t){throw t}var I2={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},w2={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},vh=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=M(Ld),this.stateManager=M(HA),this.options=M(P_,{optional:!0})||{},this.pendingTasks=M(zi),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=M(f2),this.urlSerializer=M(S_),this.location=M(yc),this.urlHandlingStrategy=M(O_),this._events=new $e,this.errorHandler=this.options.errorHandler||v2,this.navigated=!1,this.routeReuseStrategy=M(g2),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=M(k_,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!M(N_,{optional:!0}),this.eventsSubscription=new We,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Cr&&r.code!==un.Redirect&&r.code!==un.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof rs)this.navigated=!0;else if(r instanceof So){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=V({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||p2(i.source)},o);this.scheduleNavigation(a,Dc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}T2(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Dc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=V({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(x_),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=V(V({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let p;try{let g=i?i.snapshot:this.routerState.snapshot.root;p=DA(g)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),p=this.currentUrlTree.root}return SA(p,n,d,l??null)}navigateByUrl(n,r={skipLocationChange:!1}){let i=Rc(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Dc,null,r)}navigate(n,r={skipLocationChange:!1}){return E2(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let i;if(r===!0?i=V({},I2):r===!1?i=V({},w2):i=r,Rc(n))return uA(this.currentUrlTree,n,i);let s=this.parseUrl(n);return uA(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.entries(n).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((p,g)=>{a=p,c=g});let d=this.pendingTasks.add();return y2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function E2(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new W(4008,!1)}function T2(t){return!(t instanceof kc)&&!(t instanceof So)}var C2=new U("");function qA(t,...e){return Oe([{provide:k_,multi:!0,useValue:t},[],{provide:Ao,useFactory:b2,deps:[vh]},{provide:xm,multi:!0,useFactory:D2},e.map(n=>n.\u0275providers)])}function b2(t){return t.routerState.root}function D2(){let t=M(ge);return e=>{let n=t.get(Xi);if(e!==n.components[0])return;let r=t.get(vh),i=t.get(S2);t.get(A2)===1&&r.initialNavigation(),t.get(R2,null,le.Optional)?.setUpPreloading(),t.get(C2,null,le.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var S2=new U("",{factory:()=>new $e}),A2=new U("",{providedIn:"root",factory:()=>1});var R2=new U("");var zA=[];var P2="firebase",M2="10.14.1";q(P2,M2,"app");var Ve=new ti("ANGULARFIRE2_VERSION"),Mo=t=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this
context. Rather than injecting ${t} in the constructor, first ensure that ${t} is supported by calling
\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${t})\`.`;function ct(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var nt=(t,e)=>{let n=e?[e]:dl(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Qt=class{constructor(){return nt(x2)}},x2="app-check";function Po(){}var Ih=class{zone;delegate;constructor(e,n=Zp){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},F_=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Po,{},Po,Po)),n.pipe(ft({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ye=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Ih(Zone.current)),this.insideAngular=n.run(()=>new Ih(Zone.current,Yp)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(J(Z))};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function wh(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function k2(t){return wh().ngZone.runOutsideAngular(()=>t())}function ss(t){return wh().ngZone.run(()=>t())}function O2(t){return F2(wh())(t)}function F2(t){return function(n){return n=n.lift(new F_(t.ngZone)),n.pipe(Wr(t.outsideAngular),Gr(t.insideAngular))}}var L2=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ss(()=>t.apply(void 0,r))},we=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=ss(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Po,{},Po,Po))),r[s]=L2(r[s],n));let i=k2(()=>t.apply(this,r));if(!e)if(i instanceof ae){let s=wh();return i.pipe(Wr(s.outsideAngular),Gr(s.insideAngular))}else return ss(()=>i);return i instanceof ae?i.pipe(O2):i instanceof Promise?ss(()=>new Promise((s,o)=>i.then(a=>ss(()=>s(a)),a=>ss(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:ss(()=>i)};var Ue=class{constructor(e){return e}},He=class{constructor(){return dl()}};function V2(t){return t&&t.length===1?t[0]:new Ue(it())}var L_=new U("angularfire2._apps"),U2={provide:Ue,useFactory:V2,deps:[[new ee,L_]]},j2={provide:He,deps:[[new ee,L_]]};function B2(t){return(e,n)=>{let r=n.get(Nn);q("angularfire",Ve.full,"core"),q("angularfire",Ve.full,"app"),q("angular",MS.full,r.toString());let i=e.runOutsideAngular(()=>t(n));return new Ue(i)}}function GA(t,...e){return Oe([U2,j2,{provide:L_,useFactory:B2(t),multi:!0,deps:[Z,ge,Ye,...e]}])}var WA=we(sC,!0);function c0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var u0=c0,l0=new Bn("auth","Firebase",c0());var Sh=new Hn("@firebase/auth");function $2(t,...e){Sh.logLevel<=At.WARN&&Sh.warn(`Auth (${zt}): ${t}`,...e)}function Th(t,...e){Sh.logLevel<=At.ERROR&&Sh.error(`Auth (${zt}): ${t}`,...e)}function ui(t,...e){throw ry(t,...e)}function as(t,...e){return ry(t,...e)}function d0(t,e,n){let r=Object.assign(Object.assign({},u0()),{[e]:n});return new Bn("auth","Firebase",r).create(e,{appName:t.name})}function os(t){return d0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ry(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return l0.create(t,...e)}function te(t,e,...n){if(!t)throw ry(e,...n)}function Dr(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Th(e),new Error(e)}function li(t,e){t||Dr(e)}function B_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function H2(){return KA()==="http:"||KA()==="https:"}function KA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function q2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H2()||Ba()||"connection"in navigator)?navigator.onLine:!0}function z2(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var cs=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,li(n>e,"Short delay should be less than long delay!"),this.isMobile=ja()||cl()}get(){return q2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function iy(t,e){li(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Ah=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Dr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Dr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Dr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var G2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var W2=new cs(3e4,6e4);function sy(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function ko(s,o,a,c){return y(this,arguments,function*(t,e,n,r,i={}){return h0(t,i,()=>y(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let p=Ri(Object.assign({key:t.config.apiKey},d)).slice(1),g=yield t._getAdditionalHeaders();g["Content-Type"]="application/json",t.languageCode&&(g["X-Firebase-Locale"]=t.languageCode);let _=Object.assign({method:e,headers:g},l);return YT()||(_.referrerPolicy="no-referrer"),Ah.fetch()(f0(t,t.config.apiHost,n,p),_)}))})}function h0(t,e,n){return y(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},G2),e);try{let i=new $_(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Eh(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Eh(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Eh(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Eh(t,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw d0(t,d,l);ui(t,d)}}catch(i){if(i instanceof qt)throw i;ui(t,"network-request-failed",{message:String(i)})}})}function K2(s,o,a,c){return y(this,arguments,function*(t,e,n,r,i={}){let l=yield ko(t,e,n,r,i);return"mfaPendingCredential"in l&&ui(t,"multi-factor-auth-required",{_serverResponse:l}),l})}function f0(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?iy(t.config,i):`${t.config.apiScheme}://${i}`}var $_=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(as(this.auth,"network-request-failed")),W2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Eh(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=as(t,e,r);return i.customData._tokenResponse=n,i}function Q2(t,e){return y(this,null,function*(){return ko(t,"POST","/v1/accounts:delete",e)})}function p0(t,e){return y(this,null,function*(){return ko(t,"POST","/v1/accounts:lookup",e)})}function $c(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function oy(t,e=!1){return y(this,null,function*(){let n=fe(t),r=yield n.getIdToken(e),i=ay(r);te(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:$c(V_(i.auth_time)),issuedAtTime:$c(V_(i.iat)),expirationTime:$c(V_(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function V_(t){return Number(t)*1e3}function ay(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Th("JWT malformed, contained fewer than 3 sections"),null;try{let i=WT(n);return i?JSON.parse(i):(Th("Failed to decode base64 JWT payload"),null)}catch(i){return Th("Caught error parsing JWT payload as JSON",i?.toString()),null}}function QA(t){let e=ay(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function qc(t,e,n=!1){return y(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof qt&&Y2(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function Y2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var H_=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),n)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var zc=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=$c(this.lastLoginAt),this.creationTime=$c(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Rh(t){return y(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield qc(t,p0(n,{idToken:r}));te(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?g0(s.providerUserInfo):[],a=Z2(t.providerData,o),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!a?.length,d=c?l:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new zc(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,p)})}function cy(t){return y(this,null,function*(){let e=fe(t);yield Rh(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Z2(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function g0(t){return t.map(e=>{var{providerId:n}=e,r=Jp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function J2(t,e){return y(this,null,function*(){let n=yield h0(t,{},()=>y(this,null,function*(){let r=Ri({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=f0(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Ah.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function X2(t,e){return y(this,null,function*(){return ko(t,"POST","/v2/accounts:revokeToken",sy(t,e))})}var Hc=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");let n=QA(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return y(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield J2(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(te(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Dr("not implemented")}};function ci(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var xo=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Jp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H_(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new zc(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let n=yield qc(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return oy(this,e)}reload(){return cy(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Rh(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(fr(this.auth.app))return Promise.reject(os(this.auth));let e=yield this.getIdToken();return yield qc(this,Q2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,l,d;let p=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,_=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,R=(a=n.tenantId)!==null&&a!==void 0?a:void 0,A=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,x=(l=n.createdAt)!==null&&l!==void 0?l:void 0,L=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:$,emailVerified:G,isAnonymous:Ne,providerData:Y,stsTokenManager:T}=n;te($&&T,e,"internal-error");let v=Hc.fromJSON(this.name,T);te(typeof $=="string",e,"internal-error"),ci(p,e.name),ci(g,e.name),te(typeof G=="boolean",e,"internal-error"),te(typeof Ne=="boolean",e,"internal-error"),ci(_,e.name),ci(E,e.name),ci(R,e.name),ci(A,e.name),ci(x,e.name),ci(L,e.name);let I=new t({uid:$,auth:e,email:g,emailVerified:G,displayName:p,isAnonymous:Ne,photoURL:E,phoneNumber:_,tenantId:R,stsTokenManager:v,createdAt:x,lastLoginAt:L});return Y&&Array.isArray(Y)&&(I.providerData=Y.map(C=>Object.assign({},C))),A&&(I._redirectEventId=A),I}static _fromIdTokenResponse(e,n,r=!1){return y(this,null,function*(){let i=new Hc;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Rh(s),s})}static _fromGetAccountInfoResponse(e,n,r){return y(this,null,function*(){let i=n.users[0];te(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?g0(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Hc;a.updateFromIdToken(r);let c=new t({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new zc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var YA=new Map;function Sr(t){li(t instanceof Function,"Expected a class definition");let e=YA.get(t);return e?(li(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,YA.set(t,e),e)}var eB=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(n,r){return y(this,null,function*(){this.storage[n]=r})}_get(n){return y(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return y(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),q_=eB;function Ch(t,e,n){return`firebase:${t}:${e}:${n}`}var Nh=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ch(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ch("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?xo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return y(this,null,function*(){if(!n.length)return new t(Sr(q_),e,r);let i=(yield Promise.all(n.map(l=>y(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Sr(q_),o=Ch(r,e.config.apiKey,e.name),a=null;for(let l of n)try{let d=yield l._get(o);if(d){let p=xo._fromJSON(e,d);l!==s&&(a=p),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(l=>y(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new t(s,e,r))})}};function ZA(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(v0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(m0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(w0(e))return"Blackberry";if(E0(e))return"Webos";if(_0(e))return"Safari";if((e.includes("chrome/")||y0(e))&&!e.includes("edge/"))return"Chrome";if(I0(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function m0(t=St()){return/firefox\//i.test(t)}function _0(t=St()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function y0(t=St()){return/crios\//i.test(t)}function v0(t=St()){return/iemobile/i.test(t)}function I0(t=St()){return/android/i.test(t)}function w0(t=St()){return/blackberry/i.test(t)}function E0(t=St()){return/webos/i.test(t)}function uy(t=St()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tB(t=St()){var e;return uy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nB(){return ZT()&&document.documentMode===10}function T0(t=St()){return uy(t)||I0(t)||E0(t)||w0(t)||/windows phone/i.test(t)||v0(t)}function C0(t,e=[]){let n;switch(t){case"Browser":n=ZA(St());break;case"Worker":n=`${ZA(St())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${zt}/${r}`}var z_=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function rB(n){return y(this,arguments,function*(t,e={}){return ko(t,"GET","/v2/passwordPolicy",sy(t,e))})}var iB=6,G_=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:iB,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var W_=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ph(this),this.idTokenSubscription=new Ph(this),this.beforeStateQueue=new z_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Sr(n)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Nh.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let n=yield p0(this,{idToken:e}),r=yield xo._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var n;if(fr(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Rh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=z2()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(fr(this.app))return Promise.reject(os(this));let n=e?fe(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return y(this,null,function*(){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return fr(this.app)?Promise.reject(os(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return fr(this.app)?Promise.reject(os(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(Sr(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield rB(this),n=new G_(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Bn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield X2(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&Sr(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=yield Nh.create(this,[Sr(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=C0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return y(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&$2(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function ly(t){return fe(t)}var Ph=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=nC(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var dy={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sB(t){dy=t}function oB(t){return dy.loadJS(t)}function aB(){return dy.gapiScript}function b0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function hy(t,e){let n=rt(t,"auth");if(n.isInitialized()){let i=n.getImmediate(),s=n.getOptions();if(za(s,e??{}))return i;ui(i,"already-initialized")}return n.initialize({options:e})}function cB(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Sr);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function fy(t,e,n){let r=ly(t);te(r._canInitEmulator,r,"emulator-config-failed"),te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!n?.disableWarnings,s=D0(e),{host:o,port:a}=uB(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||lB()}function D0(t){let e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function uB(t){let e=D0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:JA(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:JA(o)}}}function JA(t){if(!t)return null;let e=Number(t);return isNaN(e)?null:e}function lB(){function t(){let e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}var Mh=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Dr("not implemented")}_getIdTokenResponse(e){return Dr("not implemented")}_linkToIdToken(e,n){return Dr("not implemented")}_getReauthenticationResolver(e){return Dr("not implemented")}};function U_(t,e){return y(this,null,function*(){return K2(t,"POST","/v1/accounts:signInWithIdp",sy(t,e))})}var xh=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var K_=class extends xh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Gc=class t{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,r,i=!1){return y(this,null,function*(){let s=yield xo._fromIdTokenResponse(e,r,i),o=XA(r);return new t({user:s,providerId:o,_tokenResponse:r,operationType:n})})}static _forOperation(e,n,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=XA(r);return new t({user:e,providerId:i,_tokenResponse:r,operationType:n})})}};function XA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var Q_=class t extends qt{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,t.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new t(e,n,r,i)}};function S0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Q_._fromErrorAndOperation(t,s,e,r):s})}function dB(t,e,n=!1){return y(this,null,function*(){let r=yield qc(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return Gc._forOperation(t,"link",r)})}function hB(t,e,n=!1){return y(this,null,function*(){let{auth:r}=t;if(fr(r.app))return Promise.reject(os(r));let i="reauthenticate";try{let s=yield qc(t,S0(r,i,e,t),n);te(s.idToken,r,"internal-error");let o=ay(s.idToken);te(o,r,"internal-error");let{sub:a}=o;return te(t.uid===a,r,"user-mismatch"),Gc._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ui(r,"user-mismatch"),s}})}function fB(t,e,n=!1){return y(this,null,function*(){if(fr(t.app))return Promise.reject(os(t));let r="signIn",i=yield S0(t,r,e),s=yield Gc._fromIdTokenResponse(t,r,i);return n||(yield t._updateCurrentUser(s.user)),s})}function Vh(t,e,n,r){return fe(t).onIdTokenChanged(e,n,r)}function py(t,e,n){return fe(t).beforeAuthStateChanged(e,n)}function Uh(t,e,n,r){return fe(t).onAuthStateChanged(e,n,r)}var kh="__sak";var Oh=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kh,"1"),this.storage.removeItem(kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var pB=1e3,gB=10,mB=(()=>{class t extends Oh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=T0(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&n(r,s,i)}}onStorageEvent(n,r=!1){if(!n.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=n.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);nB()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,gB):s()}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},pB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(n,r){return y(this,null,function*(){yield Hr(t.prototype,this,"_set").call(this,n,r),this.localCache[n]=JSON.stringify(r)})}_get(n){return y(this,null,function*(){let r=yield Hr(t.prototype,this,"_get").call(this,n);return this.localCache[n]=JSON.stringify(r),r})}_remove(n){return y(this,null,function*(){yield Hr(t.prototype,this,"_remove").call(this,n),delete this.localCache[n]})}}return t.type="LOCAL",t})(),A0=mB;var _B=(()=>{class t extends Oh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return t.type="SESSION",t})(),gy=_B;function yB(t){return Promise.all(t.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}})))}var vB=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){let r=this.receivers.find(s=>s.isListeningto(n));if(r)return r;let i=new t(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}handleEvent(n){return y(this,null,function*(){let r=n,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>y(this,null,function*(){return d(r.origin,o)})),l=yield yB(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(n,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t.receivers=[];return t})();function R0(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}var Y_=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=R0("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let g=p;if(g.data.eventId===l)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function er(){return window}function IB(t){er().location.href=t}function N0(){return typeof er().WorkerGlobalScope<"u"&&typeof er().importScripts=="function"}function wB(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function EB(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function TB(){return N0()?self:null}var P0="firebaseLocalStorageDb",CB=1,Fh="firebaseLocalStorage",M0="fbase_key",us=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function jh(t,e){return t.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function bB(){let t=indexedDB.deleteDatabase(P0);return new us(t).toPromise()}function Z_(){let t=indexedDB.open(P0,CB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let r=t.result;try{r.createObjectStore(Fh,{keyPath:M0})}catch(i){n(i)}}),t.addEventListener("success",()=>y(this,null,function*(){let r=t.result;r.objectStoreNames.contains(Fh)?e(r):(r.close(),yield bB(),e(yield Z_()))}))})}function e0(t,e,n){return y(this,null,function*(){let r=jh(t,!0).put({[M0]:e,value:n});return new us(r).toPromise()})}function DB(t,e){return y(this,null,function*(){let n=jh(t,!1).get(e),r=yield new us(n).toPromise();return r===void 0?null:r.value})}function t0(t,e){let n=jh(t,!0).delete(e);return new us(n).toPromise()}var SB=800,AB=3,RB=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Z_(),this.db)})}_withRetries(n){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield n(i)}catch(i){if(r++>AB)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return N0()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=vB._getInstance(TB()),this.receiver._subscribe("keyChanged",(n,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(n,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var n,r;if(this.activeServiceWorker=yield wB(),!this.activeServiceWorker)return;this.sender=new Y_(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((n=i[0])===null||n===void 0)&&n.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(n){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||EB()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let n=yield Z_();return yield e0(n,kh,"1"),yield t0(n,kh),!0}catch{}return!1})}_withPendingWrite(n){return y(this,null,function*(){this.pendingWrites++;try{yield n()}finally{this.pendingWrites--}})}_set(n,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>e0(i,n,r)),this.localCache[n]=r,this.notifyServiceWorker(n)}))})}_get(n){return y(this,null,function*(){let r=yield this._withRetries(i=>DB(i,n));return this.localCache[n]=r,r})}_remove(n){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>t0(r,n)),delete this.localCache[n],this.notifyServiceWorker(n)}))})}_poll(){return y(this,null,function*(){let n=yield this._withRetries(s=>{let o=jh(s,!1).getAll();return new us(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(n.length!==0)for(let{fbase_key:s,value:o}of n)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),SB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return t.type="LOCAL",t})(),x0=RB;var mJ=b0("rcb"),_J=new cs(3e4,6e4);function NB(t,e){return e?Sr(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var Wc=class extends Mh{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return U_(e,this._buildIdpRequest())}_linkToIdToken(e,n){return U_(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return U_(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function PB(t){return fB(t.auth,new Wc(t),t.bypassAuthState)}function MB(t){let{auth:e,user:n}=t;return te(n,e,"internal-error"),hB(n,new Wc(t),t.bypassAuthState)}function xB(t){return y(this,null,function*(){let{auth:e,user:n}=t;return te(n,e,"internal-error"),dB(n,new Wc(t),t.bypassAuthState)})}var J_=class{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise((e,n)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:n};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return PB;case"linkViaPopup":case"linkViaRedirect":return xB;case"reauthViaPopup":case"reauthViaRedirect":return MB;default:ui(this.auth,"internal-error")}}resolve(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var yJ=new cs(2e3,1e4);var kB="pendingRedirect",bh=new Map,X_=class t extends J_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=bh.get(this.auth._key());if(!e){try{let r=(yield OB(this.resolver,this.auth))?yield Hr(t.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}bh.set(this.auth._key(),e)}return this.bypassAuthState||bh.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Hr(t.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=yield this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,Hr(t.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function OB(t,e){return y(this,null,function*(){let n=VB(e),r=LB(t);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(n))==="true";return yield r._remove(n),i})}function FB(t,e){bh.set(t._key(),e)}function LB(t){return Sr(t._redirectPersistence)}function VB(t){return Ch(kB,t.config.apiKey,t.name)}function UB(t,e,n=!1){return y(this,null,function*(){if(fr(t.app))return Promise.reject(os(t));let r=ly(t),i=NB(r,e),o=yield new X_(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var jB=10*60*1e3,ey=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!k0(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(as(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jB&&this.cachedEventUids.clear(),this.cachedEventUids.has(n0(e))}saveEventToCache(e){this.cachedEventUids.add(n0(e)),this.lastProcessedEventTime=Date.now()}};function n0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function k0({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function BB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return k0(t);default:return!1}}function $B(n){return y(this,arguments,function*(t,e={}){return ko(t,"GET","/v1/projects",e)})}var HB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qB=/^https?/;function zB(t){return y(this,null,function*(){if(t.config.emulator)return;let{authorizedDomains:e}=yield $B(t);for(let n of e)try{if(GB(n))return}catch{}ui(t,"unauthorized-domain")})}function GB(t){let e=B_(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!qB.test(n))return!1;if(HB.test(t))return r===t;let i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var WB=new cs(3e4,6e4);function r0(){let t=er().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function KB(t){return new Promise((e,n)=>{var r,i,s;function o(){r0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{r0(),n(as(t,"network-request-failed"))},timeout:WB.get()})}if(!((i=(r=er().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=er().gapi)===null||s===void 0)&&s.load)o();else{let a=b0("iframefcb");return er()[a]=()=>{gapi.load?o():n(as(t,"network-request-failed"))},oB(`${aB()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Dh=null,e})}var Dh=null;function QB(t){return Dh=Dh||KB(t),Dh}var YB=new cs(5e3,15e3),ZB="__/auth/iframe",JB="emulator/auth/iframe",XB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},e$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function t$(t){let e=t.config;te(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?iy(e,JB):`https://${t.config.authDomain}/${ZB}`,r={apiKey:e.apiKey,appName:t.name,v:zt},i=e$.get(t.config.apiHost);i&&(r.eid=i);let s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ri(r).slice(1)}`}function n$(t){return y(this,null,function*(){let e=yield QB(t),n=er().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:t$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:XB,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=as(t,"network-request-failed"),a=er().setTimeout(()=>{s(o)},YB.get());function c(){er().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var r$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},i$=500,s$=600,o$="_blank",a$="http://localhost",Lh=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function c$(t,e,n,r=i$,i=s$){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},r$),{width:r.toString(),height:i.toString(),top:s,left:o}),l=St().toLowerCase();n&&(a=y0(l)?o$:n),m0(l)&&(e=e||a$,c.scrollbars="yes");let d=Object.entries(c).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(tB(l)&&a!=="_self")return u$(e||"",a),new Lh(null);let p=window.open(e||"",a,d);te(p,t,"popup-blocked");try{p.focus()}catch{}return new Lh(p)}function u$(t,e){let n=document.createElement("a");n.href=t,n.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var l$="__/auth/handler",d$="emulator/auth/handler",h$=encodeURIComponent("fac");function i0(t,e,n,r,i,s){return y(this,null,function*(){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:zt,eventId:i};if(e instanceof xh){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ha(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof K_){let d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield t._getAppCheckToken(),l=c?`#${h$}=${encodeURIComponent(c)}`:"";return`${f$(t)}?${Ri(a).slice(1)}${l}`})}function f$({config:t}){return t.emulator?iy(t,d$):`https://${t.authDomain}/${l$}`}var j_="webStorageSupport",ty=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gy,this._completeRedirectFn=UB,this._overrideRedirectResult=FB}_openPopup(e,n,r,i){return y(this,null,function*(){var s;li((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield i0(e,n,r,B_(),i);return c$(e,o,R0())})}_openRedirect(e,n,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield i0(e,n,r,B_(),i);return IB(s),new Promise(()=>{})})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(li(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(e){return y(this,null,function*(){let n=yield n$(e),r=new ey(e);return n.register("authEvent",i=>(te(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r})}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(j_,{type:j_},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[j_];o!==void 0&&n(!!o),ui(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zB(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return T0()||_0()||uy()}},O0=ty;var s0="@firebase/auth",o0="1.7.9";var ny=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function p$(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function g$(t){Xe(new Je("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:C0(t)},l=new W_(r,i,s,c);return cB(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Xe(new Je("auth-internal",e=>{let n=ly(e.getProvider("auth").getImmediate());return(r=>new ny(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),q(s0,o0,p$(t)),q(s0,o0,"esm2017")}var m$=5*60,_$=Op("authIdTokenMaxAge")||m$,a0=null,y$=t=>e=>y(void 0,null,function*(){let n=e&&(yield e.getIdTokenResult()),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_$)return;let i=n?.token;a0!==i&&(a0=i,yield fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function my(t=it()){let e=rt(t,"auth");if(e.isInitialized())return e.getImmediate();let n=hy(t,{popupRedirectResolver:O0,persistence:[x0,A0,gy]}),r=Op("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=y$(s.toString());py(n,o,()=>o(n.currentUser)),Vh(n,a=>o(a))}}let i=QT("auth");return i&&fy(n,`http://${i}`),n}function v$(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}sB({loadJS(t){return new Promise((e,n)=>{let r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{let s=as("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",v$().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});g$("Browser");function L0(t){return new ae(function(e){var n=Uh(t,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:n}})}var V0="auth",ls=class{constructor(e){return e}},xn=class{constructor(){return nt(V0)}};var _y=new U("angularfire2.auth-instances");function dH(t,e){let n=ct(V0,t,e);return n&&new ls(n)}function hH(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new ls(r)}}var fH={provide:xn,deps:[[new ee,_y]]},pH={provide:ls,useFactory:dH,deps:[[new ee,_y],Ue]};function U0(t,...e){return q("angularfire",Ve.full,"auth"),Oe([pH,fH,{provide:_y,useFactory:hH(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,Qt],...e]}])}var j0=we(L0,!0);var B0=we(my,!0);var Bh="analytics",mH="firebase_id",_H="origin",yH=60*1e3,vH="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Cy="https://www.googletagmanager.com/gtag/js";var $t=new Hn("@firebase/analytics");var IH={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ln=new Bn("analytics","Analytics",IH);function wH(t){if(!t.startsWith(Cy)){let e=ln.create("invalid-gtag-resource",{gtagURL:t});return $t.warn(e.message),""}return t}function K0(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function EH(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function TH(t,e){let n=EH("firebase-js-sdk-policy",{createScriptURL:wH}),r=document.createElement("script"),i=`${Cy}?l=${t}&id=${e}`;r.src=n?n?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function CH(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}function bH(t,e,n,r,i,s){return y(this,null,function*(){let o=r[i];try{if(o)yield e[o];else{let c=(yield K0(n)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){$t.error(a)}t("config",i,s)})}function DH(t,e,n,r,i){return y(this,null,function*(){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);let a=yield K0(n);for(let c of o){let l=a.find(p=>p.measurementId===c),d=l&&e[l.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),t("event",r,i||{})}catch(s){$t.error(s)}})}function SH(t,e,n,r){function i(s,...o){return y(this,null,function*(){try{if(s==="event"){let[a,c]=o;yield DH(t,e,n,a,c)}else if(s==="config"){let[a,c]=o;yield bH(t,e,n,r,a,c)}else if(s==="consent"){let[a,c]=o;t("consent",a,c)}else if(s==="get"){let[a,c,l]=o;t("get",a,c,l)}else if(s==="set"){let[a]=o;t("set",a)}else t(s,...o)}catch(a){$t.error(a)}})}return i}function AH(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=SH(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function RH(t){let e=window.document.getElementsByTagName("script");for(let n of Object.values(e))if(n.src&&n.src.includes(Cy)&&n.src.includes(t))return n;return null}var NH=30,PH=1e3,vy=class{constructor(e={},n=PH){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},Q0=new vy;function MH(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function xH(t){return y(this,null,function*(){var e;let{appId:n,apiKey:r}=t,i={method:"GET",headers:MH(r)},s=vH.replace("{app-id}",n),o=yield fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{let c=yield o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw ln.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()})}function kH(r){return y(this,arguments,function*(t,e=Q0,n){let{appId:i,apiKey:s,measurementId:o}=t.options;if(!i)throw ln.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw ln.create("no-api-key")}let a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new Iy;return setTimeout(()=>y(this,null,function*(){c.abort()}),n!==void 0?n:yH),Y0({appId:i,apiKey:s,measurementId:o},a,c,e)})}function Y0(s,o,a){return y(this,arguments,function*(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=Q0){var c;let{appId:l,measurementId:d}=t;try{yield OH(r,e)}catch(p){if(d)return $t.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:l,measurementId:d};throw p}try{let p=yield xH(t);return i.deleteThrottleMetadata(l),p}catch(p){let g=p;if(!FH(g)){if(i.deleteThrottleMetadata(l),d)return $t.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:l,measurementId:d};throw p}let _=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?Wa(n,i.intervalMillis,NH):Wa(n,i.intervalMillis),E={throttleEndTimeMillis:Date.now()+_,backoffCount:n+1};return i.setThrottleMetadata(l,E),$t.debug(`Calling attemptFetch again in ${_} millis`),Y0(t,E,r,i)}})}function OH(t,e){return new Promise((n,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(ln.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function FH(t){if(!(t instanceof qt)||!t.customData)return!1;let e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}var Iy=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var wy;function LH(t,e,n,r,i){return y(this,null,function*(){if(i&&i.global){t("event",n,r);return}else{let s=yield e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}})}function VH(t,e,n,r){return y(this,null,function*(){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{let i=yield e;t("config",i,{update:!0,user_id:n})}})}var Ey;function UH(t){Ey=t}function jH(t){wy=t}function BH(){return y(this,null,function*(){if(hr())try{yield Si()}catch(t){return $t.warn(ln.create("indexeddb-unavailable",{errorInfo:t?.toString()}).message),!1}else return $t.warn(ln.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function $H(t,e,n,r,i,s,o){return y(this,null,function*(){var a;let c=kH(t);c.then(_=>{n[_.measurementId]=_.appId,t.options.measurementId&&_.measurementId!==t.options.measurementId&&$t.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${_.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(_=>$t.error(_)),e.push(c);let l=BH().then(_=>{if(_)return r.getId()}),[d,p]=yield Promise.all([c,l]);RH(s)||TH(s,d.measurementId),Ey&&(i("consent","default",Ey),UH(void 0)),i("js",new Date);let g=(a=o?.config)!==null&&a!==void 0?a:{};return g[_H]="firebase",g.update=!0,p!=null&&(g[mH]=p),i("config",d.measurementId,g),wy&&(i("set",wy),jH(void 0)),d.measurementId})}var Ty=class{constructor(e){this.app=e}_delete(){return delete Oo[this.app.options.appId],Promise.resolve()}},Oo={},$0=[],H0={},yy="dataLayer",HH="gtag",q0,by,z0=!1;function qH(){let t=[];if(Ba()&&t.push("This is a browser extension environment."),$a()||t.push("Cookies are not available."),t.length>0){let e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=ln.create("invalid-analytics-context",{errorInfo:e});$t.warn(n.message)}}function zH(t,e,n){qH();let r=t.options.appId;if(!r)throw ln.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)$t.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ln.create("no-api-key");if(Oo[r]!=null)throw ln.create("already-exists",{id:r});if(!z0){CH(yy);let{wrappedGtag:s,gtagCore:o}=AH(Oo,$0,H0,yy,HH);by=s,q0=o,z0=!0}return Oo[r]=$H(t,$0,H0,e,q0,yy,n),new Ty(t)}function Z0(t=it()){t=fe(t);let e=rt(t,Bh);return e.isInitialized()?e.getImmediate():J0(t)}function J0(t,e={}){let n=rt(t,Bh);if(n.isInitialized()){let i=n.getImmediate();if(za(e,n.getOptions()))return i;throw ln.create("already-initialized")}return n.initialize({options:e})}function X0(){return y(this,null,function*(){if(Ba()||!$a()||!hr())return!1;try{return yield Si()}catch{return!1}})}function eR(t,e,n){t=fe(t),VH(by,Oo[t.app.options.appId],e,n).catch(r=>$t.error(r))}function Dy(t,e,n,r){t=fe(t),LH(by,Oo[t.app.options.appId],e,n,r).catch(i=>$t.error(i))}var G0="@firebase/analytics",W0="0.10.8";function GH(){Xe(new Je(Bh,(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return zH(r,i,n)},"PUBLIC")),Xe(new Je("analytics-internal",t,"PRIVATE")),q(G0,W0),q(G0,W0,"esm2017");function t(e){try{let n=e.getProvider(Bh).getImmediate();return{logEvent:(r,i,s)=>Dy(n,r,i,s)}}catch(n){throw ln.create("interop-component-reg-failed",{reason:n})}}}GH();var ds=class{constructor(e){return e}},rR="analytics",Ay=class{constructor(){return nt(rR)}};var Ry="__angularfire_symbol__analyticsIsSupportedValue",iR="__angularfire_symbol__analyticsIsSupported";globalThis[iR]||=X0().then(t=>globalThis[Ry]=t).catch(()=>globalThis[Ry]=!1);var $h={async:()=>globalThis[iR],sync:()=>{let t=globalThis[Ry];if(t===void 0)throw new Error(Mo("Analytics"));return t}},sR=$h.async,oR=we(Z0,!0);var WH=we(Dy,!0);var KH=we(eR,!0);var Py=(()=>{class t{initialized;disposables=[];constructor(n,r,i){q("angularfire",Ve.full,"user-tracking");let s;this.initialized=r.runOutsideAngular(()=>new Promise(o=>{s=o})),sR().then(()=>{let o=i.get(ds);o?this.disposables=[j0(n).subscribe(a=>{KH(o,a?.uid),s()})]:s()})}ngOnDestroy(){this.disposables.forEach(n=>n.unsubscribe())}static \u0275fac=function(r){return new(r||t)(J(ls),J(Z),J(ge))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),QH="firebase_event_origin",YH="firebase_previous_class",ZH="firebase_previous_id",JH="firebase_previous_screen",XH="firebase_screen_class",tR="firebase_screen_id",eq="firebase_screen",Ny="outlet",tq="page_path",nq="page_title",Kc="screen_class",nR="screen_name",rq="screen_view",iq="auto",sq="#",oq=Math.floor(Math.random()*(2**32-1))-2**31,Sy={},aq=t=>{let e=[t[Kc],t[Ny]].join(sq);if(Sy.hasOwnProperty(e))return Sy[e];{let n=oq++;return Sy[e]=n,n}},cq=(t,e,n)=>t.events.pipe(Vt(i=>i instanceof xc)).pipe(Wt(i=>{let o=t.parseUrl(t.url.replace(/(?:\().+(?:\))/g,g=>g.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",a=t.routerState.root.children.map(g=>g).find(g=>g.outlet===i.snapshot.outlet);if(!a)return K(null);let c=a;for(;c.firstChild;)c=c.firstChild;let l=c.pathFromRoot.map(g=>g.routeConfig?.path).filter(g=>g).join("/")||"/",d={[nR]:l,[tq]:`/${o}`,[QH]:iq,[eq]:l,[Ny]:i.snapshot.outlet};e&&(d[nq]=e.getTitle());let p=a.component;if(p){if(p===M_){let g=i.snapshot;for(;g.firstChild;)g=g.firstChild;p=g.component}}else p=i.snapshot.component;if(typeof p=="string")return K(Ae(V({},d),{[Kc]:p}));if(p){let g=n.resolveComponentFactory(p);return K(Ae(V({},d),{[Kc]:g.selector}))}return K(null)}),Vt(i=>!!i),Q(i=>V({[XH]:i[Kc],[tR]:aq(i)},i)),ng(i=>i[Ny]),et(i=>i.pipe(Ul((s,o)=>JSON.stringify(s)===JSON.stringify(o)),eo(void 0),Bl(),Q(([s,o])=>s?V({[YH]:s[Kc],[JH]:s[nR],[ZH]:s[tR]},o):o)))),aR=(()=>{class t{disposable;constructor(n,r,i,s,o,a){q("angularfire",Ve.full,"screen-tracking"),sR().then(()=>{let c=a.get(ds);!n||!c||s.runOutsideAngular(()=>{this.disposable=cq(n,r,i).pipe(Wt(l=>y(this,null,function*(){return o&&(yield o.initialized),WH(c,rq,l)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||t)(J(vh,8),J(nh,8),J(Xr),J(Z),J(Py,8),J(ge))};static \u0275prov=H({token:t,factory:t.\u0275fac})}return t})(),My=new U("angularfire2.analytics-instances");function uq(t,e){if(!$h.sync())return null;let n=ct(rR,t,e);return n&&new ds(n)}function lq(t){return(e,n)=>{if(!$h.sync())return null;let r=e.runOutsideAngular(()=>t(n));return new ds(r)}}var dq={provide:Ay,deps:[[new ee,My]]},hq={provide:ds,useFactory:uq,deps:[[new ee,My],Ue]};function cR(t,...e){return q("angularfire",Ve.full,"analytics"),Oe([hq,dq,{provide:si,useValue:$h.async,multi:!0},{provide:My,useFactory:lq(t),multi:!0,deps:[Z,ge,Ye,He,...e]}])}var uR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lR={};var di,xy;(function(){var t;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,b,S){for(var w=Array(arguments.length-2),ur=2;ur<arguments.length;ur++)w[ur-2]=arguments[ur];return v.prototype[b].apply(C,w)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var C=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)C[b]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(b=0;16>b;++b)C[b]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],b=T.g[2];var S=T.g[3],w=v+(S^I&(b^S))+C[0]+3614090360&4294967295;v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[1]+3905402710&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[2]+606105819&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[3]+3250441966&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[4]+4118548399&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[5]+1200080426&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[6]+2821735955&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[7]+4249261313&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[8]+1770035416&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[9]+2336552879&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[10]+4294925233&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[11]+2304563134&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(S^I&(b^S))+C[12]+1804603682&4294967295,v=I+(w<<7&4294967295|w>>>25),w=S+(b^v&(I^b))+C[13]+4254626195&4294967295,S=v+(w<<12&4294967295|w>>>20),w=b+(I^S&(v^I))+C[14]+2792965006&4294967295,b=S+(w<<17&4294967295|w>>>15),w=I+(v^b&(S^v))+C[15]+1236535329&4294967295,I=b+(w<<22&4294967295|w>>>10),w=v+(b^S&(I^b))+C[1]+4129170786&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[6]+3225465664&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[11]+643717713&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[0]+3921069994&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[5]+3593408605&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[10]+38016083&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[15]+3634488961&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[4]+3889429448&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[9]+568446438&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[14]+3275163606&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[3]+4107603335&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[8]+1163531501&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(b^S&(I^b))+C[13]+2850285829&4294967295,v=I+(w<<5&4294967295|w>>>27),w=S+(I^b&(v^I))+C[2]+4243563512&4294967295,S=v+(w<<9&4294967295|w>>>23),w=b+(v^I&(S^v))+C[7]+1735328473&4294967295,b=S+(w<<14&4294967295|w>>>18),w=I+(S^v&(b^S))+C[12]+2368359562&4294967295,I=b+(w<<20&4294967295|w>>>12),w=v+(I^b^S)+C[5]+4294588738&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[8]+2272392833&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[11]+1839030562&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[14]+4259657740&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[1]+2763975236&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[4]+1272893353&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[7]+4139469664&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[10]+3200236656&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[13]+681279174&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[0]+3936430074&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[3]+3572445317&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[6]+76029189&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(I^b^S)+C[9]+3654602809&4294967295,v=I+(w<<4&4294967295|w>>>28),w=S+(v^I^b)+C[12]+3873151461&4294967295,S=v+(w<<11&4294967295|w>>>21),w=b+(S^v^I)+C[15]+530742520&4294967295,b=S+(w<<16&4294967295|w>>>16),w=I+(b^S^v)+C[2]+3299628645&4294967295,I=b+(w<<23&4294967295|w>>>9),w=v+(b^(I|~S))+C[0]+4096336452&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[7]+1126891415&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[14]+2878612391&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[5]+4237533241&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[12]+1700485571&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[3]+2399980690&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[10]+4293915773&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[1]+2240044497&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[8]+1873313359&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[15]+4264355552&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[6]+2734768916&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[13]+1309151649&4294967295,I=b+(w<<21&4294967295|w>>>11),w=v+(b^(I|~S))+C[4]+4149444226&4294967295,v=I+(w<<6&4294967295|w>>>26),w=S+(I^(v|~b))+C[11]+3174756917&4294967295,S=v+(w<<10&4294967295|w>>>22),w=b+(v^(S|~I))+C[2]+718787259&4294967295,b=S+(w<<15&4294967295|w>>>17),w=I+(S^(b|~v))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+S&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,C=this.B,b=this.h,S=0;S<v;){if(b==0)for(;S<=I;)i(this,T,S),S+=this.blockSize;if(typeof T=="string"){for(;S<v;)if(C[b++]=T.charCodeAt(S++),b==this.blockSize){i(this,C),b=0;break}}else for(;S<v;)if(C[b++]=T[S++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var C=0;32>C;C+=8)T[I++]=this.g[v]>>>C&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],C=!0,b=T.length-1;0<=b;b--){var S=T[b]|0;C&&S==v||(I[b]=S,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return A(l(-T));for(var v=[],I=1,C=0;T>=I;C++)v[C]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return A(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),C=p,b=0;b<T.length;b+=8){var S=Math.min(8,T.length-b),w=parseInt(T.substring(b,b+S),v);8>S?(S=l(Math.pow(v,S)),C=C.j(S).add(l(w))):(C=C.j(I),C=C.add(l(w)))}return C}var p=c(0),g=c(1),_=c(16777216);t=o.prototype,t.m=function(){if(R(this))return-A(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*v,v*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(E(this))return"0";if(R(this))return"-"+A(this).toString(T);for(var v=l(Math.pow(T,6)),I=this,C="";;){var b=G(I,v).g;I=x(I,b.j(v));var S=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=b,E(I))return S+C;for(;6>S.length;)S="0"+S;C=S+C}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function E(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function R(T){return T.h==-1}t.l=function(T){return T=x(this,T),R(T)?-1:E(T)?0:1};function A(T){for(var v=T.g.length,I=[],C=0;C<v;C++)I[C]=~T.g[C];return new o(I,~T.h).add(g)}t.abs=function(){return R(this)?A(this):this},t.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0,b=0;b<=v;b++){var S=C+(this.i(b)&65535)+(T.i(b)&65535),w=(S>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);C=w>>>16,S&=65535,w&=65535,I[b]=w<<16|S}return new o(I,I[I.length-1]&-2147483648?-1:0)};function x(T,v){return T.add(A(v))}t.j=function(T){if(E(this)||E(T))return p;if(R(this))return R(T)?A(this).j(A(T)):A(A(this).j(T));if(R(T))return A(this.j(A(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],C=0;C<2*v;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<T.g.length;b++){var S=this.i(C)>>>16,w=this.i(C)&65535,ur=T.i(b)>>>16,wa=T.i(b)&65535;I[2*C+2*b]+=w*wa,L(I,2*C+2*b),I[2*C+2*b+1]+=S*wa,L(I,2*C+2*b+1),I[2*C+2*b+1]+=w*ur,L(I,2*C+2*b+1),I[2*C+2*b+2]+=S*ur,L(I,2*C+2*b+2)}for(C=0;C<v;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=v;C<2*v;C++)I[C]=0;return new o(I,0)};function L(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function $(T,v){this.g=T,this.h=v}function G(T,v){if(E(v))throw Error("division by zero");if(E(T))return new $(p,p);if(R(T))return v=G(A(T),v),new $(A(v.g),A(v.h));if(R(v))return v=G(T,A(v)),new $(A(v.g),v.h);if(30<T.g.length){if(R(T)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var I=g,C=v;0>=C.l(T);)I=Ne(I),C=Ne(C);var b=Y(I,1),S=Y(C,1);for(C=Y(C,2),I=Y(I,2);!E(C);){var w=S.add(C);0>=w.l(T)&&(b=b.add(I),S=w),C=Y(C,1),I=Y(I,1)}return v=x(T,b.j(v)),new $(b,v)}for(b=p;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),S=l(I),w=S.j(v);R(w)||0<w.l(T);)I-=C,S=l(I),w=S.j(v);E(S)&&(S=g),b=b.add(S),T=x(T,w)}return new $(b,T)}t.A=function(T){return G(this,T).h},t.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},t.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},t.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function Ne(T){for(var v=T.g.length+1,I=[],C=0;C<v;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function Y(T,v){var I=v>>5;v%=32;for(var C=T.g.length-I,b=[],S=0;S<C;S++)b[S]=0<v?T.i(S+I)>>>v|T.i(S+I+1)<<32-v:T.i(S+I);return new o(b,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xy=lR.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,di=lR.Integer=o}).apply(typeof uR<"u"?uR:typeof self<"u"?self:typeof window<"u"?window:{});var Hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ar={};var ky,fq,Fo,Oy,Qc,qh,Fy,Ly,Vy;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,f){return u==Array.prototype||u==Object.prototype||(u[h]=f.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hh=="object"&&Hh];for(var h=0;h<u.length;++h){var f=u[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(u,h){if(h)e:{var f=r;u=u.split(".");for(var m=0;m<u.length-1;m++){var D=u[m];if(!(D in f))break e;f=f[D]}u=u[u.length-1],m=f[u],h=h(m),h!=m&&h!=null&&e(f,u,{configurable:!0,writable:!0,value:h})}}function s(u,h){u instanceof String&&(u+="");var f=0,m=!1,D={next:function(){if(!m&&f<u.length){var N=f++;return{value:h(N,u[N]),done:!1}}return m=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(u){return u||function(){return s(this,function(h,f){return f})}});var o=o||{},a=this||self;function c(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function l(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,f){return u.call.apply(u.bind,arguments)}function p(u,h,f){if(!u)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,m),u.apply(h,D)}}return function(){return u.apply(h,arguments)}}function g(u,h,f){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,g.apply(null,arguments)}function _(u,h){var f=Array.prototype.slice.call(arguments,1);return function(){var m=f.slice();return m.push.apply(m,arguments),u.apply(this,m)}}function E(u,h){function f(){}f.prototype=h.prototype,u.aa=h.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(m,D,N){for(var O=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)O[Pe-2]=arguments[Pe];return h.prototype[D].apply(m,O)}}function R(u){let h=u.length;if(0<h){let f=Array(h);for(let m=0;m<h;m++)f[m]=u[m];return f}return[]}function A(u,h){for(let f=1;f<arguments.length;f++){let m=arguments[f];if(c(m)){let D=u.length||0,N=m.length||0;u.length=D+N;for(let O=0;O<N;O++)u[D+O]=m[O]}else u.push(m)}}class x{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function L(u){return/^[\s\xa0]*$/.test(u)}function $(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function G(u){return G[" "](u),u}G[" "]=function(){};var Ne=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function Y(u,h,f){for(let m in u)h.call(f,u[m],m,u)}function T(u,h){for(let f in u)h.call(void 0,u[f],f,u)}function v(u){let h={};for(let f in u)h[f]=u[f];return h}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,h){let f,m;for(let D=1;D<arguments.length;D++){m=arguments[D];for(f in m)u[f]=m[f];for(let N=0;N<I.length;N++)f=I[N],Object.prototype.hasOwnProperty.call(m,f)&&(u[f]=m[f])}}function b(u){var h=1;u=u.split(":");let f=[];for(;0<h&&u.length;)f.push(u.shift()),h--;return u.length&&f.push(u.join(":")),f}function S(u){a.setTimeout(()=>{throw u},0)}function w(){var u=lp;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class ur{constructor(){this.h=this.g=null}add(h,f){let m=wa.get();m.set(h,f),this.h?this.h.next=m:this.g=m,this.h=m}}var wa=new x(()=>new hk,u=>u.reset());class hk{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Ea,Ta=!1,lp=new ur,qE=()=>{let u=a.Promise.resolve(void 0);Ea=()=>{u.then(fk)}};var fk=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(f){S(f)}var h=wa;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}Ta=!1};function Ur(){this.s=this.s,this.C=this.C}Ur.prototype.s=!1,Ur.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ur.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Tt(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var pk=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,h),a.removeEventListener("test",f,h)}catch{}return u}();function Ca(u,h){if(Tt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,m=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(Ne){e:{try{G(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else f=="mouseover"?h=u.fromElement:f=="mouseout"&&(h=u.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:gk[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ca.aa.h.call(this)}}E(Ca,Tt);var gk={2:"touch",3:"pen",4:"mouse"};Ca.prototype.h=function(){Ca.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ba="closure_listenable_"+(1e6*Math.random()|0),mk=0;function _k(u,h,f,m,D){this.listener=u,this.proxy=null,this.src=h,this.type=f,this.capture=!!m,this.ha=D,this.key=++mk,this.da=this.fa=!1}function zu(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Gu(u){this.src=u,this.g={},this.h=0}Gu.prototype.add=function(u,h,f,m,D){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var O=hp(u,h,m,D);return-1<O?(h=u[O],f||(h.fa=!1)):(h=new _k(h,this.src,N,!!m,D),h.fa=f,u.push(h)),h};function dp(u,h){var f=h.type;if(f in u.g){var m=u.g[f],D=Array.prototype.indexOf.call(m,h,void 0),N;(N=0<=D)&&Array.prototype.splice.call(m,D,1),N&&(zu(h),u.g[f].length==0&&(delete u.g[f],u.h--))}}function hp(u,h,f,m){for(var D=0;D<u.length;++D){var N=u[D];if(!N.da&&N.listener==h&&N.capture==!!f&&N.ha==m)return D}return-1}var fp="closure_lm_"+(1e6*Math.random()|0),pp={};function zE(u,h,f,m,D){if(m&&m.once)return WE(u,h,f,m,D);if(Array.isArray(h)){for(var N=0;N<h.length;N++)zE(u,h[N],f,m,D);return null}return f=yp(f),u&&u[ba]?u.K(h,f,l(m)?!!m.capture:!!m,D):GE(u,h,f,!1,m,D)}function GE(u,h,f,m,D,N){if(!h)throw Error("Invalid event type");var O=l(D)?!!D.capture:!!D,Pe=mp(u);if(Pe||(u[fp]=Pe=new Gu(u)),f=Pe.add(h,f,m,O,N),f.proxy)return f;if(m=yk(),f.proxy=m,m.src=u,m.listener=f,u.addEventListener)pk||(D=O),D===void 0&&(D=!1),u.addEventListener(h.toString(),m,D);else if(u.attachEvent)u.attachEvent(QE(h.toString()),m);else if(u.addListener&&u.removeListener)u.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return f}function yk(){function u(f){return h.call(u.src,u.listener,f)}let h=vk;return u}function WE(u,h,f,m,D){if(Array.isArray(h)){for(var N=0;N<h.length;N++)WE(u,h[N],f,m,D);return null}return f=yp(f),u&&u[ba]?u.L(h,f,l(m)?!!m.capture:!!m,D):GE(u,h,f,!0,m,D)}function KE(u,h,f,m,D){if(Array.isArray(h))for(var N=0;N<h.length;N++)KE(u,h[N],f,m,D);else m=l(m)?!!m.capture:!!m,f=yp(f),u&&u[ba]?(u=u.i,h=String(h).toString(),h in u.g&&(N=u.g[h],f=hp(N,f,m,D),-1<f&&(zu(N[f]),Array.prototype.splice.call(N,f,1),N.length==0&&(delete u.g[h],u.h--)))):u&&(u=mp(u))&&(h=u.g[h.toString()],u=-1,h&&(u=hp(h,f,m,D)),(f=-1<u?h[u]:null)&&gp(f))}function gp(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[ba])dp(h.i,u);else{var f=u.type,m=u.proxy;h.removeEventListener?h.removeEventListener(f,m,u.capture):h.detachEvent?h.detachEvent(QE(f),m):h.addListener&&h.removeListener&&h.removeListener(m),(f=mp(h))?(dp(f,u),f.h==0&&(f.src=null,h[fp]=null)):zu(u)}}}function QE(u){return u in pp?pp[u]:pp[u]="on"+u}function vk(u,h){if(u.da)u=!0;else{h=new Ca(h,this);var f=u.listener,m=u.ha||u.src;u.fa&&gp(u),u=f.call(m,h)}return u}function mp(u){return u=u[fp],u instanceof Gu?u:null}var _p="__closure_events_fn_"+(1e9*Math.random()>>>0);function yp(u){return typeof u=="function"?u:(u[_p]||(u[_p]=function(h){return u.handleEvent(h)}),u[_p])}function Ct(){Ur.call(this),this.i=new Gu(this),this.M=this,this.F=null}E(Ct,Ur),Ct.prototype[ba]=!0,Ct.prototype.removeEventListener=function(u,h,f,m){KE(this,u,h,f,m)};function Ot(u,h){var f,m=u.F;if(m)for(f=[];m;m=m.F)f.push(m);if(u=u.M,m=h.type||h,typeof h=="string")h=new Tt(h,u);else if(h instanceof Tt)h.target=h.target||u;else{var D=h;h=new Tt(m,u),C(h,D)}if(D=!0,f)for(var N=f.length-1;0<=N;N--){var O=h.g=f[N];D=Wu(O,m,!0,h)&&D}if(O=h.g=u,D=Wu(O,m,!0,h)&&D,D=Wu(O,m,!1,h)&&D,f)for(N=0;N<f.length;N++)O=h.g=f[N],D=Wu(O,m,!1,h)&&D}Ct.prototype.N=function(){if(Ct.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var f=u.g[h],m=0;m<f.length;m++)zu(f[m]);delete u.g[h],u.h--}}this.F=null},Ct.prototype.K=function(u,h,f,m){return this.i.add(String(u),h,!1,f,m)},Ct.prototype.L=function(u,h,f,m){return this.i.add(String(u),h,!0,f,m)};function Wu(u,h,f,m){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,N=0;N<h.length;++N){var O=h[N];if(O&&!O.da&&O.capture==f){var Pe=O.listener,vt=O.ha||O.src;O.fa&&dp(u.i,O),D=Pe.call(vt,m)!==!1&&D}}return D&&!m.defaultPrevented}function YE(u,h,f){if(typeof u=="function")f&&(u=g(u,f));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function ZE(u){u.g=YE(()=>{u.g=null,u.i&&(u.i=!1,ZE(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class Ik extends Ur{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ZE(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Da(u){Ur.call(this),this.h=u,this.g={}}E(Da,Ur);var JE=[];function XE(u){Y(u.g,function(h,f){this.g.hasOwnProperty(f)&&gp(h)},u),u.g={}}Da.prototype.N=function(){Da.aa.N.call(this),XE(this)},Da.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vp=a.JSON.stringify,wk=a.JSON.parse,Ek=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Ip(){}Ip.prototype.h=null;function eT(u){return u.h||(u.h=u.i())}function tT(){}var Sa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function wp(){Tt.call(this,"d")}E(wp,Tt);function Ep(){Tt.call(this,"c")}E(Ep,Tt);var Ti={},nT=null;function Ku(){return nT=nT||new Ct}Ti.La="serverreachability";function rT(u){Tt.call(this,Ti.La,u)}E(rT,Tt);function Aa(u){let h=Ku();Ot(h,new rT(h))}Ti.STAT_EVENT="statevent";function iT(u,h){Tt.call(this,Ti.STAT_EVENT,u),this.stat=h}E(iT,Tt);function Ft(u){let h=Ku();Ot(h,new iT(h,u))}Ti.Ma="timingevent";function sT(u,h){Tt.call(this,Ti.Ma,u),this.size=h}E(sT,Tt);function Ra(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function Na(){this.g=!0}Na.prototype.xa=function(){this.g=!1};function Tk(u,h,f,m,D,N){u.info(function(){if(u.g)if(N)for(var O="",Pe=N.split("&"),vt=0;vt<Pe.length;vt++){var Ee=Pe[vt].split("=");if(1<Ee.length){var bt=Ee[0];Ee=Ee[1];var Dt=bt.split("_");O=2<=Dt.length&&Dt[1]=="type"?O+(bt+"="+Ee+"&"):O+(bt+"=redacted&")}}else O=null;else O=N;return"XMLHTTP REQ ("+m+") [attempt "+D+"]: "+h+`
`+f+`
`+O})}function Ck(u,h,f,m,D,N,O){u.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+D+"]: "+h+`
`+f+`
`+N+" "+O})}function xs(u,h,f,m){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+Dk(u,f)+(m?" "+m:"")})}function bk(u,h){u.info(function(){return"TIMEOUT: "+h})}Na.prototype.info=function(){};function Dk(u,h){if(!u.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var m=f[u];if(!(2>m.length)){var D=m[1];if(Array.isArray(D)&&!(1>D.length)){var N=D[0];if(N!="noop"&&N!="stop"&&N!="close")for(var O=1;O<D.length;O++)D[O]=""}}}}return vp(f)}catch{return h}}var Qu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},oT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tp;function Yu(){}E(Yu,Ip),Yu.prototype.g=function(){return new XMLHttpRequest},Yu.prototype.i=function(){return{}},Tp=new Yu;function jr(u,h,f,m){this.j=u,this.i=h,this.l=f,this.R=m||1,this.U=new Da(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new aT}function aT(){this.i=null,this.g="",this.h=!1}var cT={},Cp={};function bp(u,h,f){u.L=1,u.v=el(lr(h)),u.m=f,u.P=!0,uT(u,null)}function uT(u,h){u.F=Date.now(),Zu(u),u.A=lr(u.v);var f=u.A,m=u.R;Array.isArray(m)||(m=[String(m)]),TT(f.i,"t",m),u.C=0,f=u.j.J,u.h=new aT,u.g=BT(u.j,f?h:null,!u.m),0<u.O&&(u.M=new Ik(g(u.Y,u,u.g),u.O)),h=u.U,f=u.g,m=u.ca;var D="readystatechange";Array.isArray(D)||(D&&(JE[0]=D.toString()),D=JE);for(var N=0;N<D.length;N++){var O=zE(f,D[N],m||h.handleEvent,!1,h.h||h);if(!O)break;h.g[O.key]=O}h=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),Aa(),Tk(u.i,u.u,u.A,u.l,u.R,u.m)}jr.prototype.ca=function(u){u=u.target;let h=this.M;h&&dr(u)==3?h.j():this.Y(u)},jr.prototype.Y=function(u){try{if(u==this.g)e:{let Dt=dr(this.g);var h=this.g.Ba();let Fs=this.g.Z();if(!(3>Dt)&&(Dt!=3||this.g&&(this.h.h||this.g.oa()||NT(this.g)))){this.J||Dt!=4||h==7||(h==8||0>=Fs?Aa(3):Aa(2)),Dp(this);var f=this.g.Z();this.X=f;t:if(lT(this)){var m=NT(this.g);u="";var D=m.length,N=dr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ci(this),Pa(this);var O="";break t}this.h.i=new a.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,u+=this.h.i.decode(m[h],{stream:!(N&&h==D-1)});m.length=0,this.h.g+=u,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=f==200,Ck(this.i,this.u,this.A,this.l,this.R,Dt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Pe,vt=this.g;if((Pe=vt.g?vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(Pe)){var Ee=Pe;break t}}Ee=null}if(f=Ee)xs(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sp(this,f);else{this.o=!1,this.s=3,Ft(12),Ci(this),Pa(this);break e}}if(this.P){f=!0;let bn;for(;!this.J&&this.C<O.length;)if(bn=Sk(this,O),bn==Cp){Dt==4&&(this.s=4,Ft(14),f=!1),xs(this.i,this.l,null,"[Incomplete Response]");break}else if(bn==cT){this.s=4,Ft(15),xs(this.i,this.l,O,"[Invalid Chunk]"),f=!1;break}else xs(this.i,this.l,bn,null),Sp(this,bn);if(lT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Dt!=4||O.length!=0||this.h.h||(this.s=1,Ft(16),f=!1),this.o=this.o&&f,!f)xs(this.i,this.l,O,"[Invalid Chunked Response]"),Ci(this),Pa(this);else if(0<O.length&&!this.W){this.W=!0;var bt=this.j;bt.g==this&&bt.ba&&!bt.M&&(bt.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),xp(bt),bt.M=!0,Ft(11))}}else xs(this.i,this.l,O,null),Sp(this,O);Dt==4&&Ci(this),this.o&&!this.J&&(Dt==4?LT(this.j,this):(this.o=!1,Zu(this)))}else qk(this.g),f==400&&0<O.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),Ci(this),Pa(this)}}}catch{}finally{}};function lT(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Sk(u,h){var f=u.C,m=h.indexOf(`
`,f);return m==-1?Cp:(f=Number(h.substring(f,m)),isNaN(f)?cT:(m+=1,m+f>h.length?Cp:(h=h.slice(m,m+f),u.C=m+f,h)))}jr.prototype.cancel=function(){this.J=!0,Ci(this)};function Zu(u){u.S=Date.now()+u.I,dT(u,u.I)}function dT(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ra(g(u.ba,u),h)}function Dp(u){u.B&&(a.clearTimeout(u.B),u.B=null)}jr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(bk(this.i,this.A),this.L!=2&&(Aa(),Ft(17)),Ci(this),this.s=2,Pa(this)):dT(this,this.S-u)};function Pa(u){u.j.G==0||u.J||LT(u.j,u)}function Ci(u){Dp(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,XE(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function Sp(u,h){try{var f=u.j;if(f.G!=0&&(f.g==u||Ap(f.h,u))){if(!u.K&&Ap(f.h,u)&&f.G==3){try{var m=f.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var D=m;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)sl(f),rl(f);else break e;Mp(f),Ft(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ra(g(f.Za,f),6e3));if(1>=pT(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Di(f,11)}else if((u.K||f.g==u)&&sl(f),!L(h))for(D=f.Da.g.parse(h),h=0;h<D.length;h++){let Ee=D[h];if(f.T=Ee[0],Ee=Ee[1],f.G==2)if(Ee[0]=="c"){f.K=Ee[1],f.ia=Ee[2];let bt=Ee[3];bt!=null&&(f.la=bt,f.j.info("VER="+f.la));let Dt=Ee[4];Dt!=null&&(f.Aa=Dt,f.j.info("SVER="+f.Aa));let Fs=Ee[5];Fs!=null&&typeof Fs=="number"&&0<Fs&&(m=1.5*Fs,f.L=m,f.j.info("backChannelRequestTimeoutMs_="+m)),m=f;let bn=u.g;if(bn){let al=bn.g?bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(al){var N=m.h;N.g||al.indexOf("spdy")==-1&&al.indexOf("quic")==-1&&al.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Rp(N,N.h),N.h=null))}if(m.D){let kp=bn.g?bn.g.getResponseHeader("X-HTTP-Session-Id"):null;kp&&(m.ya=kp,Le(m.I,m.D,kp))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),m=f;var O=u;if(m.qa=jT(m,m.J?m.ia:null,m.W),O.K){gT(m.h,O);var Pe=O,vt=m.L;vt&&(Pe.I=vt),Pe.B&&(Dp(Pe),Zu(Pe)),m.g=O}else OT(m);0<f.i.length&&il(f)}else Ee[0]!="stop"&&Ee[0]!="close"||Di(f,7);else f.G==3&&(Ee[0]=="stop"||Ee[0]=="close"?Ee[0]=="stop"?Di(f,7):Pp(f):Ee[0]!="noop"&&f.l&&f.l.ta(Ee),f.v=0)}}Aa(4)}catch{}}var Ak=class{constructor(u,h){this.g=u,this.map=h}};function hT(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fT(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function pT(u){return u.h?1:u.g?u.g.size:0}function Ap(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Rp(u,h){u.g?u.g.add(h):u.h=h}function gT(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}hT.prototype.cancel=function(){if(this.i=mT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function mT(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let f of u.g.values())h=h.concat(f.D);return h}return R(u.i)}function Rk(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var h=[],f=u.length,m=0;m<f;m++)h.push(u[m]);return h}h=[],f=0;for(m in u)h[f++]=u[m];return h}function Nk(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var h=[];u=u.length;for(var f=0;f<u;f++)h.push(f);return h}h=[],f=0;for(let m in u)h[f++]=m;return h}}}function _T(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var f=Nk(u),m=Rk(u),D=m.length,N=0;N<D;N++)h.call(void 0,m[N],f&&f[N],u)}var yT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pk(u,h){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var m=u[f].indexOf("="),D=null;if(0<=m){var N=u[f].substring(0,m);D=u[f].substring(m+1)}else N=u[f];h(N,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function bi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof bi){this.h=u.h,Ju(this,u.j),this.o=u.o,this.g=u.g,Xu(this,u.s),this.l=u.l;var h=u.i,f=new ka;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),vT(this,f),this.m=u.m}else u&&(h=String(u).match(yT))?(this.h=!1,Ju(this,h[1]||"",!0),this.o=Ma(h[2]||""),this.g=Ma(h[3]||"",!0),Xu(this,h[4]),this.l=Ma(h[5]||"",!0),vT(this,h[6]||"",!0),this.m=Ma(h[7]||"")):(this.h=!1,this.i=new ka(null,this.h))}bi.prototype.toString=function(){var u=[],h=this.j;h&&u.push(xa(h,IT,!0),":");var f=this.g;return(f||h=="file")&&(u.push("//"),(h=this.o)&&u.push(xa(h,IT,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(xa(f,f.charAt(0)=="/"?kk:xk,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",xa(f,Fk)),u.join("")};function lr(u){return new bi(u)}function Ju(u,h,f){u.j=f?Ma(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function Xu(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function vT(u,h,f){h instanceof ka?(u.i=h,Lk(u.i,u.h)):(f||(h=xa(h,Ok)),u.i=new ka(h,u.h))}function Le(u,h,f){u.i.set(h,f)}function el(u){return Le(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ma(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function xa(u,h,f){return typeof u=="string"?(u=encodeURI(u).replace(h,Mk),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Mk(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var IT=/[#\/\?@]/g,xk=/[#\?:]/g,kk=/[#\?]/g,Ok=/[#\?@]/g,Fk=/#/g;function ka(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function Br(u){u.g||(u.g=new Map,u.h=0,u.i&&Pk(u.i,function(h,f){u.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=ka.prototype,t.add=function(u,h){Br(this),this.i=null,u=ks(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(h),this.h+=1,this};function wT(u,h){Br(u),h=ks(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function ET(u,h){return Br(u),h=ks(u,h),u.g.has(h)}t.forEach=function(u,h){Br(this),this.g.forEach(function(f,m){f.forEach(function(D){u.call(h,D,m,this)},this)},this)},t.na=function(){Br(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let m=0;m<h.length;m++){let D=u[m];for(let N=0;N<D.length;N++)f.push(h[m])}return f},t.V=function(u){Br(this);let h=[];if(typeof u=="string")ET(this,u)&&(h=h.concat(this.g.get(ks(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)h=h.concat(u[f])}return h},t.set=function(u,h){return Br(this),this.i=null,u=ks(this,u),ET(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},t.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function TT(u,h,f){wT(u,h),0<f.length&&(u.i=null,u.g.set(ks(u,h),R(f)),u.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var m=h[f];let N=encodeURIComponent(String(m)),O=this.V(m);for(m=0;m<O.length;m++){var D=N;O[m]!==""&&(D+="="+encodeURIComponent(String(O[m]))),u.push(D)}}return this.i=u.join("&")};function ks(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function Lk(u,h){h&&!u.j&&(Br(u),u.i=null,u.g.forEach(function(f,m){var D=m.toLowerCase();m!=D&&(wT(this,m),TT(this,D,f))},u)),u.j=h}function Vk(u,h){let f=new Na;if(a.Image){let m=new Image;m.onload=_($r,f,"TestLoadImage: loaded",!0,h,m),m.onerror=_($r,f,"TestLoadImage: error",!1,h,m),m.onabort=_($r,f,"TestLoadImage: abort",!1,h,m),m.ontimeout=_($r,f,"TestLoadImage: timeout",!1,h,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=u}else h(!1)}function Uk(u,h){let f=new Na,m=new AbortController,D=setTimeout(()=>{m.abort(),$r(f,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:m.signal}).then(N=>{clearTimeout(D),N.ok?$r(f,"TestPingServer: ok",!0,h):$r(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),$r(f,"TestPingServer: error",!1,h)})}function $r(u,h,f,m,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),m(f)}catch{}}function jk(){this.g=new Ek}function Bk(u,h,f){let m=f||"";try{_T(u,function(D,N){let O=D;l(D)&&(O=vp(D)),h.push(m+N+"="+encodeURIComponent(O))})}catch(D){throw h.push(m+"type="+encodeURIComponent("_badmap")),D}}function Oa(u){this.l=u.Ub||null,this.j=u.eb||!1}E(Oa,Ip),Oa.prototype.g=function(){return new tl(this.l,this.j)},Oa.prototype.i=function(u){return function(){return u}}({});function tl(u,h){Ct.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(tl,Ct),t=tl.prototype,t.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,La(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fa(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,La(this)),this.g&&(this.readyState=3,La(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;CT(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function CT(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?Fa(this):La(this),this.readyState==3&&CT(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Fa(this))},t.Qa=function(u){this.g&&(this.response=u,Fa(this))},t.ga=function(){this.g&&Fa(this)};function Fa(u){u.readyState=4,u.l=null,u.j=null,u.v=null,La(u)}t.setRequestHeader=function(u,h){this.u.append(u,h)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=h.next();return u.join(`\r
`)};function La(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(tl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function bT(u){let h="";return Y(u,function(f,m){h+=m,h+=":",h+=f,h+=`\r
`}),h}function Np(u,h,f){e:{for(m in f){var m=!1;break e}m=!0}m||(f=bT(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Le(u,h,f))}function Ge(u){Ct.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Ge,Ct);var $k=/^https?$/i,Hk=["POST","PUT"];t=Ge.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,h,f,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tp.g(),this.v=this.o?eT(this.o):eT(Tp),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(N){DT(this,N);return}if(u=f||"",f=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var D in m)f.set(D,m[D]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let N of m.keys())f.set(N,m.get(N));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(f.keys()).find(N=>N.toLowerCase()=="content-type"),D=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Hk,h,void 0))||m||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,O]of f)this.g.setRequestHeader(N,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{RT(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){DT(this,N)}};function DT(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,ST(u),nl(u)}function ST(u){u.A||(u.A=!0,Ot(u,"complete"),Ot(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ot(this,"complete"),Ot(this,"abort"),nl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nl(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?AT(this):this.bb())},t.bb=function(){AT(this)};function AT(u){if(u.h&&typeof o<"u"&&(!u.v[1]||dr(u)!=4||u.Z()!=2)){if(u.u&&dr(u)==4)YE(u.Ea,0,u);else if(Ot(u,"readystatechange"),dr(u)==4){u.h=!1;try{let O=u.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var m;if(m=O===0){var D=String(u.D).match(yT)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),m=!$k.test(D?D.toLowerCase():"")}f=m}if(f)Ot(u,"complete"),Ot(u,"success");else{u.m=6;try{var N=2<dr(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",ST(u)}}finally{nl(u)}}}}function nl(u,h){if(u.g){RT(u);let f=u.g,m=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||Ot(u,"ready");try{f.onreadystatechange=m}catch{}}}function RT(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function dr(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<dr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),wk(h)}};function NT(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function qk(u){let h={};u=(u.g&&2<=dr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<u.length;m++){if(L(u[m]))continue;var f=b(u[m]);let D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let N=h[D]||[];h[D]=N,N.push(f)}T(h,function(m){return m.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Va(u,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||h}function PT(u){this.Aa=0,this.i=[],this.j=new Na,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Va("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Va("baseRetryDelayMs",5e3,u),this.cb=Va("retryDelaySeedMs",1e4,u),this.Wa=Va("forwardChannelMaxRetries",2,u),this.wa=Va("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new hT(u&&u.concurrentRequestLimit),this.Da=new jk,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=PT.prototype,t.la=8,t.G=1,t.connect=function(u,h,f,m){Ft(0),this.W=u,this.H=h||{},f&&m!==void 0&&(this.H.OSID=f,this.H.OAID=m),this.F=this.X,this.I=jT(this,null,this.W),il(this)};function Pp(u){if(MT(u),u.G==3){var h=u.U++,f=lr(u.I);if(Le(f,"SID",u.K),Le(f,"RID",h),Le(f,"TYPE","terminate"),Ua(u,f),h=new jr(u,u.j,h),h.L=2,h.v=el(lr(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=h.v,f=!0),f||(h.g=BT(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Zu(h)}UT(u)}function rl(u){u.g&&(xp(u),u.g.cancel(),u.g=null)}function MT(u){rl(u),u.u&&(a.clearTimeout(u.u),u.u=null),sl(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function il(u){if(!fT(u.h)&&!u.s){u.s=!0;var h=u.Ga;Ea||qE(),Ta||(Ea(),Ta=!0),lp.add(h,u),u.B=0}}function zk(u,h){return pT(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ra(g(u.Ga,u,h),VT(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let D=new jr(this,this.j,u),N=this.o;if(this.S&&(N?(N=v(N),C(N,this.S)):N=this.S),this.m!==null||this.O||(D.H=N,N=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var m=this.i[f];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=kT(this,D,h),f=lr(this.I),Le(f,"RID",u),Le(f,"CVER",22),this.D&&Le(f,"X-HTTP-Session-Id",this.D),Ua(this,f),N&&(this.O?h="headers="+encodeURIComponent(String(bT(N)))+"&"+h:this.m&&Np(f,this.m,N)),Rp(this.h,D),this.Ua&&Le(f,"TYPE","init"),this.P?(Le(f,"$req",h),Le(f,"SID","null"),D.T=!0,bp(D,f,null)):bp(D,f,h),this.G=2}}else this.G==3&&(u?xT(this,u):this.i.length==0||fT(this.h)||xT(this))};function xT(u,h){var f;h?f=h.l:f=u.U++;let m=lr(u.I);Le(m,"SID",u.K),Le(m,"RID",f),Le(m,"AID",u.T),Ua(u,m),u.m&&u.o&&Np(m,u.m,u.o),f=new jr(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),h&&(u.i=h.D.concat(u.i)),h=kT(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Rp(u.h,f),bp(f,m,h)}function Ua(u,h){u.H&&Y(u.H,function(f,m){Le(h,m,f)}),u.l&&_T({},function(f,m){Le(h,m,f)})}function kT(u,h,f){f=Math.min(u.i.length,f);var m=u.l?g(u.l.Na,u.l,u):null;e:{var D=u.i;let N=-1;for(;;){let O=["count="+f];N==-1?0<f?(N=D[0].g,O.push("ofs="+N)):N=0:O.push("ofs="+N);let Pe=!0;for(let vt=0;vt<f;vt++){let Ee=D[vt].g,bt=D[vt].map;if(Ee-=N,0>Ee)N=Math.max(0,D[vt].g-100),Pe=!1;else try{Bk(bt,O,"req"+Ee+"_")}catch{m&&m(bt)}}if(Pe){m=O.join("&");break e}}}return u=u.i.splice(0,f),h.D=u,m}function OT(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;Ea||qE(),Ta||(Ea(),Ta=!0),lp.add(h,u),u.v=0}}function Mp(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ra(g(u.Fa,u),VT(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,FT(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ra(g(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),rl(this),FT(this))};function xp(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function FT(u){u.g=new jr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=lr(u.qa);Le(h,"RID","rpc"),Le(h,"SID",u.K),Le(h,"AID",u.T),Le(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&Le(h,"TO",u.ja),Le(h,"TYPE","xmlhttp"),Ua(u,h),u.m&&u.o&&Np(h,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=el(lr(h)),f.m=null,f.P=!0,uT(f,u)}t.Za=function(){this.C!=null&&(this.C=null,rl(this),Mp(this),Ft(19))};function sl(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function LT(u,h){var f=null;if(u.g==h){sl(u),xp(u),u.g=null;var m=2}else if(Ap(u.h,h))f=h.D,gT(u.h,h),m=1;else return;if(u.G!=0){if(h.o)if(m==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var D=u.B;m=Ku(),Ot(m,new sT(m,f)),il(u)}else OT(u);else if(D=h.s,D==3||D==0&&0<h.X||!(m==1&&zk(u,h)||m==2&&Mp(u)))switch(f&&0<f.length&&(h=u.h,h.i=h.i.concat(f)),D){case 1:Di(u,5);break;case 4:Di(u,10);break;case 3:Di(u,6);break;default:Di(u,2)}}}function VT(u,h){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*h}function Di(u,h){if(u.j.info("Error code "+h),h==2){var f=g(u.fb,u),m=u.Xa;let D=!m;m=new bi(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ju(m,"https"),el(m),D?Vk(m.toString(),f):Uk(m.toString(),f)}else Ft(2);u.G=0,u.l&&u.l.sa(h),UT(u),MT(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function UT(u){if(u.G=0,u.ka=[],u.l){let h=mT(u.h);(h.length!=0||u.i.length!=0)&&(A(u.ka,h),A(u.ka,u.i),u.h.i.length=0,R(u.i),u.i.length=0),u.l.ra()}}function jT(u,h,f){var m=f instanceof bi?lr(f):new bi(f);if(m.g!="")h&&(m.g=h+"."+m.g),Xu(m,m.s);else{var D=a.location;m=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var N=new bi(null);m&&Ju(N,m),h&&(N.g=h),D&&Xu(N,D),f&&(N.l=f),m=N}return f=u.D,h=u.ya,f&&h&&Le(m,f,h),Le(m,"VER",u.la),Ua(u,m),m}function BT(u,h,f){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new Ge(new Oa({eb:f})):new Ge(u.pa),h.Ha(u.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $T(){}t=$T.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ol(){}ol.prototype.g=function(u,h){return new Xt(u,h)};function Xt(u,h){Ct.call(this),this.g=new PT(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!L(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!L(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new Os(this)}E(Xt,Ct),Xt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){Pp(this.g)},Xt.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=vp(u),u=f);h.i.push(new Ak(h.Ya++,u)),h.G==3&&il(h)},Xt.prototype.N=function(){this.g.l=null,delete this.j,Pp(this.g),delete this.g,Xt.aa.N.call(this)};function HT(u){wp.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let f in h){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}E(HT,wp);function qT(){Ep.call(this),this.status=1}E(qT,Ep);function Os(u){this.g=u}E(Os,$T),Os.prototype.ua=function(){Ot(this.g,"a")},Os.prototype.ta=function(u){Ot(this.g,new HT(u))},Os.prototype.sa=function(u){Ot(this.g,new qT)},Os.prototype.ra=function(){Ot(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,Vy=Ar.createWebChannelTransport=function(){return new ol},Ly=Ar.getStatEventTarget=function(){return Ku()},Fy=Ar.Event=Ti,qh=Ar.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Qu.NO_ERROR=0,Qu.TIMEOUT=8,Qu.HTTP_ERROR=6,Qc=Ar.ErrorCode=Qu,oT.COMPLETE="complete",Oy=Ar.EventType=oT,tT.EventType=Sa,Sa.OPEN="a",Sa.CLOSE="b",Sa.ERROR="c",Sa.MESSAGE="d",Ct.prototype.listen=Ct.prototype.K,Fo=Ar.WebChannel=tT,fq=Ar.FetchXmlHttpFactory=Oa,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,ky=Ar.XhrIo=Ge}).apply(typeof Hh<"u"?Hh:typeof self<"u"?self:typeof window<"u"?window:{});var dR="@firebase/firestore";var _t=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};_t.UNAUTHENTICATED=new _t(null),_t.GOOGLE_CREDENTIALS=new _t("google-credentials-uid"),_t.FIRST_PARTY=new _t("first-party-uid"),_t.MOCK_USER=new _t("mock-user");var ta="10.14.0";var gs=new Hn("@firebase/firestore");function Yc(){return gs.logLevel}function B(t,...e){if(gs.logLevel<=At.DEBUG){let n=e.map(II);gs.debug(`Firestore (${ta}): ${t}`,...n)}}function Nr(t,...e){if(gs.logLevel<=At.ERROR){let n=e.map(II);gs.error(`Firestore (${ta}): ${t}`,...n)}}function Ho(t,...e){if(gs.logLevel<=At.WARN){let n=e.map(II);gs.warn(`Firestore (${ta}): ${t}`,...n)}}function II(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function X(t="Unexpected state"){let e=`FIRESTORE (${ta}) INTERNAL ASSERTION FAILED: `+t;throw Nr(e),new Error(e)}function Se(t,e){t||X()}function re(t,e){return t}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},j=class extends qt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var rr=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Qh=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Hy=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(_t.UNAUTHENTICATED))}shutdown(){}},qy=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},zy=class{constructor(e){this.t=e,this.currentUser=_t.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Se(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rr,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rr)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Se(typeof r.accessToken=="string"),new Qh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Se(e===null||typeof e=="string"),new _t(e)}},Gy=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=_t.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Wy=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Gy(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(_t.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ky=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Qy=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Se(this.o===void 0);let r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Se(typeof n.token=="string"),this.R=n.token,new Ky(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function pq(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Yh=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=pq(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Te(t,e){return t<e?-1:t>e?1:0}function qo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var gt=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new j(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new j(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new j(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var se=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new gt(0,0))}static max(){return new t(new gt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Zh=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(),r===void 0?r=e.length-n:r>e.length-n&&X(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},qe=class t extends Zh{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new j(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},gq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,dn=class t extends Zh{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return gq.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new j(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new j(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new j(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new j(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var z=class t{constructor(e){this.path=e}static fromPath(e){return new t(qe.fromString(e))}static fromName(e){return new t(qe.fromString(e).popFirst(5))}static empty(){return new t(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new qe(e.slice()))}};var Yy=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};Yy.UNKNOWN_ID=-1;function mq(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new gt(n+1,0):new gt(n,r));return new ms(i,z.empty(),e)}function _q(t){return new ms(t.readTime,t.key,-1)}var ms=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(se.min(),z.empty(),-1)}static max(){return new t(se.max(),z.empty(),-1)}};function yq(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=z.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}var vq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Zy=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function mu(t){return y(this,null,function*(){if(t.code!==P.FAILED_PRECONDITION||t.message!==vq)throw t;B("LocalStore","Unexpectedly lost primary lease")})}var k=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;n(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function Iq(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _u(t){return t.name==="IndexedDbTransactionError"}var GR=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function Af(t){return t==null}function nu(t){return t===0&&1/t==-1/0}function wq(t){return typeof t=="number"&&Number.isInteger(t)&&!nu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Eq=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],eee=[...Eq,"documentOverlays"],Tq=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Cq=Tq,bq=[...Cq,"indexConfiguration","indexState","indexEntries"];var tee=[...bq,"globals"];function hR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function na(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function WR(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ze=class t{constructor(e,n){this.comparator=e,this.root=n||ir.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ir.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ir.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jo(this.root,e,this.comparator,!1)}getReverseIterator(){return new jo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jo(this.root,e,this.comparator,!0)}},jo=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ir=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();let e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}};ir.EMPTY=null,ir.RED=!0,ir.BLACK=!1;ir.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ir(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Nt=class t{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Jh(this.data.getIterator())}getIteratorFrom(e){return new Jh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Jh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var nr=class t{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new t([])}unionWith(e){let n=new Nt(dn.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qo(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Xh=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Pt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Xh("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Pt.EMPTY_BYTE_STRING=new Pt("");var Dq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pr(t){if(Se(!!t),typeof t=="string"){let e=0,n=Dq.exec(t);if(Se(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(t.seconds),nanos:Be(t.nanos)}}function Be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function pi(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}function wI(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function EI(t){let e=t.mapValue.fields.__previous_value__;return wI(e)?EI(e):e}function ru(t){let e=Pr(t.mapValue.fields.__local_write_time__.timestampValue);return new gt(e.seconds,e.nanos)}var Jy=class{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},ef=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var zh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wI(t)?4:QR(t)?9007199254740991:KR(t)?10:11:X()}function ar(t,e){if(t===e)return!0;let n=_s(t);if(n!==_s(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ru(t).isEqual(ru(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Pr(i.timestampValue),a=Pr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return pi(i.bytesValue).isEqual(pi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Be(i.geoPointValue.latitude)===Be(s.geoPointValue.latitude)&&Be(i.geoPointValue.longitude)===Be(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Be(i.integerValue)===Be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Be(i.doubleValue),a=Be(s.doubleValue);return o===a?nu(o)===nu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return qo(t.arrayValue.values||[],e.arrayValue.values||[],ar);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(hR(o)!==hR(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!ar(o[c],a[c])))return!1;return!0}(t,e);default:return X()}}function iu(t,e){return(t.values||[]).find(n=>ar(n,e))!==void 0}function zo(t,e){if(t===e)return 0;let n=_s(t),r=_s(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Be(s.integerValue||s.doubleValue),c=Be(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return fR(t.timestampValue,e.timestampValue);case 4:return fR(ru(t),ru(e));case 5:return Te(t.stringValue,e.stringValue);case 6:return function(s,o){let a=pi(s),c=pi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=Te(a[l],c[l]);if(d!==0)return d}return Te(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Te(Be(s.latitude),Be(o.latitude));return a!==0?a:Te(Be(s.longitude),Be(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return pR(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let p=s.fields||{},g=o.fields||{},_=(a=p.value)===null||a===void 0?void 0:a.arrayValue,E=(c=g.value)===null||c===void 0?void 0:c.arrayValue,R=Te(((l=_?.values)===null||l===void 0?void 0:l.length)||0,((d=E?.values)===null||d===void 0?void 0:d.length)||0);return R!==0?R:pR(_,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===zh.mapValue&&o===zh.mapValue)return 0;if(s===zh.mapValue)return 1;if(o===zh.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let p=0;p<c.length&&p<d.length;++p){let g=Te(c[p],d[p]);if(g!==0)return g;let _=zo(a[c[p]],l[d[p]]);if(_!==0)return _}return Te(c.length,d.length)}(t.mapValue,e.mapValue);default:throw X()}}function fR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);let n=Pr(t),r=Pr(e),i=Te(n.seconds,r.seconds);return i!==0?i:Te(n.nanos,r.nanos)}function pR(t,e){let n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){let s=zo(n[i],r[i]);if(s)return s}return Te(n.length,r.length)}function Go(t){return Xy(t)}function Xy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Pr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return pi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Xy(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Xy(n.fields[o])}`;return i+"}"}(t.mapValue):X()}function gR(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ev(t){return!!t&&"integerValue"in t}function TI(t){return!!t&&"arrayValue"in t}function mR(t){return!!t&&"nullValue"in t}function _R(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wh(t){return!!t&&"mapValue"in t}function KR(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Jc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return na(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Jc(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Jc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function QR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var kn=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Wh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jc(n)}setAll(e){let n=dn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Jc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Wh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ar(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Wh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){na(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Jc(this.value))}};function YR(t){let e=[];return na(t.fields,(n,r)=>{let i=new dn([n]);if(Wh(r)){let s=YR(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new nr(e)}var On=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,se.min(),se.min(),se.min(),kn.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,se.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,se.min(),se.min(),kn.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,se.min(),se.min(),kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Wo=class{constructor(e,n){this.position=e,this.inclusive=n}};function yR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=z.comparator(z.fromName(o.referenceValue),n.key):r=zo(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function vR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ar(t.position[n],e.position[n]))return!1;return!0}var Ko=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Sq(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var tf=class{},dt=class t extends tf{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new nv(e,n,r):n==="array-contains"?new sv(e,r):n==="in"?new ov(e,r):n==="not-in"?new av(e,r):n==="array-contains-any"?new cv(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new rv(e,r):new iv(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(zo(n,this.value)):n!==null&&_s(this.value)===_s(n)&&this.matchesComparison(zo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fn=class t extends tf{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return ZR(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ZR(t){return t.op==="and"}function JR(t){return Aq(t)&&ZR(t)}function Aq(t){for(let e of t.filters)if(e instanceof Fn)return!1;return!0}function tv(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+Go(t.value);if(JR(t))return t.filters.map(e=>tv(e)).join(",");{let e=t.filters.map(n=>tv(n)).join(",");return`${t.op}(${e})`}}function XR(t,e){return t instanceof dt?function(r,i){return i instanceof dt&&r.op===i.op&&r.field.isEqual(i.field)&&ar(r.value,i.value)}(t,e):t instanceof Fn?function(r,i){return i instanceof Fn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&XR(o,i.filters[a]),!0):!1}(t,e):void X()}function eN(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${Go(n.value)}`}(t):t instanceof Fn?function(n){return n.op.toString()+" {"+n.getFilters().map(eN).join(" ,")+"}"}(t):"Filter"}var nv=class extends dt{constructor(e,n,r){super(e,n,r),this.key=z.fromName(r.referenceValue)}matches(e){let n=z.comparator(e.key,this.key);return this.matchesComparison(n)}},rv=class extends dt{constructor(e,n){super(e,"in",n),this.keys=tN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},iv=class extends dt{constructor(e,n){super(e,"not-in",n),this.keys=tN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function tN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>z.fromName(r.referenceValue))}var sv=class extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return TI(n)&&iu(n.arrayValue,this.value)}},ov=class extends dt{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&iu(this.value.arrayValue,n)}},av=class extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!iu(this.value.arrayValue,n)}},cv=class extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!TI(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>iu(this.value.arrayValue,r))}};var uv=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function IR(t,e=null,n=[],r=[],i=null,s=null,o=null){return new uv(t,e,n,r,i,s,o)}function CI(t){let e=re(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>tv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Af(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Go(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Go(r)).join(",")),e.ue=n}return e.ue}function bI(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Sq(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!XR(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vR(t.startAt,e.startAt)&&vR(t.endAt,e.endAt)}function lv(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var ys=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Rq(t,e,n,r,i,s,o,a){return new ys(t,e,n,r,i,s,o,a)}function DI(t){return new ys(t)}function wR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nN(t){return t.collectionGroup!==null}function Xc(t){let e=re(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Nt(dn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ko(s,r))}),n.has(dn.keyField().canonicalString())||e.ce.push(new Ko(dn.keyField(),r))}return e.ce}function sr(t){let e=re(t);return e.le||(e.le=Nq(e,Xc(t))),e.le}function Nq(t,e){if(t.limitType==="F")return IR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ko(i.field,s)});let n=t.endAt?new Wo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wo(t.startAt.position,t.startAt.inclusive):null;return IR(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function dv(t,e){let n=t.filters.concat([e]);return new ys(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function hv(t,e,n){return new ys(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Rf(t,e){return bI(sr(t),sr(e))&&t.limitType===e.limitType}function rN(t){return`${CI(sr(t))}|lt:${t.limitType}`}function Lo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>eN(i)).join(", ")}]`),Af(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Go(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Go(i)).join(",")),`Target(${r})`}(sr(t))}; limitType=${t.limitType})`}function Nf(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):z.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Xc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=yR(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,Xc(r),i)||r.endAt&&!function(o,a,c){let l=yR(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,Xc(r),i))}(t,e)}function Pq(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function iN(t){return(e,n)=>{let r=!1;for(let i of Xc(t)){let s=Mq(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Mq(t,e,n){let r=t.field.isKeyField()?z.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?zo(c,l):X()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}var gi=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){na(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return WR(this.inner)}size(){return this.innerSize}};var xq=new Ze(z.comparator);function Mr(){return xq}var sN=new Ze(z.comparator);function Zc(...t){let e=sN;for(let n of t)e=e.insert(n.key,n);return e}function oN(t){let e=sN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function hs(){return eu()}function aN(){return eu()}function eu(){return new gi(t=>t.toString(),(t,e)=>t.isEqual(e))}var kq=new Ze(z.comparator),Oq=new Nt(z.comparator);function he(...t){let e=Oq;for(let n of t)e=e.add(n);return e}var Fq=new Nt(Te);function Lq(){return Fq}function SI(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nu(e)?"-0":e}}function cN(t){return{integerValue:""+t}}function Vq(t,e){return wq(e)?cN(e):SI(t,e)}var Qo=class{constructor(){this._=void 0}};function Uq(t,e,n){return t instanceof Yo?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&wI(s)&&(s=EI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof vs?lN(t,e):t instanceof Is?dN(t,e):function(i,s){let o=uN(i,s),a=ER(o)+ER(i.Pe);return ev(o)&&ev(i.Pe)?cN(a):SI(i.serializer,a)}(t,e)}function jq(t,e,n){return t instanceof vs?lN(t,e):t instanceof Is?dN(t,e):n}function uN(t,e){return t instanceof Zo?function(r){return ev(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Yo=class extends Qo{},vs=class extends Qo{constructor(e){super(),this.elements=e}};function lN(t,e){let n=hN(e);for(let r of t.elements)n.some(i=>ar(i,r))||n.push(r);return{arrayValue:{values:n}}}var Is=class extends Qo{constructor(e){super(),this.elements=e}};function dN(t,e){let n=hN(e);for(let r of t.elements)n=n.filter(i=>!ar(i,r));return{arrayValue:{values:n}}}var Zo=class extends Qo{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function ER(t){return Be(t.integerValue||t.doubleValue)}function hN(t){return TI(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Bq(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof vs&&i instanceof vs||r instanceof Is&&i instanceof Is?qo(r.elements,i.elements,ar):r instanceof Zo&&i instanceof Zo?ar(r.Pe,i.Pe):r instanceof Yo&&i instanceof Yo}(t.transform,e.transform)}var fv=class{constructor(e,n){this.version=e,this.transformResults=n}},hi=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Kh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Jo=class{};function fN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new su(t.key,hi.none()):new ws(t.key,t.data,hi.none());{let n=t.data,r=kn.empty(),i=new Nt(dn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new xr(t.key,r,new nr(i.toArray()),hi.none())}}function $q(t,e,n){t instanceof ws?function(i,s,o){let a=i.value.clone(),c=CR(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof xr?function(i,s,o){if(!Kh(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=CR(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(pN(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function tu(t,e,n,r){return t instanceof ws?function(s,o,a,c){if(!Kh(s.precondition,o))return a;let l=s.value.clone(),d=bR(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof xr?function(s,o,a,c){if(!Kh(s.precondition,o))return a;let l=bR(s.fieldTransforms,c,o),d=o.data;return d.setAll(pN(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Kh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Hq(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=uN(r.transform,i||null);s!=null&&(n===null&&(n=kn.empty()),n.set(r.field,s))}return n||null}function TR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qo(r,i,(s,o)=>Bq(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ws=class extends Jo{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},xr=class extends Jo{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function pN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function CR(t,e,n){let r=new Map;Se(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,jq(o,a,n[i]))}return r}function bR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Uq(s,o,e))}return r}var su=class extends Jo{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},pv=class extends Jo{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var gv=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&$q(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=tu(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=tu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=aN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=fN(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),he())}isEqual(e){return this.batchId===e.batchId&&qo(this.mutations,e.mutations,(n,r)=>TR(n,r))&&qo(this.baseMutations,e.baseMutations,(n,r)=>TR(n,r))}},mv=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Se(e.mutations.length===r.length);let i=function(){return kq}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var _v=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var yv=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var ut,ye;function qq(t){switch(t){default:return X();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function gN(t){if(t===void 0)return Nr("GRPC error has no .code"),P.UNKNOWN;switch(t){case ut.OK:return P.OK;case ut.CANCELLED:return P.CANCELLED;case ut.UNKNOWN:return P.UNKNOWN;case ut.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ut.INTERNAL:return P.INTERNAL;case ut.UNAVAILABLE:return P.UNAVAILABLE;case ut.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ut.NOT_FOUND:return P.NOT_FOUND;case ut.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ut.ABORTED:return P.ABORTED;case ut.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ut.DATA_LOSS:return P.DATA_LOSS;default:return X()}}(ye=ut||(ut={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";var DR=null;function zq(){return new TextEncoder}var Gq=new di([4294967295,4294967295],0);function SR(t){let e=zq().encode(t),n=new xy;return n.update(e),new Uint8Array(n.digest())}function AR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new di([n,r],0),new di([i,s],0)]}var vv=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new fs(`Invalid padding: ${n}`);if(r<0)throw new fs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new fs(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=di.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(di.fromNumber(r)));return i.compare(Gq)===1&&(i=new di([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let n=SR(e),[r,i]=AR(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let n=SR(e),[r,i]=AR(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},fs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var nf=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,ou.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(se.min(),i,new Ze(Te),Mr(),he())}},ou=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,he(),he(),he())}};var Bo=class{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}},rf=class{constructor(e,n){this.targetId=e,this.me=n}},sf=class{constructor(e,n,r=Pt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},of=class{constructor(){this.fe=0,this.ge=NR(),this.pe=Pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=he(),n=he(),r=he();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:X()}}),new ou(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=NR()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Iv=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mr(),this.qe=RR(),this.Qe=new Ze(Te)}Ke(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{let r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:X()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){let n=e.targetId,r=e.me.count,i=this.Je(n);if(i){let s=i.target;if(lv(s))if(r===0){let o=new z(s.path);this.Ue(n,o,On.newNoDocument(o,se.min()))}else Se(r===1);else{let o=this.Ye(n);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(n);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,l)}DR?.et(function(d,p,g,_,E){var R,A,x,L,$,G;let Ne={localCacheCount:d,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},Y=p.unchangedNames;return Y&&(Ne.bloomFilter={applied:E===0,hashCount:(R=Y?.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(L=(x=(A=Y?.bits)===null||A===void 0?void 0:A.bitmap)===null||x===void 0?void 0:x.length)!==null&&L!==void 0?L:0,padding:(G=($=Y?.bits)===null||$===void 0?void 0:$.padding)!==null&&G!==void 0?G:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),Ne}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=pi(r).toUint8Array()}catch(c){if(c instanceof Xh)return Ho("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new vv(o,i,s)}catch(c){return Ho(c instanceof fs?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){let n=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&lv(a.target)){let c=new z(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,On.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=he();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new nf(e,n,this.Qe,this.ke,r);return this.ke=Mr(),this.qe=RR(),this.Qe=new Ze(Te),i}$e(e,n){if(!this.ze(e))return;let r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new of,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Nt(Te),this.qe=this.qe.insert(e,n)),n}ze(e){let n=this.Je(e)!==null;return n||B("WatchChangeAggregator","Detected inactive target",e),n}Je(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new of),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function RR(){return new Ze(z.comparator)}function NR(){return new Ze(z.comparator)}var Wq={asc:"ASCENDING",desc:"DESCENDING"},Kq={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Qq={and:"AND",or:"OR"},wv=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function Ev(t,e){return t.useProto3Json||Af(e)?e:{value:e}}function af(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Yq(t,e){return af(t,e.toTimestamp())}function or(t){return Se(!!t),se.fromTimestamp(function(n){let r=Pr(n);return new gt(r.seconds,r.nanos)}(t))}function AI(t,e){return Tv(t,e).canonicalString()}function Tv(t,e){let n=function(i){return new qe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function _N(t){let e=qe.fromString(t);return Se(EN(e)),e}function Cv(t,e){return AI(t.databaseId,e.path)}function Uy(t,e){let n=_N(e);if(n.get(1)!==t.databaseId.projectId)throw new j(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new j(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new z(vN(n))}function yN(t,e){return AI(t.databaseId,e)}function Zq(t){let e=_N(t);return e.length===4?qe.emptyPath():vN(e)}function bv(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vN(t){return Se(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function PR(t,e,n){return{name:Cv(t,e),fields:n.value.mapValue.fields}}function Jq(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Se(d===void 0||typeof d=="string"),Pt.fromBase64String(d||"")):(Se(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Pt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?P.UNKNOWN:gN(l.code);return new j(d,l.message||"")}(o);n=new sf(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Uy(t,r.document.name),s=or(r.document.updateTime),o=r.document.createTime?or(r.document.createTime):se.min(),a=new kn({mapValue:{fields:r.document.fields}}),c=On.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];n=new Bo(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Uy(t,r.document),s=r.readTime?or(r.readTime):se.min(),o=On.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Bo([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Uy(t,r.document),s=r.removedTargetIds||[];n=new Bo([],s,i,null)}else{if(!("filter"in e))return X();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new yv(i,s),a=r.targetId;n=new rf(a,o)}}return n}function Xq(t,e){let n;if(e instanceof ws)n={update:PR(t,e.key,e.value)};else if(e instanceof su)n={delete:Cv(t,e.key)};else if(e instanceof xr)n={update:PR(t,e.key,e.data),updateMask:cz(e.fieldMask)};else{if(!(e instanceof pv))return X();n={verify:Cv(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Yo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof vs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Is)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Zo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw X()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Yq(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:X()}(t,e.precondition)),n}function ez(t,e){return t&&t.length>0?(Se(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?or(i.updateTime):or(s);return o.isEqual(se.min())&&(o=or(s)),new fv(o,i.transformResults||[])}(n,e))):[]}function tz(t,e){return{documents:[yN(t,e.path)]}}function nz(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=yN(t,i);let s=function(l){if(l.length!==0)return wN(Fn.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:Vo(g.field),direction:sz(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=Ev(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:n,parent:i}}function rz(t){let e=Zq(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Se(r===1);let d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){let g=IN(p);return g instanceof Fn&&JR(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(E){return new Ko(Uo(E.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,Af(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(p){let g=!!p.before,_=p.values||[];return new Wo(_,g)}(n.startAt));let l=null;return n.endAt&&(l=function(p){let g=!p.before,_=p.values||[];return new Wo(_,g)}(n.endAt)),Rq(e,i,o,s,a,"F",c,l)}function iz(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function IN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Uo(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Uo(n.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Uo(n.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Uo(n.unaryFilter.field);return dt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(t):t.fieldFilter!==void 0?function(n){return dt.create(Uo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Fn.create(n.compositeFilter.filters.map(r=>IN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return X()}}(n.compositeFilter.op))}(t):X()}function sz(t){return Wq[t]}function oz(t){return Kq[t]}function az(t){return Qq[t]}function Vo(t){return{fieldPath:t.canonicalString()}}function Uo(t){return dn.fromServerFormat(t.fieldPath)}function wN(t){return t instanceof dt?function(n){if(n.op==="=="){if(_R(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NAN"}};if(mR(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_R(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NOT_NAN"}};if(mR(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vo(n.field),op:oz(n.op),value:n.value}}}(t):t instanceof Fn?function(n){let r=n.getFilters().map(i=>wN(i));return r.length===1?r[0]:{compositeFilter:{op:az(n.op),filters:r}}}(t):X()}function cz(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function EN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var au=class t{constructor(e,n,r,i,s=se.min(),o=se.min(),a=Pt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Dv=class{constructor(e){this.ct=e}};function uz(t){let e=rz({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hv(e,e.limit,"L"):e}var cf=class{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Be(e.integerValue));else if("doubleValue"in e){let r=Be(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),nu(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Pr(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(pi(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?QR(e)?this.dt(n,Number.MAX_SAFE_INTEGER):KR(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):X()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){let r=e.fields||{};this.dt(n,55);for(let i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;let s=e.fields||{};this.dt(n,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(Be(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){let r=e.values||[];this.dt(n,50);for(let i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),z.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}};cf.vt=new cf;var Sv=class{constructor(){this.un=new Av}addToCollectionParentIndex(e,n){return this.un.add(n),k.resolve()}getCollectionParents(e,n){return k.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return k.resolve()}deleteFieldIndex(e,n){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,n){return k.resolve()}getDocumentsMatchingTarget(e,n){return k.resolve(null)}getIndexType(e,n){return k.resolve(0)}getFieldIndexes(e,n){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,n){return k.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,n){return k.resolve(ms.min())}updateCollectionGroup(e,n,r){return k.resolve()}updateIndexEntries(e,n){return k.resolve()}},Av=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Nt(qe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Nt(qe.comparator)).toArray()}};var ree=new Uint8Array(0);var tr=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};tr.DEFAULT_COLLECTION_PERCENTILE=10,tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tr.DEFAULT=new tr(41943040,tr.DEFAULT_COLLECTION_PERCENTILE,tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tr.DISABLED=new tr(-1,0,0);var cu=class t{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new t(0)}static kn(){return new t(-1)}};var Rv=class{constructor(){this.changes=new gi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,On.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?k.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Nv=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Pv=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&tu(r.mutation,i,nr.empty(),gt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,n,r=he()){let i=hs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Zc();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=hs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,he()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Mr(),o=eu(),a=function(){return eu()}();return n.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof xr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),tu(d.mutation,l,d.mutation.getFieldMask(),gt.now())):o.set(l.key,nr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),n.forEach((l,d)=>{var p;return a.set(l,new Nv(d,(p=o.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){let r=eu(),i=new Ze((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=n.get(c);if(l===null)return;let d=r.get(c)||nr.empty();d=a.applyToLocalView(l,d),r.set(c,d);let p=(i.get(a.batchId)||he()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,p=aN();d.forEach(g=>{if(!s.has(g)){let _=fN(n.get(g),r.get(g));_!==null&&p.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return k.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):nN(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):k.resolve(hs()),a=-1,c=s;return o.next(l=>k.forEach(l,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,he())).next(d=>({batchId:a,changes:oN(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new z(n)).next(r=>{let i=Zc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Zc();return this.indexManager.getCollectionParents(e,s).next(a=>k.forEach(a,c=>{let l=function(p,g){return new ys(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,On.newInvalidDocument(d)))});let a=Zc();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&tu(d.mutation,l,nr.empty(),gt.now()),Nf(n,l)&&(a=a.insert(c,l))}),a})}};var Mv=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return k.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:or(i.createTime)}}(n)),k.resolve()}getNamedQuery(e,n){return k.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:uz(i.bundledQuery),readTime:or(i.readTime)}}(n)),k.resolve()}};var xv=class{constructor(){this.overlays=new Ze(z.comparator),this.Ir=new Map}getOverlay(e,n){return k.resolve(this.overlays.get(n))}getOverlays(e,n){let r=hs();return k.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),k.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),k.resolve()}getOverlaysForCollection(e,n,r){let i=hs(),s=n.length+1,o=new z(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return k.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ze((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=hs(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=hs(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return k.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _v(n,r));let s=this.Ir.get(n);s===void 0&&(s=he(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}};var kv=class{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,k.resolve()}};var uu=class{constructor(){this.Tr=new Nt(lt.Er),this.dr=new Nt(lt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){let r=new lt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new lt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){let n=new z(new qe([])),r=new lt(n,e),i=new lt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let n=new z(new qe([])),r=new lt(n,e),i=new lt(n,e+1),s=he();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new lt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},lt=class{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return z.comparator(e.key,n.key)||Te(e.wr,n.wr)}static Ar(e,n){return Te(e.wr,n.wr)||z.comparator(e.key,n.key)}};var Ov=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Nt(lt.Er)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new gv(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new lt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,n){return k.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.vr(r),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new lt(n,0),i=new lt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nt(Te);return n.forEach(i=>{let s=new lt(i,0),o=new lt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),k.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;z.isDocumentKey(s)||(s=s.child(""));let o=new lt(new z(s),0),a=new Nt(Te);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),k.resolve(this.Cr(a))}Cr(e){let n=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Se(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return k.forEach(n.mutations,i=>{let s=new lt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){let r=new lt(n,0),i=this.br.firstAfterOrEqual(r);return k.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Fv=class{constructor(e){this.Mr=e,this.docs=function(){return new Ze(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return k.resolve(r?r.document.mutableCopy():On.newInvalidDocument(n))}getEntries(e,n){let r=Mr();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():On.newInvalidDocument(i))}),k.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Mr(),o=n.path,a=new z(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||yq(_q(d),r)<=0||(i.has(d.key)||Nf(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,n,r,i){X()}Or(e,n){return k.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Lv(this)}getSize(e){return k.resolve(this.size)}},Lv=class extends Rv{constructor(e){super(),this.cr=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),k.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}};var Vv=class{constructor(e){this.persistence=e,this.Nr=new gi(n=>CI(n),bI),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new uu,this.targetCount=0,this.kr=cu.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),k.resolve()}Kn(e){this.Nr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.kr=new cu(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,k.resolve()}updateTargetData(e,n){return this.Kn(n),k.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,n){let r=this.Nr.get(n)||null;return k.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),k.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),k.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Br.yr(n);return k.resolve(r)}containsKey(e,n){return k.resolve(this.Br.containsKey(n))}};var Uv=class{constructor(e,n){this.qr={},this.overlays={},this.Qr=new GR(0),this.Kr=!1,this.Kr=!0,this.$r=new kv,this.referenceDelegate=e(this),this.Ur=new Vv(this),this.indexManager=new Sv,this.remoteDocumentCache=function(i){return new Fv(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Dv(n),this.Gr=new Mv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new xv,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Ov(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){B("MemoryPersistence","Starting transaction:",e);let i=new jv(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return k.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}},jv=class extends Zy{constructor(e){super(),this.currentSequenceNumber=e}},Bv=class t{constructor(e){this.persistence=e,this.Jr=new uu,this.Yr=null}static Zr(e){return new t(e)}get Xr(){if(this.Yr)return this.Yr;throw X()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),k.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),k.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Xr,r=>{let i=z.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,se.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return k.or([()=>k.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}};var $v=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=he(),i=he();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Hv=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var qv=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return JT()?8:Iq(St())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Hv;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Yc()<=At.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",Lo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),k.resolve()):(Yc()<=At.DEBUG&&B("QueryEngine","Query:",Lo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Yc()<=At.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",Lo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,sr(n))):k.resolve())}Yi(e,n){if(wR(n))return k.resolve(null);let r=sr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=hv(n,null,"F"),r=sr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=he(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(n,a);return this.ns(n,l,o,c.readTime)?this.Yi(e,hv(n,null,"F")):this.rs(e,l,n,c)}))})))}Zi(e,n,r,i){return wR(n)||i.isEqual(se.min())?k.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(n,s);return this.ns(n,o,r,i)?k.resolve(null):(Yc()<=At.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Lo(n)),this.rs(e,o,n,mq(i,-1)).next(a=>a))})}ts(e,n){let r=new Nt(iN(e));return n.forEach((i,s)=>{Nf(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Yc()<=At.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",Lo(n)),this.Ji.getDocumentsMatchingQuery(e,n,ms.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var zv=class{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ze(Te),this._s=new gi(s=>CI(s),bI),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pv(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}};function lz(t,e,n,r){return new zv(t,e,n,r)}function TN(t,e){return y(this,null,function*(){let n=re(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=he();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function dz(t,e){let n=re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let p=l.batch,g=p.keys(),_=k.resolve();return g.forEach(E=>{_=_.next(()=>d.getEntry(c,E)).next(R=>{let A=l.docVersions.get(E);Se(A!==null),R.version.compareTo(A)<0&&(p.applyToRemoteDocument(R,l),R.isValidDocument()&&(R.setReadTime(l.commitVersion),d.addEntry(R)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=he();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function CN(t){let e=re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function hz(t,e){let n=re(t),r=e.snapshotVersion,i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;let a=[];e.targetChanges.forEach((d,p)=>{let g=i.get(p);if(!g)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,p)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(Pt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(p,_),function(R,A,x){return R.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,_,d)&&a.push(n.Ur.updateTargetData(s,_))});let c=Mr(),l=he();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(fz(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(se.min())){let d=n.Ur.getLastRemoteSnapshotVersion(s).next(p=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return k.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.os=i,s))}function fz(t,e,n){let r=he(),i=he();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Mr();return n.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):B("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function pz(t,e){let n=re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gz(t,e){let n=re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,k.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new au(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}function Gv(t,e,n){return y(this,null,function*(){let r=re(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!_u(o))throw o;B("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function MR(t,e,n){let r=re(t),i=se.min(),s=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let p=re(c),g=p._s.get(d);return g!==void 0?k.resolve(p.os.get(g)):p.Ur.getTargetData(l,d)}(r,o,sr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:se.min(),n?s:he())).next(a=>(mz(r,Pq(e),a),{documents:a,Ts:s})))}function mz(t,e,n){let r=t.us.get(e)||se.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}var uf=class{constructor(){this.activeTargetIds=Lq()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Wv=class{constructor(){this.so=new uf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new uf,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Kv=class{_o(e){}shutdown(){}};var lf=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Gh=null;function jy(){return Gh===null?Gh=function(){return 268435456+Math.round(2147483648*Math.random())}():Gh++,"0x"+Gh.toString(16)}var _z={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Qv=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Rt="WebChannelConnection",Yv=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){let a=jy(),c=this.xo(n,r.toUriEncodedString());B("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(n,c,l,i).then(d=>(B("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Ho("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ta}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){let i=_z[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){let s=jy();return new Promise((o,a)=>{let c=new ky;c.setWithCredentials(!0),c.listenOnce(Oy.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Qc.NO_ERROR:let d=c.getResponseJson();B(Rt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Qc.TIMEOUT:B(Rt,`RPC '${e}' ${s} timed out`),a(new j(P.DEADLINE_EXCEEDED,"Request time out"));break;case Qc.HTTP_ERROR:let p=c.getStatus();if(B(Rt,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let _=g?.error;if(_&&_.status&&_.message){let E=function(A){let x=A.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(x)>=0?x:P.UNKNOWN}(_.status);a(new j(E,_.message))}else a(new j(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new j(P.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{B(Rt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);B(Rt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",l,r,15)})}Bo(e,n,r){let i=jy(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Vy(),a=Ly(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let d=s.join("");B(Rt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let p=o.createWebChannel(d,c),g=!1,_=!1,E=new Qv({Io:A=>{_?B(Rt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(g||(B(Rt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),B(Rt,`RPC '${e}' stream ${i} sending:`,A),p.send(A))},To:()=>p.close()}),R=(A,x,L)=>{A.listen(x,$=>{try{L($)}catch(G){setTimeout(()=>{throw G},0)}})};return R(p,Fo.EventType.OPEN,()=>{_||(B(Rt,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),R(p,Fo.EventType.CLOSE,()=>{_||(_=!0,B(Rt,`RPC '${e}' stream ${i} transport closed`),E.So())}),R(p,Fo.EventType.ERROR,A=>{_||(_=!0,Ho(Rt,`RPC '${e}' stream ${i} transport errored:`,A),E.So(new j(P.UNAVAILABLE,"The operation could not be completed")))}),R(p,Fo.EventType.MESSAGE,A=>{var x;if(!_){let L=A.data[0];Se(!!L);let $=L,G=$.error||((x=$[0])===null||x===void 0?void 0:x.error);if(G){B(Rt,`RPC '${e}' stream ${i} received error:`,G);let Ne=G.status,Y=function(I){let C=ut[I];if(C!==void 0)return gN(C)}(Ne),T=G.message;Y===void 0&&(Y=P.INTERNAL,T="Unknown error status: "+Ne+" with message "+G.message),_=!0,E.So(new j(Y,T)),p.close()}else B(Rt,`RPC '${e}' stream ${i} received:`,L),E.bo(L)}}),R(a,Fy.STAT_EVENT,A=>{A.stat===qh.PROXY?B(Rt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===qh.NOPROXY&&B(Rt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}};function By(){return typeof document<"u"?document:null}function Pf(t){return new wv(t,!0)}var df=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var hf=class{constructor(e,n,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new df(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,n){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===P.RESOURCE_EXHAUSTED?(Nr(n.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(n)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{let i=new j(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){let r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return B("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Zv=class extends hf{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let n=Jq(this.serializer,e),r=function(s){if(!("targetChange"in s))return se.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?or(o.readTime):se.min()}(e);return this.listener.d_(n,r)}A_(e){let n={};n.database=bv(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=lv(c)?{documents:tz(s,c)}:{query:nz(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mN(s,o.resumeToken);let l=Ev(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(se.min())>0){a.readTime=af(s,o.snapshotVersion.toTimestamp());let l=Ev(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=iz(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){let n={};n.database=bv(this.serializer),n.removeTarget=e,this.a_(n)}},Jv=class extends hf{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Se(!!e.streamToken),this.lastStreamToken=e.streamToken,Se(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let n=ez(e.writeResults,e.commitTime),r=or(e.commitTime);return this.listener.g_(r,n)}p_(){let e={};e.database=bv(this.serializer),this.a_(e)}m_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Xq(this.serializer,r))};this.a_(n)}};var Xv=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new j(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Tv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(P.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Tv(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(P.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},eI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Nr(n),this.D_=!1):B("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var tI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>y(this,null,function*(){Ts(this)&&(B("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let l=re(c);l.L_.add(4),yield yu(l),l.q_.set("Unknown"),l.L_.delete(4),yield Mf(l)})}(this))}))}),this.q_=new eI(r,i)}};function Mf(t){return y(this,null,function*(){if(Ts(t))for(let e of t.B_)yield e(!0)})}function yu(t){return y(this,null,function*(){for(let e of t.B_)yield e(!1)})}function bN(t,e){let n=re(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),MI(n)?PI(n):ra(n).r_()&&NI(n,e))}function RI(t,e){let n=re(t),r=ra(n);n.N_.delete(e),r.r_()&&DN(n,e),n.N_.size===0&&(r.r_()?r.o_():Ts(n)&&n.q_.set("Unknown"))}function NI(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ra(t).A_(e)}function DN(t,e){t.Q_.xe(e),ra(t).R_(e)}function PI(t){t.Q_=new Iv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ra(t).start(),t.q_.v_()}function MI(t){return Ts(t)&&!ra(t).n_()&&t.N_.size>0}function Ts(t){return re(t).L_.size===0}function SN(t){t.Q_=void 0}function yz(t){return y(this,null,function*(){t.q_.set("Online")})}function vz(t){return y(this,null,function*(){t.N_.forEach((e,n)=>{NI(t,e)})})}function Iz(t,e){return y(this,null,function*(){SN(t),MI(t)?(t.q_.M_(e),PI(t)):t.q_.set("Unknown")})}function wz(t,e,n){return y(this,null,function*(){if(t.q_.set("Online"),e instanceof sf&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(t,e)}catch(r){B("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield ff(t,r)}else if(e instanceof Bo?t.Q_.Ke(e):e instanceof rf?t.Q_.He(e):t.Q_.We(e),!n.isEqual(se.min()))try{let r=yield CN(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Pt.EMPTY_BYTE_STRING,d.snapshotVersion)),DN(s,c);let p=new au(d.target,c,l,d.sequenceNumber);NI(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){B("RemoteStore","Failed to raise snapshot:",r),yield ff(t,r)}})}function ff(t,e,n){return y(this,null,function*(){if(!_u(e))throw e;t.L_.add(1),yield yu(t),t.q_.set("Offline"),n||(n=()=>CN(t.localStore)),t.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){B("RemoteStore","Retrying IndexedDB access"),yield n(),t.L_.delete(1),yield Mf(t)}))})}function AN(t,e){return e().catch(n=>ff(t,n,e))}function xf(t){return y(this,null,function*(){let e=re(t),n=mi(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Ez(e);)try{let i=yield pz(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,Tz(e,i)}catch(i){yield ff(e,i)}RN(e)&&NN(e)})}function Ez(t){return Ts(t)&&t.O_.length<10}function Tz(t,e){t.O_.push(e);let n=mi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function RN(t){return Ts(t)&&!mi(t).n_()&&t.O_.length>0}function NN(t){mi(t).start()}function Cz(t){return y(this,null,function*(){mi(t).p_()})}function bz(t){return y(this,null,function*(){let e=mi(t);for(let n of t.O_)e.m_(n.mutations)})}function Dz(t,e,n){return y(this,null,function*(){let r=t.O_.shift(),i=mv.from(r,e,n);yield AN(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield xf(t)})}function Sz(t,e){return y(this,null,function*(){e&&mi(t).V_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return qq(o)&&o!==P.ABORTED}(i.code)){let s=r.O_.shift();mi(r).s_(),yield AN(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield xf(r)}})}(t,e)),RN(t)&&NN(t)})}function xR(t,e){return y(this,null,function*(){let n=re(t);n.asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials");let r=Ts(n);n.L_.add(3),yield yu(n),r&&n.q_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),yield Mf(n)})}function Az(t,e){return y(this,null,function*(){let n=re(t);e?(n.L_.delete(2),yield Mf(n)):e||(n.L_.add(2),yield yu(n),n.q_.set("Unknown"))})}function ra(t){return t.K_||(t.K_=function(n,r,i){let s=re(n);return s.w_(),new Zv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:yz.bind(null,t),Ro:vz.bind(null,t),mo:Iz.bind(null,t),d_:wz.bind(null,t)}),t.B_.push(e=>y(this,null,function*(){e?(t.K_.s_(),MI(t)?PI(t):t.q_.set("Unknown")):(yield t.K_.stop(),SN(t))}))),t.K_}function mi(t){return t.U_||(t.U_=function(n,r,i){let s=re(n);return s.w_(),new Jv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Cz.bind(null,t),mo:Sz.bind(null,t),f_:bz.bind(null,t),g_:Dz.bind(null,t)}),t.B_.push(e=>y(this,null,function*(){e?(t.U_.s_(),yield xf(t)):(yield t.U_.stop(),t.O_.length>0&&(B("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))}))),t.U_}var nI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function xI(t,e){if(Nr("AsyncQueue",`${e}: ${t}`),_u(t))return new j(P.UNAVAILABLE,`${e}: ${t}`);throw t}var pf=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||z.comparator(n.key,r.key):(n,r)=>z.comparator(n.key,r.key),this.keyedMap=Zc(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var gf=class{constructor(){this.W_=new Ze(z.comparator)}track(e){let n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):X():this.W_=this.W_.insert(n,e)}G_(){let e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}},Xo=class t{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,pf.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var rI=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},iI=class{constructor(){this.queries=kR(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){let i=re(n),s=i.queries;i.queries=kR(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new j(P.ABORTED,"Firestore shutting down"))}};function kR(){return new gi(t=>rN(t),Rf)}function PN(t,e){return y(this,null,function*(){let n=re(t),r=3,i=e.query,s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new rI,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield n.onListen(i,!0);break;case 1:s.z_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=xI(o,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&kI(n)})}function MN(t,e){return y(this,null,function*(){let n=re(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function Rz(t,e){let n=re(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&kI(n)}function Nz(t,e,n){let r=re(t),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(n);r.queries.delete(e)}function kI(t){t.Y_.forEach(e=>{e.next()})}var sI,OR;(OR=sI||(sI={})).ea="default",OR.Cache="cache";var mf=class{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Xo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;let r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==sI.Cache}};var _f=class{constructor(e){this.key=e}},yf=class{constructor(e){this.key=e}},oI=class{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=he(),this.mutatedKeys=he(),this.Aa=iN(e),this.Ra=new pf(this.Aa)}get Va(){return this.Ta}ma(e,n){let r=n?n.fa:new gf,i=n?n.Ra:this.Ra,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{let g=i.get(d),_=Nf(this.query,p)?p:null,E=!!g&&this.mutatedKeys.has(g.key),R=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),A=!1;g&&_?g.data.isEqual(_.data)?E!==R&&(r.track({type:3,doc:_}),A=!0):this.ga(g,_)||(r.track({type:2,doc:_}),A=!0,(c&&this.Aa(_,c)>0||l&&this.Aa(_,l)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),A=!0):g&&!_&&(r.track({type:1,doc:g}),A=!0,(c||l)&&(a=!0)),A&&(_?(o=o.add(_),s=R?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,p)=>function(_,E){let R=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return R(_)-R(E)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new Xo(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new gf,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=he(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let n=[];return e.forEach(r=>{this.da.has(r)||n.push(new yf(r))}),this.da.forEach(r=>{e.has(r)||n.push(new _f(r))}),n}ba(e){this.Ta=e.Ts,this.da=he();let n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Xo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},aI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},cI=class{constructor(e){this.key=e,this.va=!1}},uI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new gi(a=>rN(a),Rf),this.Ma=new Map,this.xa=new Set,this.Oa=new Ze(z.comparator),this.Na=new Map,this.La=new uu,this.Ba={},this.ka=new Map,this.qa=cu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Pz(t,e,n=!0){return y(this,null,function*(){let r=VN(t),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield xN(r,e,n,!0),i})}function Mz(t,e){return y(this,null,function*(){let n=VN(t);yield xN(n,e,!0,!1)})}function xN(t,e,n,r){return y(this,null,function*(){let i=yield gz(t.localStore,sr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n),a;return r&&(a=yield xz(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&bN(t.remoteStore,i),a})}function xz(t,e,n,r,i){return y(this,null,function*(){t.Ka=(p,g,_)=>function(R,A,x,L){return y(this,null,function*(){let $=A.view.ma(x);$.ns&&($=yield MR(R.localStore,A.query,!1).then(({documents:T})=>A.view.ma(T,$)));let G=L&&L.targetChanges.get(A.targetId),Ne=L&&L.targetMismatches.get(A.targetId)!=null,Y=A.view.applyChanges($,R.isPrimaryClient,G,Ne);return LR(R,A.targetId,Y.wa),Y.snapshot})}(t,p,g,_);let s=yield MR(t.localStore,e,!0),o=new oI(e,s.Ts),a=o.ma(s.documents),c=ou.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);LR(t,n,l.wa);let d=new aI(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),l.snapshot})}function kz(t,e,n){return y(this,null,function*(){let r=re(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Rf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Gv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&RI(r.remoteStore,i.targetId),lI(r,i.targetId)}).catch(mu))):(lI(r,i.targetId),yield Gv(r.localStore,i.targetId,!0))})}function Oz(t,e){return y(this,null,function*(){let n=re(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),RI(n.remoteStore,r.targetId))})}function Fz(t,e,n){return y(this,null,function*(){let r=Hz(t);try{let i=yield function(o,a){let c=re(o),l=gt.now(),d=a.reduce((_,E)=>_.add(E.key),he()),p,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=Mr(),R=he();return c.cs.getEntries(_,d).next(A=>{E=A,E.forEach((x,L)=>{L.isValidDocument()||(R=R.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(A=>{p=A;let x=[];for(let L of a){let $=Hq(L,p.get(L.key).overlayedDocument);$!=null&&x.push(new xr(L.key,$,YR($.value.mapValue),hi.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,x,a)}).next(A=>{g=A;let x=A.applyToLocalDocumentSet(p,R);return c.documentOverlayCache.saveOverlays(_,A.batchId,x)})}).then(()=>({batchId:g.batchId,changes:oN(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new Ze(Te)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,n),yield vu(r,i.changes),yield xf(r.remoteStore)}catch(i){let s=xI(i,"Failed to persist write");n.reject(s)}})}function kN(t,e){return y(this,null,function*(){let n=re(t);try{let r=yield hz(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Na.get(s);o&&(Se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Se(o.va):i.removedDocuments.size>0&&(Se(o.va),o.va=!1))}),yield vu(n,r,e)}catch(r){yield mu(r)}})}function FR(t,e,n){let r=re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=re(o);c.onlineState=a;let l=!1;c.queries.forEach((d,p)=>{for(let g of p.j_)g.Z_(a)&&(l=!0)}),l&&kI(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Lz(t,e,n){return y(this,null,function*(){let r=re(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ze(z.comparator);o=o.insert(s,On.newNoDocument(s,se.min()));let a=he().add(s),c=new nf(se.min(),new Map,new Ze(Te),o,a);yield kN(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),OI(r)}else yield Gv(r.localStore,e,!1).then(()=>lI(r,e,n)).catch(mu)})}function Vz(t,e){return y(this,null,function*(){let n=re(t),r=e.batch.batchId;try{let i=yield dz(n.localStore,e);FN(n,r,null),ON(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield vu(n,i)}catch(i){yield mu(i)}})}function Uz(t,e,n){return y(this,null,function*(){let r=re(t);try{let i=yield function(o,a){let c=re(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(Se(p!==null),d=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);FN(r,e,n),ON(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield vu(r,i)}catch(i){yield mu(i)}})}function ON(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function FN(t,e,n){let r=re(t),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function lI(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||LN(t,r)})}function LN(t,e){t.xa.delete(e.path.canonicalString());let n=t.Oa.get(e);n!==null&&(RI(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),OI(t))}function LR(t,e,n){for(let r of n)r instanceof _f?(t.La.addReference(r.key,e),jz(t,r)):r instanceof yf?(B("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||LN(t,r.key)):X()}function jz(t,e){let n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(B("SyncEngine","New document in limbo: "+n),t.xa.add(r),OI(t))}function OI(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){let e=t.xa.values().next().value;t.xa.delete(e);let n=new z(qe.fromString(e)),r=t.qa.next();t.Na.set(r,new cI(n)),t.Oa=t.Oa.insert(n,r),bN(t.remoteStore,new au(sr(DI(n.path)),r,"TargetPurposeLimboResolution",GR.oe))}}function vu(t,e,n){return y(this,null,function*(){let r=re(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,n).then(l=>{var d;if((l||n)&&r.isPrimaryClient){let p=l?!l.fromCache:(d=n?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=$v.Wi(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return y(this,null,function*(){let d=re(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>k.forEach(l,g=>k.forEach(g.$i,_=>d.persistence.referenceDelegate.addReference(p,g.targetId,_)).next(()=>k.forEach(g.Ui,_=>d.persistence.referenceDelegate.removeReference(p,g.targetId,_)))))}catch(p){if(!_u(p))throw p;B("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let g=p.targetId;if(!p.fromCache){let _=d.os.get(g),E=_.snapshotVersion,R=_.withLastLimboFreeSnapshotVersion(E);d.os=d.os.insert(g,R)}}})}(r.localStore,s))})}function Bz(t,e){return y(this,null,function*(){let n=re(t);if(!n.currentUser.isEqual(e)){B("SyncEngine","User change. New user:",e.toKey());let r=yield TN(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new j(P.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield vu(n,r.hs)}})}function $z(t,e){let n=re(t),r=n.Na.get(e);if(r&&r.va)return he().add(r.key);{let i=he(),s=n.Ma.get(e);if(!s)return i;for(let o of s){let a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function VN(t){let e=re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$z.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Lz.bind(null,e),e.Ca.d_=Rz.bind(null,e.eventManager),e.Ca.$a=Nz.bind(null,e.eventManager),e}function Hz(t){let e=re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Vz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Uz.bind(null,e),e}var VR=(()=>{class t{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(n){return y(this,null,function*(){this.serializer=Pf(n.databaseInfo.databaseId),this.sharedClientState=this.Wa(n),this.persistence=this.Ga(n),yield this.persistence.start(),this.localStore=this.za(n),this.gcScheduler=this.ja(n,this.localStore),this.indexBackfillerScheduler=this.Ha(n,this.localStore)})}ja(n,r){return null}Ha(n,r){return null}za(n){return lz(this.persistence,new qv,n.initialUser,this.serializer)}Ga(n){return new Uv(Bv.Zr,this.serializer)}Wa(n){return new Wv}terminate(){return y(this,null,function*(){var n,r;(n=this.gcScheduler)===null||n===void 0||n.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return t.provider={build:()=>new t},t})();var qz=(()=>{class t{initialize(n,r){return y(this,null,function*(){this.localStore||(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>FR(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Bz.bind(null,this.syncEngine),yield Az(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(n){return function(){return new iI}()}createDatastore(n){let r=Pf(n.databaseInfo.databaseId),i=function(o){return new Yv(o)}(n.databaseInfo);return function(o,a,c,l){return new Xv(o,a,c,l)}(n.authCredentials,n.appCheckCredentials,i,r)}createRemoteStore(n){return function(i,s,o,a,c){return new tI(i,s,o,a,c)}(this.localStore,this.datastore,n.asyncQueue,r=>FR(this.syncEngine,r,0),function(){return lf.D()?new lf:new Kv}())}createSyncEngine(n,r){return function(s,o,a,c,l,d,p){let g=new uI(s,o,a,c,l,d);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,n.initialUser,n.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var n,r;yield function(s){return y(this,null,function*(){let o=re(s);B("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield yu(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(n=this.datastore)===null||n===void 0||n.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return t.provider={build:()=>new t},t})();var vf=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Nr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}};var dI=class{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=_t.UNAUTHENTICATED,this.clientId=Yh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>y(this,null,function*(){B("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(B("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=xI(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function $y(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield TN(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function UR(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield zz(t);B("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>xR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>xR(e.remoteStore,i)),t._onlineComponents=e})}function zz(t){return y(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){B("FirestoreClient","Using user provided OfflineComponentProvider");try{yield $y(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ho("Error using user provided cache. Falling back to memory cache: "+n),yield $y(t,new VR)}}else B("FirestoreClient","Using default OfflineComponentProvider"),yield $y(t,new VR);return t._offlineComponents})}function UN(t){return y(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(B("FirestoreClient","Using user provided OnlineComponentProvider"),yield UR(t,t._uninitializedComponentsProvider._online)):(B("FirestoreClient","Using default OnlineComponentProvider"),yield UR(t,new qz))),t._onlineComponents})}function Gz(t){return UN(t).then(e=>e.syncEngine)}function hI(t){return y(this,null,function*(){let e=yield UN(t),n=e.eventManager;return n.onListen=Pz.bind(null,e.syncEngine),n.onUnlisten=kz.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Mz.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Oz.bind(null,e.syncEngine),n})}function Wz(t,e,n={}){let r=new rr;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,l){let d=new vf({next:g=>{d.Za(),o.enqueueAndForget(()=>MN(s,p)),g.fromCache&&c.source==="server"?l.reject(new j(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),p=new mf(a,d,{includeMetadataChanges:!0,_a:!0});return PN(s,p)}(yield hI(t),t.asyncQueue,e,n,r)})),r.promise}function jN(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var jR=new Map;function BN(t,e,n){if(!n)throw new j(P.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Kz(t,e,n,r){if(e===!0&&r===!0)throw new j(P.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function BR(t){if(!z.isDocumentKey(t))throw new j(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $R(t){if(z.isDocumentKey(t))throw new j(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X()}function Rr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new j(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=kf(t);throw new j(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var If=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new j(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new j(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jN((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ea=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new If({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new If(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Hy;switch(r.type){case"firstParty":return new Wy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=jR.get(n);r&&(B("ComponentProvider","Removing Datastore"),jR.delete(n),r.terminate())}(this),Promise.resolve()}};function $N(t,e,n,r={}){var i;let s=(t=Rr(t,ea))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ho("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=_t.MOCK_USER;else{a=Vs(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new j(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new _t(l)}t._authCredentials=new qy(new Qh(a,c))}}var Es=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Yt=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},fi=class t extends Es{constructor(e,n,r){super(e,n,DI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new z(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function HN(t,e,...n){if(t=fe(t),BN("collection","path",e),t instanceof ea){let r=qe.fromString(e,...n);return $R(r),new fi(t,null,r)}{if(!(t instanceof Yt||t instanceof fi))throw new j(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(qe.fromString(e,...n));return $R(r),new fi(t.firestore,null,r)}}function qN(t,e,...n){if(t=fe(t),arguments.length===1&&(e=Yh.newId()),BN("doc","path",e),t instanceof ea){let r=qe.fromString(e,...n);return BR(r),new Yt(t,null,new z(r))}{if(!(t instanceof Yt||t instanceof fi))throw new j(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(qe.fromString(e,...n));return BR(r),new Yt(t.firestore,t instanceof fi?t.converter:null,new z(r))}}var wf=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new df(this,"async_queue_retry"),this.Vu=()=>{let r=By();r&&B("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let n=By();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let n=By();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let n=new rr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return y(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!_u(e))throw e;B("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Nr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);let i=nI.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&X()}verifyOperationInProgress(){}wu(){return y(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let n=this.Tu.indexOf(e);this.Tu.splice(n,1)}};function HR(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var _i=class extends ea{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new wf,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new wf(e),this._firestoreClient=void 0,yield e}})}};function zN(t,e){let n=typeof t=="object"?t:it(),r=typeof t=="string"?t:e||"(default)",i=rt(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=qr("firestore");s&&$N(i,...s)}return i}function FI(t){if(t._terminated)throw new j(P.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Qz(t),t._firestoreClient}function Qz(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,l,d){return new Jy(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,jN(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new dI(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(t._componentsProvider))}var lu=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Pt.fromBase64String(e))}catch(n){throw new j(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var du=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new j(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ef=class{constructor(e){this._methodName=e}};var hu=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new j(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new j(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}};var fu=class{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var Yz=/^__.*__$/,fI=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new xr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ws(e,this.data,n,this.fieldTransforms)}};function GN(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}var pI=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Tf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(GN(this.Cu)&&Yz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},gI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pf(e)}Qu(e,n,r,i=!1){return new pI({Cu:e,methodName:n,qu:r,path:dn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function WN(t){let e=t._freezeSettings(),n=Pf(t._databaseId);return new gI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Zz(t,e,n,r,i,s={}){let o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);YN("Data must be an object, but it was:",o,r);let a=KN(r,o),c,l;if(s.merge)c=new nr(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let p of s.mergeFields){let g=Xz(e,p,n);if(!o.contains(g))throw new j(P.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);tG(d,g)||d.push(g)}c=new nr(d),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new fI(new kn(a),c,l)}function Jz(t,e,n,r=!1){return LI(n,t.Qu(r?4:3,e))}function LI(t,e){if(QN(t=fe(t)))return YN("Unsupported field value:",e,t),KN(t,e);if(t instanceof Ef)return function(r,i){if(!GN(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=LI(a,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Vq(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=gt.fromDate(r);return{timestampValue:af(i.serializer,s)}}if(r instanceof gt){let s=new gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:af(i.serializer,s)}}if(r instanceof hu)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof lu)return{bytesValue:mN(i.serializer,r._byteString)};if(r instanceof Yt){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:AI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fu)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return SI(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${kf(r)}`)}(t,e)}function KN(t,e){let n={};return WR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):na(t,(r,i)=>{let s=LI(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function QN(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gt||t instanceof hu||t instanceof lu||t instanceof Yt||t instanceof Ef||t instanceof fu)}function YN(t,e,n){if(!QN(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=kf(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Xz(t,e,n){if((e=fe(e))instanceof du)return e._internalPath;if(typeof e=="string")return ZN(t,e);throw Tf("Field path arguments must be of type string or ",t,!1,void 0,n)}var eG=new RegExp("[~\\*/\\[\\]]");function ZN(t,e,n){if(e.search(eG)>=0)throw Tf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new du(...e.split("."))._internalPath}catch{throw Tf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tf(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new j(P.INVALID_ARGUMENT,a+t+c)}function tG(t,e){return t.some(n=>n.isEqual(e))}var Cf=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new mI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(VI("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},mI=class extends Cf{data(){return super.data()}};function VI(t,e){return typeof e=="string"?ZN(t,e):e instanceof du?e._internalPath:e._delegate._internalPath}function JN(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new j(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pu=class{},_I=class extends pu{};function XN(t,e,...n){let r=[];e instanceof pu&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof yI).length,a=s.filter(c=>c instanceof bf).length;if(o>1||o>0&&a>0)throw new j(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var bf=class t extends _I{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return tP(e._query,n),new Es(e.firestore,e.converter,dv(e._query,n))}_parse(e){let n=WN(e.firestore);return function(s,o,a,c,l,d,p){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new j(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){zR(p,d);let _=[];for(let E of p)_.push(qR(c,s,E));g={arrayValue:{values:_}}}else g=qR(c,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||zR(p,d),g=Jz(a,o,p,d==="in"||d==="not-in");return dt.create(l,d,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function eP(t,e,n){let r=e,i=VI("where",t);return bf._create(i,r,n)}var yI=class t extends pu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fn.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)tP(o,c),o=dv(o,c)}(e._query,n),new Es(e.firestore,e.converter,dv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function qR(t,e,n){if(typeof(n=fe(n))=="string"){if(n==="")throw new j(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nN(e)&&n.indexOf("/")!==-1)throw new j(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(qe.fromString(n));if(!z.isDocumentKey(r))throw new j(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return gR(t,new z(r))}if(n instanceof Yt)return gR(t,n._key);throw new j(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kf(n)}.`)}function zR(t,e){if(!Array.isArray(t)||t.length===0)throw new j(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tP(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new j(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var vI=class{convertValue(e,n="none"){switch(_s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(pi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw X()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return na(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;let s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Be(o.doubleValue));return new fu(s)}convertGeoPoint(e){return new hu(Be(e.latitude),Be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=EI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ru(e));default:return null}}convertTimestamp(e){let n=Pr(e);return new gt(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=qe.fromString(e);Se(EN(r));let i=new ef(r.get(1),r.get(3)),s=new z(r.popFirst(5));return i.isEqual(n)||Nr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function nG(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var ps=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Df=class extends Cf{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new $o(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(VI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},$o=class extends Df{data(e={}){return super.data(e)}},Sf=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ps(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new $o(this._firestore,this._userDataWriter,r.key,r,new ps(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new j(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new $o(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ps(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new $o(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ps(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:rG(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function rG(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}var gu=class extends vI{constructor(e){super(),this.firestore=e}convertBytes(e){return new lu(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,n)}};function nP(t){t=Rr(t,Es);let e=Rr(t.firestore,_i),n=FI(e),r=new gu(e);return JN(t._query),Wz(n,t._query).then(i=>new Sf(e,r,t,i))}function rP(t,e,n){t=Rr(t,Yt);let r=Rr(t.firestore,_i),i=nG(t.converter,e,n);return sP(r,[Zz(WN(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,hi.none())])}function iP(t){return sP(Rr(t.firestore,_i),[new su(t._key,hi.none())])}function UI(t,...e){var n,r,i;t=fe(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||HR(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(HR(e[o])){let p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,d;if(t instanceof Yt)l=Rr(t.firestore,_i),d=DI(t._key.path),c={next:p=>{e[o]&&e[o](iG(l,t,p))},error:e[o+1],complete:e[o+2]};else{let p=Rr(t,Es);l=Rr(p.firestore,_i),d=p._query;let g=new gu(l);c={next:_=>{e[o]&&e[o](new Sf(l,g,p,_))},error:e[o+1],complete:e[o+2]},JN(t._query)}return function(g,_,E,R){let A=new vf(R),x=new mf(_,A,E);return g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return PN(yield hI(g),x)})),()=>{A.Za(),g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return MN(yield hI(g),x)}))}}(FI(l),d,a,c)}function sP(t,e){return function(r,i){let s=new rr;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Fz(yield Gz(r),i,s)})),s.promise}(FI(t),e)}function iG(t,e,n){let r=n.docs.get(e._key),i=new gu(t);return new Df(t,i,e._key,r,new ps(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){ta=i})(zt),Xe(new Je("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new _i(new zy(r.getProvider("auth-internal")),new Qy(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new j(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ef(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),q(dR,"4.7.3",e),q(dR,"4.7.3","esm2017")})();var Of=function(){return Of=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Of.apply(this,arguments)};var aG={includeMetadataChanges:!1};function oP(t,e){return e===void 0&&(e=aG),new ae(function(n){var r=UI(t,e,{next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)});return{unsubscribe:r}})}function aP(t,e){var n;e===void 0&&(e={});var r=t.data(e);return!t.exists()||typeof r!="object"||r===null||!e.idField?r:Of(Of({},r),(n={},n[e.idField]=t.id,n))}function cP(t){return oP(t,{includeMetadataChanges:!0}).pipe(Q(function(e){return e.docs}))}function uP(t,e){return e===void 0&&(e={}),cP(t).pipe(Q(function(n){return n.map(function(r){return aP(r,e)})}))}var Cs=class{constructor(e){return e}},lP="firestore",jI=class{constructor(){return nt(lP)}};var BI=new U("angularfire2.firestore-instances");function cG(t,e){let n=ct(lP,t,e);return n&&new Cs(n)}function uG(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Cs(r)}}var lG={provide:jI,deps:[[new ee,BI]]},dG={provide:Cs,useFactory:cG,deps:[[new ee,BI],Ue]};function dP(t,...e){return q("angularfire",Ve.full,"fst"),Oe([dG,lG,{provide:BI,useFactory:uG(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,xn],[new ee,Qt],...e]}])}var ia=we(uP,!0);var sa=we(HN,!0);var hP=we(iP,!0);var Ff=we(qN,!0);var $I=we(nP,!0);var fP=we(zN,!0);var pP=we(XN,!0);var HI=we(rP,!0);var gP=we(eP,!0);var mP="@firebase/database",_P="1.0.8";var Bw="";function hG(t){Bw=t}var ZI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mt(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:ul(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var JI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return $n(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var QP=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ZI(e)}}catch{}return new JI},Ds=QP("localStorage"),XI=QP("sessionStorage");var ua=new Hn("@firebase/database"),fG=function(){let t=1;return function(){return t++}}(),YP=function(t){let e=iC(t),n=new tC;n.update(e);let r=n.digest();return zT.encodeByteArray(r)},Mu=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Mu.apply(null,r):typeof r=="object"?e+=mt(r):e+=r,e+=" "}return e},Ss=null,yP=!0,pG=function(t,e){F(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(ua.logLevel=At.VERBOSE,Ss=ua.log.bind(ua),e&&XI.set("logging_enabled",!0)):typeof t=="function"?Ss=t:(Ss=null,XI.remove("logging_enabled"))},Mt=function(...t){if(yP===!0&&(yP=!1,Ss===null&&XI.get("logging_enabled")===!0&&pG(!0)),Ss){let e=Mu.apply(null,t);Ss(e)}},xu=function(t){return function(...e){Mt(t,...e)}},ew=function(...t){let e="FIREBASE INTERNAL ERROR: "+Mu(...t);ua.error(e)},Or=function(...t){let e=`FIREBASE FATAL ERROR: ${Mu(...t)}`;throw ua.error(e),new Error(e)},hn=function(...t){let e="FIREBASE WARNING: "+Mu(...t);ua.warn(e)},gG=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&hn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ZP=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},mG=function(t){if(jn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},da="[MIN_NAME]",As="[MAX_NAME]",ya=function(t,e){if(t===e)return 0;if(t===da||e===As)return-1;if(e===da||t===As)return 1;{let n=vP(t),r=vP(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},_G=function(t,e){return t===e?0:t<e?-1:1},Iu=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+mt(e))},$w=function(t){if(typeof t!="object"||t===null)return mt(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=mt(e[r]),n+=":",n+=$w(t[e[r]]);return n+="}",n},JP=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Cn(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var XP=function(t){F(!ZP(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),p="";for(c=0;c<64;c+=8){let g=parseInt(d.substr(c,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},yG=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},vG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var IG=new RegExp("^-?(0*)\\d{1,10}$"),wG=-2147483648,EG=2147483647,vP=function(t){if(IG.test(t)){let e=Number(t);if(e>=wG&&e<=EG)return e}return null},ku=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw hn("Exception was thrown by user callback.",n),e},Math.floor(0))}},TG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},bu=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var tw=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){hn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var nw=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Mt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',hn(e)}},Du=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Vf="5",eM="v",tM="s",nM="r",rM="f",iM=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,sM="ls",oM="p",rw="ac",aM="websocket",cM="long_polling";var Uf=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ds.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ds.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function CG(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function uM(t,e,n){F(typeof e=="string","typeof type must == string"),F(typeof n=="object","typeof params must == object");let r;if(e===aM)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===cM)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);CG(t)&&(n.ns=t.namespace);let i=[];return Cn(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var iw=class{constructor(){this.counters_={}}incrementCounter(e,n=1){$n(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return KT(this.counters_)}};var qI={},zI={};function Hw(t){let e=t.toString();return qI[e]||(qI[e]=new iw),qI[e]}function bG(t,e){let n=t.toString();return zI[n]||(zI[n]=e()),zI[n]}var sw=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ku(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var IP="start",DG="close",SG="pLPCommand",AG="pRTLPCB",lM="id",dM="pw",hM="ser",RG="cb",NG="seg",PG="ts",MG="d",xG="dframe",fM=1870,pM=30,kG=fM-pM,OG=25e3,FG=3e4,ow=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=xu(e),this.stats_=Hw(n),this.urlFn=c=>(this.appCheckToken&&(c[rw]=this.appCheckToken),uM(n,cM,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new sw(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(FG)),mG(()=>{if(this.isClosed_)return;this.scriptTagHolder=new aw((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===IP)this.id=a,this.password=c;else if(o===DG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[IP]="t",r[hM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[RG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[eM]=Vf,this.transportSessionId&&(r[tM]=this.transportSessionId),this.lastSessionId&&(r[sM]=this.lastSessionId),this.applicationId&&(r[oM]=this.applicationId),this.appCheckToken&&(r[rw]=this.appCheckToken),typeof location<"u"&&location.hostname&&iM.test(location.hostname)&&(r[nM]=rM);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return jn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!yG()&&!vG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=GT(n),i=JP(r,kG);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(jn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[xG]="t",r[lM]=e,r[dM]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=mt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},aw=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,jn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=fG(),window[SG+this.uniqueCallbackIdentifier]=e,window[AG+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Mt("frame writing exception"),a.stack&&Mt(a.stack),Mt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Mt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[lM]=this.myID,e[dM]=this.myPW,e[hM]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+pM+r.length<=fM;){let o=this.pendingSegs.shift();r=r+"&"+NG+i+"="+o.seg+"&"+PG+i+"="+o.ts+"&"+MG+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(OG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){jn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Mt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var LG=16384,VG=45e3,jf=null;typeof MozWebSocket<"u"?jf=MozWebSocket:typeof WebSocket<"u"&&(jf=WebSocket);var wu=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=xu(this.connId),this.stats_=Hw(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[eM]=Vf,!jn()&&typeof location<"u"&&location.hostname&&iM.test(location.hostname)&&(a[nM]=rM),r&&(a[tM]=r),i&&(a[sM]=i),s&&(a[rw]=s),o&&(a[oM]=o),uM(n,aM,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ds.set("previous_websocket_failure",!0);try{let i;if(jn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Vf}/${Bw}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new jf(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&jf!==null&&!t.forceDisallow_}static previouslyFailed(){return Ds.isInMemoryStorage||Ds.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ds.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=ul(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(F(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=mt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=JP(r,LG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(VG))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),UG=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[ow,wu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=wu&&wu.isAvailable(),i=r&&!wu.previouslyFailed();if(n.webSocketOnly&&(r||hn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[wu];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),jG=6e4,BG=5e3,$G=10*1024,HG=100*1024,GI="t",wP="d",qG="s",EP="r",zG="e",TP="o",CP="a",bP="n",DP="p",GG="h",cw=class{constructor(e,n,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=xu("c:"+this.id+":"),this.transportManager_=new UG(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=bu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>HG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>$G?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(GI in e){let n=e[GI];n===CP?this.upgradeIfSecondaryHealthy_():n===EP?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===TP&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Iu("t",e),r=Iu("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:DP,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:CP,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:bP,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Iu("t",e),r=Iu("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Iu(GI,e);if(wP in e){let r=e[wP];if(n===GG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===bP){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===qG?this.onConnectionShutdown_(r):n===EP?this.onReset_(r):n===zG?ew("Server Error: "+r):n===TP?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ew("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Vf!==r&&hn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),bu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(jG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):bu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(BG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:DP,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ds.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Bf=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var $f=class{constructor(e){this.allowedEvents_=e,this.listeners_={},F(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){F(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Hf=class t extends $f{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ja()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return F(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var SP=32,AP=768,ke=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Re(){return new ke("")}function ve(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function vi(t){return t.pieces_.length-t.pieceNum_}function je(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ke(t.pieces_,e)}function gM(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function WG(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function mM(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function _M(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ke(e,0)}function yt(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ke)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new ke(n,0)}function me(t){return t.pieceNum_>=t.pieces_.length}function En(t,e){let n=ve(t),r=ve(e);if(n===null)return e;if(n===r)return En(je(t),je(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function yM(t,e){if(vi(t)!==vi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Vn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(vi(t)>vi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var uw=class{constructor(e,n){this.errorPrefix_=n,this.parts_=mM(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ga(this.parts_[r]);vM(this)}};function KG(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ga(e),vM(t)}function QG(t){let e=t.parts_.pop();t.byteLength_-=Ga(e),t.parts_.length>0&&(t.byteLength_-=1)}function vM(t){if(t.byteLength_>AP)throw new Error(t.errorPrefix_+"has a key path longer than "+AP+" bytes ("+t.byteLength_+").");if(t.parts_.length>SP)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+SP+") or object contains a cycle "+bs(t))}function bs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var lw=class t extends $f{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return F(e==="visible","Unknown event type: "+e),[this.visible_]}};var Eu=1e3,YG=60*5*1e3,RP=30*1e3,ZG=1.3,JG=3e4,XG="server_kill",NP=3,qw=(()=>{class t extends Bf{constructor(n,r,i,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=xu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Eu,this.maxReconnectDelay_=YG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!jn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lw.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Hf.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(mt(o)),F(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Fp,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),F(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),F(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(d,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&$n(n,"w")){let i=Ai(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();hn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||eC(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RP)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=XT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),F(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+mt(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):ew("Unrecognized action received from server: "+mt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){F(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Eu,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Eu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>JG&&(this.reconnectDelay_=Eu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ZG)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(g){F(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,_]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);a?Mt("getToken() completed but was canceled"):(Mt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=_&&_.token,c=new cw(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,E=>{hn(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(XG)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&hn(g),l())}}})}interrupt(n){Mt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Mt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Ha(this.interruptReasons_)&&(this.reconnectDelay_=Eu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>$w(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new ke(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Mt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=NP&&(this.reconnectDelay_=RP,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Mt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=NP&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";jn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+Bw.replace(/\./g,"-")]=1,ja()?n["framework.cordova"]=1:cl()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Hf.getInstance().currentlyOnline();return Ha(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),Ie=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var ha=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new Ie(da,e),i=new Ie(da,n);return this.compare(r,i)!==0}minPost(){return Ie.MIN}};var Lf,qf=class extends ha{static get __EMPTY_NODE(){return Lf}static set __EMPTY_NODE(e){Lf=e}compare(e,n){return ya(e.name,n.name)}isDefinedOn(e){throw Ls("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ie.MIN}maxPost(){return new Ie(As,Lf)}makePost(e,n){return F(typeof e=="string","KeyIndex indexValue must always be a string."),new Ie(e,Lf)}toString(){return".key"}},la=new qf;var aa=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ln=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Tn.EMPTY_NODE,this.right=o??Tn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Tn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Tn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),dw=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Ln(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Tn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ln.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ln.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new aa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new aa(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new aa(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new aa(this.root_,null,this.comparator_,!0,e)}};Tn.EMPTY_NODE=new dw;function eW(t,e){return ya(t.name,e.name)}function zw(t,e){return ya(t,e)}var hw;function tW(t){hw=t}var IM=function(t){return typeof t=="number"?"number:"+XP(t):"string:"+t},wM=function(t){if(t.isLeafNode()){let e=t.val();F(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$n(e,".sv"),"Priority must be a string or number.")}else F(t===hw||t.isEmpty(),"priority of unexpected type.");F(t===hw||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var PP,fa=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,F(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),wM(this.priorityNode_)}static set __childrenNodeConstructor(n){PP=n}static get __childrenNodeConstructor(){return PP}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return me(n)?this:ve(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ve(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(F(i!==".priority"||vi(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(je(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+IM(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=XP(this.value_):n+=this.value_,this.lazyHash_=YP(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(F(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return F(s>=0,"Unknown leaf type: "+r),F(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),EM,TM;function nW(t){EM=t}function rW(t){TM=t}var fw=class extends ha{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?ya(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ie.MIN}maxPost(){return new Ie(As,new fa("[PRIORITY-POST]",TM))}makePost(e,n){let r=EM(e);return new Ie(n,new fa("[PRIORITY-POST]",r))}toString(){return".priority"}},kt=new fw;var iW=Math.log(2),pw=class{constructor(e){let n=s=>parseInt(Math.log(s)/iW,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},zf=function(t,e,n,r){t.sort(e);let i=function(c,l){let d=l-c,p,g;if(d===0)return null;if(d===1)return p=t[c],g=n?n(p):p,new Ln(g,p.node,Ln.BLACK,null,null);{let _=parseInt(d/2,10)+c,E=i(c,_),R=i(_+1,l);return p=t[_],g=n?n(p):p,new Ln(g,p.node,Ln.BLACK,E,R)}},s=function(c){let l=null,d=null,p=t.length,g=function(E,R){let A=p-E,x=p;p-=E;let L=i(A+1,x),$=t[A],G=n?n($):$;_(new Ln(G,$.node,R,null,L))},_=function(E){l?(l.left=E,l=E):(d=E,l=E)};for(let E=0;E<c.count;++E){let R=c.nextBitIsOne(),A=Math.pow(2,c.count-(E+1));R?g(A,Ln.BLACK):(g(A,Ln.BLACK),g(A,Ln.RED))}return d},o=new pw(t.length),a=s(o);return new Tn(r||e,a)};var WI,oa={},pa=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return F(oa&&kt,"ChildrenNode.ts has not been loaded"),WI=WI||new t({".priority":oa},{".priority":kt}),WI}get(e){let n=Ai(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Tn?n:null}hasIndex(e){return $n(this.indexSet_,e.toString())}addIndex(e,n){F(e!==la,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(Ie.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=zf(r,e.getCompare()):a=oa;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new t(d,l)}addToIndexes(e,n){let r=qa(this.indexes_,(i,s)=>{let o=Ai(this.indexSet_,s);if(F(o,"Missing index implementation for "+s),i===oa)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(Ie.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),zf(a,o.getCompare())}else return oa;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new Ie(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=qa(this.indexes_,i=>{if(i===oa)return i;{let s=n.get(e.name);return s?i.remove(new Ie(e.name,s)):i}});return new t(r,this.indexSet_)}};var Tu,ze=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&wM(this.priorityNode_),this.children_.isEmpty()&&F(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Tu||(Tu=new t(new Tn(zw),null,pa.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Tu}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Tu:r}}getChild(n){let r=ve(n);return r===null?this:this.getImmediateChild(r).getChild(je(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(F(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new Ie(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Tu:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ve(n);if(i===null)return r;{F(ve(n)!==".priority"||vi(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(je(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(kt,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+IM(this.getPriority().val())+":"),this.forEachChild(kt,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":YP(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ie(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new Ie(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new Ie(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,Ie.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,Ie.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ou?-1:0}withIndex(n){if(n===la||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===la||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(kt),s=r.getIterator(kt),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===la?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),gw=class extends ze{constructor(){super(new Tn(zw),ze.EMPTY_NODE,pa.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ze.EMPTY_NODE}isEmpty(){return!1}},Ou=new gw;Object.defineProperties(Ie,{MIN:{value:new Ie(da,ze.EMPTY_NODE)},MAX:{value:new Ie(As,Ou)}});qf.__EMPTY_NODE=ze.EMPTY_NODE;fa.__childrenNodeConstructor=ze;tW(Ou);rW(Ou);var sW=!0;function xt(t,e=null){if(t===null)return ze.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),F(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new fa(n,xt(e))}if(!(t instanceof Array)&&sW){let n=[],r=!1;if(Cn(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=xt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new Ie(o,c)))}}),n.length===0)return ze.EMPTY_NODE;let s=zf(n,eW,o=>o.name,zw);if(r){let o=zf(n,kt.getCompare());return new ze(s,xt(e),new pa({".priority":o},{".priority":kt}))}else return new ze(s,xt(e),pa.Default)}else{let n=ze.EMPTY_NODE;return Cn(t,(r,i)=>{if($n(t,r)&&r.substring(0,1)!=="."){let s=xt(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(xt(e))}}nW(xt);var mw=class extends ha{constructor(e){super(),this.indexPath_=e,F(!me(e)&&ve(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?ya(e.name,n.name):s}makePost(e,n){let r=xt(e),i=ze.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ie(n,i)}maxPost(){let e=ze.EMPTY_NODE.updateChild(this.indexPath_,Ou);return new Ie(As,e)}toString(){return mM(this.indexPath_,0).join("/")}};var _w=class extends ha{compare(e,n){let r=e.node.compareTo(n.node);return r===0?ya(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ie.MIN}maxPost(){return Ie.MAX}makePost(e,n){let r=xt(e);return new Ie(n,r)}toString(){return".value"}},oW=new _w;function aW(t){return{type:"value",snapshotNode:t}}function cW(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function uW(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function MP(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function lW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var yw=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=kt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return F(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return F(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:da}hasEnd(){return this.endSet_}getIndexEndValue(){return F(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return F(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:As}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return F(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===kt}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function xP(t){let e={};if(t.isDefault())return e;let n;if(t.index_===kt?n="$priority":t.index_===oW?n="$value":t.index_===la?n="$key":(F(t.index_ instanceof mw,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=mt(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=mt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+mt(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=mt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+mt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function kP(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==kt&&(e.i=t.index_.toString()),e}var vw=class t extends Bf{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=xu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(F(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=xP(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let p=d;if(l===404&&(p=null,l=null),l===null&&this.onDataUpdate_(s,p,!1,r),Ai(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=xP(e._queryParams),r=e._path.toString(),i=new Fp;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ri(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=ul(a.responseText)}catch{hn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&hn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Iw=class{constructor(){this.rootNode_=ze.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Gf(){return{value:null,children:new Map}}function CM(t,e,n){if(me(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ve(e);t.children.has(r)||t.children.set(r,Gf());let i=t.children.get(r);e=je(e),CM(i,e,n)}}function ww(t,e,n){t.value!==null?n(e,t.value):dW(t,(r,i)=>{let s=new ke(e.toString()+"/"+r);ww(i,s,n)})}function dW(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Ew=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Cn(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var OP=10*1e3,hW=30*1e3,fW=5*60*1e3,Tw=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Ew(e);let r=OP+(hW-OP)*Math.random();bu(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Cn(e,(i,s)=>{s>0&&$n(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),bu(this.reportStats_.bind(this),Math.floor(Math.random()*2*fW))}};var kr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(kr||{});function bM(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function DM(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function SM(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Cw=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=kr.ACK_USER_WRITE,this.source=bM()}operationForChild(e){if(me(this.path)){if(this.affectedTree.value!=null)return F(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ke(e));return new t(Re(),n,this.revert)}}else return F(ve(this.path)===e,"operationForChild called for unrelated child."),new t(je(this.path),this.affectedTree,this.revert)}};var ga=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=kr.OVERWRITE}operationForChild(e){return me(this.path)?new t(this.source,Re(),this.snap.getImmediateChild(e)):new t(this.source,je(this.path),this.snap)}};var Wf=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=kr.MERGE}operationForChild(e){if(me(this.path)){let n=this.children.subtree(new ke(e));return n.isEmpty()?null:n.value?new ga(this.source,Re(),n.value):new t(this.source,Re(),n)}else return F(ve(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,je(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ru=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(me(e))return this.isFullyInitialized()&&!this.filtered_;let n=ve(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function pW(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(lW(o.childName,o.snapshotNode))}),Cu(t,i,"child_removed",e,r,n),Cu(t,i,"child_added",e,r,n),Cu(t,i,"child_moved",s,r,n),Cu(t,i,"child_changed",e,r,n),Cu(t,i,"value",e,r,n),i}function Cu(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>mW(t,a,c)),o.forEach(a=>{let c=gW(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function gW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function mW(t,e,n){if(e.childName==null||n.childName==null)throw Ls("Should only compare child_ events.");let r=new Ie(e.childName,e.snapshotNode),i=new Ie(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function AM(t,e){return{eventCache:t,serverCache:e}}function Su(t,e,n,r){return AM(new Ru(e,n,r),t.serverCache)}function RM(t,e,n,r){return AM(t.eventCache,new Ru(e,n,r))}function bw(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Rs(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var KI,_W=()=>(KI||(KI=new Tn(_G)),KI),Zt=class t{constructor(e,n=_W()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Cn(e,(r,i)=>{n=n.set(new ke(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Re(),value:this.value};if(me(e))return null;{let r=ve(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(je(e),n);return s!=null?{path:yt(new ke(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(me(e))return this;{let n=ve(e),r=this.children.get(n);return r!==null?r.subtree(je(e)):new t(null)}}set(e,n){if(me(e))return new t(n,this.children);{let r=ve(e),s=(this.children.get(r)||new t(null)).set(je(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(me(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ve(e),r=this.children.get(n);if(r){let i=r.remove(je(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(me(e))return this.value;{let n=ve(e),r=this.children.get(n);return r?r.get(je(e)):null}}setTree(e,n){if(me(e))return n;{let r=ve(e),s=(this.children.get(r)||new t(null)).setTree(je(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(Re(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(yt(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Re(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(me(e))return null;{let s=ve(e),o=this.children.get(s);return o?o.findOnPath_(je(e),yt(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Re(),n)}foreachOnPath_(e,n,r){if(me(e))return this;{this.value&&r(n,this.value);let i=ve(e),s=this.children.get(i);return s?s.foreachOnPath_(je(e),yt(n,i),r):new t(null)}}foreach(e){this.foreach_(Re(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(yt(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Un=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Zt(null))}};function Au(t,e,n){if(me(e))return new Un(new Zt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=En(i,e);return s=s.updateChild(o,n),new Un(t.writeTree_.set(i,s))}else{let i=new Zt(n),s=t.writeTree_.setTree(e,i);return new Un(s)}}}function FP(t,e,n){let r=t;return Cn(n,(i,s)=>{r=Au(r,yt(e,i),s)}),r}function LP(t,e){if(me(e))return Un.empty();{let n=t.writeTree_.setTree(e,new Zt(null));return new Un(n)}}function Dw(t,e){return Ns(t,e)!=null}function Ns(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(En(n.path,e)):null}function VP(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(kt,(r,i)=>{e.push(new Ie(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ie(r,i.value))}),e}function yi(t,e){if(me(e))return t;{let n=Ns(t,e);return n!=null?new Un(new Zt(n)):new Un(t.writeTree_.subtree(e))}}function Sw(t){return t.writeTree_.isEmpty()}function ma(t,e){return NM(Re(),t.writeTree_,e)}function NM(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(F(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=NM(yt(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(yt(t,".priority"),r)),n}}function PM(t,e){return FM(e,t)}function yW(t,e,n,r,i){F(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Au(t.visibleWrites,e,n)),t.lastWriteId=r}function vW(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function IW(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);F(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&wW(a,r.path)?i=!1:Vn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return EW(t),!0;if(r.snap)t.visibleWrites=LP(t.visibleWrites,r.path);else{let a=r.children;Cn(a,c=>{t.visibleWrites=LP(t.visibleWrites,yt(r.path,c))})}return!0}else return!1}function wW(t,e){if(t.snap)return Vn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Vn(yt(t.path,n),e))return!0;return!1}function EW(t){t.visibleWrites=MM(t.allWrites,TW,Re()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function TW(t){return t.visible}function MM(t,e,n){let r=Un.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Vn(n,o)?(a=En(n,o),r=Au(r,a,s.snap)):Vn(o,n)&&(a=En(o,n),r=Au(r,Re(),s.snap.getChild(a)));else if(s.children){if(Vn(n,o))a=En(n,o),r=FP(r,a,s.children);else if(Vn(o,n))if(a=En(o,n),me(a))r=FP(r,Re(),s.children);else{let c=Ai(s.children,ve(a));if(c){let l=c.getChild(je(a));r=Au(r,Re(),l)}}}else throw Ls("WriteRecord should have .snap or .children")}}return r}function xM(t,e,n,r,i){if(!r&&!i){let s=Ns(t.visibleWrites,e);if(s!=null)return s;{let o=yi(t.visibleWrites,e);if(Sw(o))return n;if(n==null&&!Dw(o,Re()))return null;{let a=n||ze.EMPTY_NODE;return ma(o,a)}}}else{let s=yi(t.visibleWrites,e);if(!i&&Sw(s))return n;if(!i&&n==null&&!Dw(s,Re()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Vn(l.path,e)||Vn(e,l.path))},a=MM(t.allWrites,o,e),c=n||ze.EMPTY_NODE;return ma(a,c)}}}function CW(t,e,n){let r=ze.EMPTY_NODE,i=Ns(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(kt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=yi(t.visibleWrites,e);return n.forEachChild(kt,(o,a)=>{let c=ma(yi(s,new ke(o)),a);r=r.updateImmediateChild(o,c)}),VP(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=yi(t.visibleWrites,e);return VP(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function bW(t,e,n,r,i){F(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=yt(e,n);if(Dw(t.visibleWrites,s))return null;{let o=yi(t.visibleWrites,s);return Sw(o)?i.getChild(n):ma(o,i.getChild(n))}}function DW(t,e,n,r){let i=yt(e,n),s=Ns(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=yi(t.visibleWrites,i);return ma(o,r.getNode().getImmediateChild(n))}else return null}function SW(t,e){return Ns(t.visibleWrites,e)}function AW(t,e,n,r,i,s,o){let a,c=yi(t.visibleWrites,e),l=Ns(c,Re());if(l!=null)a=l;else if(n!=null)a=ma(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],p=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=g.getNext();for(;_&&d.length<i;)p(_,r)!==0&&d.push(_),_=g.getNext();return d}else return[]}function RW(){return{visibleWrites:Un.empty(),allWrites:[],lastWriteId:-1}}function Aw(t,e,n,r){return xM(t.writeTree,t.treePath,e,n,r)}function kM(t,e){return CW(t.writeTree,t.treePath,e)}function UP(t,e,n,r){return bW(t.writeTree,t.treePath,e,n,r)}function Kf(t,e){return SW(t.writeTree,yt(t.treePath,e))}function NW(t,e,n,r,i,s){return AW(t.writeTree,t.treePath,e,n,r,i,s)}function Gw(t,e,n){return DW(t.writeTree,t.treePath,e,n)}function OM(t,e){return FM(yt(t.treePath,e),t.writeTree)}function FM(t,e){return{treePath:t,writeTree:e}}var Rw=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;F(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),F(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,MP(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,uW(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,cW(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,MP(r,e.snapshotNode,i.oldSnap));else throw Ls("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var Nw=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},LM=new Nw,Nu=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Ru(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Gw(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Rs(this.viewCache_),s=NW(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function PW(t,e){F(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),F(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function MW(t,e,n,r,i){let s=new Rw,o,a;if(n.type===kr.OVERWRITE){let l=n;l.source.fromUser?o=Pw(t,e,l.path,l.snap,r,i,s):(F(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!me(l.path),o=Qf(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===kr.MERGE){let l=n;l.source.fromUser?o=kW(t,e,l.path,l.children,r,i,s):(F(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Mw(t,e,l.path,l.children,r,i,a,s))}else if(n.type===kr.ACK_USER_WRITE){let l=n;l.revert?o=LW(t,e,l.path,r,i,s):o=OW(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===kr.LISTEN_COMPLETE)o=FW(t,e,n.path,r,s);else throw Ls("Unknown operation type: "+n.type);let c=s.getChanges();return xW(e,o,c),{viewCache:o,changes:c}}function xW(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=bw(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(aW(bw(e)))}}function VM(t,e,n,r,i,s){let o=e.eventCache;if(Kf(r,n)!=null)return e;{let a,c;if(me(n))if(F(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Rs(e),d=l instanceof ze?l:ze.EMPTY_NODE,p=kM(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let l=Aw(r,Rs(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ve(n);if(l===".priority"){F(vi(n)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let p=UP(r,n,d,c);p!=null?a=t.filter.updatePriority(d,p):a=o.getNode()}else{let d=je(n),p;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let g=UP(r,n,o.getNode(),c);g!=null?p=o.getNode().getImmediateChild(l).updateChild(d,g):p=o.getNode().getImmediateChild(l)}else p=Gw(r,l,e.serverCache);p!=null?a=t.filter.updateChild(o.getNode(),l,p,d,i,s):a=o.getNode()}}return Su(e,a,o.isFullyInitialized()||me(n),t.filter.filtersNodes())}}function Qf(t,e,n,r,i,s,o,a){let c=e.serverCache,l,d=o?t.filter:t.filter.getIndexedFilter();if(me(n))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(n,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=ve(n);if(!c.isCompleteForPath(n)&&vi(n)>1)return e;let E=je(n),A=c.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?l=d.updatePriority(c.getNode(),A):l=d.updateChild(c.getNode(),_,A,E,LM,null)}let p=RM(e,l,c.isFullyInitialized()||me(n),d.filtersNodes()),g=new Nu(i,p,s);return VM(t,p,n,i,g,a)}function Pw(t,e,n,r,i,s,o){let a=e.eventCache,c,l,d=new Nu(i,e,s);if(me(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Su(e,l,!0,t.filter.filtersNodes());else{let p=ve(n);if(p===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Su(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=je(n),_=a.getNode().getImmediateChild(p),E;if(me(g))E=r;else{let R=d.getCompleteChild(p);R!=null?gM(g)===".priority"&&R.getChild(_M(g)).isEmpty()?E=R:E=R.updateChild(g,r):E=ze.EMPTY_NODE}if(_.equals(E))c=e;else{let R=t.filter.updateChild(a.getNode(),p,E,g,d,o);c=Su(e,R,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function jP(t,e){return t.eventCache.isCompleteForChild(e)}function kW(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=yt(n,c);jP(e,ve(d))&&(a=Pw(t,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=yt(n,c);jP(e,ve(d))||(a=Pw(t,a,d,l,i,s,o))}),a}function BP(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Mw(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;me(n)?l=r:l=new Zt(null).setTree(n,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((p,g)=>{if(d.hasChild(p)){let _=e.serverCache.getNode().getImmediateChild(p),E=BP(t,_,g);c=Qf(t,c,new ke(p),E,i,s,o,a)}}),l.children.inorderTraversal((p,g)=>{let _=!e.serverCache.isCompleteForChild(p)&&g.value===null;if(!d.hasChild(p)&&!_){let E=e.serverCache.getNode().getImmediateChild(p),R=BP(t,E,g);c=Qf(t,c,new ke(p),R,i,s,o,a)}}),c}function OW(t,e,n,r,i,s,o){if(Kf(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(me(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Qf(t,e,n,c.getNode().getChild(n),i,s,a,o);if(me(n)){let l=new Zt(null);return c.getNode().forEachChild(la,(d,p)=>{l=l.set(new ke(d),p)}),Mw(t,e,n,l,i,s,a,o)}else return e}else{let l=new Zt(null);return r.foreach((d,p)=>{let g=yt(n,d);c.isCompleteForPath(g)&&(l=l.set(d,c.getNode().getChild(g)))}),Mw(t,e,n,l,i,s,a,o)}}function FW(t,e,n,r,i){let s=e.serverCache,o=RM(e,s.getNode(),s.isFullyInitialized()||me(n),s.isFiltered());return VM(t,o,n,r,LM,i)}function LW(t,e,n,r,i,s){let o;if(Kf(r,n)!=null)return e;{let a=new Nu(r,e,i),c=e.eventCache.getNode(),l;if(me(n)||ve(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Aw(r,Rs(e));else{let p=e.serverCache.getNode();F(p instanceof ze,"serverChildren would be complete if leaf node"),d=kM(r,p)}d=d,l=t.filter.updateFullNode(c,d,s)}else{let d=ve(n),p=Gw(r,d,e.serverCache);p==null&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),p!=null?l=t.filter.updateChild(c,d,p,je(n),a,s):e.eventCache.getNode().hasChild(d)?l=t.filter.updateChild(c,d,ze.EMPTY_NODE,je(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Aw(r,Rs(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Kf(r,Re())!=null,Su(e,l,o,t.filter.filtersNodes())}}function VW(t,e){let n=Rs(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!me(e)&&!n.getImmediateChild(ve(e)).isEmpty())?n.getChild(e):null}function $P(t,e,n,r){e.type===kr.MERGE&&e.source.queryId!==null&&(F(Rs(t.viewCache_),"We should always have a full cache before handling merges"),F(bw(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=MW(t.processor_,i,e,n,r);return PW(t.processor_,s.viewCache),F(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,UW(t,s.changes,s.viewCache.eventCache.getNode(),null)}function UW(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return pW(t.eventGenerator_,e,n,i)}var HP;function jW(t){F(!HP,"__referenceConstructor has already been defined"),HP=t}function Ww(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return F(s!=null,"SyncTree gave us an op for an invalid query."),$P(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat($P(o,e,n,r));return s}}function Kw(t,e){let n=null;for(let r of t.views.values())n=n||VW(r,e);return n}var qP;function BW(t){F(!qP,"__referenceConstructor has already been defined"),qP=t}var Yf=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Zt(null),this.pendingWriteTree_=RW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function $W(t,e,n,r,i){return yW(t.pendingWriteTree_,e,n,r,i),i?Jf(t,new ga(bM(),e,n)):[]}function ca(t,e,n=!1){let r=vW(t.pendingWriteTree_,e);if(IW(t.pendingWriteTree_,e)){let s=new Zt(null);return r.snap!=null?s=s.set(Re(),!0):Cn(r.children,o=>{s=s.set(new ke(o),!0)}),Jf(t,new Cw(r.path,s,n))}else return[]}function Zf(t,e,n){return Jf(t,new ga(DM(),e,n))}function HW(t,e,n){let r=Zt.fromObject(n);return Jf(t,new Wf(DM(),e,r))}function qW(t,e,n,r){let i=$M(t,r);if(i!=null){let s=HM(i),o=s.path,a=s.queryId,c=En(o,e),l=new ga(SM(a),c,n);return qM(t,o,l)}else return[]}function zW(t,e,n,r){let i=$M(t,r);if(i){let s=HM(i),o=s.path,a=s.queryId,c=En(o,e),l=Zt.fromObject(n),d=new Wf(SM(a),c,l);return qM(t,o,d)}else return[]}function UM(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=En(o,e),l=Kw(a,c);if(l)return l});return xM(i,e,s,n,!0)}function Jf(t,e){return jM(e,t.syncPointTree_,null,PM(t.pendingWriteTree_,Re()))}function jM(t,e,n,r){if(me(t.path))return BM(t,e,n,r);{let i=e.get(Re());n==null&&i!=null&&(n=Kw(i,Re()));let s=[],o=ve(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,d=OM(r,o);s=s.concat(jM(a,c,l,d))}return i&&(s=s.concat(Ww(i,t,r,n))),s}}function BM(t,e,n,r){let i=e.get(Re());n==null&&i!=null&&(n=Kw(i,Re()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=OM(r,o),d=t.operationForChild(o);d&&(s=s.concat(BM(d,a,c,l)))}),i&&(s=s.concat(Ww(i,t,r,n))),s}function $M(t,e){return t.tagToQueryMap.get(e)}function HM(t){let e=t.indexOf("$");return F(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ke(t.substr(0,e))}}function qM(t,e,n){let r=t.syncPointTree_.get(e);F(r,"Missing sync point for query tag that we're tracking");let i=PM(t.pendingWriteTree_,e);return Ww(r,n,i,null)}var xw=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},kw=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=yt(this.path_,e);return new t(this.syncTree_,n)}node(){return UM(this.syncTree_,this.path_)}},GW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},zP=function(t,e,n){if(!t||typeof t!="object")return t;if(F(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return WW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return KW(t[".sv"],e);F(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},WW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:F(!1,"Unexpected server value: "+t)}},KW=function(t,e,n){t.hasOwnProperty("increment")||F(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&F(!1,"Unexpected increment value: "+r);let i=e.node();if(F(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},QW=function(t,e,n,r){return Qw(e,new kw(n,t),r)},YW=function(t,e,n){return Qw(t,new xw(e),n)};function Qw(t,e,n){let r=t.getPriority().val(),i=zP(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=zP(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new fa(a,xt(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new fa(i))),o.forEachChild(kt,(a,c)=>{let l=Qw(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Pu=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Yw(t,e){let n=e instanceof ke?e:new ke(e),r=t,i=ve(n);for(;i!==null;){let s=Ai(r.node.children,i)||{children:{},childCount:0};r=new Pu(i,r,s),n=je(n),i=ve(n)}return r}function va(t){return t.node.value}function zM(t,e){t.node.value=e,Ow(t)}function GM(t){return t.node.childCount>0}function ZW(t){return va(t)===void 0&&!GM(t)}function Xf(t,e){Cn(t.node.children,(n,r)=>{e(new Pu(n,t,r))})}function WM(t,e,n,r){n&&!r&&e(t),Xf(t,i=>{WM(i,e,!0,r)}),n&&r&&e(t)}function JW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Fu(t){return new ke(t.parent===null?t.name:Fu(t.parent)+"/"+t.name)}function Ow(t){t.parent!==null&&XW(t.parent,t.name,t)}function XW(t,e,n){let r=ZW(n),i=$n(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ow(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Ow(t))}var e4=/[\[\].#$\/\u0000-\u001F\u007F]/,t4=/[\[\].#$\u0000-\u001F\u007F]/,QI=10*1024*1024,KM=function(t){return typeof t=="string"&&t.length!==0&&!e4.test(t)},n4=function(t){return typeof t=="string"&&t.length!==0&&!t4.test(t)},r4=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),n4(t)};var QM=function(t,e,n){let r=n instanceof ke?new uw(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+bs(r));if(typeof e=="function")throw new Error(t+"contains a function "+bs(r)+" with contents = "+e.toString());if(ZP(e))throw new Error(t+"contains "+e.toString()+" "+bs(r));if(typeof e=="string"&&e.length>QI/3&&Ga(e)>QI)throw new Error(t+"contains a string greater than "+QI+" utf8 bytes "+bs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Cn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!KM(o)))throw new Error(t+" contains an invalid key ("+o+") "+bs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);KG(r,o),QM(t,a,r),QG(r)}),i&&s)throw new Error(t+' contains ".value" child '+bs(r)+" in addition to actual children.")}};var i4=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!KM(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!r4(n))throw new Error(rC(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Fw=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function s4(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!yM(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function Ps(t,e,n){s4(t,n),o4(t,r=>Vn(r,e)||Vn(e,r))}function o4(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(a4(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function a4(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Ss&&Mt("event: "+n.toString()),ku(r)}}}var c4="repo_interrupt",u4=25,Lw=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fw,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Gf(),this.transactionQueueTree_=new Pu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function l4(t,e,n){if(t.stats_=Hw(t.repoInfo_),t.forceRestClient_||TG())t.server_=new vw(t.repoInfo_,(r,i,s,o)=>{GP(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>WP(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new qw(t.repoInfo_,e,(r,i,s,o)=>{GP(t,r,i,s,o)},r=>{WP(t,r)},r=>{h4(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=bG(t.repoInfo_,()=>new Tw(t.stats_,t.server_)),t.infoData_=new Iw,t.infoSyncTree_=new Yf({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Zf(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Zw(t,"connected",!1),t.serverSyncTree_=new Yf({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Ps(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function d4(t){let n=t.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function YM(t){return GW({timestamp:d4(t)})}function GP(t,e,n,r,i){t.dataUpdateCount++;let s=new ke(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=qa(n,l=>xt(l));o=zW(t.serverSyncTree_,s,c,i)}else{let c=xt(n);o=qW(t.serverSyncTree_,s,c,i)}else if(r){let c=qa(n,l=>xt(l));o=HW(t.serverSyncTree_,s,c)}else{let c=xt(n);o=Zf(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Xw(t,s)),Ps(t.eventQueue_,a,o)}function WP(t,e){Zw(t,"connected",e),e===!1&&p4(t)}function h4(t,e){Cn(e,(n,r)=>{Zw(t,n,r)})}function Zw(t,e,n){let r=new ke("/.info/"+e),i=xt(n);t.infoData_.updateSnapshot(r,i);let s=Zf(t.infoSyncTree_,r,i);Ps(t.eventQueue_,r,s)}function f4(t){return t.nextWriteId_++}function p4(t){ZM(t,"onDisconnectEvents");let e=YM(t),n=Gf();ww(t.onDisconnect_,Re(),(i,s)=>{let o=QW(i,s,t.serverSyncTree_,e);CM(n,i,o)});let r=[];ww(n,Re(),(i,s)=>{r=r.concat(Zf(t.serverSyncTree_,i,s));let o=y4(t,i);Xw(t,o)}),t.onDisconnect_=Gf(),Ps(t.eventQueue_,Re(),r)}function g4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(c4)}function ZM(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Mt(n,...e)}function JM(t,e,n){return UM(t.serverSyncTree_,e,n)||ze.EMPTY_NODE}function Jw(t,e=t.transactionQueueTree_){if(e||ep(t,e),va(e)){let n=ex(t,e);F(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&m4(t,Fu(e),n)}else GM(e)&&Xf(e,n=>{Jw(t,n)})}function m4(t,e,n){let r=n.map(l=>l.currentWriteId),i=JM(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let d=n[l];F(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let p=En(e,d.path);s=s.updateChild(p,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{ZM(t,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let p=[];for(let g=0;g<n.length;g++)n[g].status=2,d=d.concat(ca(t.serverSyncTree_,n[g].currentWriteId)),n[g].onComplete&&p.push(()=>n[g].onComplete(null,!0,n[g].currentOutputSnapshotResolved)),n[g].unwatcher();ep(t,Yw(t.transactionQueueTree_,e)),Jw(t,t.transactionQueueTree_),Ps(t.eventQueue_,e,d);for(let g=0;g<p.length;g++)ku(p[g])}else{if(l==="datastale")for(let p=0;p<n.length;p++)n[p].status===3?n[p].status=4:n[p].status=0;else{hn("transaction at "+c.toString()+" failed: "+l);for(let p=0;p<n.length;p++)n[p].status=4,n[p].abortReason=l}Xw(t,e)}},o)}function Xw(t,e){let n=XM(t,e),r=Fu(n),i=ex(t,n);return _4(t,i,r),r}function _4(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=En(n,c.path),d=!1,p;if(F(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,p=c.abortReason,i=i.concat(ca(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=u4)d=!0,p="maxretry",i=i.concat(ca(t.serverSyncTree_,c.currentWriteId,!0));else{let g=JM(t,c.path,o);c.currentInputSnapshot=g;let _=e[a].update(g.val());if(_!==void 0){QM("transaction failed: Data returned ",_,c.path);let E=xt(_);typeof _=="object"&&_!=null&&$n(_,".priority")||(E=E.updatePriority(g.getPriority()));let A=c.currentWriteId,x=YM(t),L=YW(E,g,x);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=L,c.currentWriteId=f4(t),o.splice(o.indexOf(A),1),i=i.concat($W(t.serverSyncTree_,c.path,L,c.currentWriteId,c.applyLocally)),i=i.concat(ca(t.serverSyncTree_,A,!0))}else d=!0,p="nodata",i=i.concat(ca(t.serverSyncTree_,c.currentWriteId,!0))}Ps(t.eventQueue_,n,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(p==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(p),!1,null))))}ep(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ku(r[a]);Jw(t,t.transactionQueueTree_)}function XM(t,e){let n,r=t.transactionQueueTree_;for(n=ve(e);n!==null&&va(r)===void 0;)r=Yw(r,n),e=je(e),n=ve(e);return r}function ex(t,e){let n=[];return tx(t,e,n),n.sort((r,i)=>r.order-i.order),n}function tx(t,e,n){let r=va(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Xf(e,i=>{tx(t,i,n)})}function ep(t,e){let n=va(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,zM(e,n.length>0?n:void 0)}Xf(e,r=>{ep(t,r)})}function y4(t,e){let n=Fu(XM(t,e)),r=Yw(t.transactionQueueTree_,e);return JW(r,i=>{YI(t,i)}),YI(t,r),WM(r,i=>{YI(t,i)}),n}function YI(t,e){let n=va(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(F(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(F(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ca(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?zM(e,void 0):n.length=s+1,Ps(t.eventQueue_,Fu(e),i);for(let o=0;o<r.length;o++)ku(r[o])}}function v4(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function I4(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):hn(`Invalid query segment '${n}' in query '${t}'`)}return e}var KP=function(t,e){let n=w4(t),r=n.namespace;n.domain==="firebase.com"&&Or(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Or("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||gG();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Uf(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new ke(n.pathString)}},w4=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let d=t.indexOf("/");d===-1&&(d=t.length);let p=t.indexOf("?");p===-1&&(p=t.length),e=t.substring(0,Math.min(d,p)),d<p&&(i=v4(t.substring(d,p)));let g=I4(t.substring(Math.min(t.length,p)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")n="localhost";else if(_.split(".").length<=2)n=_;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),n=e.substring(E+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Vw=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return me(this._path)?null:gM(this._path)}get ref(){return new _a(this._repo,this._path)}get _queryIdentifier(){let e=kP(this._queryParams),n=$w(e);return n==="{}"?"default":n}get _queryObject(){return kP(this._queryParams)}isEqual(e){if(e=fe(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=yM(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+WG(this._path)}};var _a=class t extends Vw{constructor(e,n){super(e,n,new yw,!1)}get parent(){let e=_M(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};jW(_a);BW(_a);var E4="FIREBASE_DATABASE_EMULATOR_HOST",Uw={},T4=!1;function C4(t,e,n,r){t.repoInfo_=new Uf(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function b4(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Or("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=KP(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[E4]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=KP(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Du(Du.OWNER):new nw(t.name,t.options,e);i4("Invalid Firebase Database URL",o),me(o.path)||Or("Database URL must point to the root of a Firebase Database (not including a child path).");let p=S4(a,t,d,new tw(t.name,n));return new jw(p,t)}function D4(t,e){let n=Uw[e];(!n||n[t.key]!==t)&&Or(`Database ${e}(${t.repoInfo_}) has already been deleted.`),g4(t),delete n[t.key]}function S4(t,e,n,r){let i=Uw[e.name];i||(i={},Uw[e.name]=i);let s=i[t.toURLString()];return s&&Or("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Lw(t,T4,n,r),i[t.toURLString()]=s,s}var jw=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(l4(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new _a(this._repo,Re())),this._rootInternal}_delete(){return this._rootInternal!==null&&(D4(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Or("Cannot call "+e+" on a deleted database.")}};function nx(t=it(),e){let n=rt(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let r=qr("database");r&&rx(n,...r)}return n}function rx(t,e,n,r={}){t=fe(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Or("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Or('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Du(Du.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Vs(r.mockUserToken,t.app.options.projectId);s=new Du(o)}C4(i,e,n,s)}function A4(t){hG(zt),Xe(new Je("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return b4(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),q(mP,_P,t),q(mP,_P,"esm2017")}qw.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};qw.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};A4();var Lu=class{constructor(e){return e}},ix="database",eE=class{constructor(){return nt(ix)}};var tE=new U("angularfire2.database-instances");function R4(t,e){let n=ct(ix,t,e);return n&&new Lu(n)}function N4(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Lu(r)}}var P4={provide:eE,deps:[[new ee,tE]]},M4={provide:Lu,useFactory:R4,deps:[[new ee,tE],Ue]};function sx(t,...e){return q("angularfire",Ve.full,"rtdb"),Oe([M4,P4,{provide:tE,useFactory:N4(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,xn],[new ee,Qt],...e]}])}var ox=we(nx,!0);var ux="functions";var nE=class{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return y(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return y(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return y(this,null,function*(){if(this.appCheck){let n=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return n.error?null:n.token}return null})}getContext(e){return y(this,null,function*(){let n=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}})}};var rE="us-central1";var iE=class{constructor(e,n,r,i,s=rE,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new nE(n,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=rE}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}};function x4(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}var ax="@firebase/functions",cx="0.11.8";var k4="auth-internal",O4="app-check-internal",F4="messaging-internal";function L4(t,e){let n=(r,{instanceIdentifier:i})=>{let s=r.getProvider("app").getImmediate(),o=r.getProvider(k4),a=r.getProvider(F4),c=r.getProvider(O4);return new iE(s,o,a,c,i,t)};Xe(new Je(ux,n,"PUBLIC").setMultipleInstances(!0)),q(ax,cx,e),q(ax,cx,"esm2017")}function lx(t=it(),e=rE){let r=rt(fe(t),ux).getImmediate({identifier:e}),i=qr("functions");return i&&dx(r,...i),r}function dx(t,e,n){x4(fe(t),e,n)}L4(fetch.bind(self));var Vu=class{constructor(e){return e}},hx="functions",sE=class{constructor(){return nt(hx)}};var oE=new U("angularfire2.functions-instances");function V4(t,e){let n=ct(hx,t,e);return n&&new Vu(n)}function U4(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Vu(r)}}var j4={provide:sE,deps:[[new ee,oE]]},B4={provide:Vu,useFactory:V4,deps:[[new ee,oE],Ue]};function fx(t,...e){return q("angularfire",Ve.full,"fn"),Oe([B4,j4,{provide:oE,useFactory:U4(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,xn],[new ee,Qt],...e]}])}var px=we(lx,!0);var $4="/firebase-messaging-sw.js",H4="/firebase-cloud-messaging-push-scope",Ix="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",q4="https://fcmregistrations.googleapis.com/v1",wx="google.c.a.c_id",z4="google.c.a.c_l",G4="google.c.a.ts",W4="google.c.a.e";var tp=function(t){return t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",t}(tp||{});function Fr(t){let e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function K4(t){let e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}var aE="fcm_token_details_db",Q4=5,gx="fcm_token_object_Store";function Y4(t){return y(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(aE))return null;let e=null;return(yield Lp(aE,Q4,{upgrade:(r,i,s,o)=>y(this,null,function*(){var a;if(i<2||!r.objectStoreNames.contains(gx))return;let c=o.objectStore(gx),l=yield c.index("fcmSenderId").get(t);if(yield c.clear(),!!l){if(i===2){let d=l;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Fr(d.vapidKey)}}}else if(i===3){let d=l;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fr(d.auth),p256dh:Fr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fr(d.vapidKey)}}}else if(i===4){let d=l;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fr(d.auth),p256dh:Fr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fr(d.vapidKey)}}}}})})).close(),yield ll(aE),yield ll("fcm_vapid_details_db"),yield ll("undefined"),Z4(e)?e:null})}function Z4(t){if(!t||!t.subscriptionOptions)return!1;let{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var J4="firebase-messaging-database",X4=1,Uu="firebase-messaging-store",cE=null;function Ex(){return cE||(cE=Lp(J4,X4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Uu)}}})),cE}function e9(t){return y(this,null,function*(){let e=Tx(t),r=yield(yield Ex()).transaction(Uu).objectStore(Uu).get(e);if(r)return r;{let i=yield Y4(t.appConfig.senderId);if(i)return yield dE(t,i),i}})}function dE(t,e){return y(this,null,function*(){let n=Tx(t),i=(yield Ex()).transaction(Uu,"readwrite");return yield i.objectStore(Uu).put(e,n),yield i.done,e})}function Tx({appConfig:t}){return t.appId}var t9={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ht=new Bn("messaging","Messaging",t9);function n9(t,e){return y(this,null,function*(){let n=yield fE(t),r=Cx(e),i={method:"POST",headers:n,body:JSON.stringify(r)},s;try{s=yield(yield fetch(hE(t.appConfig),i)).json()}catch(o){throw Ht.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw Ht.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw Ht.create("token-subscribe-no-token");return s.token})}function r9(t,e){return y(this,null,function*(){let n=yield fE(t),r=Cx(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},s;try{s=yield(yield fetch(`${hE(t.appConfig)}/${e.token}`,i)).json()}catch(o){throw Ht.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw Ht.create("token-update-failed",{errorInfo:o})}if(!s.token)throw Ht.create("token-update-no-token");return s.token})}function i9(t,e){return y(this,null,function*(){let r={method:"DELETE",headers:yield fE(t)};try{let s=yield(yield fetch(`${hE(t.appConfig)}/${e}`,r)).json();if(s.error){let o=s.error.message;throw Ht.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw Ht.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function hE({projectId:t}){return`${q4}/projects/${t}/registrations`}function fE(n){return y(this,arguments,function*({appConfig:t,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function Cx({p256dh:t,auth:e,endpoint:n,vapidKey:r}){let i={web:{endpoint:n,auth:e,p256dh:t}};return r!==Ix&&(i.web.applicationPubKey=r),i}var s9=7*24*60*60*1e3;function o9(t){return y(this,null,function*(){let e=yield c9(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Fr(e.getKey("auth")),p256dh:Fr(e.getKey("p256dh"))},r=yield e9(t.firebaseDependencies);if(r){if(u9(r.subscriptionOptions,n))return Date.now()>=r.createTime+s9?a9(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{yield i9(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return mx(t.firebaseDependencies,n)}else return mx(t.firebaseDependencies,n)})}function a9(t,e){return y(this,null,function*(){try{let n=yield r9(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return yield dE(t.firebaseDependencies,r),n}catch(n){throw n}})}function mx(t,e){return y(this,null,function*(){let r={token:yield n9(t,e),createTime:Date.now(),subscriptionOptions:e};return yield dE(t,r),r.token})}function c9(t,e){return y(this,null,function*(){let n=yield t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:K4(e)})})}function u9(t,e){let n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,s=e.p256dh===t.p256dh;return n&&r&&i&&s}function _x(t){let e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return l9(e,t),d9(e,t),h9(e,t),e}function l9(t,e){if(!e.notification)return;t.notification={};let n=e.notification.title;n&&(t.notification.title=n);let r=e.notification.body;r&&(t.notification.body=r);let i=e.notification.image;i&&(t.notification.image=i);let s=e.notification.icon;s&&(t.notification.icon=s)}function d9(t,e){e.data&&(t.data=e.data)}function h9(t,e){var n,r,i,s,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};let a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;a&&(t.fcmOptions.link=a);let c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}function f9(t){return typeof t=="object"&&!!t&&wx in t}p9("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function p9(t,e){let n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}function g9(t){if(!t||!t.options)throw uE("App Configuration Object");if(!t.name)throw uE("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(let r of e)if(!n[r])throw uE(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function uE(t){return Ht.create("missing-app-config-values",{valueName:t})}var lE=class{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=g9(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}};function m9(t){return y(this,null,function*(){try{t.swRegistration=yield navigator.serviceWorker.register($4,{scope:H4}),t.swRegistration.update().catch(()=>{})}catch(e){throw Ht.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function _9(t,e){return y(this,null,function*(){if(!e&&!t.swRegistration&&(yield m9(t)),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Ht.create("invalid-sw-registration");t.swRegistration=e}})}function y9(t,e){return y(this,null,function*(){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=Ix)})}function v9(t,e){return y(this,null,function*(){if(!navigator)throw Ht.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw Ht.create("permission-blocked");return yield y9(t,e?.vapidKey),yield _9(t,e?.serviceWorkerRegistration),o9(t)})}function I9(t,e,n){return y(this,null,function*(){let r=w9(e);(yield t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[wx],message_name:n[z4],message_time:n[G4],message_device_time:Math.floor(Date.now()/1e3)})})}function w9(t){switch(t){case tp.NOTIFICATION_CLICKED:return"notification_open";case tp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function E9(t,e){return y(this,null,function*(){let n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===tp.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(_x(n)):t.onMessageHandler.next(_x(n)));let r=n.data;f9(r)&&r[W4]==="1"&&(yield I9(t,n.messageType,r))})}var yx="@firebase/messaging",vx="0.12.12";var T9=t=>{let e=new lE(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>E9(e,n)),e},C9=t=>{let e=t.getProvider("messaging").getImmediate();return{getToken:r=>v9(e,r)}};function b9(){Xe(new Je("messaging",T9,"PUBLIC")),Xe(new Je("messaging-internal",C9,"PRIVATE")),q(yx,vx),q(yx,vx,"esm2017")}function pE(){return y(this,null,function*(){try{yield Si()}catch{return!1}return typeof window<"u"&&hr()&&$a()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function bx(t=it()){return pE().then(e=>{if(!e)throw Ht.create("unsupported-browser")},e=>{throw Ht.create("indexed-db-unsupported")}),rt(fe(t),"messaging").getImmediate()}b9();var ju=class{constructor(e){return e}},Dx="messaging",gE=class{constructor(){return nt(Dx)}};var Sx="__angularfire_symbol__messagingIsSupported",mE="__angularfire_symbol__messagingIsSupportedValue";globalThis[Sx]||=pE().then(t=>globalThis[mE]=t).catch(()=>globalThis[mE]=!1);var np={async:()=>globalThis[Sx],sync:()=>{let t=globalThis[mE];if(t===void 0)throw new Error(Mo("Messaging"));return t}},_E=new U("angularfire2.messaging-instances");function D9(t,e){if(!np.sync())return null;let n=ct(Dx,t,e);return n&&new ju(n)}function S9(t){return(e,n)=>{if(!np.sync())return null;let r=e.runOutsideAngular(()=>t(n));return new ju(r)}}var A9={provide:gE,deps:[[new ee,_E]]},R9={provide:ju,useFactory:D9,deps:[[new ee,_E],Ue]};function Ax(t,...e){return q("angularfire",Ve.full,"fcm"),Oe([R9,A9,{provide:si,useValue:np.async,multi:!0},{provide:_E,useFactory:S9(t),multi:!0,deps:[Z,ge,Ye,He,...e]}])}var _re=np.async;var Rx=we(bx,!0);var Bu=class{constructor(e){return e}},Nx="performance",yE=class{constructor(){return nt(Nx)}};var vE=new U("angularfire2.performance-instances");function N9(t,e,n){if(!$m(n))return null;let r=ct(Nx,t,e);return r&&new Bu(r)}function P9(t){return(e,n,r)=>{if(!$m(n))return null;let i=e.runOutsideAngular(()=>t(r));return new Bu(i)}}var M9={provide:yE,deps:[[new ee,vE]]},x9={provide:Bu,useFactory:N9,deps:[[new ee,vE],Ue,Nn]};function Px(t,...e){return q("angularfire",Ve.full,"perf"),Oe([x9,M9,{provide:vE,useFactory:P9(t),multi:!0,deps:[Z,Nn,ge,Ye,He,...e]}])}var Mx=we(oC,!0);var Vx="firebasestorage.googleapis.com",k9="storageBucket",O9=2*60*1e3,F9=10*60*1e3;var cr=class t extends qt{constructor(e,n,r=0){super(IE(e),`Firebase Storage: ${n} (${IE(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return IE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Vr=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Vr||{});function IE(t){return"storage/"+t}function L9(){let t="An unknown error occurred, please check the error payload for server response.";return new cr(Vr.UNKNOWN,t)}function V9(){return new cr(Vr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function U9(){return new cr(Vr.CANCELED,"User canceled the upload/download.")}function j9(t){return new cr(Vr.INVALID_URL,"Invalid URL '"+t+"'.")}function B9(t){return new cr(Vr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function xx(t){return new cr(Vr.INVALID_ARGUMENT,t)}function Ux(){return new cr(Vr.APP_DELETED,"The Firebase app was deleted.")}function $9(t){return new cr(Vr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Lr=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw B9(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(G){G.path_=decodeURIComponent(G.path)}let d="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${d}/b/${i}/o${g}`,"i"),E={bucket:1,path:3},R=n===Vx?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",x=new RegExp(`^https?://${R}/${i}/${A}`,"i"),$=[{regex:a,indices:c,postModify:s},{regex:_,indices:E,postModify:l},{regex:x,indices:{bucket:1,path:2},postModify:l}];for(let G=0;G<$.length;G++){let Ne=$[G],Y=Ne.regex.exec(e);if(Y){let T=Y[Ne.indices.bucket],v=Y[Ne.indices.path];v||(v=""),r=new t(T,v),Ne.postModify(r);break}}if(r==null)throw j9(e);return r}},wE=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function H9(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...A){l||(l=!0,e.apply(null,A))}function p(A){i=setTimeout(()=>{i=null,t(_,c())},A)}function g(){s&&clearTimeout(s)}function _(A,...x){if(l){g();return}if(A){g(),d.call(null,A,...x);return}if(c()||o){g(),d.call(null,A,...x);return}r<64&&(r*=2);let $;a===1?(a=2,$=0):$=(r+Math.random())*1e3,p($)}let E=!1;function R(A){E||(E=!0,g(),!l&&(i!==null?(A||(a=2),clearTimeout(i),p(0)):A||(a=1)))}return p(0),s=setTimeout(()=>{o=!0,R(!0)},n),R}function q9(t){t(!1)}function z9(t){return t!==void 0}function kx(t,e,n,r){if(r<e)throw xx(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw xx(`Invalid value for '${t}'. Expected ${n} or less.`)}function G9(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var EE=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(EE||{});function W9(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var TE=class{constructor(e,n,r,i,s,o,a,c,l,d,p,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=p,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ia(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===EE.NO_ERROR,c=s.getStatus();if(!a||W9(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===EE.ABORT;r(!1,new Ia(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Ia(l,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());z9(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=L9();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?Ux():U9();o(c)}else{let c=V9();o(c)}};this.canceled_?n(!1,new Ia(!1,null,!0)):this.backoffId_=H9(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&q9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ia=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function K9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Q9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Y9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Z9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function J9(t,e,n,r,i,s,o=!0){let a=G9(t.urlParams),c=t.url+a,l=Object.assign({},t.headers);return Y9(l,e),K9(l,n),Q9(l,s),Z9(l,r),new TE(c,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function X9(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function e3(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}var kre=256*1024;var CE=class t{constructor(e,n){this._service=e,n instanceof Lr?this._location=n:this._location=Lr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new Lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return e3(this._location.path)}get storage(){return this._service}get parent(){let e=X9(this._location.path);if(e===null)return null;let n=new Lr(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw $9(e)}};function Ox(t,e){let n=e?.[k9];return n==null?null:Lr.makeFromBucketSpec(n,t)}function t3(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Vs(i,t.app.options.projectId))}var bE=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Vx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=O9,this._maxUploadRetryTime=F9,this._requests=new Set,i!=null?this._bucket=Lr.makeFromBucketSpec(i,this._host):this._bucket=Ox(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Lr.makeFromBucketSpec(this._url,e):this._bucket=Ox(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){kx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){kx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new CE(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new wE(Ux());{let o=J9(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},Fx="@firebase/storage",Lx="0.13.2";var jx="storage";function Bx(t=it(),e){t=fe(t);let r=rt(t,jx).getImmediate({identifier:e}),i=qr("storage");return i&&$x(r,...i),r}function $x(t,e,n,r={}){t3(t,e,n,r)}function n3(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new bE(n,r,i,e,zt)}function r3(){Xe(new Je(jx,n3,"PUBLIC").setMultipleInstances(!0)),q(Fx,Lx,""),q(Fx,Lx,"esm2017")}r3();var $u=class{constructor(e){return e}},Hx="storage",DE=class{constructor(){return nt(Hx)}};var SE=new U("angularfire2.storage-instances");function i3(t,e){let n=ct(Hx,t,e);return n&&new $u(n)}function s3(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new $u(r)}}var o3={provide:DE,deps:[[new ee,SE]]},a3={provide:$u,useFactory:i3,deps:[[new ee,SE],Ue]};function qx(t,...e){return q("angularfire",Ve.full,"gcs"),Oe([a3,o3,{provide:SE,useFactory:s3(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,xn],[new ee,Qt],...e]}])}var zx=we(Bx,!0);var AE="@firebase/remote-config",Gx="0.4.9";var Wx="remote-config";var c3={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},Jt=new Bn("remoteconfig","Remote Config",c3);function Kx(t=it()){return t=fe(t),rt(t,Wx).getImmediate()}function Qx(t){let e=fe(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var RE=class{constructor(e,n,r,i){this.client=e,this.storage=n,this.storageCache=r,this.logger=i}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-n,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return y(this,null,function*(){let[n,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&s.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(s),i})}};function u3(t=navigator){return t.languages&&t.languages[0]||t.language}var NE=class{constructor(e,n,r,i,s,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){return y(this,null,function*(){let[n,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:u3()},c={method:"POST",headers:o,body:JSON.stringify(a)},l=fetch(s,c),d=new Promise((A,x)=>{e.signal.addEventListener(()=>{let L=new Error("The operation was aborted.");L.name="AbortError",x(L)})}),p;try{yield Promise.race([l,d]),p=yield l}catch(A){let x="fetch-client-network";throw A?.name==="AbortError"&&(x="fetch-timeout"),Jt.create(x,{originalErrorMessage:A?.message})}let g=p.status,_=p.headers.get("ETag")||void 0,E,R;if(p.status===200){let A;try{A=yield p.json()}catch(x){throw Jt.create("fetch-client-parse",{originalErrorMessage:x?.message})}E=A.entries,R=A.state}if(R==="INSTANCE_STATE_UNSPECIFIED"?g=500:R==="NO_CHANGE"?g=304:(R==="NO_TEMPLATE"||R==="EMPTY_CONFIG")&&(E={}),g!==304&&g!==200)throw Jt.create("fetch-status",{httpStatus:g});return{status:g,eTag:_,config:E}})}};function l3(t,e){return new Promise((n,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Jt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function d3(t){if(!(t instanceof qt)||!t.customData)return!1;let e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}var PE=class{constructor(e,n){this.client=e,this.storage=n}fetch(e){return y(this,null,function*(){let n=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)})}attemptFetch(i,s){return y(this,arguments,function*(e,{throttleEndTimeMillis:n,backoffCount:r}){yield l3(e.signal,n);try{let o=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),o}catch(o){if(!d3(o))throw o;let a={throttleEndTimeMillis:Date.now()+Wa(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(a),this.attemptFetch(e,a)}})}};var h3=60*1e3,f3=12*60*60*1e3,ME=class{constructor(e,n,r,i,s){this.app=e,this._client=n,this._storageCache=r,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:h3,minimumFetchIntervalMillis:f3},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}};function rp(t,e){let n=t.target.error||void 0;return Jt.create(e,{originalErrorMessage:n&&n?.message})}var Ms="app_namespace_store",p3="firebase_remote_config",g3=1;function m3(){return new Promise((t,e)=>{try{let n=indexedDB.open(p3,g3);n.onerror=r=>{e(rp(r,"storage-open"))},n.onsuccess=r=>{t(r.target.result)},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ms,{keyPath:"compositeKey"})}}}catch(n){e(Jt.create("storage-open",{originalErrorMessage:n?.message}))}})}var xE=class{constructor(e,n,r,i=m3()){this.appId=e,this.appName=n,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){return y(this,null,function*(){let n=yield this.openDbPromise;return new Promise((r,i)=>{let o=n.transaction([Ms],"readonly").objectStore(Ms),a=this.createCompositeKey(e);try{let c=o.get(a);c.onerror=l=>{i(rp(l,"storage-get"))},c.onsuccess=l=>{let d=l.target.result;r(d?d.value:void 0)}}catch(c){i(Jt.create("storage-get",{originalErrorMessage:c?.message}))}})})}set(e,n){return y(this,null,function*(){let r=yield this.openDbPromise;return new Promise((i,s)=>{let a=r.transaction([Ms],"readwrite").objectStore(Ms),c=this.createCompositeKey(e);try{let l=a.put({compositeKey:c,value:n});l.onerror=d=>{s(rp(d,"storage-set"))},l.onsuccess=()=>{i()}}catch(l){s(Jt.create("storage-set",{originalErrorMessage:l?.message}))}})})}delete(e){return y(this,null,function*(){let n=yield this.openDbPromise;return new Promise((r,i)=>{let o=n.transaction([Ms],"readwrite").objectStore(Ms),a=this.createCompositeKey(e);try{let c=o.delete(a);c.onerror=l=>{i(rp(l,"storage-delete"))},c.onsuccess=()=>{r()}}catch(c){i(Jt.create("storage-delete",{originalErrorMessage:c?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};var kE=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){return y(this,null,function*(){let e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=yield e;i&&(this.lastFetchStatus=i);let s=yield n;s&&(this.lastSuccessfulFetchTimestampMillis=s);let o=yield r;o&&(this.activeConfig=o)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}};function _3(){Xe(new Je(Wx,t,"PUBLIC").setMultipleInstances(!0)),q(AE,Gx),q(AE,Gx,"esm2017");function t(e,{instanceIdentifier:n}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Jt.create("registration-window");if(!hr())throw Jt.create("indexed-db-unavailable");let{projectId:s,apiKey:o,appId:a}=r.options;if(!s)throw Jt.create("registration-project-id");if(!o)throw Jt.create("registration-api-key");if(!a)throw Jt.create("registration-app-id");n=n||"firebase";let c=new xE(a,r.name,n),l=new kE(c),d=new Hn(AE);d.logLevel=At.ERROR;let p=new NE(i,zt,n,s,o,a),g=new PE(p,c),_=new RE(g,c,l,d),E=new ME(r,_,l,c,d);return Qx(E),E}}function Yx(){return y(this,null,function*(){if(!hr())return!1;try{return yield Si()}catch{return!1}})}_3();var Hu=class{constructor(e){return e}},Zx="remote-config",OE=class{constructor(){return nt(Zx)}};var FE="__angularfire_symbol__remoteConfigIsSupportedValue",Jx="__angularfire_symbol__remoteConfigIsSupported";globalThis[Jx]||=Yx().then(t=>globalThis[FE]=t).catch(()=>globalThis[FE]=!1);var ip={async:()=>globalThis[Jx],sync:()=>{let t=globalThis[FE];if(t===void 0)throw new Error(Mo("RemoteConfig"));return t}},LE=new U("angularfire2.remote-config-instances");function y3(t,e){if(!ip.sync())return null;let n=ct(Zx,t,e);return n&&new Hu(n)}function v3(t){return(e,n)=>{if(!ip.sync())return null;let r=e.runOutsideAngular(()=>t(n));return new Hu(r)}}var I3={provide:OE,deps:[[new ee,LE]]},w3={provide:Hu,useFactory:y3,deps:[[new ee,LE],Ue]};function Xx(t,...e){return q("angularfire",Ve.full,"rc"),Oe([w3,I3,{provide:si,useValue:ip.async,multi:!0},{provide:LE,useFactory:v3(t),multi:!0,deps:[Z,ge,Ye,He,...e]}])}var Pie=ip.async;var ek=we(Kx,!0);var tk="@firebase/vertexai-preview",nk="0.0.4";var rk="vertexAI",ik="us-central1";var VE=class{constructor(e,n,r,i){var s;this.app=e,this.options=i;let o=r?.getImmediate({optional:!0}),a=n?.getImmediate({optional:!0});this.auth=a||null,this.appCheck=o||null,this.location=((s=this.options)===null||s===void 0?void 0:s.location)||ik}_delete(){return Promise.resolve()}};var UE=function(t){return t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.OTHER="OTHER",t}(UE||{});var Lie=[UE.RECITATION,UE.SAFETY];function sk(t=it(),e){return t=fe(t),rt(t,rk).getImmediate({identifier:e?.location||ik})}function E3(){Xe(new Je(rk,(t,{instanceIdentifier:e})=>{let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new VE(n,r,i,{location:e})},"PUBLIC").setMultipleInstances(!0)),q(tk,nk),q(tk,nk,"esm2017")}E3();var qu=class{constructor(e){return e}},ok="vertexai",jE=class{constructor(){return nt(ok)}};var BE=new U("angularfire2.vertexai-instances");function T3(t,e){let n=ct(ok,t,e);return n&&new qu(n)}function C3(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new qu(r)}}var b3={provide:jE,deps:[[new ee,BE]]},D3={provide:qu,useFactory:T3,deps:[[new ee,BE],Ue]};function ak(t,...e){return q("angularfire",Ve.full,"vertexai"),Oe([D3,b3,{provide:BE,useFactory:C3(t),multi:!0,deps:[Z,ge,Ye,He,[new ee,Qt],...e]}])}var ck=we(sk,!0);var uk={firebaseConfig:{apiKey:"AIzaSyBggO56pZ3V5jgNnv_4i_CpUbgU_iGvcsk",authDomain:"dash-boar-7ee0d.firebaseapp.com",projectId:"dash-boar-7ee0d",storageBucket:"dash-boar-7ee0d.firebasestorage.app",messagingSenderId:"325394396819",appId:"1:325394396819:web:e9673769b33be96849bf66",measurementId:"G-V0X3V5XKL2"},production:!0};var lk={providers:[LS({eventCoalescing:!0}),qA(zA),GA(()=>WA(uk.firebaseConfig)),U0(()=>B0()),cR(()=>oR()),aR,Py,dP(()=>fP()),sx(()=>ox()),fx(()=>px()),Ax(()=>Rx()),Px(()=>Mx()),qx(()=>zx()),Xx(()=>ek()),ak(()=>ck())]};var Ii=class t{firestore=M(Cs);destroy$=new $e;constructor(){}delete(e){return hP(Ff(this.collectionRef,e))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}generateNextId(){return y(this,null,function*(){let e=yield $I(this.collectionRef),n=0;return e.forEach(r=>{let i=r.data(),s=parseInt(i.id,10);!isNaN(s)&&s>n&&(n=s)}),(n+1).toString()})}createData(e,n){let r=Ff(this.collectionRef,e);return HI(r,n)}updateData(e,n){return HI(Ff(this.collectionRef,e),n,{merge:!0})}getDataById(e){return y(this,null,function*(){let n=pP(this.collectionRef,gP("id","==",e)),r=yield $I(n);if(!r.empty)return r.docs[0].data()})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var sp=class t extends Ii{collectionPath="/drivers";collectionRef=sa(this.firestore,this.collectionPath);constructor(){super()}getAll(){return ia(this.collectionRef).pipe(tn(this.destroy$),Q(e=>e.filter(n=>!n.deleted)))}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),this.createData(e.id,e)})}update(e){return this.updateData(e.id,e)}getById(e){return this.getDataById(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var wi=class t{constructor(){}get(){return{durationHour:24,endTyreChangeWindowHour:14,fuelDurationMinute:120,minDriverChange:30,minStintMinute:5,minTyreChange:1,startTyreChangeWindowHour:10}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};var Ei=class t extends Ii{collectionPath="/races";collectionRef=sa(this.firestore,this.collectionPath);raceConfigService=M(wi);activeRace=Rm(void 0);constructor(){super(),this.getAll().pipe(tn(this.destroy$)).subscribe(e=>{let n=this.getActiveRace(e);this.activeRace.set(n)})}getAll(){return ia(this.collectionRef).pipe(tn(this.destroy$),Q(e=>e.filter(n=>!n.deleted)))}create(e){return y(this,null,function*(){return this.activeRace()!==void 0?(console.warn("Race already active -> "+this.activeRace()),Promise.resolve()):(e.id=yield this.generateNextId(),this.createData(e.id,e))})}updateRace(e){return this.updateData(e.id,e)}getById(e){return this.getDataById(e)}getActiveRace(e){let n=new Date;for(let r of e){let i=r.start.toDate();if(i.setHours(i.getHours()+this.raceConfigService.get().durationHour),i>n)return r}}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};function S3(t,e){if(t&1){let n=PS();ot(0,"button",3),Fd("click",function(){mD(n);let i=Zi();return _D(i.startRace())}),wt(1," Start race "),Qe()}}function A3(t,e){if(t&1&&(ot(0,"div",2),wt(1),Qe()),t&2){let n=Zi();wr(),Ji(" ",n.timeLeft," ")}}var op=class t{raceService=M(Ei);raceConfigService=M(wi);durationHour;intervalId;activeRace;timeLeft="";constructor(){this.durationHour=this.raceConfigService.get().durationHour,this.activeRace=this.raceService.activeRace}ngOnInit(){this.intervalId=setInterval(()=>{let e=this.activeRace();e?this.timeLeft=this.calculateLeftTime(e.start.toDate()):this.timeLeft=""},1e3)}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId)}startRace(){this.raceService.create({id:"1",start:gt.now(),deleted:!1})}calculateLeftTime(e){let n=new Date().getTime(),i=e.getTime()+this.durationHour*60*60*1e3-n;if(i<0)return"00:00:00";{let s=Math.floor(i%864e5/36e5),o=Math.floor(i%(1e3*60*60)/(1e3*60)),a=Math.floor(i%(1e3*60)/1e3);return`${this.pad(s)}:${this.pad(o)}:${this.pad(a)}`}}pad(e,n=2){let r=e.toString();for(;r.length<n;)r="0"+r;return r}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ni({type:t,selectors:[["app-race"]],standalone:!0,features:[ii],decls:4,vars:1,consts:[[1,"flex","items-center","justify-center","h-20"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded"],[1,"text-4xl","font-bold","font-mono"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded",3,"click"]],template:function(n,r){n&1&&(ot(0,"div",0)(1,"div"),ri(2,S3,2,0,"button",1)(3,A3,2,1,"div",2),Qe()()),n&2&&(wr(2),Qi(r.activeRace()?3:2))}})};function $E(t){t||(Cd($E),t=M(_o));let e=new ae(n=>t.onDestroy(n.next.bind(n)));return n=>n.pipe(tn(e))}function HE(t,e){!e?.injector&&Cd(HE);let n=e?.injector??M(ge),r=new ec(1),i=Om(()=>{let s;try{s=t()}catch(o){jd(()=>r.error(o));return}jd(()=>r.next(s))},{injector:n,manualCleanup:!0});return n.get(_o).onDestroy(()=>{i.destroy(),r.complete()}),r.asObservable()}var ap=class t extends Ii{raceService=M(Ei);collectionPath="/pits";collectionRef=sa(this.firestore,this.collectionPath);activeRace;constructor(){super(),this.activeRace=this.raceService.activeRace}getRacePits(){return Zs({pits:ia(this.collectionRef),activeRace:HE(this.activeRace)}).pipe(tn(this.destroy$),Q(({pits:e,activeRace:n})=>n?e.filter(r=>!r.deleted&&r.raceId===n.id):[]))}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),this.createData(e.id,e)})}update(e){return this.updateData(e.id,e)}getById(e){return this.getDataById(e)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})};function R3(t,e){t&1&&(ot(0,"div",3),wt(1,"Open"),Qe())}function N3(t,e){t&1&&(ot(0,"div",4),wt(1,"Close"),Qe())}function P3(t,e){if(t&1&&(wt(0),Pm(1,"date")),t&2){let n=Zi();Ji(" ",Mm(1,1,n.openingTime(),"HH:mm:ss")," ")}}function M3(t,e){t&1&&wt(0," --:--:-- ")}function x3(t,e){if(t&1&&(wt(0),Pm(1,"date")),t&2){let n=Zi();Ji(" ",Mm(1,1,n.closingTime(),"HH:mm:ss")," ")}}function k3(t,e){t&1&&wt(0," --:--:-- ")}function O3(t,e){if(t&1&&(ot(0,"div",9),wt(1),Qe()),t&2){let n=Zi();wr(),Ji("Remaining tyre change: ",n.remainingTyreChange,"")}}function F3(t,e){t&1&&(ot(0,"div",3),wt(1,"Tyre change completed!"),Qe())}var cp=class t{raceService=M(Ei);raceConfigService=M(wi);pitService=M(ap);startTyreChangeWindowHour=this.raceConfigService.get().startTyreChangeWindowHour;endTyreChangeWindowHour=this.raceConfigService.get().endTyreChangeWindowHour;minTyreChange=this.raceConfigService.get().minTyreChange;destroy$=new $e;intervalId;isOpen=!1;remainingTyreChange;activeRace;openingTime=Ud(()=>{let e=this.activeRace();if(e){let n=e.start.toDate().getTime()+this.startTyreChangeWindowHour*60*60*1e3;return new Date(n)}});closingTime=Ud(()=>{let e=this.activeRace();if(e){let n=e.start.toDate().getTime()+this.endTyreChangeWindowHour*60*60*1e3;return new Date(n)}});constructor(){this.activeRace=this.raceService.activeRace,this.intervalId=setInterval(()=>{let e=new Date,n=this.openingTime(),r=this.closingTime();n&&r?this.isOpen=e>=n&&e<=r:this.isOpen=!1},1e3),this.remainingTyreChange=this.raceConfigService.get().minTyreChange,this.pitService.getRacePits().pipe($E()).subscribe(e=>{let n=e.filter(r=>r.tyreChange).length;this.remainingTyreChange=this.minTyreChange-n})}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId),this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ni({type:t,selectors:[["app-tyre-window"]],standalone:!0,features:[ii],decls:22,vars:4,consts:[[1,"bg-white","shadow-md","rounded-lg","p-4","max-w-md","mx-auto","border","hover:shadow-2xl"],[1,"flex","justify-between","items-center","mb-2"],[1,"text-xl","font-bold"],[1,"bg-green-500","p-2","rounded-lg","text-white","font-semibold"],[1,"bg-red-500","p-2","rounded-lg","text-white","font-semibold"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"flex","justify-center"],[1,"bg-yellow-500","p-2","rounded-lg","text-white","font-semibold"]],template:function(n,r){n&1&&(ot(0,"div",0)(1,"div",1)(2,"div",2),wt(3,"Tyre change window"),Qe(),ri(4,R3,2,0,"div",3)(5,N3,2,0,"div",4),Qe(),ot(6,"div",5)(7,"div")(8,"div",6),wt(9,"Opening Time"),Qe(),ot(10,"div",7),ri(11,P3,2,4)(12,M3,1,0),Qe()(),ot(13,"div")(14,"div",6),wt(15,"Closing Time"),Qe(),ot(16,"div",7),ri(17,x3,2,4)(18,k3,1,0),Qe()()(),ot(19,"div",8),ri(20,O3,2,1,"div",9)(21,F3,2,0,"div",3),Qe()()),n&2&&(wr(4),Qi(r.isOpen?4:5),wr(7),Qi(r.openingTime()?11:12),wr(6),Qi(r.closingTime()?17:18),wr(3),Qi(r.remainingTyreChange>0?20:21))},dependencies:[XS]})};var up=class t{driverService=M(sp);drivers$;constructor(){this.drivers$=this.driverService.getAll()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ni({type:t,selectors:[["app-root"]],standalone:!0,features:[ii],decls:9,vars:0,consts:[[1,"container","mx-auto"],[1,"container","px-4","py-2","flex","items-center","justify-between"],[1,"flex","items-center"],[1,"text-3xl","font-semibold"]],template:function(n,r){n&1&&(ot(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),wt(4,"\u{1F3CE}\uFE0F dash-boar \u{1F417}"),Qe()(),ot(5,"div"),Yi(6,"app-race"),Qe()(),Yi(7,"app-tyre-window"),Qe(),Yi(8,"router-outlet"))},dependencies:[R_,op,cp]})};aA(up,lk).catch(t=>console.error(t));
