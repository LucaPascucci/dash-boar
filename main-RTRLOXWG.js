import{$ as Pn,A as Gn,B as rr,C as wh,D as zt,E as BD,F as $D,G as Gr,H as Xo,I as Vl,J as Ul,K as jl,L as es,M as HD,N as qD,O as WD,P as zD,Q as Bl,R as va,S as Fe,T as Et,U as en,V as ir,W as Wv,X as Eh,Y as It,Z as $t,_ as pi,a as U,aa as GD,b as fe,ba as Ht,c as to,ca as Ih,d as y,da as te,e as $,ea as KD,f as fa,g as yh,h as kD,i as OD,j as FD,k as LD,l as no,m as qv,n as pa,o as ma,p as un,q as Ol,r as VD,s as Fl,t as _h,u as UD,v as Wr,w as jD,x as zr,y as ga,z as Ll}from"./chunk-TSZ4SNPW.js";function Qv(n,e){return Object.is(n,e)}var qt=null,$l=!1,Zv=1,kn=Symbol("SIGNAL");function Ae(n){let e=qt;return qt=n,e}function YD(){return qt}function s2(){return $l}var ts={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ch(n){if($l)throw new Error("");if(qt===null)return;qt.consumerOnSignalRead(n);let e=qt.nextProducerIndex++;if(Dh(qt),e<qt.producerNode.length&&qt.producerNode[e]!==n&&Hl(qt)){let t=qt.producerNode[e];bh(t,qt.producerIndexOfThis[e])}qt.producerNode[e]!==n&&(qt.producerNode[e]=n,qt.producerIndexOfThis[e]=Hl(qt)?XD(n,qt,e):0),qt.producerLastReadVersion[e]=n.version}function a2(){Zv++}function Jv(n){if(!(Hl(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Zv)){if(!n.producerMustRecompute(n)&&!Wl(n)){Kv(n);return}n.producerRecomputeValue(n),Kv(n)}}function QD(n){if(n.liveConsumerNode===void 0)return;let e=$l;$l=!0;try{for(let t of n.liveConsumerNode)t.dirty||JD(t)}finally{$l=e}}function ZD(){return qt?.consumerAllowSignalWrites!==!1}function JD(n){n.dirty=!0,QD(n),n.consumerMarkedDirty?.(n)}function Kv(n){n.dirty=!1,n.lastCleanEpoch=Zv}function ya(n){return n&&(n.nextProducerIndex=0),Ae(n)}function ql(n,e){if(Ae(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Hl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)bh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Wl(n){Dh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Jv(t),r!==t.version))return!0}return!1}function _a(n){if(Dh(n),Hl(n))for(let e=0;e<n.producerNode.length;e++)bh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function XD(n,e,t){if(eS(n),n.liveConsumerNode.length===0&&tS(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=XD(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function bh(n,e){if(eS(n),n.liveConsumerNode.length===1&&tS(n))for(let r=0;r<n.producerNode.length;r++)bh(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Dh(i),i.producerIndexOfThis[r]=e}}function Hl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Dh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function eS(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function tS(n){return n.producerNode!==void 0}function nS(n){let e=Object.create(c2);e.computation=n;let t=()=>{if(Jv(e),Ch(e),e.value===Th)throw e.error;return e.value};return t[kn]=e,t}var zv=Symbol("UNSET"),Gv=Symbol("COMPUTING"),Th=Symbol("ERRORED"),c2=fe(U({},ts),{value:zv,dirty:!0,error:null,equal:Qv,kind:"computed",producerMustRecompute(n){return n.value===zv||n.value===Gv},producerRecomputeValue(n){if(n.value===Gv)throw new Error("Detected cycle in computations.");let e=n.value;n.value=Gv;let t=ya(n),r,i=!1;try{r=n.computation(),Ae(null),i=e!==zv&&e!==Th&&r!==Th&&n.equal(e,r)}catch(o){r=Th,n.error=o}finally{ql(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function l2(){throw new Error}var rS=l2;function iS(){rS()}function oS(n){rS=n}var u2=null;function sS(n){let e=Object.create(Xv);e.value=n;let t=()=>(Ch(e),e.value);return t[kn]=e,t}function Sh(n,e){ZD()||iS(),n.equal(n.value,e)||(n.value=e,d2(n))}function aS(n,e){ZD()||iS(),Sh(n,e(n.value))}var Xv=fe(U({},ts),{equal:Qv,value:void 0,kind:"signal"});function d2(n){n.version++,a2(),QD(n),u2?.()}function cS(n,e,t){let r=Object.create(h2);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;let i=c=>{r.cleanupFn=c};function o(c){return c.fn===null&&c.schedule===null}function s(c){o(c)||(_a(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=Yv)}let a=()=>{if(r.fn===null)return;if(s2())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!Wl(r))return;r.hasRun=!0;let c=ya(r);try{r.cleanupFn(),r.cleanupFn=Yv,r.fn(i)}finally{ql(r,c)}};return r.ref={notify:()=>JD(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>s(r),[kn]:r},r.ref}var Yv=()=>{},h2=fe(U({},ts),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule!==null&&n.schedule(n.ref)},hasRun:!1,cleanupFn:Yv});function ye(n){return typeof n=="function"}function wa(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ah=wa(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ns(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ye(r))try{r()}catch(o){e=o instanceof Ah?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{lS(o)}catch(s){e=e??[],s instanceof Ah?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Ah(e)}}add(e){var t;if(e&&e!==this)if(this.closed)lS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ns(t,e)}remove(e){let{_finalizers:t}=this;t&&ns(t,e),e instanceof n&&e._removeParent(this)}};Tt.EMPTY=(()=>{let n=new Tt;return n.closed=!0,n})();var ey=Tt.EMPTY;function Rh(n){return n instanceof Tt||n&&"closed"in n&&ye(n.remove)&&ye(n.add)&&ye(n.unsubscribe)}function lS(n){ye(n)?n():n.unsubscribe()}var Tr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ea={setTimeout(n,e,...t){let{delegate:r}=Ea;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ea;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function xh(n){Ea.setTimeout(()=>{let{onUnhandledError:e}=Tr;if(e)e(n);else throw n})}function zl(){}var uS=ty("C",void 0,void 0);function dS(n){return ty("E",void 0,n)}function hS(n){return ty("N",n,void 0)}function ty(n,e,t){return{kind:n,value:e,error:t}}var rs=null;function Ia(n){if(Tr.useDeprecatedSynchronousErrorHandling){let e=!rs;if(e&&(rs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=rs;if(rs=null,t)throw r}}else n()}function fS(n){Tr.useDeprecatedSynchronousErrorHandling&&rs&&(rs.errorThrown=!0,rs.error=n)}var is=class extends Tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Rh(e)&&e.add(this)):this.destination=m2}static create(e,t,r){return new Ta(e,t,r)}next(e){this.isStopped?ry(hS(e),this):this._next(e)}error(e){this.isStopped?ry(dS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ry(uS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},f2=Function.prototype.bind;function ny(n,e){return f2.call(n,e)}var iy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Nh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Nh(r)}else Nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Nh(t)}}},Ta=class extends is{constructor(e,t,r){super();let i;if(ye(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Tr.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&ny(e.next,o),error:e.error&&ny(e.error,o),complete:e.complete&&ny(e.complete,o)}):i=e}this.destination=new iy(i)}};function Nh(n){Tr.useDeprecatedSynchronousErrorHandling?fS(n):xh(n)}function p2(n){throw n}function ry(n,e){let{onStoppedNotification:t}=Tr;t&&Ea.setTimeout(()=>t(n,e))}var m2={closed:!0,next:zl,error:p2,complete:zl};var Ca=typeof Symbol=="function"&&Symbol.observable||"@@observable";function En(n){return n}function Mh(...n){return oy(n)}function oy(n){return n.length===0?En:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var pe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=v2(t)?t:new Ta(t,r,i);return Ia(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=pS(r),new r((i,o)=>{let s=new Ta({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ca](){return this}pipe(...t){return oy(t)(this)}toPromise(t){return t=pS(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function pS(n){var e;return(e=n??Tr.Promise)!==null&&e!==void 0?e:Promise}function g2(n){return n&&ye(n.next)&&ye(n.error)&&ye(n.complete)}function v2(n){return n&&n instanceof is||g2(n)&&Rh(n)}function sy(n){return ye(n?.lift)}function Ce(n){return e=>{if(sy(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ee(n,e,t,r,i){return new Gl(n,e,t,r,i)}var Gl=class extends is{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ba(){return Ce((n,e)=>{let t=null;n._refCount++;let r=Ee(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Da=class extends pe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,sy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Tt;let t=this.getSubject();e.add(this.source.subscribe(Ee(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Tt.EMPTY)}return e}refCount(){return ba()(this)}};var mS=wa(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var st=(()=>{class n extends pe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ph(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new mS}next(t){Ia(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ia(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ia(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?ey:(this.currentObservers=null,o.push(t),new Tt(()=>{this.currentObservers=null,ns(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new pe;return t.source=this,t}}return n.create=(e,t)=>new Ph(e,t),n})(),Ph=class extends st{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:ey}};var tn=class extends st{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Kl={now(){return(Kl.delegate||Date).now()},delegate:void 0};var Yl=class extends st{constructor(e=1/0,t=1/0,r=Kl){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var kh=class extends Tt{constructor(e,t){super()}schedule(e,t=0){return this}};var Ql={setInterval(n,e,...t){let{delegate:r}=Ql;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Ql;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Sa=class extends kh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Ql.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Ql.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ns(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Aa=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Aa.now=Kl.now;var Ra=class extends Aa{constructor(e,t=Aa.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var xa=new Ra(Sa),ay=xa;var Oh=class extends Sa{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Fh=class extends Ra{};var cy=new Fh(Oh);var Kn=new pe(n=>n.complete());function Lh(n){return n&&ye(n.schedule)}function gS(n){return n[n.length-1]}function Vh(n){return ye(gS(n))?n.pop():void 0}function ro(n){return Lh(gS(n))?n.pop():void 0}function ly(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function yS(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(r.next(d))}catch(f){s(f)}}function c(d){try{u(r.throw(d))}catch(f){s(f)}}function u(d){d.done?o(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function vS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function os(n){return this instanceof os?(this.v=n,this):new os(n)}function _S(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(v){return function(w){return Promise.resolve(w).then(v,f)}}function a(v,w){r[v]&&(i[v]=function(P){return new Promise(function(N,L){o.push([v,P,N,L])>1||c(v,P)})},w&&(i[v]=w(i[v])))}function c(v,w){try{u(r[v](w))}catch(P){m(o[0][3],P)}}function u(v){v.value instanceof os?Promise.resolve(v.value.v).then(d,f):m(o[0][2],v)}function d(v){c("next",v)}function f(v){c("throw",v)}function m(v,w){v(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}function wS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof vS=="function"?vS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}}var Uh=n=>n&&typeof n.length=="number"&&typeof n!="function";function jh(n){return ye(n?.then)}function Bh(n){return ye(n[Ca])}function $h(n){return Symbol.asyncIterator&&ye(n?.[Symbol.asyncIterator])}function Hh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function y2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var qh=y2();function Wh(n){return ye(n?.[qh])}function zh(n){return _S(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield os(t.read());if(i)return yield os(void 0);yield yield os(r)}}finally{t.releaseLock()}})}function Gh(n){return ye(n?.getReader)}function Ct(n){if(n instanceof pe)return n;if(n!=null){if(Bh(n))return _2(n);if(Uh(n))return w2(n);if(jh(n))return E2(n);if($h(n))return ES(n);if(Wh(n))return I2(n);if(Gh(n))return T2(n)}throw Hh(n)}function _2(n){return new pe(e=>{let t=n[Ca]();if(ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function w2(n){return new pe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function E2(n){return new pe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,xh)})}function I2(n){return new pe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function ES(n){return new pe(e=>{C2(n,e).catch(t=>e.error(t))})}function T2(n){return ES(zh(n))}function C2(n,e){var t,r,i,o;return yS(this,void 0,void 0,function*(){try{for(t=wS(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function On(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function io(n,e=0){return Ce((t,r)=>{t.subscribe(Ee(r,i=>On(r,n,()=>r.next(i),e),()=>On(r,n,()=>r.complete(),e),i=>On(r,n,()=>r.error(i),e)))})}function oo(n,e=0){return Ce((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function IS(n,e){return Ct(n).pipe(oo(e),io(e))}function TS(n,e){return Ct(n).pipe(oo(e),io(e))}function CS(n,e){return new pe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function bS(n,e){return new pe(t=>{let r;return On(t,e,()=>{r=n[qh](),On(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>ye(r?.return)&&r.return()})}function Kh(n,e){if(!n)throw new Error("Iterable cannot be null");return new pe(t=>{On(t,e,()=>{let r=n[Symbol.asyncIterator]();On(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function DS(n,e){return Kh(zh(n),e)}function SS(n,e){if(n!=null){if(Bh(n))return IS(n,e);if(Uh(n))return CS(n,e);if(jh(n))return TS(n,e);if($h(n))return Kh(n,e);if(Wh(n))return bS(n,e);if(Gh(n))return DS(n,e)}throw Hh(n)}function lt(n,e){return e?SS(n,e):Ct(n)}function se(...n){let e=ro(n);return lt(n,e)}function Na(n,e){let t=ye(n)?n:()=>n,r=i=>i.error(t());return new pe(e?i=>e.schedule(r,0,i):r)}function uy(n){return!!n&&(n instanceof pe||ye(n.lift)&&ye(n.subscribe))}var mi=wa(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function AS(n){return n instanceof Date&&!isNaN(n)}function ee(n,e){return Ce((t,r)=>{let i=0;t.subscribe(Ee(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:b2}=Array;function D2(n,e){return b2(e)?n(...e):n(e)}function Yh(n){return ee(e=>D2(n,e))}var{isArray:S2}=Array,{getPrototypeOf:A2,prototype:R2,keys:x2}=Object;function Qh(n){if(n.length===1){let e=n[0];if(S2(e))return{args:e,keys:null};if(N2(e)){let t=x2(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function N2(n){return n&&typeof n=="object"&&A2(n)===R2}function Zh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function qe(...n){let e=ro(n),t=Vh(n),{args:r,keys:i}=Qh(n);if(r.length===0)return lt([],e);let o=new pe(M2(r,e,i?s=>Zh(i,s):En));return t?o.pipe(Yh(t)):o}function M2(n,e,t=En){return r=>{RS(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)RS(e,()=>{let u=lt(n[c],e),d=!1;u.subscribe(Ee(r,f=>{o[c]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function RS(n,e,t){n?On(t,n,e):e()}function xS(n,e,t,r,i,o,s,a){let c=[],u=0,d=0,f=!1,m=()=>{f&&!c.length&&!u&&e.complete()},v=P=>u<r?w(P):c.push(P),w=P=>{o&&e.next(P),u++;let N=!1;Ct(t(P,d++)).subscribe(Ee(e,L=>{i?.(L),o?v(L):e.next(L)},()=>{N=!0},void 0,()=>{if(N)try{for(u--;c.length&&u<r;){let L=c.shift();s?On(e,s,()=>w(L)):w(L)}m()}catch(L){e.error(L)}}))};return n.subscribe(Ee(e,v,()=>{f=!0,m()})),()=>{a?.()}}function St(n,e,t=1/0){return ye(e)?St((r,i)=>ee((o,s)=>e(r,o,i,s))(Ct(n(r,i))),t):(typeof e=="number"&&(t=e),Ce((r,i)=>xS(r,i,n,t)))}function dy(n=1/0){return St(En,n)}function NS(){return dy(1)}function Ma(...n){return NS()(lt(n,ro(n)))}function Jh(n){return new pe(e=>{Ct(n()).subscribe(e)})}function hy(...n){let e=Vh(n),{args:t,keys:r}=Qh(n),i=new pe(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,u=s;for(let d=0;d<s;d++){let f=!1;Ct(t[d]).subscribe(Ee(o,m=>{f||(f=!0,u--),a[d]=m},()=>c--,void 0,()=>{(!c||!f)&&(u||o.next(r?Zh(r,a):a),o.complete())}))}});return e?i.pipe(Yh(e)):i}function fy(n=0,e,t=ay){let r=-1;return e!=null&&(Lh(e)?t=e:r=e),new pe(i=>{let o=AS(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function At(n=0,e=xa){return n<0&&(n=0),fy(n,n,e)}function In(n,e){return Ce((t,r)=>{let i=0;t.subscribe(Ee(r,o=>n.call(e,o,i++)&&r.next(o)))})}function so(n){return Ce((e,t)=>{let r=null,i=!1,o;r=e.subscribe(Ee(t,void 0,void 0,s=>{o=Ct(n(s,so(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function MS(n,e,t,r,i){return(o,s)=>{let a=t,c=e,u=0;o.subscribe(Ee(s,d=>{let f=u++;c=a?n(c,d,f):(a=!0,d),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function ss(n,e){return ye(e)?St(n,e,1):St(n,1)}function ao(n){return Ce((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Kr(n){return n<=0?()=>Kn:Ce((e,t)=>{let r=0;e.subscribe(Ee(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Xh(n,e=En){return n=n??P2,Ce((t,r)=>{let i,o=!0;t.subscribe(Ee(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function P2(n,e){return n===e}function ef(n=k2){return Ce((e,t)=>{let r=!1;e.subscribe(Ee(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function k2(){return new mi}function Zl(n){return Ce((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function gi(n,e){let t=arguments.length>=2;return r=>r.pipe(n?In((i,o)=>n(i,o,r)):En,Kr(1),t?ao(e):ef(()=>new mi))}function py(n,e,t,r){return Ce((i,o)=>{let s;!e||typeof e=="function"?s=e:{duration:t,element:s,connector:r}=e;let a=new Map,c=w=>{a.forEach(w),w(o)},u=w=>c(P=>P.error(w)),d=0,f=!1,m=new Gl(o,w=>{try{let P=n(w),N=a.get(P);if(!N){a.set(P,N=r?r():new st);let L=v(P,N);if(o.next(L),t){let q=Ee(N,()=>{N.complete(),q?.unsubscribe()},void 0,void 0,()=>a.delete(P));m.add(Ct(t(L)).subscribe(q))}}N.next(s?s(w):w)}catch(P){u(P)}},()=>c(w=>w.complete()),u,()=>a.clear(),()=>(f=!0,d===0));i.subscribe(m);function v(w,P){let N=new pe(L=>{d++;let q=P.subscribe(L);return()=>{q.unsubscribe(),--d===0&&f&&m.unsubscribe()}});return N.key=w,N}})}function Pa(n){return n<=0?()=>Kn:Ce((e,t)=>{let r=[];e.subscribe(Ee(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function my(n,e){let t=arguments.length>=2;return r=>r.pipe(n?In((i,o)=>n(i,o,r)):En,Pa(1),t?ao(e):ef(()=>new mi))}function tf(){return Ce((n,e)=>{let t,r=!1;n.subscribe(Ee(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function nf(n,e){return Ce(MS(n,e,arguments.length>=2,!0))}function ka(...n){let e=ro(n);return Ce((t,r)=>{(e?Ma(n,t,e):Ma(n,t)).subscribe(r)})}function Fn(n,e){return Ce((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(Ee(r,c=>{i?.unsubscribe();let u=0,d=o++;Ct(n(c,d)).subscribe(i=Ee(r,f=>r.next(e?e(c,f,d,u++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Gt(n){return Ce((e,t)=>{Ct(n).subscribe(Ee(t,()=>t.complete(),zl)),!t.closed&&e.subscribe(t)})}function nn(n,e,t){let r=ye(n)||e||t?{next:n,error:e,complete:t}:n;return r?Ce((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Ee(o,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),o.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):En}var O2="https://g.co/ng/security#xss",Z=class extends Error{code;constructor(e,t){super(C_(e,t)),this.code=e}};function C_(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}var vA=Symbol("InputSignalNode#UNSET"),F2=fe(U({},Xv),{transformFn:void 0,applyValueToInputSignal(n,e){Sh(n,e)}});function yA(n,e){let t=Object.create(F2);t.value=n,t.transformFn=e?.transform;function r(){if(Ch(t),t.value===vA)throw new Z(-950,!1);return t.value}return r[kn]=t,r}function pu(n){return{toString:n}.toString()}var rf="__parameters__";function L2(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function _A(n,e,t){return pu(()=>{let r=L2(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,u,d){let f=c.hasOwnProperty(rf)?c[rf]:Object.defineProperty(c,rf,{value:[]})[rf];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Xl=globalThis;function Ze(n){for(let e in n)if(n[e]===Ze)return e;throw Error("Could not find renamed property on target object.")}function V2(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Vn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Vn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function PS(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var U2=Ze({__forward_ref__:Ze});function ar(n){return n.__forward_ref__=ar,n.toString=function(){return Vn(this())},n}function Tn(n){return wA(n)?n():n}function wA(n){return typeof n=="function"&&n.hasOwnProperty(U2)&&n.__forward_ref__===ar}function j(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function wo(n){return{providers:n.providers||[],imports:n.imports||[]}}function Uf(n){return kS(n,IA)||kS(n,TA)}function EA(n){return Uf(n)!==null}function kS(n,e){return n.hasOwnProperty(e)?n[e]:null}function j2(n){let e=n&&(n[IA]||n[TA]);return e||null}function OS(n){return n&&(n.hasOwnProperty(FS)||n.hasOwnProperty(B2))?n[FS]:null}var IA=Ze({\u0275prov:Ze}),FS=Ze({\u0275inj:Ze}),TA=Ze({ngInjectableDef:Ze}),B2=Ze({ngInjectorDef:Ze}),W=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=j({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function CA(n){return n&&!!n.\u0275providers}var $2=Ze({\u0275cmp:Ze}),H2=Ze({\u0275dir:Ze}),q2=Ze({\u0275pipe:Ze}),W2=Ze({\u0275mod:Ze}),ff=Ze({\u0275fac:Ze}),nu=Ze({__NG_ELEMENT_ID__:Ze}),LS=Ze({__NG_ENV_ID__:Ze});function b_(n){return typeof n=="string"?n:n==null?"":String(n)}function z2(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():b_(n)}function G2(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Z(-200,n)}function D_(n,e){throw new Z(-201,!1)}var De=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(De||{}),Ry;function bA(){return Ry}function Ln(n){let e=Ry;return Ry=n,e}function DA(n,e,t){let r=Uf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&De.Optional)return null;if(e!==void 0)return e;D_(n,"Injector")}var K2={},ru=K2,xy="__NG_DI_FLAG__",pf="ngTempTokenPath",Y2="ngTokenPath",Q2=/\n/gm,Z2="\u0275",VS="__source",Va;function J2(){return Va}function co(n){let e=Va;return Va=n,e}function X2(n,e=De.Default){if(Va===void 0)throw new Z(-203,!1);return Va===null?DA(n,void 0,e):Va.get(n,e&De.Optional?null:void 0,e)}function de(n,e=De.Default){return(bA()||X2)(Tn(n),e)}function S(n,e=De.Default){return de(n,jf(e))}function jf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ny(n){let e=[];for(let t=0;t<n.length;t++){let r=Tn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Z(900,!1);let i,o=De.Default;for(let s=0;s<r.length;s++){let a=r[s],c=eU(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(de(i,o))}else e.push(de(r))}return e}function SA(n,e){return n[xy]=e,n.prototype[xy]=e,n}function eU(n){return n[xy]}function tU(n,e,t,r){let i=n[pf];throw e[VS]&&i.unshift(e[VS]),n.message=nU(`
`+n.message,i,t,r),n[Y2]=i,n[pf]=null,n}function nU(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==Z2?n.slice(2):n;let i=Vn(e);if(Array.isArray(e))i=e.map(Vn).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Vn(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Q2,`
  `)}`}var Ie=SA(_A("Optional"),8);var rU=SA(_A("SkipSelf"),4);function ls(n,e){let t=n.hasOwnProperty(ff);return t?n[ff]:null}function S_(n,e){n.forEach(t=>Array.isArray(t)?S_(t,e):e(t))}function AA(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function mf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function iU(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function oU(n,e,t){let r=mu(n,e);return r>=0?n[r|1]=t:(r=~r,iU(n,r,e,t)),r}function gy(n,e){let t=mu(n,e);if(t>=0)return n[t|1]}function mu(n,e){return sU(n,e,1)}function sU(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var ja={},or=[],Ba=new W(""),RA=new W("",-1),xA=new W(""),gf=class{get(e,t=ru){if(t===ru){let r=new Error(`NullInjectorError: No provider for ${Vn(e)}!`);throw r.name="NullInjectorError",r}return t}};function NA(n,e){let t=n[W2]||null;if(!t&&e===!0)throw new Error(`Type ${Vn(n)} does not have '\u0275mod' property.`);return t}function us(n){return n[$2]||null}function MA(n){return n[H2]||null}function PA(n){return n[q2]||null}function kA(n){let e=us(n)||MA(n)||PA(n);return e!==null&&e.standalone}function ut(n){return{\u0275providers:n}}function aU(...n){return{\u0275providers:OA(!0,n),\u0275fromNgModule:!0}}function OA(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return S_(e,s=>{let a=s;My(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&FA(i,o),t}function FA(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];A_(i,o=>{e(o,r)})}}function My(n,e,t,r){if(n=Tn(n),!n)return!1;let i=null,o=OS(n),s=!o&&us(n);if(!o&&!s){let c=n.ngModule;if(o=OS(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of c)My(u,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let u;try{S_(o.imports,d=>{My(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&FA(u,e)}if(!a){let u=ls(i)||(()=>new i);e({provide:i,useFactory:u,deps:or},i),e({provide:xA,useValue:i,multi:!0},i),e({provide:Ba,useValue:()=>de(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let u=n;A_(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function A_(n,e){for(let t of n)CA(t)&&(t=t.\u0275providers),Array.isArray(t)?A_(t,e):e(t)}var cU=Ze({provide:String,useValue:Ze});function LA(n){return n!==null&&typeof n=="object"&&cU in n}function lU(n){return!!(n&&n.useExisting)}function uU(n){return!!(n&&n.useFactory)}function $a(n){return typeof n=="function"}function dU(n){return!!n.useClass}var Bf=new W(""),af={},hU={},vy;function R_(){return vy===void 0&&(vy=new gf),vy}var Un=class{},iu=class extends Un{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,ky(e,s=>this.processProvider(s)),this.records.set(RA,Oa(void 0,this)),i.has("environment")&&this.records.set(Un,Oa(void 0,this));let o=this.records.get(Bf);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(xA,or,De.Self))}destroy(){eu(this),this._destroyed=!0;let e=Ae(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ae(e)}}onDestroy(e){return eu(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){eu(this);let t=co(this),r=Ln(void 0),i;try{return e()}finally{co(t),Ln(r)}}get(e,t=ru,r=De.Default){if(eu(this),e.hasOwnProperty(LS))return e[LS](this);r=jf(r);let i,o=co(this),s=Ln(void 0);try{if(!(r&De.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=vU(e)&&Uf(e);u&&this.injectableDefInScope(u)?c=Oa(Py(e),af):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&De.Self?R_():this.parent;return t=r&De.Optional&&t===ru?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[pf]=a[pf]||[]).unshift(Vn(e)),o)throw a;return tU(a,e,"R3InjectorError",this.source)}else throw a}finally{Ln(s),co(o)}}resolveInjectorInitializers(){let e=Ae(null),t=co(this),r=Ln(void 0),i;try{let o=this.get(Ba,or,De.Self);for(let s of o)s()}finally{co(t),Ln(r),Ae(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Vn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Tn(e);let t=$a(e)?e:Tn(e&&e.provide),r=pU(e);if(!$a(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Oa(void 0,af,!0),i.factory=()=>Ny(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ae(null);try{return t.value===af&&(t.value=hU,t.value=t.factory()),typeof t.value=="object"&&t.value&&gU(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ae(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Tn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Py(n){let e=Uf(n),t=e!==null?e.factory:ls(n);if(t!==null)return t;if(n instanceof W)throw new Z(204,!1);if(n instanceof Function)return fU(n);throw new Z(204,!1)}function fU(n){if(n.length>0)throw new Z(204,!1);let t=j2(n);return t!==null?()=>t.factory(n):()=>new n}function pU(n){if(LA(n))return Oa(void 0,n.useValue);{let e=VA(n);return Oa(e,af)}}function VA(n,e,t){let r;if($a(n)){let i=Tn(n);return ls(i)||Py(i)}else if(LA(n))r=()=>Tn(n.useValue);else if(uU(n))r=()=>n.useFactory(...Ny(n.deps||[]));else if(lU(n))r=()=>de(Tn(n.useExisting));else{let i=Tn(n&&(n.useClass||n.provide));if(mU(n))r=()=>new i(...Ny(n.deps));else return ls(i)||Py(i)}return r}function eu(n){if(n.destroyed)throw new Z(205,!1)}function Oa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function mU(n){return!!n.deps}function gU(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function vU(n){return typeof n=="function"||typeof n=="object"&&n instanceof W}function ky(n,e){for(let t of n)Array.isArray(t)?ky(t,e):t&&CA(t)?ky(t.\u0275providers,e):e(t)}function Sn(n,e){n instanceof iu&&eu(n);let t,r=co(n),i=Ln(void 0);try{return e()}finally{co(r),Ln(i)}}function UA(){return bA()!==void 0||J2()!=null}function Qa(n){if(!UA())throw new Z(-203,!1)}function yU(n){return typeof n=="function"}var wi=0,be=1,ue=2,Dn=3,br=4,Sr=5,ou=6,vf=7,dn=8,Ha=9,ho=10,Mt=11,su=12,US=13,Za=14,Dr=15,qa=16,Fa=17,Wa=18,$f=19,jA=20,lo=21,cf=22,ds=23,Yn=24,Cn=25,BA=1;var hs=7,yf=8,_f=9,bn=10;function uo(n){return Array.isArray(n)&&typeof n[BA]=="object"}function Ei(n){return Array.isArray(n)&&n[BA]===!0}function x_(n){return(n.flags&4)!==0}function Hf(n){return n.componentOffset>-1}function qf(n){return(n.flags&1)===1}function fo(n){return!!n.template}function Oy(n){return(n[ue]&512)!==0}function gu(n){return(n[ue]&256)===256}var Fy=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function $A(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Eo=(()=>{let n=()=>HA;return n.ngInherit=!0,n})();function HA(n){return n.type.prototype.ngOnChanges&&(n.setInput=wU),_U}function _U(){let n=WA(this),e=n?.current;if(e){let t=n.previous;if(t===ja)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function wU(n,e,t,r,i){let o=this.declaredInputs[r],s=WA(n)||EU(n,{previous:ja,current:null}),a=s.current||(s.current={}),c=s.previous,u=c[o];a[o]=new Fy(u&&u.currentValue,t,c===ja),$A(n,e,i,t)}var qA="__ngSimpleChanges__";function WA(n){return n[qA]||null}function EU(n,e){return n[qA]=e}var jS=null;var sr=function(n,e,t){jS?.(n,e,t)},IU="svg",TU="math";function Qr(n){for(;Array.isArray(n);)n=n[wi];return n}function zA(n,e){return Qr(e[n])}function cr(n,e){return Qr(e[n.index])}function N_(n,e){return n.data[e]}function CU(n,e){return n[e]}function Io(n,e){let t=e[n];return uo(t)?t:t[wi]}function M_(n){return(n[ue]&128)===128}function bU(n){return Ei(n[Dn])}function po(n,e){return e==null?null:n[e]}function GA(n){n[Fa]=0}function P_(n){n[ue]&1024||(n[ue]|=1024,M_(n)&&vu(n))}function DU(n,e){for(;n>0;)e=e[Za],n--;return e}function Wf(n){return!!(n[ue]&9216||n[Yn]?.dirty)}function Ly(n){n[ho].changeDetectionScheduler?.notify(9),n[ue]&64&&(n[ue]|=1024),Wf(n)&&vu(n)}function vu(n){n[ho].changeDetectionScheduler?.notify(0);let e=fs(n);for(;e!==null&&!(e[ue]&8192||(e[ue]|=8192,!M_(e)));)e=fs(e)}function KA(n,e){if(gu(n))throw new Z(911,!1);n[lo]===null&&(n[lo]=[]),n[lo].push(e)}function SU(n,e){if(n[lo]===null)return;let t=n[lo].indexOf(e);t!==-1&&n[lo].splice(t,1)}function fs(n){let e=n[Dn];return Ei(e)?e[Dn]:e}function AU(n){return n[vf]??=[]}function RU(n){return n.cleanup??=[]}var Ne={lFrame:nR(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Vy=!1;function xU(){return Ne.lFrame.elementDepthCount}function NU(){Ne.lFrame.elementDepthCount++}function MU(){Ne.lFrame.elementDepthCount--}function YA(){return Ne.bindingsEnabled}function PU(){return Ne.skipHydrationRootTNode!==null}function kU(n){return Ne.skipHydrationRootTNode===n}function OU(){Ne.skipHydrationRootTNode=null}function Le(){return Ne.lFrame.lView}function rn(){return Ne.lFrame.tView}function ft(n){return Ne.lFrame.contextLView=n,n[dn]}function pt(n){return Ne.lFrame.contextLView=null,n}function hn(){let n=QA();for(;n!==null&&n.type===64;)n=n.parent;return n}function QA(){return Ne.lFrame.currentTNode}function FU(){let n=Ne.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function _s(n,e){let t=Ne.lFrame;t.currentTNode=n,t.isParent=e}function k_(){return Ne.lFrame.isParent}function ZA(){Ne.lFrame.isParent=!1}function JA(){return Vy}function wf(n){let e=Vy;return Vy=n,e}function O_(){let n=Ne.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function LU(n){return Ne.lFrame.bindingIndex=n}function Ja(){return Ne.lFrame.bindingIndex++}function VU(n){let e=Ne.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function UU(){return Ne.lFrame.inI18n}function jU(n,e){let t=Ne.lFrame;t.bindingIndex=t.bindingRootIndex=n,Uy(e)}function BU(){return Ne.lFrame.currentDirectiveIndex}function Uy(n){Ne.lFrame.currentDirectiveIndex=n}function $U(n){let e=Ne.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function XA(n){Ne.lFrame.currentQueryIndex=n}function HU(n){let e=n[be];return e.type===2?e.declTNode:e.type===1?n[Sr]:null}function eR(n,e,t){if(t&De.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&De.Host);)if(i=HU(o),i===null||(o=o[Za],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ne.lFrame=tR();return r.currentTNode=e,r.lView=n,!0}function F_(n){let e=tR(),t=n[be];Ne.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tR(){let n=Ne.lFrame,e=n===null?null:n.child;return e===null?nR(n):e}function nR(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function rR(){let n=Ne.lFrame;return Ne.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var iR=rR;function L_(){let n=rR();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function qU(n){return(Ne.lFrame.contextLView=DU(n,Ne.lFrame.contextLView))[dn]}function ws(){return Ne.lFrame.selectedIndex}function ps(n){Ne.lFrame.selectedIndex=n}function V_(){let n=Ne.lFrame;return N_(n.tView,n.selectedIndex)}function WU(){return Ne.lFrame.currentNamespace}var oR=!0;function zf(){return oR}function Gf(n){oR=n}function zU(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=HA(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Kf(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function lf(n,e,t){sR(n,e,3,t)}function uf(n,e,t,r){(n[ue]&3)===t&&sR(n,e,t,r)}function yy(n,e){let t=n[ue];(t&3)===e&&(t&=16383,t+=1,n[ue]=t)}function sR(n,e,t,r){let i=r!==void 0?n[Fa]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Fa]+=65536),(a<o||o==-1)&&(GU(n,t,e,c),n[Fa]=(n[Fa]&4294901760)+c+2),c++}function BS(n,e){sr(4,n,e);let t=Ae(null);try{e.call(n)}finally{Ae(t),sr(5,n,e)}}function GU(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ue]>>14<n[Fa]>>16&&(n[ue]&3)===e&&(n[ue]+=16384,BS(a,o)):BS(a,o)}var Ua=-1,ms=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function KU(n){return n instanceof ms}function YU(n){return(n.flags&8)!==0}function QU(n){return(n.flags&16)!==0}function ZU(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];XU(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function JU(n){return n===3||n===4||n===6}function XU(n){return n.charCodeAt(0)===64}function za(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?$S(n,t,i,null,e[++r]):$S(n,t,i,null,null))}}return n}function $S(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var _y={},jy=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=jf(r);let i=this.injector.get(e,_y,r);return i!==_y||t===_y?i:this.parentInjector.get(e,t,r)}};function aR(n){return n!==Ua}function Ef(n){return n&32767}function ej(n){return n>>16}function If(n,e){let t=ej(n),r=e;for(;t>0;)r=r[Za],t--;return r}var By=!0;function Tf(n){let e=By;return By=n,e}var tj=256,cR=tj-1,lR=5,nj=0,Yr={};function rj(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(nu)&&(r=t[nu]),r==null&&(r=t[nu]=nj++);let i=r&cR,o=1<<i;e.data[n+(i>>lR)]|=o}function Cf(n,e){let t=uR(n,e);if(t!==-1)return t;let r=e[be];r.firstCreatePass&&(n.injectorIndex=e.length,wy(r.data,n),wy(e,null),wy(r.blueprint,null));let i=U_(n,e),o=n.injectorIndex;if(aR(i)){let s=Ef(i),a=If(i,e),c=a[be].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|c[s+u]}return e[o+8]=i,o}function wy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function uR(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function U_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=mR(i),r===null)return Ua;if(t++,i=i[Za],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ua}function $y(n,e,t){rj(n,e,t)}function dR(n,e,t){if(t&De.Optional||n!==void 0)return n;D_(e,"NodeInjector")}function hR(n,e,t,r){if(t&De.Optional&&r===void 0&&(r=null),!(t&(De.Self|De.Host))){let i=n[Ha],o=Ln(void 0);try{return i?i.get(e,r,t&De.Optional):DA(e,r,t&De.Optional)}finally{Ln(o)}}return dR(r,e,t)}function fR(n,e,t,r=De.Default,i){if(n!==null){if(e[ue]&2048&&!(r&De.Self)){let s=cj(n,e,t,r,Yr);if(s!==Yr)return s}let o=pR(n,e,t,r,Yr);if(o!==Yr)return o}return hR(e,t,r,i)}function pR(n,e,t,r,i){let o=sj(t);if(typeof o=="function"){if(!eR(e,n,r))return r&De.Host?dR(i,t,r):hR(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&De.Optional))D_(t);else return s}finally{iR()}}else if(typeof o=="number"){let s=null,a=uR(n,e),c=Ua,u=r&De.Host?e[Dr][Sr]:null;for((a===-1||r&De.SkipSelf)&&(c=a===-1?U_(n,e):e[a+8],c===Ua||!qS(r,!1)?a=-1:(s=e[be],a=Ef(c),e=If(c,e)));a!==-1;){let d=e[be];if(HS(o,a,d.data)){let f=ij(a,e,t,s,r,u);if(f!==Yr)return f}c=e[a+8],c!==Ua&&qS(r,e[be].data[a+8]===u)&&HS(o,a,e)?(s=d,a=Ef(c),e=If(c,e)):a=-1}}return i}function ij(n,e,t,r,i,o){let s=e[be],a=s.data[n+8],c=r==null?Hf(a)&&By:r!=s&&(a.type&3)!==0,u=i&De.Host&&o===a,d=oj(a,s,t,c,u);return d!==null?Ga(e,s,d,a):Yr}function oj(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,u=n.directiveEnd,d=o>>20,f=r?a:a+d,m=i?a+d:u;for(let v=f;v<m;v++){let w=s[v];if(v<c&&t===w||v>=c&&w.type===t)return v}if(i){let v=s[c];if(v&&fo(v)&&v.type===t)return c}return null}function Ga(n,e,t,r){let i=n[t],o=e.data;if(KU(i)){let s=i;s.resolving&&G2(z2(o[t]));let a=Tf(s.canSeeViewProviders);s.resolving=!0;let c,u=s.injectImpl?Ln(s.injectImpl):null,d=eR(n,r,De.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&zU(t,o[t],e)}finally{u!==null&&Ln(u),Tf(a),s.resolving=!1,iR()}}return i}function sj(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(nu)?n[nu]:void 0;return typeof e=="number"?e>=0?e&cR:aj:e}function HS(n,e,t){let r=1<<n;return!!(t[e+(n>>lR)]&r)}function qS(n,e){return!(n&De.Self)&&!(n&De.Host&&e)}var cs=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return fR(this._tNode,this._lView,e,jf(r),t)}};function aj(){return new cs(hn(),Le())}function Ar(n){return pu(()=>{let e=n.prototype.constructor,t=e[ff]||Hy(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[ff]||Hy(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Hy(n){return wA(n)?()=>{let e=Hy(Tn(n));return e&&e()}:ls(n)}function cj(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ue]&2048&&!(s[ue]&512);){let a=pR(o,s,t,r|De.Self,Yr);if(a!==Yr)return a;let c=o.parent;if(!c){let u=s[jA];if(u){let d=u.get(t,Yr,r);if(d!==Yr)return d}c=mR(s),s=s[Za]}o=c}return i}function mR(n){let e=n[be],t=e.type;return t===2?e.declTNode:t===1?n[Sr]:null}function WS(n,e=null,t=null,r){let i=gR(n,e,t,r);return i.resolveInjectorInitializers(),i}function gR(n,e=null,t=null,r,i=new Set){let o=[t||or,aU(n)];return r=r||(typeof n=="object"?void 0:Vn(n)),new iu(o,e||R_(),r||null,i)}var Se=class n{static THROW_IF_NOT_FOUND=ru;static NULL=new gf;static create(e,t){if(Array.isArray(e))return WS({name:""},t,e,"");{let r=e.name??"";return WS({name:r},e.parent,e.providers,r)}}static \u0275prov=j({token:n,providedIn:"any",factory:()=>de(RA)});static __NG_ELEMENT_ID__=-1};var lj=new W("");lj.__NG_ELEMENT_ID__=n=>{let e=hn();if(e===null)throw new Z(204,!1);if(e.type&2)return e.value;if(n&De.Optional)return null;throw new Z(204,!1)};var vR=!1,Ii=(()=>{class n{static __NG_ELEMENT_ID__=uj;static __NG_ENV_ID__=t=>t}return n})(),bf=class extends Ii{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return KA(this._lView,e),()=>SU(this._lView,e)}};function uj(){return new bf(Le())}var gs=class{},Yf=new W("",{providedIn:"root",factory:()=>!1});var yR=new W(""),_R=new W(""),To=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new tn(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),Qf=(()=>{class n{internalPendingTasks=S(To);scheduler=S(gs);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(12),this.internalPendingTasks.remove(t))}}run(t){return y(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),qy=class extends st{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,UA()&&(this.destroyRef=S(Ii,{optional:!0})??void 0,this.pendingTasks=S(To,{optional:!0})??void 0)}emit(e){let t=Ae(null);try{super.next(e)}finally{Ae(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Tt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Kt=qy;function au(...n){}function wR(n){let e,t;function r(){n=au;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function zS(n){return queueMicrotask(()=>n()),()=>{n=au}}var j_="isAngularZone",Df=j_+"_ID",dj=0,me=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Kt(!1);onMicrotaskEmpty=new Kt(!1);onStable=new Kt(!1);onError=new Kt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=vR}=e;if(typeof Zone>"u")throw new Z(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,pj(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(j_)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Z(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Z(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,hj,au,au);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},hj={};function B_(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function fj(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){wR(()=>{n.callbackScheduled=!1,Wy(n),n.isCheckStableRunning=!0,B_(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Wy(n)}function pj(n){let e=()=>{fj(n)},t=dj++;n._inner=n._inner.fork({name:"angular",properties:{[j_]:!0,[Df]:t,[Df+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(mj(c))return r.invokeTask(o,s,a,c);try{return GS(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),KS(n)}},onInvoke:(r,i,o,s,a,c,u)=>{try{return GS(n),r.invoke(o,s,a,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!gj(c)&&e(),KS(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Wy(n),B_(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Wy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function GS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function KS(n){n._nesting--,B_(n)}var zy=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Kt;onMicrotaskEmpty=new Kt;onStable=new Kt;onError=new Kt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function mj(n){return ER(n,"__ignore_ng_zone__")}function gj(n){return ER(n,"__scheduler_tick__")}function ER(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var vi=class{_console=console;handleError(e){this._console.error("ERROR",e)}},vj=new W("",{providedIn:"root",factory:()=>{let n=S(me),e=S(vi);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function YS(n,e){return yA(n,e)}function yj(n){return yA(vA,n)}var IR=(YS.required=yj,YS);function _j(){return Zf(hn(),Le())}function Zf(n,e){return new lr(cr(n,e))}var lr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=_j}return n})();var QS=new Set;function Ti(n){QS.has(n)||(QS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function wj(n){return typeof n=="function"&&n[kn]!==void 0}function J(n,e){Ti("NgSignals");let t=sS(n),r=t[kn];return e?.equal&&(r.equal=e.equal),t.set=i=>Sh(r,i),t.update=i=>aS(r,i),t.asReadonly=Ej.bind(t),t}function Ej(){let n=this[kn];if(n.readonlyFn===void 0){let e=()=>this();e[kn]=n,n.readonlyFn=e}return n.readonlyFn}function TR(n){return wj(n)&&typeof n.set=="function"}function CR(n){return(n.flags&128)===128}var bR=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(bR||{}),DR=new Map,Ij=0;function Tj(){return Ij++}function Cj(n){DR.set(n[$f],n)}function Gy(n){DR.delete(n[$f])}var ZS="__ngContext__";function mo(n,e){uo(e)?(n[ZS]=e[$f],Cj(e)):n[ZS]=e}function SR(n){return RR(n[su])}function AR(n){return RR(n[br])}function RR(n){for(;n!==null&&!Ei(n);)n=n[br];return n}var Ky;function xR(n){Ky=n}function bj(){if(Ky!==void 0)return Ky;if(typeof document<"u")return document;throw new Z(210,!1)}var $_=new W("",{providedIn:"root",factory:()=>Dj}),Dj="ng",H_=new W(""),Pt=new W("",{providedIn:"platform",factory:()=>"unknown"});var q_=new W("",{providedIn:"root",factory:()=>bj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Sj="h",Aj="b";var NR=!1,Rj=new W("",{providedIn:"root",factory:()=>NR});var MR=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(MR||{}),Jf=new W("");var xj=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})();var Nj=()=>null;function W_(n,e,t=!1){return Nj(n,e,t)}function PR(n,e){let t=n.contentQueries;if(t!==null){let r=Ae(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];XA(o),a.contentQueries(2,e[s],s)}}}finally{Ae(r)}}}function Yy(n,e,t){XA(0);let r=Ae(null);try{e(n,t)}finally{Ae(r)}}function z_(n,e,t){if(x_(e)){let r=Ae(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Ae(r)}}}var Zr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Zr||{});var Qy=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${O2})`}};function G_(n){return n instanceof Qy?n.changingThisBreaksApplicationSecurity:n}var Mj=/^>|^->|<!--|-->|--!>|<!-$/g,Pj=/(<|>)/g,kj="\u200B$1\u200B";function Oj(n){return n.replace(Mj,e=>e.replace(Pj,kj))}function kR(n){return n instanceof Function?n():n}var go=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(go||{});function Fj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var OR="ng-template";function Lj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Fj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(K_(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function K_(n){return n.type===4&&n.value!==OR}function Vj(n,e,t){let r=n.type===4&&!t?OR:n.value;return e===r}function Uj(n,e,t){let r=4,i=n.attrs,o=i!==null?$j(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Cr(r)&&!Cr(c))return!1;if(s&&Cr(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Vj(n,c,t)||c===""&&e.length===1){if(Cr(r))return!1;s=!0}}else if(r&8){if(i===null||!Lj(n,i,c,t)){if(Cr(r))return!1;s=!0}}else{let u=e[++a],d=jj(c,i,K_(n),t);if(d===-1){if(Cr(r))return!1;s=!0;continue}if(u!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&u!==f){if(Cr(r))return!1;s=!0}}}}return Cr(r)||s}function Cr(n){return(n&1)===0}function jj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return Hj(e,n)}function Bj(n,e,t=!1){for(let r=0;r<e.length;r++)if(Uj(n,e[r],t))return!0;return!1}function $j(n){for(let e=0;e<n.length;e++){let t=n[e];if(JU(t))return e}return n.length}function Hj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function JS(n,e){return n?":not("+e.trim()+")":e}function qj(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Cr(s)&&(e+=JS(o,i),i=""),r=s,o=o||!Cr(r);t++}return i!==""&&(e+=JS(o,i)),e}function Wj(n){return n.map(qj).join(",")}function zj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Cr(i))break;i=o}r++}return{attrs:e,classes:t}}var Co={};function k(n=1){FR(rn(),Le(),ws()+n,!1)}function FR(n,e,t,r){if(!r)if((e[ue]&3)===3){let o=n.preOrderCheckHooks;o!==null&&lf(e,o,t)}else{let o=n.preOrderHooks;o!==null&&uf(e,o,0,t)}ps(t)}function Me(n,e=De.Default){let t=Le();if(t===null)return de(n,e);let r=hn();return fR(r,t,Tn(n),e)}function LR(n,e,t,r,i,o){let s=Ae(null);try{let a=null;i&go.SignalBased&&(a=e[r][kn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&go.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):$A(e,a,r,o)}finally{Ae(s)}}function Gj(n,e){return n.createText(e)}function Kj(n,e,t){n.setValue(e,t)}function Yj(n,e){return n.createComment(Oj(e))}function VR(n,e,t){return n.createElement(e,t)}function Sf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function UR(n,e,t){n.appendChild(e,t)}function XS(n,e,t,r,i){r!==null?Sf(n,e,t,r,i):UR(n,e,t)}function Qj(n,e,t){n.removeChild(null,e,t)}function Zj(n,e,t){n.setAttribute(e,"style",t)}function Jj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function jR(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&ZU(n,e,r),i!==null&&Jj(n,e,i),o!==null&&Zj(n,e,o)}function Xf(n,e,t,r,i,o,s,a,c,u,d){let f=e.blueprint.slice();return f[wi]=i,f[ue]=r|4|128|8|64|1024,(u!==null||n&&n[ue]&2048)&&(f[ue]|=2048),GA(f),f[Dn]=f[Za]=n,f[dn]=t,f[ho]=s||n&&n[ho],f[Mt]=a||n&&n[Mt],f[Ha]=c||n&&n[Ha]||null,f[Sr]=o,f[$f]=Tj(),f[ou]=d,f[jA]=u,f[Dr]=e.type==2?n[Dr]:f,f}function BR(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function $R(n,e,t,r,i){let o=ws(),s=r&2;try{ps(-1),s&&e.length>Cn&&FR(n,e,Cn,!1),sr(s?2:0,i),t(r,i)}finally{ps(o),sr(s?3:1,i)}}function Y_(n,e,t){YA()&&(cB(n,e,t,cr(t,e)),(t.flags&64)===64&&zR(n,e,t))}function Q_(n,e,t=cr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function HR(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Z_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Z_(n,e,t,r,i,o,s,a,c,u,d){let f=Cn+r,m=f+i,v=Xj(f,m),w=typeof u=="function"?u():u;return v[be]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function Xj(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Co);return t}function eB(n,e,t,r){let o=r.get(Rj,NR)||t===Zr.ShadowDom,s=n.selectRootElement(e,o);return tB(s),s}function tB(n){nB(n)}var nB=()=>null;function eA(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=go.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let u=o;if(i!==null){if(!i.hasOwnProperty(o))continue;u=i[o]}n===0?tA(r,t,u,a,c):tA(r,t,u,a)}return r}function tA(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function rB(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let f=o[d],m=t?t.get(f):null,v=m?m.inputs:null,w=m?m.outputs:null;c=eA(0,f.inputs,d,c,v),u=eA(1,f.outputs,d,u,w);let P=c!==null&&s!==null&&!K_(e)?_B(c,d,s):null;a.push(P)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function iB(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function qR(n,e,t,r,i,o,s,a){let c=cr(e,t),u=e.inputs,d;!a&&u!=null&&(d=u[r])?(X_(n,t,d,r,i),Hf(e)&&oB(t,e.index)):e.type&3?(r=iB(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function oB(n,e){let t=Io(e,n);t[ue]&16||(t[ue]|=64)}function J_(n,e,t,r){if(YA()){let i=r===null?null:{"":-1},o=uB(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&WR(n,e,t,s,i,a),i&&dB(t,r,i)}t.mergedAttrs=za(t.mergedAttrs,t.attrs)}function WR(n,e,t,r,i,o){for(let u=0;u<r.length;u++)$y(Cf(t,e),n,r[u].type);fB(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let s=!1,a=!1,c=BR(n,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];t.mergedAttrs=za(t.mergedAttrs,d.hostAttrs),pB(n,t,e,c,d),hB(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!s&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}rB(n,t,o)}function sB(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;aB(s)!=a&&s.push(a),s.push(t,r,o)}}function aB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function cB(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;Hf(t)&&mB(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Cf(t,e),mo(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],u=Ga(e,n,a,t);if(mo(u,e),s!==null&&yB(e,a-i,u,c,t,s),fo(c)){let d=Io(t.index,e);d[dn]=Ga(e,n,a,t)}}}function zR(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=BU();try{ps(o);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];Uy(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&lB(c,u)}}finally{ps(-1),Uy(s)}}function lB(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function uB(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(Bj(e,s.selectors,!1))if(r||(r=[]),fo(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;Zy(n,e,c)}else r.unshift(s),Zy(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Zy(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function dB(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Z(-301,!1);r.push(e[i],o)}}}function hB(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;fo(e)&&(t[""]=n)}}function fB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function pB(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=ls(i.type,!0)),s=new ms(o,fo(i),Me);n.blueprint[r]=s,t[r]=s,sB(n,e,r,BR(n,t,i.hostVars,Co),i)}function GR(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function mB(n,e,t){let r=cr(e,n),i=HR(t),o=n[ho].rendererFactory,s=ep(n,Xf(n,i,null,GR(t),r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=s}function gB(n,e,t,r,i,o){let s=cr(n,e);vB(e[Mt],s,o,n.value,t,r,i)}function vB(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?b_(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function yB(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],u=s[a++],d=s[a++],f=s[a++];LR(r,t,c,u,d,f)}}function _B(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function KR(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function ep(n,e){return n[su]?n[US][br]=e:n[su]=e,n[US]=e,e}function YR(n,e){let t=n[Ha],r=t?t.get(vi,null):null;r&&r.handleError(e)}function X_(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],u=e[s],d=n.data[s];LR(d,u,r,a,c,i)}}function wB(n,e){let t=Io(e,n),r=t[be];EB(r,t);let i=t[wi];i!==null&&t[ou]===null&&(t[ou]=W_(i,t[Ha])),ew(r,t,t[dn])}function EB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ew(n,e,t){F_(e);try{let r=n.viewQuery;r!==null&&Yy(1,r,t);let i=n.template;i!==null&&$R(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Wa]?.finishViewCreation(n),n.staticContentQueries&&PR(n,e),n.staticViewQueries&&Yy(2,n.viewQuery,t);let o=n.components;o!==null&&IB(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ue]&=-5,L_()}}function IB(n,e){for(let t=0;t<e.length;t++)wB(n,e[t])}var yi=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(yi||{}),TB;function tw(n,e){return TB(n,e)}function La(n,e,t,r,i){if(r!=null){let o,s=!1;Ei(r)?o=r:uo(r)&&(s=!0,r=r[wi]);let a=Qr(r);n===0&&t!==null?i==null?UR(e,t,a):Sf(e,t,a,i||null,!0):n===1&&t!==null?Sf(e,t,a,i||null,!0):n===2?Qj(e,a,s):n===3&&e.destroyNode(a),o!=null&&FB(e,n,o,t,i)}}function CB(n,e){QR(n,e),e[wi]=null,e[Sr]=null}function bB(n,e,t,r,i,o){r[wi]=i,r[Sr]=e,rp(n,r,t,1,i,o)}function QR(n,e){e[ho].changeDetectionScheduler?.notify(10),rp(n,e,e[Mt],2,null,null)}function DB(n){let e=n[su];if(!e)return Ey(n[be],n);for(;e;){let t=null;if(uo(e))t=e[su];else{let r=e[bn];r&&(t=r)}if(!t){for(;e&&!e[br]&&e!==n;)uo(e)&&Ey(e[be],e),e=e[Dn];e===null&&(e=n),uo(e)&&Ey(e[be],e),t=e&&e[br]}e=t}}function SB(n,e,t,r){let i=bn+r,o=t.length;r>0&&(t[i-1][br]=e),r<o-bn?(e[br]=t[i],AA(t,bn+r,e)):(t.push(e),e[br]=null),e[Dn]=t;let s=e[qa];s!==null&&t!==s&&ZR(s,e);let a=e[Wa];a!==null&&a.insertView(n),Ly(e),e[ue]|=128}function ZR(n,e){let t=n[_f],r=e[Dn];if(uo(r))n[ue]|=2;else{let i=r[Dn][Dr];e[Dr]!==i&&(n[ue]|=2)}t===null?n[_f]=[e]:t.push(e)}function nw(n,e){let t=n[_f],r=t.indexOf(e);t.splice(r,1)}function cu(n,e){if(n.length<=bn)return;let t=bn+e,r=n[t];if(r){let i=r[qa];i!==null&&i!==n&&nw(i,r),e>0&&(n[t-1][br]=r[br]);let o=mf(n,bn+e);CB(r[be],r);let s=o[Wa];s!==null&&s.detachView(o[be]),r[Dn]=null,r[br]=null,r[ue]&=-129}return r}function tp(n,e){if(gu(e))return;let t=e[Mt];t.destroyNode&&rp(n,e,t,3,null,null),DB(e)}function Ey(n,e){if(gu(e))return;let t=Ae(null);try{e[ue]&=-129,e[ue]|=256,e[Yn]&&_a(e[Yn]),RB(n,e),AB(n,e),e[be].type===1&&e[Mt].destroy();let r=e[qa];if(r!==null&&Ei(e[Dn])){r!==e[Dn]&&nw(r,e);let i=e[Wa];i!==null&&i.detachView(n)}Gy(e)}finally{Ae(t)}}function AB(n,e){let t=n.cleanup,r=e[vf];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[vf]=null);let i=e[lo];if(i!==null){e[lo]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[ds];if(o!==null){e[ds]=null;for(let s of o)s.destroy()}}function RB(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ms)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];sr(4,a,c);try{c.call(a)}finally{sr(5,a,c)}}else{sr(4,i,o);try{o.call(i)}finally{sr(5,i,o)}}}}}function xB(n,e,t){return NB(n,e.parent,t)}function NB(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[wi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===Zr.None||o===Zr.Emulated)return null}return cr(r,t)}}function MB(n,e,t){return kB(n,e,t)}function PB(n,e,t){return n.type&40?cr(n,t):null}var kB=PB,nA;function np(n,e,t,r){let i=xB(n,r,e),o=e[Mt],s=r.parent||e[Sr],a=MB(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)XS(o,i,t[c],a,!1);else XS(o,i,t,a,!1);nA!==void 0&&nA(o,r,e,t,i)}function tu(n,e){if(e!==null){let t=e.type;if(t&3)return cr(e,n);if(t&4)return Jy(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return tu(n,r);{let i=n[e.index];return Ei(i)?Jy(-1,i):Qr(i)}}else{if(t&128)return tu(n,e.next);if(t&32)return tw(e,n)()||Qr(n[e.index]);{let r=JR(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=fs(n[Dr]);return tu(i,r)}else return tu(n,e.next)}}}return null}function JR(n,e){if(e!==null){let r=n[Dr][Sr],i=e.projection;return r.projection[i]}return null}function Jy(n,e){let t=bn+n+1;if(t<e.length){let r=e[t],i=r[be].firstChild;if(i!==null)return tu(r,i)}return e[hs]}function rw(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&mo(Qr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)rw(n,e,t.child,r,i,o,!1),La(e,n,i,a,o);else if(c&32){let u=tw(t,r),d;for(;d=u();)La(e,n,i,d,o);La(e,n,i,a,o)}else c&16?OB(n,e,r,t,i,o):La(e,n,i,a,o);t=s?t.projectionNext:t.next}}function rp(n,e,t,r,i,o){rw(t,r,n.firstChild,e,i,o,!1)}function OB(n,e,t,r,i,o){let s=t[Dr],c=s[Sr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];La(e,n,i,d,o)}else{let u=c,d=s[Dn];CR(r)&&(u.flags|=128),rw(n,e,u,d,i,o,!0)}}function FB(n,e,t,r,i){let o=t[hs],s=Qr(t);o!==s&&La(e,n,r,o,i);for(let a=bn;a<t.length;a++){let c=t[a];rp(c[be],c,n,e,r,o)}}function LB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:yi.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=yi.Important),n.setStyle(t,r,i,o))}}function ip(n,e,t,r){let i=Ae(null);try{let o=e.tView,a=n[ue]&4096?4096:16,c=Xf(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[qa]=u;let d=n[Wa];return d!==null&&(c[Wa]=d.createEmbeddedView(o)),ew(o,c,t),c}finally{Ae(i)}}function XR(n,e){let t=bn+e;if(t<n.length)return n[t]}function lu(n,e){return!e||e.firstChild===null||CR(n)}function op(n,e,t,r=!0){let i=e[be];if(SB(i,e,n,t),r){let s=Jy(t,n),a=e[Mt],c=a.parentNode(n[hs]);c!==null&&bB(i,n[Sr],a,e,c,s)}let o=e[ou];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function ex(n,e){let t=cu(n,e);return t!==void 0&&tp(t[be],t),t}function Af(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Qr(o)),Ei(o)&&VB(o,r);let s=t.type;if(s&8)Af(n,e,t.child,r);else if(s&32){let a=tw(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=JR(e,t);if(Array.isArray(a))r.push(...a);else{let c=fs(e[Dr]);Af(c[be],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function VB(n,e){for(let t=bn;t<n.length;t++){let r=n[t],i=r[be].firstChild;i!==null&&Af(r[be],r,i,e)}n[hs]!==n[wi]&&e.push(n[hs])}var tx=[];function UB(n){return n[Yn]??jB(n)}function jB(n){let e=tx.pop()??Object.create($B);return e.lView=n,e}function BB(n){n.lView[Yn]!==n&&(n.lView=null,tx.push(n))}var $B=fe(U({},ts),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{vu(n.lView)},consumerOnSignalRead(){this.lView[Yn]=this}});function HB(n){let e=n[Yn]??Object.create(qB);return e.lView=n,e}var qB=fe(U({},ts),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=fs(n.lView);for(;e&&!nx(e[be]);)e=fs(e);e&&P_(e)},consumerOnSignalRead(){this.lView[Yn]=this}});function nx(n){return n.type!==2}function rx(n){if(n[ds]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[ds])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ue]&8192)}}var WB=100;function ix(n,e=!0,t=0){let i=n[ho].rendererFactory,o=!1;o||i.begin?.();try{zB(n,t)}catch(s){throw e&&YR(n,s),s}finally{o||i.end?.()}}function zB(n,e){let t=JA();try{wf(!0),Xy(n,e);let r=0;for(;Wf(n);){if(r===WB)throw new Z(103,!1);r++,Xy(n,1)}}finally{wf(t)}}function GB(n,e,t,r){if(gu(e))return;let i=e[ue],o=!1,s=!1;F_(e);let a=!0,c=null,u=null;o||(nx(n)?(u=UB(e),c=ya(u)):YD()===null?(a=!1,u=HB(e),c=ya(u)):e[Yn]&&(_a(e[Yn]),e[Yn]=null));try{GA(e),LU(n.bindingStartIndex),t!==null&&$R(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let v=n.preOrderCheckHooks;v!==null&&lf(e,v,null)}else{let v=n.preOrderHooks;v!==null&&uf(e,v,0,null),yy(e,0)}if(s||KB(e),rx(e),ox(e,0),n.contentQueries!==null&&PR(n,e),!o)if(d){let v=n.contentCheckHooks;v!==null&&lf(e,v)}else{let v=n.contentHooks;v!==null&&uf(e,v,1),yy(e,1)}QB(n,e);let f=n.components;f!==null&&ax(e,f,0);let m=n.viewQuery;if(m!==null&&Yy(2,m,r),!o)if(d){let v=n.viewCheckHooks;v!==null&&lf(e,v)}else{let v=n.viewHooks;v!==null&&uf(e,v,2),yy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[cf]){for(let v of e[cf])v();e[cf]=null}o||(e[ue]&=-73)}catch(d){throw o||vu(e),d}finally{u!==null&&(ql(u,c),a&&BB(u)),L_()}}function ox(n,e){for(let t=SR(n);t!==null;t=AR(t))for(let r=bn;r<t.length;r++){let i=t[r];sx(i,e)}}function KB(n){for(let e=SR(n);e!==null;e=AR(e)){if(!(e[ue]&2))continue;let t=e[_f];for(let r=0;r<t.length;r++){let i=t[r];P_(i)}}}function YB(n,e,t){let r=Io(e,n);sx(r,t)}function sx(n,e){M_(n)&&Xy(n,e)}function Xy(n,e){let r=n[be],i=n[ue],o=n[Yn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Wl(o)),s||=!1,o&&(o.dirty=!1),n[ue]&=-9217,s)GB(r,n,r.template,n[dn]);else if(i&8192){rx(n),ox(n,1);let a=r.components;a!==null&&ax(n,a,1)}}function ax(n,e,t){for(let r=0;r<e.length;r++)YB(n,e[r],t)}function QB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ps(~i);else{let o=i,s=t[++r],a=t[++r];jU(s,o);let c=e[o];sr(24,c),a(2,c),sr(25,c)}}}finally{ps(-1)}}function iw(n,e){let t=JA()?64:1088;for(n[ho].changeDetectionScheduler?.notify(e);n;){n[ue]|=t;let r=fs(n);if(Oy(n)&&!r)return n;n=r}return null}var vs=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[be];return Af(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[dn]}get dirty(){return!!(this._lView[ue]&9280)||!!this._lView[Yn]?.dirty}set context(e){this._lView[dn]=e}get destroyed(){return gu(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Dn];if(Ei(e)){let t=e[yf],r=t?t.indexOf(this):-1;r>-1&&(cu(e,r),mf(t,r))}this._attachedToViewContainer=!1}tp(this._lView[be],this._lView)}onDestroy(e){KA(this._lView,e)}markForCheck(){iw(this._cdRefInjectingView||this._lView,4)}markForRefresh(){P_(this._cdRefInjectingView||this._lView)}detach(){this._lView[ue]&=-129}reattach(){Ly(this._lView),this._lView[ue]|=128}detectChanges(){this._lView[ue]|=1024,ix(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Oy(this._lView),t=this._lView[qa];t!==null&&!e&&nw(t,this._lView),QR(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Z(902,!1);this._appRef=e;let t=Oy(this._lView),r=this._lView[qa];r!==null&&!t&&ZR(r,this._lView),Ly(this._lView)}},ow=(()=>{class n{static __NG_ELEMENT_ID__=XB}return n})(),ZB=ow,JB=class extends ZB{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=ip(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new vs(i)}};function XB(){return e$(hn(),Le())}function e$(n,e){return n.type&4?new JB(e,n,Zf(n,e)):null}function yu(n,e,t,r,i){let o=n.data[e];if(o===null)o=t$(n,e,t,r,i),UU()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=FU();o.injectorIndex=s===null?-1:s.injectorIndex}return _s(o,!0),o}function t$(n,e,t,r,i){let o=QA(),s=k_(),a=s?o:o&&o.parent,c=n.data[e]=r$(n,a,t,e,r,i);return n$(n,c,o,s),c}function n$(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function r$(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return PU()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Zoe=new RegExp(`^(\\d+)*(${Aj}|${Sj})*(.*)`);var i$=()=>null;function uu(n,e){return i$(n,e)}var e_=class{},Rf=class{},t_=class{resolveComponentFactory(e){throw Error(`No component factory found for ${Vn(e)}.`)}},vo=class{static NULL=new t_},Ka=class{},Ci=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>o$()}return n})();function o$(){let n=Le(),e=hn(),t=Io(e.index,n);return(uo(t)?t:n)[Mt]}var s$=(()=>{class n{static \u0275prov=j({token:n,providedIn:"root",factory:()=>null})}return n})();function xf(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=PS(i,a);else if(o==2){let c=a,u=e[++s];r=PS(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Nf=class extends vo{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=us(e);return new du(t,this.ngModule)}};function rA(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:go.None;e?t.push({propName:s,templateName:r,isSignal:(a&go.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function a$(n){let e=n.toLowerCase();return e==="svg"?IU:e==="math"?TU:null}function c$(n){let{attrs:e,classes:t}=zj(n),r=e;return t.length&&r.push(1,...t),r}var du=class extends Rf{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){let e=this.componentDef,t=e.inputTransforms,r=rA(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return rA(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Wj(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=Ae(null);try{i=i||this.ngModule;let s=i instanceof Un?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new jy(e,s):e,c=a.get(Ka,null);if(c===null)throw new Z(407,!1);let u=a.get(s$,null),d=a.get(gs,null),f={rendererFactory:c,sanitizer:u,changeDetectionScheduler:d},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",w=r?eB(m,r,this.componentDef.encapsulation,a):VR(m,v,a$(v)),P=512;this.componentDef.signals?P|=4096:this.componentDef.onPush||(P|=16);let N=null;w!==null&&(N=W_(w,a,!0));let L=Z_(0,null,null,1,0,null,null,null,null,null,null),q=Xf(null,L,null,P,null,null,f,m,a,null,N);q[Cn]=w,F_(q);let Y,re=null;try{let le=this.componentDef,D,_=null;le.findHostDirectiveDefs?(D=[],_=new Map,le.findHostDirectiveDefs(le,D,_),D.push(le)):D=[le];let E=r?["ng-version","19.1.3"]:c$(this.componentDef.selectors[0]),b=yu(L,Cn,2,"#host",E);for(let A of D)b.mergedAttrs=za(b.mergedAttrs,A.hostAttrs);b.mergedAttrs=za(b.mergedAttrs,E),xf(b,b.mergedAttrs,!0),w&&jR(m,w,b),re=l$(b,w,le,D,q,f),t!==void 0&&d$(b,this.ngContentSelectors,t),Y=u$(re,le,D,_,q,[h$]),ew(L,q,null)}catch(le){throw re!==null&&Gy(re),Gy(q),le}finally{L_()}let it=N_(L,Cn);return new n_(this.componentType,Y,Zf(it,q),q,it)}finally{Ae(o)}}},n_=class extends e_{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new vs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;X_(o[be],o,i,e,t),this.previousInputValues.set(e,t);let s=Io(this._tNode.index,o);iw(s,1)}}get injector(){return new cs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function l$(n,e,t,r,i,o){let s=i[be],a=null;e!==null&&(a=W_(e,i[Ha]));let c=o.rendererFactory.createRenderer(e,t),u=Xf(i,HR(t),null,GR(t),i[n.index],n,o,c,null,null,a);return s.firstCreatePass&&Zy(s,n,r.length-1),ep(i,u),i[n.index]=u}function u$(n,e,t,r,i,o){let s=hn(),a=i[be],c=cr(s,i);WR(a,i,s,t,null,r);for(let d=0;d<t.length;d++){let f=s.directiveStart+d,m=Ga(i,a,f,s);mo(m,i)}zR(a,i,s),c&&mo(c,i);let u=Ga(i,a,s.directiveStart+s.componentOffset,s);if(n[dn]=i[dn]=u,o!==null)for(let d of o)d(u,e);return z_(a,s,i),u}function d$(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}function h$(){let n=hn();Kf(Le()[be],n)}var Es=(()=>{class n{static __NG_ELEMENT_ID__=f$}return n})();function f$(){let n=hn();return m$(n,Le())}var p$=Es,cx=class extends p${_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Zf(this._hostTNode,this._hostLView)}get injector(){return new cs(this._hostTNode,this._hostLView)}get parentInjector(){let e=U_(this._hostTNode,this._hostLView);if(aR(e)){let t=If(e,this._hostLView),r=Ef(e),i=t[be].data[r+8];return new cs(i,t)}else return new cs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=iA(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-bn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=uu(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,lu(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!yU(e),a;if(s)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,o=w.environmentInjector||w.ngModuleRef}let c=s?e:new du(us(e)),u=r||this.parentInjector;if(!o&&c.ngModule==null){let P=(s?u:this.parentInjector).get(Un,null);P&&(o=P)}let d=us(c.componentType??{}),f=uu(this._lContainer,d?.id??null),m=f?.firstChild??null,v=c.create(u,i,m,o);return this.insertImpl(v.hostView,a,lu(this._hostTNode,f)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(bU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Dn],u=new cx(c,c[Sr],c[Dn]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return op(s,i,o,r),e.attachToViewContainerRef(),AA(Iy(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=iA(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=cu(this._lContainer,t);r&&(mf(Iy(this._lContainer),t),tp(r[be],r))}detach(e){let t=this._adjustIndex(e,-1),r=cu(this._lContainer,t);return r&&mf(Iy(this._lContainer),t)!=null?new vs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function iA(n){return n[yf]}function Iy(n){return n[yf]||(n[yf]=[])}function m$(n,e){let t,r=e[n.index];return Ei(r)?t=r:(t=KR(r,e,null,n),e[n.index]=t,ep(e,t)),v$(t,e,n,r),new cx(t,n,e)}function g$(n,e){let t=n[Mt],r=t.createComment(""),i=cr(e,n),o=t.parentNode(i);return Sf(t,o,r,t.nextSibling(i),!1),r}var v$=w$,y$=()=>!1;function _$(n,e,t){return y$(n,e,t)}function w$(n,e,t,r){if(n[hs])return;let i;t.type&8?i=Qr(r):i=g$(e,t),n[hs]=i}var yo=class{},hu=class{};var r_=class extends yo{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Nf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=NA(e);this._bootstrapComponents=kR(o.bootstrap),this._r3Injector=gR(e,t,[{provide:yo,useValue:this},{provide:vo,useValue:this.componentFactoryResolver},...r],Vn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},i_=class extends hu{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new r_(this.moduleType,e,[])}};var Mf=class extends yo{injector;componentFactoryResolver=new Nf(this);instance=null;constructor(e){super();let t=new iu([...e.providers,{provide:yo,useValue:this},{provide:vo,useValue:this.componentFactoryResolver}],e.parent||R_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function sw(n,e,t=null){return new Mf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var E$=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=OA(!1,t.type),i=r.length>0?sw([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=j({token:n,providedIn:"environment",factory:()=>new n(de(Un))})}return n})();function Ve(n){return pu(()=>{let e=ux(n),t=fe(U({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===bR.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(E$).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Zr.Emulated,styles:n.styles||or,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ti("NgStandalone"),dx(t);let r=n.dependencies;return t.directiveDefs=sA(r,!1),t.pipeDefs=sA(r,!0),t.id=C$(t),t})}function I$(n){return us(n)||MA(n)}function T$(n){return n!==null}function bo(n){return pu(()=>({type:n.type,bootstrap:n.bootstrap||or,declarations:n.declarations||or,imports:n.imports||or,exports:n.exports||or,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function oA(n,e){if(n==null)return ja;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=go.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==go.None?[r,a]:r,e[o]=s):t[o]=r}return t}function at(n){return pu(()=>{let e=ux(n);return dx(e),e})}function lx(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function ux(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ja,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||or,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:oA(n.inputs,e),outputs:oA(n.outputs),debugInfo:null}}function dx(n){n.features?.forEach(e=>e(n))}function sA(n,e){if(!n)return null;let t=e?PA:I$;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(T$)}function C$(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function b$(n){return Object.getPrototypeOf(n.prototype).constructor}function jn(n){let e=b$(n.type),t=!0,r=[n];for(;e;){let i;if(fo(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Z(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=of(n.inputs),s.inputTransforms=of(n.inputTransforms),s.declaredInputs=of(n.declaredInputs),s.outputs=of(n.outputs);let a=i.hostBindings;a&&x$(n,a);let c=i.viewQuery,u=i.contentQueries;if(c&&A$(n,c),u&&R$(n,u),D$(n,i),V2(n.outputs,i.outputs),fo(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===jn&&(t=!1)}}e=Object.getPrototypeOf(e)}S$(r)}function D$(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function S$(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=za(i.hostAttrs,t=za(t,i.hostAttrs))}}function of(n){return n===ja?{}:n===or?[]:n}function A$(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function R$(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function x$(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function hx(n){return M$(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function N$(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function M$(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function fx(n,e,t){return n[e]=t}function Jr(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function P$(n,e,t,r){let i=Jr(n,e,t);return Jr(n,e+1,r)||i}function k$(n){return(n.flags&32)===32}function O$(n,e,t,r,i,o,s,a,c){let u=e.consts,d=yu(e,n,4,s||null,a||null);J_(e,t,d,po(u,c)),Kf(e,d);let f=d.tView=Z_(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function o_(n,e,t,r,i,o,s,a,c,u){let d=t+Cn,f=e.firstCreatePass?O$(d,e,n,r,i,o,s,a,c):e.data[d];_s(f,!1);let m=F$(e,n,f,t);zf()&&np(e,n,m,f),mo(m,n);let v=KR(m,n,m,f);return n[d]=v,ep(n,v),_$(v,f,n),qf(f)&&Y_(e,n,f),c!=null&&Q_(n,f,u),f}function X(n,e,t,r,i,o,s,a){let c=Le(),u=rn(),d=po(u.consts,o);return o_(c,u,n,e,t,r,i,d,s,a),X}var F$=L$;function L$(n,e,t,r){return Gf(!0),e[Mt].createComment("")}var aw=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var px=new W("");function Is(n){return!!n&&typeof n.then=="function"}function mx(n){return!!n&&typeof n.subscribe=="function"}var gx=new W("");var vx=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=S(gx,{optional:!0})??[];injector=S(Se);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Sn(this.injector,i);if(Is(o))t.push(o);else if(mx(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yx=(()=>{class n{static \u0275prov=j({token:n,providedIn:"root",factory:()=>new Pf})}return n})(),Pf=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},cw=new W("");function V$(){oS(()=>{throw new Z(600,!1)})}function U$(n){return n.isBoundToModule}var j$=10;function B$(n,e,t){try{let r=t();return Is(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var _o=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=S(vj);afterRenderManager=S(xj);zonelessEnabled=S(Yf);rootEffectScheduler=S(yx);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new st;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=S(To).hasPendingTasks.pipe(ee(t=>!t));constructor(){S(Jf,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=S(Un);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Rf;if(!this._injector.get(vx).done){let m=!i&&kA(t),v=!1;throw new Z(405,v)}let s;i?s=t:s=this._injector.get(vo).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=U$(s)?void 0:this._injector.get(yo),c=r||s.selector,u=s.create(Se.NULL,[],c,a),d=u.location.nativeElement,f=u.injector.get(px,null);return f?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),df(this.components,u),f?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(this.tracingSnapshot!==null){let r=this.tracingSnapshot;this.tracingSnapshot=null,r.run(MR.CHANGE_DETECTION,this._tick),r.dispose();return}if(this._runningTick)throw new Z(101,!1);let t=Ae(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Ae(t),this.afterTick.next()}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Ka,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;this.dirtyFlags!==0&&t++<j$;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)$$(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Wf(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;df(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(cw,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>df(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Z(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function df(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function $$(n,e,t,r){if(!t&&!Wf(n))return;ix(n,e,t&&!r?0:1)}function _u(n,e,t,r){let i=Le(),o=Ja();if(Jr(i,o,e)){let s=rn(),a=V_();gB(a,i,n,e,t,r)}return _u}function H$(n,e,t,r){return Jr(n,Ja(),t)?e+b_(t)+r:Co}function sf(n,e){return n<<17|e<<2}function ys(n){return n>>17&32767}function q$(n){return(n&2)==2}function W$(n,e){return n&131071|e<<17}function s_(n){return n|2}function Ya(n){return(n&131068)>>2}function Ty(n,e){return n&-131069|e<<2}function z$(n){return(n&1)===1}function a_(n){return n|1}function G$(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=ys(s),c=Ya(s);n[r]=t;let u=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||mu(f,d)>0)&&(u=!0)}else d=t;if(i)if(c!==0){let m=ys(n[a+1]);n[r+1]=sf(m,a),m!==0&&(n[m+1]=Ty(n[m+1],r)),n[a+1]=W$(n[a+1],r)}else n[r+1]=sf(a,0),a!==0&&(n[a+1]=Ty(n[a+1],r)),a=r;else n[r+1]=sf(c,0),a===0?a=r:n[c+1]=Ty(n[c+1],r),c=r;u&&(n[r+1]=s_(n[r+1])),aA(n,d,r,!0),aA(n,d,r,!1),K$(e,d,n,r,o),s=sf(a,c),o?e.classBindings=s:e.styleBindings=s}function K$(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&mu(o,e)>=0&&(t[r+1]=a_(t[r+1]))}function aA(n,e,t,r){let i=n[t+1],o=e===null,s=r?ys(i):Ya(i),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],u=n[s+1];Y$(c,e)&&(a=!0,n[s+1]=r?a_(u):s_(u)),s=r?ys(u):Ya(u)}a&&(n[t+1]=r?s_(i):a_(i))}function Y$(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?mu(n,e)>=0:!1}function Q(n,e,t){let r=Le(),i=Ja();if(Jr(r,i,e)){let o=rn(),s=V_();qR(o,s,r,n,e,r[Mt],t,!1)}return Q}function cA(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";X_(n,t,o[s],s,r)}function Xa(n,e,t){return _x(n,e,t,!1),Xa}function sp(n,e){return _x(n,e,null,!0),sp}function _x(n,e,t,r){let i=Le(),o=rn(),s=VU(2);if(o.firstUpdatePass&&Z$(o,n,s,r),e!==Co&&Jr(i,s,e)){let a=o.data[ws()];nH(o,a,i,i[Mt],n,i[s+1]=rH(e,t),r,s)}}function Q$(n,e){return e>=n.expandoStartIndex}function Z$(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[ws()],s=Q$(n,t);iH(o,r)&&e===null&&!s&&(e=!1),e=J$(i,o,e,r),G$(i,o,e,t,s,r)}}function J$(n,e,t,r){let i=$U(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Cy(null,n,e,t,r),t=fu(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Cy(i,n,e,t,r),o===null){let c=X$(n,e,r);c!==void 0&&Array.isArray(c)&&(c=Cy(null,n,e,c[1],r),c=fu(c,e.attrs,r),eH(n,e,r,c))}else o=tH(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function X$(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Ya(r)!==0)return n[ys(r)]}function eH(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[ys(i)]=r}function tH(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=fu(r,s,t)}return fu(r,e.attrs,t)}function Cy(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=fu(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function fu(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),oU(n,s,t?!0:e[++o]))}return n===void 0?null:n}function nH(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let c=n.data,u=c[a+1],d=z$(u)?lA(c,e,t,i,Ya(u),s):void 0;if(!kf(d)){kf(o)||q$(u)&&(o=lA(c,null,t,i,a,s));let f=zA(ws(),t);LB(r,s,f,i,o)}}function lA(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let c=n[i],u=Array.isArray(c),d=u?c[1]:c,f=d===null,m=t[i+1];m===Co&&(m=f?or:void 0);let v=f?gy(m,r):d===r?m:void 0;if(u&&!kf(v)&&(v=gy(c,r)),kf(v)&&(a=v,s))return a;let w=n[i+1];i=s?ys(w):Ya(w)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=gy(c,r))}return a}function kf(n){return n!==void 0}function rH(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Vn(G_(n)))),n}function iH(n,e){return(n.flags&(e?8:16))!==0}var c_=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,t){this.attach(t,this.detach(e))}};function by(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function oH(n,e,t){let r,i,o=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let c=e.length-1;for(;o<=s&&o<=c;){let u=n.at(o),d=e[o],f=by(o,u,o,d,t);if(f!==0){f<0&&n.updateValue(o,d),o++;continue}let m=n.at(s),v=e[c],w=by(s,m,c,v,t);if(w!==0){w<0&&n.updateValue(s,v),s--,c--;continue}let P=t(o,u),N=t(s,m),L=t(o,d);if(Object.is(L,N)){let q=t(c,v);Object.is(q,P)?(n.swap(o,s),n.updateValue(s,v),c--,s--):n.move(s,o),n.updateValue(o,d),o++;continue}if(r??=new Of,i??=dA(n,o,s,t),l_(n,r,o,L))n.updateValue(o,d),o++,s++;else if(i.has(L))r.set(P,n.detach(o)),s--;else{let q=n.create(o,e[o]);n.attach(o,q),o++,s++}}for(;o<=c;)uA(n,r,t,o,e[o]),o++}else if(e!=null){let c=e[Symbol.iterator](),u=c.next();for(;!u.done&&o<=s;){let d=n.at(o),f=u.value,m=by(o,d,o,f,t);if(m!==0)m<0&&n.updateValue(o,f),o++,u=c.next();else{r??=new Of,i??=dA(n,o,s,t);let v=t(o,f);if(l_(n,r,o,v))n.updateValue(o,f),o++,s++,u=c.next();else if(!i.has(v))n.attach(o,n.create(o,f)),o++,s++,u=c.next();else{let w=t(o,d);r.set(w,n.detach(o)),s--}}}for(;!u.done;)uA(n,r,t,n.length,u.value),u=c.next()}for(;o<=s;)n.destroy(n.detach(s--));r?.forEach(c=>{n.destroy(c)})}function l_(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function uA(n,e,t,r,i){if(l_(n,e,r,t(r,i)))n.updateValue(r,i);else{let o=n.create(r,i);n.attach(r,o)}}function dA(n,e,t,r){let i=new Set;for(let o=e;o<=t;o++)i.add(r(o,n.at(o)));return i}var Of=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function ie(n,e){Ti("NgControlFlow");let t=Le(),r=Ja(),i=t[r]!==Co?t[r]:-1,o=i!==-1?Ff(t,Cn+i):void 0,s=0;if(Jr(t,r,n)){let a=Ae(null);try{if(o!==void 0&&ex(o,s),n!==-1){let c=Cn+n,u=Ff(t,c),d=f_(t[be],c),f=uu(u,d.tView.ssrId),m=ip(t,d,e,{dehydratedView:f});op(u,m,s,lu(d,f))}}finally{Ae(a)}}else if(o!==void 0){let a=XR(o,s);a!==void 0&&(a[dn]=e)}}var u_=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-bn}};function wx(n,e){return e}var d_=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function Ex(n,e,t,r,i,o,s,a,c,u,d,f,m){Ti("NgControlFlow");let v=Le(),w=rn(),P=c!==void 0,N=Le(),L=a?s.bind(N[Dr][dn]):s,q=new d_(P,L);N[Cn+n]=q,o_(v,w,n+1,e,t,r,i,po(w.consts,o)),P&&o_(v,w,n+2,c,u,d,f,po(w.consts,m))}var h_=class extends c_{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-bn}at(e){return this.getLView(e)[dn].$implicit}attach(e,t){let r=t[ou];this.needsIndexUpdate||=e!==this.length,op(this.lContainer,t,e,lu(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,sH(this.lContainer,e)}create(e,t){let r=uu(this.lContainer,this.templateTNode.tView.ssrId),i=ip(this.hostLView,this.templateTNode,new u_(this.lContainer,t,e),{dehydratedView:r});return this.operationsCounter?.recordCreate(),i}destroy(e){tp(e[be],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[dn].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[dn].$index=e}getLView(e){return aH(this.lContainer,e)}};function Ix(n){let e=Ae(null),t=ws();try{let r=Le(),i=r[be],o=r[t],s=t+1,a=Ff(r,s);if(o.liveCollection===void 0){let u=f_(i,s);o.liveCollection=new h_(a,r,u)}else o.liveCollection.reset();let c=o.liveCollection;if(oH(c,n,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let u=Ja(),d=c.length===0;if(Jr(r,u,d)){let f=t+2,m=Ff(r,f);if(d){let v=f_(i,f),w=uu(m,v.tView.ssrId),P=ip(r,v,void 0,{dehydratedView:w});op(m,P,0,lu(v,w))}else ex(m,0)}}}finally{Ae(e)}}function Ff(n,e){return n[e]}function sH(n,e){return cu(n,e)}function aH(n,e){return XR(n,e)}function f_(n,e){return N_(n,e)}function cH(n,e,t,r,i,o){let s=e.consts,a=po(s,i),c=yu(e,n,2,r,a);return J_(e,t,c,po(s,o)),c.attrs!==null&&xf(c,c.attrs,!1),c.mergedAttrs!==null&&xf(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function T(n,e,t,r){let i=Le(),o=rn(),s=Cn+n,a=i[Mt],c=o.firstCreatePass?cH(s,o,i,e,t,r):o.data[s],u=lH(o,i,c,a,e,n);i[s]=u;let d=qf(c);return _s(c,!0),jR(a,u,c),!k$(c)&&zf()&&np(o,i,u,c),xU()===0&&mo(u,i),NU(),d&&(Y_(o,i,c),z_(o,c,i)),r!==null&&Q_(i,c),T}function C(){let n=hn();k_()?ZA():(n=n.parent,_s(n,!1));let e=n;kU(e)&&OU(),MU();let t=rn();return t.firstCreatePass&&(Kf(t,n),x_(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&YU(e)&&cA(t,e,Le(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QU(e)&&cA(t,e,Le(),e.stylesWithoutHost,!1),C}function _e(n,e,t,r){return T(n,e,t,r),C(),_e}var lH=(n,e,t,r,i,o)=>(Gf(!0),VR(r,i,WU()));function uH(n,e,t,r,i){let o=e.consts,s=po(o,r),a=yu(e,n,8,"ng-container",s);s!==null&&xf(a,s,!0);let c=po(o,i);return J_(e,t,a,c),e.queries!==null&&e.queries.elementStart(e,a),a}function lw(n,e,t){let r=Le(),i=rn(),o=n+Cn,s=i.firstCreatePass?uH(o,i,r,e,t):i.data[o];_s(s,!0);let a=dH(i,r,s,n);return r[o]=a,zf()&&np(i,r,a,s),mo(a,r),qf(s)&&(Y_(i,r,s),z_(i,s,r)),t!=null&&Q_(r,s),lw}function uw(){let n=hn(),e=rn();return k_()?ZA():(n=n.parent,_s(n,!1)),e.firstCreatePass&&(Kf(e,n),x_(n)&&e.queries.elementEnd(n)),uw}var dH=(n,e,t,r)=>(Gf(!0),Yj(e[Mt],""));function bi(){return Le()}var as=void 0;function hH(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var fH=["en",[["a","p"],["AM","PM"],as],[["AM","PM"],as,as],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],as,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],as,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",as,"{1} 'at' {0}",as],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",hH],Dy={};function ur(n){let e=pH(n),t=hA(e);if(t)return t;let r=e.split("-")[0];if(t=hA(r),t)return t;if(r==="en")return fH;throw new Z(701,!1)}function hA(n){return n in Dy||(Dy[n]=Xl.ng&&Xl.ng.common&&Xl.ng.common.locales&&Xl.ng.common.locales[n]),Dy[n]}var Rt=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Rt||{});function pH(n){return n.toLowerCase().replace(/_/g,"-")}var Lf="en-US";var mH=Lf;function gH(n){typeof n=="string"&&(mH=n.toLowerCase().replace(/_/g,"-"))}var vH=(n,e,t)=>{};function ce(n,e,t,r){let i=Le(),o=rn(),s=hn();return Tx(o,i,i[Mt],s,n,e,r),ce}function yH(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[vf],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function Tx(n,e,t,r,i,o,s){let a=qf(r),u=n.firstCreatePass&&RU(n),d=e[dn],f=AU(e),m=!0;if(r.type&3||s){let P=cr(r,e),N=s?s(P):P,L=f.length,q=s?re=>s(Qr(re[r.index])):r.index,Y=null;if(!s&&a&&(Y=yH(n,e,i,r.index)),Y!==null){let re=Y.__ngLastListenerFn__||Y;re.__ngNextListenerFn__=o,Y.__ngLastListenerFn__=o,m=!1}else{o=pA(r,e,d,o),vH(P,i,o);let re=t.listen(N,i,o);f.push(o,re),u&&u.push(i,q,L,L+1)}}else o=pA(r,e,d,o);let v=r.outputs,w;if(m&&v!==null&&(w=v[i])){let P=w.length;if(P)for(let N=0;N<P;N+=2){let L=w[N],q=w[N+1],it=e[L][q].subscribe(o),le=f.length;f.push(o,it),u&&u.push(i,r.index,le,-(le+1))}}}function fA(n,e,t,r){let i=Ae(null);try{return sr(6,e,t),t(r)!==!1}catch(o){return YR(n,o),!1}finally{sr(7,e,t),Ae(i)}}function pA(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?Io(n.index,e):e;iw(s,5);let a=fA(e,t,r,o),c=i.__ngNextListenerFn__;for(;c;)a=fA(e,t,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function H(n=1){return qU(n)}function _H(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function R(n,e=""){let t=Le(),r=rn(),i=n+Cn,o=r.firstCreatePass?yu(r,i,1,e,null):r.data[i],s=wH(r,t,o,e,n);t[i]=s,zf()&&np(r,t,s,o),_s(o,!1)}var wH=(n,e,t,r,i)=>(Gf(!0),Gj(e[Mt],r));function kt(n){return z("",n,""),kt}function z(n,e,t){let r=Le(),i=H$(r,n,e,t);return i!==Co&&EH(r,ws(),i),z}function EH(n,e,t){let r=zA(e,n);Kj(n[Mt],r,t)}function Rr(n,e,t){TR(e)&&(e=e());let r=Le(),i=Ja();if(Jr(r,i,e)){let o=rn(),s=V_();qR(o,s,r,n,e,r[Mt],t,!1)}return Rr}function Xr(n,e){let t=TR(n);return t&&n.set(e),t}function xr(n,e){let t=Le(),r=rn(),i=hn();return Tx(r,t,t[Mt],i,n,e),xr}function IH(n,e,t){let r=rn();if(r.firstCreatePass){let i=fo(n);p_(t,r.data,r.blueprint,i,!0),p_(e,r.data,r.blueprint,i,!1)}}function p_(n,e,t,r,i){if(n=Tn(n),Array.isArray(n))for(let o=0;o<n.length;o++)p_(n[o],e,t,r,i);else{let o=rn(),s=Le(),a=hn(),c=$a(n)?n:Tn(n.provide),u=VA(n),d=a.providerIndexes&1048575,f=a.directiveStart,m=a.providerIndexes>>20;if($a(n)||!n.multi){let v=new ms(u,i,Me),w=Ay(c,e,i?d:d+m,f);w===-1?($y(Cf(a,s),o,c),Sy(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(v),s.push(v)):(t[w]=v,s[w]=v)}else{let v=Ay(c,e,d+m,f),w=Ay(c,e,d,d+m),P=v>=0&&t[v],N=w>=0&&t[w];if(i&&!N||!i&&!P){$y(Cf(a,s),o,c);let L=bH(i?CH:TH,t.length,i,r,u);!i&&N&&(t[w].providerFactory=L),Sy(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(L),s.push(L)}else{let L=Cx(t[i?w:v],u,!i&&r);Sy(o,n,v>-1?v:w,L)}!i&&r&&N&&t[w].componentProviders++}}}function Sy(n,e,t,r){let i=$a(e),o=dU(e);if(i||o){let c=(o?Tn(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[r,c]):u[d+1].push(r,c)}else u.push(t,c)}}}function Cx(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Ay(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function TH(n,e,t,r){return m_(this.multi,[])}function CH(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=Ga(t,t[be],this.providerFactory.index,r);o=a.slice(0,s),m_(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],m_(i,o);return o}function m_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function bH(n,e,t,r,i){let o=new ms(n,t,Me);return o.multi=[],o.index=e,o.componentProviders=0,Cx(o,i,r&&!t),o}function ei(n,e=[]){return t=>{t.providersResolver=(r,i)=>IH(r,i?i(n):n,e)}}function tt(n,e,t,r){return DH(Le(),O_(),n,e,t,r)}function Nr(n,e,t,r,i){return Dx(Le(),O_(),n,e,t,r,i)}function bx(n,e){let t=n[e];return t===Co?void 0:t}function DH(n,e,t,r,i,o){let s=e+t;return Jr(n,s,i)?fx(n,s+1,o?r.call(o,i):r(i)):bx(n,s+1)}function Dx(n,e,t,r,i,o,s){let a=e+t;return P$(n,a,i,o)?fx(n,a+2,s?r.call(s,i,o):r(i,o)):bx(n,a+2)}function Do(n,e){let t=rn(),r,i=n+Cn;t.firstCreatePass?(r=SH(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=ls(r.type,!0)),s,a=Ln(Me);try{let c=Tf(!1),u=o();return Tf(c),_H(t,Le(),i,u),u}finally{Ln(a)}}function SH(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function So(n,e,t,r){let i=n+Cn,o=Le(),s=CU(o,i);return AH(o,i)?Dx(o,O_(),e,s.transform,t,r,s):s.transform(t,r)}function AH(n,e){return n[be].data[e].pure}var _i=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Sx=new _i("19.1.3"),g_=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},dw=(()=>{class n{compileModuleSync(t){return new i_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=NA(t),o=kR(i.declarations).reduce((s,a)=>{let c=us(a);return c&&s.push(new du(c)),s},[]);return new g_(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var RH=(()=>{class n{zone=S(me);changeDetectionScheduler=S(gs);applicationRef=S(_o);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xH=new W("",{factory:()=>!1});function Ax({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new me(fe(U({},xx()),{scheduleInRootZone:t})),[{provide:me,useFactory:n},{provide:Ba,multi:!0,useFactory:()=>{let r=S(RH,{optional:!0});return()=>r.initialize()}},{provide:Ba,multi:!0,useFactory:()=>{let r=S(NH);return()=>{r.initialize()}}},e===!0?{provide:yR,useValue:!0}:[],{provide:_R,useValue:t??vR}]}function Rx(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=Ax({ngZoneFactory:()=>{let i=xx(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Ti("NgZone_CoalesceEvent"),new me(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return ut([{provide:xH,useValue:!0},{provide:Yf,useValue:!1},r])}function xx(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var NH=(()=>{class n{subscription=new Tt;initialized=!1;zone=S(me);pendingTasks=S(To);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{me.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{me.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var MH=(()=>{class n{appRef=S(_o);taskService=S(To);ngZone=S(me);zonelessEnabled=S(Yf);tracing=S(Jf,{optional:!0});disableScheduling=S(yR,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Df):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(S(_R,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof zy||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 8:{this.appRef.deferredDirtyFlags|=8;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 13:{this.appRef.dirtyFlags|=16,r=!0;break}case 14:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{r=!0;break}case 10:case 9:case 7:case 11:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?zS:wR;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Df+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,zS(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function PH(){return typeof $localize<"u"&&$localize.locale||Lf}var ap=new W("",{providedIn:"root",factory:()=>S(ap,De.Optional|De.SkipSelf)||PH()});var v_=new W(""),kH=new W("");function Jl(n){return!n.moduleRef}function OH(n){let e=Jl(n)?n.r3Injector:n.moduleRef.injector,t=e.get(me);return t.run(()=>{Jl(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(vi,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),Jl(n)){let o=()=>e.destroy(),s=n.platformInjector.get(v_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(v_);s.add(o),n.moduleRef.onDestroy(()=>{df(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return B$(r,t,()=>{let o=e.get(vx);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(ap,Lf);if(gH(s||Lf),!e.get(kH,!0))return Jl(n)?e.get(_o):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Jl(n)){let c=e.get(_o);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return FH(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function FH(n,e){let t=n.injector.get(_o);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Z(-403,!1);e.push(n)}var hf=null;function LH(n=[],e){return Se.create({name:e,providers:[{provide:Bf,useValue:"platform"},{provide:v_,useValue:new Set([()=>hf=null])},...n]})}function VH(n=[]){if(hf)return hf;let e=LH(n);return hf=e,V$(),UH(e),e}function UH(n){let e=n.get(H_,null);Sn(n,()=>{e?.forEach(t=>t())})}function hw(){return!1}var Ao=(()=>{class n{static __NG_ELEMENT_ID__=jH}return n})();function jH(n){return BH(hn(),Le(),(n&16)===16)}function BH(n,e,t){if(Hf(n)&&!t){let r=Io(n.index,e);return new vs(r,r)}else if(n.type&175){let r=e[Dr];return new vs(r,e)}return null}var y_=class{constructor(){}supports(e){return hx(e)}create(e){return new __(e)}},$H=(n,e)=>e,__=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||$H}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<mA(r,i,o)?t:r,a=mA(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let u=a-i,d=c-i;if(u!=d){for(let m=0;m<u;m++){let v=m<o.length?o[m]:o[m]=0,w=v+m;d<=w&&w<u&&(o[m]=v+1)}let f=s.previousIndex;o[f]=d-u}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!hx(e))throw new Z(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,N$(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new w_(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Vf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Vf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},w_=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},E_=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Vf=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new E_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function mA(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function gA(){return new fw([new y_])}var fw=(()=>{class n{factories;static \u0275prov=j({token:n,providedIn:"root",factory:gA});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||gA()),deps:[[n,new rU,new Ie]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Z(901,!1)}}return n})();function Nx(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=VH(r),o=[Ax({}),{provide:gs,useExisting:MH},...t||[]],s=new Mf({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return OH({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function wu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Re(n,e){Ti("NgSignals");let t=nS(n);return e?.equal&&(t[kn].equal=e.equal),t}function dr(n){let e=Ae(null);try{return n()}finally{Ae(e)}}var Mx=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=HH}return n})();function HH(){return new Mx(Le(),hn())}var qH=!1,WH=(()=>{class n extends Pf{pendingTasks=S(To);taskId=null;schedule(t){super.schedule(t),this.taskId===null&&(this.taskId=this.pendingTasks.add(),queueMicrotask(()=>this.flush()))}flush(){try{super.flush()}finally{this.taskId!==null&&(this.pendingTasks.remove(this.taskId),this.taskId=null)}}static \u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}return n})(),I_=class{scheduler;effectFn;zone;injector;unregisterOnDestroy;watcher;constructor(e,t,r,i,o,s){this.scheduler=e,this.effectFn=t,this.zone=r,this.injector=o,this.watcher=cS(a=>this.runEffect(a),()=>this.schedule(),s),this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(vi,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.schedule(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function zH(){}function Px(n,e){Ti("NgSignals"),!e?.injector&&Qa(zH);let t=e?.injector??S(Se),r=e?.manualCleanup!==!0?t.get(Ii):null,i=new I_(t.get(WH),n,typeof Zone>"u"?null:Zone.current,r,t,e?.allowSignalWrites??!1),o=t.get(Ao,null,{optional:!0});return!o||!(o._lView[ue]&8)?i.watcher.notify():(o._lView[cf]??=[]).push(i.watcher.notify),i}var GH=qH;var T_=class{[kn];constructor(e){this[kn]=e}destroy(){this[kn].destroy()}};function Mr(n,e){if(GH)return Px(n,e);Ti("NgSignals"),!e?.injector&&Qa(Mr);let t=e?.injector??S(Se),r=e?.manualCleanup!==!0?t.get(Ii):null,i,o=t.get(Mx,null,{optional:!0}),s=t.get(gs);return o!==null&&!e?.forceRoot?(i=QH(o.view,s,n),r instanceof bf&&r._lView===o.view&&(r=null)):i=ZH(n,t.get(yx),s),i.injector=t,r!==null&&(i.onDestroyFn=r.onDestroy(()=>i.destroy())),new T_(i)}var kx=fe(U({},ts),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:au,run(){if(this.dirty=!1,this.hasRun&&!Wl(this))return;this.hasRun=!0;let n=r=>(this.cleanupFns??=[]).push(r),e=ya(this),t=wf(!1);try{this.maybeCleanup(),this.fn(n)}finally{wf(t),ql(this,e)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),KH=fe(U({},kx),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(13)},destroy(){_a(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),YH=fe(U({},kx),{consumerMarkedDirty(){this.view[ue]|=8192,vu(this.view),this.notifier.notify(14)},destroy(){_a(this),this.onDestroyFn(),this.maybeCleanup(),this.view[ds]?.delete(this)}});function QH(n,e,t){let r=Object.create(YH);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=t,n[ds]??=new Set,n[ds].add(r),r.consumerMarkedDirty(r),r}function ZH(n,e,t){let r=Object.create(KH);return r.fn=n,r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.schedule(r),r.notifier.notify(13),r}var jx=null;function Si(){return jx}function Bx(n){jx??=n}var gp=class{};var Bn=new W(""),$x=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(eq),providedIn:"platform"})}return n})();var eq=(()=>{class n extends $x{_location;_history;_doc=S(Bn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Si().getBaseHref(this._doc)}onPopState(t){let r=Si().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Si().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Hx(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Ox(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Ts(n){return n&&n[0]!=="?"?"?"+n:n}var _p=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(qx),providedIn:"root"})}return n})(),tq=new W(""),qx=(()=>{class n extends _p{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??S(Bn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Hx(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Ts(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Ts(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Ts(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(de($x),de(tq,8))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Eu=(()=>{class n{_subject=new st;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=iq(Ox(Fx(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ts(r))}normalize(t){return n.stripTrailingSlash(rq(this._basePath,Fx(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ts(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ts(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Ts;static joinWithSlash=Hx;static stripTrailingSlash=Ox;static \u0275fac=function(r){return new(r||n)(de(_p))};static \u0275prov=j({token:n,factory:()=>nq(),providedIn:"root"})}return n})();function nq(){return new Eu(de(_p))}function rq(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Fx(n){return n.replace(/\/index.html$/,"")}function iq(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var An=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(An||{}),Je=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Je||{}),Qn=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Qn||{}),Ro={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function oq(n){return ur(n)[Rt.LocaleId]}function sq(n,e,t){let r=ur(n),i=[r[Rt.DayPeriodsFormat],r[Rt.DayPeriodsStandalone]],o=hr(i,e);return hr(o,t)}function aq(n,e,t){let r=ur(n),i=[r[Rt.DaysFormat],r[Rt.DaysStandalone]],o=hr(i,e);return hr(o,t)}function cq(n,e,t){let r=ur(n),i=[r[Rt.MonthsFormat],r[Rt.MonthsStandalone]],o=hr(i,e);return hr(o,t)}function lq(n,e){let r=ur(n)[Rt.Eras];return hr(r,e)}function cp(n,e){let t=ur(n);return hr(t[Rt.DateFormat],e)}function lp(n,e){let t=ur(n);return hr(t[Rt.TimeFormat],e)}function up(n,e){let r=ur(n)[Rt.DateTimeFormat];return hr(r,e)}function wp(n,e){let t=ur(n),r=t[Rt.NumberSymbols][e];if(typeof r>"u"){if(e===Ro.CurrencyDecimal)return t[Rt.NumberSymbols][Ro.Decimal];if(e===Ro.CurrencyGroup)return t[Rt.NumberSymbols][Ro.Group]}return r}function Wx(n){if(!n[Rt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Rt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function uq(n){let e=ur(n);return Wx(e),(e[Rt.ExtraData][2]||[]).map(r=>typeof r=="string"?pw(r):[pw(r[0]),pw(r[1])])}function dq(n,e,t){let r=ur(n);Wx(r);let i=[r[Rt.ExtraData][0],r[Rt.ExtraData][1]],o=hr(i,e)||[];return hr(o,t)||[]}function hr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function pw(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var hq=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,dp={},fq=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function pq(n,e,t,r){let i=Tq(n);e=Di(t,e)||e;let s=[],a;for(;e;)if(a=fq.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let c=i.getTimezoneOffset();r&&(c=Gx(r,c),i=Iq(i,r,!0));let u="";return s.forEach(d=>{let f=wq(d);u+=f?f(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function vp(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Di(n,e){let t=oq(n);if(dp[t]??={},dp[t][e])return dp[t][e];let r="";switch(e){case"shortDate":r=cp(n,Qn.Short);break;case"mediumDate":r=cp(n,Qn.Medium);break;case"longDate":r=cp(n,Qn.Long);break;case"fullDate":r=cp(n,Qn.Full);break;case"shortTime":r=lp(n,Qn.Short);break;case"mediumTime":r=lp(n,Qn.Medium);break;case"longTime":r=lp(n,Qn.Long);break;case"fullTime":r=lp(n,Qn.Full);break;case"short":let i=Di(n,"shortTime"),o=Di(n,"shortDate");r=hp(up(n,Qn.Short),[i,o]);break;case"medium":let s=Di(n,"mediumTime"),a=Di(n,"mediumDate");r=hp(up(n,Qn.Medium),[s,a]);break;case"long":let c=Di(n,"longTime"),u=Di(n,"longDate");r=hp(up(n,Qn.Long),[c,u]);break;case"full":let d=Di(n,"fullTime"),f=Di(n,"fullDate");r=hp(up(n,Qn.Full),[d,f]);break}return r&&(dp[t][e]=r),r}function hp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function Pr(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),o+s}function mq(n,e){return Pr(n,3).substring(0,e)}function Ot(n,e,t=0,r=!1,i=!1){return function(o,s){let a=gq(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return mq(a,e);let c=wp(s,Ro.MinusSign);return Pr(a,e,c,r,i)}}function gq(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function nt(n,e,t=An.Format,r=!1){return function(i,o){return vq(i,o,n,e,t,r)}}function vq(n,e,t,r,i,o){switch(t){case 2:return cq(e,i,r)[n.getMonth()];case 1:return aq(e,i,r)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=uq(e),d=dq(e,i,r),f=u.findIndex(m=>{if(Array.isArray(m)){let[v,w]=m,P=s>=v.hours&&a>=v.minutes,N=s<w.hours||s===w.hours&&a<w.minutes;if(v.hours<w.hours){if(P&&N)return!0}else if(P||N)return!0}else if(m.hours===s&&m.minutes===a)return!0;return!1});if(f!==-1)return d[f]}return sq(e,i,r)[s<12?0:1];case 3:return lq(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function fp(n){return function(e,t,r){let i=-1*r,o=wp(t,Ro.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+Pr(s,2,o)+Pr(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+Pr(s,1,o);case 2:return"GMT"+(i>=0?"+":"")+Pr(s,2,o)+":"+Pr(Math.abs(i%60),2,o);case 3:return r===0?"Z":(i>=0?"+":"")+Pr(s,2,o)+":"+Pr(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var yq=0,mp=4;function _q(n){let e=vp(n,yq,1).getDay();return vp(n,0,1+(e<=mp?mp:mp+7)-e)}function zx(n){let e=n.getDay(),t=e===0?-3:mp-e;return vp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function mw(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=zx(t),s=_q(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return Pr(i,n,wp(r,Ro.MinusSign))}}function pp(n,e=!1){return function(t,r){let o=zx(t).getFullYear();return Pr(o,n,wp(r,Ro.MinusSign),e)}}var gw={};function wq(n){if(gw[n])return gw[n];let e;switch(n){case"G":case"GG":case"GGG":e=nt(3,Je.Abbreviated);break;case"GGGG":e=nt(3,Je.Wide);break;case"GGGGG":e=nt(3,Je.Narrow);break;case"y":e=Ot(0,1,0,!1,!0);break;case"yy":e=Ot(0,2,0,!0,!0);break;case"yyy":e=Ot(0,3,0,!1,!0);break;case"yyyy":e=Ot(0,4,0,!1,!0);break;case"Y":e=pp(1);break;case"YY":e=pp(2,!0);break;case"YYY":e=pp(3);break;case"YYYY":e=pp(4);break;case"M":case"L":e=Ot(1,1,1);break;case"MM":case"LL":e=Ot(1,2,1);break;case"MMM":e=nt(2,Je.Abbreviated);break;case"MMMM":e=nt(2,Je.Wide);break;case"MMMMM":e=nt(2,Je.Narrow);break;case"LLL":e=nt(2,Je.Abbreviated,An.Standalone);break;case"LLLL":e=nt(2,Je.Wide,An.Standalone);break;case"LLLLL":e=nt(2,Je.Narrow,An.Standalone);break;case"w":e=mw(1);break;case"ww":e=mw(2);break;case"W":e=mw(1,!0);break;case"d":e=Ot(2,1);break;case"dd":e=Ot(2,2);break;case"c":case"cc":e=Ot(7,1);break;case"ccc":e=nt(1,Je.Abbreviated,An.Standalone);break;case"cccc":e=nt(1,Je.Wide,An.Standalone);break;case"ccccc":e=nt(1,Je.Narrow,An.Standalone);break;case"cccccc":e=nt(1,Je.Short,An.Standalone);break;case"E":case"EE":case"EEE":e=nt(1,Je.Abbreviated);break;case"EEEE":e=nt(1,Je.Wide);break;case"EEEEE":e=nt(1,Je.Narrow);break;case"EEEEEE":e=nt(1,Je.Short);break;case"a":case"aa":case"aaa":e=nt(0,Je.Abbreviated);break;case"aaaa":e=nt(0,Je.Wide);break;case"aaaaa":e=nt(0,Je.Narrow);break;case"b":case"bb":case"bbb":e=nt(0,Je.Abbreviated,An.Standalone,!0);break;case"bbbb":e=nt(0,Je.Wide,An.Standalone,!0);break;case"bbbbb":e=nt(0,Je.Narrow,An.Standalone,!0);break;case"B":case"BB":case"BBB":e=nt(0,Je.Abbreviated,An.Format,!0);break;case"BBBB":e=nt(0,Je.Wide,An.Format,!0);break;case"BBBBB":e=nt(0,Je.Narrow,An.Format,!0);break;case"h":e=Ot(3,1,-12);break;case"hh":e=Ot(3,2,-12);break;case"H":e=Ot(3,1);break;case"HH":e=Ot(3,2);break;case"m":e=Ot(4,1);break;case"mm":e=Ot(4,2);break;case"s":e=Ot(5,1);break;case"ss":e=Ot(5,2);break;case"S":e=Ot(6,1);break;case"SS":e=Ot(6,2);break;case"SSS":e=Ot(6,3);break;case"Z":case"ZZ":case"ZZZ":e=fp(0);break;case"ZZZZZ":e=fp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=fp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=fp(2);break;default:return null}return gw[n]=e,e}function Gx(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function Eq(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function Iq(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),o=Gx(e,i);return Eq(n,r*(o-i))}function Tq(n){if(Lx(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,s=1]=n.split("-").map(a=>+a);return vp(i,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(hq))return Cq(r)}let e=new Date(n);if(!Lx(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function Cq(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,c,u),e}function Lx(n){return n instanceof Date&&!isNaN(n.valueOf())}function Kx(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var vw=/\s+/,Vx=[],rt=(()=>{class n{_ngEl;_renderer;initialClasses=Vx;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(vw):Vx}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(vw):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(vw).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(Me(lr),Me(Ci))};static \u0275dir=at({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var yw=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},$n=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new yw(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),Ux(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);Ux(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Me(Es),Me(ow),Me(fw))};static \u0275dir=at({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function Ux(n,e){n.context.$implicit=e.item}function bq(n,e){return new Z(2100,!1)}var Dq="mediumDate",Sq=new W(""),Aq=new W(""),ec=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??Dq,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return pq(t,s,o||this.locale,a)}catch(s){throw bq(n,s.message)}}static \u0275fac=function(r){return new(r||n)(Me(ap,16),Me(Sq,24),Me(Aq,24))};static \u0275pipe=lx({name:"date",type:n,pure:!0})}return n})();var _w="browser",Rq="server";function tc(n){return n===_w}function Ai(n){return n===Rq}var yp=class{};var Ew=class extends gp{supportsDOMEvents=!0},Iw=class n extends Ew{static makeCurrent(){Bx(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=xq();return t==null?null:Nq(t)}resetBaseElement(){Iu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Kx(document.cookie,e)}},Iu=null;function xq(){return Iu=Iu||document.querySelector("base"),Iu?Iu.getAttribute("href"):null}function Nq(n){return new URL(n,document.baseURI).pathname}var Mq=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),Tw=new W(""),eN=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Z(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(de(Tw),de(me))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),Ip=class{_doc;constructor(e){this._doc=e}manager},Ep="ng-app-id";function Yx(n){for(let e of n)e.remove()}function Qx(n,e){let t=e.createElement("style");return t.textContent=n,t}function Pq(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Ep}="${e}"],link[${Ep}="${e}"]`);if(i)for(let o of i)o.removeAttribute(Ep),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function Cw(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var tN=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Ai(o),Pq(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,Qx);r?.forEach(i=>this.addUsage(i,this.external,Cw))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Yx(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Yx(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,Qx(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Cw(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Ep,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(de(Bn),de($_),de(q_,8),de(Pt))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),ww={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Dw=/%COMP%/g,nN="%COMP%",kq=`_nghost-${nN}`,Oq=`_ngcontent-${nN}`,Fq=!0,Lq=new W("",{providedIn:"root",factory:()=>Fq});function Vq(n){return Oq.replace(Dw,n)}function Uq(n){return kq.replace(Dw,n)}function rN(n,e){return e.map(t=>t.replace(Dw,n))}var Zx=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,c,u=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=u,this.tracingService=d,this.platformIsServer=Ai(a),this.defaultRenderer=new Tu(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Zr.ShadowDom&&(r=fe(U({},r),{encapsulation:Zr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Tp?i.applyToHost(t):i instanceof Cu&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Zr.Emulated:o=new Tp(c,u,r,this.appId,d,s,a,f,this.tracingService);break;case Zr.ShadowDom:return new bw(c,u,t,r,s,a,this.nonce,f,this.tracingService);default:o=new Cu(c,u,r,d,s,a,f,this.tracingService);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(de(eN),de(tN),de($_),de(Lq),de(Bn),de(Pt),de(me),de(q_),de(Jf,8))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),Tu=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(ww[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Jx(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Jx(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Z(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=ww[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ww[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(yi.DashCase|yi.Important)?e.style.setProperty(t,r,i&yi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&yi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Si().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);let o=this.decoratePreventDefault(r);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Jx(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var bw=class extends Tu{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,c,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=rN(i.id,i.styles);for(let m of d){let v=document.createElement("style");a&&v.setAttribute("nonce",a),v.textContent=m,this.shadowRoot.appendChild(v)}let f=i.getExternalStyles?.();if(f)for(let m of f){let v=Cw(m,o);a&&v.setAttribute("nonce",a),this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Cu=class extends Tu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?rN(u,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Tp=class extends Cu{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,c,u){let d=i+"-"+r.id;super(e,t,r,o,s,a,c,u,d),this.contentAttr=Vq(d),this.hostAttr=Uq(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},jq=(()=>{class n extends Ip{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(de(Bn))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),Xx=["alt","control","meta","shift"],Bq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$q={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Hq=(()=>{class n extends Ip{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Si().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),Xx.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),s+=u+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=Bq[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Xx.forEach(s=>{if(s!==i){let a=$q[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(de(Bn))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})();function iN(n,e){return Nx(U({rootComponent:n},qq(e)))}function qq(n){return{appProviders:[...Yq,...n?.providers??[]],platformProviders:Kq}}function Wq(){Iw.makeCurrent()}function zq(){return new vi}function Gq(){return xR(document),document}var Kq=[{provide:Pt,useValue:_w},{provide:H_,useValue:Wq,multi:!0},{provide:Bn,useFactory:Gq,deps:[]}];var Yq=[{provide:Bf,useValue:"root"},{provide:vi,useFactory:zq,deps:[]},{provide:Tw,useClass:jq,multi:!0,deps:[Bn,me,Pt]},{provide:Tw,useClass:Hq,multi:!0,deps:[Bn]},Zx,tN,eN,{provide:Ka,useExisting:Zx},{provide:yp,useClass:Mq,deps:[]},[]];var Cp=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(de(Bn))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Te="primary",Bu=Symbol("RouteTitle"),Nw=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ac(n){return new Nw(n)}function Qq(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Zq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ti(n[t],e[t]))return!1;return!0}function ti(n,e){let t=n?Mw(n):void 0,r=e?Mw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!fN(n[i],e[i]))return!1;return!0}function Mw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function fN(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function pN(n){return n.length>0?n[n.length-1]:null}function xo(n){return uy(n)?n:Is(n)?lt(Promise.resolve(n)):se(n)}var Jq={exact:gN,subset:vN},mN={exact:Xq,subset:eW,ignored:()=>!0};function sN(n,e,t){return Jq[t.paths](n.root,e.root,t.matrixParams)&&mN[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Xq(n,e){return ti(n,e)}function gN(n,e,t){if(!bs(n.segments,e.segments)||!Sp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!gN(n.children[r],e.children[r],t))return!1;return!0}function eW(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>fN(n[t],e[t]))}function vN(n,e,t){return yN(n,e,e.segments,t)}function yN(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!bs(i,t)||e.hasChildren()||!Sp(i,t,r))}else if(n.segments.length===t.length){if(!bs(n.segments,t)||!Sp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!vN(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!bs(n.segments,i)||!Sp(n.segments,i,r)||!n.children[Te]?!1:yN(n.children[Te],e,o,r)}}function Sp(n,e,t){return e.every((r,i)=>mN[t](n[i].parameters,r.parameters))}var xi=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ze([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ac(this.queryParams),this._queryParamMap}toString(){return rW.serialize(this)}},ze=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ap(this)}},Cs=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ac(this.parameters),this._parameterMap}toString(){return wN(this)}};function tW(n,e){return bs(n,e)&&n.every((t,r)=>ti(t.parameters,e[r].parameters))}function bs(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function nW(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Te&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Te&&(t=t.concat(e(i,r)))}),t}var rE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>new xu,providedIn:"root"})}return n})(),xu=class{parse(e){let t=new kw(e);return new xi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${bu(e.root,!0)}`,r=sW(e.queryParams),i=typeof e.fragment=="string"?`#${iW(e.fragment)}`:"";return`${t}${r}${i}`}},rW=new xu;function Ap(n){return n.segments.map(e=>wN(e)).join("/")}function bu(n,e){if(!n.hasChildren())return Ap(n);if(e){let t=n.children[Te]?bu(n.children[Te],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==Te&&r.push(`${i}:${bu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=nW(n,(r,i)=>i===Te?[bu(n.children[Te],!1)]:[`${i}:${bu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Te]!=null?`${Ap(n)}/${t[0]}`:`${Ap(n)}/(${t.join("//")})`}}function _N(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bp(n){return _N(n).replace(/%3B/gi,";")}function iW(n){return encodeURI(n)}function Pw(n){return _N(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rp(n){return decodeURIComponent(n)}function aN(n){return Rp(n.replace(/\+/g,"%20"))}function wN(n){return`${Pw(n.path)}${oW(n.parameters)}`}function oW(n){return Object.entries(n).map(([e,t])=>`;${Pw(e)}=${Pw(t)}`).join("")}function sW(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${bp(t)}=${bp(i)}`).join("&"):`${bp(t)}=${bp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var aW=/^[^\/()?;#]+/;function Sw(n){let e=n.match(aW);return e?e[0]:""}var cW=/^[^\/()?;=#]+/;function lW(n){let e=n.match(cW);return e?e[0]:""}var uW=/^[^=?&#]+/;function dW(n){let e=n.match(uW);return e?e[0]:""}var hW=/^[^&#]+/;function fW(n){let e=n.match(hW);return e?e[0]:""}var kw=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ze([],{}):new ze([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Te]=new ze(e,t)),r}parseSegment(){let e=Sw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Z(4009,!1);return this.capture(e),new Cs(Rp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=lW(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Sw(this.remaining);i&&(r=i,this.capture(r))}e[Rp(t)]=Rp(r)}parseQueryParam(e){let t=dW(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=fW(this.remaining);s&&(r=s,this.capture(r))}let i=aN(t),o=aN(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Sw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Z(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Te);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[Te]:new ze([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Z(4011,!1)}};function EN(n){return n.segments.length>0?new ze([],{[Te]:n}):n}function IN(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=IN(i);if(r===Te&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new ze(n.segments,e);return pW(t)}function pW(n){if(n.numberOfChildren===1&&n.children[Te]){let e=n.children[Te];return new ze(n.segments.concat(e.segments),e.children)}return n}function Nu(n){return n instanceof xi}function mW(n,e,t=null,r=null){let i=TN(n);return CN(i,e,t,r)}function TN(n){let e;function t(o){let s={};for(let c of o.children){let u=t(c);s[c.outlet]=u}let a=new ze(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=EN(r);return e??i}function CN(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Aw(i,i,i,t,r);let o=gW(e);if(o.toRoot())return Aw(i,i,new ze([],{}),t,r);let s=vW(o,i,n),a=s.processChildren?Su(s.segmentGroup,s.index,o.commands):DN(s.segmentGroup,s.index,o.commands);return Aw(i,s.segmentGroup,a,t,r)}function xp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Mu(n){return typeof n=="object"&&n!=null&&n.outlets}function Aw(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,u])=>{o[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let s;n===e?s=t:s=bN(n,e,t);let a=EN(IN(s));return new xi(a,o,i)}function bN(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=bN(o,e,t)}),new ze(n.segments,r)}var Np=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&xp(r[0]))throw new Z(4003,!1);let i=r.find(Mu);if(i&&i!==pN(r))throw new Z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function gW(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Np(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Np(t,e,r)}var ic=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function vW(n,e,t){if(n.isAbsolute)return new ic(e,!0,0);if(!t)return new ic(e,!1,NaN);if(t.parent===null)return new ic(t,!0,0);let r=xp(n.commands[0])?0:1,i=t.segments.length-1+r;return yW(t,i,n.numberOfDoubleDots)}function yW(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Z(4005,!1);i=r.segments.length}return new ic(r,!1,i-o)}function _W(n){return Mu(n[0])?n[0].outlets:{[Te]:n}}function DN(n,e,t){if(n??=new ze([],{}),n.segments.length===0&&n.hasChildren())return Su(n,e,t);let r=wW(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new ze(n.segments.slice(0,r.pathIndex),{});return o.children[Te]=new ze(n.segments.slice(r.pathIndex),n.children),Su(o,0,i)}else return r.match&&i.length===0?new ze(n.segments,{}):r.match&&!n.hasChildren()?Ow(n,e,t):r.match?Su(n,0,i):Ow(n,e,t)}function Su(n,e,t){if(t.length===0)return new ze(n.segments,{});{let r=_W(t),i={};if(Object.keys(r).some(o=>o!==Te)&&n.children[Te]&&n.numberOfChildren===1&&n.children[Te].segments.length===0){let o=Su(n.children[Te],e,t);return new ze(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=DN(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new ze(n.segments,i)}}function wW(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Mu(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!lN(c,u,s))return o;r+=2}else{if(!lN(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Ow(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Mu(o)){let c=EW(o.outlets);return new ze(r,c)}if(i===0&&xp(t[0])){let c=n.segments[e];r.push(new Cs(c.path,cN(t[0]))),i++;continue}let s=Mu(o)?o.outlets[Te]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&xp(a)?(r.push(new Cs(s,cN(a))),i+=2):(r.push(new Cs(s,{})),i++)}return new ze(r,{})}function EW(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Ow(new ze([],{}),0,r))}),e}function cN(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function lN(n,e,t){return n==t.path&&ti(e,t.parameters)}var Au="imperative",on=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(on||{}),fr=class{id;url;constructor(e,t){this.id=e,this.url=t}},Pu=class extends fr{type=on.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ds=class extends fr{urlAfterRedirects;type=on.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Jn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Jn||{}),Fw=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Fw||{}),Ri=class extends fr{reason;code;type=on.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ss=class extends fr{reason;code;type=on.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},ku=class extends fr{error;target;type=on.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Mp=class extends fr{urlAfterRedirects;state;type=on.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lw=class extends fr{urlAfterRedirects;state;type=on.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vw=class extends fr{urlAfterRedirects;state;shouldActivate;type=on.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Uw=class extends fr{urlAfterRedirects;state;type=on.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jw=class extends fr{urlAfterRedirects;state;type=on.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bw=class{route;type=on.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},$w=class{route;type=on.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Hw=class{snapshot;type=on.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qw=class{snapshot;type=on.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ww=class{snapshot;type=on.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ou=class{snapshot;type=on.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Fu=class{},cc=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function IW(n,e){return n.providers&&!n._injector&&(n._injector=sw(n.providers,e,`Route: ${n.path}`)),n._injector??e}function kr(n){return n.outlet||Te}function TW(n,e){let t=n.filter(r=>kr(r)===e);return t.push(...n.filter(r=>kr(r)!==e)),t}function $u(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var zw=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return $u(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Up(this.rootInjector)}},Up=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new zw(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(de(Un))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pp=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Gw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Gw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Kw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Kw(e,this._root).map(t=>t.value)}};function Gw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Gw(n,t);if(r)return r}return null}function Kw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Kw(n,t);if(r.length)return r.unshift(e),r}return[]}var Zn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function rc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var kp=class extends Pp{snapshot;constructor(e,t){super(e),this.snapshot=t,iE(this,e)}toString(){return this.snapshot.toString()}};function SN(n){let e=CW(n),t=new tn([new Cs("",{})]),r=new tn({}),i=new tn({}),o=new tn({}),s=new tn(""),a=new lc(t,r,o,s,i,Te,n,e.root);return a.snapshot=e.root,new kp(new Zn(a,[]),e)}function CW(n){let e={},t={},r={},i="",o=new oc([],e,r,i,t,Te,n,null,{});return new Fp("",new Zn(o,[]))}var lc=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ee(u=>u[Bu]))??se(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>ac(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>ac(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Op(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:U(U({},e.params),n.params),data:U(U({},e.data),n.data),resolve:U(U(U(U({},n.data),e.data),i?.data),n._resolvedData)}:r={params:U({},n.params),data:U({},n.data),resolve:U(U({},n.data),n._resolvedData??{})},i&&RN(i)&&(r.resolve[Bu]=i.title),r}var oc=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Bu]}constructor(e,t,r,i,o,s,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ac(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ac(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fp=class extends Pp{url;constructor(e,t){super(t),this.url=e,iE(this,t)}toString(){return AN(this._root)}};function iE(n,e){e.value._routerState=n,e.children.forEach(t=>iE(n,t))}function AN(n){let e=n.children.length>0?` { ${n.children.map(AN).join(", ")} } `:"";return`${n.value}${e}`}function Rw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ti(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ti(e.params,t.params)||n.paramsSubject.next(t.params),Zq(e.url,t.url)||n.urlSubject.next(t.url),ti(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Yw(n,e){let t=ti(n.params,e.params)&&tW(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Yw(n.parent,e.parent))}function RN(n){return typeof n.title=="string"||n.title===null}var bW=new W(""),oE=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Te;activateEvents=new Kt;deactivateEvents=new Kt;attachEvents=new Kt;detachEvents=new Kt;routerOutletData=IR(void 0);parentContexts=S(Up);location=S(Es);changeDetector=S(Ao);inputBinder=S(sE,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Z(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Z(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Qw(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Eo]})}return n})(),Qw=class n{route;childContexts;parent;outletData;__ngOutletInjector(e){return new n(this.route,this.childContexts,e,this.outletData)}constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===lc?this.route:e===Up?this.childContexts:e===bW?this.outletData:this.parent.get(e,t)}},sE=new W("");function DW(n,e,t){let r=Lu(n,e._root,t?t._root:void 0);return new kp(r,e)}function Lu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=SW(n,e,t);return new Zn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Lu(n,a)),s}}let r=AW(e.value),i=e.children.map(o=>Lu(n,o));return new Zn(r,i)}}function SW(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Lu(n,r,i);return Lu(n,r)})}function AW(n){return new lc(new tn(n.url),new tn(n.params),new tn(n.queryParams),new tn(n.fragment),new tn(n.data),n.outlet,n.component,n)}var Vu=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},xN="ngNavigationCancelingError";function Lp(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Nu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=NN(!1,Jn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function NN(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[xN]=!0,t.cancellationCode=e,t}function RW(n){return MN(n)&&Nu(n.url)}function MN(n){return!!n&&n[xN]}var xW=(n,e,t,r)=>ee(i=>(new Zw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Zw=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Rw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=rc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=rc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Ou(o.value.snapshot))}),e.children.length&&this.forwardEvent(new qw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(Rw(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Rw(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Vp=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},sc=class{component;route;constructor(e,t){this.component=e,this.route=t}};function NW(n,e,t){let r=n._root,i=e?e._root:null;return Du(r,i,t,[r.value])}function MW(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function dc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!EA(n)?n:e.get(n):r}function Du(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=rc(e);return n.children.forEach(s=>{PW(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Ru(a,t.getContext(s),i)),i}function PW(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=kW(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Vp(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Du(n,e,a?a.children:null,r,i):Du(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new sc(a.outlet.component,s))}else s&&Ru(e,a,i),i.canActivateChecks.push(new Vp(r)),o.component?Du(n,null,a?a.children:null,r,i):Du(n,null,t,r,i);return i}function kW(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!bs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!bs(n.url,e.url)||!ti(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Yw(n,e)||!ti(n.queryParams,e.queryParams);case"paramsChange":default:return!Yw(n,e)}}function Ru(n,e,t){let r=rc(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Ru(s,e.children.getContext(o),t):Ru(s,null,t):Ru(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new sc(e.outlet.component,i)):t.canDeactivateChecks.push(new sc(null,i)):t.canDeactivateChecks.push(new sc(null,i))}function Hu(n){return typeof n=="function"}function OW(n){return typeof n=="boolean"}function FW(n){return n&&Hu(n.canLoad)}function LW(n){return n&&Hu(n.canActivate)}function VW(n){return n&&Hu(n.canActivateChild)}function UW(n){return n&&Hu(n.canDeactivate)}function jW(n){return n&&Hu(n.canMatch)}function PN(n){return n instanceof mi||n?.name==="EmptyError"}var Dp=Symbol("INITIAL_VALUE");function uc(){return Fn(n=>qe(n.map(e=>e.pipe(Kr(1),ka(Dp)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===Dp)return Dp;if(t===!1||BW(t))return t}return!0}),In(e=>e!==Dp),Kr(1)))}function BW(n){return Nu(n)||n instanceof Vu}function $W(n,e){return St(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?se(fe(U({},t),{guardsResult:!0})):HW(s,r,i,n).pipe(St(a=>a&&OW(a)?qW(r,o,n,e):se(a)),ee(a=>fe(U({},t),{guardsResult:a})))})}function HW(n,e,t,r){return lt(n).pipe(St(i=>YW(i.component,i.route,t,e,r)),gi(i=>i!==!0,!0))}function qW(n,e,t,r){return lt(e).pipe(ss(i=>Ma(zW(i.route.parent,r),WW(i.route,r),KW(n,i.path,t),GW(n,i.route,t))),gi(i=>i!==!0,!0))}function WW(n,e){return n!==null&&e&&e(new Ww(n)),se(!0)}function zW(n,e){return n!==null&&e&&e(new Hw(n)),se(!0)}function GW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return se(!0);let i=r.map(o=>Jh(()=>{let s=$u(e)??t,a=dc(o,s),c=LW(a)?a.canActivate(e,n):Sn(s,()=>a(e,n));return xo(c).pipe(gi())}));return se(i).pipe(uc())}function KW(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>MW(s)).filter(s=>s!==null).map(s=>Jh(()=>{let a=s.guards.map(c=>{let u=$u(s.node)??t,d=dc(c,u),f=VW(d)?d.canActivateChild(r,n):Sn(u,()=>d(r,n));return xo(f).pipe(gi())});return se(a).pipe(uc())}));return se(o).pipe(uc())}function YW(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return se(!0);let s=o.map(a=>{let c=$u(e)??i,u=dc(a,c),d=UW(u)?u.canDeactivate(n,e,t,r):Sn(c,()=>u(n,e,t,r));return xo(d).pipe(gi())});return se(s).pipe(uc())}function QW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return se(!0);let o=i.map(s=>{let a=dc(s,n),c=FW(a)?a.canLoad(e,t):Sn(n,()=>a(e,t));return xo(c)});return se(o).pipe(uc(),kN(r))}function kN(n){return Mh(nn(e=>{if(typeof e!="boolean")throw Lp(n,e)}),ee(e=>e===!0))}function ZW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return se(!0);let o=i.map(s=>{let a=dc(s,n),c=jW(a)?a.canMatch(e,t):Sn(n,()=>a(e,t));return xo(c)});return se(o).pipe(uc(),kN(r))}var Uu=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},ju=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function nc(n){return Na(new Uu(n))}function JW(n){return Na(new Z(4e3,!1))}function XW(n){return Na(NN(!1,Jn.GuardRejected))}var Jw=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return se(r);if(i.numberOfChildren>1||!i.children[Te])return JW(`${e.redirectTo}`);i=i.children[Te]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,params:v,data:w,title:P}=i,N=Sn(o,()=>a({params:v,data:w,queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,title:P}));if(N instanceof xi)throw new ju(N);t=N}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new ju(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new xi(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new ze(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Z(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Xw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ez(n,e,t,r,i){let o=ON(n,e,t);return o.matched?(r=IW(e,r),ZW(r,e,t,i).pipe(ee(s=>s===!0?o:U({},Xw)))):se(o)}function ON(n,e,t){if(e.path==="**")return tz(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?U({},Xw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Qq)(t,n,e);if(!i)return U({},Xw);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?U(U({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function tz(n){return{matched:!0,parameters:n.length>0?pN(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function uN(n,e,t,r){return t.length>0&&iz(n,t,r)?{segmentGroup:new ze(e,rz(r,new ze(t,n.children))),slicedSegments:[]}:t.length===0&&oz(n,t,r)?{segmentGroup:new ze(n.segments,nz(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ze(n.segments,n.children),slicedSegments:t}}function nz(n,e,t,r){let i={};for(let o of t)if(jp(n,e,o)&&!r[kr(o)]){let s=new ze([],{});i[kr(o)]=s}return U(U({},r),i)}function rz(n,e){let t={};t[Te]=e;for(let r of n)if(r.path===""&&kr(r)!==Te){let i=new ze([],{});t[kr(r)]=i}return t}function iz(n,e,t){return t.some(r=>jp(n,e,r)&&kr(r)!==Te)}function oz(n,e,t){return t.some(r=>jp(n,e,r))}function jp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function sz(n,e,t){return e.length===0&&!n.children[t]}var eE=class{};function az(n,e,t,r,i,o,s="emptyOnly"){return new tE(n,e,t,r,i,s,o).recognize()}var cz=31,tE=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Jw(this.urlSerializer,this.urlTree)}noMatchError(e){return new Z(4002,`'${e.segmentGroup}'`)}recognize(){let e=uN(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(({children:t,rootSnapshot:r})=>{let i=new Zn(r,t),o=new Fp("",i),s=mW(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new oc([],Object.freeze({}),Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Te,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Te,t).pipe(ee(r=>({children:r,rootSnapshot:t})),so(r=>{if(r instanceof ju)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Uu?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(ee(s=>s instanceof Zn?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return lt(o).pipe(ss(s=>{let a=r.children[s],c=TW(t,s);return this.processSegmentGroup(e,c,a,s,i)}),nf((s,a)=>(s.push(...a),s)),ao(null),my(),St(s=>{if(s===null)return nc(r);let a=FN(s);return lz(a),se(a)}))}processSegment(e,t,r,i,o,s,a){return lt(t).pipe(ss(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(so(u=>{if(u instanceof Uu)return se(null);throw u}))),gi(c=>!!c),so(c=>{if(PN(c))return sz(r,i,o)?se(new eE):nc(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return kr(r)!==s&&(s===Te||!jp(i,o,r))?nc(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):nc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:f,remainingSegments:m}=ON(t,i,o);if(!c)return nc(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>cz&&(this.allowRedirects=!1));let v=new oc(o,u,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,dN(i),kr(i),i.component??i._loadedComponent??null,i,hN(i)),w=Op(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(w.params),v.data=Object.freeze(w.data);let P=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,v,e);return this.applyRedirects.lineralizeSegments(i,P).pipe(St(N=>this.processSegment(e,r,t,N.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=ez(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Fn(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Fn(({routes:u})=>{let d=r._loadedInjector??e,{parameters:f,consumedSegments:m,remainingSegments:v}=c,w=new oc(m,f,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,dN(r),kr(r),r.component??r._loadedComponent??null,r,hN(r)),P=Op(w,s,this.paramsInheritanceStrategy);w.params=Object.freeze(P.params),w.data=Object.freeze(P.data);let{segmentGroup:N,slicedSegments:L}=uN(t,m,v,u);if(L.length===0&&N.hasChildren())return this.processChildren(d,u,N,w).pipe(ee(Y=>new Zn(w,Y)));if(u.length===0&&L.length===0)return se(new Zn(w,[]));let q=kr(r)===o;return this.processSegment(d,u,N,L,q?Te:o,!0,w).pipe(ee(Y=>new Zn(w,Y instanceof Zn?[Y]:[])))}))):nc(t)))}getChildConfig(e,t,r){return t.children?se({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?se({routes:t._loadedRoutes,injector:t._loadedInjector}):QW(e,t,r,this.urlSerializer).pipe(St(i=>i?this.configLoader.loadChildren(e,t).pipe(nn(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):XW(t))):se({routes:[],injector:e})}};function lz(n){n.sort((e,t)=>e.value.outlet===Te?-1:t.value.outlet===Te?1:e.value.outlet.localeCompare(t.value.outlet))}function uz(n){let e=n.value.routeConfig;return e&&e.path===""}function FN(n){let e=[],t=new Set;for(let r of n){if(!uz(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=FN(r.children);e.push(new Zn(r.value,i))}return e.filter(r=>!t.has(r))}function dN(n){return n.data||{}}function hN(n){return n.resolve||{}}function dz(n,e,t,r,i,o){return St(s=>az(n,e,t,r,s.extractedUrl,i,o).pipe(ee(({state:a,tree:c})=>fe(U({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function hz(n,e){return St(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return se(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let u of LN(c))s.add(u);let a=0;return lt(s).pipe(ss(c=>o.has(c)?fz(c,r,n,e):(c.data=Op(c,c.parent,n).resolve,se(void 0))),nn(()=>a++),Pa(1),St(c=>a===s.size?se(t):Kn))})}function LN(n){let e=n.children.map(t=>LN(t)).flat();return[n,...e]}function fz(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!RN(i)&&(o[Bu]=i.title),pz(o,n,e,r).pipe(ee(s=>(n._resolvedData=s,n.data=Op(n,n.parent,t).resolve,null)))}function pz(n,e,t,r){let i=Mw(n);if(i.length===0)return se({});let o={};return lt(i).pipe(St(s=>mz(n[s],e,t,r).pipe(gi(),nn(a=>{if(a instanceof Vu)throw Lp(new xu,a);o[s]=a}))),Pa(1),ee(()=>o),so(s=>PN(s)?Kn:Na(s)))}function mz(n,e,t,r){let i=$u(e)??r,o=dc(n,i),s=o.resolve?o.resolve(e,t):Sn(i,()=>o(e,t));return xo(s)}function xw(n){return Fn(e=>{let t=n(e);return t?lt(t).pipe(ee(()=>e)):se(e)})}var VN=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Te);return r}getResolvedTitleForRoute(t){return t.data[Bu]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(gz),providedIn:"root"})}return n})(),gz=(()=>{class n extends VN{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(de(Cp))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),aE=new W("",{providedIn:"root",factory:()=>({})}),cE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Ve({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&_e(0,"router-outlet")},dependencies:[oE],encapsulation:2})}return n})();function lE(n){let e=n.children&&n.children.map(lE),t=e?fe(U({},n),{children:e}):U({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Te&&(t.component=cE),t}var uE=new W(""),vz=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=S(dw);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return se(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=xo(t.loadComponent()).pipe(ee(UN),nn(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Zl(()=>{this.componentLoaders.delete(t)})),i=new Da(r,()=>new st).pipe(ba());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return se({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=yz(r,this.compiler,t,this.onLoadEndListener).pipe(Zl(()=>{this.childrenLoaders.delete(r)})),s=new Da(o,()=>new st).pipe(ba());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yz(n,e,t,r){return xo(n.loadChildren()).pipe(ee(UN),St(i=>i instanceof hu||Array.isArray(i)?se(i):lt(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(uE,[],{optional:!0,self:!0}).flat()),{routes:s.map(lE),injector:o}}))}function _z(n){return n&&typeof n=="object"&&"default"in n}function UN(n){return _z(n)?n.default:n}var dE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(wz),providedIn:"root"})}return n})(),wz=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ez=new W("");var Iz=new W(""),Tz=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new st;transitionAbortSubject=new st;configLoader=S(vz);environmentInjector=S(Un);urlSerializer=S(rE);rootContexts=S(Up);location=S(Eu);inputBindingEnabled=S(sE,{optional:!0})!==null;titleStrategy=S(VN);options=S(aE,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=S(dE);createViewTransition=S(Ez,{optional:!0});navigationErrorHandler=S(Iz,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>se(void 0);rootComponentType=null;constructor(){let t=i=>this.events.next(new Bw(i)),r=i=>this.events.next(new $w(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(fe(U(U({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new tn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Au,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(In(o=>o.id!==0),ee(o=>fe(U({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Fn(o=>{let s=!1,a=!1;return se(o).pipe(Fn(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Jn.SupersededByNewNavigation),Kn;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?fe(U({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload"){let f="";return this.events.next(new Ss(c.id,this.urlSerializer.serialize(c.rawUrl),f,Fw.IgnoredSameUrlNavigation)),c.resolve(!1),Kn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return se(c).pipe(Fn(f=>{let m=this.transitions?.getValue();return this.events.next(new Pu(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),m!==this.transitions?.getValue()?Kn:Promise.resolve(f)}),dz(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),nn(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation=fe(U({},this.currentNavigation),{finalUrl:f.urlAfterRedirects});let m=new Mp(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:f,extractedUrl:m,source:v,restoredState:w,extras:P}=c,N=new Pu(f,this.urlSerializer.serialize(m),v,w);this.events.next(N);let L=SN(this.rootComponentType).snapshot;return this.currentTransition=o=fe(U({},c),{targetSnapshot:L,urlAfterRedirects:m,extras:fe(U({},P),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,se(o)}else{let f="";return this.events.next(new Ss(c.id,this.urlSerializer.serialize(c.extractedUrl),f,Fw.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Kn}}),nn(c=>{let u=new Lw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),ee(c=>(this.currentTransition=o=fe(U({},c),{guards:NW(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),$W(this.environmentInjector,c=>this.events.next(c)),nn(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Lp(this.urlSerializer,c.guardsResult);let u=new Vw(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),In(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Jn.GuardRejected),!1)),xw(c=>{if(c.guards.canActivateChecks.length)return se(c).pipe(nn(u=>{let d=new Uw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Fn(u=>{let d=!1;return se(u).pipe(hz(this.paramsInheritanceStrategy,this.environmentInjector),nn({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",Jn.NoDataFromResolver)}}))}),nn(u=>{let d=new jw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),xw(c=>{let u=d=>{let f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(nn(m=>{d.component=m}),ee(()=>{})));for(let m of d.children)f.push(...u(m));return f};return qe(u(c.targetSnapshot.root)).pipe(ao(null),Kr(1))}),xw(()=>this.afterPreactivation()),Fn(()=>{let{currentSnapshot:c,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?lt(d).pipe(ee(()=>o)):se(o)}),ee(c=>{let u=DW(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=fe(U({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),nn(()=>{this.events.next(new Fu)}),xW(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Kr(1),nn({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ds(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),Gt(this.transitionAbortSubject.pipe(nn(c=>{throw c}))),Zl(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Jn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),so(c=>{if(a=!0,MN(c))this.events.next(new Ri(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),RW(c)?this.events.next(new cc(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let u=new ku(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let d=Sn(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(d instanceof Vu){let{message:f,cancellationCode:m}=Lp(this.urlSerializer,d);this.events.next(new Ri(o.id,this.urlSerializer.serialize(o.extractedUrl),f,m)),this.events.next(new cc(d.redirectTo,d.navigationBehaviorOptions))}else throw this.events.next(u),c}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Kn}))}))}cancelNavigationTransition(t,r,i){let o=new Ri(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cz(n){return n!==Au}var bz=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(Dz),providedIn:"root"})}return n})(),nE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Dz=(()=>{class n extends nE{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jN=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:()=>S(Sz),providedIn:"root"})}return n})(),Sz=(()=>{class n extends jN{location=S(Eu);urlSerializer=S(rE);options=S(aE,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=S(dE);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new xi;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=SN(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Pu)this.stateMemento=this.createStateMemento();else if(t instanceof Ss)this.rawUrlTree=r.initialUrl;else if(t instanceof Mp){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Fu?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Ri&&(t.code===Jn.GuardRejected||t.code===Jn.NoDataFromResolver)?this.restoreHistory(r):t instanceof ku?this.restoreHistory(r,!0):t instanceof Ds&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof xi?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=U(U({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=U(U({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Az(n,e){n.events.pipe(In(t=>t instanceof Ds||t instanceof Ri||t instanceof ku||t instanceof Ss),ee(t=>t instanceof Ds||t instanceof Ss?0:(t instanceof Ri?t.code===Jn.Redirect||t.code===Jn.SupersededByNewNavigation:!1)?2:1),In(t=>t!==2),Kr(1)).subscribe(()=>{e()})}var Rz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},xz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Bp=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=S(aw);stateManager=S(jN);options=S(aE,{optional:!0})||{};pendingTasks=S(To);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=S(Tz);urlSerializer=S(rE);location=S(Eu);urlHandlingStrategy=S(dE);_events=new st;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=S(bz);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=S(uE,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!S(sE,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Tt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Ri&&r.code!==Jn.Redirect&&r.code!==Jn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ds)this.navigated=!0;else if(r instanceof cc){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=U({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Cz(i.source)},s);this.scheduleNavigation(a,Au,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Mz(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Au,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=U({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(lE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=U(U({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let m=i?i.snapshot:this.routerState.snapshot.root;f=TN(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return CN(f,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Nu(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Au,null,r)}navigate(t,r={skipLocationChange:!1}){return Nz(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=U({},Rz):r===!1?i=U({},xz):i=r,Nu(t))return sN(this.currentUrlTree,t,i);let o=this.parseUrl(t);return sN(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,u;s?(a=s.resolve,c=s.reject,u=s.promise):u=new Promise((f,m)=>{a=f,c=m});let d=this.pendingTasks.add();return Az(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Nz(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Z(4008,!1)}function Mz(n){return!(n instanceof Fu)&&!(n instanceof cc)}var Pz=new W("");function BN(n,...e){return ut([{provide:uE,multi:!0,useValue:n},[],{provide:lc,useFactory:kz,deps:[Bp]},{provide:cw,multi:!0,useFactory:Oz},e.map(t=>t.\u0275providers)])}function kz(n){return n.routerState.root}function Oz(){let n=S(Se);return e=>{let t=n.get(_o);if(e!==t.components[0])return;let r=n.get(Bp),i=n.get(Fz);n.get(Lz)===1&&r.initialNavigation(),n.get(Vz,null,De.Optional)?.setUpPreloading(),n.get(Pz,null,De.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Fz=new W("",{factory:()=>new st}),Lz=new W("",{providedIn:"root",factory:()=>1});var Vz=new W("");var $N=[];var jz="firebase",Bz="11.2.0";te(jz,Bz,"app");function Xe(n){n||(Qa(Xe),n=S(Ii));let e=new pe(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(Gt(e))}function he(n,e){!e?.injector&&Qa(he);let t=e?.injector??S(Se),r=new Yl(1),i=Mr(()=>{let o;try{o=n()}catch(s){dr(()=>r.error(s));return}dr(()=>r.next(o))},{injector:t,manualCleanup:!0});return t.get(Ii).onDestroy(()=>{i.destroy(),r.complete()}),r.asObservable()}function hE(n){n===void 0&&(Qa(hE),n=S(Se));let e=n.get(Qf);return t=>new pe(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:c=>{r.next(c),s()},complete:()=>{r.complete(),s()},error:c=>{r.error(c),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var dt=new _i("ANGULARFIRE2_VERSION");function Wt(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ft=(n,e)=>{let t=e?[e]:Ih(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},hc=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(hc||{}),HN=hw()&&typeof Zone<"u"?hc.WARN:hc.SILENT;var $p=class{zone;delegate;constructor(e,t=cy){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},bt=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=S(me);this.outsideAngular=t.runOutsideAngular(()=>new $p(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new $p(typeof Zone>"u"?void 0:Zone.current,xa))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),qN=!1;function $z(n,e){!qN&&(HN>hc.SILENT||hw())&&(qN=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),HN>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Hz(n){let e=S(me,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function As(n){let e=S(me,{optional:!0});return e?e.run(()=>n()):n()}var qz=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Sn(t,()=>As(()=>n.apply(void 0,r)))),He=(n,e,t)=>(t||=e?hc.WARN:hc.VERBOSE,function(){let r,i=arguments,o,s,a;try{o=S(bt),s=S(Qf),a=S(Un)}catch{return $z(n,t),n.apply(this,i)}for(let u=0;u<arguments.length;u++)typeof i[u]=="function"&&(e&&(r||=As(()=>s.add())),i[u]=qz(i[u],r,a));let c=Hz(()=>n.apply(this,i));return e?c instanceof pe?c.pipe(oo(o.outsideAngular),io(o.insideAngular),hE(a)):c instanceof Promise?As(()=>new Promise((u,d)=>{s.run(()=>c).then(f=>Sn(a,()=>As(()=>u(f))),f=>Sn(a,()=>As(()=>d(f))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:As(()=>c):c instanceof pe?c.pipe(oo(o.outsideAngular),io(o.insideAngular)):As(()=>c)});var mt=class{constructor(e){return e}},xt=class{constructor(){return Ih()}};function Wz(n){return n&&n.length===1?n[0]:new mt(Ht())}var fE=new W("angularfire2._apps"),zz={provide:mt,useFactory:Wz,deps:[[new Ie,fE]]},Gz={provide:xt,deps:[[new Ie,fE]]};function Kz(n){return(e,t)=>{let r=t.get(Pt);te("angularfire",dt.full,"core"),te("angularfire",dt.full,"app"),te("angular",Sx.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new mt(i)}}function WN(n,...e){return ut([zz,Gz,{provide:fE,useFactory:Kz(n),multi:!0,deps:[me,Se,bt,...e]}])}var zN=He(GD,!0);var Yz=new Map,Qz={activated:!1,tokenObservers:[]},Zz={initialized:!1,enabled:!1};function Or(n){return Yz.get(n)||Object.assign({},Qz)}function ZN(){return Zz}var Jz="https://content-firebaseappcheck.googleapis.com/v1";var Xz="exchangeDebugToken",GN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},uce=24*60*60*1e3;var mE=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new pa,this.pending.promise.catch(t=>{}),yield eG(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new pa,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function eG(n){return new Promise(e=>{setTimeout(e,n)})}var tG={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},No=new rr("appCheck","AppCheck",tG);function JN(n){if(!Or(n).activated)throw No.create("use-before-activation",{appName:n.name})}function XN(r,i){return y(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let v=yield s.getHeartbeatsHeader();v&&(o["X-Firebase-Client"]=v)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(v){throw No.create("fetch-network-error",{originalErrorMessage:v?.message})}if(c.status!==200)throw No.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(v){throw No.create("fetch-parse-error",{originalErrorMessage:v?.message})}let d=u.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw No.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let f=Number(d[1])*1e3,m=Date.now();return{token:u.token,expireTimeMillis:m+f,issuedAtTimeMillis:m}})}function eM(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Jz}/projects/${t}/apps/${r}:${Xz}?key=${i}`,body:{debug_token:e}}}var nG="firebase-app-check-database",rG=1,gE="firebase-app-check-store";var Hp=null;function iG(){return Hp||(Hp=new Promise((n,e)=>{try{let t=indexedDB.open(nG,rG);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(No.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(gE,{keyPath:"compositeKey"})}}}catch(t){e(No.create("storage-open",{originalErrorMessage:t?.message}))}}),Hp)}function oG(n,e){return sG(aG(n),e)}function sG(n,e){return y(this,null,function*(){let r=(yield iG()).transaction(gE,"readwrite"),o=r.objectStore(gE).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var u;a(No.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function aG(n){return`${n.options.appId}-${n.name}`}var vE=new ir("@firebase/app-check");function pE(n,e){return zr()?oG(n,e).catch(t=>{vE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function tM(){return ZN().enabled}function nM(){return y(this,null,function*(){let n=ZN();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var cG={error:"UNKNOWN_ERROR"};function lG(n){return yh.encodeString(JSON.stringify(n),!1)}function yE(n,e=!1){return y(this,null,function*(){let t=n.app;JN(t);let r=Or(t),i=r.token,o;if(i&&!qu(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(qu(c)?i=c:yield pE(t,void 0))}if(!e&&i&&qu(i))return{token:i.token};let s=!1;if(tM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=XN(eM(t,yield nM()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield pE(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Or(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?vE.warn(c.message):vE.error(c),o=c}let a;return i?o?qu(i)?a={token:i.token,internalError:o}:a=YN(o):(a={token:i.token},r.token=i,yield pE(t,i)):a=YN(o),s&&fG(t,a),a})}function uG(n){return y(this,null,function*(){let e=n.app;JN(e);let{provider:t}=Or(e);if(tM()){let r=yield nM(),{token:i}=yield XN(eM(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function dG(n,e,t,r){let{app:i}=n,o=Or(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&qu(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),KN(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>KN(n))}function rM(n,e){let t=Or(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function KN(n){let{app:e}=n,t=Or(e),r=t.tokenRefresher;r||(r=hG(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function hG(n){let{app:e}=n;return new mE(()=>y(this,null,function*(){let t=Or(e),r;if(t.token?r=yield yE(n,!0):r=yield yE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Or(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},GN.RETRIAL_MIN_WAIT,GN.RETRIAL_MAX_WAIT)}function fG(n,e){let t=Or(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function qu(n){return n.expireTimeMillis-Date.now()>0}function YN(n){return{token:lG(cG),error:n}}var _E=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Or(this.app);for(let t of e)rM(this.app,t.next);return Promise.resolve()}};function pG(n,e){return new _E(n,e)}function mG(n){return{getToken:e=>yE(n,e),getLimitedUseToken:()=>uG(n),addTokenListener:e=>dG(n,"INTERNAL",e),removeTokenListener:e=>rM(n.app,e)}}var gG="@firebase/app-check",vG="0.8.11";var yG="app-check",QN="app-check-internal";function _G(){It(new Et(yG,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return pG(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(QN).initialize()})),It(new Et(QN,n=>{let e=n.getProvider("app-check").getImmediate();return mG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),te(gG,vG)}_G();var wG="app-check";var pr=class{constructor(){return Ft(wG)}};var EG=["localhost","0.0.0.0","127.0.0.1"],Tce=typeof window<"u"&&EG.includes(window.location.hostname);function yM(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var _M=yM,wM=new rr("auth","Firebase",yM());var Yp=new ir("@firebase/auth");function IG(n,...e){Yp.logLevel<=en.WARN&&Yp.warn(`Auth (${Pn}): ${n}`,...e)}function Wp(n,...e){Yp.logLevel<=en.ERROR&&Yp.error(`Auth (${Pn}): ${n}`,...e)}function Po(n,...e){throw UE(n,...e)}function xs(n,...e){return UE(n,...e)}function EM(n,e,t){let r=Object.assign(Object.assign({},_M()),{[e]:t});return new rr("auth","Firebase",r).create(e,{appName:n.name})}function Rs(n){return EM(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function UE(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wM.create(n,...e)}function ge(n,e,...t){if(!n)throw UE(e,...t)}function Ni(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Wp(e),new Error(e)}function ko(n,e){n||Ni(e)}function TE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function TG(){return iM()==="http:"||iM()==="https:"}function iM(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function CG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TG()||Fl()||"connection"in navigator)?navigator.onLine:!0}function bG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ns=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,ko(t>e,"Short delay should be less than long delay!"),this.isMobile=Ol()||_h()}get(){return CG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function jE(n,e){ko(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Qp=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var DG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var SG=new Ns(3e4,6e4);function BE(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function pc(o,s,a,c){return y(this,arguments,function*(n,e,t,r,i={}){return IM(n,i,()=>y(this,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let f=es(Object.assign({key:n.config.apiKey},d)).slice(1),m=yield n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);let v=Object.assign({method:e,headers:m},u);return VD()||(v.referrerPolicy="no-referrer"),Qp.fetch()(TM(n,n.config.apiHost,t,f),v)}))})}function IM(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},DG),e);try{let i=new CE(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw qp(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw qp(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw qp(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw qp(n,"user-disabled",s);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw EM(n,d,u);Po(n,d)}}catch(i){if(i instanceof Gn)throw i;Po(n,"network-request-failed",{message:String(i)})}})}function AG(o,s,a,c){return y(this,arguments,function*(n,e,t,r,i={}){let u=yield pc(n,e,t,r,i);return"mfaPendingCredential"in u&&Po(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function TM(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?jE(n.config,i):`${n.config.apiScheme}://${i}`}var CE=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xs(this.auth,"network-request-failed")),SG.get())})}};function qp(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=xs(n,e,r);return i.customData._tokenResponse=t,i}function RG(n,e){return y(this,null,function*(){return pc(n,"POST","/v1/accounts:delete",e)})}function CM(n,e){return y(this,null,function*(){return pc(n,"POST","/v1/accounts:lookup",e)})}function Wu(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function $E(n,e=!1){return y(this,null,function*(){let t=Fe(n),r=yield t.getIdToken(e),i=HE(r);ge(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:Wu(wE(i.auth_time)),issuedAtTime:Wu(wE(i.iat)),expirationTime:Wu(wE(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function wE(n){return Number(n)*1e3}function HE(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Wp("JWT malformed, contained fewer than 3 sections"),null;try{let i=OD(t);return i?JSON.parse(i):(Wp("Failed to decode base64 JWT payload"),null)}catch(i){return Wp("Caught error parsing JWT payload as JSON",i?.toString()),null}}function oM(n){let e=HE(n);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Gu(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Gn&&xG(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function xG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var bE=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ku=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wu(this.lastLoginAt),this.creationTime=Wu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Zp(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Gu(n,CM(t,{idToken:r}));ge(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?bM(o.providerUserInfo):[],a=NG(n.providerData,s),c=n.isAnonymous,u=!(n.email&&o.passwordHash)&&!a?.length,d=c?u:!1,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Ku(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(n,f)})}function qE(n){return y(this,null,function*(){let e=Fe(n);yield Zp(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function NG(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function bM(n){return n.map(e=>{var{providerId:t}=e,r=ly(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function MG(n,e){return y(this,null,function*(){let t=yield IM(n,{},()=>y(this,null,function*(){let r=es({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=TM(n,i,"/v1/token",`key=${o}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Qp.fetch()(s,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function PG(n,e){return y(this,null,function*(){return pc(n,"POST","/v2/accounts:revokeToken",BE(n,e))})}var zu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ge(e.length!==0,"internal-error");let t=oM(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield MG(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(ge(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(ge(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(ge(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ni("not implemented")}};function Mo(n,e){ge(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var fc=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=ly(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ku(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield Gu(this,this.stsTokenManager.getToken(this.auth,e));return ge(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return $E(this,e)}reload(){return qE(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Zp(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(pi(this.auth.app))return Promise.reject(Rs(this.auth));let e=yield this.getIdToken();return yield Gu(this,RG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,c,u,d;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,v=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,w=(s=t.photoURL)!==null&&s!==void 0?s:void 0,P=(a=t.tenantId)!==null&&a!==void 0?a:void 0,N=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(u=t.createdAt)!==null&&u!==void 0?u:void 0,q=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:Y,emailVerified:re,isAnonymous:it,providerData:le,stsTokenManager:D}=t;ge(Y&&D,e,"internal-error");let _=zu.fromJSON(this.name,D);ge(typeof Y=="string",e,"internal-error"),Mo(f,e.name),Mo(m,e.name),ge(typeof re=="boolean",e,"internal-error"),ge(typeof it=="boolean",e,"internal-error"),Mo(v,e.name),Mo(w,e.name),Mo(P,e.name),Mo(N,e.name),Mo(L,e.name),Mo(q,e.name);let E=new n({uid:Y,auth:e,email:m,emailVerified:re,displayName:f,isAnonymous:it,photoURL:w,phoneNumber:v,tenantId:P,stsTokenManager:_,createdAt:L,lastLoginAt:q});return le&&Array.isArray(le)&&(E.providerData=le.map(b=>Object.assign({},b))),N&&(E._redirectEventId=N),E}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new zu;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Zp(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];ge(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?bM(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new zu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ku(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c})}};var sM=new Map;function Mi(n){ko(n instanceof Function,"Expected a class definition");let e=sM.get(n);return e?(ko(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,sM.set(n,e),e)}var kG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),DE=kG;function zp(n,e,t){return`firebase:${n}:${e}:${t}`}var Jp=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=zp(this.userKey,i.apiKey,o),this.fullPersistenceKey=zp("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?fc._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(Mi(DE),e,r);let i=(yield Promise.all(t.map(u=>y(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),o=i[0]||Mi(DE),s=zp(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(s);if(d){let f=fc._fromJSON(e,d);u!==o&&(a=f),o=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,r):(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(u=>y(this,null,function*(){if(u!==o)try{yield u._remove(s)}catch{}}))),new n(o,e,r))})}};function aM(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RM(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DM(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(NM(e))return"Blackberry";if(MM(e))return"Webos";if(SM(e))return"Safari";if((e.includes("chrome/")||AM(e))&&!e.includes("edge/"))return"Chrome";if(xM(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function DM(n=un()){return/firefox\//i.test(n)}function SM(n=un()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function AM(n=un()){return/crios\//i.test(n)}function RM(n=un()){return/iemobile/i.test(n)}function xM(n=un()){return/android/i.test(n)}function NM(n=un()){return/blackberry/i.test(n)}function MM(n=un()){return/webos/i.test(n)}function WE(n=un()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function OG(n=un()){var e;return WE(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function FG(){return UD()&&document.documentMode===10}function PM(n=un()){return WE(n)||xM(n)||MM(n)||NM(n)||/windows phone/i.test(n)||RM(n)}function kM(n,e=[]){let t;switch(n){case"Browser":t=aM(un());break;case"Worker":t=`${aM(un())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pn}/${r}`}var SE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let c=e(o);s(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function LG(t){return y(this,arguments,function*(n,e={}){return pc(n,"GET","/v2/passwordPolicy",BE(n,e))})}var VG=6,AE=class{constructor(e){var t,r,i,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:VG,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(s=c.containsNumericCharacter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var RE=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xp(this),this.idTokenSubscription=new Xp(this),this.beforeStateQueue=new SE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wM,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mi(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Jp.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield CM(this,{idToken:e}),r=yield fc._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(pi(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!s||s===a)&&c?.user&&(i=c.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Zp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=bG()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(pi(this.app))return Promise.reject(Rs(this));let t=e?Fe(e):null;return t&&ge(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return pi(this.app)?Promise.reject(Rs(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return pi(this.app)?Promise.reject(Rs(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(Mi(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield LG(this),t=new AE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new rr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield PG(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Mi(e)||this._popupRedirectResolver;ge(t,this,"argument-error"),this.redirectPersistenceManager=yield Jp.create(this,[Mi(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{s=!0,c()}}else{let c=e.addObserver(t);return()=>{s=!0,c()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&IG(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function zE(n){return Fe(n)}var Xp=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=qD(t=>this.observer=t)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var GE={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UG(n){GE=n}function jG(n){return GE.loadJS(n)}function BG(){return GE.gapiScript}function OM(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function KE(n,e){let t=$t(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(jl(o,e??{}))return i;Po(i,"already-initialized")}return t.initialize({options:e})}function $G(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Mi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function YE(n,e,t){let r=zE(n);ge(r._canInitEmulator,r,"emulator-config-failed"),ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=FM(e),{host:s,port:a}=HG(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${o}//${s}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||qG()}function FM(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HG(n){let e=FM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:cM(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:cM(s)}}}function cM(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function qG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var em=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,t){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}};function EE(n,e){return y(this,null,function*(){return AG(n,"POST","/v1/accounts:signInWithIdp",BE(n,e))})}var tm=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var xE=class extends tm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Yu=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield fc._fromIdTokenResponse(e,r,i),s=lM(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=lM(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function lM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var NE=class n extends Gn{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function LM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?NE._fromErrorAndOperation(n,o,e,r):o})}function WG(n,e,t=!1){return y(this,null,function*(){let r=yield Gu(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Yu._forOperation(n,"link",r)})}function zG(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(pi(r.app))return Promise.reject(Rs(r));let i="reauthenticate";try{let o=yield Gu(n,LM(r,i,e,n),t);ge(o.idToken,r,"internal-error");let s=HE(o.idToken);ge(s,r,"internal-error");let{sub:a}=s;return ge(n.uid===a,r,"user-mismatch"),Yu._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Po(r,"user-mismatch"),o}})}function GG(n,e,t=!1){return y(this,null,function*(){if(pi(n.app))return Promise.reject(Rs(n));let r="signIn",i=yield LM(n,r,e),o=yield Yu._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function sm(n,e,t,r){return Fe(n).onIdTokenChanged(e,t,r)}function QE(n,e,t){return Fe(n).beforeAuthStateChanged(e,t)}function am(n,e,t,r){return Fe(n).onAuthStateChanged(e,t,r)}var nm="__sak";var rm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nm,"1"),this.storage.removeItem(nm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var KG=1e3,YG=10,QG=(()=>{class n extends rm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PM(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);FG()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,YG):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},KG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield to(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield to(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield to(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),VM=QG;var ZG=(()=>{class n extends rm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ZE=ZG;function JG(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var XG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let c=Array.from(a).map(d=>y(this,null,function*(){return d(r.origin,s)})),u=yield JG(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function UM(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ME=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{let u=UM("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(f){let m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(m.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}};function ni(){return window}function e4(n){ni().location.href=n}function jM(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}function t4(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function n4(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function r4(){return jM()?self:null}var BM="firebaseLocalStorageDb",i4=1,im="firebaseLocalStorage",$M="fbase_key",Ms=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function cm(n,e){return n.transaction([im],e?"readwrite":"readonly").objectStore(im)}function o4(){let n=indexedDB.deleteDatabase(BM);return new Ms(n).toPromise()}function PE(){let n=indexedDB.open(BM,i4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(im,{keyPath:$M})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(im)?e(r):(r.close(),yield o4(),e(yield PE()))}))})}function uM(n,e,t){return y(this,null,function*(){let r=cm(n,!0).put({[$M]:e,value:t});return new Ms(r).toPromise()})}function s4(n,e){return y(this,null,function*(){let t=cm(n,!1).get(e),r=yield new Ms(t).toPromise();return r===void 0?null:r.value})}function dM(n,e){let t=cm(n,!0).delete(e);return new Ms(t).toPromise()}var a4=800,c4=3,l4=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield PE(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>c4)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return jM()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=XG._getInstance(r4()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield t4(),!this.activeServiceWorker)return;this.sender=new ME(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||n4()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield PE();return yield uM(t,nm,"1"),yield dM(t,nm),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>uM(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>s4(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>dM(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let s=cm(o,!1).getAll();return new Ms(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),a4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),HM=l4;var Pce=OM("rcb"),kce=new Ns(3e4,6e4);function u4(n,e){return e?Mi(e):(ge(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Qu=class extends em{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return EE(e,this._buildIdpRequest())}_linkToIdToken(e,t){return EE(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return EE(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function d4(n){return GG(n.auth,new Qu(n),n.bypassAuthState)}function h4(n){let{auth:e,user:t}=n;return ge(t,e,"internal-error"),zG(t,new Qu(n),n.bypassAuthState)}function f4(n){return y(this,null,function*(){let{auth:e,user:t}=n;return ge(t,e,"internal-error"),WG(t,new Qu(n),n.bypassAuthState)})}var kE=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return d4;case"linkViaPopup":case"linkViaRedirect":return f4;case"reauthViaPopup":case"reauthViaRedirect":return h4;default:Po(this.auth,"internal-error")}}resolve(e){ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Oce=new Ns(2e3,1e4);var p4="pendingRedirect",Gp=new Map,OE=class n extends kE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Gp.get(this.auth._key());if(!e){try{let r=(yield m4(this.resolver,this.auth))?yield to(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gp.set(this.auth._key(),e)}return this.bypassAuthState||Gp.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return to(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,to(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function m4(n,e){return y(this,null,function*(){let t=y4(e),r=v4(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function g4(n,e){Gp.set(n._key(),e)}function v4(n){return Mi(n._redirectPersistence)}function y4(n){return zp(p4,n.config.apiKey,n.name)}function _4(n,e,t=!1){return y(this,null,function*(){if(pi(n.app))return Promise.reject(Rs(n));let r=zE(n),i=u4(r,e),s=yield new OE(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,e)),s})}var w4=10*60*1e3,FE=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!E4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!qM(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(xs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w4&&this.cachedEventUids.clear(),this.cachedEventUids.has(hM(e))}saveEventToCache(e){this.cachedEventUids.add(hM(e)),this.lastProcessedEventTime=Date.now()}};function hM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function E4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qM(n);default:return!1}}function I4(t){return y(this,arguments,function*(n,e={}){return pc(n,"GET","/v1/projects",e)})}var T4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C4=/^https?/;function b4(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield I4(n);for(let t of e)try{if(D4(t))return}catch{}Po(n,"unauthorized-domain")})}function D4(n){let e=TE(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!C4.test(t))return!1;if(T4.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var S4=new Ns(3e4,6e4);function fM(){let n=ni().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function A4(n){return new Promise((e,t)=>{var r,i,o;function s(){fM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fM(),t(xs(n,"network-request-failed"))},timeout:S4.get()})}if(!((i=(r=ni().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ni().gapi)===null||o===void 0)&&o.load)s();else{let a=OM("iframefcb");return ni()[a]=()=>{gapi.load?s():t(xs(n,"network-request-failed"))},jG(`${BG()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Kp=null,e})}var Kp=null;function R4(n){return Kp=Kp||A4(n),Kp}var x4=new Ns(5e3,15e3),N4="__/auth/iframe",M4="emulator/auth/iframe",P4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},k4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O4(n){let e=n.config;ge(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?jE(e,M4):`https://${n.config.authDomain}/${N4}`,r={apiKey:e.apiKey,appName:n.name,v:Pn},i=k4.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${es(r).slice(1)}`}function F4(n){return y(this,null,function*(){let e=yield R4(n),t=ni().gapi;return ge(t,n,"internal-error"),e.open({where:document.body,url:O4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:P4,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let s=xs(n,"network-request-failed"),a=ni().setTimeout(()=>{o(s)},x4.get());function c(){ni().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{o(s)})})))})}var L4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V4=500,U4=600,j4="_blank",B4="http://localhost",om=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function $4(n,e,t,r=V4,i=U4){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},L4),{width:r.toString(),height:i.toString(),top:o,left:s}),u=un().toLowerCase();t&&(a=AM(u)?j4:t),DM(u)&&(e=e||B4,c.scrollbars="yes");let d=Object.entries(c).reduce((m,[v,w])=>`${m}${v}=${w},`,"");if(OG(u)&&a!=="_self")return H4(e||"",a),new om(null);let f=window.open(e||"",a,d);ge(f,n,"popup-blocked");try{f.focus()}catch{}return new om(f)}function H4(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var q4="__/auth/handler",W4="emulator/auth/handler",z4=encodeURIComponent("fac");function pM(n,e,t,r,i,o){return y(this,null,function*(){ge(n.config.authDomain,n,"auth-domain-config-required"),ge(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pn,eventId:i};if(e instanceof tm){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",Vl(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(o||{}))s[d]=f}if(e instanceof xE){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${z4}=${encodeURIComponent(c)}`:"";return`${G4(n)}?${es(a).slice(1)}${u}`})}function G4({config:n}){return n.emulator?jE(n,W4):`https://${n.authDomain}/${q4}`}var IE="webStorageSupport",LE=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ZE,this._completeRedirectFn=_4,this._overrideRedirectResult=g4}_openPopup(e,t,r,i){return y(this,null,function*(){var o;ko((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let s=yield pM(e,t,r,TE(),i);return $4(e,s,UM())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield pM(e,t,r,TE(),i);return e4(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(ko(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield F4(e),r=new FE(e);return t.register("authEvent",i=>(ge(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(IE,{type:IE},i=>{var o;let s=(o=i?.[0])===null||o===void 0?void 0:o[IE];s!==void 0&&t(!!s),Po(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=b4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return PM()||SM()||WE()}},WM=LE;var mM="@firebase/auth",gM="1.8.2";var VE=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function K4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Y4(n){It(new Et("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;ge(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kM(n)},u=new RE(r,i,o,c);return $G(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),It(new Et("auth-internal",e=>{let t=zE(e.getProvider("auth").getImmediate());return(r=>new VE(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),te(mM,gM,K4(n)),te(mM,gM,"esm2017")}var Q4=5*60,Z4=qv("authIdTokenMaxAge")||Q4,vM=null,J4=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Z4)return;let i=t?.token;vM!==i&&(vM=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function JE(n=Ht()){let e=$t(n,"auth");if(e.isInitialized())return e.getImmediate();let t=KE(n,{popupRedirectResolver:WM,persistence:[HM,VM,ZE]}),r=qv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=J4(o.toString());QE(t,s,()=>s(t.currentUser)),sm(t,a=>s(a))}}let i=LD("auth");return i&&YE(t,`http://${i}`),t}function X4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}UG({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=xs("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",X4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Y4("Browser");function GM(n){return new pe(function(e){var t=am(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var KM="auth",Ps=class{constructor(e){return e}},Fr=class{constructor(){return Ft(KM)}};var XE=new W("angularfire2.auth-instances");function q3(n,e){let t=Wt(KM,n,e);return t&&new Ps(t)}function W3(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ps(r)}}var z3={provide:Fr,deps:[[new Ie,XE]]},G3={provide:Ps,useFactory:q3,deps:[[new Ie,XE],mt]};function YM(n,...e){return te("angularfire",dt.full,"auth"),ut([G3,z3,{provide:XE,useFactory:W3(n),multi:!0,deps:[me,Se,bt,xt,[new Ie,pr],...e]}])}var QM=He(GM,!0);var ZM=He(JE,!0);var lm="analytics",Y3="firebase_id",Q3="origin",Z3=60*1e3,J3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",sI="https://www.googletagmanager.com/gtag/js";var Rn=new ir("@firebase/analytics");var X3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Xn=new rr("analytics","Analytics",X3);function e6(n){if(!n.startsWith(sI)){let e=Xn.create("invalid-gtag-resource",{gtagURL:n});return Rn.warn(e.message),""}return n}function iP(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function t6(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function n6(n,e){let t=t6("firebase-js-sdk-policy",{createScriptURL:e6}),r=document.createElement("script"),i=`${sI}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function r6(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function i6(n,e,t,r,i,o){return y(this,null,function*(){let s=r[i];try{if(s)yield e[s];else{let c=(yield iP(t)).find(u=>u.measurementId===i);c&&(yield e[c.appId])}}catch(a){Rn.error(a)}n("config",i,o)})}function o6(n,e,t,r,i){return y(this,null,function*(){try{let o=[];if(i&&i.send_to){let s=i.send_to;Array.isArray(s)||(s=[s]);let a=yield iP(t);for(let c of s){let u=a.find(f=>f.measurementId===c),d=u&&e[u.appId];if(d)o.push(d);else{o=[];break}}}o.length===0&&(o=Object.values(e)),yield Promise.all(o),n("event",r,i||{})}catch(o){Rn.error(o)}})}function s6(n,e,t,r){function i(o,...s){return y(this,null,function*(){try{if(o==="event"){let[a,c]=s;yield o6(n,e,t,a,c)}else if(o==="config"){let[a,c]=s;yield i6(n,e,t,r,a,c)}else if(o==="consent"){let[a,c]=s;n("consent",a,c)}else if(o==="get"){let[a,c,u]=s;n("get",a,c,u)}else if(o==="set"){let[a]=s;n("set",a)}else n(o,...s)}catch(a){Rn.error(a)}})}return i}function a6(n,e,t,r,i){let o=function(...s){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(o=window[i]),window[i]=s6(o,n,e,t),{gtagCore:o,wrappedGtag:window[i]}}function c6(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(sI)&&t.src.includes(n))return t;return null}var l6=30,u6=1e3,tI=class{constructor(e={},t=u6){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},oP=new tI;function d6(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function h6(n){return y(this,null,function*(){var e;let{appId:t,apiKey:r}=n,i={method:"GET",headers:d6(r)},o=J3.replace("{app-id}",t),s=yield fetch(o,i);if(s.status!==200&&s.status!==304){let a="";try{let c=yield s.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Xn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()})}function f6(r){return y(this,arguments,function*(n,e=oP,t){let{appId:i,apiKey:o,measurementId:s}=n.options;if(!i)throw Xn.create("no-app-id");if(!o){if(s)return{measurementId:s,appId:i};throw Xn.create("no-api-key")}let a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new nI;return setTimeout(()=>y(this,null,function*(){c.abort()}),t!==void 0?t:Z3),sP({appId:i,apiKey:o,measurementId:s},a,c,e)})}function sP(o,s,a){return y(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=oP){var c;let{appId:u,measurementId:d}=n;try{yield p6(r,e)}catch(f){if(d)return Rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:u,measurementId:d};throw f}try{let f=yield h6(n);return i.deleteThrottleMetadata(u),f}catch(f){let m=f;if(!m6(m)){if(i.deleteThrottleMetadata(u),d)return Rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m?.message}]`),{appId:u,measurementId:d};throw f}let v=Number((c=m?.customData)===null||c===void 0?void 0:c.httpStatus)===503?va(t,i.intervalMillis,l6):va(t,i.intervalMillis),w={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return i.setThrottleMetadata(u,w),Rn.debug(`Calling attemptFetch again in ${v} millis`),sP(n,w,r,i)}})}function p6(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(Xn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function m6(n){if(!(n instanceof Gn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var nI=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var rI;function g6(n,e,t,r,i){return y(this,null,function*(){if(i&&i.global){n("event",t,r);return}else{let o=yield e,s=Object.assign(Object.assign({},r),{send_to:o});n("event",t,s)}})}function v6(n,e,t,r){return y(this,null,function*(){if(r&&r.global)return n("set",{user_id:t}),Promise.resolve();{let i=yield e;n("config",i,{update:!0,user_id:t})}})}var iI;function y6(n){iI=n}function _6(n){rI=n}function w6(){return y(this,null,function*(){if(zr())try{yield ga()}catch(n){return Rn.warn(Xn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Rn.warn(Xn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function E6(n,e,t,r,i,o,s){return y(this,null,function*(){var a;let c=f6(n);c.then(v=>{t[v.measurementId]=v.appId,n.options.measurementId&&v.measurementId!==n.options.measurementId&&Rn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>Rn.error(v)),e.push(c);let u=w6().then(v=>{if(v)return r.getId()}),[d,f]=yield Promise.all([c,u]);c6(o)||n6(o,d.measurementId),iI&&(i("consent","default",iI),y6(void 0)),i("js",new Date);let m=(a=s?.config)!==null&&a!==void 0?a:{};return m[Q3]="firebase",m.update=!0,f!=null&&(m[Y3]=f),i("config",d.measurementId,m),rI&&(i("set",rI),_6(void 0)),d.measurementId})}var oI=class{constructor(e){this.app=e}_delete(){return delete mc[this.app.options.appId],Promise.resolve()}},mc={},JM=[],XM={},eI="dataLayer",I6="gtag",eP,aI,tP=!1;function T6(){let n=[];if(Fl()&&n.push("This is a browser extension environment."),Ll()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Xn.create("invalid-analytics-context",{errorInfo:e});Rn.warn(t.message)}}function C6(n,e,t){T6();let r=n.options.appId;if(!r)throw Xn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Xn.create("no-api-key");if(mc[r]!=null)throw Xn.create("already-exists",{id:r});if(!tP){r6(eI);let{wrappedGtag:o,gtagCore:s}=a6(mc,JM,XM,eI,I6);aI=o,eP=s,tP=!0}return mc[r]=E6(n,JM,XM,e,eP,eI,t),new oI(n)}function aP(n=Ht()){n=Fe(n);let e=$t(n,lm);return e.isInitialized()?e.getImmediate():cP(n)}function cP(n,e={}){let t=$t(n,lm);if(t.isInitialized()){let i=t.getImmediate();if(jl(e,t.getOptions()))return i;throw Xn.create("already-initialized")}return t.initialize({options:e})}function lP(){return y(this,null,function*(){if(Fl()||!Ll()||!zr())return!1;try{return yield ga()}catch{return!1}})}function uP(n,e,t){n=Fe(n),v6(aI,mc[n.app.options.appId],e,t).catch(r=>Rn.error(r))}function cI(n,e,t,r){n=Fe(n),g6(aI,mc[n.app.options.appId],e,t,r).catch(i=>Rn.error(i))}var nP="@firebase/analytics",rP="0.10.11";function b6(){It(new Et(lm,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return C6(r,i,t)},"PUBLIC")),It(new Et("analytics-internal",n,"PRIVATE")),te(nP,rP),te(nP,rP,"esm2017");function n(e){try{let t=e.getProvider(lm).getImmediate();return{logEvent:(r,i,o)=>cI(t,r,i,o)}}catch(t){throw Xn.create("interop-component-reg-failed",{reason:t})}}}b6();var ks=class{constructor(e){return e}},fP="analytics",uI=class{constructor(){return Ft(fP)}};var pP=He(aP,!0);var mP=He(lP,!1),D6=He(cI,!1,2);var S6=He(uP,!0,2);var hI=(()=>{class n{initialized;disposables=[];constructor(t,r,i){te("angularfire",dt.full,"user-tracking");let o;this.initialized=r.runOutsideAngular(()=>new Promise(s=>{o=s})),mP().then(()=>{let s=i.get(ks);s?this.disposables=[QM(t).subscribe(a=>{S6(s,a?.uid),o()})]:o()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(r){return new(r||n)(de(Ps),de(me),de(Se))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),A6="firebase_event_origin",R6="firebase_previous_class",x6="firebase_previous_id",N6="firebase_previous_screen",M6="firebase_screen_class",dP="firebase_screen_id",P6="firebase_screen",dI="outlet",k6="page_path",O6="page_title",Zu="screen_class",hP="screen_name",F6="screen_view",L6="auto",V6="#",U6=Math.floor(Math.random()*(2**32-1))-2**31,lI={},j6=n=>{let e=[n[Zu],n[dI]].join(V6);if(lI.hasOwnProperty(e))return lI[e];{let t=U6++;return lI[e]=t,t}},B6=(n,e,t)=>n.events.pipe(In(i=>i instanceof Ou)).pipe(Fn(i=>{let s=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,m=>m.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",a=n.routerState.root.children.map(m=>m).find(m=>m.outlet===i.snapshot.outlet);if(!a)return se(null);let c=a;for(;c.firstChild;)c=c.firstChild;let u=c.pathFromRoot.map(m=>m.routeConfig?.path).filter(m=>m).join("/")||"/",d={[hP]:u,[k6]:`/${s}`,[A6]:L6,[P6]:u,[dI]:i.snapshot.outlet};e&&(d[O6]=e.getTitle());let f=a.component;if(f){if(f===cE){let m=i.snapshot;for(;m.firstChild;)m=m.firstChild;f=m.component}}else f=i.snapshot.component;if(typeof f=="string")return se(fe(U({},d),{[Zu]:f}));if(f){let m=t.resolveComponentFactory(f);return se(fe(U({},d),{[Zu]:m.selector}))}return se(null)}),In(i=>!!i),ee(i=>U({[M6]:i[Zu],[dP]:j6(i)},i)),py(i=>i[dI]),St(i=>i.pipe(Xh((o,s)=>JSON.stringify(o)===JSON.stringify(s)),ka(void 0),tf(),ee(([o,s])=>o?U({[R6]:o[Zu],[N6]:o[hP],[x6]:o[dP]},s):s)))),gP=(()=>{class n{disposable;constructor(t,r,i,o,s,a){te("angularfire",dt.full,"screen-tracking"),mP().then(()=>{let c=a.get(ks);!t||!c||o.runOutsideAngular(()=>{this.disposable=B6(t,r,i).pipe(Fn(u=>y(this,null,function*(){return s&&(yield s.initialized),D6(c,F6,u)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||n)(de(Bp,8),de(Cp,8),de(vo),de(me),de(hI,8),de(Se))};static \u0275prov=j({token:n,factory:n.\u0275fac})}return n})(),fI=new W("angularfire2.analytics-instances");function $6(n,e,t){if(!tc(t))return null;let r=Wt(fP,n,e);return r&&new ks(r)}function H6(n){return(e,t,r)=>{if(!tc(r))return null;let i=e.runOutsideAngular(()=>n(t));return new ks(i)}}var q6={provide:uI,deps:[[new Ie,fI]]},W6={provide:ks,useFactory:$6,deps:[[new Ie,fI],mt,Pt]};function vP(n,...e){return te("angularfire",dt.full,"analytics"),ut([W6,q6,{provide:fI,useFactory:H6(n),multi:!0,deps:[me,Se,Pt,bt,xt,...e]}])}var yP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_P={};var Pi,pI;(function(){var n;function e(D,_){function E(){}E.prototype=_.prototype,D.D=_.prototype,D.prototype=new E,D.prototype.constructor=D,D.C=function(b,A,M){for(var I=Array(arguments.length-2),di=2;di<arguments.length;di++)I[di-2]=arguments[di];return _.prototype[A].apply(b,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,_,E){E||(E=0);var b=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)b[A]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(A=0;16>A;++A)b[A]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=D.g[0],E=D.g[1],A=D.g[2];var M=D.g[3],I=_+(M^E&(A^M))+b[0]+3614090360&4294967295;_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[1]+3905402710&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[2]+606105819&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[3]+3250441966&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[4]+4118548399&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[5]+1200080426&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[6]+2821735955&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[7]+4249261313&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[8]+1770035416&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[9]+2336552879&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[10]+4294925233&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[11]+2304563134&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(M^E&(A^M))+b[12]+1804603682&4294967295,_=E+(I<<7&4294967295|I>>>25),I=M+(A^_&(E^A))+b[13]+4254626195&4294967295,M=_+(I<<12&4294967295|I>>>20),I=A+(E^M&(_^E))+b[14]+2792965006&4294967295,A=M+(I<<17&4294967295|I>>>15),I=E+(_^A&(M^_))+b[15]+1236535329&4294967295,E=A+(I<<22&4294967295|I>>>10),I=_+(A^M&(E^A))+b[1]+4129170786&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[6]+3225465664&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[11]+643717713&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[0]+3921069994&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[5]+3593408605&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[10]+38016083&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[15]+3634488961&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[4]+3889429448&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[9]+568446438&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[14]+3275163606&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[3]+4107603335&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[8]+1163531501&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(A^M&(E^A))+b[13]+2850285829&4294967295,_=E+(I<<5&4294967295|I>>>27),I=M+(E^A&(_^E))+b[2]+4243563512&4294967295,M=_+(I<<9&4294967295|I>>>23),I=A+(_^E&(M^_))+b[7]+1735328473&4294967295,A=M+(I<<14&4294967295|I>>>18),I=E+(M^_&(A^M))+b[12]+2368359562&4294967295,E=A+(I<<20&4294967295|I>>>12),I=_+(E^A^M)+b[5]+4294588738&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[8]+2272392833&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[11]+1839030562&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[14]+4259657740&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[1]+2763975236&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[4]+1272893353&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[7]+4139469664&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[10]+3200236656&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[13]+681279174&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[0]+3936430074&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[3]+3572445317&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[6]+76029189&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(E^A^M)+b[9]+3654602809&4294967295,_=E+(I<<4&4294967295|I>>>28),I=M+(_^E^A)+b[12]+3873151461&4294967295,M=_+(I<<11&4294967295|I>>>21),I=A+(M^_^E)+b[15]+530742520&4294967295,A=M+(I<<16&4294967295|I>>>16),I=E+(A^M^_)+b[2]+3299628645&4294967295,E=A+(I<<23&4294967295|I>>>9),I=_+(A^(E|~M))+b[0]+4096336452&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[7]+1126891415&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[14]+2878612391&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[5]+4237533241&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[12]+1700485571&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[3]+2399980690&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[10]+4293915773&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[1]+2240044497&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[8]+1873313359&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[15]+4264355552&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[6]+2734768916&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[13]+1309151649&4294967295,E=A+(I<<21&4294967295|I>>>11),I=_+(A^(E|~M))+b[4]+4149444226&4294967295,_=E+(I<<6&4294967295|I>>>26),I=M+(E^(_|~A))+b[11]+3174756917&4294967295,M=_+(I<<10&4294967295|I>>>22),I=A+(_^(M|~E))+b[2]+718787259&4294967295,A=M+(I<<15&4294967295|I>>>17),I=E+(M^(A|~_))+b[9]+3951481745&4294967295,D.g[0]=D.g[0]+_&4294967295,D.g[1]=D.g[1]+(A+(I<<21&4294967295|I>>>11))&4294967295,D.g[2]=D.g[2]+A&4294967295,D.g[3]=D.g[3]+M&4294967295}r.prototype.u=function(D,_){_===void 0&&(_=D.length);for(var E=_-this.blockSize,b=this.B,A=this.h,M=0;M<_;){if(A==0)for(;M<=E;)i(this,D,M),M+=this.blockSize;if(typeof D=="string"){for(;M<_;)if(b[A++]=D.charCodeAt(M++),A==this.blockSize){i(this,b),A=0;break}}else for(;M<_;)if(b[A++]=D[M++],A==this.blockSize){i(this,b),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var _=1;_<D.length-8;++_)D[_]=0;var E=8*this.o;for(_=D.length-8;_<D.length;++_)D[_]=E&255,E/=256;for(this.u(D),D=Array(16),_=E=0;4>_;++_)for(var b=0;32>b;b+=8)D[E++]=this.g[_]>>>b&255;return D};function o(D,_){var E=a;return Object.prototype.hasOwnProperty.call(E,D)?E[D]:E[D]=_(D)}function s(D,_){this.h=_;for(var E=[],b=!0,A=D.length-1;0<=A;A--){var M=D[A]|0;b&&M==_||(E[A]=M,b=!1)}this.g=E}var a={};function c(D){return-128<=D&&128>D?o(D,function(_){return new s([_|0],0>_?-1:0)}):new s([D|0],0>D?-1:0)}function u(D){if(isNaN(D)||!isFinite(D))return f;if(0>D)return N(u(-D));for(var _=[],E=1,b=0;D>=E;b++)_[b]=D/E|0,E*=4294967296;return new s(_,0)}function d(D,_){if(D.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(D.charAt(0)=="-")return N(d(D.substring(1),_));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(_,8)),b=f,A=0;A<D.length;A+=8){var M=Math.min(8,D.length-A),I=parseInt(D.substring(A,A+M),_);8>M?(M=u(Math.pow(_,M)),b=b.j(M).add(u(I))):(b=b.j(E),b=b.add(u(I)))}return b}var f=c(0),m=c(1),v=c(16777216);n=s.prototype,n.m=function(){if(P(this))return-N(this).m();for(var D=0,_=1,E=0;E<this.g.length;E++){var b=this.i(E);D+=(0<=b?b:4294967296+b)*_,_*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(w(this))return"0";if(P(this))return"-"+N(this).toString(D);for(var _=u(Math.pow(D,6)),E=this,b="";;){var A=re(E,_).g;E=L(E,A.j(_));var M=((0<E.g.length?E.g[0]:E.h)>>>0).toString(D);if(E=A,w(E))return M+b;for(;6>M.length;)M="0"+M;b=M+b}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function w(D){if(D.h!=0)return!1;for(var _=0;_<D.g.length;_++)if(D.g[_]!=0)return!1;return!0}function P(D){return D.h==-1}n.l=function(D){return D=L(this,D),P(D)?-1:w(D)?0:1};function N(D){for(var _=D.g.length,E=[],b=0;b<_;b++)E[b]=~D.g[b];return new s(E,~D.h).add(m)}n.abs=function(){return P(this)?N(this):this},n.add=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0,A=0;A<=_;A++){var M=b+(this.i(A)&65535)+(D.i(A)&65535),I=(M>>>16)+(this.i(A)>>>16)+(D.i(A)>>>16);b=I>>>16,M&=65535,I&=65535,E[A]=I<<16|M}return new s(E,E[E.length-1]&-2147483648?-1:0)};function L(D,_){return D.add(N(_))}n.j=function(D){if(w(this)||w(D))return f;if(P(this))return P(D)?N(this).j(N(D)):N(N(this).j(D));if(P(D))return N(this.j(N(D)));if(0>this.l(v)&&0>D.l(v))return u(this.m()*D.m());for(var _=this.g.length+D.g.length,E=[],b=0;b<2*_;b++)E[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<D.g.length;A++){var M=this.i(b)>>>16,I=this.i(b)&65535,di=D.i(A)>>>16,gl=D.i(A)&65535;E[2*b+2*A]+=I*gl,q(E,2*b+2*A),E[2*b+2*A+1]+=M*gl,q(E,2*b+2*A+1),E[2*b+2*A+1]+=I*di,q(E,2*b+2*A+1),E[2*b+2*A+2]+=M*di,q(E,2*b+2*A+2)}for(b=0;b<_;b++)E[b]=E[2*b+1]<<16|E[2*b];for(b=_;b<2*_;b++)E[b]=0;return new s(E,0)};function q(D,_){for(;(D[_]&65535)!=D[_];)D[_+1]+=D[_]>>>16,D[_]&=65535,_++}function Y(D,_){this.g=D,this.h=_}function re(D,_){if(w(_))throw Error("division by zero");if(w(D))return new Y(f,f);if(P(D))return _=re(N(D),_),new Y(N(_.g),N(_.h));if(P(_))return _=re(D,N(_)),new Y(N(_.g),_.h);if(30<D.g.length){if(P(D)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var E=m,b=_;0>=b.l(D);)E=it(E),b=it(b);var A=le(E,1),M=le(b,1);for(b=le(b,2),E=le(E,2);!w(b);){var I=M.add(b);0>=I.l(D)&&(A=A.add(E),M=I),b=le(b,1),E=le(E,1)}return _=L(D,A.j(_)),new Y(A,_)}for(A=f;0<=D.l(_);){for(E=Math.max(1,Math.floor(D.m()/_.m())),b=Math.ceil(Math.log(E)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),M=u(E),I=M.j(_);P(I)||0<I.l(D);)E-=b,M=u(E),I=M.j(_);w(M)&&(M=m),A=A.add(M),D=L(D,I)}return new Y(A,D)}n.A=function(D){return re(this,D).h},n.and=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)&D.i(b);return new s(E,this.h&D.h)},n.or=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)|D.i(b);return new s(E,this.h|D.h)},n.xor=function(D){for(var _=Math.max(this.g.length,D.g.length),E=[],b=0;b<_;b++)E[b]=this.i(b)^D.i(b);return new s(E,this.h^D.h)};function it(D){for(var _=D.g.length+1,E=[],b=0;b<_;b++)E[b]=D.i(b)<<1|D.i(b-1)>>>31;return new s(E,D.h)}function le(D,_){var E=_>>5;_%=32;for(var b=D.g.length-E,A=[],M=0;M<b;M++)A[M]=0<_?D.i(M+E)>>>_|D.i(M+E+1)<<32-_:D.i(M+E);return new s(A,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,pI=_P.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,Pi=_P.Integer=s}).apply(typeof yP<"u"?yP:typeof self<"u"?self:typeof window<"u"?window:{});var um=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ki={};var mI,z6,gc,gI,Ju,dm,vI,yI,_I;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof um=="object"&&um];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var p=r;l=l.split(".");for(var g=0;g<l.length-1;g++){var x=l[g];if(!(x in p))break e;p=p[x]}l=l[l.length-1],g=p[l],h=h(g),h!=g&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function o(l,h){l instanceof String&&(l+="");var p=0,g=!1,x={next:function(){if(!g&&p<l.length){var O=p++;return{value:h(O,l[O]),done:!1}}return g=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.values",function(l){return l||function(){return o(this,function(h,p){return p})}});var s=s||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var x=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(x,g),l.apply(h,x)}}return function(){return l.apply(h,arguments)}}function m(l,h,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function v(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var g=p.slice();return g.push.apply(g,arguments),l.apply(this,g)}}function w(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(g,x,O){for(var B=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)B[Qe-2]=arguments[Qe];return h.prototype[x].apply(g,B)}}function P(l){let h=l.length;if(0<h){let p=Array(h);for(let g=0;g<h;g++)p[g]=l[g];return p}return[]}function N(l,h){for(let p=1;p<arguments.length;p++){let g=arguments[p];if(c(g)){let x=l.length||0,O=g.length||0;l.length=x+O;for(let B=0;B<O;B++)l[x+B]=g[B]}else l.push(g)}}class L{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function q(l){return/^[\s\xa0]*$/.test(l)}function Y(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function re(l){return re[" "](l),l}re[" "]=function(){};var it=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function le(l,h,p){for(let g in l)h.call(p,l[g],g,l)}function D(l,h){for(let p in l)h.call(void 0,l[p],p,l)}function _(l){let h={};for(let p in l)h[p]=l[p];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(l,h){let p,g;for(let x=1;x<arguments.length;x++){g=arguments[x];for(p in g)l[p]=g[p];for(let O=0;O<E.length;O++)p=E[O],Object.prototype.hasOwnProperty.call(g,p)&&(l[p]=g[p])}}function A(l){var h=1;l=l.split(":");let p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function M(l){a.setTimeout(()=>{throw l},0)}function I(){var l=_v;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class di{constructor(){this.h=this.g=null}add(h,p){let g=gl.get();g.set(h,p),this.h?this.h.next=g:this.g=g,this.h=g}}var gl=new L(()=>new DV,l=>l.reset());class DV{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let vl,yl=!1,_v=new di,Pb=()=>{let l=a.Promise.resolve(void 0);vl=()=>{l.then(SV)}};var SV=()=>{for(var l;l=I();){try{l.h.call(l.g)}catch(p){M(p)}var h=gl;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}yl=!1};function Zi(){this.s=this.s,this.C=this.C}Zi.prototype.s=!1,Zi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Zi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function sn(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}sn.prototype.h=function(){this.defaultPrevented=!0};var AV=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function _l(l,h){if(sn.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,g=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(it){e:{try{re(h.nodeName);var x=!0;break e}catch{}x=!1}x||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:RV[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&_l.aa.h.call(this)}}w(_l,sn);var RV={2:"touch",3:"pen",4:"mouse"};_l.prototype.h=function(){_l.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var wl="closure_listenable_"+(1e6*Math.random()|0),xV=0;function NV(l,h,p,g,x){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!g,this.ha=x,this.key=++xV,this.da=this.fa=!1}function th(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function nh(l){this.src=l,this.g={},this.h=0}nh.prototype.add=function(l,h,p,g,x){var O=l.toString();l=this.g[O],l||(l=this.g[O]=[],this.h++);var B=Ev(l,h,g,x);return-1<B?(h=l[B],p||(h.fa=!1)):(h=new NV(h,this.src,O,!!g,x),h.fa=p,l.push(h)),h};function wv(l,h){var p=h.type;if(p in l.g){var g=l.g[p],x=Array.prototype.indexOf.call(g,h,void 0),O;(O=0<=x)&&Array.prototype.splice.call(g,x,1),O&&(th(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Ev(l,h,p,g){for(var x=0;x<l.length;++x){var O=l[x];if(!O.da&&O.listener==h&&O.capture==!!p&&O.ha==g)return x}return-1}var Iv="closure_lm_"+(1e6*Math.random()|0),Tv={};function kb(l,h,p,g,x){if(g&&g.once)return Fb(l,h,p,g,x);if(Array.isArray(h)){for(var O=0;O<h.length;O++)kb(l,h[O],p,g,x);return null}return p=Sv(p),l&&l[wl]?l.K(h,p,u(g)?!!g.capture:!!g,x):Ob(l,h,p,!1,g,x)}function Ob(l,h,p,g,x,O){if(!h)throw Error("Invalid event type");var B=u(x)?!!x.capture:!!x,Qe=bv(l);if(Qe||(l[Iv]=Qe=new nh(l)),p=Qe.add(h,p,g,B,O),p.proxy)return p;if(g=MV(),p.proxy=g,g.src=l,g.listener=p,l.addEventListener)AV||(x=B),x===void 0&&(x=!1),l.addEventListener(h.toString(),g,x);else if(l.attachEvent)l.attachEvent(Vb(h.toString()),g);else if(l.addListener&&l.removeListener)l.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return p}function MV(){function l(p){return h.call(l.src,l.listener,p)}let h=PV;return l}function Fb(l,h,p,g,x){if(Array.isArray(h)){for(var O=0;O<h.length;O++)Fb(l,h[O],p,g,x);return null}return p=Sv(p),l&&l[wl]?l.L(h,p,u(g)?!!g.capture:!!g,x):Ob(l,h,p,!0,g,x)}function Lb(l,h,p,g,x){if(Array.isArray(h))for(var O=0;O<h.length;O++)Lb(l,h[O],p,g,x);else g=u(g)?!!g.capture:!!g,p=Sv(p),l&&l[wl]?(l=l.i,h=String(h).toString(),h in l.g&&(O=l.g[h],p=Ev(O,p,g,x),-1<p&&(th(O[p]),Array.prototype.splice.call(O,p,1),O.length==0&&(delete l.g[h],l.h--)))):l&&(l=bv(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Ev(h,p,g,x)),(p=-1<l?h[l]:null)&&Cv(p))}function Cv(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[wl])wv(h.i,l);else{var p=l.type,g=l.proxy;h.removeEventListener?h.removeEventListener(p,g,l.capture):h.detachEvent?h.detachEvent(Vb(p),g):h.addListener&&h.removeListener&&h.removeListener(g),(p=bv(h))?(wv(p,l),p.h==0&&(p.src=null,h[Iv]=null)):th(l)}}}function Vb(l){return l in Tv?Tv[l]:Tv[l]="on"+l}function PV(l,h){if(l.da)l=!0;else{h=new _l(h,this);var p=l.listener,g=l.ha||l.src;l.fa&&Cv(l),l=p.call(g,h)}return l}function bv(l){return l=l[Iv],l instanceof nh?l:null}var Dv="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sv(l){return typeof l=="function"?l:(l[Dv]||(l[Dv]=function(h){return l.handleEvent(h)}),l[Dv])}function an(){Zi.call(this),this.i=new nh(this),this.M=this,this.F=null}w(an,Zi),an.prototype[wl]=!0,an.prototype.removeEventListener=function(l,h,p,g){Lb(this,l,h,p,g)};function _n(l,h){var p,g=l.F;if(g)for(p=[];g;g=g.F)p.push(g);if(l=l.M,g=h.type||h,typeof h=="string")h=new sn(h,l);else if(h instanceof sn)h.target=h.target||l;else{var x=h;h=new sn(g,l),b(h,x)}if(x=!0,p)for(var O=p.length-1;0<=O;O--){var B=h.g=p[O];x=rh(B,g,!0,h)&&x}if(B=h.g=l,x=rh(B,g,!0,h)&&x,x=rh(B,g,!1,h)&&x,p)for(O=0;O<p.length;O++)B=h.g=p[O],x=rh(B,g,!1,h)&&x}an.prototype.N=function(){if(an.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],g=0;g<p.length;g++)th(p[g]);delete l.g[h],l.h--}}this.F=null},an.prototype.K=function(l,h,p,g){return this.i.add(String(l),h,!1,p,g)},an.prototype.L=function(l,h,p,g){return this.i.add(String(l),h,!0,p,g)};function rh(l,h,p,g){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var x=!0,O=0;O<h.length;++O){var B=h[O];if(B&&!B.da&&B.capture==p){var Qe=B.listener,Xt=B.ha||B.src;B.fa&&wv(l.i,B),x=Qe.call(Xt,g)!==!1&&x}}return x&&!g.defaultPrevented}function Ub(l,h,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function jb(l){l.g=Ub(()=>{l.g=null,l.i&&(l.i=!1,jb(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class kV extends Zi{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:jb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function El(l){Zi.call(this),this.h=l,this.g={}}w(El,Zi);var Bb=[];function $b(l){le(l.g,function(h,p){this.g.hasOwnProperty(p)&&Cv(h)},l),l.g={}}El.prototype.N=function(){El.aa.N.call(this),$b(this)},El.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Av=a.JSON.stringify,OV=a.JSON.parse,FV=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Rv(){}Rv.prototype.h=null;function Hb(l){return l.h||(l.h=l.i())}function qb(){}var Il={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xv(){sn.call(this,"d")}w(xv,sn);function Nv(){sn.call(this,"c")}w(Nv,sn);var Yo={},Wb=null;function ih(){return Wb=Wb||new an}Yo.La="serverreachability";function zb(l){sn.call(this,Yo.La,l)}w(zb,sn);function Tl(l){let h=ih();_n(h,new zb(h))}Yo.STAT_EVENT="statevent";function Gb(l,h){sn.call(this,Yo.STAT_EVENT,l),this.stat=h}w(Gb,sn);function wn(l){let h=ih();_n(h,new Gb(h,l))}Yo.Ma="timingevent";function Kb(l,h){sn.call(this,Yo.Ma,l),this.size=h}w(Kb,sn);function Cl(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function bl(){this.g=!0}bl.prototype.xa=function(){this.g=!1};function LV(l,h,p,g,x,O){l.info(function(){if(l.g)if(O)for(var B="",Qe=O.split("&"),Xt=0;Xt<Qe.length;Xt++){var $e=Qe[Xt].split("=");if(1<$e.length){var cn=$e[0];$e=$e[1];var ln=cn.split("_");B=2<=ln.length&&ln[1]=="type"?B+(cn+"="+$e+"&"):B+(cn+"=redacted&")}}else B=null;else B=O;return"XMLHTTP REQ ("+g+") [attempt "+x+"]: "+h+`
`+p+`
`+B})}function VV(l,h,p,g,x,O,B){l.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+x+"]: "+h+`
`+p+`
`+O+" "+B})}function la(l,h,p,g){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+jV(l,p)+(g?" "+g:"")})}function UV(l,h){l.info(function(){return"TIMEOUT: "+h})}bl.prototype.info=function(){};function jV(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var g=p[l];if(!(2>g.length)){var x=g[1];if(Array.isArray(x)&&!(1>x.length)){var O=x[0];if(O!="noop"&&O!="stop"&&O!="close")for(var B=1;B<x.length;B++)x[B]=""}}}}return Av(p)}catch{return h}}var oh={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Yb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Mv;function sh(){}w(sh,Rv),sh.prototype.g=function(){return new XMLHttpRequest},sh.prototype.i=function(){return{}},Mv=new sh;function Ji(l,h,p,g){this.j=l,this.i=h,this.l=p,this.R=g||1,this.U=new El(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qb}function Qb(){this.i=null,this.g="",this.h=!1}var Zb={},Pv={};function kv(l,h,p){l.L=1,l.v=uh(hi(h)),l.m=p,l.P=!0,Jb(l,null)}function Jb(l,h){l.F=Date.now(),ah(l),l.A=hi(l.v);var p=l.A,g=l.R;Array.isArray(g)||(g=[String(g)]),hD(p.i,"t",g),l.C=0,p=l.j.J,l.h=new Qb,l.g=xD(l.j,p?h:null,!l.m),0<l.O&&(l.M=new kV(m(l.Y,l,l.g),l.O)),h=l.U,p=l.g,g=l.ca;var x="readystatechange";Array.isArray(x)||(x&&(Bb[0]=x.toString()),x=Bb);for(var O=0;O<x.length;O++){var B=kb(p,x[O],g||h.handleEvent,!1,h.h||h);if(!B)break;h.g[B.key]=B}h=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Tl(),LV(l.i,l.u,l.A,l.l,l.R,l.m)}Ji.prototype.ca=function(l){l=l.target;let h=this.M;h&&fi(l)==3?h.j():this.Y(l)},Ji.prototype.Y=function(l){try{if(l==this.g)e:{let ln=fi(this.g);var h=this.g.Ba();let ha=this.g.Z();if(!(3>ln)&&(ln!=3||this.g&&(this.h.h||this.g.oa()||_D(this.g)))){this.J||ln!=4||h==7||(h==8||0>=ha?Tl(3):Tl(2)),Ov(this);var p=this.g.Z();this.X=p;t:if(Xb(this)){var g=_D(this.g);l="";var x=g.length,O=fi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qo(this),Dl(this);var B="";break t}this.h.i=new a.TextDecoder}for(h=0;h<x;h++)this.h.h=!0,l+=this.h.i.decode(g[h],{stream:!(O&&h==x-1)});g.length=0,this.h.g+=l,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=p==200,VV(this.i,this.u,this.A,this.l,this.R,ln,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Xt=this.g;if((Qe=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Qe)){var $e=Qe;break t}}$e=null}if(p=$e)la(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fv(this,p);else{this.o=!1,this.s=3,wn(12),Qo(this),Dl(this);break e}}if(this.P){p=!0;let Ir;for(;!this.J&&this.C<B.length;)if(Ir=BV(this,B),Ir==Pv){ln==4&&(this.s=4,wn(14),p=!1),la(this.i,this.l,null,"[Incomplete Response]");break}else if(Ir==Zb){this.s=4,wn(15),la(this.i,this.l,B,"[Invalid Chunk]"),p=!1;break}else la(this.i,this.l,Ir,null),Fv(this,Ir);if(Xb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||B.length!=0||this.h.h||(this.s=1,wn(16),p=!1),this.o=this.o&&p,!p)la(this.i,this.l,B,"[Invalid Chunked Response]"),Qo(this),Dl(this);else if(0<B.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),$v(cn),cn.M=!0,wn(11))}}else la(this.i,this.l,B,null),Fv(this,B);ln==4&&Qo(this),this.o&&!this.J&&(ln==4?DD(this.j,this):(this.o=!1,ah(this)))}else i2(this.g),p==400&&0<B.indexOf("Unknown SID")?(this.s=3,wn(12)):(this.s=0,wn(13)),Qo(this),Dl(this)}}}catch{}finally{}};function Xb(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function BV(l,h){var p=l.C,g=h.indexOf(`
`,p);return g==-1?Pv:(p=Number(h.substring(p,g)),isNaN(p)?Zb:(g+=1,g+p>h.length?Pv:(h=h.slice(g,g+p),l.C=g+p,h)))}Ji.prototype.cancel=function(){this.J=!0,Qo(this)};function ah(l){l.S=Date.now()+l.I,eD(l,l.I)}function eD(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Cl(m(l.ba,l),h)}function Ov(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Ji.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(UV(this.i,this.A),this.L!=2&&(Tl(),wn(17)),Qo(this),this.s=2,Dl(this)):eD(this,this.S-l)};function Dl(l){l.j.G==0||l.J||DD(l.j,l)}function Qo(l){Ov(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,$b(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Fv(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Lv(p.h,l))){if(!l.K&&Lv(p.h,l)&&p.G==3){try{var g=p.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var x=g;if(x[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)mh(p),fh(p);else break e;Bv(p),wn(18)}}else p.za=x[1],0<p.za-p.T&&37500>x[2]&&p.F&&p.v==0&&!p.C&&(p.C=Cl(m(p.Za,p),6e3));if(1>=rD(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Jo(p,11)}else if((l.K||p.g==l)&&mh(p),!q(h))for(x=p.Da.g.parse(h),h=0;h<x.length;h++){let $e=x[h];if(p.T=$e[0],$e=$e[1],p.G==2)if($e[0]=="c"){p.K=$e[1],p.ia=$e[2];let cn=$e[3];cn!=null&&(p.la=cn,p.j.info("VER="+p.la));let ln=$e[4];ln!=null&&(p.Aa=ln,p.j.info("SVER="+p.Aa));let ha=$e[5];ha!=null&&typeof ha=="number"&&0<ha&&(g=1.5*ha,p.L=g,p.j.info("backChannelRequestTimeoutMs_="+g)),g=p;let Ir=l.g;if(Ir){let vh=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vh){var O=g.h;O.g||vh.indexOf("spdy")==-1&&vh.indexOf("quic")==-1&&vh.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Vv(O,O.h),O.h=null))}if(g.D){let Hv=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;Hv&&(g.ya=Hv,ot(g.I,g.D,Hv))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),g=p;var B=l;if(g.qa=RD(g,g.J?g.ia:null,g.W),B.K){iD(g.h,B);var Qe=B,Xt=g.L;Xt&&(Qe.I=Xt),Qe.B&&(Ov(Qe),ah(Qe)),g.g=B}else CD(g);0<p.i.length&&ph(p)}else $e[0]!="stop"&&$e[0]!="close"||Jo(p,7);else p.G==3&&($e[0]=="stop"||$e[0]=="close"?$e[0]=="stop"?Jo(p,7):jv(p):$e[0]!="noop"&&p.l&&p.l.ta($e),p.v=0)}}Tl(4)}catch{}}var $V=class{constructor(l,h){this.g=l,this.map=h}};function tD(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function nD(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function rD(l){return l.h?1:l.g?l.g.size:0}function Lv(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Vv(l,h){l.g?l.g.add(h):l.h=h}function iD(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}tD.prototype.cancel=function(){if(this.i=oD(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function oD(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let p of l.g.values())h=h.concat(p.D);return h}return P(l.i)}function HV(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,g=0;g<p;g++)h.push(l[g]);return h}h=[],p=0;for(g in l)h[p++]=l[g];return h}function qV(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(let g in l)h[p++]=g;return h}}}function sD(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=qV(l),g=HV(l),x=g.length,O=0;O<x;O++)h.call(void 0,g[O],p&&p[O],l)}var aD=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WV(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var g=l[p].indexOf("="),x=null;if(0<=g){var O=l[p].substring(0,g);x=l[p].substring(g+1)}else O=l[p];h(O,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}function Zo(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Zo){this.h=l.h,ch(this,l.j),this.o=l.o,this.g=l.g,lh(this,l.s),this.l=l.l;var h=l.i,p=new Rl;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),cD(this,p),this.m=l.m}else l&&(h=String(l).match(aD))?(this.h=!1,ch(this,h[1]||"",!0),this.o=Sl(h[2]||""),this.g=Sl(h[3]||"",!0),lh(this,h[4]),this.l=Sl(h[5]||"",!0),cD(this,h[6]||"",!0),this.m=Sl(h[7]||"")):(this.h=!1,this.i=new Rl(null,this.h))}Zo.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Al(h,lD,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Al(h,lD,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Al(p,p.charAt(0)=="/"?KV:GV,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Al(p,QV)),l.join("")};function hi(l){return new Zo(l)}function ch(l,h,p){l.j=p?Sl(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function lh(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function cD(l,h,p){h instanceof Rl?(l.i=h,ZV(l.i,l.h)):(p||(h=Al(h,YV)),l.i=new Rl(h,l.h))}function ot(l,h,p){l.i.set(h,p)}function uh(l){return ot(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Sl(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Al(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,zV),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function zV(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var lD=/[#\/\?@]/g,GV=/[#\?:]/g,KV=/[#\?]/g,YV=/[#\?@]/g,QV=/#/g;function Rl(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Xi(l){l.g||(l.g=new Map,l.h=0,l.i&&WV(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Rl.prototype,n.add=function(l,h){Xi(this),this.i=null,l=ua(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function uD(l,h){Xi(l),h=ua(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function dD(l,h){return Xi(l),h=ua(l,h),l.g.has(h)}n.forEach=function(l,h){Xi(this),this.g.forEach(function(p,g){p.forEach(function(x){l.call(h,x,g,this)},this)},this)},n.na=function(){Xi(this);let l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let g=0;g<h.length;g++){let x=l[g];for(let O=0;O<x.length;O++)p.push(h[g])}return p},n.V=function(l){Xi(this);let h=[];if(typeof l=="string")dD(this,l)&&(h=h.concat(this.g.get(ua(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Xi(this),this.i=null,l=ua(this,l),dD(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function hD(l,h,p){uD(l,h),0<p.length&&(l.i=null,l.g.set(ua(l,h),P(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var g=h[p];let O=encodeURIComponent(String(g)),B=this.V(g);for(g=0;g<B.length;g++){var x=O;B[g]!==""&&(x+="="+encodeURIComponent(String(B[g]))),l.push(x)}}return this.i=l.join("&")};function ua(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function ZV(l,h){h&&!l.j&&(Xi(l),l.i=null,l.g.forEach(function(p,g){var x=g.toLowerCase();g!=x&&(uD(this,g),hD(this,x,p))},l)),l.j=h}function JV(l,h){let p=new bl;if(a.Image){let g=new Image;g.onload=v(eo,p,"TestLoadImage: loaded",!0,h,g),g.onerror=v(eo,p,"TestLoadImage: error",!1,h,g),g.onabort=v(eo,p,"TestLoadImage: abort",!1,h,g),g.ontimeout=v(eo,p,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=l}else h(!1)}function XV(l,h){let p=new bl,g=new AbortController,x=setTimeout(()=>{g.abort(),eo(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:g.signal}).then(O=>{clearTimeout(x),O.ok?eo(p,"TestPingServer: ok",!0,h):eo(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(x),eo(p,"TestPingServer: error",!1,h)})}function eo(l,h,p,g,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),g(p)}catch{}}function e2(){this.g=new FV}function t2(l,h,p){let g=p||"";try{sD(l,function(x,O){let B=x;u(x)&&(B=Av(x)),h.push(g+O+"="+encodeURIComponent(B))})}catch(x){throw h.push(g+"type="+encodeURIComponent("_badmap")),x}}function xl(l){this.l=l.Ub||null,this.j=l.eb||!1}w(xl,Rv),xl.prototype.g=function(){return new dh(this.l,this.j)},xl.prototype.i=function(l){return function(){return l}}({});function dh(l,h){an.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(dh,an),n=dh.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Ml(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Nl(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ml(this)),this.g&&(this.readyState=3,Ml(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fD(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function fD(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Nl(this):Ml(this),this.readyState==3&&fD(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Nl(this))},n.Qa=function(l){this.g&&(this.response=l,Nl(this))},n.ga=function(){this.g&&Nl(this)};function Nl(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ml(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function Ml(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(dh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function pD(l){let h="";return le(l,function(p,g){h+=g,h+=":",h+=p,h+=`\r
`}),h}function Uv(l,h,p){e:{for(g in p){var g=!1;break e}g=!0}g||(p=pD(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):ot(l,h,p))}function wt(l){an.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(wt,an);var n2=/^https?$/i,r2=["POST","PUT"];n=wt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Mv.g(),this.v=this.o?Hb(this.o):Hb(Mv),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(O){mD(this,O);return}if(l=p||"",p=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var x in g)p.set(x,g[x]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let O of g.keys())p.set(O,g.get(O));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(p.keys()).find(O=>O.toLowerCase()=="content-type"),x=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(r2,h,void 0))||g||x||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,B]of p)this.g.setRequestHeader(O,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yD(this),this.u=!0,this.g.send(l),this.u=!1}catch(O){mD(this,O)}};function mD(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,gD(l),hh(l)}function gD(l){l.A||(l.A=!0,_n(l,"complete"),_n(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,_n(this,"complete"),_n(this,"abort"),hh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hh(this,!0)),wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?vD(this):this.bb())},n.bb=function(){vD(this)};function vD(l){if(l.h&&typeof s<"u"&&(!l.v[1]||fi(l)!=4||l.Z()!=2)){if(l.u&&fi(l)==4)Ub(l.Ea,0,l);else if(_n(l,"readystatechange"),fi(l)==4){l.h=!1;try{let B=l.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var g;if(g=B===0){var x=String(l.D).match(aD)[1]||null;!x&&a.self&&a.self.location&&(x=a.self.location.protocol.slice(0,-1)),g=!n2.test(x?x.toLowerCase():"")}p=g}if(p)_n(l,"complete"),_n(l,"success");else{l.m=6;try{var O=2<fi(l)?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.Z()+"]",gD(l)}}finally{hh(l)}}}}function hh(l,h){if(l.g){yD(l);let p=l.g,g=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||_n(l,"ready");try{p.onreadystatechange=g}catch{}}}function yD(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function fi(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<fi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),OV(h)}};function _D(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function i2(l){let h={};l=(l.g&&2<=fi(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<l.length;g++){if(q(l[g]))continue;var p=A(l[g]);let x=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let O=h[x]||[];h[x]=O,O.push(p)}D(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pl(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function wD(l){this.Aa=0,this.i=[],this.j=new bl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pl("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pl("baseRetryDelayMs",5e3,l),this.cb=Pl("retryDelaySeedMs",1e4,l),this.Wa=Pl("forwardChannelMaxRetries",2,l),this.wa=Pl("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new tD(l&&l.concurrentRequestLimit),this.Da=new e2,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=wD.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,g){wn(0),this.W=l,this.H=h||{},p&&g!==void 0&&(this.H.OSID=p,this.H.OAID=g),this.F=this.X,this.I=RD(this,null,this.W),ph(this)};function jv(l){if(ED(l),l.G==3){var h=l.U++,p=hi(l.I);if(ot(p,"SID",l.K),ot(p,"RID",h),ot(p,"TYPE","terminate"),kl(l,p),h=new Ji(l,l.j,h),h.L=2,h.v=uh(hi(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=xD(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ah(h)}AD(l)}function fh(l){l.g&&($v(l),l.g.cancel(),l.g=null)}function ED(l){fh(l),l.u&&(a.clearTimeout(l.u),l.u=null),mh(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function ph(l){if(!nD(l.h)&&!l.s){l.s=!0;var h=l.Ga;vl||Pb(),yl||(vl(),yl=!0),_v.add(h,l),l.B=0}}function o2(l,h){return rD(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Cl(m(l.Ga,l,h),SD(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let x=new Ji(this,this.j,l),O=this.o;if(this.S&&(O?(O=_(O),b(O,this.S)):O=this.S),this.m!==null||this.O||(x.H=O,O=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var g=this.i[p];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=TD(this,x,h),p=hi(this.I),ot(p,"RID",l),ot(p,"CVER",22),this.D&&ot(p,"X-HTTP-Session-Id",this.D),kl(this,p),O&&(this.O?h="headers="+encodeURIComponent(String(pD(O)))+"&"+h:this.m&&Uv(p,this.m,O)),Vv(this.h,x),this.Ua&&ot(p,"TYPE","init"),this.P?(ot(p,"$req",h),ot(p,"SID","null"),x.T=!0,kv(x,p,null)):kv(x,p,h),this.G=2}}else this.G==3&&(l?ID(this,l):this.i.length==0||nD(this.h)||ID(this))};function ID(l,h){var p;h?p=h.l:p=l.U++;let g=hi(l.I);ot(g,"SID",l.K),ot(g,"RID",p),ot(g,"AID",l.T),kl(l,g),l.m&&l.o&&Uv(g,l.m,l.o),p=new Ji(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=TD(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Vv(l.h,p),kv(p,g,h)}function kl(l,h){l.H&&le(l.H,function(p,g){ot(h,g,p)}),l.l&&sD({},function(p,g){ot(h,g,p)})}function TD(l,h,p){p=Math.min(l.i.length,p);var g=l.l?m(l.l.Na,l.l,l):null;e:{var x=l.i;let O=-1;for(;;){let B=["count="+p];O==-1?0<p?(O=x[0].g,B.push("ofs="+O)):O=0:B.push("ofs="+O);let Qe=!0;for(let Xt=0;Xt<p;Xt++){let $e=x[Xt].g,cn=x[Xt].map;if($e-=O,0>$e)O=Math.max(0,x[Xt].g-100),Qe=!1;else try{t2(cn,B,"req"+$e+"_")}catch{g&&g(cn)}}if(Qe){g=B.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,g}function CD(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;vl||Pb(),yl||(vl(),yl=!0),_v.add(h,l),l.v=0}}function Bv(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Cl(m(l.Fa,l),SD(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,bD(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Cl(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,wn(10),fh(this),bD(this))};function $v(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function bD(l){l.g=new Ji(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=hi(l.qa);ot(h,"RID","rpc"),ot(h,"SID",l.K),ot(h,"AID",l.T),ot(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&ot(h,"TO",l.ja),ot(h,"TYPE","xmlhttp"),kl(l,h),l.m&&l.o&&Uv(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=uh(hi(h)),p.m=null,p.P=!0,Jb(p,l)}n.Za=function(){this.C!=null&&(this.C=null,fh(this),Bv(this),wn(19))};function mh(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function DD(l,h){var p=null;if(l.g==h){mh(l),$v(l),l.g=null;var g=2}else if(Lv(l.h,h))p=h.D,iD(l.h,h),g=1;else return;if(l.G!=0){if(h.o)if(g==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var x=l.B;g=ih(),_n(g,new Kb(g,p)),ph(l)}else CD(l);else if(x=h.s,x==3||x==0&&0<h.X||!(g==1&&o2(l,h)||g==2&&Bv(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),x){case 1:Jo(l,5);break;case 4:Jo(l,10);break;case 3:Jo(l,6);break;default:Jo(l,2)}}}function SD(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Jo(l,h){if(l.j.info("Error code "+h),h==2){var p=m(l.fb,l),g=l.Xa;let x=!g;g=new Zo(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ch(g,"https"),uh(g),x?JV(g.toString(),p):XV(g.toString(),p)}else wn(2);l.G=0,l.l&&l.l.sa(h),AD(l),ED(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),wn(2)):(this.j.info("Failed to ping google.com"),wn(1))};function AD(l){if(l.G=0,l.ka=[],l.l){let h=oD(l.h);(h.length!=0||l.i.length!=0)&&(N(l.ka,h),N(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function RD(l,h,p){var g=p instanceof Zo?hi(p):new Zo(p);if(g.g!="")h&&(g.g=h+"."+g.g),lh(g,g.s);else{var x=a.location;g=x.protocol,h=h?h+"."+x.hostname:x.hostname,x=+x.port;var O=new Zo(null);g&&ch(O,g),h&&(O.g=h),x&&lh(O,x),p&&(O.l=p),g=O}return p=l.D,h=l.ya,p&&h&&ot(g,p,h),ot(g,"VER",l.la),kl(l,g),g}function xD(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new wt(new xl({eb:p})):new wt(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ND(){}n=ND.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function gh(){}gh.prototype.g=function(l,h){return new zn(l,h)};function zn(l,h){an.call(this),this.g=new wD(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!q(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!q(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new da(this)}w(zn,an),zn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zn.prototype.close=function(){jv(this.g)},zn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Av(l),l=p);h.i.push(new $V(h.Ya++,l)),h.G==3&&ph(h)},zn.prototype.N=function(){this.g.l=null,delete this.j,jv(this.g),delete this.g,zn.aa.N.call(this)};function MD(l){xv.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}w(MD,xv);function PD(){Nv.call(this),this.status=1}w(PD,Nv);function da(l){this.g=l}w(da,ND),da.prototype.ua=function(){_n(this.g,"a")},da.prototype.ta=function(l){_n(this.g,new MD(l))},da.prototype.sa=function(l){_n(this.g,new PD)},da.prototype.ra=function(){_n(this.g,"b")},gh.prototype.createWebChannel=gh.prototype.g,zn.prototype.send=zn.prototype.o,zn.prototype.open=zn.prototype.m,zn.prototype.close=zn.prototype.close,_I=ki.createWebChannelTransport=function(){return new gh},yI=ki.getStatEventTarget=function(){return ih()},vI=ki.Event=Yo,dm=ki.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},oh.NO_ERROR=0,oh.TIMEOUT=8,oh.HTTP_ERROR=6,Ju=ki.ErrorCode=oh,Yb.COMPLETE="complete",gI=ki.EventType=Yb,qb.EventType=Il,Il.OPEN="a",Il.CLOSE="b",Il.ERROR="c",Il.MESSAGE="d",an.prototype.listen=an.prototype.K,gc=ki.WebChannel=qb,z6=ki.FetchXmlHttpFactory=xl,wt.prototype.listenOnce=wt.prototype.L,wt.prototype.getLastError=wt.prototype.Ka,wt.prototype.getLastErrorCode=wt.prototype.Ba,wt.prototype.getStatus=wt.prototype.Z,wt.prototype.getResponseJson=wt.prototype.Oa,wt.prototype.getResponseText=wt.prototype.oa,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Ha,mI=ki.XhrIo=wt}).apply(typeof um<"u"?um:typeof self<"u"?self:typeof window<"u"?window:{});var wP="@firebase/firestore";var Yt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");var Fc="11.2.0";var Us=new ir("@firebase/firestore");function vc(){return Us.logLevel}function G(n,...e){if(Us.logLevel<=en.DEBUG){let t=e.map(i0);Us.debug(`Firestore (${Fc}): ${n}`,...t)}}function Oi(n,...e){if(Us.logLevel<=en.ERROR){let t=e.map(i0);Us.error(`Firestore (${Fc}): ${n}`,...t)}}function Cc(n,...e){if(Us.logLevel<=en.WARN){let t=e.map(i0);Us.warn(`Firestore (${Fc}): ${n}`,...t)}}function i0(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ae(n="Unexpected state"){let e=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: `+n;throw Oi(e),new Error(e)}function Ge(n,e){n||ae()}function ve(n,e){return n}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},K=class extends Gn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ii=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ym=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},CI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yt.UNAUTHENTICATED))}shutdown(){}},bI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},DI=class{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ge(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new ii;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ii,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ii)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string"),new ym(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string"),new Yt(e)}},SI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},AI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new SI(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},RI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},xI=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ge(this.o===void 0);let r=o=>{o.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,G("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ge(typeof t.token=="string"),this.R=t.token,new RI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function G6(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var _m=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=G6(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function ke(n,e){return n<e?-1:n>e?1:0}function bc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Nt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ke(this.nanoseconds,e.nanoseconds):ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var we=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Nt(0,0))}static max(){return new n(new Nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var wm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ae(),r===void 0?r=e.length-t:r>e.length-t&&ae(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Math.sign(e.length-t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}},gt=class n extends wm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new K(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},K6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,er=class n extends wm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return K6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new K(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new K(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new K(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ne=class n{constructor(e){this.path=e}static fromPath(e){return new n(gt.fromString(e))}static fromName(e){return new n(gt.fromString(e).popFirst(5))}static empty(){return new n(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new gt(e.slice()))}};var NI=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};NI.UNKNOWN_ID=-1;function Y6(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=we.fromTimestamp(r===1e9?new Nt(t+1,0):new Nt(t,r));return new js(i,ne.empty(),e)}function Q6(n){return new js(n.readTime,n.key,-1)}var js=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(we.min(),ne.empty(),-1)}static max(){return new n(we.max(),ne.empty(),-1)}};function Z6(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ne.comparator(n.documentKey,e.documentKey),t!==0?t:ke(n.largestBatchId,e.largestBatchId))}var J6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",MI=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Lc(n){return y(this,null,function*(){if(n.code!==F.FAILED_PRECONDITION||n.message!==J6)throw n;G("LocalStore","Unexpectedly lost primary lease")})}var V=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let u=c;t(e[u]).next(d=>{s[u]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function X6(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vc(n){return n.name==="IndexedDbTransactionError"}var o0=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Xm(n){return n==null}function id(n){return n===0&&1/n==-1/0}function e5(n){return typeof n=="number"&&Number.isInteger(n)&&!id(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function t5(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=EP(e)),e=n5(n.get(t),e);return EP(e)}function n5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function EP(n){return n+""}var r5=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_ue=[...r5,"documentOverlays"],i5=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],o5=i5,s5=[...o5,"indexConfiguration","indexState","indexEntries"];var wue=[...s5,"globals"];function IP(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gs(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function nk(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Dt=class n{constructor(e,t){this.comparator=e,this.root=t||oi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,oi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ec(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ec(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ec(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ec(this.root,e,this.comparator,!0)}},Ec=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},oi=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();let e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}};oi.EMPTY=null,oi.RED=!0,oi.BLACK=!1;oi.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,t,r,i,o){return this}insert(e,t,r){return new oi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qt=class n{constructor(e){this.comparator=e,this.data=new Dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Em(this.data.getIterator())}getIteratorFrom(e){return new Em(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Em=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ri=class n{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new n([])}unionWith(e){let t=new Qt(er.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Im=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var pn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Im("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};pn.EMPTY_BYTE_STRING=new pn("");var a5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fi(n){if(Ge(!!n),typeof n=="string"){let e=0,t=a5.exec(n);if(Ge(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ht(n.seconds),nanos:ht(n.nanos)}}function ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Li(n){return typeof n=="string"?pn.fromBase64String(n):pn.fromUint8Array(n)}function s0(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function eg(n){let e=n.mapValue.fields.__previous_value__;return s0(e)?eg(e):e}function od(n){let e=Fi(n.mapValue.fields.__local_write_time__.timestampValue);return new Nt(e.seconds,e.nanos)}var PI=class{constructor(e,t,r,i,o,s,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Tm=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hm={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Lo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?s0(n)?4:ik(n)?9007199254740991:rk(n)?10:11:ae()}function ci(n,e){if(n===e)return!0;let t=Lo(n);if(t!==Lo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return od(n).isEqual(od(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Fi(i.timestampValue),a=Fi(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Li(i.bytesValue).isEqual(Li(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ht(i.geoPointValue.latitude)===ht(o.geoPointValue.latitude)&&ht(i.geoPointValue.longitude)===ht(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ht(i.integerValue)===ht(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=ht(i.doubleValue),a=ht(o.doubleValue);return s===a?id(s)===id(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return bc(n.arrayValue.values||[],e.arrayValue.values||[],ci);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(IP(s)!==IP(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!ci(s[c],a[c])))return!1;return!0}(n,e);default:return ae()}}function sd(n,e){return(n.values||[]).find(t=>ci(t,e))!==void 0}function Dc(n,e){if(n===e)return 0;let t=Lo(n),r=Lo(e);if(t!==r)return ke(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ke(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=ht(o.integerValue||o.doubleValue),c=ht(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return TP(n.timestampValue,e.timestampValue);case 4:return TP(od(n),od(e));case 5:return ke(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Li(o),c=Li(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=ke(a[u],c[u]);if(d!==0)return d}return ke(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=ke(ht(o.latitude),ht(s.latitude));return a!==0?a:ke(ht(o.longitude),ht(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return CP(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,u,d;let f=o.fields||{},m=s.fields||{},v=(a=f.value)===null||a===void 0?void 0:a.arrayValue,w=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=ke(((u=v?.values)===null||u===void 0?void 0:u.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return P!==0?P:CP(v,w)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===hm.mapValue&&s===hm.mapValue)return 0;if(o===hm.mapValue)return 1;if(s===hm.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),u=s.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let m=ke(c[f],d[f]);if(m!==0)return m;let v=Dc(a[c[f]],u[d[f]]);if(v!==0)return v}return ke(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ae()}}function TP(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ke(n,e);let t=Fi(n),r=Fi(e),i=ke(t.seconds,r.seconds);return i!==0?i:ke(t.nanos,r.nanos)}function CP(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Dc(t[i],r[i]);if(o)return o}return ke(t.length,r.length)}function Sc(n){return kI(n)}function kI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Fi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Li(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=kI(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${kI(t.fields[s])}`;return i+"}"}(n.mapValue):ae()}function mm(n){switch(Lo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=eg(n);return e?16+mm(e):16;case 5:return 2*n.stringValue.length;case 6:return Li(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+mm(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Gs(r.fields,(o,s)=>{i+=o.length+mm(s)}),i}(n.mapValue);default:throw ae()}}function bP(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function OI(n){return!!n&&"integerValue"in n}function a0(n){return!!n&&"arrayValue"in n}function DP(n){return!!n&&"nullValue"in n}function SP(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gm(n){return!!n&&"mapValue"in n}function rk(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ed(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Gs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ed(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ed(n.arrayValue.values[t]);return e}return Object.assign({},n)}function ik(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Lr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!gm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ed(t)}setAll(e){let t=er.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=ed(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());gm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ci(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];gm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gs(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ed(this.value))}};function ok(n){let e=[];return Gs(n.fields,(t,r)=>{let i=new er([t]);if(gm(r)){let o=ok(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new ri(e)}var Vr=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,we.min(),we.min(),we.min(),Lr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,we.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,we.min(),we.min(),Lr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,we.min(),we.min(),Lr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ac=class{constructor(e,t){this.position=e,this.inclusive=t}};function AP(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=ne.comparator(ne.fromName(s.referenceValue),t.key):r=Dc(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function RP(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ci(n.position[t],e.position[t]))return!1;return!0}var Rc=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function c5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Cm=class{},Ut=class n extends Cm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new LI(e,t,r):t==="array-contains"?new jI(e,r):t==="in"?new BI(e,r):t==="not-in"?new $I(e,r):t==="array-contains-any"?new HI(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new VI(e,r):new UI(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Dc(t,this.value)):t!==null&&Lo(this.value)===Lo(t)&&this.matchesComparison(Dc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ur=class n extends Cm{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return sk(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function sk(n){return n.op==="and"}function ak(n){return l5(n)&&sk(n)}function l5(n){for(let e of n.filters)if(e instanceof Ur)return!1;return!0}function FI(n){if(n instanceof Ut)return n.field.canonicalString()+n.op.toString()+Sc(n.value);if(ak(n))return n.filters.map(e=>FI(e)).join(",");{let e=n.filters.map(t=>FI(t)).join(",");return`${n.op}(${e})`}}function ck(n,e){return n instanceof Ut?function(r,i){return i instanceof Ut&&r.op===i.op&&r.field.isEqual(i.field)&&ci(r.value,i.value)}(n,e):n instanceof Ur?function(r,i){return i instanceof Ur&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&ck(s,i.filters[a]),!0):!1}(n,e):void ae()}function lk(n){return n instanceof Ut?function(t){return`${t.field.canonicalString()} ${t.op} ${Sc(t.value)}`}(n):n instanceof Ur?function(t){return t.op.toString()+" {"+t.getFilters().map(lk).join(" ,")+"}"}(n):"Filter"}var LI=class extends Ut{constructor(e,t,r){super(e,t,r),this.key=ne.fromName(r.referenceValue)}matches(e){let t=ne.comparator(e.key,this.key);return this.matchesComparison(t)}},VI=class extends Ut{constructor(e,t){super(e,"in",t),this.keys=uk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},UI=class extends Ut{constructor(e,t){super(e,"not-in",t),this.keys=uk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function uk(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ne.fromName(r.referenceValue))}var jI=class extends Ut{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return a0(t)&&sd(t.arrayValue,this.value)}},BI=class extends Ut{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&sd(this.value.arrayValue,t)}},$I=class extends Ut{constructor(e,t){super(e,"not-in",t)}matches(e){if(sd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!sd(this.value.arrayValue,t)}},HI=class extends Ut{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!a0(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>sd(this.value.arrayValue,r))}};var qI=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function xP(n,e=null,t=[],r=[],i=null,o=null,s=null){return new qI(n,e,t,r,i,o,s)}function c0(n){let e=ve(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>FI(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Xm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Sc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Sc(r)).join(",")),e.ue=t}return e.ue}function l0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!c5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ck(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!RP(n.startAt,e.startAt)&&RP(n.endAt,e.endAt)}function WI(n){return ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Bs=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function u5(n,e,t,r,i,o,s,a){return new Bs(n,e,t,r,i,o,s,a)}function u0(n){return new Bs(n)}function NP(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dk(n){return n.collectionGroup!==null}function td(n){let e=ve(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Qt(er.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Rc(o,r))}),t.has(er.keyField().canonicalString())||e.ce.push(new Rc(er.keyField(),r))}return e.ce}function si(n){let e=ve(n);return e.le||(e.le=d5(e,td(n))),e.le}function d5(n,e){if(n.limitType==="F")return xP(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Rc(i.field,o)});let t=n.endAt?new Ac(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ac(n.startAt.position,n.startAt.inclusive):null;return xP(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function zI(n,e){let t=n.filters.concat([e]);return new Bs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function GI(n,e,t){return new Bs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function tg(n,e){return l0(si(n),si(e))&&n.limitType===e.limitType}function hk(n){return`${c0(si(n))}|lt:${n.limitType}`}function yc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>lk(i)).join(", ")}]`),Xm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Sc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Sc(i)).join(",")),`Target(${r})`}(si(n))}; limitType=${n.limitType})`}function ng(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ne.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of td(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let u=AP(s,a,c);return s.inclusive?u<=0:u<0}(r.startAt,td(r),i)||r.endAt&&!function(s,a,c){let u=AP(s,a,c);return s.inclusive?u>=0:u>0}(r.endAt,td(r),i))}(n,e)}function h5(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fk(n){return(e,t)=>{let r=!1;for(let i of td(n)){let o=f5(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function f5(n,e,t){let r=n.field.isKeyField()?ne.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?Dc(c,u):ae()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}var Vi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gs(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return nk(this.inner)}size(){return this.innerSize}};var p5=new Dt(ne.comparator);function Ui(){return p5}var pk=new Dt(ne.comparator);function Xu(...n){let e=pk;for(let t of n)e=e.insert(t.key,t);return e}function mk(n){let e=pk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Os(){return nd()}function gk(){return nd()}function nd(){return new Vi(n=>n.toString(),(n,e)=>n.isEqual(e))}var m5=new Dt(ne.comparator),g5=new Qt(ne.comparator);function Pe(...n){let e=g5;for(let t of n)e=e.add(t);return e}var v5=new Qt(ke);function y5(){return v5}function d0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:id(e)?"-0":e}}function vk(n){return{integerValue:""+n}}function _5(n,e){return e5(e)?vk(e):d0(n,e)}var xc=class{constructor(){this._=void 0}};function w5(n,e,t){return n instanceof Nc?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&s0(o)&&(o=eg(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof $s?_k(n,e):n instanceof Hs?wk(n,e):function(i,o){let s=yk(i,o),a=MP(s)+MP(i.Pe);return OI(s)&&OI(i.Pe)?vk(a):d0(i.serializer,a)}(n,e)}function E5(n,e,t){return n instanceof $s?_k(n,e):n instanceof Hs?wk(n,e):t}function yk(n,e){return n instanceof Mc?function(r){return OI(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Nc=class extends xc{},$s=class extends xc{constructor(e){super(),this.elements=e}};function _k(n,e){let t=Ek(e);for(let r of n.elements)t.some(i=>ci(i,r))||t.push(r);return{arrayValue:{values:t}}}var Hs=class extends xc{constructor(e){super(),this.elements=e}};function wk(n,e){let t=Ek(e);for(let r of n.elements)t=t.filter(i=>!ci(i,r));return{arrayValue:{values:t}}}var Mc=class extends xc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function MP(n){return ht(n.integerValue||n.doubleValue)}function Ek(n){return a0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function I5(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof $s&&i instanceof $s||r instanceof Hs&&i instanceof Hs?bc(r.elements,i.elements,ci):r instanceof Mc&&i instanceof Mc?ci(r.Pe,i.Pe):r instanceof Nc&&i instanceof Nc}(n.transform,e.transform)}var KI=class{constructor(e,t){this.version=e,this.transformResults=t}},Vs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function vm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Pc=class{};function Ik(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bm(n.key,Vs.none()):new qs(n.key,n.data,Vs.none());{let t=n.data,r=Lr.empty(),i=new Qt(er.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new ji(n.key,r,new ri(i.toArray()),Vs.none())}}function T5(n,e,t){n instanceof qs?function(i,o,s){let a=i.value.clone(),c=kP(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof ji?function(i,o,s){if(!vm(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=kP(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(Tk(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function rd(n,e,t,r){return n instanceof qs?function(o,s,a,c){if(!vm(o.precondition,s))return a;let u=o.value.clone(),d=OP(o.fieldTransforms,c,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof ji?function(o,s,a,c){if(!vm(o.precondition,s))return a;let u=OP(o.fieldTransforms,c,s),d=s.data;return d.setAll(Tk(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(o,s,a){return vm(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function C5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=yk(r.transform,i||null);o!=null&&(t===null&&(t=Lr.empty()),t.set(r.field,o))}return t||null}function PP(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&bc(r,i,(o,s)=>I5(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var qs=class extends Pc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ji=class extends Pc{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Tk(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function kP(n,e,t){let r=new Map;Ge(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,E5(s,a,t[i]))}return r}function OP(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,w5(o,s,e))}return r}var bm=class extends Pc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},YI=class extends Pc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var QI=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&T5(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=rd(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=rd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=gk();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=Ik(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(we.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&bc(this.mutations,e.mutations,(t,r)=>PP(t,r))&&bc(this.baseMutations,e.baseMutations,(t,r)=>PP(t,r))}},ZI=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ge(e.mutations.length===r.length);let i=function(){return m5}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var JI=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var XI=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Lt,Ue;function b5(n){switch(n){default:return ae();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function Ck(n){if(n===void 0)return Oi("GRPC error has no .code"),F.UNKNOWN;switch(n){case Lt.OK:return F.OK;case Lt.CANCELLED:return F.CANCELLED;case Lt.UNKNOWN:return F.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return F.INTERNAL;case Lt.UNAVAILABLE:return F.UNAVAILABLE;case Lt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Lt.NOT_FOUND:return F.NOT_FOUND;case Lt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Lt.ABORTED:return F.ABORTED;case Lt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Lt.DATA_LOSS:return F.DATA_LOSS;default:return ae()}}(Ue=Lt||(Lt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";var FP=null;function D5(){return new TextEncoder}var S5=new Pi([4294967295,4294967295],0);function LP(n){let e=D5().encode(n),t=new pI;return t.update(e),new Uint8Array(t.digest())}function VP(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Pi([t,r],0),new Pi([i,o],0)]}var eT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fs(`Invalid padding: ${t}`);if(r<0)throw new Fs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fs(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Pi.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Pi.fromNumber(r)));return i.compare(S5)===1&&(i=new Pi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}Ee(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=LP(e),[r,i]=VP(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);if(!this.Ee(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Te===0)return;let t=LP(e),[r,i]=VP(t);for(let o=0;o<this.hashCount;o++){let s=this.de(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Fs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Dm=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ad.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(we.min(),i,new Dt(ke),Ui(),Pe())}},ad=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Pe(),Pe(),Pe())}};var Ic=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Sm=class{constructor(e,t){this.targetId=e,this.me=t}},Am=class{constructor(e,t,r=pn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Rm=class{constructor(){this.fe=0,this.ge=UP(),this.pe=pn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Pe(),t=Pe(),r=Pe();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new ad(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=UP()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},tT=class{constructor(e){this.Be=e,this.Le=new Map,this.ke=Ui(),this.qe=fm(),this.Qe=fm(),this.Ke=new Dt(ke)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Le.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){let t=e.targetId,r=e.me.count,i=this.Ye(t);if(i){let o=i.target;if(WI(o))if(r===0){let s=new ne(o.path);this.We(t,s,Vr.newNoDocument(s,we.min()))}else Ge(r===1);else{let s=this.Ze(t);if(s!==r){let a=this.Xe(e),c=a?this.et(a,e,s):1;if(c!==0){this.He(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,u)}FP?.tt(function(d,f,m,v,w){var P,N,L,q,Y,re;let it={localCacheCount:d,existenceFilterCount:f.count,databaseId:m.database,projectId:m.projectId},le=f.unchangedNames;return le&&(it.bloomFilter={applied:w===0,hashCount:(P=le?.hashCount)!==null&&P!==void 0?P:0,bitmapLength:(q=(L=(N=le?.bits)===null||N===void 0?void 0:N.bitmap)===null||L===void 0?void 0:L.length)!==null&&q!==void 0?q:0,padding:(re=(Y=le?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&re!==void 0?re:0,mightContain:D=>{var _;return(_=v?.mightContain(D))!==null&&_!==void 0&&_}}),it}(s,e.me,this.Be.nt(),a,c))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Li(r).toUint8Array()}catch(c){if(c instanceof Im)return Cc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new eT(s,i,o)}catch(c){return Cc(c instanceof Fs?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){let r=this.Be.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Be.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.We(t,o,null),i++)}),i}it(e){let t=new Map;this.Le.forEach((o,s)=>{let a=this.Ye(s);if(a){if(o.current&&WI(a.target)){let c=new ne(a.target.path);this.st(c).has(s)||this.ot(s,c)||this.We(s,c,Vr.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=Pe();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new Dm(e,t,this.Ke,this.ke,r);return this.ke=Ui(),this.qe=fm(),this.Qe=fm(),this.Ke=new Dt(ke),i}Ue(e,t){if(!this.je(e))return;let r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;let i=this.ze(e);this.ot(e,t)?i.Fe(t,1):i.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Le.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Le.get(e);return t||(t=new Rm,this.Le.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new Qt(ke),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Qt(ke),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||G("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Le.get(e);return t&&t.Se?null:this.Be.ut(e)}He(e){this.Le.set(e,new Rm),this.Be.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}};function fm(){return new Dt(ne.comparator)}function UP(){return new Dt(ne.comparator)}var A5={asc:"ASCENDING",desc:"DESCENDING"},R5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},x5={and:"AND",or:"OR"},nT=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function rT(n,e){return n.useProto3Json||Xm(e)?e:{value:e}}function xm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function N5(n,e){return xm(n,e.toTimestamp())}function ai(n){return Ge(!!n),we.fromTimestamp(function(t){let r=Fi(t);return new Nt(r.seconds,r.nanos)}(n))}function h0(n,e){return iT(n,e).canonicalString()}function iT(n,e){let t=function(i){return new gt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Dk(n){let e=gt.fromString(n);return Ge(Nk(e)),e}function oT(n,e){return h0(n.databaseId,e.path)}function wI(n,e){let t=Dk(e);if(t.get(1)!==n.databaseId.projectId)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(Ak(t))}function Sk(n,e){return h0(n.databaseId,e)}function M5(n){let e=Dk(n);return e.length===4?gt.emptyPath():Ak(e)}function sT(n){return new gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ak(n){return Ge(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function jP(n,e,t){return{name:oT(n,e),fields:t.value.mapValue.fields}}function P5(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,d){return u.useProto3Json?(Ge(d===void 0||typeof d=="string"),pn.fromBase64String(d||"")):(Ge(d===void 0||d instanceof Buffer||d instanceof Uint8Array),pn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(u){let d=u.code===void 0?F.UNKNOWN:Ck(u.code);return new K(d,u.message||"")}(s);t=new Am(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=wI(n,r.document.name),o=ai(r.document.updateTime),s=r.document.createTime?ai(r.document.createTime):we.min(),a=new Lr({mapValue:{fields:r.document.fields}}),c=Vr.newFoundDocument(i,o,s,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Ic(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=wI(n,r.document),o=r.readTime?ai(r.readTime):we.min(),s=Vr.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Ic([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=wI(n,r.document),o=r.removedTargetIds||[];t=new Ic([],o,i,null)}else{if(!("filter"in e))return ae();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new XI(i,o),a=r.targetId;t=new Sm(a,s)}}return t}function k5(n,e){let t;if(e instanceof qs)t={update:jP(n,e.key,e.value)};else if(e instanceof bm)t={delete:oT(n,e.key)};else if(e instanceof ji)t={update:jP(n,e.key,e.data),updateMask:H5(e.fieldMask)};else{if(!(e instanceof YI))return ae();t={verify:oT(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Nc)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $s)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Hs)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Mc)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw ae()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:N5(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ae()}(n,e.precondition)),t}function O5(n,e){return n&&n.length>0?(Ge(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?ai(i.updateTime):ai(o);return s.isEqual(we.min())&&(s=ai(o)),new KI(s,i.transformResults||[])}(t,e))):[]}function F5(n,e){return{documents:[Sk(n,e.path)]}}function L5(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Sk(n,i);let o=function(u){if(u.length!==0)return xk(Ur.create(u,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:_c(m.field),direction:j5(m.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=rT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ct:t,parent:i}}function V5(n){let e=M5(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Ge(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(f){let m=Rk(f);return m instanceof Ur&&ak(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(m=>function(w){return new Rc(wc(w.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Xm(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(f){let m=!!f.before,v=f.values||[];return new Ac(v,m)}(t.startAt));let u=null;return t.endAt&&(u=function(f){let m=!f.before,v=f.values||[];return new Ac(v,m)}(t.endAt)),u5(e,i,s,o,a,"F",c,u)}function U5(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Rk(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=wc(t.unaryFilter.field);return Ut.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=wc(t.unaryFilter.field);return Ut.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=wc(t.unaryFilter.field);return Ut.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=wc(t.unaryFilter.field);return Ut.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(n):n.fieldFilter!==void 0?function(t){return Ut.create(wc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ur.create(t.compositeFilter.filters.map(r=>Rk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ae()}}(t.compositeFilter.op))}(n):ae()}function j5(n){return A5[n]}function B5(n){return R5[n]}function $5(n){return x5[n]}function _c(n){return{fieldPath:n.canonicalString()}}function wc(n){return er.fromServerFormat(n.fieldPath)}function xk(n){return n instanceof Ut?function(t){if(t.op==="=="){if(SP(t.value))return{unaryFilter:{field:_c(t.field),op:"IS_NAN"}};if(DP(t.value))return{unaryFilter:{field:_c(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(SP(t.value))return{unaryFilter:{field:_c(t.field),op:"IS_NOT_NAN"}};if(DP(t.value))return{unaryFilter:{field:_c(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_c(t.field),op:B5(t.op),value:t.value}}}(n):n instanceof Ur?function(t){let r=t.getFilters().map(i=>xk(i));return r.length===1?r[0]:{compositeFilter:{op:$5(t.op),filters:r}}}(n):ae()}function H5(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Nk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var cd=class n{constructor(e,t,r,i,o=we.min(),s=we.min(),a=pn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var aT=class{constructor(e){this.ht=e}};function q5(n){let e=V5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?GI(e,e.limit,"L"):e}var Nm=class{constructor(){}dt(e,t){this.Et(e,t),t.At()}Et(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(ht(e.integerValue));else if("doubleValue"in e){let r=ht(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),id(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),typeof r=="string"&&(r=Fi(r)),t.ft(`${r.seconds||""}`),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(Li(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?ik(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):rk(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):ae()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let r=e.fields||{};this.Rt(t,55);for(let i of Object.keys(r))this.gt(i,t),this.Et(r[i],t)}bt(e,t){var r,i;let o=e.fields||{};this.Rt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(t,15),t.Vt(ht(a)),this.gt(s,t),this.Et(o[s],t)}vt(e,t){let r=e.values||[];this.Rt(t,50);for(let i of r)this.Et(i,t)}St(e,t){this.Rt(t,37),ne.fromName(e).path.forEach(r=>{this.Rt(t,60),this.Ct(r,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};Nm.Ft=new Nm;var cT=class{constructor(){this.ln=new lT}addToCollectionParentIndex(e,t){return this.ln.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(js.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(js.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}},lT=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qt(gt.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(gt.comparator)).toArray()}};var Iue=new Uint8Array(0);var BP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mr=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};mr.DEFAULT_COLLECTION_PERCENTILE=10,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mr.DEFAULT=new mr(41943040,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mr.DISABLED=new mr(-1,0,0);var ld=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};function $P([n,e],[t,r]){let i=ke(n,t);return i===0?ke(e,r):i}var uT=class{constructor(e){this.Gn=e,this.buffer=new Qt($P),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();$P(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},dT=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){G("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vc(t)?G("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Lc(t)}yield this.Yn(3e5)}))}},hT=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return V.resolve(o0.oe);let r=new uT(t);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(G("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(BP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(G("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BP):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,i,o,s,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(G("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),vc()<=en.DEBUG&&G("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function W5(n,e){return new hT(n,e)}var fT=class{constructor(){this.changes=new Vi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var pT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var mT=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&rd(r.mutation,i,ri.empty(),Nt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Pe()){let i=Os();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Xu();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Os();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Pe()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Ui(),s=nd(),a=function(){return nd()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof ji)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),rd(d.mutation,u,d.mutation.getFieldMask(),Nt.now())):s.set(u.key,ri.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new pT(d,(f=s.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=nd(),i=new Dt((s,a)=>s-a),o=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||ri.empty();d=a.applyToLocalView(u,d),r.set(c,d);let f=(i.get(a.batchId)||Pe()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,f=gk();d.forEach(m=>{if(!o.has(m)){let v=Ik(t.get(m),r.get(m));v!==null&&f.set(m,v),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,f))}return V.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return ne.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):V.resolve(Os()),a=-1,c=o;return s.next(u=>V.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Pe())).next(d=>({batchId:a,changes:mk(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next(r=>{let i=Xu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Xu();return this.indexManager.getCollectionParents(e,o).next(a=>V.forEach(a,c=>{let u=function(f,m){return new Bs(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,m)=>{s=s.insert(f,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,Vr.newInvalidDocument(d)))});let a=Xu();return s.forEach((c,u)=>{let d=o.get(c);d!==void 0&&rd(d.mutation,u,ri.empty(),Nt.now()),ng(t,u)&&(a=a.insert(c,u))}),a})}};var gT=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return V.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ai(i.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(i){return{name:i.name,query:q5(i.bundledQuery),readTime:ai(i.readTime)}}(t)),V.resolve()}};var vT=class{constructor(){this.overlays=new Dt(ne.comparator),this.dr=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Os();return V.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.Tt(e,t,o)}),V.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.dr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.dr.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){let i=Os(),o=t.length+1,s=new ne(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Dt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=o.get(u.largestBatchId);d===null&&(d=Os(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=Os(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return V.resolve(a)}Tt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.dr.get(i.largestBatchId).delete(r.key);this.dr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new JI(t,r));let o=this.dr.get(t);o===void 0&&(o=Pe(),this.dr.set(t,o)),this.dr.set(t,o.add(r.key))}};var yT=class{constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}};var ud=class{constructor(){this.Er=new Qt(Vt.Ar),this.Rr=new Qt(Vt.Vr)}isEmpty(){return this.Er.isEmpty()}addReference(e,t){let r=new Vt(e,t);this.Er=this.Er.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.gr(new Vt(e,t))}pr(e,t){e.forEach(r=>this.removeReference(r,t))}yr(e){let t=new ne(new gt([])),r=new Vt(t,e),i=new Vt(t,e+1),o=[];return this.Rr.forEachInRange([r,i],s=>{this.gr(s),o.push(s.key)}),o}wr(){this.Er.forEach(e=>this.gr(e))}gr(e){this.Er=this.Er.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new ne(new gt([])),r=new Vt(t,e),i=new Vt(t,e+1),o=Pe();return this.Rr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Vt(e,0),r=this.Er.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Vt=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return ne.comparator(e.key,t.key)||ke(e.br,t.br)}static Vr(e,t){return ke(e.br,t.br)||ne.comparator(e.key,t.key)}};var _T=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new Qt(Vt.Ar)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new QI(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.vr=this.vr.add(new Vt(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(s)}lookupMutationBatch(e,t){return V.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Fr(r),o=i<0?0:i;return V.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Vt(t,0),i=new Vt(t,Number.POSITIVE_INFINITY),o=[];return this.vr.forEachInRange([r,i],s=>{let a=this.Cr(s.br);o.push(a)}),V.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qt(ke);return t.forEach(i=>{let o=new Vt(i,0),s=new Vt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([o,s],a=>{r=r.add(a.br)})}),V.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;ne.isDocumentKey(o)||(o=o.child(""));let s=new Vt(new ne(o),0),a=new Qt(ke);return this.vr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.br)),!0)},s),V.resolve(this.Mr(a))}Mr(e){let t=[];return e.forEach(r=>{let i=this.Cr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Ge(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return V.forEach(t.mutations,i=>{let o=new Vt(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Bn(e){}containsKey(e,t){let r=new Vt(t,0),i=this.vr.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var wT=class{constructor(e){this.Nr=e,this.docs=function(){return new Dt(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():Vr.newInvalidDocument(t))}getEntries(e,t){let r=Ui();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Vr.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ui(),s=t.path,a=new ne(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||Z6(Q6(d),r)<=0||(i.has(d.key)||ng(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return V.resolve(o)}getAllFromCollectionGroup(e,t,r,i){ae()}Br(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ET(this)}getSize(e){return V.resolve(this.size)}},ET=class extends fT{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var IT=class{constructor(e){this.persistence=e,this.Lr=new Vi(t=>c0(t),l0),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.kr=0,this.qr=new ud,this.targetCount=0,this.Qr=ld.qn()}forEachTarget(e,t){return this.Lr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),V.resolve()}Un(e){this.Lr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new ld(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Un(t),V.resolve()}removeTargetData(e,t){return this.Lr.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Lr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Lr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),V.waitFor(o).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){let r=this.Lr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),V.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),V.resolve()}getMatchingKeysForTargetId(e,t){let r=this.qr.Sr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.qr.containsKey(t))}};var Mm=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new o0(0),this.Ur=!1,this.Ur=!0,this.Wr=new yT,this.referenceDelegate=e(this),this.Gr=new IT(this),this.indexManager=new cT,this.remoteDocumentCache=function(i){return new wT(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new aT(t),this.jr=new gT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new _T(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){G("MemoryPersistence","Starting transaction:",e);let i=new TT(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(o=>this.referenceDelegate.Jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Yr(e,t){return V.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,t)))}},TT=class extends MI{constructor(e){super(),this.currentSequenceNumber=e}},CT=class n{constructor(e){this.persistence=e,this.Zr=new ud,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw ae()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),V.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(i=>this.ti.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.ti.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.ti,r=>{let i=ne.fromPath(r);return this.ni(e,i).next(o=>{o||t.removeEntry(i,we.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(r=>{r?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return V.or([()=>V.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},Pm=class n{constructor(e,t){this.persistence=e,this.ri=new Vi(r=>t5(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=W5(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return V.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}er(e,t){return V.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(o=>o?V.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Br(e,s=>this.ir(e,s,t).next(a=>{a||(r++,o.removeEntry(s,we.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),V.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),V.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mm(e.data.value)),t}ir(e,t,r){return V.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ri.get(t);return V.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var bT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=i}static zi(e,t){let r=Pe(),i=Pe();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var DT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ST=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return jD()?8:X6(un())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Xi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.es(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new DT;return this.ts(e,t,s).next(a=>{if(o.result=a,this.Hi)return this.ns(e,t,s,a.size)})}).next(()=>o.result)}ns(e,t,r,i){return r.documentReadCount<this.Ji?(vc()<=en.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",yc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),V.resolve()):(vc()<=en.DEBUG&&G("QueryEngine","Query:",yc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(vc()<=en.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",yc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,si(t))):V.resolve())}Xi(e,t){if(NP(t))return V.resolve(null);let r=si(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=GI(t,null,"F"),r=si(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=Pe(...o);return this.Zi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.rs(t,a);return this.ss(t,u,s,c.readTime)?this.Xi(e,GI(t,null,"F")):this.os(e,u,t,c)}))})))}es(e,t,r,i){return NP(t)||i.isEqual(we.min())?V.resolve(null):this.Zi.getDocuments(e,r).next(o=>{let s=this.rs(t,o);return this.ss(t,s,r,i)?V.resolve(null):(vc()<=en.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),yc(t)),this.os(e,s,t,Y6(i,-1)).next(a=>a))})}rs(e,t){let r=new Qt(fk(e));return t.forEach((i,o)=>{ng(e,o)&&(r=r.add(o))}),r}ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ts(e,t,r){return vc()<=en.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",yc(t)),this.Zi.getDocumentsMatchingQuery(e,t,js.min(),r)}os(e,t,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var AT=class{constructor(e,t,r,i){this.persistence=e,this._s=t,this.serializer=i,this.us=new Dt(ke),this.cs=new Vi(o=>c0(o),l0),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mT(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function z5(n,e,t,r){return new AT(n,e,t,r)}function Mk(n,e){return y(this,null,function*(){let t=ve(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ps(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=Pe();for(let u of i){s.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({Ts:u,removedBatchIds:s,addedBatchIds:a}))})})})}function G5(n,e){let t=ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let f=u.batch,m=f.keys(),v=V.resolve();return m.forEach(w=>{v=v.next(()=>d.getEntry(c,w)).next(P=>{let N=u.docVersions.get(w);Ge(N!==null),P.version.compareTo(N)<0&&(f.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),d.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Pk(n){let e=ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function K5(n,e){let t=ve(n),r=e.snapshotVersion,i=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.hs.newChangeBuffer({trackRemovals:!0});i=t.us;let a=[];e.targetChanges.forEach((d,f)=>{let m=i.get(f);if(!m)return;a.push(t.Gr.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.Gr.addMatchingKeys(o,d.addedDocuments,f)));let v=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(pn.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(f,v),function(P,N,L){return P.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(m,v,d)&&a.push(t.Gr.updateTargetData(o,v))});let c=Ui(),u=Pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(Y5(o,s,e.documentUpdates).next(d=>{c=d.Is,u=d.ds})),!r.isEqual(we.min())){let d=t.Gr.getLastRemoteSnapshotVersion(o).next(f=>t.Gr.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(t.us=i,o))}function Y5(n,e,t){let r=Pe(),i=Pe();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Ui();return t.forEach((a,c)=>{let u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(we.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):G("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Is:s,ds:i}})}function Q5(n,e){let t=ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Z5(n,e){let t=ve(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Gr.getTargetData(r,e).next(o=>o?(i=o,V.resolve(i)):t.Gr.allocateTargetId(r).next(s=>(i=new cd(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.us=t.us.insert(r.targetId,r),t.cs.set(e,r.targetId)),r})}function RT(n,e,t){return y(this,null,function*(){let r=ve(n),i=r.us.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Vc(s))throw s;G("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.us=r.us.remove(e),r.cs.delete(i.target)})}function HP(n,e,t){let r=ve(n),i=we.min(),o=Pe();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,d){let f=ve(c),m=f.cs.get(d);return m!==void 0?V.resolve(f.us.get(m)):f.Gr.getTargetData(u,d)}(r,s,si(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r._s.getDocumentsMatchingQuery(s,e,t?i:we.min(),t?o:Pe())).next(a=>(J5(r,h5(e),a),{documents:a,Es:o})))}function J5(n,e,t){let r=n.ls.get(e)||we.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.ls.set(e,r)}var km=class{constructor(){this.activeTargetIds=y5()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var xT=class{constructor(){this._o=new km,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new km,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var NT=class{uo(e){}shutdown(){}};var Om=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){G("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){G("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var pm=null;function EI(){return pm===null?pm=function(){return 268435456+Math.round(2147483648*Math.random())}():pm++,"0x"+pm.toString(16)}var X5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var MT=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var fn="WebChannelConnection",PT=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+t.host,this.Mo=`projects/${i}/databases/${o}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Oo(t,r,i,o,s){let a=EI(),c=this.No(t,r.toUriEncodedString());G("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Bo(u,o,s),this.Lo(t,c,u,i).then(d=>(G("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Cc("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}ko(t,r,i,o,s,a){return this.Oo(t,r,i,o,s)}Bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}No(t,r){let i=X5[t];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Lo(e,t,r,i){let o=EI();return new Promise((s,a)=>{let c=new mI;c.setWithCredentials(!0),c.listenOnce(gI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ju.NO_ERROR:let d=c.getResponseJson();G(fn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),s(d);break;case Ju.TIMEOUT:G(fn,`RPC '${e}' ${o} timed out`),a(new K(F.DEADLINE_EXCEEDED,"Request time out"));break;case Ju.HTTP_ERROR:let f=c.getStatus();if(G(fn,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let w=function(N){let L=N.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(L)>=0?L:F.UNKNOWN}(v.status);a(new K(w,v.message))}else a(new K(F.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new K(F.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{G(fn,`RPC '${e}' ${o} completed.`)}});let u=JSON.stringify(i);G(fn,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",u,r,15)})}qo(e,t,r){let i=EI(),o=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=_I(),a=yI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Bo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=o.join("");G(fn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=s.createWebChannel(d,c),m=!1,v=!1,w=new MT({Eo:N=>{v?G(fn,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(G(fn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),G(fn,`RPC '${e}' stream ${i} sending:`,N),f.send(N))},Ao:()=>f.close()}),P=(N,L,q)=>{N.listen(L,Y=>{try{q(Y)}catch(re){setTimeout(()=>{throw re},0)}})};return P(f,gc.EventType.OPEN,()=>{v||(G(fn,`RPC '${e}' stream ${i} transport opened.`),w.So())}),P(f,gc.EventType.CLOSE,()=>{v||(v=!0,G(fn,`RPC '${e}' stream ${i} transport closed`),w.Do())}),P(f,gc.EventType.ERROR,N=>{v||(v=!0,Cc(fn,`RPC '${e}' stream ${i} transport errored:`,N),w.Do(new K(F.UNAVAILABLE,"The operation could not be completed")))}),P(f,gc.EventType.MESSAGE,N=>{var L;if(!v){let q=N.data[0];Ge(!!q);let Y=q,re=Y?.error||((L=Y[0])===null||L===void 0?void 0:L.error);if(re){G(fn,`RPC '${e}' stream ${i} received error:`,re);let it=re.status,le=function(E){let b=Lt[E];if(b!==void 0)return Ck(b)}(it),D=re.message;le===void 0&&(le=F.INTERNAL,D="Unknown error status: "+it+" with message "+re.message),v=!0,w.Do(new K(le,D)),f.close()}else G(fn,`RPC '${e}' stream ${i} received:`,q),w.vo(q)}}),P(a,vI.STAT_EVENT,N=>{N.stat===dm.PROXY?G(fn,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===dm.NOPROXY&&G(fn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.bo()},0),w}};function II(){return typeof document<"u"?document:null}function rg(n){return new nT(n,!0)}var Fm=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&G("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var Lm=class{constructor(e,t,r,i,o,s,a,c){this.li=e,this.Yo=r,this.Zo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new Fm(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return y(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return y(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return y(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Oi(t.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===t&&this.I_(r,i)},r=>{e(()=>{let i=new K(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.d_(i)})})}I_(e,t){let r=this.T_(this.Xo);this.stream=this.E_(e,t),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.d_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(()=>y(this,null,function*(){this.state=0,this.start()}))}d_(e){return G("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(G("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},kT=class extends Lm{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}E_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=P5(this.serializer,e),r=function(o){if(!("targetChange"in o))return we.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?we.min():s.readTime?ai(s.readTime):we.min()}(e);return this.listener.R_(t,r)}V_(e){let t={};t.database=sT(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=WI(c)?{documents:F5(o,c)}:{query:L5(o,c).ct},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=bk(o,s.resumeToken);let u=rT(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(we.min())>0){a.readTime=xm(o,s.snapshotVersion.toTimestamp());let u=rT(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=U5(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){let t={};t.database=sT(this.serializer),t.removeTarget=e,this.c_(t)}},OT=class extends Lm{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}E_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=O5(e.writeResults,e.commitTime),r=ai(e.commitTime);return this.listener.y_(r,t)}w_(){let e={};e.database=sT(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>k5(this.serializer,r))};this.c_(t)}};var FT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Oo(e,iT(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(F.UNKNOWN,o.toString())})}ko(e,t,r,i,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.ko(e,iT(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(F.UNKNOWN,s.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},LT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Oi(t),this.C_=!1):G("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var VT=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.B_=[],this.L_=new Map,this.k_=new Set,this.q_=[],this.Q_=o,this.Q_.uo(s=>{r.enqueueAndForget(()=>y(this,null,function*(){Ks(this)&&(G("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let u=ve(c);u.k_.add(4),yield vd(u),u.K_.set("Unknown"),u.k_.delete(4),yield ig(u)})}(this))}))}),this.K_=new LT(r,i)}};function ig(n){return y(this,null,function*(){if(Ks(n))for(let e of n.q_)yield e(!0)})}function vd(n){return y(this,null,function*(){for(let e of n.q_)yield e(!1)})}function kk(n,e){let t=ve(n);t.L_.has(e.targetId)||(t.L_.set(e.targetId,e),g0(t)?m0(t):Uc(t).s_()&&p0(t,e))}function f0(n,e){let t=ve(n),r=Uc(t);t.L_.delete(e),r.s_()&&Ok(t,e),t.L_.size===0&&(r.s_()?r.a_():Ks(t)&&t.K_.set("Unknown"))}function p0(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Uc(n).V_(e)}function Ok(n,e){n.U_.xe(e),Uc(n).m_(e)}function m0(n){n.U_=new tT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.L_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Uc(n).start(),n.K_.F_()}function g0(n){return Ks(n)&&!Uc(n).i_()&&n.L_.size>0}function Ks(n){return ve(n).k_.size===0}function Fk(n){n.U_=void 0}function e9(n){return y(this,null,function*(){n.K_.set("Online")})}function t9(n){return y(this,null,function*(){n.L_.forEach((e,t)=>{p0(n,e)})})}function n9(n,e){return y(this,null,function*(){Fk(n),g0(n)?(n.K_.O_(e),m0(n)):n.K_.set("Unknown")})}function r9(n,e,t){return y(this,null,function*(){if(n.K_.set("Online"),e instanceof Am&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.L_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.L_.delete(a),i.U_.removeTarget(a))})}(n,e)}catch(r){G("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Vm(n,r)}else if(e instanceof Ic?n.U_.$e(e):e instanceof Sm?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(we.min()))try{let r=yield Pk(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.U_.it(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=o.L_.get(u);d&&o.L_.set(u,d.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{let d=o.L_.get(c);if(!d)return;o.L_.set(c,d.withResumeToken(pn.EMPTY_BYTE_STRING,d.snapshotVersion)),Ok(o,c);let f=new cd(d.target,c,u,d.sequenceNumber);p0(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){G("RemoteStore","Failed to raise snapshot:",r),yield Vm(n,r)}})}function Vm(n,e,t){return y(this,null,function*(){if(!Vc(e))throw e;n.k_.add(1),yield vd(n),n.K_.set("Offline"),t||(t=()=>Pk(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){G("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield ig(n)}))})}function Lk(n,e){return e().catch(t=>Vm(n,t,e))}function og(n){return y(this,null,function*(){let e=ve(n),t=Vo(e),r=e.B_.length>0?e.B_[e.B_.length-1].batchId:-1;for(;i9(e);)try{let i=yield Q5(e.localStore,r);if(i===null){e.B_.length===0&&t.a_();break}r=i.batchId,o9(e,i)}catch(i){yield Vm(e,i)}Vk(e)&&Uk(e)})}function i9(n){return Ks(n)&&n.B_.length<10}function o9(n,e){n.B_.push(e);let t=Vo(n);t.s_()&&t.f_&&t.g_(e.mutations)}function Vk(n){return Ks(n)&&!Vo(n).i_()&&n.B_.length>0}function Uk(n){Vo(n).start()}function s9(n){return y(this,null,function*(){Vo(n).w_()})}function a9(n){return y(this,null,function*(){let e=Vo(n);for(let t of n.B_)e.g_(t.mutations)})}function c9(n,e,t){return y(this,null,function*(){let r=n.B_.shift(),i=ZI.from(r,e,t);yield Lk(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield og(n)})}function l9(n,e){return y(this,null,function*(){e&&Vo(n).f_&&(yield function(r,i){return y(this,null,function*(){if(function(s){return b5(s)&&s!==F.ABORTED}(i.code)){let o=r.B_.shift();Vo(r).__(),yield Lk(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield og(r)}})}(n,e)),Vk(n)&&Uk(n)})}function qP(n,e){return y(this,null,function*(){let t=ve(n);t.asyncQueue.verifyOperationInProgress(),G("RemoteStore","RemoteStore received new credentials");let r=Ks(t);t.k_.add(3),yield vd(t),r&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield ig(t)})}function u9(n,e){return y(this,null,function*(){let t=ve(n);e?(t.k_.delete(2),yield ig(t)):e||(t.k_.add(2),yield vd(t),t.K_.set("Unknown"))})}function Uc(n){return n.W_||(n.W_=function(t,r,i){let o=ve(t);return o.b_(),new kT(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:e9.bind(null,n),mo:t9.bind(null,n),po:n9.bind(null,n),R_:r9.bind(null,n)}),n.q_.push(e=>y(this,null,function*(){e?(n.W_.__(),g0(n)?m0(n):n.K_.set("Unknown")):(yield n.W_.stop(),Fk(n))}))),n.W_}function Vo(n){return n.G_||(n.G_=function(t,r,i){let o=ve(t);return o.b_(),new OT(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:s9.bind(null,n),po:l9.bind(null,n),p_:a9.bind(null,n),y_:c9.bind(null,n)}),n.q_.push(e=>y(this,null,function*(){e?(n.G_.__(),yield og(n)):(yield n.G_.stop(),n.B_.length>0&&(G("RemoteStore",`Stopping write stream with ${n.B_.length} pending writes`),n.B_=[]))}))),n.G_}var UT=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function v0(n,e){if(Oi("AsyncQueue",`${e}: ${n}`),Vc(n))return new K(F.UNAVAILABLE,`${e}: ${n}`);throw n}var Um=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ne.comparator(t.key,r.key):(t,r)=>ne.comparator(t.key,r.key),this.keyedMap=Xu(),this.sortedSet=new Dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var jm=class{constructor(){this.z_=new Dt(ne.comparator)}track(e){let t=e.doc.key,r=this.z_.get(t);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(t,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(t):e.type===1&&r.type===2?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):ae():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,r)=>{e.push(r)}),e}},kc=class n{constructor(e,t,r,i,o,s,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Um.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var jT=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},BT=class{constructor(){this.queries=WP(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,r){let i=ve(t),o=i.queries;i.queries=WP(),o.forEach((s,a)=>{for(let c of a.J_)c.onError(r)})})(this,new K(F.ABORTED,"Firestore shutting down"))}};function WP(){return new Vi(n=>hk(n),tg)}function jk(n,e){return y(this,null,function*(){let t=ve(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Y_()&&e.Z_()&&(r=2):(o=new jT,r=e.Z_()?0:1);try{switch(r){case 0:o.H_=yield t.onListen(i,!0);break;case 1:o.H_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=v0(s,`Initialization of query '${yc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.J_.push(e),e.ea(t.onlineState),o.H_&&e.ta(o.H_)&&y0(t)})}function Bk(n,e){return y(this,null,function*(){let t=ve(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.J_.indexOf(e);s>=0&&(o.J_.splice(s,1),o.J_.length===0?i=e.Z_()?0:1:!o.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function d9(n,e){let t=ve(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.J_)a.ta(i)&&(r=!0);s.H_=i}}r&&y0(t)}function h9(n,e,t){let r=ve(n),i=r.queries.get(e);if(i)for(let o of i.J_)o.onError(t);r.queries.delete(e)}function y0(n){n.X_.forEach(e=>{e.next()})}var $T,zP;(zP=$T||($T={})).na="default",zP.Cache="cache";var Bm=class{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new kc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let r=t!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=kc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==$T.Cache}};var $m=class{constructor(e){this.key=e}},Hm=class{constructor(e){this.key=e}},HT=class{constructor(e,t){this.query=e,this.Ea=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Pe(),this.mutatedKeys=Pe(),this.Va=fk(e),this.ma=new Um(this.Va)}get fa(){return this.Ea}ga(e,t){let r=t?t.pa:new jm,i=t?t.ma:this.ma,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let m=i.get(d),v=ng(this.query,f)?f:null,w=!!m&&this.mutatedKeys.has(m.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),N=!1;m&&v?m.data.isEqual(v.data)?w!==P&&(r.track({type:3,doc:v}),N=!0):this.ya(m,v)||(r.track({type:2,doc:v}),N=!0,(c&&this.Va(v,c)>0||u&&this.Va(v,u)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),N=!0):m&&!v&&(r.track({type:1,doc:m}),N=!0,(c||u)&&(a=!0)),N&&(v?(s=s.add(v),o=P?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{ma:s,pa:r,ss:a,mutatedKeys:o}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let s=e.pa.j_();s.sort((d,f)=>function(v,w){let P=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(v)-P(w)}(d.type,f.type)||this.Va(d.doc,f.doc)),this.wa(r),i=i!=null&&i;let a=t&&!i?this.Sa():[],c=this.Ra.size===0&&this.current&&!i?1:0,u=c!==this.Aa;return this.Aa=c,s.length!==0||u?{snapshot:new kc(this.query,e.ma,o,s,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new jm,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.Ea.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.Ea=this.Ea.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ea=this.Ea.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=Pe(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let t=[];return e.forEach(r=>{this.Ra.has(r)||t.push(new Hm(r))}),this.Ra.forEach(r=>{e.has(r)||t.push(new $m(r))}),t}va(e){this.Ea=e.Es,this.Ra=Pe();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return kc.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},qT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},WT=class{constructor(e){this.key=e,this.Fa=!1}},zT=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new Vi(a=>hk(a),tg),this.Oa=new Map,this.Na=new Set,this.Ba=new Dt(ne.comparator),this.La=new Map,this.ka=new ud,this.qa={},this.Qa=new Map,this.Ka=ld.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function f9(n,e,t=!0){return y(this,null,function*(){let r=Gk(n),i,o=r.xa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Ca()):i=yield $k(r,e,t,!0),i})}function p9(n,e){return y(this,null,function*(){let t=Gk(n);yield $k(t,e,!0,!1)})}function $k(n,e,t,r){return y(this,null,function*(){let i=yield Z5(n.localStore,si(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield m9(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&kk(n.remoteStore,i),a})}function m9(n,e,t,r,i){return y(this,null,function*(){n.Ua=(f,m,v)=>function(P,N,L,q){return y(this,null,function*(){let Y=N.view.ga(L);Y.ss&&(Y=yield HP(P.localStore,N.query,!1).then(({documents:D})=>N.view.ga(D,Y)));let re=q&&q.targetChanges.get(N.targetId),it=q&&q.targetMismatches.get(N.targetId)!=null,le=N.view.applyChanges(Y,P.isPrimaryClient,re,it);return KP(P,N.targetId,le.ba),le.snapshot})}(n,f,m,v);let o=yield HP(n.localStore,e,!0),s=new HT(e,o.Es),a=s.ga(o.documents),c=ad.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=s.applyChanges(a,n.isPrimaryClient,c);KP(n,t,u.ba);let d=new qT(e,t,s);return n.xa.set(e,d),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),u.snapshot})}function g9(n,e,t){return y(this,null,function*(){let r=ve(n),i=r.xa.get(e),o=r.Oa.get(i.targetId);if(o.length>1)return r.Oa.set(i.targetId,o.filter(s=>!tg(s,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield RT(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&f0(r.remoteStore,i.targetId),GT(r,i.targetId)}).catch(Lc))):(GT(r,i.targetId),yield RT(r.localStore,i.targetId,!0))})}function v9(n,e){return y(this,null,function*(){let t=ve(n),r=t.xa.get(e),i=t.Oa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),f0(t.remoteStore,r.targetId))})}function y9(n,e,t){return y(this,null,function*(){let r=b9(n);try{let i=yield function(s,a){let c=ve(s),u=Nt.now(),d=a.reduce((v,w)=>v.add(w.key),Pe()),f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let w=Ui(),P=Pe();return c.hs.getEntries(v,d).next(N=>{w=N,w.forEach((L,q)=>{q.isValidDocument()||(P=P.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,w)).next(N=>{f=N;let L=[];for(let q of a){let Y=C5(q,f.get(q.key).overlayedDocument);Y!=null&&L.push(new ji(q.key,Y,ok(Y.value.mapValue),Vs.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,L,a)}).next(N=>{m=N;let L=N.applyToLocalDocumentSet(f,P);return c.documentOverlayCache.saveOverlays(v,N.batchId,L)})}).then(()=>({batchId:m.batchId,changes:mk(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let u=s.qa[s.currentUser.toKey()];u||(u=new Dt(ke)),u=u.insert(a,c),s.qa[s.currentUser.toKey()]=u}(r,i.batchId,t),yield yd(r,i.changes),yield og(r.remoteStore)}catch(i){let o=v0(i,"Failed to persist write");t.reject(o)}})}function Hk(n,e){return y(this,null,function*(){let t=ve(n);try{let r=yield K5(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.La.get(o);s&&(Ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Fa=!0:i.modifiedDocuments.size>0?Ge(s.Fa):i.removedDocuments.size>0&&(Ge(s.Fa),s.Fa=!1))}),yield yd(t,r,e)}catch(r){yield Lc(r)}})}function GP(n,e,t){let r=ve(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xa.forEach((o,s)=>{let a=s.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=ve(s);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(let m of f.J_)m.ea(a)&&(u=!0)}),u&&y0(c)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function _9(n,e,t){return y(this,null,function*(){let r=ve(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.La.get(e),o=i&&i.key;if(o){let s=new Dt(ne.comparator);s=s.insert(o,Vr.newNoDocument(o,we.min()));let a=Pe().add(o),c=new Dm(we.min(),new Map,new Dt(ke),s,a);yield Hk(r,c),r.Ba=r.Ba.remove(o),r.La.delete(e),_0(r)}else yield RT(r.localStore,e,!1).then(()=>GT(r,e,t)).catch(Lc)})}function w9(n,e){return y(this,null,function*(){let t=ve(n),r=e.batch.batchId;try{let i=yield G5(t.localStore,e);Wk(t,r,null),qk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield yd(t,i)}catch(i){yield Lc(i)}})}function E9(n,e,t){return y(this,null,function*(){let r=ve(n);try{let i=yield function(s,a){let c=ve(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(Ge(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Wk(r,e,t),qk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield yd(r,i)}catch(i){yield Lc(i)}})}function qk(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function Wk(n,e,t){let r=ve(n),i=r.qa[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function GT(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Oa.get(e))n.xa.delete(r),t&&n.Ma.Wa(r,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(r=>{n.ka.containsKey(r)||zk(n,r)})}function zk(n,e){n.Na.delete(e.path.canonicalString());let t=n.Ba.get(e);t!==null&&(f0(n.remoteStore,t),n.Ba=n.Ba.remove(e),n.La.delete(t),_0(n))}function KP(n,e,t){for(let r of t)r instanceof $m?(n.ka.addReference(r.key,e),I9(n,r)):r instanceof Hm?(G("SyncEngine","Document no longer in limbo: "+r.key),n.ka.removeReference(r.key,e),n.ka.containsKey(r.key)||zk(n,r.key)):ae()}function I9(n,e){let t=e.key,r=t.path.canonicalString();n.Ba.get(t)||n.Na.has(r)||(G("SyncEngine","New document in limbo: "+t),n.Na.add(r),_0(n))}function _0(n){for(;n.Na.size>0&&n.Ba.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new ne(gt.fromString(e)),r=n.Ka.next();n.La.set(r,new WT(t)),n.Ba=n.Ba.insert(t,r),kk(n.remoteStore,new cd(si(u0(t.path)),r,"TargetPurposeLimboResolution",o0.oe))}}function yd(n,e,t){return y(this,null,function*(){let r=ve(n),i=[],o=[],s=[];r.xa.isEmpty()||(r.xa.forEach((a,c)=>{s.push(r.Ua(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){let f=u?!u.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);let f=bT.zi(c.targetId,u);o.push(f)}}))}),yield Promise.all(s),r.Ma.R_(i),yield function(c,u){return y(this,null,function*(){let d=ve(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(u,m=>V.forEach(m.Wi,v=>d.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>V.forEach(m.Gi,v=>d.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!Vc(f))throw f;G("LocalStore","Failed to update sequence numbers: "+f)}for(let f of u){let m=f.targetId;if(!f.fromCache){let v=d.us.get(m),w=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(w);d.us=d.us.insert(m,P)}}})}(r.localStore,o))})}function T9(n,e){return y(this,null,function*(){let t=ve(n);if(!t.currentUser.isEqual(e)){G("SyncEngine","User change. New user:",e.toKey());let r=yield Mk(t.localStore,e);t.currentUser=e,function(o,s){o.Qa.forEach(a=>{a.forEach(c=>{c.reject(new K(F.CANCELLED,s))})}),o.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield yd(t,r.Ts)}})}function C9(n,e){let t=ve(n),r=t.La.get(e);if(r&&r.Fa)return Pe().add(r.key);{let i=Pe(),o=t.Oa.get(e);if(!o)return i;for(let s of o){let a=t.xa.get(s);i=i.unionWith(a.view.fa)}return i}}function Gk(n){let e=ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=C9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_9.bind(null,e),e.Ma.R_=d9.bind(null,e.eventManager),e.Ma.Wa=h9.bind(null,e.eventManager),e}function b9(n){let e=ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=w9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=E9.bind(null,e),e}var Kk=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=rg(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,r){return null}Ya(t,r){return null}Ha(t){return z5(this.persistence,new ST,t.initialUser,this.serializer)}ja(t){return new Mm(CT.ei,this.serializer)}za(t){return new xT}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),KT=class extends Kk{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Ge(this.persistence.referenceDelegate instanceof Pm);let r=this.persistence.referenceDelegate.garbageCollector;return new dT(r,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new Mm(r=>Pm.ei(r,t),this.serializer)}};var D9=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>GP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=T9.bind(null,this.syncEngine),yield u9(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new BT}()}createDatastore(t){let r=rg(t.databaseInfo.databaseId),i=function(s){return new PT(s)}(t.databaseInfo);return function(s,a,c,u){return new FT(s,a,c,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new VT(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>GP(this.syncEngine,r,0),function(){return Om.p()?new Om:new NT}())}createSyncEngine(t,r){return function(o,s,a,c,u,d,f){let m=new zT(o,s,a,c,u,d);return f&&(m.$a=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(o){return y(this,null,function*(){let s=ve(o);G("RemoteStore","RemoteStore shutting down."),s.k_.add(5),yield vd(s),s.Q_.shutdown(),s.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var qm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var YT=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Yt.UNAUTHENTICATED,this.clientId=_m.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>y(this,null,function*(){G("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(G("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=v0(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function TI(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),G("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Mk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function YP(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield S9(n);G("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>qP(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>qP(e.remoteStore,i)),n._onlineComponents=e})}function S9(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){G("FirestoreClient","Using user provided OfflineComponentProvider");try{yield TI(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Cc("Error using user provided cache. Falling back to memory cache: "+t),yield TI(n,new Kk)}}else G("FirestoreClient","Using default OfflineComponentProvider"),yield TI(n,new KT(void 0));return n._offlineComponents})}function Yk(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(G("FirestoreClient","Using user provided OnlineComponentProvider"),yield YP(n,n._uninitializedComponentsProvider._online)):(G("FirestoreClient","Using default OnlineComponentProvider"),yield YP(n,new D9))),n._onlineComponents})}function A9(n){return Yk(n).then(e=>e.syncEngine)}function QT(n){return y(this,null,function*(){let e=yield Yk(n),t=e.eventManager;return t.onListen=f9.bind(null,e.syncEngine),t.onUnlisten=g9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=p9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=v9.bind(null,e.syncEngine),t})}function R9(n,e,t={}){let r=new ii;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(o,s,a,c,u){let d=new qm({next:m=>{d.eu(),s.enqueueAndForget(()=>Bk(o,f)),m.fromCache&&c.source==="server"?u.reject(new K(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Bm(a,d,{includeMetadataChanges:!0,ua:!0});return jk(o,f)}(yield QT(n),n.asyncQueue,e,t,r)})),r.promise}function Qk(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var QP=new Map;function Zk(n,e,t){if(!t)throw new K(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function x9(n,e,t,r){if(e===!0&&r===!0)throw new K(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ZP(n){if(!ne.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function JP(n){if(ne.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ae()}function Oo(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new K(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=sg(n);throw new K(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Wm=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}x9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Oc=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new CI;switch(r.type){case"firstParty":return new AI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=QP.get(t);r&&(G("ComponentProvider","Removing Datastore"),QP.delete(t),r.terminate())}(this),Promise.resolve()}};function Jk(n,e,t,r={}){var i;let o=(n=Oo(n,Oc))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Cc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Yt.MOCK_USER;else{a=ma(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new K(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Yt(u)}n._authCredentials=new bI(new ym(a,c))}}var Ws=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Hn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Fo=class n extends Ws{constructor(e,t,r){super(e,t,u0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Hn(this.firestore,null,new ne(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Xk(n,e,...t){if(n=Fe(n),Zk("collection","path",e),n instanceof Oc){let r=gt.fromString(e,...t);return JP(r),new Fo(n,null,r)}{if(!(n instanceof Hn||n instanceof Fo))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(gt.fromString(e,...t));return JP(r),new Fo(n.firestore,null,r)}}function eO(n,e,...t){if(n=Fe(n),arguments.length===1&&(e=_m.newId()),Zk("doc","path",e),n instanceof Oc){let r=gt.fromString(e,...t);return ZP(r),new Hn(n,null,new ne(r))}{if(!(n instanceof Hn||n instanceof Fo))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(gt.fromString(e,...t));return ZP(r),new Hn(n.firestore,n instanceof Fo?n.converter:null,new ne(r))}}var zm=class{constructor(e=Promise.resolve()){this.Iu=[],this.du=!1,this.Eu=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new Fm(this,"async_queue_retry"),this.fu=()=>{let r=II();r&&G("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let t=II();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.du}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.du){this.du=!0,this.Vu=e||!1;let t=II();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.du)return new Promise(()=>{});let t=new ii;return this.yu(()=>this.du&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return y(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!Vc(e))throw e;G("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Oi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let i=UT.createAndSchedule(this,e,t,r,o=>this.Su(o));return this.Eu.push(i),i}pu(){this.Au&&ae()}verifyOperationInProgress(){}bu(){return y(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.Eu)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.Eu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Eu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.Eu.indexOf(e);this.Eu.splice(t,1)}};function XP(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var zs=class extends Oc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new zm,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new zm(e),this._firestoreClient=void 0,yield e}})}};function tO(n,e){let t=typeof n=="object"?n:Ht(),r=typeof n=="string"?n:e||"(default)",i=$t(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=no("firestore");o&&Jk(i,...o)}return i}function w0(n){if(n._terminated)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||N9(n),n._firestoreClient}function N9(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,u,d){return new PI(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Qk(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new YT(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}var dd=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(pn.fromBase64String(e))}catch(t){throw new K(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var hd=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new K(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gm=class{constructor(e){this._methodName=e}};var fd=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ke(this._lat,e._lat)||ke(this._long,e._long)}};var pd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var M9=/^__.*__$/,ZT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ji(e,this.data,this.fieldMask,t,this.fieldTransforms):new qs(e,this.data,t,this.fieldTransforms)}};function nO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}var JT=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Fu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Bu(e),i}Lu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Km(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Bu(this.path.get(e))}Bu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(nO(this.Mu)&&M9.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},XT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rg(e)}$u(e,t,r,i=!1){return new JT({Mu:e,methodName:t,Ku:r,path:er.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function rO(n){let e=n._freezeSettings(),t=rg(n._databaseId);return new XT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function P9(n,e,t,r,i,o={}){let s=n.$u(o.merge||o.mergeFields?2:0,e,t,i);sO("Data must be an object, but it was:",s,r);let a=iO(r,s),c,u;if(o.merge)c=new ri(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let m=O9(e,f,t);if(!s.contains(m))throw new K(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);L9(d,m)||d.push(m)}c=new ri(d),u=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=s.fieldTransforms;return new ZT(new Lr(a),c,u)}function k9(n,e,t,r=!1){return E0(t,n.$u(r?4:3,e))}function E0(n,e){if(oO(n=Fe(n)))return sO("Unsupported field value:",e,n),iO(n,e);if(n instanceof Gm)return function(r,i){if(!nO(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=E0(a,i.ku(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return _5(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Nt.fromDate(r);return{timestampValue:xm(i.serializer,o)}}if(r instanceof Nt){let o=new Nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xm(i.serializer,o)}}if(r instanceof fd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dd)return{bytesValue:bk(i.serializer,r._byteString)};if(r instanceof Hn){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.qu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:h0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof pd)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.qu("VectorValues must only contain numeric values.");return d0(a.serializer,c)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${sg(r)}`)}(n,e)}function iO(n,e){let t={};return nk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gs(n,(r,i)=>{let o=E0(i,e.Ou(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function oO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Nt||n instanceof fd||n instanceof dd||n instanceof Hn||n instanceof Gm||n instanceof pd)}function sO(n,e,t){if(!oO(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=sg(t);throw r==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+r)}}function O9(n,e,t){if((e=Fe(e))instanceof hd)return e._internalPath;if(typeof e=="string")return aO(n,e);throw Km("Field path arguments must be of type string or ",n,!1,void 0,t)}var F9=new RegExp("[~\\*/\\[\\]]");function aO(n,e,t){if(e.search(F9)>=0)throw Km(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hd(...e.split("."))._internalPath}catch{throw Km(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Km(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new K(F.INVALID_ARGUMENT,a+n+c)}function L9(n,e){return n.some(t=>t.isEqual(e))}var Ym=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new e0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(I0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},e0=class extends Ym{data(){return super.data()}};function I0(n,e){return typeof e=="string"?aO(n,e):e instanceof hd?e._internalPath:e._delegate._internalPath}function cO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new K(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var md=class{},t0=class extends md{};function lO(n,e,...t){let r=[];e instanceof md&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof n0).length,a=o.filter(c=>c instanceof Qm).length;if(s>1||s>0&&a>0)throw new K(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Qm=class n extends t0{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return dO(e._query,t),new Ws(e.firestore,e.converter,zI(e._query,t))}_parse(e){let t=rO(e.firestore);return function(o,s,a,c,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new K(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){tk(f,d);let v=[];for(let w of f)v.push(ek(c,o,w));m={arrayValue:{values:v}}}else m=ek(c,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||tk(f,d),m=k9(a,s,f,d==="in"||d==="not-in");return Ut.create(u,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function uO(n,e,t){let r=e,i=I0("where",n);return Qm._create(i,r,t)}var n0=class n extends md{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ur.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)dO(s,c),s=zI(s,c)}(e._query,t),new Ws(e.firestore,e.converter,zI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function ek(n,e,t){if(typeof(t=Fe(t))=="string"){if(t==="")throw new K(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dk(e)&&t.indexOf("/")!==-1)throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(gt.fromString(t));if(!ne.isDocumentKey(r))throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bP(n,new ne(r))}if(t instanceof Hn)return bP(n,t._key);throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sg(t)}.`)}function tk(n,e){if(!Array.isArray(n)||n.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dO(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var r0=class{convertValue(e,t="none"){switch(Lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Gs(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>ht(s.doubleValue));return new pd(o)}convertGeoPoint(e){return new fd(ht(e.latitude),ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=eg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(od(e));default:return null}}convertTimestamp(e){let t=Fi(e);return new Nt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=gt.fromString(e);Ge(Nk(r));let i=new Tm(r.get(1),r.get(3)),o=new ne(r.popFirst(5));return i.isEqual(t)||Oi(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function V9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Ls=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Zm=class extends Ym{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Tc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(I0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Tc=class extends Zm{data(e={}){return super.data(e)}},Jm=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ls(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Tc(this._firestore,this._userDataWriter,r.key,r,new Ls(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Tc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ls(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Tc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ls(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:U9(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function U9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}var gd=class extends r0{constructor(e){super(),this.firestore=e}convertBytes(e){return new dd(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hn(this.firestore,null,t)}};function hO(n){n=Oo(n,Ws);let e=Oo(n.firestore,zs),t=w0(e),r=new gd(e);return cO(n._query),R9(t,n._query).then(i=>new Jm(e,r,n,i))}function fO(n,e,t){n=Oo(n,Hn);let r=Oo(n.firestore,zs),i=V9(n.converter,e,t);return j9(r,[P9(rO(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Vs.none())])}function T0(n,...e){var t,r,i;n=Fe(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||XP(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(XP(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[s+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,u,d;if(n instanceof Hn)u=Oo(n.firestore,zs),d=u0(n._key.path),c={next:f=>{e[s]&&e[s](B9(u,n,f))},error:e[s+1],complete:e[s+2]};else{let f=Oo(n,Ws);u=Oo(f.firestore,zs),d=f._query;let m=new gd(u);c={next:v=>{e[s]&&e[s](new Jm(u,m,f,v))},error:e[s+1],complete:e[s+2]},cO(n._query)}return function(m,v,w,P){let N=new qm(P),L=new Bm(v,N,w);return m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return jk(yield QT(m),L)})),()=>{N.eu(),m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Bk(yield QT(m),L)}))}}(w0(u),d,a,c)}function j9(n,e){return function(r,i){let o=new ii;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return y9(yield A9(r),i,o)})),o.promise}(w0(n),e)}function B9(n,e,t){let r=t.docs.get(e._key),i=new gd(n);return new Zm(n,i,e._key,r,new Ls(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Fc=i})(Pn),It(new Et("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new zs(new DI(r.getProvider("auth-internal")),new xI(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new K(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tm(u.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),te(wP,"4.7.6",e),te(wP,"4.7.6","esm2017")})();var ag=function(){return ag=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ag.apply(this,arguments)};var q9={includeMetadataChanges:!1};function pO(n,e){return e===void 0&&(e=q9),new pe(function(t){var r=T0(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function mO(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:ag(ag({},r),(t={},t[e.idField]=n.id,t))}function gO(n){return pO(n,{includeMetadataChanges:!0}).pipe(ee(function(e){return e.docs}))}function vO(n,e){return e===void 0&&(e={}),gO(n).pipe(ee(function(t){return t.map(function(r){return mO(r,e)})}))}var Ys=class{constructor(e){return e}},yO="firestore",C0=class{constructor(){return Ft(yO)}};var b0=new W("angularfire2.firestore-instances");function W9(n,e){let t=Wt(yO,n,e);return t&&new Ys(t)}function z9(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ys(r)}}var G9={provide:C0,deps:[[new Ie,b0]]},K9={provide:Ys,useFactory:W9,deps:[[new Ie,b0],mt]};function _O(n,...e){return te("angularfire",dt.full,"fst"),ut([K9,G9,{provide:b0,useFactory:z9(n),multi:!0,deps:[me,Se,bt,xt,[new Ie,Fr],[new Ie,pr],...e]}])}var gr=He(vO,!0);var vr=He(Xk,!0,2);var D0=He(eO,!0,2);var S0=He(hO,!0);var wO=He(tO,!0);var EO=He(lO,!0,2);var A0=He(fO,!0,2);var IO=He(uO,!0,2);var TO="@firebase/database",CO="1.0.11";var DC="";function Y9(n){DC=n}var F0=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),zt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:wh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var L0=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Gr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var n1=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new F0(e)}}catch{}return new L0},Zs=n1("localStorage"),V0=n1("sessionStorage");var Hc=new ir("@firebase/database"),Q9=function(){let n=1;return function(){return n++}}(),r1=function(n){let e=zD(n),t=new HD;t.update(e);let r=t.digest();return yh.encodeByteArray(r)},Nd=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Nd.apply(null,r):typeof r=="object"?e+=zt(r):e+=r,e+=" "}return e},Js=null,bO=!0,Z9=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Hc.logLevel=en.VERBOSE,Js=Hc.log.bind(Hc),e&&V0.set("logging_enabled",!0)):typeof n=="function"?Js=n:(Js=null,V0.remove("logging_enabled"))},mn=function(...n){if(bO===!0&&(bO=!1,Js===null&&V0.get("logging_enabled")===!0&&Z9(!0)),Js){let e=Nd.apply(null,n);Js(e)}},Md=function(n){return function(...e){mn(n,...e)}},U0=function(...n){let e="FIREBASE INTERNAL ERROR: "+Nd(...n);Hc.error(e)},$i=function(...n){let e=`FIREBASE FATAL ERROR: ${Nd(...n)}`;throw Hc.error(e),new Error(e)},tr=function(...n){let e="FIREBASE WARNING: "+Nd(...n);Hc.warn(e)},J9=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&tr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},i1=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},X9=function(n){if(Wr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Wc="[MIN_NAME]",Xs="[MAX_NAME]",Jc=function(n,e){if(n===e)return 0;if(n===Wc||e===Xs)return-1;if(e===Wc||n===Xs)return 1;{let t=DO(n),r=DO(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},e8=function(n,e){return n===e?0:n<e?-1:1},_d=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+zt(e))},SC=function(n){if(typeof n!="object"||n===null)return zt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=zt(e[r]),t+=":",t+=SC(n[e[r]]);return t+="}",t},o1=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function wr(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var s1=function(n){$(!i1(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,s,a,c;n===0?(o=0,s=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=a+r,s=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,s=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);for(c=e;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(i?1:0),u.reverse();let d=u.join(""),f="";for(c=0;c<64;c+=8){let m=parseInt(d.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},t8=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},n8=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var r8=new RegExp("^-?(0*)\\d{1,10}$"),i8=-2147483648,o8=2147483647,DO=function(n){if(r8.test(n)){let e=Number(n);if(e>=i8&&e<=o8)return e}return null},Pd=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw tr("Exception was thrown by user callback.",t),e},Math.floor(0))}},s8=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Cd=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var j0=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){tr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var B0=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(mn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',tr(e)}},bd=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),lg="5",a1="v",c1="s",l1="r",u1="f",d1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,h1="ls",f1="p",$0="ac",p1="websocket",m1="long_polling";var ug=class{constructor(e,t,r,i,o=!1,s="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Zs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function a8(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function g1(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let r;if(e===p1)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===m1)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);a8(n)&&(t.ns=n.namespace);let i=[];return wr(t,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}var H0=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Gr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return FD(this.counters_)}};var R0={},x0={};function AC(n){let e=n.toString();return R0[e]||(R0[e]=new H0),R0[e]}function c8(n,e){let t=n.toString();return x0[t]||(x0[t]=e()),x0[t]}var q0=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Pd(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var SO="start",l8="close",u8="pLPCommand",d8="pRTLPCB",v1="id",y1="pw",_1="ser",h8="cb",f8="seg",p8="ts",m8="d",g8="dframe",w1=1870,E1=30,v8=w1-E1,y8=25e3,_8=3e4,W0=class n{constructor(e,t,r,i,o,s,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Md(e),this.stats_=AC(t),this.urlFn=c=>(this.appCheckToken&&(c[$0]=this.appCheckToken),g1(t,m1,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new q0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(_8)),X9(()=>{if(this.isClosed_)return;this.scriptTagHolder=new z0((...o)=>{let[s,a,c,u,d]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===SO)this.id=a,this.password=c;else if(s===l8)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{let[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[SO]="t",r[_1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[h8]=this.scriptTagHolder.uniqueCallbackIdentifier),r[a1]=lg,this.transportSessionId&&(r[c1]=this.transportSessionId),this.lastSessionId&&(r[h1]=this.lastSessionId),this.applicationId&&(r[f1]=this.applicationId),this.appCheckToken&&(r[$0]=this.appCheckToken),typeof location<"u"&&location.hostname&&d1.test(location.hostname)&&(r[l1]=u1);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Wr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!t8()&&!n8()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=zt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=kD(t),i=o1(r,v8);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Wr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[g8]="t",r[v1]=e,r[y1]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=zt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},z0=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Wr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Q9(),window[u8+this.uniqueCallbackIdentifier]=e,window[d8+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){mn("frame writing exception"),a.stack&&mn(a.stack),mn(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||mn("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[v1]=this.myID,e[y1]=this.myPW,e[_1]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+E1+r.length<=w1;){let s=this.pendingSegs.shift();r=r+"&"+f8+i+"="+s.seg+"&"+p8+i+"="+s.ts+"&"+m8+i+"="+s.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(y8)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){Wr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{mn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var w8=16384,E8=45e3,dg=null;typeof MozWebSocket<"u"?dg=MozWebSocket:typeof WebSocket<"u"&&(dg=WebSocket);var wd=(()=>{class n{constructor(t,r,i,o,s,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Md(this.connId),this.stats_=AC(r),this.connURL=n.connectionURL_(r,a,c,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,s){let a={};return a[a1]=lg,!Wr()&&typeof location<"u"&&location.hostname&&d1.test(location.hostname)&&(a[l1]=u1),r&&(a[c1]=r),i&&(a[h1]=i),o&&(a[$0]=o),s&&(a[f1]=s),g1(t,p1,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zs.set("previous_websocket_failure",!0);try{let i;if(Wr()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${lg}/${DC}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new dg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&dg!==null&&!n.forceDisallow_}static previouslyFailed(){return Zs.isInMemoryStorage||Zs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Zs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=wh(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=zt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=o1(r,w8);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(E8))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),I8=(()=>{class n{static get ALL_TRANSPORTS(){return[W0,wd]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=wd&&wd.isAvailable(),i=r&&!wd.previouslyFailed();if(t.webSocketOnly&&(r||tr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[wd];else{let o=this.transports_=[];for(let s of n.ALL_TRANSPORTS)s&&s.isAvailable()&&o.push(s);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),T8=6e4,C8=5e3,b8=10*1024,D8=100*1024,N0="t",AO="d",S8="s",RO="r",A8="e",xO="o",NO="a",MO="n",PO="p",R8="h",G0=class{constructor(e,t,r,i,o,s,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Md("c:"+this.id+":"),this.transportManager_=new I8(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Cd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>D8?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>b8?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(N0 in e){let t=e[N0];t===NO?this.upgradeIfSecondaryHealthy_():t===RO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===xO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=_d("t",e),r=_d("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:NO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:MO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=_d("t",e),r=_d("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=_d(N0,e);if(AO in e){let r=e[AO];if(t===R8){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===MO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===S8?this.onConnectionShutdown_(r):t===RO?this.onReset_(r):t===A8?U0("Server Error: "+r):t===xO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):U0("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),lg!==r&&tr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Cd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(T8))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Cd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(C8))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var hg=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var fg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var pg=class n extends fg{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ol()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var kO=32,OO=768,et=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ke(){return new et("")}function je(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function jo(n){return n.pieces_.length-n.pieceNum_}function ct(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new et(n.pieces_,e)}function I1(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function x8(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function T1(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function C1(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new et(e,0)}function Zt(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof et)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new et(t,0)}function Oe(n){return n.pieceNum_>=n.pieces_.length}function yr(n,e){let t=je(n),r=je(e);if(t===null)return e;if(t===r)return yr(ct(n),ct(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function b1(n,e){if(jo(n)!==jo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Br(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(jo(n)>jo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var K0=class{constructor(e,t){this.errorPrefix_=t,this.parts_=T1(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Bl(this.parts_[r]);D1(this)}};function N8(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Bl(e),D1(n)}function M8(n){let e=n.parts_.pop();n.byteLength_-=Bl(e),n.parts_.length>0&&(n.byteLength_-=1)}function D1(n){if(n.byteLength_>OO)throw new Error(n.errorPrefix_+"has a key path longer than "+OO+" bytes ("+n.byteLength_+").");if(n.parts_.length>kO)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+kO+") or object contains a cycle "+Qs(n))}function Qs(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Y0=class n extends fg{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ed=1e3,P8=60*5*1e3,FO=30*1e3,k8=1.3,O8=3e4,F8="server_kill",LO=3,RC=(()=>{class n extends hg{constructor(t,r,i,o,s,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Md("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ed,this.maxReconnectDelay_=P8,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Wr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Y0.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&pg.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,s={r:o,a:t,b:r};this.log_(zt(s)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new pa,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,i,o){this.initConnection_();let s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let c={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(a).set(s,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let s={p:i},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Gr(t,"w")){let i=Xo(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();tr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||$D(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=FO)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=BD(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let s=o.s,a=o.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let s={p:t},a="n";o&&(s.q=i,s.t=o),this.sendRequest(a,s)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let s={p:r,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,s){this.initConnection_();let a={p:r,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:o}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(s.s,s.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+zt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):U0("Unrecognized action received from server: "+zt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ed,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ed,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>O8&&(this.reconnectDelay_=Ed),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*k8)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(m){$(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(m)};this.realtime_={close:u,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,v]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?mn("getToken() completed but was canceled"):(mn("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=v&&v.token,c=new G0(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{tr(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(F8)},s))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&tr(m),u())}}})}interrupt(t){mn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){mn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Vl(this.interruptReasons_)&&(this.reconnectDelay_=Ed,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(s=>SC(s)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new et(t).toString(),o;if(this.listens.has(i)){let s=this.listens.get(i);o=s.get(r),s.delete(r),s.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){mn("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=LO&&(this.reconnectDelay_=FO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){mn("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=LO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Wr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+DC.replace(/\./g,"-")]=1,Ol()?t["framework.cordova"]=1:_h()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=pg.getInstance().currentlyOnline();return Vl(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Be=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var zc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Be(Wc,e),i=new Be(Wc,t);return this.compare(r,i)!==0}minPost(){return Be.MIN}};var cg,mg=class extends zc{static get __EMPTY_NODE(){return cg}static set __EMPTY_NODE(e){cg=e}compare(e,t){return Jc(e.name,t.name)}isDefinedOn(e){throw fa("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Be.MIN}maxPost(){return new Be(Xs,cg)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new Be(e,cg)}toString(){return".key"}},qc=new mg;var Bc=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?r(e.key,t):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},jr=(()=>{class n{constructor(t,r,i,o,s){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??_r.EMPTY_NODE,this.right=s??_r.EMPTY_NODE}copy(t,r,i,o,s){return new n(t??this.key,r??this.value,i??this.color,o??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,s=i(t,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):s===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return _r.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return _r.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),Q0=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new jr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},_r=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,jr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,jr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Bc(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Bc(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Bc(this.root_,null,this.comparator_,!0,e)}};_r.EMPTY_NODE=new Q0;function L8(n,e){return Jc(n.name,e.name)}function xC(n,e){return Jc(n,e)}var Z0;function V8(n){Z0=n}var S1=function(n){return typeof n=="number"?"number:"+s1(n):"string:"+n},A1=function(n){if(n.isLeafNode()){let e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Gr(e,".sv"),"Priority must be a string or number.")}else $(n===Z0||n.isEmpty(),"priority of unexpected type.");$(n===Z0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var VO,Gc=(()=>{class n{static set __childrenNodeConstructor(t){VO=t}static get __childrenNodeConstructor(){return VO}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),A1(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Oe(t)?this:je(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=je(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:($(i!==".priority"||jo(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(ct(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+S1(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=s1(this.value_):t+=this.value_,this.lazyHash_=r1(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),s=n.VALUE_TYPE_ORDER.indexOf(i);return $(o>=0,"Unknown leaf type: "+r),$(s>=0,"Unknown leaf type: "+i),o===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),R1,x1;function U8(n){R1=n}function j8(n){x1=n}var J0=class extends zc{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Jc(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Be.MIN}maxPost(){return new Be(Xs,new Gc("[PRIORITY-POST]",x1))}makePost(e,t){let r=R1(e);return new Be(t,new Gc("[PRIORITY-POST]",r))}toString(){return".priority"}},vn=new J0;var B8=Math.log(2),X0=class{constructor(e){let t=o=>parseInt(Math.log(o)/B8,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},gg=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,f,m;if(d===0)return null;if(d===1)return f=n[c],m=t?t(f):f,new jr(m,f.node,jr.BLACK,null,null);{let v=parseInt(d/2,10)+c,w=i(c,v),P=i(v+1,u);return f=n[v],m=t?t(f):f,new jr(m,f.node,jr.BLACK,w,P)}},o=function(c){let u=null,d=null,f=n.length,m=function(w,P){let N=f-w,L=f;f-=w;let q=i(N+1,L),Y=n[N],re=t?t(Y):Y;v(new jr(re,Y.node,P,null,q))},v=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<c.count;++w){let P=c.nextBitIsOne(),N=Math.pow(2,c.count-(w+1));P?m(N,jr.BLACK):(m(N,jr.BLACK),m(N,jr.RED))}return d},s=new X0(n.length),a=o(s);return new _r(r||e,a)};var M0,jc={},Kc=class n{static get Default(){return $(jc&&vn,"ChildrenNode.ts has not been loaded"),M0=M0||new n({".priority":jc},{".priority":vn}),M0}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Xo(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof _r?t:null}hasIndex(e){return Gr(this.indexSet_,e.toString())}addIndex(e,t){$(e!==qc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(Be.Wrap),s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=gg(r,e.getCompare()):a=jc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Ul(this.indexes_,(i,o)=>{let s=Xo(this.indexSet_,o);if($(s,"Missing index implementation for "+o),i===jc)if(s.isDefinedOn(e.node)){let a=[],c=t.getIterator(Be.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),gg(a,s.getCompare())}else return jc;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Be(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ul(this.indexes_,i=>{if(i===jc)return i;{let o=t.get(e.name);return o?i.remove(new Be(e.name,o)):i}});return new n(r,this.indexSet_)}};var Id,vt=(()=>{class n{static get EMPTY_NODE(){return Id||(Id=new n(new _r(xC),null,Kc.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&A1(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Id}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Id:r}}getChild(t){let r=je(t);return r===null?this:this.getImmediateChild(r).getChild(ct(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if($(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Be(t,r),o,s;r.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(i,this.children_));let a=o.isEmpty()?Id:this.priorityNode_;return new n(o,a,s)}}updateChild(t,r){let i=je(t);if(i===null)return r;{$(je(t)!==".priority"||jo(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(ct(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,s=!0;if(this.forEachChild(vn,(a,c)=>{r[a]=c.val(t),i++,s&&n.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):s=!1}),!t&&s&&o<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+S1(this.getPriority().val())+":"),this.forEachChild(vn,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":r1(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let s=o.getPredecessorKey(new Be(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Be(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Be(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,Be.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)<0;)o.getNext(),s=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,Be.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)>0;)o.getNext(),s=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===kd?-1:0}withIndex(t){if(t===qc||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===qc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(vn),o=r.getIterator(vn),s=i.getNext(),a=o.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=o.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===qc?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),eC=class extends vt{constructor(){super(new _r(xC),vt.EMPTY_NODE,Kc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return vt.EMPTY_NODE}isEmpty(){return!1}},kd=new eC;Object.defineProperties(Be,{MIN:{value:new Be(Wc,vt.EMPTY_NODE)},MAX:{value:new Be(Xs,kd)}});mg.__EMPTY_NODE=vt.EMPTY_NODE;Gc.__childrenNodeConstructor=vt;V8(kd);j8(kd);var $8=!0;function gn(n,e=null){if(n===null)return vt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Gc(t,gn(e))}if(!(n instanceof Array)&&$8){let t=[],r=!1;if(wr(n,(s,a)=>{if(s.substring(0,1)!=="."){let c=gn(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Be(s,c)))}}),t.length===0)return vt.EMPTY_NODE;let o=gg(t,L8,s=>s.name,xC);if(r){let s=gg(t,vn.getCompare());return new vt(o,gn(e),new Kc({".priority":s},{".priority":vn}))}else return new vt(o,gn(e),Kc.Default)}else{let t=vt.EMPTY_NODE;return wr(n,(r,i)=>{if(Gr(n,r)&&r.substring(0,1)!=="."){let o=gn(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(gn(e))}}U8(gn);var tC=class extends zc{constructor(e){super(),this.indexPath_=e,$(!Oe(e)&&je(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Jc(e.name,t.name):o}makePost(e,t){let r=gn(e),i=vt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Be(t,i)}maxPost(){let e=vt.EMPTY_NODE.updateChild(this.indexPath_,kd);return new Be(Xs,e)}toString(){return T1(this.indexPath_,0).join("/")}};var nC=class extends zc{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Jc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Be.MIN}maxPost(){return Be.MAX}makePost(e,t){let r=gn(e);return new Be(t,r)}toString(){return".value"}},H8=new nC;function q8(n){return{type:"value",snapshotNode:n}}function W8(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function z8(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function UO(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function G8(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var rC=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=vn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Wc}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===vn}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function jO(n){let e={};if(n.isDefault())return e;let t;if(n.index_===vn?t="$priority":n.index_===H8?t="$value":n.index_===qc?t="$key":($(n.index_ instanceof tC,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=zt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=zt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+zt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=zt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+zt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function BO(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==vn&&(e.i=n.index_.toString()),e}var iC=class n extends hg{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Md("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let s=n.getListenId_(e,r),a={};this.listens_[s]=a;let c=jO(e._queryParams);this.restRequest_(o+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(o,f,!1,r),Xo(this.listens_,s)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=jO(e._queryParams),r=e._path.toString(),i=new pa;return this.restRequest_(r+".json",t,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+es(t);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=wh(a.responseText)}catch{tr("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&tr("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var oC=class{constructor(){this.rootNode_=vt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function vg(){return{value:null,children:new Map}}function N1(n,e,t){if(Oe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=je(e);n.children.has(r)||n.children.set(r,vg());let i=n.children.get(r);e=ct(e),N1(i,e,t)}}function sC(n,e,t){n.value!==null?t(e,n.value):K8(n,(r,i)=>{let o=new et(e.toString()+"/"+r);sC(i,o,t)})}function K8(n,e){n.children.forEach((t,r)=>{e(r,t)})}var aC=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&wr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var $O=10*1e3,Y8=30*1e3,Q8=5*60*1e3,cC=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new aC(e);let r=$O+(Y8-$O)*Math.random();Cd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;wr(e,(i,o)=>{o>0&&Gr(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),Cd(this.reportStats_.bind(this),Math.floor(Math.random()*2*Q8))}};var Bi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Bi||{});function M1(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function P1(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function k1(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var lC=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Bi.ACK_USER_WRITE,this.source=M1()}operationForChild(e){if(Oe(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new et(e));return new n(Ke(),t,this.revert)}}else return $(je(this.path)===e,"operationForChild called for unrelated child."),new n(ct(this.path),this.affectedTree,this.revert)}};var Yc=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Bi.OVERWRITE}operationForChild(e){return Oe(this.path)?new n(this.source,Ke(),this.snap.getImmediateChild(e)):new n(this.source,ct(this.path),this.snap)}};var yg=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Bi.MERGE}operationForChild(e){if(Oe(this.path)){let t=this.children.subtree(new et(e));return t.isEmpty()?null:t.value?new Yc(this.source,Ke(),t.value):new n(this.source,Ke(),t)}else return $(je(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,ct(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ad=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Oe(e))return this.isFullyInitialized()&&!this.filtered_;let t=je(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function Z8(n,e,t,r){let i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&n.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(G8(s.childName,s.snapshotNode))}),Td(n,i,"child_removed",e,r,t),Td(n,i,"child_added",e,r,t),Td(n,i,"child_moved",o,r,t),Td(n,i,"child_changed",e,r,t),Td(n,i,"value",e,r,t),i}function Td(n,e,t,r,i,o){let s=r.filter(a=>a.type===t);s.sort((a,c)=>X8(n,a,c)),s.forEach(a=>{let c=J8(n,a,o);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function J8(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function X8(n,e,t){if(e.childName==null||t.childName==null)throw fa("Should only compare child_ events.");let r=new Be(e.childName,e.snapshotNode),i=new Be(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function O1(n,e){return{eventCache:n,serverCache:e}}function Dd(n,e,t,r){return O1(new Ad(e,t,r),n.serverCache)}function F1(n,e,t,r){return O1(n.eventCache,new Ad(e,t,r))}function uC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ea(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var P0,eK=()=>(P0||(P0=new _r(e8)),P0),qn=class n{static fromObject(e){let t=new n(null);return wr(e,(r,i)=>{t=t.set(new et(r),i)}),t}constructor(e,t=eK()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ke(),value:this.value};if(Oe(e))return null;{let r=je(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(ct(e),t);return o!=null?{path:Zt(new et(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Oe(e))return this;{let t=je(e),r=this.children.get(t);return r!==null?r.subtree(ct(e)):new n(null)}}set(e,t){if(Oe(e))return new n(t,this.children);{let r=je(e),o=(this.children.get(r)||new n(null)).set(ct(e),t),s=this.children.insert(r,o);return new n(this.value,s)}}remove(e){if(Oe(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=je(e),r=this.children.get(t);if(r){let i=r.remove(ct(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(Oe(e))return this.value;{let t=je(e),r=this.children.get(t);return r?r.get(ct(e)):null}}setTree(e,t){if(Oe(e))return t;{let r=je(e),o=(this.children.get(r)||new n(null)).setTree(ct(e),t),s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new n(this.value,s)}}fold(e){return this.fold_(Ke(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Zt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ke(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Oe(e))return null;{let o=je(e),s=this.children.get(o);return s?s.findOnPath_(ct(e),Zt(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ke(),t)}foreachOnPath_(e,t,r){if(Oe(e))return this;{this.value&&r(t,this.value);let i=je(e),o=this.children.get(i);return o?o.foreachOnPath_(ct(e),Zt(t,i),r):new n(null)}}foreach(e){this.foreach_(Ke(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Zt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var $r=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new qn(null))}};function Sd(n,e,t){if(Oe(e))return new $r(new qn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,s=yr(i,e);return o=o.updateChild(s,t),new $r(n.writeTree_.set(i,o))}else{let i=new qn(t),o=n.writeTree_.setTree(e,i);return new $r(o)}}}function HO(n,e,t){let r=n;return wr(t,(i,o)=>{r=Sd(r,Zt(e,i),o)}),r}function qO(n,e){if(Oe(e))return $r.empty();{let t=n.writeTree_.setTree(e,new qn(null));return new $r(t)}}function dC(n,e){return ta(n,e)!=null}function ta(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(yr(t.path,e)):null}function WO(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(vn,(r,i)=>{e.push(new Be(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Be(r,i.value))}),e}function Uo(n,e){if(Oe(e))return n;{let t=ta(n,e);return t!=null?new $r(new qn(t)):new $r(n.writeTree_.subtree(e))}}function hC(n){return n.writeTree_.isEmpty()}function Qc(n,e){return L1(Ke(),n.writeTree_,e)}function L1(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?($(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=L1(Zt(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Zt(n,".priority"),r)),t}}function V1(n,e){return H1(e,n)}function tK(n,e,t,r,i){$(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Sd(n.visibleWrites,e,t)),n.lastWriteId=r}function nK(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function rK(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,s=n.allWrites.length-1;for(;i&&s>=0;){let a=n.allWrites[s];a.visible&&(s>=t&&iK(a,r.path)?i=!1:Br(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return oK(n),!0;if(r.snap)n.visibleWrites=qO(n.visibleWrites,r.path);else{let a=r.children;wr(a,c=>{n.visibleWrites=qO(n.visibleWrites,Zt(r.path,c))})}return!0}else return!1}function iK(n,e){if(n.snap)return Br(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Br(Zt(n.path,t),e))return!0;return!1}function oK(n){n.visibleWrites=U1(n.allWrites,sK,Ke()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function sK(n){return n.visible}function U1(n,e,t){let r=$r.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let s=o.path,a;if(o.snap)Br(t,s)?(a=yr(t,s),r=Sd(r,a,o.snap)):Br(s,t)&&(a=yr(s,t),r=Sd(r,Ke(),o.snap.getChild(a)));else if(o.children){if(Br(t,s))a=yr(t,s),r=HO(r,a,o.children);else if(Br(s,t))if(a=yr(s,t),Oe(a))r=HO(r,Ke(),o.children);else{let c=Xo(o.children,je(a));if(c){let u=c.getChild(ct(a));r=Sd(r,Ke(),u)}}}else throw fa("WriteRecord should have .snap or .children")}}return r}function j1(n,e,t,r,i){if(!r&&!i){let o=ta(n.visibleWrites,e);if(o!=null)return o;{let s=Uo(n.visibleWrites,e);if(hC(s))return t;if(t==null&&!dC(s,Ke()))return null;{let a=t||vt.EMPTY_NODE;return Qc(s,a)}}}else{let o=Uo(n.visibleWrites,e);if(!i&&hC(o))return t;if(!i&&t==null&&!dC(o,Ke()))return null;{let s=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Br(u.path,e)||Br(e,u.path))},a=U1(n.allWrites,s,e),c=t||vt.EMPTY_NODE;return Qc(a,c)}}}function aK(n,e,t){let r=vt.EMPTY_NODE,i=ta(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(vn,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(t){let o=Uo(n.visibleWrites,e);return t.forEachChild(vn,(s,a)=>{let c=Qc(Uo(o,new et(s)),a);r=r.updateImmediateChild(s,c)}),WO(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let o=Uo(n.visibleWrites,e);return WO(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function cK(n,e,t,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=Zt(e,t);if(dC(n.visibleWrites,o))return null;{let s=Uo(n.visibleWrites,o);return hC(s)?i.getChild(t):Qc(s,i.getChild(t))}}function lK(n,e,t,r){let i=Zt(e,t),o=ta(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let s=Uo(n.visibleWrites,i);return Qc(s,r.getNode().getImmediateChild(t))}else return null}function uK(n,e){return ta(n.visibleWrites,e)}function dK(n,e,t,r,i,o,s){let a,c=Uo(n.visibleWrites,e),u=ta(c,Ke());if(u!=null)a=u;else if(t!=null)a=Qc(c,t);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=s.getCompare(),m=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),v=m.getNext();for(;v&&d.length<i;)f(v,r)!==0&&d.push(v),v=m.getNext();return d}else return[]}function hK(){return{visibleWrites:$r.empty(),allWrites:[],lastWriteId:-1}}function fC(n,e,t,r){return j1(n.writeTree,n.treePath,e,t,r)}function B1(n,e){return aK(n.writeTree,n.treePath,e)}function zO(n,e,t,r){return cK(n.writeTree,n.treePath,e,t,r)}function _g(n,e){return uK(n.writeTree,Zt(n.treePath,e))}function fK(n,e,t,r,i,o){return dK(n.writeTree,n.treePath,e,t,r,i,o)}function NC(n,e,t){return lK(n.writeTree,n.treePath,e,t)}function $1(n,e){return H1(Zt(n.treePath,e),n.writeTree)}function H1(n,e){return{treePath:n,writeTree:e}}var pC=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,UO(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,z8(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,W8(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,UO(r,e.snapshotNode,i.oldSnap));else throw fa("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var mC=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},q1=new mC,Rd=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Ad(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return NC(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ea(this.viewCache_),o=fK(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function pK(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function mK(n,e,t,r,i){let o=new pC,s,a;if(t.type===Bi.OVERWRITE){let u=t;u.source.fromUser?s=gC(n,e,u.path,u.snap,r,i,o):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Oe(u.path),s=wg(n,e,u.path,u.snap,r,i,a,o))}else if(t.type===Bi.MERGE){let u=t;u.source.fromUser?s=vK(n,e,u.path,u.children,r,i,o):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),s=vC(n,e,u.path,u.children,r,i,a,o))}else if(t.type===Bi.ACK_USER_WRITE){let u=t;u.revert?s=wK(n,e,u.path,r,i,o):s=yK(n,e,u.path,u.affectedTree,r,i,o)}else if(t.type===Bi.LISTEN_COMPLETE)s=_K(n,e,t.path,r,o);else throw fa("Unknown operation type: "+t.type);let c=o.getChanges();return gK(e,s,c),{viewCache:s,changes:c}}function gK(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=uC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(q8(uC(e)))}}function W1(n,e,t,r,i,o){let s=e.eventCache;if(_g(r,t)!=null)return e;{let a,c;if(Oe(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=ea(e),d=u instanceof vt?u:vt.EMPTY_NODE,f=B1(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{let u=fC(r,ea(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{let u=je(t);if(u===".priority"){$(jo(t)===1,"Can't have a priority with additional path components");let d=s.getNode();c=e.serverCache.getNode();let f=zO(r,t,d,c);f!=null?a=n.filter.updatePriority(d,f):a=s.getNode()}else{let d=ct(t),f;if(s.isCompleteForChild(u)){c=e.serverCache.getNode();let m=zO(r,t,s.getNode(),c);m!=null?f=s.getNode().getImmediateChild(u).updateChild(d,m):f=s.getNode().getImmediateChild(u)}else f=NC(r,u,e.serverCache);f!=null?a=n.filter.updateChild(s.getNode(),u,f,d,i,o):a=s.getNode()}}return Dd(e,a,s.isFullyInitialized()||Oe(t),n.filter.filtersNodes())}}function wg(n,e,t,r,i,o,s,a){let c=e.serverCache,u,d=s?n.filter:n.filter.getIndexedFilter();if(Oe(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let v=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),v,null)}else{let v=je(t);if(!c.isCompleteForPath(t)&&jo(t)>1)return e;let w=ct(t),N=c.getNode().getImmediateChild(v).updateChild(w,r);v===".priority"?u=d.updatePriority(c.getNode(),N):u=d.updateChild(c.getNode(),v,N,w,q1,null)}let f=F1(e,u,c.isFullyInitialized()||Oe(t),d.filtersNodes()),m=new Rd(i,f,o);return W1(n,f,t,i,m,a)}function gC(n,e,t,r,i,o,s){let a=e.eventCache,c,u,d=new Rd(i,e,o);if(Oe(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,s),c=Dd(e,u,!0,n.filter.filtersNodes());else{let f=je(t);if(f===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=Dd(e,u,a.isFullyInitialized(),a.isFiltered());else{let m=ct(t),v=a.getNode().getImmediateChild(f),w;if(Oe(m))w=r;else{let P=d.getCompleteChild(f);P!=null?I1(m)===".priority"&&P.getChild(C1(m)).isEmpty()?w=P:w=P.updateChild(m,r):w=vt.EMPTY_NODE}if(v.equals(w))c=e;else{let P=n.filter.updateChild(a.getNode(),f,w,m,d,s);c=Dd(e,P,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function GO(n,e){return n.eventCache.isCompleteForChild(e)}function vK(n,e,t,r,i,o,s){let a=e;return r.foreach((c,u)=>{let d=Zt(t,c);GO(e,je(d))&&(a=gC(n,a,d,u,i,o,s))}),r.foreach((c,u)=>{let d=Zt(t,c);GO(e,je(d))||(a=gC(n,a,d,u,i,o,s))}),a}function KO(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function vC(n,e,t,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Oe(t)?u=r:u=new qn(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){let v=e.serverCache.getNode().getImmediateChild(f),w=KO(n,v,m);c=wg(n,c,new et(f),w,i,o,s,a)}}),u.children.inorderTraversal((f,m)=>{let v=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!d.hasChild(f)&&!v){let w=e.serverCache.getNode().getImmediateChild(f),P=KO(n,w,m);c=wg(n,c,new et(f),P,i,o,s,a)}}),c}function yK(n,e,t,r,i,o,s){if(_g(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Oe(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return wg(n,e,t,c.getNode().getChild(t),i,o,a,s);if(Oe(t)){let u=new qn(null);return c.getNode().forEachChild(qc,(d,f)=>{u=u.set(new et(d),f)}),vC(n,e,t,u,i,o,a,s)}else return e}else{let u=new qn(null);return r.foreach((d,f)=>{let m=Zt(t,d);c.isCompleteForPath(m)&&(u=u.set(d,c.getNode().getChild(m)))}),vC(n,e,t,u,i,o,a,s)}}function _K(n,e,t,r,i){let o=e.serverCache,s=F1(e,o.getNode(),o.isFullyInitialized()||Oe(t),o.isFiltered());return W1(n,s,t,r,q1,i)}function wK(n,e,t,r,i,o){let s;if(_g(r,t)!=null)return e;{let a=new Rd(r,e,i),c=e.eventCache.getNode(),u;if(Oe(t)||je(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=fC(r,ea(e));else{let f=e.serverCache.getNode();$(f instanceof vt,"serverChildren would be complete if leaf node"),d=B1(r,f)}d=d,u=n.filter.updateFullNode(c,d,o)}else{let d=je(t),f=NC(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=n.filter.updateChild(c,d,f,ct(t),a,o):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,vt.EMPTY_NODE,ct(t),a,o):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=fC(r,ea(e)),s.isLeafNode()&&(u=n.filter.updateFullNode(u,s,o)))}return s=e.serverCache.isFullyInitialized()||_g(r,Ke())!=null,Dd(e,u,s,n.filter.filtersNodes())}}function EK(n,e){let t=ea(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Oe(e)&&!t.getImmediateChild(je(e)).isEmpty())?t.getChild(e):null}function YO(n,e,t,r){e.type===Bi.MERGE&&e.source.queryId!==null&&($(ea(n.viewCache_),"We should always have a full cache before handling merges"),$(uC(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=mK(n.processor_,i,e,t,r);return pK(n.processor_,o.viewCache),$(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,IK(n,o.changes,o.viewCache.eventCache.getNode(),null)}function IK(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return Z8(n.eventGenerator_,e,t,i)}var QO;function TK(n){$(!QO,"__referenceConstructor has already been defined"),QO=n}function MC(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return $(o!=null,"SyncTree gave us an op for an invalid query."),YO(o,e,t,r)}else{let o=[];for(let s of n.views.values())o=o.concat(YO(s,e,t,r));return o}}function PC(n,e){let t=null;for(let r of n.views.values())t=t||EK(r,e);return t}var ZO;function CK(n){$(!ZO,"__referenceConstructor has already been defined"),ZO=n}var Eg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qn(null),this.pendingWriteTree_=hK(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function bK(n,e,t,r,i){return tK(n.pendingWriteTree_,e,t,r,i),i?Tg(n,new Yc(M1(),e,t)):[]}function $c(n,e,t=!1){let r=nK(n.pendingWriteTree_,e);if(rK(n.pendingWriteTree_,e)){let o=new qn(null);return r.snap!=null?o=o.set(Ke(),!0):wr(r.children,s=>{o=o.set(new et(s),!0)}),Tg(n,new lC(r.path,o,t))}else return[]}function Ig(n,e,t){return Tg(n,new Yc(P1(),e,t))}function DK(n,e,t){let r=qn.fromObject(t);return Tg(n,new yg(P1(),e,r))}function SK(n,e,t,r){let i=Y1(n,r);if(i!=null){let o=Q1(i),s=o.path,a=o.queryId,c=yr(s,e),u=new Yc(k1(a),c,t);return Z1(n,s,u)}else return[]}function AK(n,e,t,r){let i=Y1(n,r);if(i){let o=Q1(i),s=o.path,a=o.queryId,c=yr(s,e),u=qn.fromObject(t),d=new yg(k1(a),c,u);return Z1(n,s,d)}else return[]}function z1(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(s,a)=>{let c=yr(s,e),u=PC(a,c);if(u)return u});return j1(i,e,o,t,!0)}function Tg(n,e){return G1(e,n.syncPointTree_,null,V1(n.pendingWriteTree_,Ke()))}function G1(n,e,t,r){if(Oe(n.path))return K1(n,e,t,r);{let i=e.get(Ke());t==null&&i!=null&&(t=PC(i,Ke()));let o=[],s=je(n.path),a=n.operationForChild(s),c=e.children.get(s);if(c&&a){let u=t?t.getImmediateChild(s):null,d=$1(r,s);o=o.concat(G1(a,c,u,d))}return i&&(o=o.concat(MC(i,n,r,t))),o}}function K1(n,e,t,r){let i=e.get(Ke());t==null&&i!=null&&(t=PC(i,Ke()));let o=[];return e.children.inorderTraversal((s,a)=>{let c=t?t.getImmediateChild(s):null,u=$1(r,s),d=n.operationForChild(s);d&&(o=o.concat(K1(d,a,c,u)))}),i&&(o=o.concat(MC(i,n,r,t))),o}function Y1(n,e){return n.tagToQueryMap.get(e)}function Q1(n){let e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new et(n.substr(0,e))}}function Z1(n,e,t){let r=n.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");let i=V1(n.pendingWriteTree_,e);return MC(r,t,i,null)}var yC=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},_C=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Zt(this.path_,e);return new n(this.syncTree_,t)}node(){return z1(this.syncTree_,this.path_)}},RK=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},JO=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return xK(n[".sv"],e,t);if(typeof n[".sv"]=="object")return NK(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},xK=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},NK=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);let i=e.node();if($(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return typeof s!="number"?r:s+r},MK=function(n,e,t,r){return kC(e,new _C(t,n),r)},PK=function(n,e,t){return kC(n,new yC(e),t)};function kC(n,e,t){let r=n.getPriority().val(),i=JO(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let s=n,a=JO(s.getValue(),e,t);return a!==s.getValue()||i!==s.getPriority().val()?new Gc(a,gn(i)):n}else{let s=n;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new Gc(i))),s.forEachChild(vn,(a,c)=>{let u=kC(c,e.getImmediateChild(a),t);u!==c&&(o=o.updateImmediateChild(a,u))}),o}}var xd=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function OC(n,e){let t=e instanceof et?e:new et(e),r=n,i=je(t);for(;i!==null;){let o=Xo(r.node.children,i)||{children:{},childCount:0};r=new xd(i,r,o),t=ct(t),i=je(t)}return r}function Xc(n){return n.node.value}function J1(n,e){n.node.value=e,wC(n)}function X1(n){return n.node.childCount>0}function kK(n){return Xc(n)===void 0&&!X1(n)}function Cg(n,e){wr(n.node.children,(t,r)=>{e(new xd(t,n,r))})}function eF(n,e,t,r){t&&!r&&e(n),Cg(n,i=>{eF(i,e,!0,r)}),t&&r&&e(n)}function OK(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Od(n){return new et(n.parent===null?n.name:Od(n.parent)+"/"+n.name)}function wC(n){n.parent!==null&&FK(n.parent,n.name,n)}function FK(n,e,t){let r=kK(t),i=Gr(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,wC(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,wC(n))}var LK=/[\[\].#$\/\u0000-\u001F\u007F]/,VK=/[\[\].#$\u0000-\u001F\u007F]/,k0=10*1024*1024,tF=function(n){return typeof n=="string"&&n.length!==0&&!LK.test(n)},UK=function(n){return typeof n=="string"&&n.length!==0&&!VK.test(n)},jK=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),UK(n)};var nF=function(n,e,t){let r=t instanceof et?new K0(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Qs(r));if(typeof e=="function")throw new Error(n+"contains a function "+Qs(r)+" with contents = "+e.toString());if(i1(e))throw new Error(n+"contains "+e.toString()+" "+Qs(r));if(typeof e=="string"&&e.length>k0/3&&Bl(e)>k0)throw new Error(n+"contains a string greater than "+k0+" utf8 bytes "+Qs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(wr(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!tF(s)))throw new Error(n+" contains an invalid key ("+s+") "+Qs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);N8(r,s),nF(n,a,r),M8(r)}),i&&o)throw new Error(n+' contains ".value" child '+Qs(r)+" in addition to actual children.")}};var BK=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!tF(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!jK(t))throw new Error(WD(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var EC=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function $K(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!b1(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function na(n,e,t){$K(n,t),HK(n,r=>Br(r,e)||Br(e,r))}function HK(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(qK(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function qK(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Js&&mn("event: "+t.toString()),Pd(r)}}}var WK="repo_interrupt",zK=25,IC=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vg(),this.transactionQueueTree_=new xd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function GK(n,e,t){if(n.stats_=AC(n.repoInfo_),n.forceRestClient_||s8())n.server_=new iC(n.repoInfo_,(r,i,o,s)=>{XO(n,r,i,o,s)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>e1(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{zt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new RC(n.repoInfo_,e,(r,i,o,s)=>{XO(n,r,i,o,s)},r=>{e1(n,r)},r=>{YK(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=c8(n.repoInfo_,()=>new cC(n.stats_,n.server_)),n.infoData_=new oC,n.infoSyncTree_=new Eg({startListening:(r,i,o,s)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Ig(n.infoSyncTree_,r._path,c),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),FC(n,"connected",!1),n.serverSyncTree_=new Eg({startListening:(r,i,o,s)=>(n.server_.listen(r,o,i,(a,c)=>{let u=s(a,c);na(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function KK(n){let t=n.infoData_.getNode(new et(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function rF(n){return RK({timestamp:KK(n)})}function XO(n,e,t,r,i){n.dataUpdateCount++;let o=new et(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let s=[];if(i)if(r){let c=Ul(t,u=>gn(u));s=AK(n.serverSyncTree_,o,c,i)}else{let c=gn(t);s=SK(n.serverSyncTree_,o,c,i)}else if(r){let c=Ul(t,u=>gn(u));s=DK(n.serverSyncTree_,o,c)}else{let c=gn(t);s=Ig(n.serverSyncTree_,o,c)}let a=o;s.length>0&&(a=VC(n,o)),na(n.eventQueue_,a,s)}function e1(n,e){FC(n,"connected",e),e===!1&&ZK(n)}function YK(n,e){wr(e,(t,r)=>{FC(n,t,r)})}function FC(n,e,t){let r=new et("/.info/"+e),i=gn(t);n.infoData_.updateSnapshot(r,i);let o=Ig(n.infoSyncTree_,r,i);na(n.eventQueue_,r,o)}function QK(n){return n.nextWriteId_++}function ZK(n){iF(n,"onDisconnectEvents");let e=rF(n),t=vg();sC(n.onDisconnect_,Ke(),(i,o)=>{let s=MK(i,o,n.serverSyncTree_,e);N1(t,i,s)});let r=[];sC(t,Ke(),(i,o)=>{r=r.concat(Ig(n.serverSyncTree_,i,o));let s=t7(n,i);VC(n,s)}),n.onDisconnect_=vg(),na(n.eventQueue_,Ke(),r)}function JK(n){n.persistentConnection_&&n.persistentConnection_.interrupt(WK)}function iF(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),mn(t,...e)}function oF(n,e,t){return z1(n.serverSyncTree_,e,t)||vt.EMPTY_NODE}function LC(n,e=n.transactionQueueTree_){if(e||bg(n,e),Xc(e)){let t=aF(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&XK(n,Od(e),t)}else X1(e)&&Cg(e,t=>{LC(n,t)})}function XK(n,e,t){let r=t.map(u=>u.currentWriteId),i=oF(n,e,r),o=i,s=i.hash();for(let u=0;u<t.length;u++){let d=t[u];$(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=yr(e,d.path);o=o.updateChild(f,d.currentOutputSnapshotRaw)}let a=o.val(!0),c=e;n.server_.put(c.toString(),a,u=>{iF(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let f=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat($c(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&f.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();bg(n,OC(n.transactionQueueTree_,e)),LC(n,n.transactionQueueTree_),na(n.eventQueue_,e,d);for(let m=0;m<f.length;m++)Pd(f[m])}else{if(u==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{tr("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=u}VC(n,e)}},s)}function VC(n,e){let t=sF(n,e),r=Od(t),i=aF(n,t);return e7(n,i,r),r}function e7(n,e,t){if(e.length===0)return;let r=[],i=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=yr(t,c.path),d=!1,f;if($(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat($c(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=zK)d=!0,f="maxretry",i=i.concat($c(n.serverSyncTree_,c.currentWriteId,!0));else{let m=oF(n,c.path,s);c.currentInputSnapshot=m;let v=e[a].update(m.val());if(v!==void 0){nF("transaction failed: Data returned ",v,c.path);let w=gn(v);typeof v=="object"&&v!=null&&Gr(v,".priority")||(w=w.updatePriority(m.getPriority()));let N=c.currentWriteId,L=rF(n),q=PK(w,m,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=q,c.currentWriteId=QK(n),s.splice(s.indexOf(N),1),i=i.concat(bK(n.serverSyncTree_,c.path,q,c.currentWriteId,c.applyLocally)),i=i.concat($c(n.serverSyncTree_,N,!0))}else d=!0,f="nodata",i=i.concat($c(n.serverSyncTree_,c.currentWriteId,!0))}na(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}bg(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Pd(r[a]);LC(n,n.transactionQueueTree_)}function sF(n,e){let t,r=n.transactionQueueTree_;for(t=je(e);t!==null&&Xc(r)===void 0;)r=OC(r,t),e=ct(e),t=je(e);return r}function aF(n,e){let t=[];return cF(n,e,t),t.sort((r,i)=>r.order-i.order),t}function cF(n,e,t){let r=Xc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Cg(e,i=>{cF(n,i,t)})}function bg(n,e){let t=Xc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,J1(e,t.length>0?t:void 0)}Cg(e,r=>{bg(n,r)})}function t7(n,e){let t=Od(sF(n,e)),r=OC(n.transactionQueueTree_,e);return OK(r,i=>{O0(n,i)}),O0(n,r),eF(r,i=>{O0(n,i)}),t}function O0(n,e){let t=Xc(e);if(t){let r=[],i=[],o=-1;for(let s=0;s<t.length;s++)t[s].status===3||(t[s].status===1?($(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=3,t[s].abortReason="set"):($(t[s].status===0,"Unexpected transaction status in abort"),t[s].unwatcher(),i=i.concat($c(n.serverSyncTree_,t[s].currentWriteId,!0)),t[s].onComplete&&r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?J1(e,void 0):t.length=o+1,na(n.eventQueue_,Od(e),i);for(let s=0;s<r.length;s++)Pd(r[s])}}function n7(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function r7(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):tr(`Invalid query segment '${t}' in query '${n}'`)}return e}var t1=function(n,e){let t=i7(n),r=t.namespace;t.domain==="firebase.com"&&$i(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&$i("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||J9();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new ug(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new et(t.pathString)}},i7=function(n){let e="",t="",r="",i="",o="",s=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=n7(n.substring(d,f)));let m=r7(n.substring(Math.min(n.length,f)));u=e.indexOf(":"),u>=0?(s=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let v=e.slice(0,u);if(v.toLowerCase()==="localhost")t="localhost";else if(v.split(".").length<=2)t=v;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),o=r}"ns"in m&&(o=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};var TC=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Oe(this._path)?null:I1(this._path)}get ref(){return new Zc(this._repo,this._path)}get _queryIdentifier(){let e=BO(this._queryParams),t=SC(e);return t==="{}"?"default":t}get _queryObject(){return BO(this._queryParams)}isEqual(e){if(e=Fe(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=b1(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+x8(this._path)}};var Zc=class n extends TC{constructor(e,t){super(e,t,new rC,!1)}get parent(){let e=C1(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};TK(Zc);CK(Zc);var o7="FIREBASE_DATABASE_EMULATOR_HOST",CC={},s7=!1;function a7(n,e,t,r){n.repoInfo_=new ug(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function c7(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||$i("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),mn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let s=t1(o,i),a=s.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[o7]),u?(c=!0,o=`http://${u}?ns=${a.namespace}`,s=t1(o,i),a=s.repoInfo):c=!s.repoInfo.secure;let d=i&&c?new bd(bd.OWNER):new B0(n.name,n.options,e);BK("Invalid Firebase Database URL",s),Oe(s.path)||$i("Database URL must point to the root of a Firebase Database (not including a child path).");let f=u7(a,n,d,new j0(n.name,t));return new bC(f,n)}function l7(n,e){let t=CC[e];(!t||t[n.key]!==n)&&$i(`Database ${e}(${n.repoInfo_}) has already been deleted.`),JK(n),delete t[n.key]}function u7(n,e,t,r){let i=CC[e.name];i||(i={},CC[e.name]=i);let o=i[n.toURLString()];return o&&$i("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new IC(n,s7,t,r),i[n.toURLString()]=o,o}var bC=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(GK(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Zc(this._repo,Ke())),this._rootInternal}_delete(){return this._rootInternal!==null&&(l7(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$i("Cannot call "+e+" on a deleted database.")}};function lF(n=Ht(),e){let t=$t(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=no("database");r&&uF(t,...r)}return t}function uF(n,e,t,r={}){n=Fe(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&$i("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&$i('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new bd(bd.OWNER);else if(r.mockUserToken){let s=typeof r.mockUserToken=="string"?r.mockUserToken:ma(r.mockUserToken,n.app.options.projectId);o=new bd(s)}a7(i,e,t,o)}function d7(n){Y9(Pn),It(new Et("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return c7(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),te(TO,CO,n),te(TO,CO,"esm2017")}RC.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};RC.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};d7();var Fd=class{constructor(e){return e}},dF="database",UC=class{constructor(){return Ft(dF)}};var jC=new W("angularfire2.database-instances");function h7(n,e){let t=Wt(dF,n,e);return t&&new Fd(t)}function f7(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Fd(r)}}var p7={provide:UC,deps:[[new Ie,jC]]},m7={provide:Fd,useFactory:h7,deps:[[new Ie,jC],mt]};function hF(n,...e){return te("angularfire",dt.full,"rtdb"),ut([m7,p7,{provide:jC,useFactory:f7(n),multi:!0,deps:[me,Se,bt,xt,[new Ie,Fr],[new Ie,pr],...e]}])}var fF=He(lF,!0);var gF="functions";var BC=class{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||t.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return y(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return y(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return y(this,null,function*(){if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return y(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var $C="us-central1";var HC=class{constructor(e,t,r,i,o=$C,s=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new BC(t,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(o);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=$C}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function g7(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var pF="@firebase/functions",mF="0.12.1";var v7="auth-internal",y7="app-check-internal",_7="messaging-internal";function w7(n){let e=(t,{instanceIdentifier:r})=>{let i=t.getProvider("app").getImmediate(),o=t.getProvider(v7),s=t.getProvider(_7),a=t.getProvider(y7);return new HC(i,o,s,a,r)};It(new Et(gF,e,"PUBLIC").setMultipleInstances(!0)),te(pF,mF,n),te(pF,mF,"esm2017")}function vF(n=Ht(),e=$C){let r=$t(Fe(n),gF).getImmediate({identifier:e}),i=no("functions");return i&&yF(r,...i),r}function yF(n,e,t){g7(Fe(n),e,t)}w7();var Ld=class{constructor(e){return e}},_F="functions",qC=class{constructor(){return Ft(_F)}};var WC=new W("angularfire2.functions-instances");function E7(n,e){let t=Wt(_F,n,e);return t&&new Ld(t)}function I7(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ld(r)}}var T7={provide:qC,deps:[[new Ie,WC]]},C7={provide:Ld,useFactory:E7,deps:[[new Ie,WC],mt]};function wF(n,...e){return te("angularfire",dt.full,"fn"),ut([C7,T7,{provide:WC,useFactory:I7(n),multi:!0,deps:[me,Se,bt,xt,[new Ie,Fr],[new Ie,pr],...e]}])}var EF=He(vF,!0);var b7="/firebase-messaging-sw.js",D7="/firebase-cloud-messaging-push-scope",AF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",S7="https://fcmregistrations.googleapis.com/v1",RF="google.c.a.c_id",A7="google.c.a.c_l",R7="google.c.a.ts",x7="google.c.a.e",IF=1e4;var Dg=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}(Dg||{});function Hi(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function N7(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}var zC="fcm_token_details_db",M7=5,TF="fcm_token_object_Store";function P7(n){return y(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(zC))return null;let e=null;return(yield Wv(zC,M7,{upgrade:(r,i,o,s)=>y(this,null,function*(){var a;if(i<2||!r.objectStoreNames.contains(TF))return;let c=s.objectStore(TF),u=yield c.index("fcmSenderId").get(n);if(yield c.clear(),!!u){if(i===2){let d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Hi(d.vapidKey)}}}else if(i===3){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Hi(d.auth),p256dh:Hi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Hi(d.vapidKey)}}}else if(i===4){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Hi(d.auth),p256dh:Hi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Hi(d.vapidKey)}}}}})})).close(),yield Eh(zC),yield Eh("fcm_vapid_details_db"),yield Eh("undefined"),k7(e)?e:null})}function k7(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var O7="firebase-messaging-database",F7=1,Vd="firebase-messaging-store",GC=null;function xF(){return GC||(GC=Wv(O7,F7,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Vd)}}})),GC}function L7(n){return y(this,null,function*(){let e=NF(n),r=yield(yield xF()).transaction(Vd).objectStore(Vd).get(e);if(r)return r;{let i=yield P7(n.appConfig.senderId);if(i)return yield QC(n,i),i}})}function QC(n,e){return y(this,null,function*(){let t=NF(n),i=(yield xF()).transaction(Vd,"readwrite");return yield i.objectStore(Vd).put(e,t),yield i.done,e})}function NF({appConfig:n}){return n.appId}var V7={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},xn=new rr("messaging","Messaging",V7);function U7(n,e){return y(this,null,function*(){let t=yield JC(n),r=MF(e),i={method:"POST",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(ZC(n.appConfig),i)).json()}catch(s){throw xn.create("token-subscribe-failed",{errorInfo:s?.toString()})}if(o.error){let s=o.error.message;throw xn.create("token-subscribe-failed",{errorInfo:s})}if(!o.token)throw xn.create("token-subscribe-no-token");return o.token})}function j7(n,e){return y(this,null,function*(){let t=yield JC(n),r=MF(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(`${ZC(n.appConfig)}/${e.token}`,i)).json()}catch(s){throw xn.create("token-update-failed",{errorInfo:s?.toString()})}if(o.error){let s=o.error.message;throw xn.create("token-update-failed",{errorInfo:s})}if(!o.token)throw xn.create("token-update-no-token");return o.token})}function B7(n,e){return y(this,null,function*(){let r={method:"DELETE",headers:yield JC(n)};try{let o=yield(yield fetch(`${ZC(n.appConfig)}/${e}`,r)).json();if(o.error){let s=o.error.message;throw xn.create("token-unsubscribe-failed",{errorInfo:s})}}catch(i){throw xn.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function ZC({projectId:n}){return`${S7}/projects/${n}/registrations`}function JC(t){return y(this,arguments,function*({appConfig:n,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function MF({p256dh:n,auth:e,endpoint:t,vapidKey:r}){let i={web:{endpoint:t,auth:e,p256dh:n}};return r!==AF&&(i.web.applicationPubKey=r),i}var $7=7*24*60*60*1e3;function H7(n){return y(this,null,function*(){let e=yield W7(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Hi(e.getKey("auth")),p256dh:Hi(e.getKey("p256dh"))},r=yield L7(n.firebaseDependencies);if(r){if(z7(r.subscriptionOptions,t))return Date.now()>=r.createTime+$7?q7(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield B7(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return CF(n.firebaseDependencies,t)}else return CF(n.firebaseDependencies,t)})}function q7(n,e){return y(this,null,function*(){try{let t=yield j7(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield QC(n.firebaseDependencies,r),t}catch(t){throw t}})}function CF(n,e){return y(this,null,function*(){let r={token:yield U7(n,e),createTime:Date.now(),subscriptionOptions:e};return yield QC(n,r),r.token})}function W7(n,e){return y(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:N7(e)})})}function z7(n,e){let t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&r&&i&&o}function bF(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return G7(e,n),K7(e,n),Y7(e,n),e}function G7(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let r=e.notification.body;r&&(n.notification.body=r);let i=e.notification.image;i&&(n.notification.image=i);let o=e.notification.icon;o&&(n.notification.icon=o)}function K7(n,e){e.data&&(n.data=e.data)}function Y7(n,e){var t,r,i,o,s;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;a&&(n.fcmOptions.link=a);let c=(s=e.fcmOptions)===null||s===void 0?void 0:s.analytics_label;c&&(n.fcmOptions.analyticsLabel=c)}function Q7(n){return typeof n=="object"&&!!n&&RF in n}Z7("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function Z7(n,e){let t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function J7(n){if(!n||!n.options)throw KC("App Configuration Object");if(!n.name)throw KC("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let r of e)if(!t[r])throw KC(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function KC(n){return xn.create("missing-app-config-values",{valueName:n})}var YC=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=J7(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};function X7(n){return y(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(b7,{scope:D7}),n.swRegistration.update().catch(()=>{}),yield eY(n.swRegistration)}catch(e){throw xn.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function eY(n){return y(this,null,function*(){return new Promise((e,t)=>{let r=setTimeout(()=>t(new Error(`Service worker not registered after ${IF} ms`)),IF),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=o=>{var s;((s=o.target)===null||s===void 0?void 0:s.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})})}function tY(n,e){return y(this,null,function*(){if(!e&&!n.swRegistration&&(yield X7(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw xn.create("invalid-sw-registration");n.swRegistration=e}})}function nY(n,e){return y(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=AF)})}function rY(n,e){return y(this,null,function*(){if(!navigator)throw xn.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw xn.create("permission-blocked");return yield nY(n,e?.vapidKey),yield tY(n,e?.serviceWorkerRegistration),H7(n)})}function iY(n,e,t){return y(this,null,function*(){let r=oY(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[RF],message_name:t[A7],message_time:t[R7],message_device_time:Math.floor(Date.now()/1e3)})})}function oY(n){switch(n){case Dg.NOTIFICATION_CLICKED:return"notification_open";case Dg.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function sY(n,e){return y(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===Dg.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(bF(t)):n.onMessageHandler.next(bF(t)));let r=t.data;Q7(r)&&r[x7]==="1"&&(yield iY(n,t.messageType,r))})}var DF="@firebase/messaging",SF="0.12.16";var aY=n=>{let e=new YC(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>sY(e,t)),e},cY=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:r=>rY(e,r)}};function lY(){It(new Et("messaging",aY,"PUBLIC")),It(new Et("messaging-internal",cY,"PRIVATE")),te(DF,SF),te(DF,SF,"esm2017")}function PF(){return y(this,null,function*(){try{yield ga()}catch{return!1}return typeof window<"u"&&zr()&&Ll()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function kF(n=Ht()){return PF().then(e=>{if(!e)throw xn.create("unsupported-browser")},e=>{throw xn.create("indexed-db-unsupported")}),$t(Fe(n),"messaging").getImmediate()}lY();var Ud=class{constructor(e){return e}},OF="messaging",XC=class{constructor(){return Ft(OF)}};var eb=new W("angularfire2.messaging-instances");function uY(n,e,t){if(Ai(t))return null;let r=Wt(OF,n,e);return r&&new Ud(r)}function dY(n){return(e,t,r)=>{if(Ai(r))return null;let i=e.runOutsideAngular(()=>n(t));return new Ud(i)}}var hY={provide:XC,deps:[[new Ie,eb]]},fY={provide:Ud,useFactory:uY,deps:[[new Ie,eb],mt,Pt]};function FF(n,...e){return te("angularfire",dt.full,"fcm"),ut([fY,hY,{provide:eb,useFactory:dY(n),multi:!0,deps:[me,Se,Pt,bt,xt,...e]}])}var LF=He(kF,!0);var jd=class{constructor(e){return e}},VF="performance",tb=class{constructor(){return Ft(VF)}};var nb=new W("angularfire2.performance-instances");function pY(n,e,t){if(!tc(t))return null;let r=Wt(VF,n,e);return r&&new jd(r)}function mY(n){return(e,t,r)=>{if(!tc(t))return null;let i=e.runOutsideAngular(()=>n(r));return new jd(i)}}var gY={provide:tb,deps:[[new Ie,nb]]},vY={provide:jd,useFactory:pY,deps:[[new Ie,nb],mt,Pt]};function UF(n,...e){return te("angularfire",dt.full,"perf"),ut([vY,gY,{provide:nb,useFactory:mY(n),multi:!0,deps:[me,Pt,Se,bt,xt,...e]}])}var jF=He(KD,!0);var zF="firebasestorage.googleapis.com",yY="storageBucket",_Y=2*60*1e3,wY=10*60*1e3;var li=class n extends Gn{constructor(e,t,r=0){super(rb(e),`Firebase Storage: ${t} (${rb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Wi=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Wi||{});function rb(n){return"storage/"+n}function EY(){let n="An unknown error occurred, please check the error payload for server response.";return new li(Wi.UNKNOWN,n)}function IY(){return new li(Wi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function TY(){return new li(Wi.CANCELED,"User canceled the upload/download.")}function CY(n){return new li(Wi.INVALID_URL,"Invalid URL '"+n+"'.")}function bY(n){return new li(Wi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function BF(n){return new li(Wi.INVALID_ARGUMENT,n)}function GF(){return new li(Wi.APP_DELETED,"The Firebase app was deleted.")}function DY(n){return new li(Wi.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var qi=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw bY(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function o(re){re.path.charAt(re.path.length-1)==="/"&&(re.path_=re.path_.slice(0,-1))}let s="(/(.*))?$",a=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function u(re){re.path_=decodeURIComponent(re.path)}let d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${d}/b/${i}/o${m}`,"i"),w={bucket:1,path:3},P=t===zF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",L=new RegExp(`^https?://${P}/${i}/${N}`,"i"),Y=[{regex:a,indices:c,postModify:o},{regex:v,indices:w,postModify:u},{regex:L,indices:{bucket:1,path:2},postModify:u}];for(let re=0;re<Y.length;re++){let it=Y[re],le=it.regex.exec(e);if(le){let D=le[it.indices.bucket],_=le[it.indices.path];_||(_=""),r=new n(D,_),it.postModify(r);break}}if(r==null)throw CY(e);return r}},ib=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function SY(n,e,t){let r=1,i=null,o=null,s=!1,a=0;function c(){return a===2}let u=!1;function d(...N){u||(u=!0,e.apply(null,N))}function f(N){i=setTimeout(()=>{i=null,n(v,c())},N)}function m(){o&&clearTimeout(o)}function v(N,...L){if(u){m();return}if(N){m(),d.call(null,N,...L);return}if(c()||s){m(),d.call(null,N,...L);return}r<64&&(r*=2);let Y;a===1?(a=2,Y=0):Y=(r+Math.random())*1e3,f(Y)}let w=!1;function P(N){w||(w=!0,m(),!u&&(i!==null?(N||(a=2),clearTimeout(i),f(0)):N||(a=1)))}return f(0),o=setTimeout(()=>{s=!0,P(!0)},t),P}function AY(n){n(!1)}function RY(n){return n!==void 0}function $F(n,e,t,r){if(r<e)throw BF(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw BF(`Invalid value for '${n}'. Expected ${t} or less.`)}function xY(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var ob=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(ob||{});function NY(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}var sb=class{constructor(e,t,r,i,o,s,a,c,u,d,f,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,w)=>{this.resolve_=v,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new el(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let s=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;let a=o.getErrorCode()===ob.NO_ERROR,c=o.getStatus();if(!a||NY(c,this.additionalRetryCodes_)&&this.retry){let d=o.getErrorCode()===ob.ABORT;r(!1,new el(!1,null,d));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new el(u,o))})},t=(r,i)=>{let o=this.resolve_,s=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());RY(c)?o(c):o()}catch(c){s(c)}else if(a!==null){let c=EY();c.serverResponse=a.getErrorText(),this.errorCallback_?s(this.errorCallback_(a,c)):s(c)}else if(i.canceled){let c=this.appDelete_?GF():TY();s(c)}else{let c=IY();s(c)}};this.canceled_?t(!1,new el(!1,null,!0)):this.backoffId_=SY(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&AY(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},el=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function MY(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function PY(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function kY(n,e){e&&(n["X-Firebase-GMPID"]=e)}function OY(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function FY(n,e,t,r,i,o,s=!0){let a=xY(n.urlParams),c=n.url+a,u=Object.assign({},n.headers);return kY(u,e),MY(u,t),PY(u,o),OY(u,r),new sb(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,s)}function LY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function VY(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var zfe=256*1024;var ab=class n{constructor(e,t){this._service=e,t instanceof qi?this._location=t:this._location=qi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new qi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VY(this._location.path)}get storage(){return this._service}get parent(){let e=LY(this._location.path);if(e===null)return null;let t=new qi(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw DY(e)}};function HF(n,e){let t=e?.[yY];return t==null?null:qi.makeFromBucketSpec(t,n)}function UY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:ma(i,n.app.options.projectId))}var cb=class{constructor(e,t,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=zF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_Y,this._maxUploadRetryTime=wY,this._requests=new Set,i!=null?this._bucket=qi.makeFromBucketSpec(i,this._host):this._bucket=HF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qi.makeFromBucketSpec(this._url,e):this._bucket=HF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$F("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$F("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ab(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new ib(GF());{let s=FY(e,this._appId,r,i,t,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},qF="@firebase/storage",WF="0.13.5";var KF="storage";function YF(n=Ht(),e){n=Fe(n);let r=$t(n,KF).getImmediate({identifier:e}),i=no("storage");return i&&QF(r,...i),r}function QF(n,e,t,r={}){UY(n,e,t,r)}function jY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new cb(t,r,i,e,Pn)}function BY(){It(new Et(KF,jY,"PUBLIC").setMultipleInstances(!0)),te(qF,WF,""),te(qF,WF,"esm2017")}BY();var Bd=class{constructor(e){return e}},ZF="storage",lb=class{constructor(){return Ft(ZF)}};var ub=new W("angularfire2.storage-instances");function $Y(n,e){let t=Wt(ZF,n,e);return t&&new Bd(t)}function HY(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Bd(r)}}var qY={provide:lb,deps:[[new Ie,ub]]},WY={provide:Bd,useFactory:$Y,deps:[[new Ie,ub],mt]};function JF(n,...e){return te("angularfire",dt.full,"gcs"),ut([WY,qY,{provide:ub,useFactory:HY(n),multi:!0,deps:[me,Se,bt,xt,[new Ie,Fr],[new Ie,pr],...e]}])}var XF=He(YF,!0);var db="@firebase/remote-config",eL="0.5.0";var nL="remote-config",tL=100;var zY={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser","custom-signal-max-allowed-signals":"Setting more than {$maxSignals} custom signals is not supported."},Nn=new rr("remoteconfig","Remote Config",zY);function rL(n=Ht()){return n=Fe(n),$t(n,nL).getImmediate()}function iL(n){let e=Fe(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var hb=class{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})}};function GY(n=navigator){return n.languages&&n.languages[0]||n.language}var fb=class{constructor(e,t,r,i,o,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=o,this.appId=s}fetch(e){return y(this,null,function*(){let[t,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:GY(),custom_signals:e.customSignals},c={method:"POST",headers:s,body:JSON.stringify(a)},u=fetch(o,c),d=new Promise((N,L)=>{e.signal.addEventListener(()=>{let q=new Error("The operation was aborted.");q.name="AbortError",L(q)})}),f;try{yield Promise.race([u,d]),f=yield u}catch(N){let L="fetch-client-network";throw N?.name==="AbortError"&&(L="fetch-timeout"),Nn.create(L,{originalErrorMessage:N?.message})}let m=f.status,v=f.headers.get("ETag")||void 0,w,P;if(f.status===200){let N;try{N=yield f.json()}catch(L){throw Nn.create("fetch-client-parse",{originalErrorMessage:L?.message})}w=N.entries,P=N.state}if(P==="INSTANCE_STATE_UNSPECIFIED"?m=500:P==="NO_CHANGE"?m=304:(P==="NO_TEMPLATE"||P==="EMPTY_CONFIG")&&(w={}),m!==304&&m!==200)throw Nn.create("fetch-status",{httpStatus:m});return{status:m,eTag:v,config:w}})}};function KY(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(Nn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function YY(n){if(!(n instanceof Gn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var pb=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return y(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(i,o){return y(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:r}){yield KY(e.signal,t);try{let s=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),s}catch(s){if(!YY(s))throw s;let a={throttleEndTimeMillis:Date.now()+va(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(a),this.attemptFetch(e,a)}})}};var QY=60*1e3,ZY=12*60*60*1e3,mb=class{get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}constructor(e,t,r,i,o){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:QY,minimumFetchIntervalMillis:ZY},this.defaultConfig={}}};function Sg(n,e){let t=n.target.error||void 0;return Nn.create(e,{originalErrorMessage:t&&t?.message})}var Bo="app_namespace_store",JY="firebase_remote_config",XY=1;function eQ(){return new Promise((n,e)=>{try{let t=indexedDB.open(JY,XY);t.onerror=r=>{e(Sg(r,"storage-open"))},t.onsuccess=r=>{n(r.target.result)},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Bo,{keyPath:"compositeKey"})}}}catch(t){e(Nn.create("storage-open",{originalErrorMessage:t?.message}))}})}var gb=class{constructor(e,t,r,i=eQ()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}getCustomSignals(){return this.get("custom_signals")}setCustomSignals(e){return y(this,null,function*(){let r=(yield this.openDbPromise).transaction([Bo],"readwrite"),i=yield this.getWithTransaction("custom_signals",r),o=Object.assign(Object.assign({},i),e),s=Object.fromEntries(Object.entries(o).filter(([a,c])=>c!==null).map(([a,c])=>typeof c=="number"?[a,c.toString()]:[a,c]));if(Object.keys(s).length>tL)throw Nn.create("custom-signal-max-allowed-signals",{maxSignals:tL});return yield this.setWithTransaction("custom_signals",s,r),s})}getWithTransaction(e,t){return y(this,null,function*(){return new Promise((r,i)=>{let o=t.objectStore(Bo),s=this.createCompositeKey(e);try{let a=o.get(s);a.onerror=c=>{i(Sg(c,"storage-get"))},a.onsuccess=c=>{let u=c.target.result;r(u?u.value:void 0)}}catch(a){i(Nn.create("storage-get",{originalErrorMessage:a?.message}))}})})}setWithTransaction(e,t,r){return y(this,null,function*(){return new Promise((i,o)=>{let s=r.objectStore(Bo),a=this.createCompositeKey(e);try{let c=s.put({compositeKey:a,value:t});c.onerror=u=>{o(Sg(u,"storage-set"))},c.onsuccess=()=>{i()}}catch(c){o(Nn.create("storage-set",{originalErrorMessage:c?.message}))}})})}get(e){return y(this,null,function*(){let r=(yield this.openDbPromise).transaction([Bo],"readonly");return this.getWithTransaction(e,r)})}set(e,t){return y(this,null,function*(){let i=(yield this.openDbPromise).transaction([Bo],"readwrite");return this.setWithTransaction(e,t,i)})}delete(e){return y(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let s=t.transaction([Bo],"readwrite").objectStore(Bo),a=this.createCompositeKey(e);try{let c=s.delete(a);c.onerror=u=>{i(Sg(u,"storage-delete"))},c.onsuccess=()=>{r()}}catch(c){i(Nn.create("storage-delete",{originalErrorMessage:c?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};var vb=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}getCustomSignals(){return this.customSignals}loadFromStorage(){return y(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=this.storage.getCustomSignals(),o=yield e;o&&(this.lastFetchStatus=o);let s=yield t;s&&(this.lastSuccessfulFetchTimestampMillis=s);let a=yield r;a&&(this.activeConfig=a);let c=yield i;c&&(this.customSignals=c)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}setCustomSignals(e){return y(this,null,function*(){this.customSignals=yield this.storage.setCustomSignals(e)})}};function tQ(){It(new Et(nL,n,"PUBLIC").setMultipleInstances(!0)),te(db,eL),te(db,eL,"esm2017");function n(e,{instanceIdentifier:t}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Nn.create("registration-window");if(!zr())throw Nn.create("indexed-db-unavailable");let{projectId:o,apiKey:s,appId:a}=r.options;if(!o)throw Nn.create("registration-project-id");if(!s)throw Nn.create("registration-api-key");if(!a)throw Nn.create("registration-app-id");t=t||"firebase";let c=new gb(a,r.name,t),u=new vb(c),d=new ir(db);d.logLevel=en.ERROR;let f=new fb(i,Pn,t,o,s,a),m=new pb(f,c),v=new hb(m,c,u,d),w=new mb(r,v,u,c,d);return iL(w),w}}tQ();var $d=class{constructor(e){return e}},oL="remote-config",yb=class{constructor(){return Ft(oL)}};var _b=new W("angularfire2.remote-config-instances");function nQ(n,e,t){if(Ai(t))return null;let r=Wt(oL,n,e);return r&&new $d(r)}function rQ(n){return(e,t,r)=>{if(Ai(r))return null;let i=e.runOutsideAngular(()=>n(t));return new $d(i)}}var iQ={provide:yb,deps:[[new Ie,_b]]},oQ={provide:$d,useFactory:nQ,deps:[[new Ie,_b],mt,Pt]};function sL(n,...e){return te("angularfire",dt.full,"rc"),ut([oQ,iQ,{provide:_b,useFactory:rQ(n),multi:!0,deps:[me,Se,Pt,bt,xt,...e]}])}var aL=He(rL,!0);var cL={firebaseConfig:{apiKey:"AIzaSyCaMopW6HWBwUEvvtDZUQ7UemvGdT7xGEA",authDomain:"dash-boar-7ee0d.firebaseapp.com",projectId:"dash-boar-7ee0d",storageBucket:"dash-boar-7ee0d.firebasestorage.app",messagingSenderId:"325394396819",appId:"1:325394396819:web:82c3741552a46bb149bf66",measurementId:"G-LXRMSZ5ZSH"},production:!0};var lL={providers:[Rx({eventCoalescing:!0}),BN($N),WN(()=>zN(cL.firebaseConfig)),YM(()=>ZM()),vP(()=>pP()),gP,hI,_O(()=>wO()),hF(()=>fF()),wF(()=>EF()),FF(()=>LF()),UF(()=>jF()),JF(()=>XF()),sL(()=>aL())]};var Wn=class n{destroyRef=S(Ii);firestore=S(Ys);destroyed=new st;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed.next(),this.destroyed.complete()})}generateNextId(){return y(this,null,function*(){let e=yield S0(this.collectionRef),t=0;return e.forEach(r=>{let i=r.data(),o=parseInt(i.id,10);!isNaN(o)&&o>t&&(t=o)}),(t+1).toString()})}createData(e,t){let r=D0(this.collectionRef,e);return A0(r,t)}updateData(e,t){return A0(D0(this.collectionRef,e),t,{merge:!0})}getDataById(e){return y(this,null,function*(){let t=EO(this.collectionRef,IO("id","==",e)),r=yield S0(t);if(!r.empty)return r.docs[0].data()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ye=class n extends Wn{collectionPath="/race-configs";collectionRef=vr(this.firestore,this.collectionPath);activeRaceConfig=J(void 0);constructor(){super(),this.getAll().pipe(Xe()).subscribe(e=>{e.length>0&&this.activeRaceConfig.set(e.at(0))})}updateFuelDurationMinute(e){let t=this.activeRaceConfig();return t?(t.fuelDurationMinute=e,this.updateData(t.id,t)):Promise.resolve()}updateStartRaceDriverId(e){let t=this.activeRaceConfig();return t?(t.startRaceDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitDriverId(e){let t=this.activeRaceConfig();return t?(t.nextPitDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitRefueling(e){let t=this.activeRaceConfig();return t?(t.nextPitRefueling=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitTyreChange(e){let t=this.activeRaceConfig();return t?(t.nextPitTyreChange=e,this.updateData(t.id,t)):Promise.resolve()}updateReferenceLapTime(e){let t=this.activeRaceConfig();return t?(t.referenceLapTimeMillisecond=e,this.updateData(t.id,t)):Promise.resolve()}getAll(){return gr(this.collectionRef).pipe(Gt(this.destroyed),ee(e=>e.map(t=>t).filter(t=>!t.deleted)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var sQ=Math.pow(10,8)*24*60*60*1e3,Sme=-sQ,Ag=6048e5,uL=864e5,tl=6e4,nl=36e5,dL=1e3;var aQ=3600;var hL=aQ*24,Ame=hL*7,cQ=hL*365.2425,lQ=cQ/12,Rme=lQ*3,wb=Symbol.for("constructDateFrom");function yt(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&wb in n?n[wb](e):n instanceof Date?new n.constructor(e):new Date(e)}function oe(n,e){return yt(e||n,n)}function fL(n,e,t){let r=oe(n,t?.in);return isNaN(e)?yt(t?.in||n,NaN):(e&&r.setDate(r.getDate()+e),r)}function pL(n,e,t){let r=oe(n,t?.in);if(isNaN(e))return yt(t?.in||n,NaN);if(!e)return r;let i=r.getDate(),o=yt(t?.in||n,r.getTime());o.setMonth(r.getMonth()+e+1,0);let s=o.getDate();return i>=s?o:(r.setFullYear(o.getFullYear(),o.getMonth(),i),r)}function rl(n,e,t){let{years:r=0,months:i=0,weeks:o=0,days:s=0,hours:a=0,minutes:c=0,seconds:u=0}=e,d=oe(n,t?.in),f=i||r?pL(d,i+r*12):d,m=s||o?fL(f,s+o*7):f,v=c+a*60,P=(u+v*60)*1e3;return yt(t?.in||n,+m+P)}function nr(n,e,t){return yt(t?.in||n,+oe(n)+e)}function $o(n,e,t){return nr(n,e*nl,t)}var uQ={};function Ho(){return uQ}function zi(n,e){let t=Ho(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=oe(n,e?.in),o=i.getDay(),s=(o<r?7:0)+o-r;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function ra(n,e){return zi(n,fe(U({},e),{weekStartsOn:1}))}function Rg(n,e){let t=oe(n,e?.in),r=t.getFullYear(),i=yt(t,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);let o=ra(i),s=yt(t,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);let a=ra(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function Eb(n){let e=oe(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function yn(n,...e){let t=yt.bind(null,n||e.find(r=>typeof r=="object"));return e.map(t)}function Ib(n,e){let t=oe(n,e?.in);return t.setHours(0,0,0,0),t}function xg(n,e,t){let[r,i]=yn(t?.in,n,e),o=Ib(r),s=Ib(i),a=+o-Eb(o),c=+s-Eb(s);return Math.round((a-c)/uL)}function mL(n,e){let t=Rg(n,e),r=yt(e?.in||n,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ra(r)}function ia(n,e,t){let r=oe(n,t?.in);return r.setTime(r.getTime()+e*tl),r}function oa(n,e,t){return nr(n,e*1e3,t)}function sa(n,e){let t=+oe(n)-+oe(e);return t<0?-1:t>0?1:t}function gL(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function vL(n){return!(!gL(n)&&typeof n!="number"||isNaN(+oe(n)))}function yL(n,e,t){let[r,i]=yn(t?.in,n,e),o=r.getFullYear()-i.getFullYear(),s=r.getMonth()-i.getMonth();return o*12+s}function _L(n,e,t){let[r,i]=yn(t?.in,n,e);return r.getFullYear()-i.getFullYear()}function EL(n,e,t){let[r,i]=yn(t?.in,n,e),o=wL(r,i),s=Math.abs(xg(r,i));r.setDate(r.getDate()-o*s);let a=+(wL(r,i)===-o),c=o*(s-a);return c===0?0:c}function wL(n,e){let t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function il(n){return e=>{let r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function IL(n,e,t){let[r,i]=yn(t?.in,n,e),o=(+r-+i)/nl;return il(t?.roundingMethod)(o)}function Gi(n,e){return+oe(n)-+oe(e)}function Ng(n,e,t){let r=Gi(n,e)/tl;return il(t?.roundingMethod)(r)}function TL(n,e){let t=oe(n,e?.in);return t.setHours(23,59,59,999),t}function CL(n,e){let t=oe(n,e?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function bL(n,e){let t=oe(n,e?.in);return+TL(t,e)==+CL(t,e)}function DL(n,e,t){let[r,i,o]=yn(t?.in,n,n,e),s=sa(i,o),a=Math.abs(yL(i,o));if(a<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-s*a);let c=sa(i,o)===-s;bL(r)&&a===1&&sa(r,o)===1&&(c=!1);let u=s*(a-+c);return u===0?0:u}function SL(n,e,t){let r=Gi(n,e)/1e3;return il(t?.roundingMethod)(r)}function AL(n,e,t){let[r,i]=yn(t?.in,n,e),o=sa(r,i),s=Math.abs(_L(r,i));r.setFullYear(1584),i.setFullYear(1584);let a=sa(r,i)===-o,c=o*(s-+a);return c===0?0:c}function RL(n,e){let[t,r]=yn(n,e.start,e.end);return{start:t,end:r}}function xL(n,e){let t=oe(n,e?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}var dQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},NL=(n,e,t)=>{let r,i=dQ[n];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Mg(n){return(e={})=>{let t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}var hQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ML={date:Mg({formats:hQ,defaultWidth:"full"}),time:Mg({formats:fQ,defaultWidth:"full"}),dateTime:Mg({formats:pQ,defaultWidth:"full"})};var mQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},PL=(n,e,t,r)=>mQ[n];function ol(n){return(e,t)=>{let r=t?.context?String(t.context):"standalone",i;if(r==="formatting"&&n.formattingValues){let s=n.defaultFormattingWidth||n.defaultWidth,a=t?.width?String(t.width):s;i=n.formattingValues[a]||n.formattingValues[s]}else{let s=n.defaultWidth,a=t?.width?String(t.width):n.defaultWidth;i=n.values[a]||n.values[s]}let o=n.argumentCallback?n.argumentCallback(e):e;return i[o]}}var gQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},vQ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},yQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_Q={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},EQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},IQ=(n,e)=>{let t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},kL={ordinalNumber:IQ,era:ol({values:gQ,defaultWidth:"wide"}),quarter:ol({values:vQ,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ol({values:yQ,defaultWidth:"wide"}),day:ol({values:_Q,defaultWidth:"wide"}),dayPeriod:ol({values:wQ,defaultWidth:"wide",formattingValues:EQ,defaultFormattingWidth:"wide"})};function sl(n){return(e,t={})=>{let r=t.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],o=e.match(i);if(!o)return null;let s=o[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?CQ(a,f=>f.test(s)):TQ(a,f=>f.test(s)),u;u=n.valueCallback?n.valueCallback(c):c,u=t.valueCallback?t.valueCallback(u):u;let d=e.slice(s.length);return{value:u,rest:d}}}function TQ(n,e){for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function CQ(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function OL(n){return(e,t={})=>{let r=e.match(n.matchPattern);if(!r)return null;let i=r[0],o=e.match(n.parsePattern);if(!o)return null;let s=n.valueCallback?n.valueCallback(o[0]):o[0];s=t.valueCallback?t.valueCallback(s):s;let a=e.slice(i.length);return{value:s,rest:a}}}var bQ=/^(\d+)(th|st|nd|rd)?/i,DQ=/\d+/i,SQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AQ={any:[/^b/i,/^(a|c)/i]},RQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xQ={any:[/1/i,/2/i,/3/i,/4/i]},NQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},MQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},PQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},OQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},FQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},FL={ordinalNumber:OL({matchPattern:bQ,parsePattern:DQ,valueCallback:n=>parseInt(n,10)}),era:sl({matchPatterns:SQ,defaultMatchWidth:"wide",parsePatterns:AQ,defaultParseWidth:"any"}),quarter:sl({matchPatterns:RQ,defaultMatchWidth:"wide",parsePatterns:xQ,defaultParseWidth:"any",valueCallback:n=>n+1}),month:sl({matchPatterns:NQ,defaultMatchWidth:"wide",parsePatterns:MQ,defaultParseWidth:"any"}),day:sl({matchPatterns:PQ,defaultMatchWidth:"wide",parsePatterns:kQ,defaultParseWidth:"any"}),dayPeriod:sl({matchPatterns:OQ,defaultMatchWidth:"any",parsePatterns:FQ,defaultParseWidth:"any"})};var Tb={code:"en-US",formatDistance:NL,formatLong:ML,formatRelative:PL,localize:kL,match:FL,options:{weekStartsOn:0,firstWeekContainsDate:1}};function LL(n,e){let t=oe(n,e?.in);return xg(t,xL(t))+1}function VL(n,e){let t=oe(n,e?.in),r=+ra(t)-+mL(t);return Math.round(r/Ag)+1}function Pg(n,e){let t=oe(n,e?.in),r=t.getFullYear(),i=Ho(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=yt(e?.in||n,0);s.setFullYear(r+1,0,o),s.setHours(0,0,0,0);let a=zi(s,e),c=yt(e?.in||n,0);c.setFullYear(r,0,o),c.setHours(0,0,0,0);let u=zi(c,e);return+t>=+a?r+1:+t>=+u?r:r-1}function UL(n,e){let t=Ho(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=Pg(n,e),o=yt(e?.in||n,0);return o.setFullYear(i,0,r),o.setHours(0,0,0,0),zi(o,e)}function jL(n,e){let t=oe(n,e?.in),r=+zi(t,e)-+UL(t,e);return Math.round(r/Ag)+1}function We(n,e){let t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}var Ki={y(n,e){let t=n.getFullYear(),r=t>0?t:1-t;return We(e==="yy"?r%100:r,e.length)},M(n,e){let t=n.getMonth();return e==="M"?String(t+1):We(t+1,2)},d(n,e){return We(n.getDate(),e.length)},a(n,e){let t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return We(n.getHours()%12||12,e.length)},H(n,e){return We(n.getHours(),e.length)},m(n,e){return We(n.getMinutes(),e.length)},s(n,e){return We(n.getSeconds(),e.length)},S(n,e){let t=e.length,r=n.getMilliseconds(),i=Math.trunc(r*Math.pow(10,t-3));return We(i,e.length)}};var al={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Cb={G:function(n,e,t){let r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){let r=n.getFullYear(),i=r>0?r:1-r;return t.ordinalNumber(i,{unit:"year"})}return Ki.y(n,e)},Y:function(n,e,t,r){let i=Pg(n,r),o=i>0?i:1-i;if(e==="YY"){let s=o%100;return We(s,2)}return e==="Yo"?t.ordinalNumber(o,{unit:"year"}):We(o,e.length)},R:function(n,e){let t=Rg(n);return We(t,e.length)},u:function(n,e){let t=n.getFullYear();return We(t,e.length)},Q:function(n,e,t){let r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return We(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){let r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return We(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){let r=n.getMonth();switch(e){case"M":case"MM":return Ki.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){let r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return We(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){let i=jL(n,r);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):We(i,e.length)},I:function(n,e,t){let r=VL(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):We(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Ki.d(n,e)},D:function(n,e,t){let r=LL(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):We(r,e.length)},E:function(n,e,t){let r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){let i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return We(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){let i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return We(o,e.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){let r=n.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return We(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){let i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){let r=n.getHours(),i;switch(r===12?i=al.noon:r===0?i=al.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){let r=n.getHours(),i;switch(r>=17?i=al.evening:r>=12?i=al.afternoon:r>=4?i=al.morning:i=al.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Ki.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Ki.H(n,e)},K:function(n,e,t){let r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):We(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):We(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Ki.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Ki.s(n,e)},S:function(n,e){return Ki.S(n,e)},X:function(n,e,t){let r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return $L(r);case"XXXX":case"XX":return aa(r);case"XXXXX":case"XXX":default:return aa(r,":")}},x:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"x":return $L(r);case"xxxx":case"xx":return aa(r);case"xxxxx":case"xxx":default:return aa(r,":")}},O:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+BL(r,":");case"OOOO":default:return"GMT"+aa(r,":")}},z:function(n,e,t){let r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+BL(r,":");case"zzzz":default:return"GMT"+aa(r,":")}},t:function(n,e,t){let r=Math.trunc(+n/1e3);return We(r,e.length)},T:function(n,e,t){return We(+n,e.length)}};function BL(n,e=""){let t=n>0?"-":"+",r=Math.abs(n),i=Math.trunc(r/60),o=r%60;return o===0?t+String(i):t+String(i)+e+We(o,2)}function $L(n,e){return n%60===0?(n>0?"-":"+")+We(Math.abs(n)/60,2):aa(n,e)}function aa(n,e=""){let t=n>0?"-":"+",r=Math.abs(n),i=We(Math.trunc(r/60),2),o=We(r%60,2);return t+i+e+o}var HL=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},qL=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},LQ=(n,e)=>{let t=n.match(/(P+)(p+)?/)||[],r=t[1],i=t[2];if(!i)return HL(n,e);let o;switch(r){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",HL(r,e)).replace("{{time}}",qL(i,e))},WL={p:qL,P:LQ};var VQ=/^D+$/,UQ=/^Y+$/,jQ=["D","DD","YY","YYYY"];function zL(n){return VQ.test(n)}function GL(n){return UQ.test(n)}function KL(n,e,t){let r=BQ(n,e,t);if(console.warn(r),jQ.includes(n))throw new RangeError(r)}function BQ(n,e,t){let r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var $Q=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,HQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qQ=/^'([^]*?)'?$/,WQ=/''/g,zQ=/[a-zA-Z]/;function Hr(n,e,t){let r=Ho(),i=t?.locale??r.locale??Tb,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=oe(n,t?.in);if(!vL(a))throw new RangeError("Invalid time value");let c=e.match(HQ).map(d=>{let f=d[0];if(f==="p"||f==="P"){let m=WL[f];return m(d,i.formatLong)}return d}).join("").match($Q).map(d=>{if(d==="''")return{isToken:!1,value:"'"};let f=d[0];if(f==="'")return{isToken:!1,value:GQ(d)};if(Cb[f])return{isToken:!0,value:d};if(f.match(zQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:d}});i.localize.preprocessor&&(c=i.localize.preprocessor(a,c));let u={firstWeekContainsDate:o,weekStartsOn:s,locale:i};return c.map(d=>{if(!d.isToken)return d.value;let f=d.value;(!t?.useAdditionalWeekYearTokens&&GL(f)||!t?.useAdditionalDayOfYearTokens&&zL(f))&&KL(f,e,String(n));let m=Cb[f[0]];return m(a,f,i.localize,u)}).join("")}function GQ(n){let e=n.match(qQ);return e?e[1].replace(WQ,"'"):n}function bb(n){return Math.trunc(n*nl)}function Db(n,e){let{start:t,end:r}=RL(e?.in,n),i={},o=AL(r,t);o&&(i.years=o);let s=rl(t,{years:i.years}),a=DL(r,s);a&&(i.months=a);let c=rl(s,{months:i.months}),u=EL(r,c);u&&(i.days=u);let d=rl(c,{days:i.days}),f=IL(r,d);f&&(i.hours=f);let m=rl(d,{hours:i.hours}),v=Ng(r,m);v&&(i.minutes=v);let w=rl(m,{minutes:i.minutes}),P=SL(r,w);return P&&(i.seconds=P),i}function YL(n,e){return+oe(n)>+oe(e)}function QL(n,e){return+oe(n)<+oe(e)}function kg(n){return Math.trunc(n*tl)}function Hd(n){return n*dL}function ZL(n,e,t){return ia(n,-e,t)}var jt=class n extends Wn{collectionPath="/races";collectionRef=vr(this.firestore,this.collectionPath);raceConfigService=S(Ye);activeRace=J(void 0);endRaceDate=J(void 0);constructor(){super(),qe({races:this.getAll(),raceConfig:he(this.raceConfigService.activeRaceConfig)}).pipe(Xe(),ee(({races:e,raceConfig:t})=>{if(e&&t){let r=this.getActiveRace(e,t),i=r?$o(r.start.toDate(),t.durationHour):void 0;return{activeRace:r,endRaceDate:i}}return{activeRace:void 0,endRaceDate:void 0}})).subscribe(e=>{this.activeRace.set(e.activeRace),this.endRaceDate.set(e.endRaceDate)})}create(e){return y(this,null,function*(){return this.activeRace()!==void 0?(console.warn("Race already active -> "+this.activeRace()),Promise.resolve()):(e.id=yield this.generateNextId(),yield this.createData(e.id,e),e)})}getAll(){return gr(this.collectionRef).pipe(Gt(this.destroyed),ee(e=>e.map(t=>t).filter(t=>!t.deleted)))}getActiveRace(e,t){let r=new Date,i=e.sort((o,s)=>s.start.toDate().getTime()-o.start.toDate().getTime());for(let o of i)if($o(o.start.toDate(),t.durationHour)>=r)return o}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function qr(n,e){if(!n||!e)return"--:--:--";let t=Db({end:e,start:n});return Og(t)}function ca(n){if(!n)return"--:--:--";let e=Db({end:n,start:new Date});return Og(e)}function _t(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={hours:Math.floor(e/3600),minutes:Math.floor(e%3600/60),seconds:e%60};return Og(t)}function JL(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={minutes:Math.floor(e%3600/60),seconds:e%60};return Og(t)}function XL(n){if(!n||n<0)return"--:--:---";let e=Math.floor(n/1e3),t=n%1e3,r={minutes:Math.floor(e/60),seconds:e%60};return KQ(r,t)}function KQ(n,e){return n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:---":[qd(n.minutes),qd(n.seconds),YQ(e)].join(":")}function Og(n){return n.hours&&n.hours<0||n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:--":[qd(n.hours),qd(n.minutes),qd(n.seconds)].join(":")}function qd(n){return n?n<10?`0${n}`:`${n}`:"00"}function YQ(n){return n<10?`00${n}`:n<100?`0${n}`:`${n}`}var Jt=class n extends Wn{collectionPath="/pits";collectionRef=vr(this.firestore,this.collectionPath);raceService=S(jt);raceConfigService=S(Ye);activePit=J(void 0);activePitRemainingMilliseconds=J(0);lastRefuelPit=J(void 0);pits=J([]);completedDriverChanges=J(0);lastPit=J(void 0);remainingDriverChanges=J(0);constructor(){super(),qe({pits:this.getRacePits(),activeRaceConfig:he(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({pits:e,activeRaceConfig:t})=>{this.pits.set(e),this.activePit.set(this.getActivePit(e)),this.activePitRemainingMilliseconds.set(this.calculateActivePitRemainingMilliseconds(e,t)),this.lastRefuelPit.set(this.getLastRefuelPit(e)),this.lastPit.set(this.getLastPit(e)),this.completedDriverChanges.set(this.calculateCompletedDriverChanges(e)),this.remainingDriverChanges.set(this.calculateRemainingDriverChanges(e,t))})}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return this.updateData(e.id,e)}getRacePits(){return qe({pits:gr(this.collectionRef),activeRace:he(this.raceService.activeRace)}).pipe(Gt(this.destroyed),ee(({pits:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()):[]))}getActivePit(e){for(let t of e)if(!t.exitTime)return t}calculateActivePitRemainingMilliseconds(e,t){if(!t)return 0;let r=this.getActivePit(e);if(r){let i=new Date().getTime();return oa(r.entryTime.toDate(),t.minPitSeconds).getTime()-i}return 0}getLastRefuelPit(e){return e.filter(r=>r.refuel&&r.exitTime).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()).at(0)}getLastPit(e){return e.length===0?void 0:e.sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()).at(0)}calculateCompletedDriverChanges(e){return e.reduce((t,r)=>t+(r.entryDriverId!==r.exitDriverId?1:0),0)}calculateRemainingDriverChanges(e,t){return t?Math.max(0,t.minDriverChange-this.calculateCompletedDriverChanges(e)):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var qo=class n{raceService=S(jt);raceConfigService=S(Ye);pitService=S(Jt);openingTime=J(void 0);closingTime=J(void 0);tyreChangeWindowOpen=J(!1);remainingTyreChange=J(0);constructor(){qe({pits:he(this.pitService.pits),activeRace:he(this.raceService.activeRace),raceConfig:he(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({pits:e,activeRace:t,raceConfig:r})=>{t&&r?(this.openingTime.set($o(t.start.toDate(),r.startTyreChangeWindowHour)),this.closingTime.set($o(t.start.toDate(),r.endTyreChangeWindowHour)),this.tyreChangeWindowOpen.set(this.isTyreChangeWindowOpen(this.openingTime(),this.closingTime()))):(this.openingTime.set(void 0),this.closingTime.set(void 0),this.tyreChangeWindowOpen.set(!1)),r&&this.remainingTyreChange.set(this.calculateRemainingTyreChange(e,r.minTyreChange))})}isTyreChangeWindowOpen(e,t){if(e&&t){let r=new Date;return r>=e&&r<=t}return!1}calculateRemainingTyreChange(e,t){let r=e.filter(i=>i.tyreChange&&i.exitTime).length;return t-r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var ui=class n{raceService=S(jt);pitService=S(Jt);raceConfigService=S(Ye);tyreService=S(qo);optimizedStint=J(void 0);constructor(){qe({activeRace:he(this.raceService.activeRace),endRaceDate:he(this.raceService.endRaceDate),activeRaceConfig:he(this.raceConfigService.activeRaceConfig),remainingDriverChanges:he(this.pitService.remainingDriverChanges),remainingTyreChange:he(this.tyreService.remainingTyreChange),lastPit:he(this.pitService.lastPit),ping:At(1e3)}).pipe(Xe()).subscribe(({activeRace:e,endRaceDate:t,activeRaceConfig:r,remainingDriverChanges:i,remainingTyreChange:o,lastPit:s})=>{r?this.optimizedStint.set(this.calculateOptimizedStint(e?e.start.toDate():new Date,t||$o(new Date,r.durationHour),r,i,o,s)):this.optimizedStint.set(void 0)})}calculateOptimizedStint(e,t,r,i,o,s){let a=new Date;if(a>=t)return;let c=this.calculateRemainingPitTime(r,i,o),u=Gi(t,a)-c,d;s&&(s.exitTime?d=s.exitTime.toDate():d=oa(s.entryTime.toDate(),r.minPitSeconds));let v=(Gi(t,d||e)-c)/(i+1),w=u/i;return{avgStintMillisecondsTime:v,laps:Math.floor(v/r.referenceLapTimeMillisecond),avgStintMillisecondsIfDriverChangedNow:w,lapsIfDriverChangeNow:Math.floor(w/r.referenceLapTimeMillisecond)}}calculateRemainingPitTime(e,t,r){let i=t-r,o=Hd(e.minPitSeconds*i),s=Hd(e.minPitWithTyreChangeSeconds*r);return o+s}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Bt=class n extends Wn{collectionPath="/stints";collectionRef=vr(this.firestore,this.collectionPath);raceService=S(jt);raceConfigService=S(Ye);stintOptimizerService=S(ui);activeRace=this.raceService.activeRace;stints=J([]);activeStint=J(void 0);activeStintTimeOnTrack=J(0);activeStintLaps=J(0);activeStintRemainingTimeOnTrack=J(0);activeStintRemainingLaps=J(0);activeStintGainedTimeOnTrack=J(0);activeStintGainedLaps=J(0);constructor(){super(),qe({stints:this.getRaceStints(),activeRaceConfig:he(this.raceConfigService.activeRaceConfig),optimizedStint:he(this.stintOptimizerService.optimizedStint),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e,activeRaceConfig:t,optimizedStint:r})=>{this.stints.set(e),this.activeStint.set(this.getActiveStint(e)),this.activeStintTimeOnTrack.set(this.calculateActiveStintTimeOnTrack(this.activeStint())),this.activeStintLaps.set(this.calculateActiveStintLaps(this.activeStintTimeOnTrack(),t)),this.activeStintRemainingTimeOnTrack.set(this.calculateActiveStintRemainingTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintRemainingLaps.set(this.calculateActiveStintRemainingLaps(this.activeStintLaps(),r)),this.activeStintGainedTimeOnTrack.set(this.calculateActiveStintGainedTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintGainedLaps.set(this.calculateActiveStintGainedLaps(this.activeStintLaps(),r))})}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return y(this,null,function*(){return yield this.updateData(e.id,e),e})}getRaceStints(){return qe({stints:gr(this.collectionRef),activeRace:he(this.activeRace)}).pipe(Gt(this.destroyed),ee(({stints:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.startDate.toDate().getTime()-r.startDate.toDate().getTime()):[]))}getActiveStint(e){for(let t of e)if(!t.endDate)return t}calculateActiveStintTimeOnTrack(e){return e?new Date().getTime()-e.startDate.toDate().getTime():0}calculateActiveStintLaps(e,t){return e>=0&&t?Math.floor(e/t.referenceLapTimeMillisecond):0}calculateActiveStintRemainingTimeOnTrack(e,t){return e>=0&&t?t.avgStintMillisecondsTime-e:0}calculateActiveStintRemainingLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r>0?r:0}calculateActiveStintGainedTimeOnTrack(e,t){let r=0;return e>=0&&t&&(r=t.avgStintMillisecondsTime-e),r<0?Math.abs(r):0}calculateActiveStintGainedLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r<0?Math.abs(r):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var cl=class n{raceService=S(jt);stintService=S(Bt);pitService=S(Jt);stintOptimizerService=S(ui);activeRace=this.raceService.activeRace;activeStint=this.stintService.activeStint;activePit=this.pitService.activePit;optimizedStintMilliseconds=Re(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.avgStintMillisecondsTime:0});startRace(e){return y(this,null,function*(){let t=this.createRace(),r=yield this.raceService.create(t);r&&(yield this.startStint(r.id,e,r.start))})}pitIn(e,t,r){return y(this,null,function*(){let i=this.activeRace(),o=this.activeStint();if(i&&o){let s=this.createPit(o.driverId,e,i.id,t,r),a=yield this.pitService.create(s);yield this.closeActiveStint(a.entryTime)}})}pitOut(){return y(this,null,function*(){let e=this.activeRace(),t=this.activePit();if(e&&t){let r=Nt.now();yield this.closeActivePit(r),yield this.startStint(e.id,t.exitDriverId,r)}})}startStint(e,t,r){return y(this,null,function*(){let i=this.createStint(e,t,r);return yield this.stintService.create(i),i})}closeActiveStint(e){return y(this,null,function*(){let t=this.activeStint();t&&(t.endDate=e,yield this.stintService.update(t))})}closeActivePit(e){return y(this,null,function*(){let t=this.activePit();t&&(t.exitTime=e,yield this.pitService.update(t))})}createRace(){return{id:"1",start:Nt.now(),deleted:!1}}createStint(e,t,r){return{id:"1",deleted:!1,driverId:t,endDate:null,optimumMilliseconds:this.optimizedStintMilliseconds(),raceId:e,startDate:r}}createPit(e,t,r,i,o){return{id:"1",entryDriverId:e,entryTime:Nt.now(),exitDriverId:t,exitTime:null,raceId:r,refuel:i,tyreChange:o,deleted:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var lV=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Me(Ci),Me(lr))};static \u0275dir=at({type:n})}return n})(),Zd=(()=>{class n extends lV{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,features:[jn]})}return n})(),fl=new W(""),QQ={provide:fl,useExisting:ar(()=>Rb),multi:!0},Rb=(()=>{class n extends Zd{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[ei([QQ]),jn]})}return n})(),ZQ={provide:fl,useExisting:ar(()=>pl),multi:!0};function JQ(){let n=Si()?Si().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var XQ=new W(""),pl=(()=>{class n extends lV{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!JQ())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Me(Ci),Me(lr),Me(XQ,8))};static \u0275dir=at({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&ce("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[ei([ZQ]),jn]})}return n})();function Sb(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var Hg=new W(""),uV=new W("");function eZ(n){return e=>{if(Sb(e.value)||Sb(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function tZ(n){return Sb(n.value)?{required:!0}:null}function eV(n){return null}function dV(n){return n!=null}function hV(n){return Is(n)?lt(n):n}function fV(n){let e={};return n.forEach(t=>{e=t!=null?U(U({},e),t):e}),Object.keys(e).length===0?null:e}function pV(n,e){return e.map(t=>t(n))}function nZ(n){return!n.validate}function mV(n){return n.map(e=>nZ(e)?e:t=>e.validate(t))}function rZ(n){if(!n)return null;let e=n.filter(dV);return e.length==0?null:function(t){return fV(pV(t,e))}}function xb(n){return n!=null?rZ(mV(n)):null}function iZ(n){if(!n)return null;let e=n.filter(dV);return e.length==0?null:function(t){let r=pV(t,e).map(hV);return hy(r).pipe(ee(fV))}}function Nb(n){return n!=null?iZ(mV(n)):null}function tV(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function oZ(n){return n._rawValidators}function sZ(n){return n._rawAsyncValidators}function Ab(n){return n?Array.isArray(n)?n:[n]:[]}function Lg(n,e){return Array.isArray(n)?n.includes(e):n===e}function nV(n,e){let t=Ab(e);return Ab(n).forEach(i=>{Lg(t,i)||t.push(i)}),t}function rV(n,e){return Ab(e).filter(t=>!Lg(n,t))}var Vg=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=xb(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Nb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},dl=class extends Vg{name;get formDirective(){return null}get path(){return null}},Qd=class extends Vg{_parent=null;name=null;valueAccessor=null},Ug=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},aZ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Fwe=fe(U({},aZ),{"[class.ng-submitted]":"isSubmitted"}),Wo=(()=>{class n extends Ug{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Me(Qd,2))};static \u0275dir=at({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&sp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[jn]})}return n})(),zo=(()=>{class n extends Ug{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Me(dl,10))};static \u0275dir=at({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&sp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[jn]})}return n})();var Wd="VALID",Fg="INVALID",ll="PENDING",zd="DISABLED",hl=class{},jg=class extends hl{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Kd=class extends hl{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Yd=class extends hl{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},ul=class extends hl{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function gV(n){return(qg(n)?n.validators:n)||null}function cZ(n){return Array.isArray(n)?xb(n):n||null}function vV(n,e){return(qg(e)?e.asyncValidators:n)||null}function lZ(n){return Array.isArray(n)?Nb(n):n||null}function qg(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function uZ(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Z(1e3,"");if(!r[t])throw new Z(1001,"")}function dZ(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Z(1002,"")})}var Bg=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return dr(this.statusReactive)}set status(e){dr(()=>this.statusReactive.set(e))}_status=Re(()=>this.statusReactive());statusReactive=J(void 0);get valid(){return this.status===Wd}get invalid(){return this.status===Fg}get pending(){return this.status==ll}get disabled(){return this.status===zd}get enabled(){return this.status!==zd}errors;get pristine(){return dr(this.pristineReactive)}set pristine(e){dr(()=>this.pristineReactive.set(e))}_pristine=Re(()=>this.pristineReactive());pristineReactive=J(!0);get dirty(){return!this.pristine}get touched(){return dr(this.touchedReactive)}set touched(e){dr(()=>this.touchedReactive.set(e))}_touched=Re(()=>this.touchedReactive());touchedReactive=J(!1);get untouched(){return!this.touched}_events=new st;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(nV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(nV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(rV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(rV(e,this._rawAsyncValidators))}hasValidator(e){return Lg(this._rawValidators,e)}hasAsyncValidator(e){return Lg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(fe(U({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Yd(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Yd(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(fe(U({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Kd(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Kd(!0,r))}markAsPending(e={}){this.status=ll;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ul(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(fe(U({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=zd,this.errors=null,this._forEachChild(i=>{i.disable(fe(U({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new jg(this.value,r)),this._events.next(new ul(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(fe(U({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wd,this._forEachChild(r=>{r.enable(fe(U({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(fe(U({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Wd||this.status===ll)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new jg(this.value,t)),this._events.next(new ul(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(fe(U({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zd:Wd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=ll,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=hV(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new ul(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Kt,this.statusChanges=new Kt}_calculateStatus(){return this._allControlsDisabled()?zd:this.errors?Fg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ll)?ll:this._anyControlsHaveStatus(Fg)?Fg:Wd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Kd(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Yd(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){qg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=cZ(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=lZ(this._rawAsyncValidators)}},$g=class extends Bg{constructor(e,t,r){super(gV(t),vV(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){dZ(this,!0,e),Object.keys(e).forEach(r=>{uZ(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Wg=new W("",{providedIn:"root",factory:()=>zg}),zg="always";function hZ(n,e){return[...e.path,n]}function yV(n,e,t=zg){_V(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),pZ(n,e),gZ(n,e),mZ(n,e),fZ(n,e)}function iV(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function fZ(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function _V(n,e){let t=oZ(n);e.validator!==null?n.setValidators(tV(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=sZ(n);e.asyncValidator!==null?n.setAsyncValidators(tV(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();iV(e._rawValidators,i),iV(e._rawAsyncValidators,i)}function pZ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&wV(n,e)})}function mZ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&wV(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function wV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function gZ(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function vZ(n,e){n==null,_V(n,e)}function yZ(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function _Z(n){return Object.getPrototypeOf(n.constructor)===Zd}function wZ(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function EZ(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===pl?t=o:_Z(o)?r=o:i=o}),i||r||t||null}var IZ={provide:dl,useExisting:ar(()=>Yi)},Gd=Promise.resolve(),Yi=(()=>{class n extends dl{callSetDisabledState;get submitted(){return dr(this.submittedReactive)}_submitted=Re(()=>this.submittedReactive());submittedReactive=J(!1);_directives=new Set;form;ngSubmit=new Kt;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new $g({},xb(t),Nb(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Gd.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),yV(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Gd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Gd.then(()=>{let r=this._findContainer(t.path),i=new $g({});vZ(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Gd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Gd.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),wZ(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(Me(Hg,10),Me(uV,10),Me(Wg,8))};static \u0275dir=at({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&ce("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[ei([IZ]),jn]})}return n})();function oV(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function sV(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var TZ=class extends Bg{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(gV(t),vV(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),qg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(sV(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){oV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){oV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){sV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var CZ={provide:Qd,useExisting:ar(()=>Qi)},aV=Promise.resolve(),Qi=(()=>{class n extends Qd{_changeDetectorRef;callSetDisabledState;control=new TZ;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Kt;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=EZ(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),yZ(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){yV(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){aV.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&wu(r);aV.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?hZ(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Me(dl,9),Me(Hg,10),Me(uV,10),Me(fl,10),Me(Ao,8),Me(Wg,8))};static \u0275dir=at({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[ei([CZ]),jn,Eo]})}return n})(),Go=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),bZ={provide:fl,useExisting:ar(()=>Jd),multi:!0},Jd=(()=>{class n extends Zd{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&ce("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[ei([bZ]),jn]})}return n})();var DZ=new W("");var SZ={provide:fl,useExisting:ar(()=>ml),multi:!0};function EV(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function AZ(n){return n.split(":")[0]}var ml=(()=>{class n extends Zd{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=EV(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=AZ(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[ei([SZ]),jn]})}return n})(),Gg=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(EV(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Me(lr),Me(Ci),Me(ml,9))};static \u0275dir=at({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),RZ={provide:fl,useExisting:ar(()=>IV),multi:!0};function cV(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function xZ(n){return n.split(":")[0]}var IV=(()=>{class n extends Zd{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],u=this._getOptionValue(c.value);i.push(u)}}else{let s=r.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let u=this._getOptionValue(c.value);i.push(u)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=xZ(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&ce("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[ei([RZ]),jn]})}return n})(),Kg=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(cV(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(cV(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Me(lr),Me(Ci),Me(IV,9))};static \u0275dir=at({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function NZ(n){return typeof n=="number"?n:parseFloat(n)}var TV=(()=>{class n{_validator=eV;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):eV,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=at({type:n,features:[Eo]})}return n})();var MZ={provide:Hg,useExisting:ar(()=>Xd),multi:!0},Xd=(()=>{class n extends TV{min;inputName="min";normalizeInput=t=>NZ(t);createValidator=t=>eZ(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&_u("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[ei([MZ]),jn]})}return n})(),PZ={provide:Hg,useExisting:ar(()=>eh),multi:!0};var eh=(()=>{class n extends TV{required;inputName="required";normalizeInput=wu;createValidator=t=>tZ;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Ar(n)))(i||n)}})();static \u0275dir=at({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&_u("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[ei([PZ]),jn]})}return n})();var CV=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=bo({type:n});static \u0275inj=wo({})}return n})();var Ko=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Wg,useValue:t.callSetDisabledState??zg}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=bo({type:n});static \u0275inj=wo({imports:[CV]})}return n})(),bV=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:DZ,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Wg,useValue:t.callSetDisabledState??zg}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=bo({type:n});static \u0275inj=wo({imports:[CV]})}return n})();var Qg=class n extends Wn{collectionPath="/laps";collectionRef=vr(this.firestore,this.collectionPath);raceService=S(jt);laps=J([]);constructor(){super(),qe({laps:this.getRaceLaps(),activeRace:he(this.raceService.activeRace)}).pipe(Xe()).subscribe(e=>this.laps.set(e.laps))}getRaceLaps(){return qe({laps:gr(this.collectionRef),activeRace:he(this.raceService.activeRace)}).pipe(Gt(this.destroyed),ee(({laps:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id):[]))}create(e){return y(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var Er=class n extends Wn{collectionPath="/drivers";collectionRef=vr(this.firestore,this.collectionPath);lapService=S(Qg);stintService=S(Bt);raceConfigService=S(Ye);drivers=J([]);driversReferenceLapTimeMap=J(new Map);driversTimeOnTrackMap=J(new Map);driversTimeOnTrackWarningMap=J(new Map);driversStintCountMap=J(new Map);driverWithMoreTimeFromLastStint=J(void 0);driversTimeFromLastStintMap=J(new Map);driversTimeOnTrackWarningCount=Re(()=>{let e=this.driversTimeOnTrackWarningMap(),t=0;return e.forEach(r=>{r&&t++}),t});constructor(){super(),qe({drivers:this.getAll(),laps:he(this.lapService.laps),stints:he(this.stintService.stints),activeRaceConfig:he(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({drivers:e,laps:t,stints:r,activeRaceConfig:i})=>{this.drivers.set(e),this.driversReferenceLapTimeMap.set(this.createDriverReferenceLapTimeMap(t,e)),this.driversTimeOnTrackMap.set(this.createDriverTrackTimeMap(r,e)),this.driversTimeOnTrackWarningMap.set(this.createDriversTimeOnTrackWarningMap(this.driversTimeOnTrackMap(),i)),this.driversStintCountMap.set(this.createDriverStintCountMap(r,e)),this.driverWithMoreTimeFromLastStint.set(this.getDriverWithMoreTimeFromLastStint(r,e)),this.driversTimeFromLastStintMap.set(this.createDriversTimeFromLastStintMap(r,e))})}getAll(){return gr(this.collectionRef).pipe(Gt(this.destroyed),ee(e=>e.map(t=>t).filter(t=>!t.deleted)))}createDriverReferenceLapTimeMap(e,t){let r=new Map;t.forEach(o=>{r.set(o.id,0)});let i=e.reduce((o,s)=>(o[s.driverId]||(o[s.driverId]=[]),o[s.driverId].push(s.millisecondsTime),o),{});for(let o in i){let s=i[o],a=s.reduce((c,u)=>c+u,0)/s.length;r.set(o,a)}return r}createDriverTrackTimeMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{let o;i.endDate?o=i.endDate.toDate().getTime()-i.startDate.toDate().getTime():o=new Date().getTime()-i.startDate.toDate().getTime(),r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+o):r.set(i.driverId,o)}),r}createDriversTimeOnTrackWarningMap(e,t){let r=new Map;if(t){let i=bb(t.minDriverOnTrackHour),o=bb(t.maxDriverOnTrackHour),s=kg(t.warningDriverOnTrackThresholdMinute);e.forEach((a,c)=>{let u=a<i,d=o-a<=s;r.set(c,u||d)})}return r}createDriverStintCountMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+1):r.set(i.driverId,1)}),r}getDriverWithMoreTimeFromLastStint(e,t){if(t.length===0)return;let r,i=this.createDriversTimeFromLastStintMap(e,t),o=e.find(u=>u.endDate===null)?.driverId,s=new Map(t.map(u=>[u.id,u])),a=-1,c=!1;return i.forEach((u,d)=>{d!==o&&(u===0?(!c||c&&u>a)&&(a=u,r=s.get(d),c=!0):!c&&u>a&&(a=u,r=s.get(d)))}),r}createDriversTimeFromLastStintMap(e,t){let r=new Map;return t.forEach(i=>{let o=e.filter(s=>s.driverId===i.id).sort((s,a)=>a.startDate.toDate().getTime()-s.startDate.toDate().getTime()).at(0);o&&o.endDate?r.set(i.id,new Date().getTime()-o.endDate.toDate().getTime()):r.set(i.id,0)}),r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function kZ(n,e){if(n&1&&(T(0,"option",7),R(1),C()),n&2){let t=e.$implicit;Q("value",t.id),k(),z(" ",t.raceName," ")}}function OZ(n,e){if(n&1){let t=bi();T(0,"div",0)(1,"div",2)(2,"form")(3,"label",3),R(4,"Start driver"),C(),T(5,"select",4),xr("ngModelChange",function(i){ft(t);let o=H();return Xr(o.selectedDriver,i)||(o.selectedDriver=i),pt(i)}),ce("change",function(){ft(t);let i=H();return pt(i.updateDriverId())}),X(6,kZ,2,2,"option",5),C()()(),T(7,"button",6),ce("click",function(){ft(t);let i=H();return pt(i.startRace())}),R(8," Start race "),C()()}if(n&2){let t=H();k(5),Rr("ngModel",t.selectedDriver),k(),Q("ngForOf",t.drivers())}}function FZ(n,e){if(n&1&&(T(0,"div",1),R(1),C()),n&2){let t=H();k(),z(" ",t.endRaceCountdown," ")}}var Zg=class n{raceService=S(jt);raceConfigService=S(Ye);raceManagerService=S(cl);driverService=S(Er);drivers=this.driverService.drivers;endRaceDate=this.raceService.endRaceDate;endRaceCountdown="--:--:--";selectedDriver="1";constructor(){qe({endRaceDate:he(this.endRaceDate),ping:At(1e3)}).pipe(Xe()).subscribe(e=>{this.endRaceCountdown=ca(e.endRaceDate)}),Mr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.startRaceDriverId)})}startRace(){this.raceManagerService.startRace(this.selectedDriver)}updateDriverId(){this.raceConfigService.updateStartRaceDriverId(this.selectedDriver)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-race"]],decls:2,vars:1,consts:[[1,"flex","items-center","justify-center"],[1,"text-2xl","md:text-4xl","font-bold","font-mono","dark:text-white"],[1,"font-bold","mr-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded",3,"click"],[3,"value"]],template:function(t,r){t&1&&X(0,OZ,9,2,"div",0)(1,FZ,2,1,"div",1),t&2&&ie(r.endRaceDate()?1:0)},dependencies:[Ko,Go,Gg,Kg,ml,Wo,zo,Qi,Yi,$n],encapsulation:2})};var LZ=n=>({"mb-2":n}),VZ=n=>({"animate-bounce":n});function UZ(n,e){if(n&1&&(T(0,"div",4),R(1),C()),n&2){let t=H();k(),z(" Remaining: ",t.remainingTyreChange()," ")}}function jZ(n,e){n&1&&(T(0,"div",5),R(1," Completed! "),C())}function BZ(n,e){if(n&1&&(T(0,"div",6),R(1," Window open "),C()),n&2){let t=H();Q("ngClass",tt(1,VZ,t.remainingTyreChange()>0))}}function $Z(n,e){n&1&&(T(0,"div",7),R(1," Window closed "),C())}function HZ(n,e){if(n&1&&(R(0),Do(1,"date")),n&2){let t=H(2);z(" ",So(1,1,t.openingTime(),"HH:mm:ss")," ")}}function qZ(n,e){n&1&&R(0," --:--:-- ")}function WZ(n,e){if(n&1&&(R(0),Do(1,"date")),n&2){let t=H(2);z(" ",So(1,1,t.closingTime(),"HH:mm:ss")," ")}}function zZ(n,e){n&1&&R(0," --:--:-- ")}function GZ(n,e){if(n&1&&(T(0,"div",8)(1,"div")(2,"div",9),R(3,"Opening time"),C(),T(4,"div",10),X(5,HZ,2,4)(6,qZ,1,0),C()(),T(7,"div")(8,"div",11),R(9,"Opening in"),C(),T(10,"div",12),R(11),C()()(),_e(12,"hr",13),T(13,"div",14)(14,"div")(15,"div",9),R(16,"Closing time"),C(),T(17,"div",10),X(18,WZ,2,4)(19,zZ,1,0),C()(),T(20,"div")(21,"div",11),R(22,"Closing in"),C(),T(23,"div",12),R(24),C()()()),n&2){let t=H();k(5),ie(t.openingTime()?5:6),k(6),z(" ",t.countdownOpeningTime()," "),k(7),ie(t.closingTime()?18:19),k(6),z(" ",t.countdownClosingTime()," ")}}var Jg=class n{tyreService=S(qo);openingTime=this.tyreService.openingTime;closingTime=this.tyreService.closingTime;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;countdownOpeningTime=Re(()=>ca(this.tyreService.openingTime()));countdownClosingTime=Re(()=>ca(this.tyreService.closingTime()));isOpen=!1;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-tyre-change-window"]],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default",3,"ngClass"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F6DE} \u{1F504} Tyre change"),C(),T(4,"div",3),X(5,UZ,2,1,"div",4)(6,jZ,2,0,"div",5)(7,BZ,2,3,"div",6)(8,$Z,2,0,"div",7),C()(),X(9,GZ,25,4),C()),t&2&&(k(),Q("ngClass",tt(4,LZ,r.isOpen)),k(4),ie(r.remainingTyreChange()>0?5:6),k(2),ie(r.tyreChangeWindowOpen()?7:8),k(2),ie(r.isOpen?9:-1))},dependencies:[ec,rt],encapsulation:2})};var Xg=class n{charge=100;batteryColor="bg-green-500";batteryBorderColor="border-gray-200";ngOnChanges(e){this.batteryColor=this.getBackgroundColor(this.charge),this.batteryBorderColor=this.getBorderColor(this.charge)}getBackgroundColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}getBorderColor(e){return e<=10?"border-red-500":e<=25?"border-orange-500":"border-gray-200"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-battery"]],inputs:{charge:"charge"},features:[Eo],decls:6,vars:6,consts:[[1,"w-16","lg:w-20","h-8","grid","grid-cols-6","items-center"],[1,"shadow","col-span-5","rounded","border-2","flex","relative",3,"ngClass"],[1,"cursor-default","leading-none","rounded-sm","flex","items-center","m-0.5","py-3",3,"ngClass"],[1,"absolute","right-2","text-black","font-semibold","font-mono"],[1,"ml-0.5","border-r-8","w-1","h-4","rounded-r",3,"ngClass"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),R(4),C()()(),_e(5,"div",4),C()),t&2&&(k(),Q("ngClass",r.batteryBorderColor),k(),Xa("width",r.charge,"%"),Q("ngClass",r.batteryColor),k(2),kt(r.charge),k(),Q("ngClass",r.batteryBorderColor))},dependencies:[rt],encapsulation:2,changeDetection:0})};var ev=class n{raceService=S(jt);pitService=S(Jt);raceConfigService=S(Ye);lastRefuelTime=J(void 0);emptyFuelTime=J(void 0);remainingFuelPercentage=J(100);remainingFuelLap=J(0);constructor(){qe({lastRefuelPit:he(this.pitService.lastRefuelPit),activeRace:he(this.raceService.activeRace),raceConfig:he(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({lastRefuelPit:e,activeRace:t,raceConfig:r})=>{this.lastRefuelTime.set(this.getLastRefuelDate(e,t)),this.emptyFuelTime.set(this.calculateEmptyFuelTime(this.lastRefuelTime(),r)),this.remainingFuelLap.set(this.calculateRemainingFuelLaps(this.emptyFuelTime(),r)),this.remainingFuelPercentage.set(this.calculateRemainingFuelPercentage(this.emptyFuelTime(),r))})}getLastRefuelDate(e,t){if(e&&e.exitTime)return e.exitTime.toDate();if(t)return t.start.toDate()}calculateEmptyFuelTime(e,t){if(e&&t)return ia(e,t.fuelDurationMinute)}calculateRemainingFuelPercentage(e,t){if(e&&t){let i=Ng(e,new Date)/t.fuelDurationMinute*100,o=Math.max(0,Math.min(i,100));return parseFloat(o.toFixed(0))}return 100}calculateRemainingFuelLaps(e,t){if(e&&t){let r=Gi(e,new Date);return Math.floor(r/t.referenceLapTimeMillisecond)}if(!e&&t){let r=kg(t.fuelDurationMinute);return Math.floor(r/t.referenceLapTimeMillisecond)}return 0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var KZ=n=>({"mb-2":n}),YZ=n=>({"animate-bounce":n});function QZ(n,e){if(n&1&&(R(0),Do(1,"date")),n&2){let t=H(2);z(" ",So(1,1,t.lastRefuelTime(),"HH:mm:ss")," ")}}function ZZ(n,e){n&1&&R(0," --:--:-- ")}function JZ(n,e){if(n&1&&(R(0),Do(1,"date")),n&2){let t=H(2);z(" ",So(1,1,t.emptyFuelTime(),"HH:mm:ss")," ")}}function XZ(n,e){n&1&&R(0," --:--:-- ")}function eJ(n,e){if(n&1){let t=bi();T(0,"div",7)(1,"div")(2,"div",8),R(3,"Last refuel time"),C(),T(4,"div",9),X(5,QZ,2,4)(6,ZZ,1,0),C()(),T(7,"div")(8,"div",10),R(9,"Since last refuel"),C(),T(10,"div",11),R(11),C()()(),_e(12,"hr",12),T(13,"div",7)(14,"div")(15,"div",8),R(16,"Empty time"),C(),T(17,"div",9),X(18,JZ,2,4)(19,XZ,1,0),C()(),T(20,"div")(21,"div",10),R(22,"Empty in"),C(),T(23,"div",11),R(24),C()()(),_e(25,"hr",12),T(26,"div",13)(27,"div")(28,"div",8),R(29,"Remaining laps"),C(),T(30,"div",9),R(31),C()(),T(32,"div")(33,"div",10),R(34,"Fuel duration (min)"),C(),T(35,"div",14)(36,"button",15),ce("click",function(){ft(t);let i=H();return pt(i.increaseFuelDuration())}),R(37,"+"),C(),T(38,"form",16),ce("ngSubmit",function(){ft(t);let i=H();return pt(i.onSubmit())}),T(39,"input",17),xr("ngModelChange",function(i){ft(t);let o=H();return Xr(o.fuelDurationMinute,i)||(o.fuelDurationMinute=i),pt(i)}),C()(),T(40,"button",18),ce("click",function(){ft(t);let i=H();return pt(i.decreaseFuelDuration())}),R(41,"-"),C()()()()}if(n&2){let t=H();k(5),ie(t.lastRefuelTime()?5:6),k(6),z(" ",t.sinceLastRefuel()," "),k(7),ie(t.emptyFuelTime()?18:19),k(6),z(" ",t.emptyFuelCountdown()," "),k(7),z(" ",t.remainingFuelLap()," "),k(8),Rr("ngModel",t.fuelDurationMinute)}}var tv=class n{raceConfigService=S(Ye);fuelService=S(ev);remainingFuelPercentage=this.fuelService.remainingFuelPercentage;remainingFuelLap=this.fuelService.remainingFuelLap;emptyFuelTime=this.fuelService.emptyFuelTime;lastRefuelTime=this.fuelService.lastRefuelTime;emptyFuelCountdown=Re(()=>ca(this.emptyFuelTime()));sinceLastRefuel=Re(()=>qr(this.lastRefuelTime(),new Date));warning=Re(()=>this.remainingFuelPercentage()<=20);remainingColor=Re(()=>this.getRemainingColor(this.remainingFuelPercentage()));isOpen=!0;fuelDurationMinute=0;constructor(){Mr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.fuelDurationMinute=e.fuelDurationMinute)})}onSubmit(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute)}increaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute+1)}decreaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute-1)}getRemainingColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-fuel"]],decls:11,vars:12,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center",3,"ngClass"],[1,"px-2","py-1","w-36","rounded-lg","text-left","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[1,"px-2","py-1","rounded-lg","text-center","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[3,"charge"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"],[1,"flex","justify-end"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","mr-1","rounded",3,"click"],[1,"text-right",3,"ngSubmit"],["type","number","id","fuelDuration","name","fuelDuration","required","","min","1",1,"border","rounded-lg","px-2","py-1","w-20","text-right",3,"ngModelChange","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","ml-1","rounded",3,"click"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u26FD\uFE0F Fuel"),C(),T(4,"div",3)(5,"div",4),R(6),C(),T(7,"div",5),R(8),C(),_e(9,"app-battery",6),C()(),X(10,eJ,42,6),C()),t&2&&(k(),Q("ngClass",tt(8,KZ,r.isOpen)),k(3),Q("ngClass",tt(10,YZ,r.warning())),k(),Q("ngClass",r.remainingColor()),k(),z(" Empty: ",r.emptyFuelCountdown()," "),k(),Q("ngClass",r.remainingColor()),k(),z(" Laps: ",r.remainingFuelLap()," "),k(),Q("charge",r.remainingFuelPercentage()),k(),ie(r.isOpen?10:-1))},dependencies:[rt,ec,Xg,Ko,Go,pl,Jd,Wo,zo,eh,Xd,Qi,Yi],encapsulation:2})};var tJ=n=>({"mb-2":n});function nJ(n,e){if(n&1&&(T(0,"div",6)(1,"div")(2,"div",7),R(3,"Optimized AVG time"),C(),T(4,"div",8),R(5),C()(),T(6,"div")(7,"div",9),R(8,"Laps"),C(),T(9,"div",10),R(10),C()()(),_e(11,"hr",11),T(12,"div",12)(13,"div")(14,"div",7),R(15," Optimized AVG time "),T(16,"strong"),R(17,"if driver change now"),C()(),T(18,"div",8),R(19),C()(),T(20,"div")(21,"div",9),R(22,"Laps"),C(),T(23,"div",10),R(24),C()()()),n&2){let t=H();k(5),z(" ",t.AVGStintTime()," "),k(5),z(" ",t.laps()," "),k(9),z(" ",t.AVGStintTimeIfDriverChangeNow()," "),k(5),z(" ",t.lapsIfDriverChangeNow()," ")}}var nv=class n{stintOptimizerService=S(ui);AVGStintTime=Re(()=>{let e=this.stintOptimizerService.optimizedStint();return e?_t(e.avgStintMillisecondsTime):"--:--:--"});laps=Re(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.laps:0});AVGStintTimeIfDriverChangeNow=Re(()=>{let e=this.stintOptimizerService.optimizedStint();return e?_t(e.avgStintMillisecondsIfDriverChangedNow):"--:--:--"});lapsIfDriverChangeNow=Re(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.lapsIfDriverChangeNow:0});isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-stint-optimizer"]],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F9E0} Stint optimizer"),C(),T(4,"div",3)(5,"div",4),R(6),C(),T(7,"div",5),R(8),C()()(),X(9,nJ,25,4),C()),t&2&&(k(),Q("ngClass",tt(4,tJ,r.isOpen)),k(5),z(" Optimum: ",r.AVGStintTime()," "),k(2),z(" Laps: ",r.laps()," "),k(),ie(r.isOpen?9:-1))},dependencies:[rt],encapsulation:2})};var rJ=n=>({"mb-2":n}),iJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e}),oJ=n=>({"bg-yellow-500 text-white":n});function sJ(n,e){if(n&1&&(T(0,"div",4),R(1),C()),n&2){let t=H();k(),z(" Warning: ",t.driversTimeOnTrackWarningCount()," ")}}function aJ(n,e){n&1&&(T(0,"div",5),R(1," Completed! "),C())}function cJ(n,e){if(n&1&&(T(0,"tr",17)(1,"td",18),R(2),C(),T(3,"td",19),R(4),C(),T(5,"td",20),R(6),C(),T(7,"td",21)(8,"div",22),R(9),C()(),T(10,"td",23),R(11),C()()),n&2){let t=e.$implicit,r=H(2);Q("ngClass",Nr(7,iJ,t.id===r.activeStintDriverId(),t.id!==r.activeStintDriverId())),k(2),kt(t.id),k(2),kt(t.raceName),k(2),z(" ",r.getDriverStintCount(t.id)," "),k(2),Q("ngClass",tt(10,oJ,r.getDriverTimeOnTrackWarning(t.id))),k(),z(" ",r.getDriverTimeOnTrack(t.id)," "),k(2),z("",r.getDriverTimeFromLastStint(t.id)," ")}}function lJ(n,e){if(n&1&&(T(0,"div",6)(1,"table",7)(2,"thead",8)(3,"tr"),_e(4,"th",9),T(5,"th",10),R(6," Name "),C(),T(7,"th",11),R(8," Stint "),C(),T(9,"th",12),R(10," On track "),C(),T(11,"th",13),R(12," From last stint "),C()()()(),T(13,"div",14)(14,"table",15)(15,"tbody"),X(16,cJ,12,12,"tr",16),C()()()()),n&2){let t=H();k(16),Q("ngForOf",t.drivers())}}var rv=class n{driverService=S(Er);stintService=S(Bt);drivers=this.driverService.drivers;driversTimeOnTrackWarningCount=this.driverService.driversTimeOnTrackWarningCount;activeStintDriverId=Re(()=>{let e=this.stintService.activeStint();if(e)return e.driverId});isOpen=!0;getDriverTimeOnTrack(e){return _t(this.driverService.driversTimeOnTrackMap().get(e))}getDriverTimeOnTrackWarning(e){return this.driverService.driversTimeOnTrackWarningMap().get(e)||!1}getDriverStintCount(e){return this.driverService.driversStintCountMap().get(e)??0}getDriverTimeFromLastStint(e){return _t(this.driverService.driversTimeFromLastStintMap().get(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-driver"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[1,"p-1","text-center","rounded",3,"ngClass"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F417} Driver"),C(),T(4,"div",3),X(5,sJ,2,1,"div",4)(6,aJ,2,0,"div",5),C()(),X(7,lJ,17,1,"div",6),C()),t&2&&(k(),Q("ngClass",tt(3,rJ,r.isOpen)),k(4),ie(r.driversTimeOnTrackWarningCount()>0?5:6),k(2),ie(r.isOpen?7:-1))},dependencies:[rt,$n],encapsulation:2})};var iv=class n{raceService=S(jt);stintService=S(Bt);raceConfigService=S(Ye);open=J(!1);openInMilliseconds=J(0);constructor(){qe({endRaceDate:he(this.raceService.endRaceDate),activeStint:he(this.stintService.activeStint),activeRaceConfig:he(this.raceConfigService.activeRaceConfig),ping:At(1e3)}).pipe(Xe()).subscribe(({endRaceDate:e,activeStint:t,activeRaceConfig:r})=>{e&&t&&r?(this.open.set(this.calculatePitLaneOpen(e,t,r)),this.openInMilliseconds.set(this.calculatePitLaneOpenInMilliseconds(t,r))):(this.open.set(!1),this.openInMilliseconds.set(0))})}calculatePitLaneOpenInMilliseconds(e,t){let r=new Date().getTime();return ia(e.startDate.toDate(),t.minStintMinute).getTime()-r}calculatePitLaneOpen(e,t,r){let i=new Date,o=ZL(e,r.pitLaneCloseBeforeEndRaceMinute),s=QL(i,o),a=ia(t.startDate.toDate(),r.minStintMinute),c=YL(i,a);return s&&c}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var ov=class n{audio=new Audio;constructor(){this.audio.addEventListener("error",e=>console.error("Audio error:",e))}play(){this.audio.play()}playFile(e){this.audio=new Audio(e),this.audio.play()}pause(){this.audio.pause()}stop(){this.audio.pause(),this.audio.currentTime=0}seek(e){this.audio.currentTime=e}setVolume(e){this.audio.volume=e}setLoop(e){this.audio.loop=e}on(e,t){this.audio.addEventListener(e,t)}off(e,t){this.audio.removeEventListener(e,t)}getCurrentTime(){return this.audio.currentTime}getDuration(){return this.audio.duration}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var uJ=n=>({"mb-4":n}),dJ=n=>({"animate-bounce":n});function hJ(n,e){if(n&1&&(T(0,"div",3),R(1),C()),n&2){let t=H();k(),z(" Open in: ",t.pitLaneOpenInMillisecondsString()," ")}}function fJ(n,e){n&1&&(T(0,"div",5),R(1," Open "),C())}function pJ(n,e){n&1&&(T(0,"div",6),R(1," Closed "),C())}function mJ(n,e){if(n&1&&(T(0,"option",20),R(1),C()),n&2){let t=e.$implicit;Q("value",t.id),k(),z(" ",t.raceName," ")}}function gJ(n,e){if(n&1){let t=bi();T(0,"div",11),R(1,"PIT SETTINGS"),C(),T(2,"form")(3,"div",12)(4,"label",13),R(5,"\u{1F417} Driver"),C(),T(6,"select",14),xr("ngModelChange",function(i){ft(t);let o=H(2);return Xr(o.selectedDriver,i)||(o.selectedDriver=i),pt(i)}),ce("change",function(){ft(t);let i=H(2);return pt(i.updateDriverId())}),X(7,mJ,2,2,"option",15),C()(),T(8,"div",12)(9,"label",16),R(10,"\u26FD\uFE0F Refueling"),C(),T(11,"input",17),ce("change",function(){ft(t);let i=H(2);return pt(i.updateRefueling())}),xr("ngModelChange",function(i){ft(t);let o=H(2);return Xr(o.refueling,i)||(o.refueling=i),pt(i)}),C()(),T(12,"div",12)(13,"label",18),R(14,"\u{1F6DE} Tyre change"),C(),T(15,"input",19),xr("ngModelChange",function(i){ft(t);let o=H(2);return Xr(o.tyreChange,i)||(o.tyreChange=i),pt(i)}),ce("change",function(){ft(t);let i=H(2);return pt(i.updateTyreChange())}),C()()()}if(n&2){let t=H(2);k(6),Q("disabled",t.activePit()!==void 0),Rr("ngModel",t.selectedDriver),k(),Q("ngForOf",t.drivers()),k(4),Q("disabled",t.activePit()!==void 0),Rr("ngModel",t.refueling),k(4),Q("disabled",t.activePit()!==void 0||!t.tyreChangeWindowOpen()||t.remainingTyreChange()<=0),Rr("ngModel",t.tyreChange)}}function vJ(n,e){if(n&1&&(T(0,"div",21),R(1),C()),n&2){let t=H(3);Q("ngClass",tt(2,dJ,t.activePitRemainingMilliseconds()<1e4)),k(),z(" Pit out enabled in: ",t.activePitRemainingMillisecondsString()," ")}}function yJ(n,e){n&1&&(T(0,"div",22),R(1," Pit out ready! "),C())}function _J(n,e){if(n&1&&X(0,vJ,2,4,"div",21)(1,yJ,2,0,"div",22),n&2){let t=H(2);ie(t.activePitRemainingMilliseconds()>0?0:1)}}function wJ(n,e){if(n&1){let t=bi();T(0,"div",7),X(1,gJ,16,7)(2,_J,2,1),C(),T(3,"div",8)(4,"button",9),ce("click",function(){ft(t);let i=H();return pt(i.pitIn())}),R(5," Pit in "),C(),T(6,"button",10),ce("click",function(){ft(t);let i=H();return pt(i.pitOut())}),R(7," Pit out "),C()()}if(n&2){let t=H();k(),ie(t.activePit()?2:1),k(3),Q("disabled",!t.pitLaneOpen()),k(2),Q("disabled",!t.activePit()||t.activePit()&&t.activePitRemainingMilliseconds()>0)}}var sv=class n{pitLaneService=S(iv);pitService=S(Jt);driverService=S(Er);raceManagerService=S(cl);tyreService=S(qo);raceConfigService=S(Ye);audioService=S(ov);pitLaneOpen=this.pitLaneService.open;pitLaneOpenInMilliseconds=this.pitLaneService.openInMilliseconds;pitLaneOpenInMillisecondsString=Re(()=>_t(this.pitLaneService.openInMilliseconds()));activePit=this.pitService.activePit;activePitRemainingMilliseconds=this.pitService.activePitRemainingMilliseconds;activePitRemainingMillisecondsString=Re(()=>JL(this.pitService.activePitRemainingMilliseconds()));drivers=this.driverService.drivers;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;isOpen=!0;refueling=!1;tyreChange=!1;selectedDriver="1";constructor(){Mr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.nextPitDriverId,this.refueling=e.nextPitRefueling,this.tyreChange=e.nextPitTyreChange)})}pitIn(){return y(this,null,function*(){this.audioService.playFile("assets/box_box_box_box.mp3"),yield this.raceManagerService.pitIn(this.selectedDriver,this.refueling,this.tyreChange)})}pitOut(){return y(this,null,function*(){yield this.raceManagerService.pitOut(),this.raceConfigService.updateNextPitRefueling(!1),this.raceConfigService.updateNextPitTyreChange(!1);let e=this.driverService.driverWithMoreTimeFromLastStint();e&&this.raceConfigService.updateNextPitDriverId(e.id)})}updateDriverId(){this.raceConfigService.updateNextPitDriverId(this.selectedDriver)}updateTyreChange(){this.raceConfigService.updateNextPitTyreChange(this.tyreChange)}updateRefueling(){this.raceConfigService.updateNextPitRefueling(this.refueling)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-pit-lane"]],decls:9,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"flex","items-center"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","items-center","mb-2"],[1,"flex","justify-between"],[1,"bg-green-500","hover:bg-green-700","disabled:bg-green-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"bg-red-500","hover:bg-red-700","disabled:bg-red-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"font-semibold","mb-2"],[1,"mb-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","disabled","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","refueling",1,"mr-2"],["type","checkbox","id","refueling","name","refueling",3,"change","ngModelChange","disabled","ngModel"],["for","tyreChange",1,"mr-2"],["type","checkbox","id","tyreChange","name","tyreChange",3,"ngModelChange","change","disabled","ngModel"],[3,"value"],[1,"bg-yellow-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default",3,"ngClass"],[1,"bg-green-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F17F}\uFE0F Pit Lane"),C(),X(4,hJ,2,1,"div",3),T(5,"div",4),X(6,fJ,2,0,"div",5)(7,pJ,2,0,"div",6),C()(),X(8,wJ,8,3),C()),t&2&&(k(),Q("ngClass",tt(4,uJ,r.isOpen)),k(3),ie(r.pitLaneOpenInMilliseconds()>0?4:-1),k(2),ie(r.pitLaneOpen()?6:7),k(2),ie(r.isOpen?8:-1))},dependencies:[rt,Ko,Go,Gg,Kg,Rb,ml,Wo,zo,Qi,Yi,$n],encapsulation:2})};var EJ=n=>({"mb-2":n});function IJ(n,e){if(n&1&&(T(0,"div",4),R(1),C()),n&2){let t=H();k(),z(" Remaining: ",t.remainingDriverChanges()," ")}}function TJ(n,e){n&1&&(T(0,"div",5),R(1," Completed! "),C())}function CJ(n,e){if(n&1&&(T(0,"div",6)(1,"div")(2,"div",7),R(3,"Competed"),C(),T(4,"div",8),R(5),C()(),T(6,"div")(7,"div",9),R(8,"Remaining"),C(),T(9,"div",10),R(10),C()()()),n&2){let t=H();k(5),z(" ",t.completedDriverChanges()," "),k(5),z(" ",t.remainingDriverChanges()," ")}}var av=class n{pitService=S(Jt);remainingDriverChanges=this.pitService.remainingDriverChanges;completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!1;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-driver-change"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F417} \u{1F504} Driver change"),C(),T(4,"div",3),X(5,IJ,2,1,"div",4)(6,TJ,2,0,"div",5),C()(),X(7,CJ,11,2,"div",6),C()),t&2&&(k(),Q("ngClass",tt(3,EJ,r.isOpen)),k(4),ie(r.remainingDriverChanges()>0?5:6),k(2),ie(r.isOpen?7:-1))},dependencies:[rt],encapsulation:2})};var bJ=n=>({"mb-2":n});function DJ(n,e){if(n&1&&(T(0,"div",4),R(1),C(),T(2,"div",5),R(3),C()),n&2){let t=H(2);k(),z(" Remaining: ",t.activeStintRemainingTimeOnTrackString()," "),k(2),z(" Laps: ",t.activeStintRemainingLaps()," ")}}function SJ(n,e){if(n&1&&(T(0,"div",6),R(1),C(),T(2,"div",7),R(3),C()),n&2){let t=H(2);k(),z(" Gaining: ",t.activeStintGainedTimeOnTrackString()," "),k(2),z(" Laps: ",t.activeStintGainedLaps()," ")}}function AJ(n,e){if(n&1&&X(0,DJ,4,2)(1,SJ,4,2),n&2){let t=H();ie(t.activeStintRemainingTimeOnTrack()>0?0:1)}}function RJ(n,e){if(n&1&&R(0),n&2){let t=H(2);z(" ",t.activeStintRemainingTimeOnTrackString()," ")}}function xJ(n,e){n&1&&R(0," --:--:-- ")}function NJ(n,e){if(n&1&&R(0),n&2){let t=H(2);z(" ",t.activeStintRemainingLaps()," ")}}function MJ(n,e){n&1&&R(0," 0 ")}function PJ(n,e){if(n&1&&(T(0,"div",8)(1,"div")(2,"div",9),R(3,"Time on track"),C(),T(4,"div",10),R(5),C()(),T(6,"div")(7,"div",11),R(8,"Laps"),C(),T(9,"div",12),R(10),C()()(),_e(11,"hr",13),T(12,"div",8)(13,"div")(14,"div",9),R(15,"Remaining time on track"),C(),T(16,"div",10),X(17,RJ,1,1)(18,xJ,1,0),C()(),T(19,"div")(20,"div",11),R(21,"Remaining laps"),C(),T(22,"div",12),X(23,NJ,1,1)(24,MJ,1,0),C()()(),_e(25,"hr",13),T(26,"div",14)(27,"div")(28,"div",9),R(29,"Gained time on track"),C(),T(30,"div",10),R(31),C()(),T(32,"div")(33,"div",11),R(34,"Gained laps"),C(),T(35,"div",12),R(36),C()()()),n&2){let t=H();k(5),z(" ",t.activeStintTimeOnTrackString()," "),k(5),z(" ",t.activeStintLaps()," "),k(7),ie(t.activeStint()?17:18),k(6),ie(t.activeStint()?23:24),k(8),z(" ",t.activeStintGainedTimeOnTrackString()," "),k(5),z(" ",t.activeStintGainedLaps()," ")}}var cv=class n{stintService=S(Bt);activeStint=this.stintService.activeStint;activeStintRemainingTimeOnTrack=this.stintService.activeStintRemainingTimeOnTrack;activeStintTimeOnTrackString=Re(()=>_t(this.stintService.activeStintTimeOnTrack()));activeStintRemainingTimeOnTrackString=Re(()=>_t(this.stintService.activeStintRemainingTimeOnTrack()));activeStintGainedTimeOnTrackString=Re(()=>_t(this.stintService.activeStintGainedTimeOnTrack()));activeStintLaps=this.stintService.activeStintLaps;activeStintRemainingLaps=this.stintService.activeStintRemainingLaps;activeStintGainedLaps=this.stintService.activeStintGainedLaps;isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-active-stint"]],decls:7,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F3CE}\uFE0F \u{1F4A8} Active stint"),C(),T(4,"div",3),X(5,AJ,2,1),C()(),X(6,PJ,37,6),C()),t&2&&(k(),Q("ngClass",tt(3,bJ,r.isOpen)),k(4),ie(r.activeStint()?5:-1),k(),ie(r.isOpen?6:-1))},dependencies:[rt],encapsulation:2})};var kJ=n=>({"mb-2":n}),OJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function FJ(n,e){if(n&1&&(T(0,"tr",19)(1,"td",20),R(2),C(),T(3,"td",21),R(4),C(),T(5,"td",18),R(6),Do(7,"date"),C(),T(8,"td",18),R(9),C(),T(10,"td",18),R(11),C()()),n&2){let t=e.$implicit,r=H(2);Q("ngClass",Nr(9,OJ,t.id===r.activeStintId(),t.id!==r.activeStintId())),k(2),kt(t.id),k(2),z("",r.getDriverRacingName(t.driverId)," "),k(2),kt(So(7,6,t.startDate.toDate(),"HH:mm:ss")),k(3),z(" ",r.getEndDate(t)," "),k(2),z(" ",r.calculateTimeOnTrack(t.startDate.toDate(),t.endDate==null?null:t.endDate.toDate())," ")}}function LJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),_e(4,"th",8),T(5,"th",9),R(6,"Driver"),C(),T(7,"th",10),R(8,"Start"),C(),T(9,"th",10),R(10,"End"),C(),T(11,"th",10),R(12,"On track"),C()()()(),T(13,"div",11)(14,"table",12)(15,"tbody"),X(16,FJ,12,12,"tr",13),C()()(),T(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),R(22,"Totals"),C(),T(23,"td",18),R(24),C()()()()()()),n&2){let t=H();k(16),Q("ngForOf",t.stints()),k(8),kt(t.calculateTotalTimeOnTrack())}}var lv=class n{stintService=S(Bt);driverService=S(Er);stints=this.stintService.stints;activeStintId=Re(()=>{let e=this.stintService.activeStint();if(e)return e.id});isOpen=!0;getDriverRacingName(e){let r=this.driverService.drivers().find(i=>i.id===e);return r?r.raceName:""}calculateTimeOnTrack(e,t){return t?qr(e,t):qr(e,new Date)}calculateTotalTimeOnTrack(){let e=this.stintService.stints(),t=0;return e.forEach(r=>{r.endDate?t+=r.endDate.toDate().getTime()-r.startDate.toDate().getTime():t+=new Date().getTime()-r.startDate.toDate().getTime()}),_t(t)}getEndDate(e){if(e.endDate)return Hr(e.endDate.toDate(),"HH:mm:ss");let t=nr(e.startDate.toDate(),e.optimumMilliseconds);return"("+Hr(t,"HH:mm:ss")+")"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-stint"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],["colspan","6",1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-xs","xl:text-base","text-black"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u23F3 Stint"),C(),T(4,"div",3)(5,"div",4),R(6),C()()(),X(7,LJ,25,2,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,kJ,r.isOpen)),k(5),z(" Total: ",r.stints().length," "),k(),ie(r.isOpen?7:-1))},dependencies:[rt,$n,ec],encapsulation:2})};var VJ=n=>({"mb-2":n});function UJ(n,e){if(n&1){let t=bi();T(0,"div",5)(1,"div")(2,"div",6),R(3,"Reference time (mills)"),C(),T(4,"div",7)(5,"button",8),ce("click",function(){ft(t);let i=H();return pt(i.increaseReferenceLapTime())}),R(6,"+"),C(),T(7,"form",9),ce("ngSubmit",function(){ft(t);let i=H();return pt(i.onSubmit())}),T(8,"input",10),xr("ngModelChange",function(i){ft(t);let o=H();return Xr(o.referenceLapTime,i)||(o.referenceLapTime=i),pt(i)}),C()(),T(9,"button",11),ce("click",function(){ft(t);let i=H();return pt(i.decreaseReferenceLapTime())}),R(10,"-"),C()()()()}if(n&2){let t=H();k(8),Rr("ngModel",t.referenceLapTime)}}var uv=class n{raceConfigService=S(Ye);isOpen=!0;referenceLapTime=0;referenceLapTimeString="--:--:---";constructor(){Mr(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.referenceLapTime=e.referenceLapTimeMillisecond,this.referenceLapTimeString=XL(e.referenceLapTimeMillisecond))})}onSubmit(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime)}increaseReferenceLapTime(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime+1)}decreaseReferenceLapTime(){this.raceConfigService.updateReferenceLapTime(this.referenceLapTime-1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-lap"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-center"],[1,"text-gray-600","text-center"],[1,"flex","justify-end"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","mr-1","rounded",3,"click"],[1,"text-right",3,"ngSubmit"],["type","number","id","referenceLapTime","name","referenceLapTime","required","","min","1",1,"border","rounded-lg","px-2","py-1","w-36","text-right",3,"ngModelChange","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","ml-1","rounded",3,"click"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u23F1\uFE0F Lap"),C(),T(4,"div",3)(5,"div",4),R(6),C()()(),X(7,UJ,11,1,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,VJ,r.isOpen)),k(5),z(" Reference: ",r.referenceLapTimeString," "),k(),ie(r.isOpen?7:-1))},dependencies:[rt,Ko,Go,pl,Jd,Wo,zo,eh,Xd,Qi,Yi,bV],encapsulation:2})};var jJ=n=>({"mb-2":n}),BJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function $J(n,e){n&1&&R(0," \u2705 ")}function HJ(n,e){n&1&&R(0," \u2705 ")}function qJ(n,e){n&1&&R(0," \u2705 ")}function WJ(n,e){if(n&1&&(T(0,"tr",20)(1,"td",17),R(2),C(),T(3,"td",21),X(4,$J,1,0),C(),T(5,"td",22),X(6,HJ,1,0),C(),T(7,"td",22),X(8,qJ,1,0),C(),T(9,"td",23),R(10),C()()),n&2){let t=e.$implicit,r=H(2);Q("ngClass",Nr(6,BJ,t.id===r.activePitId(),t.id!==r.activePitId())),k(2),kt(t.id),k(2),ie(t.entryDriverId!==t.exitDriverId?4:-1),k(2),ie(t.refuel?6:-1),k(2),ie(t.tyreChange?8:-1),k(2),z(" ",r.calculatePitTime(t.entryTime.toDate(),t.exitTime==null?null:t.exitTime.toDate())," ")}}function zJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),_e(4,"th",8),T(5,"th",9),R(6,"\u{1F417} \u{1F504}"),C(),T(7,"th",9),R(8,"\u26FD\uFE0F"),C(),T(9,"th",9),R(10,"\u{1F6DE} \u{1F504}"),C(),T(11,"th",10),R(12,"Time"),C()()()(),T(13,"div",11)(14,"table",12)(15,"tbody"),X(16,WJ,11,9,"tr",13),C()()(),T(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),R(22,"Totals"),C(),T(23,"td",18),R(24),C(),T(25,"td",18),R(26),C(),T(27,"td",18),R(28),C(),T(29,"td",19),R(30),C()()()()()()),n&2){let t=H();k(16),Q("ngForOf",t.pits()),k(8),kt(t.completedDriverChanges()),k(2),kt(t.calculateTotalRefueling()),k(2),kt(t.calculateTotalTyreChanges()),k(2),kt(t.calculateTotalPitTime())}}var dv=class n{pitService=S(Jt);pits=this.pitService.pits;activePitId=Re(()=>{let e=this.pitService.activePit();if(e)return e.id});completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!0;calculatePitTime(e,t){return t?qr(e,t):qr(e,new Date)}calculateTotalPitTime(){let e=this.pitService.pits(),t=0;return e.forEach(r=>{r.exitTime?t+=r.exitTime.toDate().getTime()-r.entryTime.toDate().getTime():t+=new Date().getTime()-r.entryTime.toDate().getTime()}),_t(t)}calculateTotalRefueling(){return this.pitService.pits().filter(e=>e.refuel).length}calculateTotalTyreChanges(){return this.pitService.pits().filter(e=>e.tyreChange).length}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-pit"]],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],[1,"py-2","px-3","border-b","border-gray-200","text-sm","xl:text-base","text-black"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F468}\u{1F3FB}\u200D\u{1F527} Pit"),C(),T(4,"div",3)(5,"div",4),R(6),C()()(),X(7,zJ,31,5,"div",5),C()),t&2&&(k(),Q("ngClass",tt(3,jJ,r.isOpen)),k(5),z(" Total: ",r.pits().length," "),k(),ie(r.isOpen?7:-1))},dependencies:[rt,$n],encapsulation:2})};var hv=class n{stintService=S(Bt);deltaStints=J([]);totalDeltaMilliseconds=J(0);constructor(){qe({stints:he(this.stintService.stints),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e})=>{let t=this.createDeltaStints(e);this.deltaStints.set(t),this.totalDeltaMilliseconds.set(t.reduce((r,i)=>r+i.delta,0))})}createDeltaStints(e){let t=[];return e.forEach(r=>{t.push(this.createDeltaStint(r))}),t}createDeltaStint(e){let r=(e.endDate?e.endDate.toDate():new Date).getTime()-e.startDate.toDate().getTime(),i=r-e.optimumMilliseconds;return{id:e.id,delta:i,optimum:e.optimumMilliseconds,timeOnTrack:r}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};var GJ=n=>({"mb-2":n}),Mb=(n,e)=>({"bg-yellow-500":n,"bg-green-500":e}),KJ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function YJ(n,e){n&1&&R(0," Losing: ")}function QJ(n,e){n&1&&R(0," Gaining: ")}function ZJ(n,e){if(n&1&&(T(0,"tr",19)(1,"td",20),R(2),C(),T(3,"td",17),R(4),C(),T(5,"td",17),R(6),C(),T(7,"td",21)(8,"div",18),R(9),C()()()),n&2){let t=e.$implicit,r=H(2);Q("ngClass",Nr(6,KJ,t.id===r.activeStintId(),t.id!==r.activeStintId())),k(2),kt(t.id),k(2),kt(r.getMillisecondsToTimeString(t.timeOnTrack)),k(2),kt(r.getMillisecondsToTimeString(t.optimum)),k(2),Q("ngClass",Nr(9,Mb,t.delta<0,t.delta>=0)),k(),z(" ",r.getMillisecondsToTimeString(t.delta)," ")}}function JJ(n,e){if(n&1&&(T(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),_e(4,"th",8),T(5,"th",9),R(6,"On track"),C(),T(7,"th",9),R(8,"Optimum"),C(),T(9,"th",9),R(10,"Delta"),C()()()(),T(11,"div",10)(12,"table",11)(13,"tbody"),X(14,ZJ,10,12,"tr",12),C()()(),T(15,"div",13)(16,"table",11)(17,"tfoot",14)(18,"tr",15)(19,"td",16),R(20,"Totals"),C(),T(21,"td",17)(22,"div",18),R(23),C()()()()()()()),n&2){let t=H();k(14),Q("ngForOf",t.deltaStints()),k(8),Q("ngClass",Nr(3,Mb,t.totalDeltaMilliseconds()<0,t.totalDeltaMilliseconds()>=0)),k(),z(" ",t.getMillisecondsToTimeString(t.totalDeltaMilliseconds())," ")}}var fv=class n{stintService=S(Bt);deltaStintService=S(hv);deltaStints=this.deltaStintService.deltaStints;totalDeltaMilliseconds=this.deltaStintService.totalDeltaMilliseconds;activeStintId=Re(()=>{let e=this.stintService.activeStint();if(e)return e.id});isOpen=!0;getMillisecondsToTimeString(e){return _t(Math.abs(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-delta-stint"]],decls:10,vars:10,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default",3,"ngClass"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-xs","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],["colspan","5",1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","text-black","font-mono"],[1,"p-1","text-center","text-white","rounded",3,"ngClass"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-xs","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-xs","xl:text-base","font-mono"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),ce("click",function(){return r.isOpen=!r.isOpen}),T(2,"div",2),R(3,"\u{1F9D0} Delta stint"),C(),T(4,"div",3)(5,"div",4),X(6,YJ,1,0)(7,QJ,1,0),R(8),C()()(),X(9,JJ,24,6,"div",5),C()),t&2&&(k(),Q("ngClass",tt(5,GJ,r.isOpen)),k(4),Q("ngClass",Nr(7,Mb,r.totalDeltaMilliseconds()<0,r.totalDeltaMilliseconds()>=0)),k(),ie(r.totalDeltaMilliseconds()<0?6:7),k(2),z(" ",r.getMillisecondsToTimeString(r.totalDeltaMilliseconds())," "),k(),ie(r.isOpen?9:-1))},dependencies:[$n,rt],encapsulation:2})};var pv=class n{stintService=S(Bt);pitService=S(Jt);stintOptimizerService=S(ui);raceConfigService=S(Ye);timelineSteps=J([]);constructor(){qe({stints:he(this.stintService.stints),pits:he(this.pitService.pits),remainingDriverChanges:he(this.pitService.remainingDriverChanges),raceConfig:he(this.raceConfigService.activeRaceConfig),optimizedStint:he(this.stintOptimizerService.optimizedStint),ping:At(1e3)}).pipe(Xe()).subscribe(({stints:e,pits:t,remainingDriverChanges:r,raceConfig:i,optimizedStint:o})=>{let s=this.createRealSteps(e,t);if(s=s.sort((a,c)=>a.start.getTime()-c.start.getTime()),r>0&&o&&i){let a=this.createFutureSteps(s.at(s.length-1),r,o,i);s.push(...a)}s=s.sort((a,c)=>a.start.getTime()-c.start.getTime()),this.timelineSteps.set(s)})}createRealSteps(e,t){let r=[];return e.forEach(i=>{r.push(this.createTimelineStepFromStint(i))}),t.forEach(i=>{r.push(this.createTimelineStepFromPit(i))}),r}createTimelineStepFromPit(e){return{durationMills:e.exitTime?e.exitTime.toDate().getTime()-e.entryTime.toDate().getTime():void 0,end:e.exitTime?.toDate(),pit:e,start:e.entryTime.toDate(),status:e.exitTime?"DONE":"ACTIVE",stint:void 0,type:"PIT"}}createTimelineStepFromStint(e){return{durationMills:e.endDate?e.endDate.toDate().getTime()-e.startDate.toDate().getTime():void 0,end:e.endDate?.toDate(),pit:void 0,start:e.startDate.toDate(),status:e.endDate?"DONE":"ACTIVE",stint:e,type:"STINT"}}createFutureSteps(e,t,r,i){let o=[],s=this.calculateLastEndDateFromRealStep(e,r,i);if(e===void 0||e.type==="PIT"){let a=nr(s,r.avgStintMillisecondsTime);o.push(this.createFutureStintStep(s,a,r.avgStintMillisecondsTime)),s=a}for(let a=0;a<t;a++){let c=oa(s,i.minPitSeconds);o.push(this.createFuturePitStep(s,c,Hd(i.minPitSeconds)));let u=nr(c,r.avgStintMillisecondsTime);o.push(this.createFutureStintStep(c,u,r.avgStintMillisecondsTime)),s=u}return o}createFutureStintStep(e,t,r){return{durationMills:r,end:t,pit:void 0,start:e,status:"FUTURE",stint:void 0,type:"STINT"}}createFuturePitStep(e,t,r){return{durationMills:r,end:t,pit:void 0,start:e,status:"FUTURE",stint:void 0,type:"PIT"}}calculateLastEndDateFromRealStep(e,t,r){if(e===void 0)return new Date;let i;return e.type==="PIT"?i=oa(e.start,r.minPitSeconds):i=nr(e.start,t.avgStintMillisecondsTime),i>new Date?i:new Date}static \u0275fac=function(t){return new(t||n)};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})};function XJ(n,e){n&1&&_e(0,"hr",2)}function eX(n,e){if(n&1&&(T(0,"div",2),R(1),C(),X(2,XJ,1,0,"hr",2)),n&2){let t=H(),r=t.$implicit,i=t.$index,o=t.$count;k(),z(" ",r," "),k(),ie(i!==o-1?2:-1)}}function tX(n,e){if(n&1&&X(0,eX,3,2),n&2){let t=e.$implicit;ie(t!==""?0:-1)}}function nX(n,e){if(n&1&&(_e(0,"hr",2),T(1,"div",3),R(2),C()),n&2){let t=H();k(2),z(" ",t.data==null?null:t.data.footer," ")}}var mv=class n{left=0;top=0;data;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["tooltip"]],inputs:{left:"left",top:"top",data:"data"},decls:6,vars:6,consts:[[1,"fixed","whitespace-pre-line","bg-black","rounded-lg","shadow-md","p-4","text-white","max-w-48","-translate-x-1/2","tooltip"],[1,"font-bold","text-lg","mb-2"],[1,"mb-1"],[1,"text-lg"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1),R(2),C(),Ex(3,tX,1,1,null,null,wx),X(5,nX,3,1),C()),t&2&&(Xa("left",r.left+"px")("top",r.top+"px"),k(2),z(" ",r.data==null?null:r.data.title," "),k(),Ix(r.data==null?null:r.data.paragraphs),k(2),ie((r.data==null?null:r.data.footer)!==""?5:-1))},encapsulation:2})};var gv=class n{elementRef=S(lr);viewContainerRef=S(Es);document=S(Bn);tooltipData;tooltipComponent;hideTooltipTimeout;onMouseEnter(){this.tooltipComponent||(this.tooltipComponent=this.viewContainerRef.createComponent(mv),this.document.body.appendChild(this.tooltipComponent.location.nativeElement),this.setTooltipComponentProperties(),this.tooltipComponent.hostView.detectChanges())}onMouseLeave(){this.removeTooltip()}removeTooltip(){this.tooltipComponent&&(this.tooltipComponent.destroy(),this.tooltipComponent=void 0,this.hideTooltipTimeout&&(clearTimeout(this.hideTooltipTimeout),this.hideTooltipTimeout=void 0))}setTooltipComponentProperties(){if(!this.tooltipComponent)return;this.tooltipComponent.instance.data=this.tooltipData;let e=this.elementRef.nativeElement.getBoundingClientRect(),r=this.tooltipComponent.location.nativeElement.getBoundingClientRect(),i=e.left+(e.width-r.width)/2,o=e.bottom;i+r.width>window.innerWidth&&(i=window.innerWidth-r.width),i<0&&(i=0),o+r.height>window.innerHeight&&(o=e.top-r.height),o+r.height>window.innerHeight&&(o=e.top-r.height),o<0&&(o=e.bottom),this.tooltipComponent.instance.left=i,this.tooltipComponent.instance.top=o}static \u0275fac=function(t){return new(t||n)};static \u0275dir=at({type:n,selectors:[["","tooltip",""]],hostBindings:function(t,r){t&1&&ce("mouseenter",function(){return r.onMouseEnter()})("mouseleave",function(){return r.onMouseLeave()})},inputs:{tooltipData:"tooltipData"}})};function rX(n,e){if(n&1&&(T(0,"div",2),R(1),C()),n&2){let t=H().$implicit,r=H(2);Q("ngClass",r.getStintColor(t))("tooltipData",r.getStintTooltipInfo(t)),k(),z(" ",r.getStintText(t)," ")}}function iX(n,e){if(n&1&&(T(0,"div",3),R(1),C()),n&2){let t=H().$implicit,r=H(2);Q("ngClass",r.getPitColor(t))("tooltipData",r.getPitTooltipInfo(t)),k(),z(" ",r.getPitText(t)," ")}}function oX(n,e){if(n&1&&(lw(0),X(1,rX,2,3,"div",2)(2,iX,2,3,"div",3),uw()),n&2){let t=e.$implicit;k(),ie(t.type==="STINT"?1:2)}}function sX(n,e){if(n&1&&(T(0,"div",0),X(1,oX,3,1,"ng-container",1),C()),n&2){let t=H();k(),Q("ngForOf",t.timelineSteps())}}var vv=class n{timelineService=S(pv);driverService=S(Er);timelineSteps=this.timelineService.timelineSteps;hide=!1;constructor(){window.addEventListener("resize",this.onResize.bind(this))}onResize(){this.hide=window.innerWidth<=1460}getStintColor(e){return e.status==="DONE"?"bg-blue-400":e.status==="FUTURE"?"bg-blue-100":"bg-green-500"}getStintText(e){return e.status==="ACTIVE"?"\u{1F3CE}\uFE0F":"\u23F3"}getStintTooltipInfo(e){return{footer:"",paragraphs:[this.getStintTimeInfo(e),this.getDriverInfo(e)].filter(Boolean),title:this.getTooltipTitle(e)}}getStintTimeInfo(e){let t=[];t.push("Start: "+Hr(e.start,"HH:mm:ss"));let r=e.stint?e.stint.optimumMilliseconds??0:0;switch(e.status){case"ACTIVE":t.push("On track: "+qr(e.start,new Date)),t.push("Optimum: "+_t(r)),t.push("End: ("+Hr(nr(e.start,r),"HH:mm:ss")+")");break;case"DONE":t.push("On track: "+qr(e.start,e.end)),t.push("Optimum: "+_t(r)),t.push("End: "+(e.end?Hr(e.end,"HH:mm:ss"):""));break;case"FUTURE":t.push("Optimum: "+_t(e.durationMills)),t.push("End: "+(e.end?Hr(e.end,"HH:mm:ss"):""));break}return t.filter(Boolean).join(`
`)}getPitColor(e){return e.status==="DONE"?"bg-amber-400":e.status==="FUTURE"?"bg-amber-100":"bg-green-500"}getPitText(e){return e.status==="ACTIVE"?"\u{1F17F}\uFE0F":"\u{1F468}\u{1F3FB}\u200D\u{1F527}"}getPitTooltipInfo(e){let t="Enter: "+Hr(e.start,"HH:mm:ss"),r=e.durationMills?"Time: "+_t(e.durationMills):"",i="Exit: "+(e.end?Hr(e.end,"HH:mm:ss"):Hr(nr(e.start,e.durationMills??0),"HH:mm:ss")),o=[];e.pit&&(e.pit.entryDriverId!==e.pit.exitDriverId&&o.push("\u{1F417}"),e.pit.refuel&&o.push("\u26FD\uFE0F"),e.pit.tyreChange&&o.push("\u{1F6DE}\uFE0F")),r.length>0&&(t+=`
`),i.length>0&&(r+=`
`);let a=[t+r+i,this.getDriverInfo(e)].filter(Boolean);return{footer:o.join(" | "),paragraphs:a,title:this.getTooltipTitle(e)}}getTooltipTitle(e){if(e.type==="STINT"){let t=e.stint?"("+e.stint.id+")":"";return e.status==="ACTIVE"?"Active stint "+t:e.status==="DONE"?"Stint "+t:"Future stint"}if(e.type==="PIT"){let t=e.pit?"("+e.pit.id+")":"";return e.status==="ACTIVE"?"Active pit "+t:e.status==="DONE"?"Pit "+t:"Future pit"}return""}getDriverInfo(e){if(e.type==="STINT"&&e.stint)return"Driver: "+this.getDriverRacingName(e.stint.driverId);if(e.type==="PIT"&&e.pit){let t="Driver in: "+this.getDriverRacingName(e.pit.entryDriverId),r="Driver out: "+this.getDriverRacingName(e.pit.exitDriverId);return t+`
`+r}return""}getDriverRacingName(e){let r=this.driverService.drivers().find(i=>i.id===e);return r?r.raceName:""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-timeline"]],decls:1,vars:1,consts:[[1,"mb-3","flex","justify-center","items-center"],[4,"ngFor","ngForOf"],["tooltip","",1,"flex-1","flex","px-1","py-3","justify-center","items-center",3,"ngClass","tooltipData"],["tooltip","",1,"flex-0","flex","px-1","py-3","justify-center","items-center",3,"ngClass","tooltipData"]],template:function(t,r){t&1&&X(0,sX,2,1,"div",0),t&2&&ie(r.hide?-1:0)},dependencies:[$n,rt,gv],encapsulation:2})};var yv=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ve({type:n,selectors:[["app-root"]],decls:38,vars:0,consts:[[1,"w-full","h-full","min-h-full","dark:bg-black"],[1,"p-4","grid","grid-cols-2","lg:grid-cols-3","gap-3"],[1,"text-xl","md:text-3xl","dark:text-white","font-semibold"],[1,"text-right","lg:text-center"],[1,"mx-4","grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3","mb-4"],[1,"flex-col","md:h-fit"],[1,"mb-3","lg:mb-4"],[1,"lg:mb-4"],[1,"flex-col"],[1,"flex","flex-col","justify-center","items-center"],["src","assets/cremona_circuit.jpg","alt","Circuito",1,"max-w-sm","md:max-w-md"]],template:function(t,r){t&1&&(T(0,"div",0)(1,"div",1)(2,"div",2),R(3,"\u{1F3CE}\uFE0F dash-boar \u{1F417}"),C(),T(4,"div",3),_e(5,"app-race"),C()(),_e(6,"app-timeline"),T(7,"div",4)(8,"div",5)(9,"div",6),_e(10,"app-pit-lane"),C(),T(11,"div",6),_e(12,"app-driver-change"),C(),T(13,"div",6),_e(14,"app-tyre-change-window"),C(),T(15,"div",7),_e(16,"app-pit"),C()(),T(17,"div",8)(18,"div",6),_e(19,"app-fuel"),C(),T(20,"div",6),_e(21,"app-stint-optimizer"),C(),T(22,"div",6),_e(23,"app-lap"),C(),T(24,"div",7),_e(25,"app-driver"),C()(),T(26,"div",8)(27,"div",6),_e(28,"app-active-stint"),C(),T(29,"div",6),_e(30,"app-stint"),C(),T(31,"div",7),_e(32,"app-delta-stint"),C()()(),T(33,"div",9)(34,"div",2),R(35,"Cremona kart circuit"),C(),_e(36,"img",10),C()(),_e(37,"router-outlet"))},dependencies:[oE,Zg,Jg,tv,nv,rv,sv,av,cv,lv,uv,dv,fv,vv],encapsulation:2})};iN(yv,lL).catch(n=>console.error(n));
