import{$ as bn,A as Tn,B as xr,C as $d,D as $t,E as Bb,F as $b,G as Nr,H as Rs,I as hl,J as fl,K as pl,L as xs,M as Hb,N as qb,O as Gb,P as zb,Q as ml,R as gl,S as xe,T as Tt,U as rn,V as Mr,W as Yg,X as Hd,Y as bt,Z as xt,_ as si,a as j,aa as Wb,b as Te,ba as Nt,c as qi,ca as qd,d as _,da as J,e as $,ea as Kb,f as Go,g as Pb,h as Ob,i as kb,j as Fb,k as Lb,l as Gi,m as Kg,n as Qg,o as zo,p as nn,q as ll,r as Vb,s as ul,t as Bd,u as Ub,v as Rr,w as jb,x as ii,y as As,z as dl}from"./chunk-VUN4IAWB.js";function Qb(n,e){return Object.is(n,e)}var Ut=null,vl=!1,Gd=1,Pr=Symbol("SIGNAL");function Ne(n){let e=Ut;return Ut=n,e}function Yb(){return Ut}function NL(){return vl}var Wo={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ev(n){if(vl)throw new Error("");if(Ut===null)return;Ut.consumerOnSignalRead(n);let e=Ut.nextProducerIndex++;if(Zd(Ut),e<Ut.producerNode.length&&Ut.producerNode[e]!==n&&_l(Ut)){let t=Ut.producerNode[e];Yd(t,Ut.producerIndexOfThis[e])}Ut.producerNode[e]!==n&&(Ut.producerNode[e]=n,Ut.producerIndexOfThis[e]=_l(Ut)?tS(n,Ut,e):0),Ut.producerLastReadVersion[e]=n.version}function ML(){Gd++}function Zb(n){if(!(_l(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Gd)){if(!n.producerMustRecompute(n)&&!Kd(n)){n.dirty=!1,n.lastCleanEpoch=Gd;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Gd}}function Jb(n){if(n.liveConsumerNode===void 0)return;let e=vl;vl=!0;try{for(let t of n.liveConsumerNode)t.dirty||eS(t)}finally{vl=e}}function Xb(){return Ut?.consumerAllowSignalWrites!==!1}function eS(n){n.dirty=!0,Jb(n),n.consumerMarkedDirty?.(n)}function yl(n){return n&&(n.nextProducerIndex=0),Ne(n)}function Wd(n,e){if(Ne(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(_l(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Yd(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Kd(n){Zd(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Zb(t),r!==t.version))return!0}return!1}function Qd(n){if(Zd(n),_l(n))for(let e=0;e<n.producerNode.length;e++)Yd(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function tS(n,e,t){if(nS(n),n.liveConsumerNode.length===0&&rS(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=tS(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Yd(n,e){if(nS(n),n.liveConsumerNode.length===1&&rS(n))for(let r=0;r<n.producerNode.length;r++)Yd(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Zd(i),i.producerIndexOfThis[r]=e}}function _l(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Zd(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function nS(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function rS(n){return n.producerNode!==void 0}function iS(n){let e=Object.create(PL);e.computation=n;let t=()=>{if(Zb(e),ev(e),e.value===zd)throw e.error;return e.value};return t[Pr]=e,t}var Zg=Symbol("UNSET"),Jg=Symbol("COMPUTING"),zd=Symbol("ERRORED"),PL=Te(j({},Wo),{value:Zg,dirty:!0,error:null,equal:Qb,producerMustRecompute(n){return n.value===Zg||n.value===Jg},producerRecomputeValue(n){if(n.value===Jg)throw new Error("Detected cycle in computations.");let e=n.value;n.value=Jg;let t=yl(n),r;try{r=n.computation()}catch(i){r=zd,n.error=i}finally{Wd(n,t)}if(e!==Zg&&e!==zd&&r!==zd&&n.equal(e,r)){n.value=e;return}n.value=r,n.version++}});function OL(){throw new Error}var sS=OL;function oS(){sS()}function aS(n){sS=n}var kL=null;function cS(n){let e=Object.create(uS);e.value=n;let t=()=>(ev(e),e.value);return t[Pr]=e,t}function tv(n,e){Xb()||oS(),n.equal(n.value,e)||(n.value=e,FL(n))}function lS(n,e){Xb()||oS(),tv(n,e(n.value))}var uS=Te(j({},Wo),{equal:Qb,value:void 0});function FL(n){n.version++,ML(),Jb(n),kL?.()}function dS(n,e,t){let r=Object.create(LL);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;let i=c=>{r.cleanupFn=c};function s(c){return c.fn===null&&c.schedule===null}function o(c){s(c)||(Qd(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=Xg)}let a=()=>{if(r.fn===null)return;if(NL())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!Kd(r))return;r.hasRun=!0;let c=yl(r);try{r.cleanupFn(),r.cleanupFn=Xg,r.fn(i)}finally{Wd(r,c)}};return r.ref={notify:()=>eS(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>o(r),[Pr]:r},r.ref}var Xg=()=>{},LL=Te(j({},Wo),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule!==null&&n.schedule(n.ref)},hasRun:!1,cleanupFn:Xg});function pe(n){return typeof n=="function"}function Ko(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Jd=Ko(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ns(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var yt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(pe(r))try{r()}catch(s){e=s instanceof Jd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{hS(s)}catch(o){e=e??[],o instanceof Jd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Jd(e)}}add(e){var t;if(e&&e!==this)if(this.closed)hS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ns(t,e)}remove(e){let{_finalizers:t}=this;t&&Ns(t,e),e instanceof n&&e._removeParent(this)}};yt.EMPTY=(()=>{let n=new yt;return n.closed=!0,n})();var nv=yt.EMPTY;function Xd(n){return n instanceof yt||n&&"closed"in n&&pe(n.remove)&&pe(n.add)&&pe(n.unsubscribe)}function hS(n){pe(n)?n():n.unsubscribe()}var pr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Qo={setTimeout(n,e,...t){let{delegate:r}=Qo;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Qo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function eh(n){Qo.setTimeout(()=>{let{onUnhandledError:e}=pr;if(e)e(n);else throw n})}function wl(){}var fS=rv("C",void 0,void 0);function pS(n){return rv("E",void 0,n)}function mS(n){return rv("N",n,void 0)}function rv(n,e,t){return{kind:n,value:e,error:t}}var Ms=null;function Yo(n){if(pr.useDeprecatedSynchronousErrorHandling){let e=!Ms;if(e&&(Ms={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Ms;if(Ms=null,t)throw r}}else n()}function gS(n){pr.useDeprecatedSynchronousErrorHandling&&Ms&&(Ms.errorThrown=!0,Ms.error=n)}var Ps=class extends yt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Xd(e)&&e.add(this)):this.destination=jL}static create(e,t,r){return new Zo(e,t,r)}next(e){this.isStopped?sv(mS(e),this):this._next(e)}error(e){this.isStopped?sv(pS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?sv(fS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},VL=Function.prototype.bind;function iv(n,e){return VL.call(n,e)}var ov=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){th(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){th(r)}else th(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){th(t)}}},Zo=class extends Ps{constructor(e,t,r){super();let i;if(pe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&pr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&iv(e.next,s),error:e.error&&iv(e.error,s),complete:e.complete&&iv(e.complete,s)}):i=e}this.destination=new ov(i)}};function th(n){pr.useDeprecatedSynchronousErrorHandling?gS(n):eh(n)}function UL(n){throw n}function sv(n,e){let{onStoppedNotification:t}=pr;t&&Qo.setTimeout(()=>t(n,e))}var jL={closed:!0,next:wl,error:UL,complete:wl};var Jo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function gn(n){return n}function nh(...n){return av(n)}function av(n){return n.length===0?gn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var he=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=$L(t)?t:new Zo(t,r,i);return Yo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=vS(r),new r((i,s)=>{let o=new Zo({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Jo](){return this}pipe(...t){return av(t)(this)}toPromise(t){return t=vS(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function vS(n){var e;return(e=n??pr.Promise)!==null&&e!==void 0?e:Promise}function BL(n){return n&&pe(n.next)&&pe(n.error)&&pe(n.complete)}function $L(n){return n&&n instanceof Ps||BL(n)&&Xd(n)}function cv(n){return pe(n?.lift)}function ye(n){return e=>{if(cv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function me(n,e,t,r,i){return new Il(n,e,t,r,i)}var Il=class extends Ps{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Xo(){return ye((n,e)=>{let t=null;n._refCount++;let r=me(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ea=class extends he{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,cv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new yt;let t=this.getSubject();e.add(this.source.subscribe(me(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=yt.EMPTY)}return e}refCount(){return Xo()(this)}};var _S=Ko(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ht=(()=>{class n extends he{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new rh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new _S}next(t){Yo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Yo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Yo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?nv:(this.currentObservers=null,s.push(t),new yt(()=>{this.currentObservers=null,Ns(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new he;return t.source=this,t}}return n.create=(e,t)=>new rh(e,t),n})(),rh=class extends ht{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:nv}};var Qt=class extends ht{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var El={now(){return(El.delegate||Date).now()},delegate:void 0};var Cl=class extends ht{constructor(e=1/0,t=1/0,r=El){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var ih=class extends yt{constructor(e,t){super()}schedule(e,t=0){return this}};var Tl={setInterval(n,e,...t){let{delegate:r}=Tl;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Tl;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ta=class extends ih{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Tl.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Tl.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ns(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var na=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};na.now=El.now;var ra=class extends na{constructor(e,t=na.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ia=new ra(ta),lv=ia;var sh=class extends ta{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var oh=class extends ra{};var uv=new oh(sh);var jn=new he(n=>n.complete());function ah(n){return n&&pe(n.schedule)}function yS(n){return n[n.length-1]}function ch(n){return pe(yS(n))?n.pop():void 0}function zi(n){return ah(yS(n))?n.pop():void 0}function dv(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function IS(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{u(r.next(d))}catch(f){o(f)}}function c(d){try{u(r.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function wS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Os(n){return this instanceof Os?(this.v=n,this):new Os(n)}function ES(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(w){return Promise.resolve(w).then(v,f)}}function a(v,w){r[v]&&(i[v]=function(M){return new Promise(function(R,L){s.push([v,M,R,L])>1||c(v,M)})},w&&(i[v]=w(i[v])))}function c(v,w){try{u(r[v](w))}catch(M){m(s[0][3],M)}}function u(v){v.value instanceof Os?Promise.resolve(v.value.v).then(d,f):m(s[0][2],v)}function d(v){c("next",v)}function f(v){c("throw",v)}function m(v,w){v(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function CS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof wS=="function"?wS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var lh=n=>n&&typeof n.length=="number"&&typeof n!="function";function uh(n){return pe(n?.then)}function dh(n){return pe(n[Jo])}function hh(n){return Symbol.asyncIterator&&pe(n?.[Symbol.asyncIterator])}function fh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function HL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ph=HL();function mh(n){return pe(n?.[ph])}function gh(n){return ES(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Os(t.read());if(i)return yield Os(void 0);yield yield Os(r)}}finally{t.releaseLock()}})}function vh(n){return pe(n?.getReader)}function wt(n){if(n instanceof he)return n;if(n!=null){if(dh(n))return qL(n);if(lh(n))return GL(n);if(uh(n))return zL(n);if(hh(n))return TS(n);if(mh(n))return WL(n);if(vh(n))return KL(n)}throw fh(n)}function qL(n){return new he(e=>{let t=n[Jo]();if(pe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function GL(n){return new he(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function zL(n){return new he(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,eh)})}function WL(n){return new he(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function TS(n){return new he(e=>{QL(n,e).catch(t=>e.error(t))})}function KL(n){return TS(gh(n))}function QL(n,e){var t,r,i,s;return IS(this,void 0,void 0,function*(){try{for(t=CS(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Sn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Wi(n,e=0){return ye((t,r)=>{t.subscribe(me(r,i=>Sn(r,n,()=>r.next(i),e),()=>Sn(r,n,()=>r.complete(),e),i=>Sn(r,n,()=>r.error(i),e)))})}function Ki(n,e=0){return ye((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function bS(n,e){return wt(n).pipe(Ki(e),Wi(e))}function SS(n,e){return wt(n).pipe(Ki(e),Wi(e))}function DS(n,e){return new he(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function AS(n,e){return new he(t=>{let r;return Sn(t,e,()=>{r=n[ph](),Sn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>pe(r?.return)&&r.return()})}function _h(n,e){if(!n)throw new Error("Iterable cannot be null");return new he(t=>{Sn(t,e,()=>{let r=n[Symbol.asyncIterator]();Sn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function RS(n,e){return _h(gh(n),e)}function xS(n,e){if(n!=null){if(dh(n))return bS(n,e);if(lh(n))return DS(n,e);if(uh(n))return SS(n,e);if(hh(n))return _h(n,e);if(mh(n))return AS(n,e);if(vh(n))return RS(n,e)}throw fh(n)}function ct(n,e){return e?xS(n,e):wt(n)}function ne(...n){let e=zi(n);return ct(n,e)}function sa(n,e){let t=pe(n)?n:()=>n,r=i=>i.error(t());return new he(e?i=>e.schedule(r,0,i):r)}function hv(n){return!!n&&(n instanceof he||pe(n.lift)&&pe(n.subscribe))}var oi=Ko(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function NS(n){return n instanceof Date&&!isNaN(n)}function Q(n,e){return ye((t,r)=>{let i=0;t.subscribe(me(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:YL}=Array;function ZL(n,e){return YL(e)?n(...e):n(e)}function yh(n){return Q(e=>ZL(n,e))}var{isArray:JL}=Array,{getPrototypeOf:XL,prototype:eV,keys:tV}=Object;function wh(n){if(n.length===1){let e=n[0];if(JL(e))return{args:e,keys:null};if(nV(e)){let t=tV(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function nV(n){return n&&typeof n=="object"&&XL(n)===eV}function Ih(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Je(...n){let e=zi(n),t=ch(n),{args:r,keys:i}=wh(n);if(r.length===0)return ct([],e);let s=new he(rV(r,e,i?o=>Ih(i,o):gn));return t?s.pipe(yh(t)):s}function rV(n,e,t=gn){return r=>{MS(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)MS(e,()=>{let u=ct(n[c],e),d=!1;u.subscribe(me(r,f=>{s[c]=f,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function MS(n,e,t){n?Sn(t,n,e):e()}function PS(n,e,t,r,i,s,o,a){let c=[],u=0,d=0,f=!1,m=()=>{f&&!c.length&&!u&&e.complete()},v=M=>u<r?w(M):c.push(M),w=M=>{s&&e.next(M),u++;let R=!1;wt(t(M,d++)).subscribe(me(e,L=>{i?.(L),s?v(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(u--;c.length&&u<r;){let L=c.shift();o?Sn(e,o,()=>w(L)):w(L)}m()}catch(L){e.error(L)}}))};return n.subscribe(me(e,v,()=>{f=!0,m()})),()=>{a?.()}}function St(n,e,t=1/0){return pe(e)?St((r,i)=>Q((s,o)=>e(r,s,i,o))(wt(n(r,i))),t):(typeof e=="number"&&(t=e),ye((r,i)=>PS(r,i,n,t)))}function fv(n=1/0){return St(gn,n)}function OS(){return fv(1)}function oa(...n){return OS()(ct(n,zi(n)))}function Eh(n){return new he(e=>{wt(n()).subscribe(e)})}function pv(...n){let e=ch(n),{args:t,keys:r}=wh(n),i=new he(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let d=0;d<o;d++){let f=!1;wt(t[d]).subscribe(me(s,m=>{f||(f=!0,u--),a[d]=m},()=>c--,void 0,()=>{(!c||!f)&&(u||s.next(r?Ih(r,a):a),s.complete())}))}});return e?i.pipe(yh(e)):i}function mv(n=0,e,t=lv){let r=-1;return e!=null&&(ah(e)?t=e:r=e),new he(i=>{let s=NS(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}function Yt(n=0,e=ia){return n<0&&(n=0),mv(n,n,e)}function vn(n,e){return ye((t,r)=>{let i=0;t.subscribe(me(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Qi(n){return ye((e,t)=>{let r=null,i=!1,s;r=e.subscribe(me(t,void 0,void 0,o=>{s=wt(n(o,Qi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function kS(n,e,t,r,i){return(s,o)=>{let a=t,c=e,u=0;s.subscribe(me(o,d=>{let f=u++;c=a?n(c,d,f):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ks(n,e){return pe(e)?St(n,e,1):St(n,1)}function Yi(n){return ye((e,t)=>{let r=!1;e.subscribe(me(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function ai(n){return n<=0?()=>jn:ye((e,t)=>{let r=0;e.subscribe(me(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function gv(n){return Q(()=>n)}function Ch(n,e=gn){return n=n??iV,ye((t,r)=>{let i,s=!0;t.subscribe(me(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function iV(n,e){return n===e}function Th(n=sV){return ye((e,t)=>{let r=!1;e.subscribe(me(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function sV(){return new oi}function bl(n){return ye((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Or(n,e){let t=arguments.length>=2;return r=>r.pipe(n?vn((i,s)=>n(i,s,r)):gn,ai(1),t?Yi(e):Th(()=>new oi))}function vv(n,e,t,r){return ye((i,s)=>{let o;!e||typeof e=="function"?o=e:{duration:t,element:o,connector:r}=e;let a=new Map,c=w=>{a.forEach(w),w(s)},u=w=>c(M=>M.error(w)),d=0,f=!1,m=new Il(s,w=>{try{let M=n(w),R=a.get(M);if(!R){a.set(M,R=r?r():new ht);let L=v(M,R);if(s.next(L),t){let q=me(R,()=>{R.complete(),q?.unsubscribe()},void 0,void 0,()=>a.delete(M));m.add(wt(t(L)).subscribe(q))}}R.next(o?o(w):w)}catch(M){u(M)}},()=>c(w=>w.complete()),u,()=>a.clear(),()=>(f=!0,d===0));i.subscribe(m);function v(w,M){let R=new he(L=>{d++;let q=M.subscribe(L);return()=>{q.unsubscribe(),--d===0&&f&&m.unsubscribe()}});return R.key=w,R}})}function aa(n){return n<=0?()=>jn:ye((e,t)=>{let r=[];e.subscribe(me(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function _v(n,e){let t=arguments.length>=2;return r=>r.pipe(n?vn((i,s)=>n(i,s,r)):gn,aa(1),t?Yi(e):Th(()=>new oi))}function bh(){return ye((n,e)=>{let t,r=!1;n.subscribe(me(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function Sh(n,e){return ye(kS(n,e,arguments.length>=2,!0))}function ca(...n){let e=zi(n);return ye((t,r)=>{(e?oa(n,t,e):oa(n,t)).subscribe(r)})}function Dn(n,e){return ye((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(me(r,c=>{i?.unsubscribe();let u=0,d=s++;wt(n(c,d)).subscribe(i=me(r,f=>r.next(e?e(c,f,d,u++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Ht(n){return ye((e,t)=>{wt(n).subscribe(me(t,()=>t.complete(),wl)),!t.closed&&e.subscribe(t)})}function jt(n,e,t){let r=pe(n)||e||t?{next:n,error:e,complete:t}:n;return r?ye((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(me(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):gn}var oV="https://g.co/ng/security#xss",Y=class extends Error{constructor(e,t){super(T_(e,t)),this.code=e}};function T_(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Ll(n){return{toString:n}.toString()}var Dh="__parameters__";function aV(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function wD(n,e,t){return Ll(()=>{let r=aV(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,d){let f=c.hasOwnProperty(Dh)?c[Dh]:Object.defineProperty(c,Dh,{value:[]})[Dh];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Sl=globalThis;function Xe(n){for(let e in n)if(n[e]===Xe)return e;throw Error("Could not find renamed property on target object.")}function cV(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Rn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Rn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function FS(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var lV=Xe({__forward_ref__:Xe});function er(n){return n.__forward_ref__=er,n.toString=function(){return Rn(this())},n}function _n(n){return ID(n)?n():n}function ID(n){return typeof n=="function"&&n.hasOwnProperty(lV)&&n.__forward_ref__===er}function B(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ws(n){return{providers:n.providers||[],imports:n.imports||[]}}function lf(n){return LS(n,CD)||LS(n,TD)}function ED(n){return lf(n)!==null}function LS(n,e){return n.hasOwnProperty(e)?n[e]:null}function uV(n){let e=n&&(n[CD]||n[TD]);return e||null}function VS(n){return n&&(n.hasOwnProperty(US)||n.hasOwnProperty(dV))?n[US]:null}var CD=Xe({\u0275prov:Xe}),US=Xe({\u0275inj:Xe}),TD=Xe({ngInjectableDef:Xe}),dV=Xe({ngInjectorDef:Xe}),H=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=B({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function bD(n){return n&&!!n.\u0275providers}var hV=Xe({\u0275cmp:Xe}),fV=Xe({\u0275dir:Xe}),pV=Xe({\u0275pipe:Xe}),mV=Xe({\u0275mod:Xe}),Lh=Xe({\u0275fac:Xe}),Rl=Xe({__NG_ELEMENT_ID__:Xe}),jS=Xe({__NG_ENV_ID__:Xe});function b_(n){return typeof n=="string"?n:n==null?"":String(n)}function gV(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():b_(n)}function vV(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Y(-200,n)}function S_(n,e){throw new Y(-201,!1)}var Ie=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ie||{}),Mv;function SD(){return Mv}function An(n){let e=Mv;return Mv=n,e}function DD(n,e,t){let r=lf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ie.Optional)return null;if(e!==void 0)return e;S_(n,"Injector")}var _V={},xl=_V,Pv="__NG_DI_FLAG__",Vh="ngTempTokenPath",yV="ngTokenPath",wV=/\n/gm,IV="\u0275",BS="__source",ha;function EV(){return ha}function Zi(n){let e=ha;return ha=n,e}function CV(n,e=Ie.Default){if(ha===void 0)throw new Y(-203,!1);return ha===null?DD(n,void 0,e):ha.get(n,e&Ie.Optional?null:void 0,e)}function oe(n,e=Ie.Default){return(SD()||CV)(_n(n),e)}function P(n,e=Ie.Default){return oe(n,uf(e))}function uf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ov(n){let e=[];for(let t=0;t<n.length;t++){let r=_n(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Y(900,!1);let i,s=Ie.Default;for(let o=0;o<r.length;o++){let a=r[o],c=TV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(oe(i,s))}else e.push(oe(r))}return e}function AD(n,e){return n[Pv]=e,n.prototype[Pv]=e,n}function TV(n){return n[Pv]}function bV(n,e,t,r){let i=n[Vh];throw e[BS]&&i.unshift(e[BS]),n.message=SV(`
`+n.message,i,t,r),n[yV]=i,n[Vh]=null,n}function SV(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==IV?n.slice(2):n;let i=Rn(e);if(Array.isArray(e))i=e.map(Rn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Rn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(wV,`
  `)}`}var ue=AD(wD("Optional"),8);var RD=AD(wD("SkipSelf"),4);function Vs(n,e){let t=n.hasOwnProperty(Lh);return t?n[Lh]:null}function D_(n,e){n.forEach(t=>Array.isArray(t)?D_(t,e):e(t))}function xD(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Uh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function DV(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function AV(n,e,t){let r=Vl(n,e);return r>=0?n[r|1]=t:(r=~r,DV(n,r,e,t)),r}function yv(n,e){let t=Vl(n,e);if(t>=0)return n[t|1]}function Vl(n,e){return RV(n,e,1)}function RV(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var pa={},Qn=[],ma=new H(""),ND=new H("",-1),MD=new H(""),jh=class{get(e,t=xl){if(t===xl){let r=new Error(`NullInjectorError: No provider for ${Rn(e)}!`);throw r.name="NullInjectorError",r}return t}},PD=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(PD||{}),Lr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Lr||{}),es=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(es||{});function xV(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function kv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];MV(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function NV(n){return n===3||n===4||n===6}function MV(n){return n.charCodeAt(0)===64}function Nl(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?$S(n,t,i,null,e[++r]):$S(n,t,i,null,null))}}return n}function $S(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var OD="ng-template";function PV(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&xV(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(A_(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function A_(n){return n.type===4&&n.value!==OD}function OV(n,e,t){let r=n.type===4&&!t?OD:n.value;return e===r}function kV(n,e,t){let r=4,i=n.attrs,s=i!==null?VV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!mr(r)&&!mr(c))return!1;if(o&&mr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!OV(n,c,t)||c===""&&e.length===1){if(mr(r))return!1;o=!0}}else if(r&8){if(i===null||!PV(n,i,c,t)){if(mr(r))return!1;o=!0}}else{let u=e[++a],d=FV(c,i,A_(n),t);if(d===-1){if(mr(r))return!1;o=!0;continue}if(u!==""){let f;if(d>s?f="":f=i[d+1].toLowerCase(),r&2&&u!==f){if(mr(r))return!1;o=!0}}}}return mr(r)||o}function mr(n){return(n&1)===0}function FV(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return UV(e,n)}function LV(n,e,t=!1){for(let r=0;r<e.length;r++)if(kV(n,e[r],t))return!0;return!1}function VV(n){for(let e=0;e<n.length;e++){let t=n[e];if(NV(t))return e}return n.length}function UV(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function HS(n,e){return n?":not("+e.trim()+")":e}function jV(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!mr(o)&&(e+=HS(s,i),i=""),r=o,s=s||!mr(r);t++}return i!==""&&(e+=HS(s,i)),e}function BV(n){return n.map(jV).join(",")}function $V(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!mr(i))break;i=s}r++}return{attrs:e,classes:t}}function We(n){return Ll(()=>{let e=jD(n),t=Te(j({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===PD.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Lr.Emulated,styles:n.styles||Qn,_:null,schemas:n.schemas||null,tView:null,id:""});BD(t);let r=n.dependencies;return t.directiveDefs=GS(r,!1),t.pipeDefs=GS(r,!0),t.id=GV(t),t})}function HV(n){return Us(n)||FD(n)}function qV(n){return n!==null}function Ks(n){return Ll(()=>({type:n.type,bootstrap:n.bootstrap||Qn,declarations:n.declarations||Qn,imports:n.imports||Qn,exports:n.exports||Qn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function qS(n,e){if(n==null)return pa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=es.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==es.None?[r,a]:r,e[s]=o):t[s]=r}return t}function ft(n){return Ll(()=>{let e=jD(n);return BD(e),e})}function kD(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Us(n){return n[hV]||null}function FD(n){return n[fV]||null}function LD(n){return n[pV]||null}function VD(n){let e=Us(n)||FD(n)||LD(n);return e!==null?e.standalone:!1}function UD(n,e){let t=n[mV]||null;if(!t&&e===!0)throw new Error(`Type ${Rn(n)} does not have '\u0275mod' property.`);return t}function jD(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||pa,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Qn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qS(n.inputs,e),outputs:qS(n.outputs),debugInfo:null}}function BD(n){n.features?.forEach(e=>e(n))}function GS(n,e){if(!n)return null;let t=e?LD:HV;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(qV)}function GV(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function nt(n){return{\u0275providers:n}}function zV(...n){return{\u0275providers:$D(!0,n),\u0275fromNgModule:!0}}function $D(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return D_(e,o=>{let a=o;Fv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&HD(i,s),t}function HD(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];R_(i,s=>{e(s,r)})}}function Fv(n,e,t,r){if(n=_n(n),!n)return!1;let i=null,s=VS(n),o=!s&&Us(n);if(!s&&!o){let c=n.ngModule;if(s=VS(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)Fv(u,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{D_(s.imports,d=>{Fv(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&HD(u,e)}if(!a){let u=Vs(i)||(()=>new i);e({provide:i,useFactory:u,deps:Qn},i),e({provide:MD,useValue:i,multi:!0},i),e({provide:ma,useValue:()=>oe(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=n;R_(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function R_(n,e){for(let t of n)bD(t)&&(t=t.\u0275providers),Array.isArray(t)?R_(t,e):e(t)}var WV=Xe({provide:String,useValue:Xe});function qD(n){return n!==null&&typeof n=="object"&&WV in n}function KV(n){return!!(n&&n.useExisting)}function QV(n){return!!(n&&n.useFactory)}function ga(n){return typeof n=="function"}function YV(n){return!!n.useClass}var df=new H(""),Nh={},ZV={},wv;function x_(){return wv===void 0&&(wv=new jh),wv}var Zn=class{},Ml=class extends Zn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vv(e,o=>this.processProvider(o)),this.records.set(ND,la(void 0,this)),i.has("environment")&&this.records.set(Zn,la(void 0,this));let s=this.records.get(df);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(MD,Qn,Ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ne(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ne(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Zi(this),r=An(void 0),i;try{return e()}finally{Zi(t),An(r)}}get(e,t=xl,r=Ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(jS))return e[jS](this);r=uf(r);let i,s=Zi(this),o=An(void 0);try{if(!(r&Ie.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=nU(e)&&lf(e);u&&this.injectableDefInScope(u)?c=la(Lv(e),Nh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ie.Self?x_():this.parent;return t=r&Ie.Optional&&t===xl?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Vh]=a[Vh]||[]).unshift(Rn(e)),s)throw a;return bV(a,e,"R3InjectorError",this.source)}else throw a}finally{An(o),Zi(s)}}resolveInjectorInitializers(){let e=Ne(null),t=Zi(this),r=An(void 0),i;try{let s=this.get(ma,Qn,Ie.Self);for(let o of s)o()}finally{Zi(t),An(r),Ne(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Rn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Y(205,!1)}processProvider(e){e=_n(e);let t=ga(e)?e:_n(e&&e.provide),r=XV(e);if(!ga(e)&&e.multi===!0){let i=this.records.get(t);i||(i=la(void 0,Nh,!0),i.factory=()=>Ov(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ne(null);try{return t.value===Nh&&(t.value=ZV,t.value=t.factory()),typeof t.value=="object"&&t.value&&tU(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ne(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=_n(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Lv(n){let e=lf(n),t=e!==null?e.factory:Vs(n);if(t!==null)return t;if(n instanceof H)throw new Y(204,!1);if(n instanceof Function)return JV(n);throw new Y(204,!1)}function JV(n){if(n.length>0)throw new Y(204,!1);let t=uV(n);return t!==null?()=>t.factory(n):()=>new n}function XV(n){if(qD(n))return la(void 0,n.useValue);{let e=GD(n);return la(e,Nh)}}function GD(n,e,t){let r;if(ga(n)){let i=_n(n);return Vs(i)||Lv(i)}else if(qD(n))r=()=>_n(n.useValue);else if(QV(n))r=()=>n.useFactory(...Ov(n.deps||[]));else if(KV(n))r=()=>oe(_n(n.useExisting));else{let i=_n(n&&(n.useClass||n.provide));if(eU(n))r=()=>new i(...Ov(n.deps));else return Vs(i)||Lv(i)}return r}function la(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function eU(n){return!!n.deps}function tU(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function nU(n){return typeof n=="function"||typeof n=="object"&&n instanceof H}function Vv(n,e){for(let t of n)Array.isArray(t)?Vv(t,e):t&&bD(t)?Vv(t.\u0275providers,e):e(t)}function hi(n,e){n instanceof Ml&&n.assertNotDestroyed();let t,r=Zi(n),i=An(void 0);try{return e()}finally{Zi(r),An(i)}}function zD(){return SD()!==void 0||EV()!=null}function hf(n){if(!zD())throw new Y(-203,!1)}function rU(n){return typeof n=="function"}var fi=0,Ee=1,le=2,yn=3,gr=4,vr=5,Bh=6,$h=7,Jn=8,va=9,ci=10,Bt=11,Pl=12,zS=13,Ta=14,Vr=15,_a=16,ua=17,ya=18,ff=19,WD=20,Ji=21,Mh=22,Yn=23,Xn=25,KD=1;var js=7,Hh=8,qh=9,Bn=10,Gh=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Gh||{});function Xi(n){return Array.isArray(n)&&typeof n[KD]=="object"}function pi(n){return Array.isArray(n)&&n[KD]===!0}function QD(n){return(n.flags&4)!==0}function pf(n){return n.componentOffset>-1}function N_(n){return(n.flags&1)===1}function ts(n){return!!n.template}function Uv(n){return(n[le]&512)!==0}var jv=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function YD(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function mi(){return ZD}function ZD(n){return n.type.prototype.ngOnChanges&&(n.setInput=sU),iU}mi.ngInherit=!0;function iU(){let n=XD(this),e=n?.current;if(e){let t=n.previous;if(t===pa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function sU(n,e,t,r,i){let s=this.declaredInputs[r],o=XD(n)||oU(n,{previous:pa,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new jv(u&&u.currentValue,t,c===pa),YD(n,e,i,t)}var JD="__ngSimpleChanges__";function XD(n){return n[JD]||null}function oU(n,e){return n[JD]=e}var WS=null;var kr=function(n,e,t){WS?.(n,e,t)},aU="svg",cU="math";function Ur(n){for(;Array.isArray(n);)n=n[fi];return n}function eA(n,e){return Ur(e[n])}function tr(n,e){return Ur(e[n.index])}function M_(n,e){return n.data[e]}function lU(n,e){return n[e]}function is(n,e){let t=e[n];return Xi(t)?t:t[fi]}function P_(n){return(n[le]&128)===128}function uU(n){return pi(n[yn])}function zh(n,e){return e==null?null:n[e]}function tA(n){n[ua]=0}function nA(n){n[le]&1024||(n[le]|=1024,P_(n)&&gf(n))}function dU(n,e){for(;n>0;)e=e[Ta],n--;return e}function mf(n){return!!(n[le]&9216||n[Yn]?.dirty)}function Bv(n){n[ci].changeDetectionScheduler?.notify(8),n[le]&64&&(n[le]|=1024),mf(n)&&gf(n)}function gf(n){n[ci].changeDetectionScheduler?.notify(0);let e=Bs(n);for(;e!==null&&!(e[le]&8192||(e[le]|=8192,!P_(e)));)e=Bs(e)}function rA(n,e){if((n[le]&256)===256)throw new Y(911,!1);n[Ji]===null&&(n[Ji]=[]),n[Ji].push(e)}function hU(n,e){if(n[Ji]===null)return;let t=n[Ji].indexOf(e);t!==-1&&n[Ji].splice(t,1)}function Bs(n){let e=n[yn];return pi(e)?e[yn]:e}var be={lFrame:hA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var iA=!1;function fU(){return be.lFrame.elementDepthCount}function pU(){be.lFrame.elementDepthCount++}function mU(){be.lFrame.elementDepthCount--}function sA(){return be.bindingsEnabled}function gU(){return be.skipHydrationRootTNode!==null}function vU(n){return be.skipHydrationRootTNode===n}function _U(){be.skipHydrationRootTNode=null}function Ge(){return be.lFrame.lView}function xn(){return be.lFrame.tView}function qt(n){return be.lFrame.contextLView=n,n[Jn]}function Gt(n){return be.lFrame.contextLView=null,n}function Nn(){let n=oA();for(;n!==null&&n.type===64;)n=n.parent;return n}function oA(){return be.lFrame.currentTNode}function yU(){let n=be.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ul(n,e){let t=be.lFrame;t.currentTNode=n,t.isParent=e}function aA(){return be.lFrame.isParent}function wU(){be.lFrame.isParent=!1}function cA(){return iA}function KS(n){iA=n}function O_(){let n=be.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function IU(n){return be.lFrame.bindingIndex=n}function jl(){return be.lFrame.bindingIndex++}function EU(n){let e=be.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function CU(){return be.lFrame.inI18n}function TU(n,e){let t=be.lFrame;t.bindingIndex=t.bindingRootIndex=n,$v(e)}function bU(){return be.lFrame.currentDirectiveIndex}function $v(n){be.lFrame.currentDirectiveIndex=n}function SU(n){let e=be.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function lA(n){be.lFrame.currentQueryIndex=n}function DU(n){let e=n[Ee];return e.type===2?e.declTNode:e.type===1?n[vr]:null}function uA(n,e,t){if(t&Ie.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ie.Host);)if(i=DU(s),i===null||(s=s[Ta],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=be.lFrame=dA();return r.currentTNode=e,r.lView=n,!0}function k_(n){let e=dA(),t=n[Ee];be.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function dA(){let n=be.lFrame,e=n===null?null:n.child;return e===null?hA(n):e}function hA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function fA(){let n=be.lFrame;return be.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var pA=fA;function F_(){let n=fA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function AU(n){return(be.lFrame.contextLView=dU(n,be.lFrame.contextLView))[Jn]}function ba(){return be.lFrame.selectedIndex}function $s(n){be.lFrame.selectedIndex=n}function L_(){let n=be.lFrame;return M_(n.tView,n.selectedIndex)}function RU(){return be.lFrame.currentNamespace}var mA=!0;function V_(){return mA}function U_(n){mA=n}function xU(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=ZD(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function j_(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Ph(n,e,t){gA(n,e,3,t)}function Oh(n,e,t,r){(n[le]&3)===t&&gA(n,e,t,r)}function Iv(n,e){let t=n[le];(t&3)===e&&(t&=16383,t+=1,n[le]=t)}function gA(n,e,t,r){let i=r!==void 0?n[ua]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[ua]+=65536),(a<s||s==-1)&&(NU(n,t,e,c),n[ua]=(n[ua]&4294901760)+c+2),c++}function QS(n,e){kr(4,n,e);let t=Ne(null);try{e.call(n)}finally{Ne(t),kr(5,n,e)}}function NU(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[le]>>14<n[ua]>>16&&(n[le]&3)===e&&(n[le]+=16384,QS(a,s)):QS(a,s)}var fa=-1,Hs=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function MU(n){return n instanceof Hs}function PU(n){return(n.flags&8)!==0}function OU(n){return(n.flags&16)!==0}var Ev={},Hv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=uf(r);let i=this.injector.get(e,Ev,r);return i!==Ev||t===Ev?i:this.parentInjector.get(e,t,r)}};function vA(n){return n!==fa}function Wh(n){return n&32767}function kU(n){return n>>16}function Kh(n,e){let t=kU(n),r=e;for(;t>0;)r=r[Ta],t--;return r}var qv=!0;function Qh(n){let e=qv;return qv=n,e}var FU=256,_A=FU-1,yA=5,LU=0,Fr={};function VU(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Rl)&&(r=t[Rl]),r==null&&(r=t[Rl]=LU++);let i=r&_A,s=1<<i;e.data[n+(i>>yA)]|=s}function Yh(n,e){let t=wA(n,e);if(t!==-1)return t;let r=e[Ee];r.firstCreatePass&&(n.injectorIndex=e.length,Cv(r.data,n),Cv(e,null),Cv(r.blueprint,null));let i=B_(n,e),s=n.injectorIndex;if(vA(i)){let o=Wh(i),a=Kh(i,e),c=a[Ee].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function Cv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function wA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function B_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=bA(i),r===null)return fa;if(t++,i=i[Ta],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return fa}function Gv(n,e,t){VU(n,e,t)}function IA(n,e,t){if(t&Ie.Optional||n!==void 0)return n;S_(e,"NodeInjector")}function EA(n,e,t,r){if(t&Ie.Optional&&r===void 0&&(r=null),!(t&(Ie.Self|Ie.Host))){let i=n[va],s=An(void 0);try{return i?i.get(e,r,t&Ie.Optional):DD(e,r,t&Ie.Optional)}finally{An(s)}}return IA(r,e,t)}function CA(n,e,t,r=Ie.Default,i){if(n!==null){if(e[le]&2048&&!(r&Ie.Self)){let o=HU(n,e,t,r,Fr);if(o!==Fr)return o}let s=TA(n,e,t,r,Fr);if(s!==Fr)return s}return EA(e,t,r,i)}function TA(n,e,t,r,i){let s=BU(t);if(typeof s=="function"){if(!uA(e,n,r))return r&Ie.Host?IA(i,t,r):EA(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ie.Optional))S_(t);else return o}finally{pA()}}else if(typeof s=="number"){let o=null,a=wA(n,e),c=fa,u=r&Ie.Host?e[Vr][vr]:null;for((a===-1||r&Ie.SkipSelf)&&(c=a===-1?B_(n,e):e[a+8],c===fa||!ZS(r,!1)?a=-1:(o=e[Ee],a=Wh(c),e=Kh(c,e)));a!==-1;){let d=e[Ee];if(YS(s,a,d.data)){let f=UU(a,e,t,o,r,u);if(f!==Fr)return f}c=e[a+8],c!==fa&&ZS(r,e[Ee].data[a+8]===u)&&YS(s,a,e)?(o=d,a=Wh(c),e=Kh(c,e)):a=-1}}return i}function UU(n,e,t,r,i,s){let o=e[Ee],a=o.data[n+8],c=r==null?pf(a)&&qv:r!=o&&(a.type&3)!==0,u=i&Ie.Host&&s===a,d=jU(a,o,t,c,u);return d!==null?wa(e,o,d,a):Fr}function jU(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,u=n.directiveEnd,d=s>>20,f=r?a:a+d,m=i?a+d:u;for(let v=f;v<m;v++){let w=o[v];if(v<c&&t===w||v>=c&&w.type===t)return v}if(i){let v=o[c];if(v&&ts(v)&&v.type===t)return c}return null}function wa(n,e,t,r){let i=n[t],s=e.data;if(MU(i)){let o=i;o.resolving&&vV(gV(s[t]));let a=Qh(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?An(o.injectImpl):null,d=uA(n,r,Ie.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&xU(t,s[t],e)}finally{u!==null&&An(u),Qh(a),o.resolving=!1,pA()}}return i}function BU(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Rl)?n[Rl]:void 0;return typeof e=="number"?e>=0?e&_A:$U:e}function YS(n,e,t){let r=1<<n;return!!(t[e+(n>>yA)]&r)}function ZS(n,e){return!(n&Ie.Self)&&!(n&Ie.Host&&e)}var Ls=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return CA(this._tNode,this._lView,e,uf(r),t)}};function $U(){return new Ls(Nn(),Ge())}function _r(n){return Ll(()=>{let e=n.prototype.constructor,t=e[Lh]||zv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Lh]||zv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function zv(n){return ID(n)?()=>{let e=zv(_n(n));return e&&e()}:Vs(n)}function HU(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[le]&2048&&!(o[le]&512);){let a=TA(s,o,t,r|Ie.Self,Fr);if(a!==Fr)return a;let c=s.parent;if(!c){let u=o[WD];if(u){let d=u.get(t,Fr,r);if(d!==Fr)return d}c=bA(o),o=o[Ta]}s=c}return i}function bA(n){let e=n[Ee],t=e.type;return t===2?e.declTNode:t===1?n[vr]:null}function JS(n,e=null,t=null,r){let i=SA(n,e,t,r);return i.resolveInjectorInitializers(),i}function SA(n,e=null,t=null,r,i=new Set){let s=[t||Qn,zV(n)];return r=r||(typeof n=="object"?void 0:Rn(n)),new Ml(s,e||x_(),r||null,i)}var Ae=class n{static{this.THROW_IF_NOT_FOUND=xl}static{this.NULL=new jh}static create(e,t){if(Array.isArray(e))return JS({name:""},t,e,"");{let r=e.name??"";return JS({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=B({token:n,providedIn:"any",factory:()=>oe(ND)})}static{this.__NG_ELEMENT_ID__=-1}};var qU=new H("");qU.__NG_ELEMENT_ID__=n=>{let e=Nn();if(e===null)throw new Y(204,!1);if(e.type&2)return e.value;if(n&Ie.Optional)return null;throw new Y(204,!1)};var GU="ngOriginalError";function Tv(n){return n[GU]}var DA=!0,ss=(()=>{class n{static{this.__NG_ELEMENT_ID__=zU}static{this.__NG_ENV_ID__=t=>t}}return n})(),Wv=class extends ss{constructor(e){super(),this._lView=e}onDestroy(e){return rA(this._lView,e),()=>hU(this._lView,e)}};function zU(){return new Wv(Ge())}var Qs=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Qt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=B({token:n,providedIn:"root",factory:()=>new n})}}return n})();var Kv=class extends ht{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,zD()&&(this.destroyRef=P(ss,{optional:!0})??void 0,this.pendingTasks=P(Qs,{optional:!0})??void 0)}emit(e){let t=Ne(null);try{super.next(e)}finally{Ne(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof yt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Mt=Kv;function Zh(...n){}function AA(n){let e,t;function r(){n=Zh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function XS(n){return queueMicrotask(()=>n()),()=>{n=Zh}}var $_="isAngularZone",Jh=$_+"_ID",WU=0,se=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Mt(!1),this.onMicrotaskEmpty=new Mt(!1),this.onStable=new Mt(!1),this.onError=new Mt(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=DA}=e;if(typeof Zone>"u")throw new Y(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,YU(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get($_)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Y(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Y(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,KU,Zh,Zh);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},KU={};function H_(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function QU(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){AA(()=>{n.callbackScheduled=!1,Qv(n),n.isCheckStableRunning=!0,H_(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Qv(n)}function YU(n){let e=()=>{QU(n)},t=WU++;n._inner=n._inner.fork({name:"angular",properties:{[$_]:!0,[Jh]:t,[Jh+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(ZU(c))return r.invokeTask(s,o,a,c);try{return eD(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),tD(n)}},onInvoke:(r,i,s,o,a,c,u)=>{try{return eD(n),r.invoke(s,o,a,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!JU(c)&&e(),tD(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Qv(n),H_(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Qv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function eD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function tD(n){n._nesting--,H_(n)}var Yv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Mt,this.onMicrotaskEmpty=new Mt,this.onStable=new Mt,this.onError=new Mt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function ZU(n){return RA(n,"__ignore_ng_zone__")}function JU(n){return RA(n,"__scheduler_tick__")}function RA(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var jr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Tv(e);for(;t&&Tv(t);)t=Tv(t);return t||null}},XU=new H("",{providedIn:"root",factory:()=>{let n=P(se),e=P(jr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function e2(){return vf(Nn(),Ge())}function vf(n,e){return new Br(tr(n,e))}var Br=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=e2}}return n})();function xA(n){return(n.flags&128)===128}var NA=new Map,t2=0;function n2(){return t2++}function r2(n){NA.set(n[ff],n)}function Zv(n){NA.delete(n[ff])}var nD="__ngContext__";function qs(n,e){Xi(e)?(n[nD]=e[ff],r2(e)):n[nD]=e}function MA(n){return OA(n[Pl])}function PA(n){return OA(n[gr])}function OA(n){for(;n!==null&&!pi(n);)n=n[gr];return n}var Jv;function kA(n){Jv=n}function i2(){if(Jv!==void 0)return Jv;if(typeof document<"u")return document;throw new Y(210,!1)}var q_=new H("",{providedIn:"root",factory:()=>s2}),s2="ng",G_=new H(""),yr=new H("",{providedIn:"platform",factory:()=>"unknown"});var z_=new H("",{providedIn:"root",factory:()=>i2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var o2="h",a2="b";var c2=()=>null;function W_(n,e,t=!1){return c2(n,e,t)}var FA=!1,l2=new H("",{providedIn:"root",factory:()=>FA});var Xv=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${oV})`}};function K_(n){return n instanceof Xv?n.changingThisBreaksApplicationSecurity:n}function LA(n){return n instanceof Function?n():n}var li=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(li||{}),u2;function Q_(n,e){return u2(n,e)}function da(n,e,t,r,i){if(r!=null){let s,o=!1;pi(r)?s=r:Xi(r)&&(o=!0,r=r[fi]);let a=Ur(r);n===0&&t!==null?i==null?BA(e,t,a):ef(e,t,a,i||null,!0):n===1&&t!==null?ef(e,t,a,i||null,!0):n===2?b2(e,a,o):n===3&&e.destroyNode(a),s!=null&&D2(e,n,s,t,i)}}function d2(n,e){return n.createText(e)}function h2(n,e,t){n.setValue(e,t)}function VA(n,e,t){return n.createElement(e,t)}function f2(n,e){UA(n,e),e[fi]=null,e[vr]=null}function p2(n,e,t,r,i,s){r[fi]=i,r[vr]=e,_f(n,r,t,1,i,s)}function UA(n,e){e[ci].changeDetectionScheduler?.notify(9),_f(n,e,e[Bt],2,null,null)}function m2(n){let e=n[Pl];if(!e)return bv(n[Ee],n);for(;e;){let t=null;if(Xi(e))t=e[Pl];else{let r=e[Bn];r&&(t=r)}if(!t){for(;e&&!e[gr]&&e!==n;)Xi(e)&&bv(e[Ee],e),e=e[yn];e===null&&(e=n),Xi(e)&&bv(e[Ee],e),t=e&&e[gr]}e=t}}function g2(n,e,t,r){let i=Bn+r,s=t.length;r>0&&(t[i-1][gr]=e),r<s-Bn?(e[gr]=t[i],xD(t,Bn+r,e)):(t.push(e),e[gr]=null),e[yn]=t;let o=e[_a];o!==null&&t!==o&&jA(o,e);let a=e[ya];a!==null&&a.insertView(n),Bv(e),e[le]|=128}function jA(n,e){let t=n[qh],r=e[yn];if(Xi(r))n[le]|=Gh.HasTransplantedViews;else{let i=r[yn][Vr];e[Vr]!==i&&(n[le]|=Gh.HasTransplantedViews)}t===null?n[qh]=[e]:t.push(e)}function Y_(n,e){let t=n[qh],r=t.indexOf(e);t.splice(r,1)}function Xh(n,e){if(n.length<=Bn)return;let t=Bn+e,r=n[t];if(r){let i=r[_a];i!==null&&i!==n&&Y_(i,r),e>0&&(n[t-1][gr]=r[gr]);let s=Uh(n,Bn+e);f2(r[Ee],r);let o=s[ya];o!==null&&o.detachView(s[Ee]),r[yn]=null,r[gr]=null,r[le]&=-129}return r}function Z_(n,e){if(!(e[le]&256)){let t=e[Bt];t.destroyNode&&_f(n,e,t,3,null,null),m2(e)}}function bv(n,e){if(e[le]&256)return;let t=Ne(null);try{e[le]&=-129,e[le]|=256,e[Yn]&&Qd(e[Yn]),_2(n,e),v2(n,e),e[Ee].type===1&&e[Bt].destroy();let r=e[_a];if(r!==null&&pi(e[yn])){r!==e[yn]&&Y_(r,e);let i=e[ya];i!==null&&i.detachView(n)}Zv(e)}finally{Ne(t)}}function v2(n,e){let t=n.cleanup,r=e[$h];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[$h]=null);let i=e[Ji];if(i!==null){e[Ji]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function _2(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Hs)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];kr(4,a,c);try{c.call(a)}finally{kr(5,a,c)}}else{kr(4,i,s);try{s.call(i)}finally{kr(5,i,s)}}}}}function y2(n,e,t){return w2(n,e.parent,t)}function w2(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[fi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Lr.None||s===Lr.Emulated)return null}return tr(r,t)}}function ef(n,e,t,r,i){n.insertBefore(e,t,r,i)}function BA(n,e,t){n.appendChild(e,t)}function rD(n,e,t,r,i){r!==null?ef(n,e,t,r,i):BA(n,e,t)}function $A(n,e){return n.parentNode(e)}function I2(n,e){return n.nextSibling(e)}function E2(n,e,t){return T2(n,e,t)}function C2(n,e,t){return n.type&40?tr(n,t):null}var T2=C2,iD;function J_(n,e,t,r){let i=y2(n,r,e),s=e[Bt],o=r.parent||e[vr],a=E2(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)rD(s,i,t[c],a,!1);else rD(s,i,t,a,!1);iD!==void 0&&iD(s,r,e,t,i)}function Dl(n,e){if(e!==null){let t=e.type;if(t&3)return tr(e,n);if(t&4)return e_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Dl(n,r);{let i=n[e.index];return pi(i)?e_(-1,i):Ur(i)}}else{if(t&128)return Dl(n,e.next);if(t&32)return Q_(e,n)()||Ur(n[e.index]);{let r=HA(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Bs(n[Vr]);return Dl(i,r)}else return Dl(n,e.next)}}}return null}function HA(n,e){if(e!==null){let r=n[Vr][vr],i=e.projection;return r.projection[i]}return null}function e_(n,e){let t=Bn+n+1;if(t<e.length){let r=e[t],i=r[Ee].firstChild;if(i!==null)return Dl(r,i)}return e[js]}function b2(n,e,t){n.removeChild(null,e,t)}function X_(n,e,t,r,i,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(o&&e===0&&(a&&qs(Ur(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)X_(n,e,t.child,r,i,s,!1),da(e,n,i,a,s);else if(c&32){let u=Q_(t,r),d;for(;d=u();)da(e,n,i,d,s);da(e,n,i,a,s)}else c&16?S2(n,e,r,t,i,s):da(e,n,i,a,s);t=o?t.projectionNext:t.next}}function _f(n,e,t,r,i,s){X_(t,r,n.firstChild,e,i,s,!1)}function S2(n,e,t,r,i,s){let o=t[Vr],c=o[vr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];da(e,n,i,d,s)}else{let u=c,d=o[yn];xA(r)&&(u.flags|=128),X_(n,e,u,d,i,s,!0)}}function D2(n,e,t,r,i){let s=t[js],o=Ur(t);s!==o&&da(e,n,r,s,i);for(let a=Bn;a<t.length;a++){let c=t[a];_f(c[Ee],c,n,e,r,s)}}function A2(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:li.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=li.Important),n.setStyle(t,r,i,s))}}function R2(n,e,t){n.setAttribute(e,"style",t)}function qA(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function GA(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&kv(n,e,r),i!==null&&qA(n,e,i),s!==null&&R2(n,e,s)}var os={};function k(n=1){zA(xn(),Ge(),ba()+n,!1)}function zA(n,e,t,r){if(!r)if((e[le]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Ph(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Oh(e,s,0,t)}$s(t)}function Se(n,e=Ie.Default){let t=Ge();if(t===null)return oe(n,e);let r=Nn();return CA(r,t,_n(n),e)}function WA(n,e,t,r,i,s){let o=Ne(null);try{let a=null;i&es.SignalBased&&(a=e[r][Pr]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&es.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):YD(e,a,r,s)}finally{Ne(o)}}function x2(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)$s(~i);else{let s=i,o=t[++r],a=t[++r];TU(o,s);let c=e[s];a(2,c)}}}finally{$s(-1)}}function yf(n,e,t,r,i,s,o,a,c,u,d){let f=e.blueprint.slice();return f[fi]=i,f[le]=r|4|128|8|64,(u!==null||n&&n[le]&2048)&&(f[le]|=2048),tA(f),f[yn]=f[Ta]=n,f[Jn]=t,f[ci]=o||n&&n[ci],f[Bt]=a||n&&n[Bt],f[va]=c||n&&n[va]||null,f[vr]=s,f[ff]=n2(),f[Bh]=d,f[WD]=u,f[Vr]=e.type==2?n[Vr]:f,f}function wf(n,e,t,r,i){let s=n.data[e];if(s===null)s=N2(n,e,t,r,i),CU()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=yU();s.injectorIndex=o===null?-1:o.injectorIndex}return Ul(s,!0),s}function N2(n,e,t,r,i){let s=oA(),o=aA(),a=o?s:s&&s.parent,c=n.data[e]=F2(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function KA(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function QA(n,e,t,r,i){let s=ba(),o=r&2;try{$s(-1),o&&e.length>Xn&&zA(n,e,Xn,!1),kr(o?2:0,i),t(r,i)}finally{$s(s),kr(o?3:1,i)}}function YA(n,e,t){if(QD(e)){let r=Ne(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Ne(r)}}}function ZA(n,e,t){sA()&&($2(n,e,t,tr(t,e)),(t.flags&64)===64&&rR(n,e,t))}function JA(n,e,t=tr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function XA(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=ey(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function ey(n,e,t,r,i,s,o,a,c,u,d){let f=Xn+r,m=f+i,v=M2(f,m),w=typeof u=="function"?u():u;return v[Ee]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function M2(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:os);return t}function P2(n,e,t,r){let s=r.get(l2,FA)||t===Lr.ShadowDom,o=n.selectRootElement(e,s);return O2(o),o}function O2(n){k2(n)}var k2=()=>null;function F2(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return gU()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function sD(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=es.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}n===0?oD(r,t,u,a,c):oD(r,t,u,a)}return r}function oD(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function L2(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let f=s[d],m=t?t.get(f):null,v=m?m.inputs:null,w=m?m.outputs:null;c=sD(0,f.inputs,d,c,v),u=sD(1,f.outputs,d,u,w);let M=c!==null&&o!==null&&!A_(e)?X2(c,d,o):null;a.push(M)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function V2(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function eR(n,e,t,r,i,s,o,a){let c=tr(e,t),u=e.inputs,d;!a&&u!=null&&(d=u[r])?(ty(n,t,d,r,i),pf(e)&&U2(t,e.index)):e.type&3?(r=V2(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function U2(n,e){let t=is(e,n);t[le]&16||(t[le]|=64)}function tR(n,e,t,r){if(sA()){let i=r===null?null:{"":-1},s=q2(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&nR(n,e,t,o,i,a),i&&G2(t,r,i)}t.mergedAttrs=Nl(t.mergedAttrs,t.attrs)}function nR(n,e,t,r,i,s){for(let u=0;u<r.length;u++)Gv(Yh(t,e),n,r[u].type);W2(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=KA(n,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];t.mergedAttrs=Nl(t.mergedAttrs,d.hostAttrs),K2(n,t,e,c,d),z2(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}L2(n,t,s)}function j2(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;B2(o)!=a&&o.push(a),o.push(t,r,s)}}function B2(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function $2(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;pf(t)&&Q2(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Yh(t,e),qs(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],u=wa(e,n,a,t);if(qs(u,e),o!==null&&J2(e,a-i,u,c,t,o),ts(c)){let d=is(t.index,e);d[Jn]=wa(e,n,a,t)}}}function rR(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=bU();try{$s(s);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];$v(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&H2(c,u)}}finally{$s(-1),$v(o)}}function H2(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function q2(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(LV(e,o.selectors,!1))if(r||(r=[]),ts(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;t_(n,e,c)}else r.unshift(o),t_(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function t_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function G2(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new Y(-301,!1);r.push(e[i],s)}}}function z2(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;ts(e)&&(t[""]=n)}}function W2(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function K2(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Vs(i.type,!0)),o=new Hs(s,ts(i),Se);n.blueprint[r]=o,t[r]=o,j2(n,e,r,KA(n,t,i.hostVars,os),i)}function Q2(n,e,t){let r=tr(e,n),i=XA(t),s=n[ci].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=If(n,yf(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function Y2(n,e,t,r,i,s){let o=tr(n,e);Z2(e[Bt],o,s,n.value,t,r,i)}function Z2(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?b_(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function J2(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],d=o[a++],f=o[a++];WA(r,t,c,u,d,f)}}function X2(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function iR(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function sR(n,e){let t=n.contentQueries;if(t!==null){let r=Ne(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];lA(s),a.contentQueries(2,e[o],o)}}}finally{Ne(r)}}}function If(n,e){return n[Pl]?n[zS][gr]=e:n[Pl]=e,n[zS]=e,e}function n_(n,e,t){lA(0);let r=Ne(null);try{e(n,t)}finally{Ne(r)}}function ej(n){return n[$h]??=[]}function tj(n){return n.cleanup??=[]}function oR(n,e){let t=n[va],r=t?t.get(jr,null):null;r&&r.handleError(e)}function ty(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],u=e[o],d=n.data[o];WA(d,u,r,a,c,i)}}function nj(n,e,t){let r=eA(e,n);h2(n[Bt],r,t)}function rj(n,e){let t=is(e,n),r=t[Ee];ij(r,t);let i=t[fi];i!==null&&t[Bh]===null&&(t[Bh]=W_(i,t[va])),ny(r,t,t[Jn])}function ij(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ny(n,e,t){k_(e);try{let r=n.viewQuery;r!==null&&n_(1,r,t);let i=n.template;i!==null&&QA(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ya]?.finishViewCreation(n),n.staticContentQueries&&sR(n,e),n.staticViewQueries&&n_(2,n.viewQuery,t);let s=n.components;s!==null&&sj(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[le]&=-5,F_()}}function sj(n,e){for(let t=0;t<e.length;t++)rj(n,e[t])}function aR(n,e,t,r){let i=Ne(null);try{let s=e.tView,a=n[le]&4096?4096:16,c=yf(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[_a]=u;let d=n[ya];return d!==null&&(c[ya]=d.createEmbeddedView(s)),ny(s,c,t),c}finally{Ne(i)}}function oj(n,e){let t=Bn+e;if(t<n.length)return n[t]}function r_(n,e){return!e||e.firstChild===null||xA(n)}function cR(n,e,t,r=!0){let i=e[Ee];if(g2(i,e,n,t),r){let o=e_(t,n),a=e[Bt],c=$A(a,n[js]);c!==null&&p2(i,n[vr],a,e,c,o)}let s=e[Bh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function aj(n,e){let t=Xh(n,e);return t!==void 0&&Z_(t[Ee],t),t}function tf(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(Ur(s)),pi(s)&&cj(s,r);let o=t.type;if(o&8)tf(n,e,t.child,r);else if(o&32){let a=Q_(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=HA(e,t);if(Array.isArray(a))r.push(...a);else{let c=Bs(e[Vr]);tf(c[Ee],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function cj(n,e){for(let t=Bn;t<n.length;t++){let r=n[t],i=r[Ee].firstChild;i!==null&&tf(r[Ee],r,i,e)}n[js]!==n[fi]&&e.push(n[js])}var lR=[];function lj(n){return n[Yn]??uj(n)}function uj(n){let e=lR.pop()??Object.create(hj);return e.lView=n,e}function dj(n){n.lView[Yn]!==n&&(n.lView=null,lR.push(n))}var hj=Te(j({},Wo),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{gf(n.lView)},consumerOnSignalRead(){this.lView[Yn]=this}});function fj(n){let e=n[Yn]??Object.create(pj);return e.lView=n,e}var pj=Te(j({},Wo),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Bs(n.lView);for(;e&&!uR(e[Ee]);)e=Bs(e);e&&nA(e)},consumerOnSignalRead(){this.lView[Yn]=this}});function uR(n){return n.type!==2}var mj=100;function dR(n,e=!0,t=0){let r=n[ci],i=r.rendererFactory,s=!1;s||i.begin?.();try{gj(n,t)}catch(o){throw e&&oR(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function gj(n,e){let t=cA();try{KS(!0),i_(n,e);let r=0;for(;mf(n);){if(r===mj)throw new Y(103,!1);r++,i_(n,1)}}finally{KS(t)}}function vj(n,e,t,r){let i=e[le];if((i&256)===256)return;let s=!1,o=!1;!s&&e[ci].inlineEffectRunner?.flush(),k_(e);let a=!0,c=null,u=null;s||(uR(n)?(u=lj(e),c=yl(u)):Yb()===null?(a=!1,u=fj(e),c=yl(u)):e[Yn]&&(Qd(e[Yn]),e[Yn]=null));try{tA(e),IU(n.bindingStartIndex),t!==null&&QA(n,e,t,2,r);let d=(i&3)===3;if(!s)if(d){let v=n.preOrderCheckHooks;v!==null&&Ph(e,v,null)}else{let v=n.preOrderHooks;v!==null&&Oh(e,v,0,null),Iv(e,0)}if(o||_j(e),hR(e,0),n.contentQueries!==null&&sR(n,e),!s)if(d){let v=n.contentCheckHooks;v!==null&&Ph(e,v)}else{let v=n.contentHooks;v!==null&&Oh(e,v,1),Iv(e,1)}x2(n,e);let f=n.components;f!==null&&pR(e,f,0);let m=n.viewQuery;if(m!==null&&n_(2,m,r),!s)if(d){let v=n.viewCheckHooks;v!==null&&Ph(e,v)}else{let v=n.viewHooks;v!==null&&Oh(e,v,2),Iv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Mh]){for(let v of e[Mh])v();e[Mh]=null}s||(e[le]&=-73)}catch(d){throw s||gf(e),d}finally{u!==null&&(Wd(u,c),a&&dj(u)),F_()}}function hR(n,e){for(let t=MA(n);t!==null;t=PA(t))for(let r=Bn;r<t.length;r++){let i=t[r];fR(i,e)}}function _j(n){for(let e=MA(n);e!==null;e=PA(e)){if(!(e[le]&Gh.HasTransplantedViews))continue;let t=e[qh];for(let r=0;r<t.length;r++){let i=t[r];nA(i)}}}function yj(n,e,t){let r=is(e,n);fR(r,t)}function fR(n,e){P_(n)&&i_(n,e)}function i_(n,e){let r=n[Ee],i=n[le],s=n[Yn],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Kd(s)),o||=!1,s&&(s.dirty=!1),n[le]&=-9217,o)vj(r,n,r.template,n[Jn]);else if(i&8192){hR(n,1);let a=r.components;a!==null&&pR(n,a,1)}}function pR(n,e,t){for(let r=0;r<e.length;r++)yj(n,e[r],t)}function ry(n,e){let t=cA()?64:1088;for(n[ci].changeDetectionScheduler?.notify(e);n;){n[le]|=t;let r=Bs(n);if(Uv(n)&&!r)return n;n=r}return null}var Gs=class{get rootNodes(){let e=this._lView,t=e[Ee];return tf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Jn]}set context(e){this._lView[Jn]=e}get destroyed(){return(this._lView[le]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[yn];if(pi(e)){let t=e[Hh],r=t?t.indexOf(this):-1;r>-1&&(Xh(e,r),Uh(t,r))}this._attachedToViewContainer=!1}Z_(this._lView[Ee],this._lView)}onDestroy(e){rA(this._lView,e)}markForCheck(){ry(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[le]&=-129}reattach(){Bv(this._lView),this._lView[le]|=128}detectChanges(){this._lView[le]|=1024,dR(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Y(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Uv(this._lView),t=this._lView[_a];t!==null&&!e&&Y_(t,this._lView),UA(this._lView[Ee],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Y(902,!1);this._appRef=e;let t=Uv(this._lView),r=this._lView[_a];r!==null&&!t&&jA(r,this._lView),Bv(this._lView)}},iy=(()=>{class n{static{this.__NG_ELEMENT_ID__=Ej}}return n})(),wj=iy,Ij=class extends wj{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=aR(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Gs(i)}};function Ej(){return Cj(Nn(),Ge())}function Cj(n,e){return n.type&4?new Ij(e,n,vf(n,e)):null}var qne=new RegExp(`^(\\d+)*(${a2}|${o2})*(.*)`);var Tj=()=>null;function s_(n,e){return Tj(n,e)}var Ia=class{},Ef=new H("",{providedIn:"root",factory:()=>!1});var mR=new H(""),gR=new H(""),o_=class{},nf=class{};function bj(n){let e=Error(`No component factory found for ${Rn(n)}.`);return e[Sj]=n,e}var Sj="ngComponent";var a_=class{resolveComponentFactory(e){throw bj(e)}},ns=class{static{this.NULL=new a_}},Ea=class{},gi=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>Dj()}}return n})();function Dj(){let n=Ge(),e=Nn(),t=is(e.index,n);return(Xi(t)?t:n)[Bt]}var Aj=(()=>{class n{static{this.\u0275prov=B({token:n,providedIn:"root",factory:()=>null})}}return n})();function c_(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=FS(i,a);else if(s==2){let c=a,u=e[++o];r=FS(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var rf=class extends ns{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Us(e);return new Ol(t,this.ngModule)}};function aD(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let s=Array.isArray(i),o=s?i[0]:i,a=s?i[1]:es.None;e?t.push({propName:o,templateName:r,isSignal:(a&es.SignalBased)!==0}):t.push({propName:o,templateName:r})}return t}function Rj(n){let e=n.toLowerCase();return e==="svg"?aU:e==="math"?cU:null}var Ol=class extends nf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=aD(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return aD(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=BV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Ne(null);try{i=i||this.ngModule;let o=i instanceof Zn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Hv(e,o):e,c=a.get(Ea,null);if(c===null)throw new Y(407,!1);let u=a.get(Aj,null),d=a.get(Ia,null),f={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,changeDetectionScheduler:d},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",w=r?P2(m,r,this.componentDef.encapsulation,a):VA(m,v,Rj(v)),M=512;this.componentDef.signals?M|=4096:this.componentDef.onPush||(M|=16);let R=null;w!==null&&(R=W_(w,a,!0));let L=ey(0,null,null,1,0,null,null,null,null,null,null),q=yf(null,L,null,M,null,null,f,m,a,null,R);k_(q);let W,te,Ye=null;try{let ie=this.componentDef,C,y=null;ie.findHostDirectiveDefs?(C=[],y=new Map,ie.findHostDirectiveDefs(ie,C,y),C.push(ie)):C=[ie];let I=xj(q,w);Ye=Nj(I,w,ie,C,q,f,m),te=M_(L,Xn),w&&Oj(m,ie,w,r),t!==void 0&&kj(te,this.ngContentSelectors,t),W=Pj(Ye,ie,C,y,q,[Fj]),ny(L,q,null)}catch(ie){throw Ye!==null&&Zv(Ye),Zv(q),ie}finally{F_()}return new l_(this.componentType,W,vf(te,q),q,te)}finally{Ne(s)}}},l_=class extends o_{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Gs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;ty(s[Ee],s,i,e,t),this.previousInputValues.set(e,t);let o=is(this._tNode.index,s);ry(o,1)}}get injector(){return new Ls(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function xj(n,e){let t=n[Ee],r=Xn;return n[r]=e,wf(t,r,2,"#host",null)}function Nj(n,e,t,r,i,s,o){let a=i[Ee];Mj(r,n,e,o);let c=null;e!==null&&(c=W_(e,i[va]));let u=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let f=yf(i,XA(t),null,d,i[n.index],n,s,u,null,null,c);return a.firstCreatePass&&t_(a,n,r.length-1),If(i,f),i[n.index]=f}function Mj(n,e,t,r){for(let i of n)e.mergedAttrs=Nl(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(c_(e,e.mergedAttrs,!0),t!==null&&GA(r,t,e))}function Pj(n,e,t,r,i,s){let o=Nn(),a=i[Ee],c=tr(o,i);nR(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let f=o.directiveStart+d,m=wa(i,a,f,o);qs(m,i)}rR(a,i,o),c&&qs(c,i);let u=wa(i,a,o.directiveStart+o.componentOffset,o);if(n[Jn]=i[Jn]=u,s!==null)for(let d of s)d(u,e);return YA(a,o,i),u}function Oj(n,e,t,r){if(r)kv(n,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:s}=$V(e.selectors[0]);i&&kv(n,t,i),s&&s.length>0&&qA(n,t,s.join(" "))}}function kj(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function Fj(){let n=Nn();j_(Ge()[Ee],n)}var Bl=(()=>{class n{static{this.__NG_ELEMENT_ID__=Lj}}return n})();function Lj(){let n=Nn();return Uj(n,Ge())}var Vj=Bl,vR=class extends Vj{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return vf(this._hostTNode,this._hostLView)}get injector(){return new Ls(this._hostTNode,this._hostLView)}get parentInjector(){let e=B_(this._hostTNode,this._hostLView);if(vA(e)){let t=Kh(e,this._hostLView),r=Wh(e),i=t[Ee].data[r+8];return new Ls(i,t)}else return new Ls(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=cD(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Bn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=s_(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,r_(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!rU(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new Ol(Us(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let M=(o?u:this.parentInjector).get(Zn,null);M&&(s=M)}let d=Us(c.componentType??{}),f=s_(this._lContainer,d?.id??null),m=f?.firstChild??null,v=c.create(u,i,m,s);return this.insertImpl(v.hostView,a,r_(this._hostTNode,f)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(uU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[yn],u=new vR(c,c[vr],c[yn]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return cR(o,i,s,r),e.attachToViewContainerRef(),xD(Sv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=cD(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Xh(this._lContainer,t);r&&(Uh(Sv(this._lContainer),t),Z_(r[Ee],r))}detach(e){let t=this._adjustIndex(e,-1),r=Xh(this._lContainer,t);return r&&Uh(Sv(this._lContainer),t)!=null?new Gs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function cD(n){return n[Hh]}function Sv(n){return n[Hh]||(n[Hh]=[])}function Uj(n,e){let t,r=e[n.index];return pi(r)?t=r:(t=iR(r,e,null,n),e[n.index]=t,If(e,t)),Bj(t,e,n,r),new vR(t,n,e)}function jj(n,e){let t=n[Bt],r=t.createComment(""),i=tr(e,n),s=$A(t,i);return ef(t,s,r,I2(t,i),!1),r}var Bj=qj,$j=()=>!1;function Hj(n,e,t){return $j(n,e,t)}function qj(n,e,t,r){if(n[js])return;let i;t.type&8?i=Ur(r):i=jj(e,t),n[js]=i}var lD=new Set;function Ys(n){lD.has(n)||(lD.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function Gj(n){return typeof n=="function"&&n[Pr]!==void 0}function X(n,e){Ys("NgSignals");let t=cS(n),r=t[Pr];return e?.equal&&(r.equal=e.equal),t.set=i=>tv(r,i),t.update=i=>lS(r,i),t.asReadonly=zj.bind(t),t}function zj(){let n=this[Pr];if(n.readonlyFn===void 0){let e=()=>this();e[Pr]=n,n.readonlyFn=e}return n.readonlyFn}function _R(n){return Gj(n)&&typeof n.set=="function"}function Wj(n){return Object.getPrototypeOf(n.prototype).constructor}function Mn(n){let e=Wj(n.type),t=!0,r=[n];for(;e;){let i;if(ts(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Y(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=Ah(n.inputs),o.inputTransforms=Ah(n.inputTransforms),o.declaredInputs=Ah(n.declaredInputs),o.outputs=Ah(n.outputs);let a=i.hostBindings;a&&Jj(n,a);let c=i.viewQuery,u=i.contentQueries;if(c&&Yj(n,c),u&&Zj(n,u),Kj(n,i),cV(n.outputs,i.outputs),ts(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Mn&&(t=!1)}}e=Object.getPrototypeOf(e)}Qj(r)}function Kj(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function Qj(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Nl(i.hostAttrs,t=Nl(t,i.hostAttrs))}}function Ah(n){return n===pa?{}:n===Qn?[]:n}function Yj(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function Zj(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function Jj(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}var rs=class{},kl=class{};var u_=class extends rs{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rf(this);let s=UD(e);this._bootstrapComponents=LA(s.bootstrap),this._r3Injector=SA(e,t,[{provide:rs,useValue:this},{provide:ns,useValue:this.componentFactoryResolver},...r],Rn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},d_=class extends kl{constructor(e){super(),this.moduleType=e}create(e){return new u_(this.moduleType,e,[])}};var sf=class extends rs{constructor(e){super(),this.componentFactoryResolver=new rf(this),this.instance=null;let t=new Ml([...e.providers,{provide:rs,useValue:this},{provide:ns,useValue:this.componentFactoryResolver}],e.parent||x_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function sy(n,e,t=null){return new sf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function yR(n){return eB(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Xj(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function eB(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function wR(n,e,t){return n[e]=t}function ui(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function tB(n,e,t,r){let i=ui(n,e,t);return ui(n,e+1,r)||i}function nB(n){return(n.flags&32)===32}function rB(n,e,t,r,i,s,o,a,c){let u=e.consts,d=wf(e,n,4,o||null,a||null);tR(e,t,d,zh(u,c)),j_(e,d);let f=d.tView=ey(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function iB(n,e,t,r,i,s,o,a,c,u){let d=t+Xn,f=e.firstCreatePass?rB(d,e,n,r,i,s,o,a,c):e.data[d];Ul(f,!1);let m=sB(e,n,f,t);V_()&&J_(e,n,m,f),qs(m,n);let v=iR(m,n,m,f);return n[d]=v,If(n,v),Hj(v,f,n),N_(f)&&ZA(e,n,f),c!=null&&JA(n,f,u),f}function ae(n,e,t,r,i,s,o,a){let c=Ge(),u=xn(),d=zh(u.consts,s);return iB(c,u,n,e,t,r,i,d,o,a),ae}var sB=oB;function oB(n,e,t,r){return U_(!0),e[Bt].createComment("")}var Al=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Al||{}),aB=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=B({token:n,providedIn:"root",factory:()=>new n})}}return n})(),uD=class n{constructor(){this.ngZone=P(se),this.scheduler=P(Ia),this.errorHandler=P(jr,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[Al.EarlyRead,Al.Write,Al.MixedReadWrite,Al.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=B({token:n,providedIn:"root",factory:()=>new n})}};function $l(n,e,t,r){let i=Ge(),s=jl();if(ui(i,s,e)){let o=xn(),a=L_();Y2(a,i,n,e,t,r)}return $l}function cB(n,e,t,r){return ui(n,jl(),t)?e+b_(t)+r:os}function Rh(n,e){return n<<17|e<<2}function zs(n){return n>>17&32767}function lB(n){return(n&2)==2}function uB(n,e){return n&131071|e<<17}function h_(n){return n|2}function Ca(n){return(n&131068)>>2}function Dv(n,e){return n&-131069|e<<2}function dB(n){return(n&1)===1}function f_(n){return n|1}function hB(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=zs(o),c=Ca(o);n[r]=t;let u=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||Vl(f,d)>0)&&(u=!0)}else d=t;if(i)if(c!==0){let m=zs(n[a+1]);n[r+1]=Rh(m,a),m!==0&&(n[m+1]=Dv(n[m+1],r)),n[a+1]=uB(n[a+1],r)}else n[r+1]=Rh(a,0),a!==0&&(n[a+1]=Dv(n[a+1],r)),a=r;else n[r+1]=Rh(c,0),a===0?a=r:n[c+1]=Dv(n[c+1],r),c=r;u&&(n[r+1]=h_(n[r+1])),dD(n,d,r,!0),dD(n,d,r,!1),fB(e,d,n,r,s),o=Rh(a,c),s?e.classBindings=o:e.styleBindings=o}function fB(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&Vl(s,e)>=0&&(t[r+1]=f_(t[r+1]))}function dD(n,e,t,r){let i=n[t+1],s=e===null,o=r?zs(i):Ca(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],u=n[o+1];pB(c,e)&&(a=!0,n[o+1]=r?f_(u):h_(u)),o=r?zs(u):Ca(u)}a&&(n[t+1]=r?h_(i):f_(i))}function pB(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Vl(n,e)>=0:!1}function re(n,e,t){let r=Ge(),i=jl();if(ui(r,i,e)){let s=xn(),o=L_();eR(s,o,r,n,e,r[Bt],t,!1)}return re}function hD(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";ty(n,t,s[o],o,r)}function Cf(n,e,t){return IR(n,e,t,!1),Cf}function Tf(n,e){return IR(n,e,null,!0),Tf}function IR(n,e,t,r){let i=Ge(),s=xn(),o=EU(2);if(s.firstUpdatePass&&gB(s,n,o,r),e!==os&&ui(i,o,e)){let a=s.data[ba()];IB(s,a,i,i[Bt],n,i[o+1]=EB(e,t),r,o)}}function mB(n,e){return e>=n.expandoStartIndex}function gB(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[ba()],o=mB(n,t);CB(s,r)&&e===null&&!o&&(e=!1),e=vB(i,s,e,r),hB(i,s,e,t,o,r)}}function vB(n,e,t,r){let i=SU(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Av(null,n,e,t,r),t=Fl(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=Av(i,n,e,t,r),s===null){let c=_B(n,e,r);c!==void 0&&Array.isArray(c)&&(c=Av(null,n,e,c[1],r),c=Fl(c,e.attrs,r),yB(n,e,r,c))}else s=wB(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function _B(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Ca(r)!==0)return n[zs(r)]}function yB(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[zs(i)]=r}function wB(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=Fl(r,o,t)}return Fl(r,e.attrs,t)}function Av(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=Fl(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Fl(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),AV(n,o,t?!0:e[++s]))}return n===void 0?null:n}function IB(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,u=c[a+1],d=dB(u)?fD(c,e,t,i,Ca(u),o):void 0;if(!of(d)){of(s)||lB(u)&&(s=fD(c,null,t,i,a,o));let f=eA(ba(),t);A2(r,o,f,i,s)}}function fD(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],u=Array.isArray(c),d=u?c[1]:c,f=d===null,m=t[i+1];m===os&&(m=f?Qn:void 0);let v=f?yv(m,r):d===r?m:void 0;if(u&&!of(v)&&(v=yv(c,r)),of(v)&&(a=v,o))return a;let w=n[i+1];i=o?zs(w):Ca(w)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=yv(c,r))}return a}function of(n){return n!==void 0}function EB(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Rn(K_(n)))),n}function CB(n,e){return(n.flags&(e?8:16))!==0}function ge(n,e){Ys("NgControlFlow");let t=Ge(),r=jl(),i=t[r]!==os?t[r]:-1,s=i!==-1?pD(t,Xn+i):void 0,o=0;if(ui(t,r,n)){let a=Ne(null);try{if(s!==void 0&&aj(s,o),n!==-1){let c=Xn+n,u=pD(t,c),d=TB(t[Ee],c),f=s_(u,d.tView.ssrId),m=aR(t,d,e,{dehydratedView:f});cR(u,m,o,r_(d,f))}}finally{Ne(a)}}else if(s!==void 0){let a=oj(s,o);a!==void 0&&(a[Jn]=e)}}function pD(n,e){return n[e]}function TB(n,e){return M_(n,e)}function bB(n,e,t,r,i,s){let o=e.consts,a=zh(o,i),c=wf(e,n,2,r,a);return tR(e,t,c,zh(o,s)),c.attrs!==null&&c_(c,c.attrs,!1),c.mergedAttrs!==null&&c_(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function b(n,e,t,r){let i=Ge(),s=xn(),o=Xn+n,a=i[Bt],c=s.firstCreatePass?bB(o,s,i,e,t,r):s.data[o],u=SB(s,i,c,a,e,n);i[o]=u;let d=N_(c);return Ul(c,!0),GA(a,u,c),!nB(c)&&V_()&&J_(s,i,u,c),fU()===0&&qs(u,i),pU(),d&&(ZA(s,i,c),YA(s,c,i)),r!==null&&JA(i,c),b}function S(){let n=Nn();aA()?wU():(n=n.parent,Ul(n,!1));let e=n;vU(e)&&_U(),mU();let t=xn();return t.firstCreatePass&&(j_(t,n),QD(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&PU(e)&&hD(t,e,Ge(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&OU(e)&&hD(t,e,Ge(),e.stylesWithoutHost,!1),S}function Ce(n,e,t,r){return b(n,e,t,r),S(),Ce}var SB=(n,e,t,r,i,s)=>(U_(!0),VA(r,i,RU()));function Zs(){return Ge()}var Fs=void 0;function DB(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var AB=["en",[["a","p"],["AM","PM"],Fs],[["AM","PM"],Fs,Fs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Fs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Fs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Fs,"{1} 'at' {0}",Fs],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",DB],Rv={};function nr(n){let e=RB(n),t=mD(e);if(t)return t;let r=e.split("-")[0];if(t=mD(r),t)return t;if(r==="en")return AB;throw new Y(701,!1)}function mD(n){return n in Rv||(Rv[n]=Sl.ng&&Sl.ng.common&&Sl.ng.common.locales&&Sl.ng.common.locales[n]),Rv[n]}var Dt=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Dt||{});function RB(n){return n.toLowerCase().replace(/_/g,"-")}var af="en-US";var xB=af;function NB(n){typeof n=="string"&&(xB=n.toLowerCase().replace(/_/g,"-"))}var MB=(n,e,t)=>{};function we(n,e,t,r){let i=Ge(),s=xn(),o=Nn();return ER(s,i,i[Bt],o,n,e,r),we}function PB(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[$h],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function ER(n,e,t,r,i,s,o){let a=N_(r),u=n.firstCreatePass&&tj(n),d=e[Jn],f=ej(e),m=!0;if(r.type&3||o){let M=tr(r,e),R=o?o(M):M,L=f.length,q=o?te=>o(Ur(te[r.index])):r.index,W=null;if(!o&&a&&(W=PB(n,e,i,r.index)),W!==null){let te=W.__ngLastListenerFn__||W;te.__ngNextListenerFn__=s,W.__ngLastListenerFn__=s,m=!1}else{s=vD(r,e,d,s),MB(M,i,s);let te=t.listen(R,i,s);f.push(s,te),u&&u.push(i,q,L,L+1)}}else s=vD(r,e,d,s);let v=r.outputs,w;if(m&&v!==null&&(w=v[i])){let M=w.length;if(M)for(let R=0;R<M;R+=2){let L=w[R],q=w[R+1],Ye=e[L][q].subscribe(s),ie=f.length;f.push(s,Ye),u&&u.push(i,r.index,ie,-(ie+1))}}}function gD(n,e,t,r){let i=Ne(null);try{return kr(6,e,t),t(r)!==!1}catch(s){return oR(n,s),!1}finally{kr(7,e,t),Ne(i)}}function vD(n,e,t,r){return function i(s){if(s===Function)return r;let o=n.componentOffset>-1?is(n.index,e):e;ry(o,5);let a=gD(e,t,r,s),c=i.__ngNextListenerFn__;for(;c;)a=gD(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Z(n=1){return AU(n)}function OB(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function N(n,e=""){let t=Ge(),r=xn(),i=n+Xn,s=r.firstCreatePass?wf(r,i,1,e,null):r.data[i],o=kB(r,t,s,e,n);t[i]=o,V_()&&J_(r,t,o,s),Ul(s,!1)}var kB=(n,e,t,r,i)=>(U_(!0),d2(e[Bt],r));function sn(n){return K("",n,""),sn}function K(n,e,t){let r=Ge(),i=cB(r,n,e,t);return i!==os&&nj(r,ba(),i),K}function vi(n,e,t){_R(e)&&(e=e());let r=Ge(),i=jl();if(ui(r,i,e)){let s=xn(),o=L_();eR(s,o,r,n,e,r[Bt],t,!1)}return vi}function as(n,e){let t=_R(n);return t&&n.set(e),t}function _i(n,e){let t=Ge(),r=xn(),i=Nn();return ER(r,t,t[Bt],i,n,e),_i}function FB(n,e,t){let r=xn();if(r.firstCreatePass){let i=ts(n);p_(t,r.data,r.blueprint,i,!0),p_(e,r.data,r.blueprint,i,!1)}}function p_(n,e,t,r,i){if(n=_n(n),Array.isArray(n))for(let s=0;s<n.length;s++)p_(n[s],e,t,r,i);else{let s=xn(),o=Ge(),a=Nn(),c=ga(n)?n:_n(n.provide),u=GD(n),d=a.providerIndexes&1048575,f=a.directiveStart,m=a.providerIndexes>>20;if(ga(n)||!n.multi){let v=new Hs(u,i,Se),w=Nv(c,e,i?d:d+m,f);w===-1?(Gv(Yh(a,o),s,c),xv(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(v),o.push(v)):(t[w]=v,o[w]=v)}else{let v=Nv(c,e,d+m,f),w=Nv(c,e,d,d+m),M=v>=0&&t[v],R=w>=0&&t[w];if(i&&!R||!i&&!M){Gv(Yh(a,o),s,c);let L=UB(i?VB:LB,t.length,i,r,u);!i&&R&&(t[w].providerFactory=L),xv(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(L),o.push(L)}else{let L=CR(t[i?w:v],u,!i&&r);xv(s,n,v>-1?v:w,L)}!i&&r&&R&&t[w].componentProviders++}}}function xv(n,e,t,r){let i=ga(e),s=YV(e);if(i||s){let c=(s?_n(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[r,c]):u[d+1].push(r,c)}else u.push(t,c)}}}function CR(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Nv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function LB(n,e,t,r){return m_(this.multi,[])}function VB(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=wa(t,t[Ee],this.providerFactory.index,r);s=a.slice(0,o),m_(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],m_(i,s);return s}function m_(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function UB(n,e,t,r,i){let s=new Hs(n,t,Se);return s.multi=[],s.index=e,s.componentProviders=0,CR(s,i,r&&!t),s}function $r(n,e=[]){return t=>{t.providersResolver=(r,i)=>FB(r,i?i(n):n,e)}}var jB=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=$D(!1,t.type),i=r.length>0?sy([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=B({token:n,providedIn:"environment",factory:()=>new n(oe(Zn))})}}return n})();function Ke(n){Ys("NgStandalone"),n.getStandaloneInjector=e=>e.get(jB).getOrCreateStandaloneInjector(n)}function lt(n,e,t,r){return BB(Ge(),O_(),n,e,t,r)}function Sa(n,e,t,r,i){return bR(Ge(),O_(),n,e,t,r,i)}function TR(n,e){let t=n[e];return t===os?void 0:t}function BB(n,e,t,r,i,s){let o=e+t;return ui(n,o,i)?wR(n,o+1,s?r.call(s,i):r(i)):TR(n,o+1)}function bR(n,e,t,r,i,s,o){let a=e+t;return tB(n,a,i,s)?wR(n,a+2,o?r.call(o,i,s):r(i,s)):TR(n,a+2)}function yi(n,e){let t=xn(),r,i=n+Xn;t.firstCreatePass?(r=$B(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Vs(r.type,!0)),o,a=An(Se);try{let c=Qh(!1),u=s();return Qh(c),OB(t,Ge(),i,u),u}finally{An(a)}}function $B(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function wi(n,e,t,r){let i=n+Xn,s=Ge(),o=lU(s,i);return HB(s,i)?bR(s,O_(),e,o.transform,t,r,o):o.transform(t,r)}function HB(n,e){return n[Ee].data[e].pure}var di=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},SR=new di("18.2.13");var bf=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var DR=new H("");function Js(n){return!!n&&typeof n.then=="function"}function AR(n){return!!n&&typeof n.subscribe=="function"}var cs=new H(""),RR=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=P(cs,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(Js(s))t.push(s);else if(AR(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),oy=new H("");function qB(){aS(()=>{throw new Y(600,!1)})}function GB(n){return n.isBoundToModule}var zB=10;function WB(n,e,t){try{let r=t();return Js(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Xs=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(XU),this.afterRenderManager=P(aB),this.zonelessEnabled=P(Ef),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new ht,this.afterTick=new ht,this.componentTypes=[],this.components=[],this.isStable=P(Qs).hasPendingTasks.pipe(Q(t=>!t)),this._injector=P(Zn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof nf;if(!this._injector.get(RR).done){let m=!i&&VD(t),v=!1;throw new Y(405,v)}let o;i?o=t:o=this._injector.get(ns).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=GB(o)?void 0:this._injector.get(rs),c=r||o.selector,u=o.create(Ae.NULL,[],c,a),d=u.location.nativeElement,f=u.injector.get(DR,null);return f?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),kh(this.components,u),f?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new Y(101,!1);let t=Ne(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Ne(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Ea,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<zB;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:s}of this._views)KB(i,s,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>mf(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;kh(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(oy,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>kh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Y(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function kh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function KB(n,e,t,r){if(!t&&!mf(n))return;dR(n,e,t&&!r?0:1)}var g_=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},ay=(()=>{class n{compileModuleSync(t){return new d_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=UD(t),s=LA(i.declarations).reduce((o,a)=>{let c=Us(a);return c&&o.push(new Ol(c)),o},[]);return new g_(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var QB=(()=>{class n{constructor(){this.zone=P(se),this.changeDetectionScheduler=P(Ia),this.applicationRef=P(Xs)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),YB=new H("",{factory:()=>!1});function xR({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new se(Te(j({},MR()),{scheduleInRootZone:t})),[{provide:se,useFactory:n},{provide:ma,multi:!0,useFactory:()=>{let r=P(QB,{optional:!0});return()=>r.initialize()}},{provide:ma,multi:!0,useFactory:()=>{let r=P(ZB);return()=>{r.initialize()}}},e===!0?{provide:mR,useValue:!0}:[],{provide:gR,useValue:t??DA}]}function NR(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=xR({ngZoneFactory:()=>{let i=MR(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Ys("NgZone_CoalesceEvent"),new se(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return nt([{provide:YB,useValue:!0},{provide:Ef,useValue:!1},r])}function MR(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var ZB=(()=>{class n{constructor(){this.subscription=new yt,this.initialized=!1,this.zone=P(se),this.pendingTasks=P(Qs)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{se.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var JB=(()=>{class n{constructor(){this.appRef=P(Xs),this.taskService=P(Qs),this.ngZone=P(se),this.zonelessEnabled=P(Ef),this.disableScheduling=P(mR,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new yt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Jh):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(P(gR,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Yv||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?XS:AA;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Jh+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,XS(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function XB(){return typeof $localize<"u"&&$localize.locale||af}var Sf=new H("",{providedIn:"root",factory:()=>P(Sf,Ie.Optional|Ie.SkipSelf)||XB()});var v_=new H("");function xh(n){return!n.moduleRef}function e$(n){let e=xh(n)?n.r3Injector:n.moduleRef.injector,t=e.get(se);return t.run(()=>{xh(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(jr,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:s=>{r.handleError(s)}})}),xh(n)){let s=()=>e.destroy(),o=n.platformInjector.get(v_);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(v_);o.add(s),n.moduleRef.onDestroy(()=>{kh(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return WB(r,t,()=>{let s=e.get(RR);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(Sf,af);if(NB(o||af),xh(n)){let a=e.get(Xs);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return t$(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function t$(n,e){let t=n.injector.get(Xs);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Y(-403,!1);e.push(n)}var Fh=null;function n$(n=[],e){return Ae.create({name:e,providers:[{provide:df,useValue:"platform"},{provide:v_,useValue:new Set([()=>Fh=null])},...n]})}function r$(n=[]){if(Fh)return Fh;let e=n$(n);return Fh=e,qB(),i$(e),e}function i$(n){n.get(G_,null)?.forEach(t=>t())}var ls=(()=>{class n{static{this.__NG_ELEMENT_ID__=s$}}return n})();function s$(n){return o$(Nn(),Ge(),(n&16)===16)}function o$(n,e,t){if(pf(n)&&!t){let r=is(n.index,e);return new Gs(r,r)}else if(n.type&175){let r=e[Vr];return new Gs(r,e)}return null}var __=class{constructor(){}supports(e){return yR(e)}create(e){return new y_(e)}},a$=(n,e)=>e,y_=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||a$}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<_D(r,i,s)?t:r,a=_D(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,d=c-i;if(u!=d){for(let m=0;m<u;m++){let v=m<s.length?s[m]:s[m]=0,w=v+m;d<=w&&w<u&&(s[m]=v+1)}let f=o.previousIndex;s[f]=d-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!yR(e))throw new Y(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Xj(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new w_(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new cf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new cf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},w_=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},I_=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},cf=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new I_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function _D(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function yD(){return new cy([new __])}var cy=(()=>{class n{static{this.\u0275prov=B({token:n,providedIn:"root",factory:yD})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||yD()),deps:[[n,new RD,new ue]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Y(901,!1)}}return n})();function PR(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=r$(r),s=[xR({}),{provide:Ia,useExisting:JB},...t||[]],o=new sf({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return e$({r3Injector:o.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function Hl(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Pe(n,e){Ys("NgSignals");let t=iS(n);return e?.equal&&(t[Pr].equal=e.equal),t}function rr(n){let e=Ne(null);try{return n()}finally{Ne(e)}}var c$=new H("",{providedIn:"root",factory:()=>P(l$)}),l$=(()=>{class n{static{this.\u0275prov=B({token:n,providedIn:"root",factory:()=>new E_})}}return n})(),E_=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=P(Qs),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),this.taskId===null){let t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){let t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},C_=class{constructor(e,t,r,i,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=r,this.injector=s,this.watcher=dS(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(jr,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function Ii(n,e){Ys("NgSignals"),!e?.injector&&hf(Ii);let t=e?.injector??P(Ae),r=e?.manualCleanup!==!0?t.get(ss):null,i=new C_(t.get(c$),n,typeof Zone>"u"?null:Zone.current,r,t,e?.allowSignalWrites??!1),s=t.get(ls,null,{optional:!0});return!s||!(s._lView[le]&8)?i.watcher.notify():(s._lView[Mh]??=[]).push(i.watcher.notify),i}var UR=null;function Ti(){return UR}function jR(n){UR??=n}var kf=class{};var sr=new H(""),BR=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(h$),providedIn:"platform"})}}return n})();var h$=(()=>{class n extends BR{constructor(){super(),this._doc=P(sr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ti().getBaseHref(this._doc)}onPopState(t){let r=Ti().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Ti().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function $R(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function OR(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function eo(n){return n&&n[0]!=="?"?"?"+n:n}var Vf=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(HR),providedIn:"root"})}}return n})(),f$=new H(""),HR=(()=>{class n extends Vf{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??P(sr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return $R(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+eo(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+eo(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+eo(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(oe(BR),oe(f$,8))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ql=(()=>{class n{constructor(t){this._subject=new Mt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=g$(OR(kR(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+eo(r))}normalize(t){return n.stripTrailingSlash(m$(this._basePath,kR(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+eo(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+eo(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=eo}static{this.joinWithSlash=$R}static{this.stripTrailingSlash=OR}static{this.\u0275fac=function(r){return new(r||n)(oe(Vf))}}static{this.\u0275prov=B({token:n,factory:()=>p$(),providedIn:"root"})}}return n})();function p$(){return new ql(oe(Vf))}function m$(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function kR(n){return n.replace(/\/index.html$/,"")}function g$(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var wn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(wn||{}),et=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(et||{}),$n=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}($n||{}),us={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function v$(n){return nr(n)[Dt.LocaleId]}function _$(n,e,t){let r=nr(n),i=[r[Dt.DayPeriodsFormat],r[Dt.DayPeriodsStandalone]],s=ir(i,e);return ir(s,t)}function y$(n,e,t){let r=nr(n),i=[r[Dt.DaysFormat],r[Dt.DaysStandalone]],s=ir(i,e);return ir(s,t)}function w$(n,e,t){let r=nr(n),i=[r[Dt.MonthsFormat],r[Dt.MonthsStandalone]],s=ir(i,e);return ir(s,t)}function I$(n,e){let r=nr(n)[Dt.Eras];return ir(r,e)}function Df(n,e){let t=nr(n);return ir(t[Dt.DateFormat],e)}function Af(n,e){let t=nr(n);return ir(t[Dt.TimeFormat],e)}function Rf(n,e){let r=nr(n)[Dt.DateTimeFormat];return ir(r,e)}function Uf(n,e){let t=nr(n),r=t[Dt.NumberSymbols][e];if(typeof r>"u"){if(e===us.CurrencyDecimal)return t[Dt.NumberSymbols][us.Decimal];if(e===us.CurrencyGroup)return t[Dt.NumberSymbols][us.Group]}return r}function qR(n){if(!n[Dt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Dt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function E$(n){let e=nr(n);return qR(e),(e[Dt.ExtraData][2]||[]).map(r=>typeof r=="string"?ly(r):[ly(r[0]),ly(r[1])])}function C$(n,e,t){let r=nr(n);qR(r);let i=[r[Dt.ExtraData][0],r[Dt.ExtraData][1]],s=ir(i,e)||[];return ir(s,t)||[]}function ir(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function ly(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var T$=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,xf={},b$=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Ci=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(Ci||{}),He=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(He||{}),$e=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}($e||{});function S$(n,e,t,r){let i=k$(n);e=Ei(t,e)||e;let o=[],a;for(;e;)if(a=b$.exec(e),a){o=o.concat(a.slice(1));let d=o.pop();if(!d)break;e=d}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=zR(r,c),i=O$(i,r,!0));let u="";return o.forEach(d=>{let f=M$(d);u+=f?f(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Ff(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Ei(n,e){let t=v$(n);if(xf[t]??={},xf[t][e])return xf[t][e];let r="";switch(e){case"shortDate":r=Df(n,$n.Short);break;case"mediumDate":r=Df(n,$n.Medium);break;case"longDate":r=Df(n,$n.Long);break;case"fullDate":r=Df(n,$n.Full);break;case"shortTime":r=Af(n,$n.Short);break;case"mediumTime":r=Af(n,$n.Medium);break;case"longTime":r=Af(n,$n.Long);break;case"fullTime":r=Af(n,$n.Full);break;case"short":let i=Ei(n,"shortTime"),s=Ei(n,"shortDate");r=Nf(Rf(n,$n.Short),[i,s]);break;case"medium":let o=Ei(n,"mediumTime"),a=Ei(n,"mediumDate");r=Nf(Rf(n,$n.Medium),[o,a]);break;case"long":let c=Ei(n,"longTime"),u=Ei(n,"longDate");r=Nf(Rf(n,$n.Long),[c,u]);break;case"full":let d=Ei(n,"fullTime"),f=Ei(n,"fullDate");r=Nf(Rf(n,$n.Full),[d,f]);break}return r&&(xf[t][e]=r),r}function Nf(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function wr(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function D$(n,e){return wr(n,3).substring(0,e)}function Pt(n,e,t=0,r=!1,i=!1){return function(s,o){let a=A$(n,s);if((t>0||a>-t)&&(a+=t),n===He.Hours)a===0&&t===-12&&(a=12);else if(n===He.FractionalSeconds)return D$(a,e);let c=Uf(o,us.MinusSign);return wr(a,e,c,r,i)}}function A$(n,e){switch(n){case He.FullYear:return e.getFullYear();case He.Month:return e.getMonth();case He.Date:return e.getDate();case He.Hours:return e.getHours();case He.Minutes:return e.getMinutes();case He.Seconds:return e.getSeconds();case He.FractionalSeconds:return e.getMilliseconds();case He.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function rt(n,e,t=wn.Format,r=!1){return function(i,s){return R$(i,s,n,e,t,r)}}function R$(n,e,t,r,i,s){switch(t){case $e.Months:return w$(e,i,r)[n.getMonth()];case $e.Days:return y$(e,i,r)[n.getDay()];case $e.DayPeriods:let o=n.getHours(),a=n.getMinutes();if(s){let u=E$(e),d=C$(e,i,r),f=u.findIndex(m=>{if(Array.isArray(m)){let[v,w]=m,M=o>=v.hours&&a>=v.minutes,R=o<w.hours||o===w.hours&&a<w.minutes;if(v.hours<w.hours){if(M&&R)return!0}else if(M||R)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(f!==-1)return d[f]}return _$(e,i,r)[o<12?0:1];case $e.Eras:return I$(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function Mf(n){return function(e,t,r){let i=-1*r,s=Uf(t,us.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case Ci.Short:return(i>=0?"+":"")+wr(o,2,s)+wr(Math.abs(i%60),2,s);case Ci.ShortGMT:return"GMT"+(i>=0?"+":"")+wr(o,1,s);case Ci.Long:return"GMT"+(i>=0?"+":"")+wr(o,2,s)+":"+wr(Math.abs(i%60),2,s);case Ci.Extended:return r===0?"Z":(i>=0?"+":"")+wr(o,2,s)+":"+wr(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var x$=0,Of=4;function N$(n){let e=Ff(n,x$,1).getDay();return Ff(n,0,1+(e<=Of?Of:Of+7)-e)}function GR(n){let e=n.getDay(),t=e===0?-3:Of-e;return Ff(n.getFullYear(),n.getMonth(),n.getDate()+t)}function uy(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{let s=GR(t),o=N$(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return wr(i,n,Uf(r,us.MinusSign))}}function Pf(n,e=!1){return function(t,r){let s=GR(t).getFullYear();return wr(s,n,Uf(r,us.MinusSign),e)}}var dy={};function M$(n){if(dy[n])return dy[n];let e;switch(n){case"G":case"GG":case"GGG":e=rt($e.Eras,et.Abbreviated);break;case"GGGG":e=rt($e.Eras,et.Wide);break;case"GGGGG":e=rt($e.Eras,et.Narrow);break;case"y":e=Pt(He.FullYear,1,0,!1,!0);break;case"yy":e=Pt(He.FullYear,2,0,!0,!0);break;case"yyy":e=Pt(He.FullYear,3,0,!1,!0);break;case"yyyy":e=Pt(He.FullYear,4,0,!1,!0);break;case"Y":e=Pf(1);break;case"YY":e=Pf(2,!0);break;case"YYY":e=Pf(3);break;case"YYYY":e=Pf(4);break;case"M":case"L":e=Pt(He.Month,1,1);break;case"MM":case"LL":e=Pt(He.Month,2,1);break;case"MMM":e=rt($e.Months,et.Abbreviated);break;case"MMMM":e=rt($e.Months,et.Wide);break;case"MMMMM":e=rt($e.Months,et.Narrow);break;case"LLL":e=rt($e.Months,et.Abbreviated,wn.Standalone);break;case"LLLL":e=rt($e.Months,et.Wide,wn.Standalone);break;case"LLLLL":e=rt($e.Months,et.Narrow,wn.Standalone);break;case"w":e=uy(1);break;case"ww":e=uy(2);break;case"W":e=uy(1,!0);break;case"d":e=Pt(He.Date,1);break;case"dd":e=Pt(He.Date,2);break;case"c":case"cc":e=Pt(He.Day,1);break;case"ccc":e=rt($e.Days,et.Abbreviated,wn.Standalone);break;case"cccc":e=rt($e.Days,et.Wide,wn.Standalone);break;case"ccccc":e=rt($e.Days,et.Narrow,wn.Standalone);break;case"cccccc":e=rt($e.Days,et.Short,wn.Standalone);break;case"E":case"EE":case"EEE":e=rt($e.Days,et.Abbreviated);break;case"EEEE":e=rt($e.Days,et.Wide);break;case"EEEEE":e=rt($e.Days,et.Narrow);break;case"EEEEEE":e=rt($e.Days,et.Short);break;case"a":case"aa":case"aaa":e=rt($e.DayPeriods,et.Abbreviated);break;case"aaaa":e=rt($e.DayPeriods,et.Wide);break;case"aaaaa":e=rt($e.DayPeriods,et.Narrow);break;case"b":case"bb":case"bbb":e=rt($e.DayPeriods,et.Abbreviated,wn.Standalone,!0);break;case"bbbb":e=rt($e.DayPeriods,et.Wide,wn.Standalone,!0);break;case"bbbbb":e=rt($e.DayPeriods,et.Narrow,wn.Standalone,!0);break;case"B":case"BB":case"BBB":e=rt($e.DayPeriods,et.Abbreviated,wn.Format,!0);break;case"BBBB":e=rt($e.DayPeriods,et.Wide,wn.Format,!0);break;case"BBBBB":e=rt($e.DayPeriods,et.Narrow,wn.Format,!0);break;case"h":e=Pt(He.Hours,1,-12);break;case"hh":e=Pt(He.Hours,2,-12);break;case"H":e=Pt(He.Hours,1);break;case"HH":e=Pt(He.Hours,2);break;case"m":e=Pt(He.Minutes,1);break;case"mm":e=Pt(He.Minutes,2);break;case"s":e=Pt(He.Seconds,1);break;case"ss":e=Pt(He.Seconds,2);break;case"S":e=Pt(He.FractionalSeconds,1);break;case"SS":e=Pt(He.FractionalSeconds,2);break;case"SSS":e=Pt(He.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Mf(Ci.Short);break;case"ZZZZZ":e=Mf(Ci.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Mf(Ci.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Mf(Ci.Long);break;default:return null}return dy[n]=e,e}function zR(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function P$(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function O$(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),s=zR(e,i);return P$(n,r*(s-i))}function k$(n){if(FR(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return Ff(i,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(T$))return F$(r)}let e=new Date(n);if(!FR(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function F$(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,u),e}function FR(n){return n instanceof Date&&!isNaN(n.valueOf())}function WR(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var hy=/\s+/,LR=[],It=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=LR,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(hy):LR}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(hy):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(hy).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(Se(Br),Se(gi))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();var fy=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Hr=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new fy(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),VR(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);VR(s,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(Se(Bl),Se(iy),Se(cy))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function VR(n,e){n.context.$implicit=e.item}function L$(n,e){return new Y(2100,!1)}var V$="mediumDate",U$=new H(""),j$=new H(""),Da=(()=>{class n{constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let o=r??this.defaultOptions?.dateFormat??V$,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return S$(t,o,s||this.locale,a)}catch(o){throw L$(n,o.message)}}static{this.\u0275fac=function(r){return new(r||n)(Se(Sf,16),Se(U$,24),Se(j$,24))}}static{this.\u0275pipe=kD({name:"date",type:n,pure:!0,standalone:!0})}}return n})();var py="browser",B$="server";function my(n){return n===py}function gy(n){return n===B$}var Lf=class{};var yy=class extends kf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},wy=class n extends yy{static makeCurrent(){jR(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=$$();return t==null?null:H$(t)}resetBaseElement(){Gl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return WR(document.cookie,e)}},Gl=null;function $$(){return Gl=Gl||document.querySelector("base"),Gl?Gl.getAttribute("href"):null}function H$(n){return new URL(n,document.baseURI).pathname}var q$=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})(),Iy=new H(""),ZR=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new Y(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(oe(Iy),oe(se))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})(),jf=class{constructor(e){this._doc=e}},vy="ng-app-id",JR=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=gy(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${vy}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(vy),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(vy,this.appId),t.appendChild(o),o}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(oe(sr),oe(q_),oe(z_,8),oe(yr))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})(),_y={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Cy=/%COMP%/g,XR="%COMP%",G$=`_nghost-${XR}`,z$=`_ngcontent-${XR}`,W$=!0,K$=new H("",{providedIn:"root",factory:()=>W$});function Q$(n){return z$.replace(Cy,n)}function Y$(n){return G$.replace(Cy,n)}function ex(n,e){return e.map(t=>t.replace(Cy,n))}var KR=(()=>{class n{constructor(t,r,i,s,o,a,c,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=gy(a),this.defaultRenderer=new zl(t,o,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Lr.ShadowDom&&(r=Te(j({},r),{encapsulation:Lr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Bf?i.applyToHost(t):i instanceof Wl&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Lr.Emulated:s=new Bf(c,u,r,this.appId,d,o,a,f);break;case Lr.ShadowDom:return new Ey(c,u,t,r,o,a,this.nonce,f);default:s=new Wl(c,u,r,d,o,a,f);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(oe(ZR),oe(JR),oe(q_),oe(K$),oe(sr),oe(yr),oe(se),oe(z_))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})(),zl=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(_y[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(QR(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(QR(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Y(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=_y[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=_y[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(li.DashCase|li.Important)?e.style.setProperty(t,r,i&li.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&li.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Ti().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function QR(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Ey=class extends zl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=ex(i.id,i.styles);for(let d of u){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Wl=class extends zl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?ex(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Bf=class extends Wl{constructor(e,t,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,u),this.contentAttr=Q$(u),this.hostAttr=Y$(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Z$=(()=>{class n extends jf{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(oe(sr))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})(),YR=["alt","control","meta","shift"],J$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},X$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},eH=(()=>{class n extends jf{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ti().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),YR.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),o+=u+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=J$[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),YR.forEach(o=>{if(o!==i){let a=X$[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(oe(sr))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac})}}return n})();function tx(n,e){return PR(j({rootComponent:n},tH(e)))}function tH(n){return{appProviders:[...oH,...n?.providers??[]],platformProviders:sH}}function nH(){wy.makeCurrent()}function rH(){return new jr}function iH(){return kA(document),document}var sH=[{provide:yr,useValue:py},{provide:G_,useValue:nH,multi:!0},{provide:sr,useFactory:iH,deps:[]}];var oH=[{provide:df,useValue:"root"},{provide:jr,useFactory:rH,deps:[]},{provide:Iy,useClass:Z$,multi:!0,deps:[sr,se,yr]},{provide:Iy,useClass:eH,multi:!0,deps:[sr]},KR,JR,ZR,{provide:Ea,useExisting:KR},{provide:Lf,useClass:q$,deps:[]},[]];var $f=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(oe(sr))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var _e="primary",du=Symbol("RouteTitle"),Ay=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Pa(n){return new Ay(n)}function aH(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function cH(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!qr(n[t],e[t]))return!1;return!0}function qr(n,e){let t=n?Ry(n):void 0,r=e?Ry(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!ux(n[i],e[i]))return!1;return!0}function Ry(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function ux(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function dx(n){return n.length>0?n[n.length-1]:null}function ds(n){return hv(n)?n:Js(n)?ct(Promise.resolve(n)):ne(n)}var lH={exact:fx,subset:px},hx={exact:uH,subset:dH,ignored:()=>!0};function rx(n,e,t){return lH[t.paths](n.root,e.root,t.matrixParams)&&hx[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function uH(n,e){return qr(n,e)}function fx(n,e,t){if(!no(n.segments,e.segments)||!Gf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!fx(n.children[r],e.children[r],t))return!1;return!0}function dH(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>ux(n[t],e[t]))}function px(n,e,t){return mx(n,e,e.segments,t)}function mx(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!no(i,t)||e.hasChildren()||!Gf(i,t,r))}else if(n.segments.length===t.length){if(!no(n.segments,t)||!Gf(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!px(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!no(n.segments,i)||!Gf(n.segments,i,r)||!n.children[_e]?!1:mx(n.children[_e],e,s,r)}}function Gf(n,e,t){return e.every((r,i)=>hx[t](n[i].parameters,r.parameters))}var Si=class{constructor(e=new qe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Pa(this.queryParams),this._queryParamMap}toString(){return pH.serialize(this)}},qe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zf(this)}},to=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Pa(this.parameters),this._parameterMap}toString(){return vx(this)}};function hH(n,e){return no(n,e)&&n.every((t,r)=>qr(t.parameters,e[r].parameters))}function no(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function fH(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===_e&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==_e&&(t=t.concat(e(i,r)))}),t}var ew=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>new eu,providedIn:"root"})}}return n})(),eu=class{parse(e){let t=new Ny(e);return new Si(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Kl(e.root,!0)}`,r=vH(e.queryParams),i=typeof e.fragment=="string"?`#${mH(e.fragment)}`:"";return`${t}${r}${i}`}},pH=new eu;function zf(n){return n.segments.map(e=>vx(e)).join("/")}function Kl(n,e){if(!n.hasChildren())return zf(n);if(e){let t=n.children[_e]?Kl(n.children[_e],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==_e&&r.push(`${i}:${Kl(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=fH(n,(r,i)=>i===_e?[Kl(n.children[_e],!1)]:[`${i}:${Kl(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[_e]!=null?`${zf(n)}/${t[0]}`:`${zf(n)}/(${t.join("//")})`}}function gx(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hf(n){return gx(n).replace(/%3B/gi,";")}function mH(n){return encodeURI(n)}function xy(n){return gx(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wf(n){return decodeURIComponent(n)}function ix(n){return Wf(n.replace(/\+/g,"%20"))}function vx(n){return`${xy(n.path)}${gH(n.parameters)}`}function gH(n){return Object.entries(n).map(([e,t])=>`;${xy(e)}=${xy(t)}`).join("")}function vH(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Hf(t)}=${Hf(i)}`).join("&"):`${Hf(t)}=${Hf(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var _H=/^[^\/()?;#]+/;function Ty(n){let e=n.match(_H);return e?e[0]:""}var yH=/^[^\/()?;=#]+/;function wH(n){let e=n.match(yH);return e?e[0]:""}var IH=/^[^=?&#]+/;function EH(n){let e=n.match(IH);return e?e[0]:""}var CH=/^[^&#]+/;function TH(n){let e=n.match(CH);return e?e[0]:""}var Ny=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new qe([],{}):new qe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[_e]=new qe(e,t)),r}parseSegment(){let e=Ty(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Y(4009,!1);return this.capture(e),new to(Wf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=wH(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Ty(this.remaining);i&&(r=i,this.capture(r))}e[Wf(t)]=Wf(r)}parseQueryParam(e){let t=EH(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=TH(this.remaining);o&&(r=o,this.capture(r))}let i=ix(t),s=ix(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ty(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Y(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=_e);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[_e]:new qe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Y(4011,!1)}};function _x(n){return n.segments.length>0?new qe([],{[_e]:n}):n}function yx(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=yx(i);if(r===_e&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new qe(n.segments,e);return bH(t)}function bH(n){if(n.numberOfChildren===1&&n.children[_e]){let e=n.children[_e];return new qe(n.segments.concat(e.segments),e.children)}return n}function tu(n){return n instanceof Si}function SH(n,e,t=null,r=null){let i=wx(n);return Ix(i,e,t,r)}function wx(n){let e;function t(s){let o={};for(let c of s.children){let u=t(c);o[c.outlet]=u}let a=new qe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=_x(r);return e??i}function Ix(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return by(i,i,i,t,r);let s=DH(e);if(s.toRoot())return by(i,i,new qe([],{}),t,r);let o=AH(s,i,n),a=o.processChildren?Zl(o.segmentGroup,o.index,s.commands):Cx(o.segmentGroup,o.index,s.commands);return by(i,o.segmentGroup,a,t,r)}function Kf(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function nu(n){return typeof n=="object"&&n!=null&&n.outlets}function by(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let o;n===e?o=t:o=Ex(n,e,t);let a=_x(yx(o));return new Si(a,s,i)}function Ex(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Ex(s,e,t)}),new qe(n.segments,r)}var Qf=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Kf(r[0]))throw new Y(4003,!1);let i=r.find(nu);if(i&&i!==dx(r))throw new Y(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function DH(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Qf(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Qf(t,e,r)}var xa=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function AH(n,e,t){if(n.isAbsolute)return new xa(e,!0,0);if(!t)return new xa(e,!1,NaN);if(t.parent===null)return new xa(t,!0,0);let r=Kf(n.commands[0])?0:1,i=t.segments.length-1+r;return RH(t,i,n.numberOfDoubleDots)}function RH(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Y(4005,!1);i=r.segments.length}return new xa(r,!1,i-s)}function xH(n){return nu(n[0])?n[0].outlets:{[_e]:n}}function Cx(n,e,t){if(n??=new qe([],{}),n.segments.length===0&&n.hasChildren())return Zl(n,e,t);let r=NH(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new qe(n.segments.slice(0,r.pathIndex),{});return s.children[_e]=new qe(n.segments.slice(r.pathIndex),n.children),Zl(s,0,i)}else return r.match&&i.length===0?new qe(n.segments,{}):r.match&&!n.hasChildren()?My(n,e,t):r.match?Zl(n,0,i):My(n,e,t)}function Zl(n,e,t){if(t.length===0)return new qe(n.segments,{});{let r=xH(t),i={};if(Object.keys(r).some(s=>s!==_e)&&n.children[_e]&&n.numberOfChildren===1&&n.children[_e].segments.length===0){let s=Zl(n.children[_e],e,t);return new qe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Cx(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new qe(n.segments,i)}}function NH(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(nu(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!ox(c,u,o))return s;r+=2}else{if(!ox(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function My(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(nu(s)){let c=MH(s.outlets);return new qe(r,c)}if(i===0&&Kf(t[0])){let c=n.segments[e];r.push(new to(c.path,sx(t[0]))),i++;continue}let o=nu(s)?s.outlets[_e]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Kf(a)?(r.push(new to(o,sx(a))),i+=2):(r.push(new to(o,{})),i++)}return new qe(r,{})}function MH(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=My(new qe([],{}),0,r))}),e}function sx(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function ox(n,e,t){return n==t.path&&qr(e,t.parameters)}var Jl="imperative",Zt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Zt||{}),or=class{constructor(e,t){this.id=e,this.url=t}},ru=class extends or{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Zt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ro=class extends or{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Zt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},qn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(qn||{}),Py=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Py||{}),bi=class extends or{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Zt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},io=class extends or{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Zt.NavigationSkipped}},iu=class extends or{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Zt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yf=class extends or{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Zt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oy=class extends or{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Zt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ky=class extends or{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Zt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Fy=class extends or{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Zt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ly=class extends or{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Zt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vy=class{constructor(e){this.route=e,this.type=Zt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Uy=class{constructor(e){this.route=e,this.type=Zt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},jy=class{constructor(e){this.snapshot=e,this.type=Zt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},By=class{constructor(e){this.snapshot=e,this.type=Zt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$y=class{constructor(e){this.snapshot=e,this.type=Zt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},su=class{constructor(e){this.snapshot=e,this.type=Zt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ou=class{},Oa=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function PH(n,e){return n.providers&&!n._injector&&(n._injector=sy(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Ir(n){return n.outlet||_e}function OH(n,e){let t=n.filter(r=>Ir(r)===e);return t.push(...n.filter(r=>Ir(r)!==e)),t}function hu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Hy=class{get injector(){return hu(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new rp(this.rootInjector),this.attachRef=null}},rp=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Hy(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(oe(Zn))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Zf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=qy(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=qy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Gy(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Gy(e,this._root).map(t=>t.value)}};function qy(n,e){if(n===e.value)return e;for(let t of e.children){let r=qy(n,t);if(r)return r}return null}function Gy(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Gy(n,t);if(r.length)return r.unshift(e),r}return[]}var Hn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ra(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Jf=class extends Zf{constructor(e,t){super(e),this.snapshot=t,tw(this,e)}toString(){return this.snapshot.toString()}};function Tx(n){let e=kH(n),t=new Qt([new to("",{})]),r=new Qt({}),i=new Qt({}),s=new Qt({}),o=new Qt(""),a=new ka(t,r,s,o,i,_e,n,e.root);return a.snapshot=e.root,new Jf(new Hn(a,[]),e)}function kH(n){let e={},t={},r={},i="",s=new Na([],e,r,i,t,_e,n,null,{});return new ep("",new Hn(s,[]))}var ka=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Q(u=>u[du]))??ne(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Q(e=>Pa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Q(e=>Pa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Xf(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:j(j({},e.params),n.params),data:j(j({},e.data),n.data),resolve:j(j(j(j({},n.data),e.data),i?.data),n._resolvedData)}:r={params:j({},n.params),data:j({},n.data),resolve:j(j({},n.data),n._resolvedData??{})},i&&Sx(i)&&(r.resolve[du]=i.title),r}var Na=class{get title(){return this.data?.[du]}constructor(e,t,r,i,s,o,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Pa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Pa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ep=class extends Zf{constructor(e,t){super(t),this.url=e,tw(this,t)}toString(){return bx(this._root)}};function tw(n,e){e.value._routerState=n,e.children.forEach(t=>tw(n,t))}function bx(n){let e=n.children.length>0?` { ${n.children.map(bx).join(", ")} } `:"";return`${n.value}${e}`}function Sy(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,qr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),qr(e.params,t.params)||n.paramsSubject.next(t.params),cH(e.url,t.url)||n.urlSubject.next(t.url),qr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function zy(n,e){let t=qr(n.params,e.params)&&hH(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||zy(n.parent,e.parent))}function Sx(n){return typeof n.title=="string"||n.title===null}var nw=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=_e,this.activateEvents=new Mt,this.deactivateEvents=new Mt,this.attachEvents=new Mt,this.detachEvents=new Mt,this.parentContexts=P(rp),this.location=P(Bl),this.changeDetector=P(ls),this.inputBinder=P(rw,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Y(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Y(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Y(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Y(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Wy(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=ft({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[mi]})}}return n})(),Wy=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ka?this.route:e===rp?this.childContexts:this.parent.get(e,t)}},rw=new H("");function FH(n,e,t){let r=au(n,e._root,t?t._root:void 0);return new Jf(r,e)}function au(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=LH(n,e,t);return new Hn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>au(n,a)),o}}let r=VH(e.value),i=e.children.map(s=>au(n,s));return new Hn(r,i)}}function LH(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return au(n,r,i);return au(n,r)})}function VH(n){return new ka(new Qt(n.url),new Qt(n.params),new Qt(n.queryParams),new Qt(n.fragment),new Qt(n.data),n.outlet,n.component,n)}var cu=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Dx="ngNavigationCancelingError";function tp(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=tu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Ax(!1,qn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Ax(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Dx]=!0,t.cancellationCode=e,t}function UH(n){return Rx(n)&&tu(n.url)}function Rx(n){return!!n&&n[Dx]}var jH=(n,e,t,r)=>Q(i=>(new Ky(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Ky=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Sy(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new su(s.value.snapshot))}),e.children.length&&this.forwardEvent(new By(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Sy(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Sy(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},np=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ma=class{constructor(e,t){this.component=e,this.route=t}};function BH(n,e,t){let r=n._root,i=e?e._root:null;return Ql(r,i,t,[r.value])}function $H(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function La(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!ED(n)?n:e.get(n):r}function Ql(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ra(e);return n.children.forEach(o=>{HH(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Xl(a,t.getContext(o),i)),i}function HH(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=qH(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new np(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ql(n,e,a?a.children:null,r,i):Ql(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ma(a.outlet.component,o))}else o&&Xl(e,a,i),i.canActivateChecks.push(new np(r)),s.component?Ql(n,null,a?a.children:null,r,i):Ql(n,null,t,r,i);return i}function qH(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!no(n.url,e.url);case"pathParamsOrQueryParamsChange":return!no(n.url,e.url)||!qr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zy(n,e)||!qr(n.queryParams,e.queryParams);case"paramsChange":default:return!zy(n,e)}}function Xl(n,e,t){let r=Ra(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Xl(o,e.children.getContext(s),t):Xl(o,null,t):Xl(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ma(e.outlet.component,i)):t.canDeactivateChecks.push(new Ma(null,i)):t.canDeactivateChecks.push(new Ma(null,i))}function fu(n){return typeof n=="function"}function GH(n){return typeof n=="boolean"}function zH(n){return n&&fu(n.canLoad)}function WH(n){return n&&fu(n.canActivate)}function KH(n){return n&&fu(n.canActivateChild)}function QH(n){return n&&fu(n.canDeactivate)}function YH(n){return n&&fu(n.canMatch)}function xx(n){return n instanceof oi||n?.name==="EmptyError"}var qf=Symbol("INITIAL_VALUE");function Fa(){return Dn(n=>Je(n.map(e=>e.pipe(ai(1),ca(qf)))).pipe(Q(e=>{for(let t of e)if(t!==!0){if(t===qf)return qf;if(t===!1||ZH(t))return t}return!0}),vn(e=>e!==qf),ai(1)))}function ZH(n){return tu(n)||n instanceof cu}function JH(n,e){return St(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ne(Te(j({},t),{guardsResult:!0})):XH(o,r,i,n).pipe(St(a=>a&&GH(a)?eq(r,s,n,e):ne(a)),Q(a=>Te(j({},t),{guardsResult:a})))})}function XH(n,e,t,r){return ct(n).pipe(St(i=>sq(i.component,i.route,t,e,r)),Or(i=>i!==!0,!0))}function eq(n,e,t,r){return ct(e).pipe(ks(i=>oa(nq(i.route.parent,r),tq(i.route,r),iq(n,i.path,t),rq(n,i.route,t))),Or(i=>i!==!0,!0))}function tq(n,e){return n!==null&&e&&e(new $y(n)),ne(!0)}function nq(n,e){return n!==null&&e&&e(new jy(n)),ne(!0)}function rq(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ne(!0);let i=r.map(s=>Eh(()=>{let o=hu(e)??t,a=La(s,o),c=WH(a)?a.canActivate(e,n):hi(o,()=>a(e,n));return ds(c).pipe(Or())}));return ne(i).pipe(Fa())}function iq(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>$H(o)).filter(o=>o!==null).map(o=>Eh(()=>{let a=o.guards.map(c=>{let u=hu(o.node)??t,d=La(c,u),f=KH(d)?d.canActivateChild(r,n):hi(u,()=>d(r,n));return ds(f).pipe(Or())});return ne(a).pipe(Fa())}));return ne(s).pipe(Fa())}function sq(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ne(!0);let o=s.map(a=>{let c=hu(e)??i,u=La(a,c),d=QH(u)?u.canDeactivate(n,e,t,r):hi(c,()=>u(n,e,t,r));return ds(d).pipe(Or())});return ne(o).pipe(Fa())}function oq(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ne(!0);let s=i.map(o=>{let a=La(o,n),c=zH(a)?a.canLoad(e,t):hi(n,()=>a(e,t));return ds(c)});return ne(s).pipe(Fa(),Nx(r))}function Nx(n){return nh(jt(e=>{if(typeof e!="boolean")throw tp(n,e)}),Q(e=>e===!0))}function aq(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ne(!0);let s=i.map(o=>{let a=La(o,n),c=YH(a)?a.canMatch(e,t):hi(n,()=>a(e,t));return ds(c)});return ne(s).pipe(Fa(),Nx(r))}var lu=class{constructor(e){this.segmentGroup=e||null}},uu=class extends Error{constructor(e){super(),this.urlTree=e}};function Aa(n){return sa(new lu(n))}function cq(n){return sa(new Y(4e3,!1))}function lq(n){return sa(Ax(!1,qn.GuardRejected))}var Qy=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ne(r);if(i.numberOfChildren>1||!i.children[_e])return cq(`${e.redirectTo}`);i=i.children[_e]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,params:v,data:w,title:M}=i,R=hi(s,()=>a({params:v,data:w,queryParams:c,fragment:u,routeConfig:d,url:f,outlet:m,title:M}));if(R instanceof Si)throw new uu(R);t=R}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new uu(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Si(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new qe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Y(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Yy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function uq(n,e,t,r,i){let s=Mx(n,e,t);return s.matched?(r=PH(e,r),aq(r,e,t,i).pipe(Q(o=>o===!0?s:j({},Yy)))):ne(s)}function Mx(n,e,t){if(e.path==="**")return dq(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?j({},Yy):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||aH)(t,n,e);if(!i)return j({},Yy);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?j(j({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function dq(n){return{matched:!0,parameters:n.length>0?dx(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function ax(n,e,t,r){return t.length>0&&pq(n,t,r)?{segmentGroup:new qe(e,fq(r,new qe(t,n.children))),slicedSegments:[]}:t.length===0&&mq(n,t,r)?{segmentGroup:new qe(n.segments,hq(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new qe(n.segments,n.children),slicedSegments:t}}function hq(n,e,t,r){let i={};for(let s of t)if(ip(n,e,s)&&!r[Ir(s)]){let o=new qe([],{});i[Ir(s)]=o}return j(j({},r),i)}function fq(n,e){let t={};t[_e]=e;for(let r of n)if(r.path===""&&Ir(r)!==_e){let i=new qe([],{});t[Ir(r)]=i}return t}function pq(n,e,t){return t.some(r=>ip(n,e,r)&&Ir(r)!==_e)}function mq(n,e,t){return t.some(r=>ip(n,e,r))}function ip(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function gq(n,e,t){return e.length===0&&!n.children[t]}var Zy=class{};function vq(n,e,t,r,i,s,o="emptyOnly"){return new Jy(n,e,t,r,i,o,s).recognize()}var _q=31,Jy=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Qy(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Y(4002,`'${e.segmentGroup}'`)}recognize(){let e=ax(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Q(({children:t,rootSnapshot:r})=>{let i=new Hn(r,t),s=new ep("",i),o=SH(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Na([],Object.freeze({}),Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),_e,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,_e,t).pipe(Q(r=>({children:r,rootSnapshot:t})),Qi(r=>{if(r instanceof uu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof lu?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(Q(o=>o instanceof Hn?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return ct(s).pipe(ks(o=>{let a=r.children[o],c=OH(t,o);return this.processSegmentGroup(e,c,a,o,i)}),Sh((o,a)=>(o.push(...a),o)),Yi(null),_v(),St(o=>{if(o===null)return Aa(r);let a=Px(o);return yq(a),ne(a)}))}processSegment(e,t,r,i,s,o,a){return ct(t).pipe(ks(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(Qi(u=>{if(u instanceof lu)return ne(null);throw u}))),Or(c=>!!c),Qi(c=>{if(xx(c))return gq(r,i,s)?ne(new Zy):Aa(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return Ir(r)!==o&&(o===_e||!ip(i,s,r))?Aa(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):Aa(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:f,remainingSegments:m}=Mx(t,i,s);if(!c)return Aa(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>_q&&(this.allowRedirects=!1));let v=new Na(s,u,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,cx(i),Ir(i),i.component??i._loadedComponent??null,i,lx(i)),w=Xf(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(w.params),v.data=Object.freeze(w.data);let M=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,v,e);return this.applyRedirects.lineralizeSegments(i,M).pipe(St(R=>this.processSegment(e,r,t,R.concat(m),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=uq(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Dn(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Dn(({routes:u})=>{let d=r._loadedInjector??e,{parameters:f,consumedSegments:m,remainingSegments:v}=c,w=new Na(m,f,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,cx(r),Ir(r),r.component??r._loadedComponent??null,r,lx(r)),M=Xf(w,o,this.paramsInheritanceStrategy);w.params=Object.freeze(M.params),w.data=Object.freeze(M.data);let{segmentGroup:R,slicedSegments:L}=ax(t,m,v,u);if(L.length===0&&R.hasChildren())return this.processChildren(d,u,R,w).pipe(Q(W=>new Hn(w,W)));if(u.length===0&&L.length===0)return ne(new Hn(w,[]));let q=Ir(r)===s;return this.processSegment(d,u,R,L,q?_e:s,!0,w).pipe(Q(W=>new Hn(w,W instanceof Hn?[W]:[])))}))):Aa(t)))}getChildConfig(e,t,r){return t.children?ne({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ne({routes:t._loadedRoutes,injector:t._loadedInjector}):oq(e,t,r,this.urlSerializer).pipe(St(i=>i?this.configLoader.loadChildren(e,t).pipe(jt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):lq(t))):ne({routes:[],injector:e})}};function yq(n){n.sort((e,t)=>e.value.outlet===_e?-1:t.value.outlet===_e?1:e.value.outlet.localeCompare(t.value.outlet))}function wq(n){let e=n.value.routeConfig;return e&&e.path===""}function Px(n){let e=[],t=new Set;for(let r of n){if(!wq(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Px(r.children);e.push(new Hn(r.value,i))}return e.filter(r=>!t.has(r))}function cx(n){return n.data||{}}function lx(n){return n.resolve||{}}function Iq(n,e,t,r,i,s){return St(o=>vq(n,e,t,r,o.extractedUrl,i,s).pipe(Q(({state:a,tree:c})=>Te(j({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function Eq(n,e){return St(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ne(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of Ox(c))o.add(u);let a=0;return ct(o).pipe(ks(c=>s.has(c)?Cq(c,r,n,e):(c.data=Xf(c,c.parent,n).resolve,ne(void 0))),jt(()=>a++),aa(1),St(c=>a===o.size?ne(t):jn))})}function Ox(n){let e=n.children.map(t=>Ox(t)).flat();return[n,...e]}function Cq(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Sx(i)&&(s[du]=i.title),Tq(s,n,e,r).pipe(Q(o=>(n._resolvedData=o,n.data=Xf(n,n.parent,t).resolve,null)))}function Tq(n,e,t,r){let i=Ry(n);if(i.length===0)return ne({});let s={};return ct(i).pipe(St(o=>bq(n[o],e,t,r).pipe(Or(),jt(a=>{if(a instanceof cu)throw tp(new eu,a);s[o]=a}))),aa(1),gv(s),Qi(o=>xx(o)?jn:sa(o)))}function bq(n,e,t,r){let i=hu(e)??r,s=La(n,i),o=s.resolve?s.resolve(e,t):hi(i,()=>s(e,t));return ds(o)}function Dy(n){return Dn(e=>{let t=n(e);return t?ct(t).pipe(Q(()=>e)):ne(e)})}var kx=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===_e);return r}getResolvedTitleForRoute(t){return t.data[du]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(Sq),providedIn:"root"})}}return n})(),Sq=(()=>{class n extends kx{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(oe($f))}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),iw=new H("",{providedIn:"root",factory:()=>({})}),sw=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=We({type:n,selectors:[["ng-component"]],standalone:!0,features:[Ke],decls:1,vars:0,template:function(r,i){r&1&&Ce(0,"router-outlet")},dependencies:[nw],encapsulation:2})}}return n})();function ow(n){let e=n.children&&n.children.map(ow),t=e?Te(j({},n),{children:e}):j({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==_e&&(t.component=sw),t}var aw=new H(""),Dq=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(ay)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ne(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=ds(t.loadComponent()).pipe(Q(Fx),jt(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),bl(()=>{this.componentLoaders.delete(t)})),i=new ea(r,()=>new ht).pipe(Xo());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ne({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=Aq(r,this.compiler,t,this.onLoadEndListener).pipe(bl(()=>{this.childrenLoaders.delete(r)})),o=new ea(s,()=>new ht).pipe(Xo());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Aq(n,e,t,r){return ds(n.loadChildren()).pipe(Q(Fx),St(i=>i instanceof kl||Array.isArray(i)?ne(i):ct(e.compileModuleAsync(i))),Q(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(aw,[],{optional:!0,self:!0}).flat()),{routes:o.map(ow),injector:s}}))}function Rq(n){return n&&typeof n=="object"&&"default"in n}function Fx(n){return Rq(n)?n.default:n}var cw=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(xq),providedIn:"root"})}}return n})(),xq=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Nq=new H("");var Mq=new H(""),Pq=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ht,this.transitionAbortSubject=new ht,this.configLoader=P(Dq),this.environmentInjector=P(Zn),this.urlSerializer=P(ew),this.rootContexts=P(rp),this.location=P(ql),this.inputBindingEnabled=P(rw,{optional:!0})!==null,this.titleStrategy=P(kx),this.options=P(iw,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(cw),this.createViewTransition=P(Nq,{optional:!0}),this.navigationErrorHandler=P(Mq,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ne(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Vy(i)),r=i=>this.events.next(new Uy(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Te(j(j({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Qt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Jl,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(vn(s=>s.id!==0),Q(s=>Te(j({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Dn(s=>{let o=!1,a=!1;return ne(s).pipe(Dn(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",qn.SupersededByNewNavigation),jn;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Te(j({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&d!=="reload"){let f="";return this.events.next(new io(c.id,this.urlSerializer.serialize(c.rawUrl),f,Py.IgnoredSameUrlNavigation)),c.resolve(!1),jn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return ne(c).pipe(Dn(f=>{let m=this.transitions?.getValue();return this.events.next(new ru(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),m!==this.transitions?.getValue()?jn:Promise.resolve(f)}),Iq(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),jt(f=>{s.targetSnapshot=f.targetSnapshot,s.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation=Te(j({},this.currentNavigation),{finalUrl:f.urlAfterRedirects});let m=new Yf(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:f,extractedUrl:m,source:v,restoredState:w,extras:M}=c,R=new ru(f,this.urlSerializer.serialize(m),v,w);this.events.next(R);let L=Tx(this.rootComponentType).snapshot;return this.currentTransition=s=Te(j({},c),{targetSnapshot:L,urlAfterRedirects:m,extras:Te(j({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,ne(s)}else{let f="";return this.events.next(new io(c.id,this.urlSerializer.serialize(c.extractedUrl),f,Py.IgnoredByUrlHandlingStrategy)),c.resolve(!1),jn}}),jt(c=>{let u=new Oy(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),Q(c=>(this.currentTransition=s=Te(j({},c),{guards:BH(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),JH(this.environmentInjector,c=>this.events.next(c)),jt(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw tp(this.urlSerializer,c.guardsResult);let u=new ky(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),vn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",qn.GuardRejected),!1)),Dy(c=>{if(c.guards.canActivateChecks.length)return ne(c).pipe(jt(u=>{let d=new Fy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Dn(u=>{let d=!1;return ne(u).pipe(Eq(this.paramsInheritanceStrategy,this.environmentInjector),jt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",qn.NoDataFromResolver)}}))}),jt(u=>{let d=new Ly(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),Dy(c=>{let u=d=>{let f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe(jt(m=>{d.component=m}),Q(()=>{})));for(let m of d.children)f.push(...u(m));return f};return Je(u(c.targetSnapshot.root)).pipe(Yi(null),ai(1))}),Dy(()=>this.afterPreactivation()),Dn(()=>{let{currentSnapshot:c,targetSnapshot:u}=s,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?ct(d).pipe(Q(()=>s)):ne(s)}),Q(c=>{let u=FH(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=Te(j({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),jt(()=>{this.events.next(new ou)}),jH(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),ai(1),jt({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ro(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),Ht(this.transitionAbortSubject.pipe(jt(c=>{throw c}))),bl(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",qn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Qi(c=>{if(a=!0,Rx(c))this.events.next(new bi(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),UH(c)?this.events.next(new Oa(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let u=new iu(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let d=hi(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(d instanceof cu){let{message:f,cancellationCode:m}=tp(this.urlSerializer,d);this.events.next(new bi(s.id,this.urlSerializer.serialize(s.extractedUrl),f,m)),this.events.next(new Oa(d.redirectTo,d.navigationBehaviorOptions))}else{this.events.next(u);let f=t.errorHandler(c);s.resolve(!!f)}}catch(d){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(d)}}return jn}))}))}cancelNavigationTransition(t,r,i){let s=new bi(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Oq(n){return n!==Jl}var kq=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(Fq),providedIn:"root"})}}return n})(),Xy=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Fq=(()=>{class n extends Xy{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Lx=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:()=>P(Lq),providedIn:"root"})}}return n})(),Lq=(()=>{class n extends Lx{constructor(){super(...arguments),this.location=P(ql),this.urlSerializer=P(ew),this.options=P(iw,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(cw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Si,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Tx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ru)this.stateMemento=this.createStateMemento();else if(t instanceof io)this.rawUrlTree=r.initialUrl;else if(t instanceof Yf){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof ou?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof bi&&(t.code===qn.GuardRejected||t.code===qn.NoDataFromResolver)?this.restoreHistory(r):t instanceof iu?this.restoreHistory(r,!0):t instanceof ro&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Si?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=j(j({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=j(j({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Yl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Yl||{});function Vq(n,e){n.events.pipe(vn(t=>t instanceof ro||t instanceof bi||t instanceof iu||t instanceof io),Q(t=>t instanceof ro||t instanceof io?Yl.COMPLETE:(t instanceof bi?t.code===qn.Redirect||t.code===qn.SupersededByNewNavigation:!1)?Yl.REDIRECTING:Yl.FAILED),vn(t=>t!==Yl.REDIRECTING),ai(1)).subscribe(()=>{e()})}function Uq(n){throw n}var jq={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Bq={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},sp=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=P(bf),this.stateManager=P(Lx),this.options=P(iw,{optional:!0})||{},this.pendingTasks=P(Qs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(Pq),this.urlSerializer=P(ew),this.location=P(ql),this.urlHandlingStrategy=P(cw),this._events=new ht,this.errorHandler=this.options.errorHandler||Uq,this.navigated=!1,this.routeReuseStrategy=P(kq),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(aw,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(rw,{optional:!0}),this.eventsSubscription=new yt,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof bi&&r.code!==qn.Redirect&&r.code!==qn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ro)this.navigated=!0;else if(r instanceof Oa){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=j({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Oq(i.source)},o);this.scheduleNavigation(a,Jl,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Hq(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Jl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=j({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ow),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=j(j({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let m=i?i.snapshot:this.routerState.snapshot.root;f=wx(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return Ix(f,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=tu(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Jl,null,r)}navigate(t,r={skipLocationChange:!1}){return $q(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=j({},jq):r===!1?i=j({},Bq):i=r,tu(t))return rx(this.currentUrlTree,t,i);let s=this.parseUrl(t);return rx(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,u;o?(a=o.resolve,c=o.reject,u=o.promise):u=new Promise((f,m)=>{a=f,c=m});let d=this.pendingTasks.add();return Vq(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function $q(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Y(4008,!1)}function Hq(n){return!(n instanceof ou)&&!(n instanceof Oa)}var qq=new H("");function Vx(n,...e){return nt([{provide:aw,multi:!0,useValue:n},[],{provide:ka,useFactory:Gq,deps:[sp]},{provide:oy,multi:!0,useFactory:zq},e.map(t=>t.\u0275providers)])}function Gq(n){return n.routerState.root}function zq(){let n=P(Ae);return e=>{let t=n.get(Xs);if(e!==t.components[0])return;let r=n.get(sp),i=n.get(Wq);n.get(Kq)===1&&r.initialNavigation(),n.get(Qq,null,Ie.Optional)?.setUpPreloading(),n.get(qq,null,Ie.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Wq=new H("",{factory:()=>new ht}),Kq=new H("",{providedIn:"root",factory:()=>1});var Qq=new H("");var Ux=[];var Zq="firebase",Jq="10.14.1";J(Zq,Jq,"app");var st=new di("ANGULARFIRE2_VERSION"),Ua=n=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this
context. Rather than injecting ${n} in the constructor, first ensure that ${n} is supported by calling
\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${n})\`.`;function Ot(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var At=(n,e)=>{let t=e?[e]:qd(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Pn=class{constructor(){return At(Xq)}},Xq="app-check";function Va(){}var op=class{zone;delegate;constructor(e,t=uv){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},lw=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Va,{},Va,Va)),t.pipe(jt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Et=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new op(Zone.current)),this.insideAngular=t.run(()=>new op(Zone.current,ia)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(oe(se))};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ap(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function eG(n){return ap().ngZone.runOutsideAngular(()=>n())}function so(n){return ap().ngZone.run(()=>n())}function tG(n){return nG(ap())(n)}function nG(n){return function(t){return t=t.lift(new lw(n.ngZone)),t.pipe(Ki(n.outsideAngular),Wi(n.insideAngular))}}var rG=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),so(()=>n.apply(void 0,r))},Ue=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=so(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Va,{},Va,Va))),r[s]=rG(r[s],t));let i=eG(()=>n.apply(this,r));if(!e)if(i instanceof he){let s=ap();return i.pipe(Ki(s.outsideAngular),Wi(s.insideAngular))}else return so(()=>i);return i instanceof he?i.pipe(tG):i instanceof Promise?so(()=>new Promise((s,o)=>i.then(a=>so(()=>s(a)),a=>so(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:so(()=>i)};var ot=class{constructor(e){return e}},pt=class{constructor(){return qd()}};function iG(n){return n&&n.length===1?n[0]:new ot(Nt())}var uw=new H("angularfire2._apps"),sG={provide:ot,useFactory:iG,deps:[[new ue,uw]]},oG={provide:pt,deps:[[new ue,uw]]};function aG(n){return(e,t)=>{let r=t.get(yr);J("angularfire",st.full,"core"),J("angularfire",st.full,"app"),J("angular",SR.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new ot(i)}}function jx(n,...e){return nt([sG,oG,{provide:uw,useFactory:aG(n),multi:!0,deps:[se,Ae,Et,...e]}])}var Bx=Ue(Wb,!0);function nN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var rN=nN,iN=new xr("auth","Firebase",nN());var fp=new Mr("@firebase/auth");function cG(n,...e){fp.logLevel<=rn.WARN&&fp.warn(`Auth (${bn}): ${n}`,...e)}function lp(n,...e){fp.logLevel<=rn.ERROR&&fp.error(`Auth (${bn}): ${n}`,...e)}function fs(n,...e){throw xw(n,...e)}function ao(n,...e){return xw(n,...e)}function sN(n,e,t){let r=Object.assign(Object.assign({},rN()),{[e]:t});return new xr("auth","Firebase",r).create(e,{appName:n.name})}function oo(n){return sN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xw(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return iN.create(n,...e)}function de(n,e,...t){if(!n)throw xw(e,...t)}function Di(n){let e="INTERNAL ASSERTION FAILED: "+n;throw lp(e),new Error(e)}function ps(n,e){n||Di(e)}function pw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function lG(){return $x()==="http:"||$x()==="https:"}function $x(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function uG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lG()||ul()||"connection"in navigator)?navigator.onLine:!0}function dG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var co=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,ps(t>e,"Short delay should be less than long delay!"),this.isMobile=ll()||Bd()}get(){return uG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Nw(n,e){ps(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var pp=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var hG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var fG=new co(3e4,6e4);function Mw(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ba(s,o,a,c){return _(this,arguments,function*(n,e,t,r,i={}){return oN(n,i,()=>_(this,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let f=xs(Object.assign({key:n.config.apiKey},d)).slice(1),m=yield n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);let v=Object.assign({method:e,headers:m},u);return Vb()||(v.referrerPolicy="no-referrer"),pp.fetch()(aN(n,n.config.apiHost,t,f),v)}))})}function oN(n,e,t){return _(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},hG),e);try{let i=new mw(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw cp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw cp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw cp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw cp(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw sN(n,d,u);fs(n,d)}}catch(i){if(i instanceof Tn)throw i;fs(n,"network-request-failed",{message:String(i)})}})}function pG(s,o,a,c){return _(this,arguments,function*(n,e,t,r,i={}){let u=yield Ba(n,e,t,r,i);return"mfaPendingCredential"in u&&fs(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function aN(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Nw(n.config,i):`${n.config.apiScheme}://${i}`}var mw=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ao(this.auth,"network-request-failed")),fG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function cp(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ao(n,e,r);return i.customData._tokenResponse=t,i}function mG(n,e){return _(this,null,function*(){return Ba(n,"POST","/v1/accounts:delete",e)})}function cN(n,e){return _(this,null,function*(){return Ba(n,"POST","/v1/accounts:lookup",e)})}function pu(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Pw(n,e=!1){return _(this,null,function*(){let t=xe(n),r=yield t.getIdToken(e),i=Ow(r);de(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:pu(dw(i.auth_time)),issuedAtTime:pu(dw(i.iat)),expirationTime:pu(dw(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function dw(n){return Number(n)*1e3}function Ow(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return lp("JWT malformed, contained fewer than 3 sections"),null;try{let i=kb(t);return i?JSON.parse(i):(lp("Failed to decode base64 JWT payload"),null)}catch(i){return lp("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Hx(n){let e=Ow(n);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function gu(n,e,t=!1){return _(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Tn&&gG(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function gG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var gw=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>_(this,null,function*(){yield this.iteration()}),t)}iteration(){return _(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var vu=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function mp(n){return _(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield gu(n,cN(t,{idToken:r}));de(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?lN(s.providerUserInfo):[],a=vG(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new vu(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,f)})}function kw(n){return _(this,null,function*(){let e=xe(n);yield mp(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function vG(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function lN(n){return n.map(e=>{var{providerId:t}=e,r=dv(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function _G(n,e){return _(this,null,function*(){let t=yield oN(n,{},()=>_(this,null,function*(){let r=xs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=aN(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",pp.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function yG(n,e){return _(this,null,function*(){return Ba(n,"POST","/v2/accounts:revokeToken",Mw(n,e))})}var mu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){de(e.length!==0,"internal-error");let t=Hx(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return _(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return _(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield _G(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(de(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(de(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Di("not implemented")}};function hs(n,e){de(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ja=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=dv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new vu(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return _(this,null,function*(){let t=yield gu(this,this.stsTokenManager.getToken(this.auth,e));return de(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Pw(this,e)}reload(){return kw(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return _(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield mp(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return _(this,null,function*(){if(si(this.auth.app))return Promise.reject(oo(this.auth));let e=yield this.getIdToken();return yield gu(this,mG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,d;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,v=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,M=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(u=t.createdAt)!==null&&u!==void 0?u:void 0,q=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:W,emailVerified:te,isAnonymous:Ye,providerData:ie,stsTokenManager:C}=t;de(W&&C,e,"internal-error");let y=mu.fromJSON(this.name,C);de(typeof W=="string",e,"internal-error"),hs(f,e.name),hs(m,e.name),de(typeof te=="boolean",e,"internal-error"),de(typeof Ye=="boolean",e,"internal-error"),hs(v,e.name),hs(w,e.name),hs(M,e.name),hs(R,e.name),hs(L,e.name),hs(q,e.name);let I=new n({uid:W,auth:e,email:m,emailVerified:te,displayName:f,isAnonymous:Ye,photoURL:w,phoneNumber:v,tenantId:M,stsTokenManager:y,createdAt:L,lastLoginAt:q});return ie&&Array.isArray(ie)&&(I.providerData=ie.map(T=>Object.assign({},T))),R&&(I._redirectEventId=R),I}static _fromIdTokenResponse(e,t,r=!1){return _(this,null,function*(){let i=new mu;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield mp(s),s})}static _fromGetAccountInfoResponse(e,t,r){return _(this,null,function*(){let i=t.users[0];de(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?lN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new mu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new vu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c})}};var qx=new Map;function Ai(n){ps(n instanceof Function,"Expected a class definition");let e=qx.get(n);return e?(ps(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qx.set(n,e),e)}var wG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return _(this,null,function*(){return!0})}_set(t,r){return _(this,null,function*(){this.storage[t]=r})}_get(t){return _(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return _(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),vw=wG;function up(n,e,t){return`firebase:${n}:${e}:${t}`}var gp=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=up(this.userKey,i.apiKey,s),this.fullPersistenceKey=up("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return _(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ja._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return _(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return _(this,null,function*(){if(!t.length)return new n(Ai(vw),e,r);let i=(yield Promise.all(t.map(u=>_(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||Ai(vw),o=up(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(o);if(d){let f=ja._fromJSON(e,d);u!==s&&(a=f),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(u=>_(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,r))})}};function Gx(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mN(e))return"Blackberry";if(gN(e))return"Webos";if(dN(e))return"Safari";if((e.includes("chrome/")||hN(e))&&!e.includes("edge/"))return"Chrome";if(pN(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function uN(n=nn()){return/firefox\//i.test(n)}function dN(n=nn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hN(n=nn()){return/crios\//i.test(n)}function fN(n=nn()){return/iemobile/i.test(n)}function pN(n=nn()){return/android/i.test(n)}function mN(n=nn()){return/blackberry/i.test(n)}function gN(n=nn()){return/webos/i.test(n)}function Fw(n=nn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function IG(n=nn()){var e;return Fw(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function EG(){return Ub()&&document.documentMode===10}function vN(n=nn()){return Fw(n)||pN(n)||gN(n)||mN(n)||/windows phone/i.test(n)||fN(n)}function _N(n,e=[]){let t;switch(n){case"Browser":t=Gx(nn());break;case"Worker":t=`${Gx(nn())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bn}/${r}`}var _w=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return _(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function CG(t){return _(this,arguments,function*(n,e={}){return Ba(n,"GET","/v2/passwordPolicy",Mw(n,e))})}var TG=6,yw=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:TG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var ww=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vp(this),this.idTokenSubscription=new vp(this),this.beforeStateQueue=new _w(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ai(t)),this._initializationPromise=this.queue(()=>_(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield gp.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return _(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return _(this,null,function*(){try{let t=yield cN(this,{idToken:e}),r=yield ja._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return _(this,null,function*(){var t;if(si(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return _(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return _(this,null,function*(){try{yield mp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=dG()}_delete(){return _(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return _(this,null,function*(){if(si(this.app))return Promise.reject(oo(this));let t=e?xe(e):null;return t&&de(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return _(this,null,function*(){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>_(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return _(this,null,function*(){return si(this.app)?Promise.reject(oo(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return si(this.app)?Promise.reject(oo(this)):this.queue(()=>_(this,null,function*(){yield this.assertedPersistence.setPersistence(Ai(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return _(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return _(this,null,function*(){let e=yield CG(this),t=new yw(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return _(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield yG(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return _(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return _(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Ai(e)||this._popupRedirectResolver;de(t,this,"argument-error"),this.redirectPersistenceManager=yield gp.create(this,[Ai(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return _(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>_(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return _(this,null,function*(){if(e===this.currentUser)return this.queue(()=>_(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return _(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_N(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return _(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return _(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&cG(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Lw(n){return xe(n)}var vp=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=qb(t=>this.observer=t)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Vw={loadJS(){return _(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bG(n){Vw=n}function SG(n){return Vw.loadJS(n)}function DG(){return Vw.gapiScript}function yN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Uw(n,e){let t=xt(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(pl(s,e??{}))return i;fs(i,"already-initialized")}return t.initialize({options:e})}function AG(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ai);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function jw(n,e,t){let r=Lw(n);de(r._canInitEmulator,r,"emulator-config-failed"),de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=wN(e),{host:o,port:a}=RG(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||xG()}function wN(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function RG(n){let e=wN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:zx(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:zx(o)}}}function zx(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function xG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var _p=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,t){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}};function hw(n,e){return _(this,null,function*(){return pG(n,"POST","/v1/accounts:signInWithIdp",Mw(n,e))})}var yp=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Iw=class extends yp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var _u=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return _(this,null,function*(){let s=yield ja._fromIdTokenResponse(e,r,i),o=Wx(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return _(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Wx(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Wx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Ew=class n extends Tn{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function IN(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ew._fromErrorAndOperation(n,s,e,r):s})}function NG(n,e,t=!1){return _(this,null,function*(){let r=yield gu(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return _u._forOperation(n,"link",r)})}function MG(n,e,t=!1){return _(this,null,function*(){let{auth:r}=n;if(si(r.app))return Promise.reject(oo(r));let i="reauthenticate";try{let s=yield gu(n,IN(r,i,e,n),t);de(s.idToken,r,"internal-error");let o=Ow(s.idToken);de(o,r,"internal-error");let{sub:a}=o;return de(n.uid===a,r,"user-mismatch"),_u._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&fs(r,"user-mismatch"),s}})}function PG(n,e,t=!1){return _(this,null,function*(){if(si(n.app))return Promise.reject(oo(n));let r="signIn",i=yield IN(n,r,e),s=yield _u._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Tp(n,e,t,r){return xe(n).onIdTokenChanged(e,t,r)}function Bw(n,e,t){return xe(n).beforeAuthStateChanged(e,t)}function bp(n,e,t,r){return xe(n).onAuthStateChanged(e,t,r)}var wp="__sak";var Ip=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(wp,"1"),this.storage.removeItem(wp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var OG=1e3,kG=10,FG=(()=>{class n extends Ip{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vN(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);EG()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,kG):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},OG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return _(this,null,function*(){yield qi(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return _(this,null,function*(){let r=yield qi(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return _(this,null,function*(){yield qi(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),EN=FG;var LG=(()=>{class n extends Ip{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),$w=LG;function VG(n){return Promise.all(n.map(e=>_(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var UG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return _(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>_(this,null,function*(){return d(r.origin,o)})),u=yield VG(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function CN(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Cw=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return _(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=CN("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){let m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Gr(){return window}function jG(n){Gr().location.href=n}function TN(){return typeof Gr().WorkerGlobalScope<"u"&&typeof Gr().importScripts=="function"}function BG(){return _(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function $G(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function HG(){return TN()?self:null}var bN="firebaseLocalStorageDb",qG=1,Ep="firebaseLocalStorage",SN="fbase_key",lo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Sp(n,e){return n.transaction([Ep],e?"readwrite":"readonly").objectStore(Ep)}function GG(){let n=indexedDB.deleteDatabase(bN);return new lo(n).toPromise()}function Tw(){let n=indexedDB.open(bN,qG);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ep,{keyPath:SN})}catch(i){t(i)}}),n.addEventListener("success",()=>_(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Ep)?e(r):(r.close(),yield GG(),e(yield Tw()))}))})}function Kx(n,e,t){return _(this,null,function*(){let r=Sp(n,!0).put({[SN]:e,value:t});return new lo(r).toPromise()})}function zG(n,e){return _(this,null,function*(){let t=Sp(n,!1).get(e),r=yield new lo(t).toPromise();return r===void 0?null:r.value})}function Qx(n,e){let t=Sp(n,!0).delete(e);return new lo(t).toPromise()}var WG=800,KG=3,QG=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return _(this,null,function*(){return this.db?this.db:(this.db=yield Tw(),this.db)})}_withRetries(t){return _(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>KG)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return _(this,null,function*(){return TN()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return _(this,null,function*(){this.receiver=UG._getInstance(HG()),this.receiver._subscribe("keyChanged",(t,r)=>_(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>_(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return _(this,null,function*(){var t,r;if(this.activeServiceWorker=yield BG(),!this.activeServiceWorker)return;this.sender=new Cw(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return _(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||$G()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return _(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Tw();return yield Kx(t,wp,"1"),yield Qx(t,wp),!0}catch{}return!1})}_withPendingWrite(t){return _(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(i=>Kx(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return _(this,null,function*(){let r=yield this._withRetries(i=>zG(i,t));return this.localCache[t]=r,r})}_remove(t){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(r=>Qx(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return _(this,null,function*(){let t=yield this._withRetries(s=>{let o=Sp(s,!1).getAll();return new lo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>_(this,null,function*(){return this._poll()}),WG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),DN=QG;var Gie=yN("rcb"),zie=new co(3e4,6e4);function YG(n,e){return e?Ai(e):(de(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var yu=class extends _p{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hw(e,this._buildIdpRequest())}_linkToIdToken(e,t){return hw(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return hw(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function ZG(n){return PG(n.auth,new yu(n),n.bypassAuthState)}function JG(n){let{auth:e,user:t}=n;return de(t,e,"internal-error"),MG(t,new yu(n),n.bypassAuthState)}function XG(n){return _(this,null,function*(){let{auth:e,user:t}=n;return de(t,e,"internal-error"),NG(t,new yu(n),n.bypassAuthState)})}var bw=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>_(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return _(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ZG;case"linkViaPopup":case"linkViaRedirect":return XG;case"reauthViaPopup":case"reauthViaRedirect":return JG;default:fs(this.auth,"internal-error")}}resolve(e){ps(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ps(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Wie=new co(2e3,1e4);var ez="pendingRedirect",dp=new Map,Sw=class n extends bw{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return _(this,null,function*(){let e=dp.get(this.auth._key());if(!e){try{let r=(yield tz(this.resolver,this.auth))?yield qi(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}dp.set(this.auth._key(),e)}return this.bypassAuthState||dp.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return _(this,null,function*(){if(e.type==="signInViaRedirect")return qi(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,qi(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return _(this,null,function*(){})}cleanUp(){}};function tz(n,e){return _(this,null,function*(){let t=iz(e),r=rz(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function nz(n,e){dp.set(n._key(),e)}function rz(n){return Ai(n._redirectPersistence)}function iz(n){return up(ez,n.config.apiKey,n.name)}function sz(n,e,t=!1){return _(this,null,function*(){if(si(n.app))return Promise.reject(oo(n));let r=Lw(n),i=YG(r,e),o=yield new Sw(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var oz=10*60*1e3,Dw=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!az(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!AN(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ao(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=oz&&this.cachedEventUids.clear(),this.cachedEventUids.has(Yx(e))}saveEventToCache(e){this.cachedEventUids.add(Yx(e)),this.lastProcessedEventTime=Date.now()}};function Yx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function AN({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function az(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AN(n);default:return!1}}function cz(t){return _(this,arguments,function*(n,e={}){return Ba(n,"GET","/v1/projects",e)})}var lz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uz=/^https?/;function dz(n){return _(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield cz(n);for(let t of e)try{if(hz(t))return}catch{}fs(n,"unauthorized-domain")})}function hz(n){let e=pw(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!uz.test(t))return!1;if(lz.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var fz=new co(3e4,6e4);function Zx(){let n=Gr().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function pz(n){return new Promise((e,t)=>{var r,i,s;function o(){Zx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zx(),t(ao(n,"network-request-failed"))},timeout:fz.get()})}if(!((i=(r=Gr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Gr().gapi)===null||s===void 0)&&s.load)o();else{let a=yN("iframefcb");return Gr()[a]=()=>{gapi.load?o():t(ao(n,"network-request-failed"))},SG(`${DG()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw hp=null,e})}var hp=null;function mz(n){return hp=hp||pz(n),hp}var gz=new co(5e3,15e3),vz="__/auth/iframe",_z="emulator/auth/iframe",yz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Iz(n){let e=n.config;de(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Nw(e,_z):`https://${n.config.authDomain}/${vz}`,r={apiKey:e.apiKey,appName:n.name,v:bn},i=wz.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${xs(r).slice(1)}`}function Ez(n){return _(this,null,function*(){let e=yield mz(n),t=Gr().gapi;return de(t,n,"internal-error"),e.open({where:document.body,url:Iz(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yz,dontclear:!0},r=>new Promise((i,s)=>_(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=ao(n,"network-request-failed"),a=Gr().setTimeout(()=>{s(o)},gz.get());function c(){Gr().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var Cz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Tz=500,bz=600,Sz="_blank",Dz="http://localhost",Cp=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Az(n,e,t,r=Tz,i=bz){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},Cz),{width:r.toString(),height:i.toString(),top:s,left:o}),u=nn().toLowerCase();t&&(a=hN(u)?Sz:t),uN(u)&&(e=e||Dz,c.scrollbars="yes");let d=Object.entries(c).reduce((m,[v,w])=>`${m}${v}=${w},`,"");if(IG(u)&&a!=="_self")return Rz(e||"",a),new Cp(null);let f=window.open(e||"",a,d);de(f,n,"popup-blocked");try{f.focus()}catch{}return new Cp(f)}function Rz(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var xz="__/auth/handler",Nz="emulator/auth/handler",Mz=encodeURIComponent("fac");function Jx(n,e,t,r,i,s){return _(this,null,function*(){de(n.config.authDomain,n,"auth-domain-config-required"),de(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:bn,eventId:i};if(e instanceof yp){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",hl(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(s||{}))o[d]=f}if(e instanceof Iw){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${Mz}=${encodeURIComponent(c)}`:"";return`${Pz(n)}?${xs(a).slice(1)}${u}`})}function Pz({config:n}){return n.emulator?Nw(n,Nz):`https://${n.authDomain}/${xz}`}var fw="webStorageSupport",Aw=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$w,this._completeRedirectFn=sz,this._overrideRedirectResult=nz}_openPopup(e,t,r,i){return _(this,null,function*(){var s;ps((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Jx(e,t,r,pw(),i);return Az(e,o,CN())})}_openRedirect(e,t,r,i){return _(this,null,function*(){yield this._originValidation(e);let s=yield Jx(e,t,r,pw(),i);return jG(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ps(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return _(this,null,function*(){let t=yield Ez(e),r=new Dw(e);return t.register("authEvent",i=>(de(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(fw,{type:fw},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[fw];o!==void 0&&t(!!o),fs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dz(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return vN()||dN()||Fw()}},RN=Aw;var Xx="@firebase/auth",eN="1.7.9";var Rw=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return _(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Oz(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kz(n){bt(new Tt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_N(n)},u=new ww(r,i,s,c);return AG(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),bt(new Tt("auth-internal",e=>{let t=Lw(e.getProvider("auth").getImmediate());return(r=>new Rw(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),J(Xx,eN,Oz(n)),J(Xx,eN,"esm2017")}var Fz=5*60,Lz=Kg("authIdTokenMaxAge")||Fz,tN=null,Vz=n=>e=>_(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Lz)return;let i=t?.token;tN!==i&&(tN=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Hw(n=Nt()){let e=xt(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Uw(n,{popupRedirectResolver:RN,persistence:[DN,EN,$w]}),r=Kg("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=Vz(s.toString());Bw(t,o,()=>o(t.currentUser)),Tp(t,a=>o(a))}}let i=Lb("auth");return i&&jw(t,`http://${i}`),t}function Uz(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}bG({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ao("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Uz().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kz("Browser");function NN(n){return new he(function(e){var t=bp(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var MN="auth",uo=class{constructor(e){return e}},Er=class{constructor(){return At(MN)}};var qw=new H("angularfire2.auth-instances");function NW(n,e){let t=Ot(MN,n,e);return t&&new uo(t)}function MW(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new uo(r)}}var PW={provide:Er,deps:[[new ue,qw]]},OW={provide:uo,useFactory:NW,deps:[[new ue,qw],ot]};function PN(n,...e){return J("angularfire",st.full,"auth"),nt([OW,PW,{provide:qw,useFactory:MW(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Pn],...e]}])}var ON=Ue(NN,!0);var kN=Ue(Hw,!0);var Dp="analytics",FW="firebase_id",LW="origin",VW=60*1e3,UW="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Zw="https://www.googletagmanager.com/gtag/js";var In=new Mr("@firebase/analytics");var jW={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new xr("analytics","Analytics",jW);function BW(n){if(!n.startsWith(Zw)){let e=Gn.create("invalid-gtag-resource",{gtagURL:n});return In.warn(e.message),""}return n}function $N(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function $W(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function HW(n,e){let t=$W("firebase-js-sdk-policy",{createScriptURL:BW}),r=document.createElement("script"),i=`${Zw}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function qW(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function GW(n,e,t,r,i,s){return _(this,null,function*(){let o=r[i];try{if(o)yield e[o];else{let c=(yield $N(t)).find(u=>u.measurementId===i);c&&(yield e[c.appId])}}catch(a){In.error(a)}n("config",i,s)})}function zW(n,e,t,r,i){return _(this,null,function*(){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);let a=yield $N(t);for(let c of o){let u=a.find(f=>f.measurementId===c),d=u&&e[u.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),n("event",r,i||{})}catch(s){In.error(s)}})}function WW(n,e,t,r){function i(s,...o){return _(this,null,function*(){try{if(s==="event"){let[a,c]=o;yield zW(n,e,t,a,c)}else if(s==="config"){let[a,c]=o;yield GW(n,e,t,r,a,c)}else if(s==="consent"){let[a,c]=o;n("consent",a,c)}else if(s==="get"){let[a,c,u]=o;n("get",a,c,u)}else if(s==="set"){let[a]=o;n("set",a)}else n(s,...o)}catch(a){In.error(a)}})}return i}function KW(n,e,t,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=WW(s,n,e,t),{gtagCore:s,wrappedGtag:window[i]}}function QW(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(Zw)&&t.src.includes(n))return t;return null}var YW=30,ZW=1e3,zw=class{constructor(e={},t=ZW){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},HN=new zw;function JW(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function XW(n){return _(this,null,function*(){var e;let{appId:t,apiKey:r}=n,i={method:"GET",headers:JW(r)},s=UW.replace("{app-id}",t),o=yield fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{let c=yield o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()})}function e4(r){return _(this,arguments,function*(n,e=HN,t){let{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw Gn.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw Gn.create("no-api-key")}let a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new Ww;return setTimeout(()=>_(this,null,function*(){c.abort()}),t!==void 0?t:VW),qN({appId:i,apiKey:s,measurementId:o},a,c,e)})}function qN(s,o,a){return _(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=HN){var c;let{appId:u,measurementId:d}=n;try{yield t4(r,e)}catch(f){if(d)return In.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:u,measurementId:d};throw f}try{let f=yield XW(n);return i.deleteThrottleMetadata(u),f}catch(f){let m=f;if(!n4(m)){if(i.deleteThrottleMetadata(u),d)return In.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m?.message}]`),{appId:u,measurementId:d};throw f}let v=Number((c=m?.customData)===null||c===void 0?void 0:c.httpStatus)===503?gl(t,i.intervalMillis,YW):gl(t,i.intervalMillis),w={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return i.setThrottleMetadata(u,w),In.debug(`Calling attemptFetch again in ${v} millis`),qN(n,w,r,i)}})}function t4(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function n4(n){if(!(n instanceof Tn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var Ww=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var Kw;function r4(n,e,t,r,i){return _(this,null,function*(){if(i&&i.global){n("event",t,r);return}else{let s=yield e,o=Object.assign(Object.assign({},r),{send_to:s});n("event",t,o)}})}function i4(n,e,t,r){return _(this,null,function*(){if(r&&r.global)return n("set",{user_id:t}),Promise.resolve();{let i=yield e;n("config",i,{update:!0,user_id:t})}})}var Qw;function s4(n){Qw=n}function o4(n){Kw=n}function a4(){return _(this,null,function*(){if(ii())try{yield As()}catch(n){return In.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return In.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function c4(n,e,t,r,i,s,o){return _(this,null,function*(){var a;let c=e4(n);c.then(v=>{t[v.measurementId]=v.appId,n.options.measurementId&&v.measurementId!==n.options.measurementId&&In.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>In.error(v)),e.push(c);let u=a4().then(v=>{if(v)return r.getId()}),[d,f]=yield Promise.all([c,u]);QW(s)||HW(s,d.measurementId),Qw&&(i("consent","default",Qw),s4(void 0)),i("js",new Date);let m=(a=o?.config)!==null&&a!==void 0?a:{};return m[LW]="firebase",m.update=!0,f!=null&&(m[FW]=f),i("config",d.measurementId,m),Kw&&(i("set",Kw),o4(void 0)),d.measurementId})}var Yw=class{constructor(e){this.app=e}_delete(){return delete $a[this.app.options.appId],Promise.resolve()}},$a={},FN=[],LN={},Gw="dataLayer",l4="gtag",VN,Jw,UN=!1;function u4(){let n=[];if(ul()&&n.push("This is a browser extension environment."),dl()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});In.warn(t.message)}}function d4(n,e,t){u4();let r=n.options.appId;if(!r)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)In.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if($a[r]!=null)throw Gn.create("already-exists",{id:r});if(!UN){qW(Gw);let{wrappedGtag:s,gtagCore:o}=KW($a,FN,LN,Gw,l4);Jw=s,VN=o,UN=!0}return $a[r]=c4(n,FN,LN,e,VN,Gw,t),new Yw(n)}function GN(n=Nt()){n=xe(n);let e=xt(n,Dp);return e.isInitialized()?e.getImmediate():zN(n)}function zN(n,e={}){let t=xt(n,Dp);if(t.isInitialized()){let i=t.getImmediate();if(pl(e,t.getOptions()))return i;throw Gn.create("already-initialized")}return t.initialize({options:e})}function WN(){return _(this,null,function*(){if(ul()||!dl()||!ii())return!1;try{return yield As()}catch{return!1}})}function KN(n,e,t){n=xe(n),i4(Jw,$a[n.app.options.appId],e,t).catch(r=>In.error(r))}function Xw(n,e,t,r){n=xe(n),r4(Jw,$a[n.app.options.appId],e,t,r).catch(i=>In.error(i))}var jN="@firebase/analytics",BN="0.10.8";function h4(){bt(new Tt(Dp,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return d4(r,i,t)},"PUBLIC")),bt(new Tt("analytics-internal",n,"PRIVATE")),J(jN,BN),J(jN,BN,"esm2017");function n(e){try{let t=e.getProvider(Dp).getImmediate();return{logEvent:(r,i,s)=>Xw(t,r,i,s)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}h4();var ho=class{constructor(e){return e}},ZN="analytics",tI=class{constructor(){return At(ZN)}};var nI="__angularfire_symbol__analyticsIsSupportedValue",JN="__angularfire_symbol__analyticsIsSupported";globalThis[JN]||=WN().then(n=>globalThis[nI]=n).catch(()=>globalThis[nI]=!1);var Ap={async:()=>globalThis[JN],sync:()=>{let n=globalThis[nI];if(n===void 0)throw new Error(Ua("Analytics"));return n}},XN=Ap.async,eM=Ue(GN,!0);var f4=Ue(Xw,!0);var p4=Ue(KN,!0);var iI=(()=>{class n{initialized;disposables=[];constructor(t,r,i){J("angularfire",st.full,"user-tracking");let s;this.initialized=r.runOutsideAngular(()=>new Promise(o=>{s=o})),XN().then(()=>{let o=i.get(ho);o?this.disposables=[ON(t).subscribe(a=>{p4(o,a?.uid),s()})]:s()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(r){return new(r||n)(oe(uo),oe(se),oe(Ae))};static \u0275prov=B({token:n,factory:n.\u0275fac})}return n})(),m4="firebase_event_origin",g4="firebase_previous_class",v4="firebase_previous_id",_4="firebase_previous_screen",y4="firebase_screen_class",QN="firebase_screen_id",w4="firebase_screen",rI="outlet",I4="page_path",E4="page_title",wu="screen_class",YN="screen_name",C4="screen_view",T4="auto",b4="#",S4=Math.floor(Math.random()*(2**32-1))-2**31,eI={},D4=n=>{let e=[n[wu],n[rI]].join(b4);if(eI.hasOwnProperty(e))return eI[e];{let t=S4++;return eI[e]=t,t}},A4=(n,e,t)=>n.events.pipe(vn(i=>i instanceof su)).pipe(Dn(i=>{let o=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,m=>m.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",a=n.routerState.root.children.map(m=>m).find(m=>m.outlet===i.snapshot.outlet);if(!a)return ne(null);let c=a;for(;c.firstChild;)c=c.firstChild;let u=c.pathFromRoot.map(m=>m.routeConfig?.path).filter(m=>m).join("/")||"/",d={[YN]:u,[I4]:`/${o}`,[m4]:T4,[w4]:u,[rI]:i.snapshot.outlet};e&&(d[E4]=e.getTitle());let f=a.component;if(f){if(f===sw){let m=i.snapshot;for(;m.firstChild;)m=m.firstChild;f=m.component}}else f=i.snapshot.component;if(typeof f=="string")return ne(Te(j({},d),{[wu]:f}));if(f){let m=t.resolveComponentFactory(f);return ne(Te(j({},d),{[wu]:m.selector}))}return ne(null)}),vn(i=>!!i),Q(i=>j({[y4]:i[wu],[QN]:D4(i)},i)),vv(i=>i[rI]),St(i=>i.pipe(Ch((s,o)=>JSON.stringify(s)===JSON.stringify(o)),ca(void 0),bh(),Q(([s,o])=>s?j({[g4]:s[wu],[_4]:s[YN],[v4]:s[QN]},o):o)))),tM=(()=>{class n{disposable;constructor(t,r,i,s,o,a){J("angularfire",st.full,"screen-tracking"),XN().then(()=>{let c=a.get(ho);!t||!c||s.runOutsideAngular(()=>{this.disposable=A4(t,r,i).pipe(Dn(u=>_(this,null,function*(){return o&&(yield o.initialized),f4(c,C4,u)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||n)(oe(sp,8),oe($f,8),oe(ns),oe(se),oe(iI,8),oe(Ae))};static \u0275prov=B({token:n,factory:n.\u0275fac})}return n})(),sI=new H("angularfire2.analytics-instances");function R4(n,e){if(!Ap.sync())return null;let t=Ot(ZN,n,e);return t&&new ho(t)}function x4(n){return(e,t)=>{if(!Ap.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new ho(r)}}var N4={provide:tI,deps:[[new ue,sI]]},M4={provide:ho,useFactory:R4,deps:[[new ue,sI],ot]};function nM(n,...e){return J("angularfire",st.full,"analytics"),nt([M4,N4,{provide:cs,useValue:Ap.async,multi:!0},{provide:sI,useFactory:x4(n),multi:!0,deps:[se,Ae,Et,pt,...e]}])}var rM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},iM={};var ms,oI;(function(){var n;function e(C,y){function I(){}I.prototype=y.prototype,C.D=y.prototype,C.prototype=new I,C.prototype.constructor=C,C.C=function(T,D,x){for(var E=Array(arguments.length-2),ti=2;ti<arguments.length;ti++)E[ti-2]=arguments[ti];return y.prototype[D].apply(T,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,y,I){I||(I=0);var T=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)T[D]=y.charCodeAt(I++)|y.charCodeAt(I++)<<8|y.charCodeAt(I++)<<16|y.charCodeAt(I++)<<24;else for(D=0;16>D;++D)T[D]=y[I++]|y[I++]<<8|y[I++]<<16|y[I++]<<24;y=C.g[0],I=C.g[1],D=C.g[2];var x=C.g[3],E=y+(x^I&(D^x))+T[0]+3614090360&4294967295;y=I+(E<<7&4294967295|E>>>25),E=x+(D^y&(I^D))+T[1]+3905402710&4294967295,x=y+(E<<12&4294967295|E>>>20),E=D+(I^x&(y^I))+T[2]+606105819&4294967295,D=x+(E<<17&4294967295|E>>>15),E=I+(y^D&(x^y))+T[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=y+(x^I&(D^x))+T[4]+4118548399&4294967295,y=I+(E<<7&4294967295|E>>>25),E=x+(D^y&(I^D))+T[5]+1200080426&4294967295,x=y+(E<<12&4294967295|E>>>20),E=D+(I^x&(y^I))+T[6]+2821735955&4294967295,D=x+(E<<17&4294967295|E>>>15),E=I+(y^D&(x^y))+T[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=y+(x^I&(D^x))+T[8]+1770035416&4294967295,y=I+(E<<7&4294967295|E>>>25),E=x+(D^y&(I^D))+T[9]+2336552879&4294967295,x=y+(E<<12&4294967295|E>>>20),E=D+(I^x&(y^I))+T[10]+4294925233&4294967295,D=x+(E<<17&4294967295|E>>>15),E=I+(y^D&(x^y))+T[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=y+(x^I&(D^x))+T[12]+1804603682&4294967295,y=I+(E<<7&4294967295|E>>>25),E=x+(D^y&(I^D))+T[13]+4254626195&4294967295,x=y+(E<<12&4294967295|E>>>20),E=D+(I^x&(y^I))+T[14]+2792965006&4294967295,D=x+(E<<17&4294967295|E>>>15),E=I+(y^D&(x^y))+T[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=y+(D^x&(I^D))+T[1]+4129170786&4294967295,y=I+(E<<5&4294967295|E>>>27),E=x+(I^D&(y^I))+T[6]+3225465664&4294967295,x=y+(E<<9&4294967295|E>>>23),E=D+(y^I&(x^y))+T[11]+643717713&4294967295,D=x+(E<<14&4294967295|E>>>18),E=I+(x^y&(D^x))+T[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=y+(D^x&(I^D))+T[5]+3593408605&4294967295,y=I+(E<<5&4294967295|E>>>27),E=x+(I^D&(y^I))+T[10]+38016083&4294967295,x=y+(E<<9&4294967295|E>>>23),E=D+(y^I&(x^y))+T[15]+3634488961&4294967295,D=x+(E<<14&4294967295|E>>>18),E=I+(x^y&(D^x))+T[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=y+(D^x&(I^D))+T[9]+568446438&4294967295,y=I+(E<<5&4294967295|E>>>27),E=x+(I^D&(y^I))+T[14]+3275163606&4294967295,x=y+(E<<9&4294967295|E>>>23),E=D+(y^I&(x^y))+T[3]+4107603335&4294967295,D=x+(E<<14&4294967295|E>>>18),E=I+(x^y&(D^x))+T[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=y+(D^x&(I^D))+T[13]+2850285829&4294967295,y=I+(E<<5&4294967295|E>>>27),E=x+(I^D&(y^I))+T[2]+4243563512&4294967295,x=y+(E<<9&4294967295|E>>>23),E=D+(y^I&(x^y))+T[7]+1735328473&4294967295,D=x+(E<<14&4294967295|E>>>18),E=I+(x^y&(D^x))+T[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=y+(I^D^x)+T[5]+4294588738&4294967295,y=I+(E<<4&4294967295|E>>>28),E=x+(y^I^D)+T[8]+2272392833&4294967295,x=y+(E<<11&4294967295|E>>>21),E=D+(x^y^I)+T[11]+1839030562&4294967295,D=x+(E<<16&4294967295|E>>>16),E=I+(D^x^y)+T[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=y+(I^D^x)+T[1]+2763975236&4294967295,y=I+(E<<4&4294967295|E>>>28),E=x+(y^I^D)+T[4]+1272893353&4294967295,x=y+(E<<11&4294967295|E>>>21),E=D+(x^y^I)+T[7]+4139469664&4294967295,D=x+(E<<16&4294967295|E>>>16),E=I+(D^x^y)+T[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=y+(I^D^x)+T[13]+681279174&4294967295,y=I+(E<<4&4294967295|E>>>28),E=x+(y^I^D)+T[0]+3936430074&4294967295,x=y+(E<<11&4294967295|E>>>21),E=D+(x^y^I)+T[3]+3572445317&4294967295,D=x+(E<<16&4294967295|E>>>16),E=I+(D^x^y)+T[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=y+(I^D^x)+T[9]+3654602809&4294967295,y=I+(E<<4&4294967295|E>>>28),E=x+(y^I^D)+T[12]+3873151461&4294967295,x=y+(E<<11&4294967295|E>>>21),E=D+(x^y^I)+T[15]+530742520&4294967295,D=x+(E<<16&4294967295|E>>>16),E=I+(D^x^y)+T[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=y+(D^(I|~x))+T[0]+4096336452&4294967295,y=I+(E<<6&4294967295|E>>>26),E=x+(I^(y|~D))+T[7]+1126891415&4294967295,x=y+(E<<10&4294967295|E>>>22),E=D+(y^(x|~I))+T[14]+2878612391&4294967295,D=x+(E<<15&4294967295|E>>>17),E=I+(x^(D|~y))+T[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=y+(D^(I|~x))+T[12]+1700485571&4294967295,y=I+(E<<6&4294967295|E>>>26),E=x+(I^(y|~D))+T[3]+2399980690&4294967295,x=y+(E<<10&4294967295|E>>>22),E=D+(y^(x|~I))+T[10]+4293915773&4294967295,D=x+(E<<15&4294967295|E>>>17),E=I+(x^(D|~y))+T[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=y+(D^(I|~x))+T[8]+1873313359&4294967295,y=I+(E<<6&4294967295|E>>>26),E=x+(I^(y|~D))+T[15]+4264355552&4294967295,x=y+(E<<10&4294967295|E>>>22),E=D+(y^(x|~I))+T[6]+2734768916&4294967295,D=x+(E<<15&4294967295|E>>>17),E=I+(x^(D|~y))+T[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=y+(D^(I|~x))+T[4]+4149444226&4294967295,y=I+(E<<6&4294967295|E>>>26),E=x+(I^(y|~D))+T[11]+3174756917&4294967295,x=y+(E<<10&4294967295|E>>>22),E=D+(y^(x|~I))+T[2]+718787259&4294967295,D=x+(E<<15&4294967295|E>>>17),E=I+(x^(D|~y))+T[9]+3951481745&4294967295,C.g[0]=C.g[0]+y&4294967295,C.g[1]=C.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+x&4294967295}r.prototype.u=function(C,y){y===void 0&&(y=C.length);for(var I=y-this.blockSize,T=this.B,D=this.h,x=0;x<y;){if(D==0)for(;x<=I;)i(this,C,x),x+=this.blockSize;if(typeof C=="string"){for(;x<y;)if(T[D++]=C.charCodeAt(x++),D==this.blockSize){i(this,T),D=0;break}}else for(;x<y;)if(T[D++]=C[x++],D==this.blockSize){i(this,T),D=0;break}}this.h=D,this.o+=y},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var y=1;y<C.length-8;++y)C[y]=0;var I=8*this.o;for(y=C.length-8;y<C.length;++y)C[y]=I&255,I/=256;for(this.u(C),C=Array(16),y=I=0;4>y;++y)for(var T=0;32>T;T+=8)C[I++]=this.g[y]>>>T&255;return C};function s(C,y){var I=a;return Object.prototype.hasOwnProperty.call(I,C)?I[C]:I[C]=y(C)}function o(C,y){this.h=y;for(var I=[],T=!0,D=C.length-1;0<=D;D--){var x=C[D]|0;T&&x==y||(I[D]=x,T=!1)}this.g=I}var a={};function c(C){return-128<=C&&128>C?s(C,function(y){return new o([y|0],0>y?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return R(u(-C));for(var y=[],I=1,T=0;C>=I;T++)y[T]=C/I|0,I*=4294967296;return new o(y,0)}function d(C,y){if(C.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(C.charAt(0)=="-")return R(d(C.substring(1),y));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(y,8)),T=f,D=0;D<C.length;D+=8){var x=Math.min(8,C.length-D),E=parseInt(C.substring(D,D+x),y);8>x?(x=u(Math.pow(y,x)),T=T.j(x).add(u(E))):(T=T.j(I),T=T.add(u(E)))}return T}var f=c(0),m=c(1),v=c(16777216);n=o.prototype,n.m=function(){if(M(this))return-R(this).m();for(var C=0,y=1,I=0;I<this.g.length;I++){var T=this.i(I);C+=(0<=T?T:4294967296+T)*y,y*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(M(this))return"-"+R(this).toString(C);for(var y=u(Math.pow(C,6)),I=this,T="";;){var D=te(I,y).g;I=L(I,D.j(y));var x=((0<I.g.length?I.g[0]:I.h)>>>0).toString(C);if(I=D,w(I))return x+T;for(;6>x.length;)x="0"+x;T=x+T}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(var y=0;y<C.g.length;y++)if(C.g[y]!=0)return!1;return!0}function M(C){return C.h==-1}n.l=function(C){return C=L(this,C),M(C)?-1:w(C)?0:1};function R(C){for(var y=C.g.length,I=[],T=0;T<y;T++)I[T]=~C.g[T];return new o(I,~C.h).add(m)}n.abs=function(){return M(this)?R(this):this},n.add=function(C){for(var y=Math.max(this.g.length,C.g.length),I=[],T=0,D=0;D<=y;D++){var x=T+(this.i(D)&65535)+(C.i(D)&65535),E=(x>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);T=E>>>16,x&=65535,E&=65535,I[D]=E<<16|x}return new o(I,I[I.length-1]&-2147483648?-1:0)};function L(C,y){return C.add(R(y))}n.j=function(C){if(w(this)||w(C))return f;if(M(this))return M(C)?R(this).j(R(C)):R(R(this).j(C));if(M(C))return R(this.j(R(C)));if(0>this.l(v)&&0>C.l(v))return u(this.m()*C.m());for(var y=this.g.length+C.g.length,I=[],T=0;T<2*y;T++)I[T]=0;for(T=0;T<this.g.length;T++)for(var D=0;D<C.g.length;D++){var x=this.i(T)>>>16,E=this.i(T)&65535,ti=C.i(D)>>>16,qc=C.i(D)&65535;I[2*T+2*D]+=E*qc,q(I,2*T+2*D),I[2*T+2*D+1]+=x*qc,q(I,2*T+2*D+1),I[2*T+2*D+1]+=E*ti,q(I,2*T+2*D+1),I[2*T+2*D+2]+=x*ti,q(I,2*T+2*D+2)}for(T=0;T<y;T++)I[T]=I[2*T+1]<<16|I[2*T];for(T=y;T<2*y;T++)I[T]=0;return new o(I,0)};function q(C,y){for(;(C[y]&65535)!=C[y];)C[y+1]+=C[y]>>>16,C[y]&=65535,y++}function W(C,y){this.g=C,this.h=y}function te(C,y){if(w(y))throw Error("division by zero");if(w(C))return new W(f,f);if(M(C))return y=te(R(C),y),new W(R(y.g),R(y.h));if(M(y))return y=te(C,R(y)),new W(R(y.g),y.h);if(30<C.g.length){if(M(C)||M(y))throw Error("slowDivide_ only works with positive integers.");for(var I=m,T=y;0>=T.l(C);)I=Ye(I),T=Ye(T);var D=ie(I,1),x=ie(T,1);for(T=ie(T,2),I=ie(I,2);!w(T);){var E=x.add(T);0>=E.l(C)&&(D=D.add(I),x=E),T=ie(T,1),I=ie(I,1)}return y=L(C,D.j(y)),new W(D,y)}for(D=f;0<=C.l(y);){for(I=Math.max(1,Math.floor(C.m()/y.m())),T=Math.ceil(Math.log(I)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),x=u(I),E=x.j(y);M(E)||0<E.l(C);)I-=T,x=u(I),E=x.j(y);w(x)&&(x=m),D=D.add(x),C=L(C,E)}return new W(D,C)}n.A=function(C){return te(this,C).h},n.and=function(C){for(var y=Math.max(this.g.length,C.g.length),I=[],T=0;T<y;T++)I[T]=this.i(T)&C.i(T);return new o(I,this.h&C.h)},n.or=function(C){for(var y=Math.max(this.g.length,C.g.length),I=[],T=0;T<y;T++)I[T]=this.i(T)|C.i(T);return new o(I,this.h|C.h)},n.xor=function(C){for(var y=Math.max(this.g.length,C.g.length),I=[],T=0;T<y;T++)I[T]=this.i(T)^C.i(T);return new o(I,this.h^C.h)};function Ye(C){for(var y=C.g.length+1,I=[],T=0;T<y;T++)I[T]=C.i(T)<<1|C.i(T-1)>>>31;return new o(I,C.h)}function ie(C,y){var I=y>>5;y%=32;for(var T=C.g.length-I,D=[],x=0;x<T;x++)D[x]=0<y?C.i(x+I)>>>y|C.i(x+I+1)<<32-y:C.i(x+I);return new o(D,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,oI=iM.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,ms=iM.Integer=o}).apply(typeof rM<"u"?rM:typeof self<"u"?self:typeof window<"u"?window:{});var Rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ri={};var aI,P4,Ha,cI,Iu,xp,lI,uI,dI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rp=="object"&&Rp];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var p=r;l=l.split(".");for(var g=0;g<l.length-1;g++){var A=l[g];if(!(A in p))break e;p=p[A]}l=l[l.length-1],g=p[l],h=h(g),h!=g&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var p=0,g=!1,A={next:function(){if(!g&&p<l.length){var O=p++;return{value:h(O,l[O]),done:!1}}return g=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,p){return p})}});var o=o||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,g),l.apply(h,A)}}return function(){return l.apply(h,arguments)}}function m(l,h,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function v(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var g=p.slice();return g.push.apply(g,arguments),l.apply(this,g)}}function w(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(g,A,O){for(var U=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)U[Ze-2]=arguments[Ze];return h.prototype[A].apply(g,U)}}function M(l){let h=l.length;if(0<h){let p=Array(h);for(let g=0;g<h;g++)p[g]=l[g];return p}return[]}function R(l,h){for(let p=1;p<arguments.length;p++){let g=arguments[p];if(c(g)){let A=l.length||0,O=g.length||0;l.length=A+O;for(let U=0;U<O;U++)l[A+U]=g[U]}else l.push(g)}}class L{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function q(l){return/^[\s\xa0]*$/.test(l)}function W(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function te(l){return te[" "](l),l}te[" "]=function(){};var Ye=W().indexOf("Gecko")!=-1&&!(W().toLowerCase().indexOf("webkit")!=-1&&W().indexOf("Edge")==-1)&&!(W().indexOf("Trident")!=-1||W().indexOf("MSIE")!=-1)&&W().indexOf("Edge")==-1;function ie(l,h,p){for(let g in l)h.call(p,l[g],g,l)}function C(l,h){for(let p in l)h.call(void 0,l[p],p,l)}function y(l){let h={};for(let p in l)h[p]=l[p];return h}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,h){let p,g;for(let A=1;A<arguments.length;A++){g=arguments[A];for(p in g)l[p]=g[p];for(let O=0;O<I.length;O++)p=I[O],Object.prototype.hasOwnProperty.call(g,p)&&(l[p]=g[p])}}function D(l){var h=1;l=l.split(":");let p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function x(l){a.setTimeout(()=>{throw l},0)}function E(){var l=Cg;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ti{constructor(){this.h=this.g=null}add(h,p){let g=qc.get();g.set(h,p),this.h?this.h.next=g:this.g=g,this.h=g}}var qc=new L(()=>new ZF,l=>l.reset());class ZF{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Gc,zc=!1,Cg=new ti,MT=()=>{let l=a.Promise.resolve(void 0);Gc=()=>{l.then(JF)}};var JF=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(p){x(p)}var h=qc;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}zc=!1};function ji(){this.s=this.s,this.C=this.C}ji.prototype.s=!1,ji.prototype.ma=function(){this.s||(this.s=!0,this.N())},ji.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Jt(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Jt.prototype.h=function(){this.defaultPrevented=!0};var XF=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function Wc(l,h){if(Jt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,g=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(Ye){e:{try{te(h.nodeName);var A=!0;break e}catch{}A=!1}A||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:eL[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Wc.aa.h.call(this)}}w(Wc,Jt);var eL={2:"touch",3:"pen",4:"mouse"};Wc.prototype.h=function(){Wc.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Kc="closure_listenable_"+(1e6*Math.random()|0),tL=0;function nL(l,h,p,g,A){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!g,this.ha=A,this.key=++tL,this.da=this.fa=!1}function Td(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function bd(l){this.src=l,this.g={},this.h=0}bd.prototype.add=function(l,h,p,g,A){var O=l.toString();l=this.g[O],l||(l=this.g[O]=[],this.h++);var U=bg(l,h,g,A);return-1<U?(h=l[U],p||(h.fa=!1)):(h=new nL(h,this.src,O,!!g,A),h.fa=p,l.push(h)),h};function Tg(l,h){var p=h.type;if(p in l.g){var g=l.g[p],A=Array.prototype.indexOf.call(g,h,void 0),O;(O=0<=A)&&Array.prototype.splice.call(g,A,1),O&&(Td(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function bg(l,h,p,g){for(var A=0;A<l.length;++A){var O=l[A];if(!O.da&&O.listener==h&&O.capture==!!p&&O.ha==g)return A}return-1}var Sg="closure_lm_"+(1e6*Math.random()|0),Dg={};function PT(l,h,p,g,A){if(g&&g.once)return kT(l,h,p,g,A);if(Array.isArray(h)){for(var O=0;O<h.length;O++)PT(l,h[O],p,g,A);return null}return p=Ng(p),l&&l[Kc]?l.K(h,p,u(g)?!!g.capture:!!g,A):OT(l,h,p,!1,g,A)}function OT(l,h,p,g,A,O){if(!h)throw Error("Invalid event type");var U=u(A)?!!A.capture:!!A,Ze=Rg(l);if(Ze||(l[Sg]=Ze=new bd(l)),p=Ze.add(h,p,g,U,O),p.proxy)return p;if(g=rL(),p.proxy=g,g.src=l,g.listener=p,l.addEventListener)XF||(A=U),A===void 0&&(A=!1),l.addEventListener(h.toString(),g,A);else if(l.attachEvent)l.attachEvent(LT(h.toString()),g);else if(l.addListener&&l.removeListener)l.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return p}function rL(){function l(p){return h.call(l.src,l.listener,p)}let h=iL;return l}function kT(l,h,p,g,A){if(Array.isArray(h)){for(var O=0;O<h.length;O++)kT(l,h[O],p,g,A);return null}return p=Ng(p),l&&l[Kc]?l.L(h,p,u(g)?!!g.capture:!!g,A):OT(l,h,p,!0,g,A)}function FT(l,h,p,g,A){if(Array.isArray(h))for(var O=0;O<h.length;O++)FT(l,h[O],p,g,A);else g=u(g)?!!g.capture:!!g,p=Ng(p),l&&l[Kc]?(l=l.i,h=String(h).toString(),h in l.g&&(O=l.g[h],p=bg(O,p,g,A),-1<p&&(Td(O[p]),Array.prototype.splice.call(O,p,1),O.length==0&&(delete l.g[h],l.h--)))):l&&(l=Rg(l))&&(h=l.g[h.toString()],l=-1,h&&(l=bg(h,p,g,A)),(p=-1<l?h[l]:null)&&Ag(p))}function Ag(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Kc])Tg(h.i,l);else{var p=l.type,g=l.proxy;h.removeEventListener?h.removeEventListener(p,g,l.capture):h.detachEvent?h.detachEvent(LT(p),g):h.addListener&&h.removeListener&&h.removeListener(g),(p=Rg(h))?(Tg(p,l),p.h==0&&(p.src=null,h[Sg]=null)):Td(l)}}}function LT(l){return l in Dg?Dg[l]:Dg[l]="on"+l}function iL(l,h){if(l.da)l=!0;else{h=new Wc(h,this);var p=l.listener,g=l.ha||l.src;l.fa&&Ag(l),l=p.call(g,h)}return l}function Rg(l){return l=l[Sg],l instanceof bd?l:null}var xg="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ng(l){return typeof l=="function"?l:(l[xg]||(l[xg]=function(h){return l.handleEvent(h)}),l[xg])}function Xt(){ji.call(this),this.i=new bd(this),this.M=this,this.F=null}w(Xt,ji),Xt.prototype[Kc]=!0,Xt.prototype.removeEventListener=function(l,h,p,g){FT(this,l,h,p,g)};function pn(l,h){var p,g=l.F;if(g)for(p=[];g;g=g.F)p.push(g);if(l=l.M,g=h.type||h,typeof h=="string")h=new Jt(h,l);else if(h instanceof Jt)h.target=h.target||l;else{var A=h;h=new Jt(g,l),T(h,A)}if(A=!0,p)for(var O=p.length-1;0<=O;O--){var U=h.g=p[O];A=Sd(U,g,!0,h)&&A}if(U=h.g=l,A=Sd(U,g,!0,h)&&A,A=Sd(U,g,!1,h)&&A,p)for(O=0;O<p.length;O++)U=h.g=p[O],A=Sd(U,g,!1,h)&&A}Xt.prototype.N=function(){if(Xt.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],g=0;g<p.length;g++)Td(p[g]);delete l.g[h],l.h--}}this.F=null},Xt.prototype.K=function(l,h,p,g){return this.i.add(String(l),h,!1,p,g)},Xt.prototype.L=function(l,h,p,g){return this.i.add(String(l),h,!0,p,g)};function Sd(l,h,p,g){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var A=!0,O=0;O<h.length;++O){var U=h[O];if(U&&!U.da&&U.capture==p){var Ze=U.listener,Kt=U.ha||U.src;U.fa&&Tg(l.i,U),A=Ze.call(Kt,g)!==!1&&A}}return A&&!g.defaultPrevented}function VT(l,h,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function UT(l){l.g=VT(()=>{l.g=null,l.i&&(l.i=!1,UT(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class sL extends ji{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:UT(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qc(l){ji.call(this),this.h=l,this.g={}}w(Qc,ji);var jT=[];function BT(l){ie(l.g,function(h,p){this.g.hasOwnProperty(p)&&Ag(h)},l),l.g={}}Qc.prototype.N=function(){Qc.aa.N.call(this),BT(this)},Qc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mg=a.JSON.stringify,oL=a.JSON.parse,aL=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Pg(){}Pg.prototype.h=null;function $T(l){return l.h||(l.h=l.i())}function HT(){}var Yc={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Og(){Jt.call(this,"d")}w(Og,Jt);function kg(){Jt.call(this,"c")}w(kg,Jt);var Ts={},qT=null;function Dd(){return qT=qT||new Xt}Ts.La="serverreachability";function GT(l){Jt.call(this,Ts.La,l)}w(GT,Jt);function Zc(l){let h=Dd();pn(h,new GT(h))}Ts.STAT_EVENT="statevent";function zT(l,h){Jt.call(this,Ts.STAT_EVENT,l),this.stat=h}w(zT,Jt);function mn(l){let h=Dd();pn(h,new zT(h,l))}Ts.Ma="timingevent";function WT(l,h){Jt.call(this,Ts.Ma,l),this.size=h}w(WT,Jt);function Jc(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function Xc(){this.g=!0}Xc.prototype.xa=function(){this.g=!1};function cL(l,h,p,g,A,O){l.info(function(){if(l.g)if(O)for(var U="",Ze=O.split("&"),Kt=0;Kt<Ze.length;Kt++){var Le=Ze[Kt].split("=");if(1<Le.length){var en=Le[0];Le=Le[1];var tn=en.split("_");U=2<=tn.length&&tn[1]=="type"?U+(en+"="+Le+"&"):U+(en+"=redacted&")}}else U=null;else U=O;return"XMLHTTP REQ ("+g+") [attempt "+A+"]: "+h+`
`+p+`
`+U})}function lL(l,h,p,g,A,O,U){l.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+A+"]: "+h+`
`+p+`
`+O+" "+U})}function Bo(l,h,p,g){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+dL(l,p)+(g?" "+g:"")})}function uL(l,h){l.info(function(){return"TIMEOUT: "+h})}Xc.prototype.info=function(){};function dL(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var g=p[l];if(!(2>g.length)){var A=g[1];if(Array.isArray(A)&&!(1>A.length)){var O=A[0];if(O!="noop"&&O!="stop"&&O!="close")for(var U=1;U<A.length;U++)A[U]=""}}}}return Mg(p)}catch{return h}}var Ad={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},KT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fg;function Rd(){}w(Rd,Pg),Rd.prototype.g=function(){return new XMLHttpRequest},Rd.prototype.i=function(){return{}},Fg=new Rd;function Bi(l,h,p,g){this.j=l,this.i=h,this.l=p,this.R=g||1,this.U=new Qc(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new QT}function QT(){this.i=null,this.g="",this.h=!1}var YT={},Lg={};function Vg(l,h,p){l.L=1,l.v=Pd(ni(h)),l.m=p,l.P=!0,ZT(l,null)}function ZT(l,h){l.F=Date.now(),xd(l),l.A=ni(l.v);var p=l.A,g=l.R;Array.isArray(g)||(g=[String(g)]),db(p.i,"t",g),l.C=0,p=l.j.J,l.h=new QT,l.g=Rb(l.j,p?h:null,!l.m),0<l.O&&(l.M=new sL(m(l.Y,l,l.g),l.O)),h=l.U,p=l.g,g=l.ca;var A="readystatechange";Array.isArray(A)||(A&&(jT[0]=A.toString()),A=jT);for(var O=0;O<A.length;O++){var U=PT(p,A[O],g||h.handleEvent,!1,h.h||h);if(!U)break;h.g[U.key]=U}h=l.H?y(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Zc(),cL(l.i,l.u,l.A,l.l,l.R,l.m)}Bi.prototype.ca=function(l){l=l.target;let h=this.M;h&&ri(l)==3?h.j():this.Y(l)},Bi.prototype.Y=function(l){try{if(l==this.g)e:{let tn=ri(this.g);var h=this.g.Ba();let qo=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||_b(this.g)))){this.J||tn!=4||h==7||(h==8||0>=qo?Zc(3):Zc(2)),Ug(this);var p=this.g.Z();this.X=p;t:if(JT(this)){var g=_b(this.g);l="";var A=g.length,O=ri(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){bs(this),el(this);var U="";break t}this.h.i=new a.TextDecoder}for(h=0;h<A;h++)this.h.h=!0,l+=this.h.i.decode(g[h],{stream:!(O&&h==A-1)});g.length=0,this.h.g+=l,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=p==200,lL(this.i,this.u,this.A,this.l,this.R,tn,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ze,Kt=this.g;if((Ze=Kt.g?Kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Ze)){var Le=Ze;break t}}Le=null}if(p=Le)Bo(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,jg(this,p);else{this.o=!1,this.s=3,mn(12),bs(this),el(this);break e}}if(this.P){p=!0;let fr;for(;!this.J&&this.C<U.length;)if(fr=hL(this,U),fr==Lg){tn==4&&(this.s=4,mn(14),p=!1),Bo(this.i,this.l,null,"[Incomplete Response]");break}else if(fr==YT){this.s=4,mn(15),Bo(this.i,this.l,U,"[Invalid Chunk]"),p=!1;break}else Bo(this.i,this.l,fr,null),jg(this,fr);if(JT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||U.length!=0||this.h.h||(this.s=1,mn(16),p=!1),this.o=this.o&&p,!p)Bo(this.i,this.l,U,"[Invalid Chunked Response]"),bs(this),el(this);else if(0<U.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),zg(en),en.M=!0,mn(11))}}else Bo(this.i,this.l,U,null),jg(this,U);tn==4&&bs(this),this.o&&!this.J&&(tn==4?bb(this.j,this):(this.o=!1,xd(this)))}else RL(this.g),p==400&&0<U.indexOf("Unknown SID")?(this.s=3,mn(12)):(this.s=0,mn(13)),bs(this),el(this)}}}catch{}finally{}};function JT(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function hL(l,h){var p=l.C,g=h.indexOf(`
`,p);return g==-1?Lg:(p=Number(h.substring(p,g)),isNaN(p)?YT:(g+=1,g+p>h.length?Lg:(h=h.slice(g,g+p),l.C=g+p,h)))}Bi.prototype.cancel=function(){this.J=!0,bs(this)};function xd(l){l.S=Date.now()+l.I,XT(l,l.I)}function XT(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Jc(m(l.ba,l),h)}function Ug(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Bi.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(uL(this.i,this.A),this.L!=2&&(Zc(),mn(17)),bs(this),this.s=2,el(this)):XT(this,this.S-l)};function el(l){l.j.G==0||l.J||bb(l.j,l)}function bs(l){Ug(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,BT(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function jg(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Bg(p.h,l))){if(!l.K&&Bg(p.h,l)&&p.G==3){try{var g=p.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var A=g;if(A[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Vd(p),Fd(p);else break e;Gg(p),mn(18)}}else p.za=A[1],0<p.za-p.T&&37500>A[2]&&p.F&&p.v==0&&!p.C&&(p.C=Jc(m(p.Za,p),6e3));if(1>=nb(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ds(p,11)}else if((l.K||p.g==l)&&Vd(p),!q(h))for(A=p.Da.g.parse(h),h=0;h<A.length;h++){let Le=A[h];if(p.T=Le[0],Le=Le[1],p.G==2)if(Le[0]=="c"){p.K=Le[1],p.ia=Le[2];let en=Le[3];en!=null&&(p.la=en,p.j.info("VER="+p.la));let tn=Le[4];tn!=null&&(p.Aa=tn,p.j.info("SVER="+p.Aa));let qo=Le[5];qo!=null&&typeof qo=="number"&&0<qo&&(g=1.5*qo,p.L=g,p.j.info("backChannelRequestTimeoutMs_="+g)),g=p;let fr=l.g;if(fr){let jd=fr.g?fr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jd){var O=g.h;O.g||jd.indexOf("spdy")==-1&&jd.indexOf("quic")==-1&&jd.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&($g(O,O.h),O.h=null))}if(g.D){let Wg=fr.g?fr.g.getResponseHeader("X-HTTP-Session-Id"):null;Wg&&(g.ya=Wg,it(g.I,g.D,Wg))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),g=p;var U=l;if(g.qa=Ab(g,g.J?g.ia:null,g.W),U.K){rb(g.h,U);var Ze=U,Kt=g.L;Kt&&(Ze.I=Kt),Ze.B&&(Ug(Ze),xd(Ze)),g.g=U}else Cb(g);0<p.i.length&&Ld(p)}else Le[0]!="stop"&&Le[0]!="close"||Ds(p,7);else p.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Ds(p,7):qg(p):Le[0]!="noop"&&p.l&&p.l.ta(Le),p.v=0)}}Zc(4)}catch{}}var fL=class{constructor(l,h){this.g=l,this.map=h}};function eb(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tb(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function nb(l){return l.h?1:l.g?l.g.size:0}function Bg(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function $g(l,h){l.g?l.g.add(h):l.h=h}function rb(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}eb.prototype.cancel=function(){if(this.i=ib(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function ib(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let p of l.g.values())h=h.concat(p.D);return h}return M(l.i)}function pL(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,g=0;g<p;g++)h.push(l[g]);return h}h=[],p=0;for(g in l)h[p++]=l[g];return h}function mL(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(let g in l)h[p++]=g;return h}}}function sb(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=mL(l),g=pL(l),A=g.length,O=0;O<A;O++)h.call(void 0,g[O],p&&p[O],l)}var ob=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gL(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var g=l[p].indexOf("="),A=null;if(0<=g){var O=l[p].substring(0,g);A=l[p].substring(g+1)}else O=l[p];h(O,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Ss(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ss){this.h=l.h,Nd(this,l.j),this.o=l.o,this.g=l.g,Md(this,l.s),this.l=l.l;var h=l.i,p=new rl;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),ab(this,p),this.m=l.m}else l&&(h=String(l).match(ob))?(this.h=!1,Nd(this,h[1]||"",!0),this.o=tl(h[2]||""),this.g=tl(h[3]||"",!0),Md(this,h[4]),this.l=tl(h[5]||"",!0),ab(this,h[6]||"",!0),this.m=tl(h[7]||"")):(this.h=!1,this.i=new rl(null,this.h))}Ss.prototype.toString=function(){var l=[],h=this.j;h&&l.push(nl(h,cb,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(nl(h,cb,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(nl(p,p.charAt(0)=="/"?yL:_L,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",nl(p,IL)),l.join("")};function ni(l){return new Ss(l)}function Nd(l,h,p){l.j=p?tl(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Md(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function ab(l,h,p){h instanceof rl?(l.i=h,EL(l.i,l.h)):(p||(h=nl(h,wL)),l.i=new rl(h,l.h))}function it(l,h,p){l.i.set(h,p)}function Pd(l){return it(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function tl(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function nl(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,vL),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function vL(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var cb=/[#\/\?@]/g,_L=/[#\?:]/g,yL=/[#\?]/g,wL=/[#\?@]/g,IL=/#/g;function rl(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function $i(l){l.g||(l.g=new Map,l.h=0,l.i&&gL(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=rl.prototype,n.add=function(l,h){$i(this),this.i=null,l=$o(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function lb(l,h){$i(l),h=$o(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function ub(l,h){return $i(l),h=$o(l,h),l.g.has(h)}n.forEach=function(l,h){$i(this),this.g.forEach(function(p,g){p.forEach(function(A){l.call(h,A,g,this)},this)},this)},n.na=function(){$i(this);let l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let g=0;g<h.length;g++){let A=l[g];for(let O=0;O<A.length;O++)p.push(h[g])}return p},n.V=function(l){$i(this);let h=[];if(typeof l=="string")ub(this,l)&&(h=h.concat(this.g.get($o(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return $i(this),this.i=null,l=$o(this,l),ub(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function db(l,h,p){lb(l,h),0<p.length&&(l.i=null,l.g.set($o(l,h),M(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var g=h[p];let O=encodeURIComponent(String(g)),U=this.V(g);for(g=0;g<U.length;g++){var A=O;U[g]!==""&&(A+="="+encodeURIComponent(String(U[g]))),l.push(A)}}return this.i=l.join("&")};function $o(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function EL(l,h){h&&!l.j&&($i(l),l.i=null,l.g.forEach(function(p,g){var A=g.toLowerCase();g!=A&&(lb(this,g),db(this,A,p))},l)),l.j=h}function CL(l,h){let p=new Xc;if(a.Image){let g=new Image;g.onload=v(Hi,p,"TestLoadImage: loaded",!0,h,g),g.onerror=v(Hi,p,"TestLoadImage: error",!1,h,g),g.onabort=v(Hi,p,"TestLoadImage: abort",!1,h,g),g.ontimeout=v(Hi,p,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=l}else h(!1)}function TL(l,h){let p=new Xc,g=new AbortController,A=setTimeout(()=>{g.abort(),Hi(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:g.signal}).then(O=>{clearTimeout(A),O.ok?Hi(p,"TestPingServer: ok",!0,h):Hi(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(A),Hi(p,"TestPingServer: error",!1,h)})}function Hi(l,h,p,g,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),g(p)}catch{}}function bL(){this.g=new aL}function SL(l,h,p){let g=p||"";try{sb(l,function(A,O){let U=A;u(A)&&(U=Mg(A)),h.push(g+O+"="+encodeURIComponent(U))})}catch(A){throw h.push(g+"type="+encodeURIComponent("_badmap")),A}}function il(l){this.l=l.Ub||null,this.j=l.eb||!1}w(il,Pg),il.prototype.g=function(){return new Od(this.l,this.j)},il.prototype.i=function(l){return function(){return l}}({});function Od(l,h){Xt.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Od,Xt),n=Od.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ol(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sl(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ol(this)),this.g&&(this.readyState=3,ol(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hb(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function hb(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?sl(this):ol(this),this.readyState==3&&hb(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,sl(this))},n.Qa=function(l){this.g&&(this.response=l,sl(this))},n.ga=function(){this.g&&sl(this)};function sl(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ol(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function ol(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Od.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function fb(l){let h="";return ie(l,function(p,g){h+=g,h+=":",h+=p,h+=`\r
`}),h}function Hg(l,h,p){e:{for(g in p){var g=!1;break e}g=!0}g||(p=fb(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):it(l,h,p))}function _t(l){Xt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(_t,Xt);var DL=/^https?$/i,AL=["POST","PUT"];n=_t.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fg.g(),this.v=this.o?$T(this.o):$T(Fg),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(O){pb(this,O);return}if(l=p||"",p=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var A in g)p.set(A,g[A]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let O of g.keys())p.set(O,g.get(O));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(p.keys()).find(O=>O.toLowerCase()=="content-type"),A=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(AL,h,void 0))||g||A||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,U]of p)this.g.setRequestHeader(O,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vb(this),this.u=!0,this.g.send(l),this.u=!1}catch(O){pb(this,O)}};function pb(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,mb(l),kd(l)}function mb(l){l.A||(l.A=!0,pn(l,"complete"),pn(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,pn(this,"complete"),pn(this,"abort"),kd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),kd(this,!0)),_t.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?gb(this):this.bb())},n.bb=function(){gb(this)};function gb(l){if(l.h&&typeof o<"u"&&(!l.v[1]||ri(l)!=4||l.Z()!=2)){if(l.u&&ri(l)==4)VT(l.Ea,0,l);else if(pn(l,"readystatechange"),ri(l)==4){l.h=!1;try{let U=l.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var g;if(g=U===0){var A=String(l.D).match(ob)[1]||null;!A&&a.self&&a.self.location&&(A=a.self.location.protocol.slice(0,-1)),g=!DL.test(A?A.toLowerCase():"")}p=g}if(p)pn(l,"complete"),pn(l,"success");else{l.m=6;try{var O=2<ri(l)?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.Z()+"]",mb(l)}}finally{kd(l)}}}}function kd(l,h){if(l.g){vb(l);let p=l.g,g=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||pn(l,"ready");try{p.onreadystatechange=g}catch{}}}function vb(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function ri(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<ri(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),oL(h)}};function _b(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function RL(l){let h={};l=(l.g&&2<=ri(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<l.length;g++){if(q(l[g]))continue;var p=D(l[g]);let A=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let O=h[A]||[];h[A]=O,O.push(p)}C(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function al(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function yb(l){this.Aa=0,this.i=[],this.j=new Xc,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=al("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=al("baseRetryDelayMs",5e3,l),this.cb=al("retryDelaySeedMs",1e4,l),this.Wa=al("forwardChannelMaxRetries",2,l),this.wa=al("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new eb(l&&l.concurrentRequestLimit),this.Da=new bL,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=yb.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,g){mn(0),this.W=l,this.H=h||{},p&&g!==void 0&&(this.H.OSID=p,this.H.OAID=g),this.F=this.X,this.I=Ab(this,null,this.W),Ld(this)};function qg(l){if(wb(l),l.G==3){var h=l.U++,p=ni(l.I);if(it(p,"SID",l.K),it(p,"RID",h),it(p,"TYPE","terminate"),cl(l,p),h=new Bi(l,l.j,h),h.L=2,h.v=Pd(ni(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=Rb(h.j,null),h.g.ea(h.v)),h.F=Date.now(),xd(h)}Db(l)}function Fd(l){l.g&&(zg(l),l.g.cancel(),l.g=null)}function wb(l){Fd(l),l.u&&(a.clearTimeout(l.u),l.u=null),Vd(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Ld(l){if(!tb(l.h)&&!l.s){l.s=!0;var h=l.Ga;Gc||MT(),zc||(Gc(),zc=!0),Cg.add(h,l),l.B=0}}function xL(l,h){return nb(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Jc(m(l.Ga,l,h),Sb(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let A=new Bi(this,this.j,l),O=this.o;if(this.S&&(O?(O=y(O),T(O,this.S)):O=this.S),this.m!==null||this.O||(A.H=O,O=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var g=this.i[p];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Eb(this,A,h),p=ni(this.I),it(p,"RID",l),it(p,"CVER",22),this.D&&it(p,"X-HTTP-Session-Id",this.D),cl(this,p),O&&(this.O?h="headers="+encodeURIComponent(String(fb(O)))+"&"+h:this.m&&Hg(p,this.m,O)),$g(this.h,A),this.Ua&&it(p,"TYPE","init"),this.P?(it(p,"$req",h),it(p,"SID","null"),A.T=!0,Vg(A,p,null)):Vg(A,p,h),this.G=2}}else this.G==3&&(l?Ib(this,l):this.i.length==0||tb(this.h)||Ib(this))};function Ib(l,h){var p;h?p=h.l:p=l.U++;let g=ni(l.I);it(g,"SID",l.K),it(g,"RID",p),it(g,"AID",l.T),cl(l,g),l.m&&l.o&&Hg(g,l.m,l.o),p=new Bi(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Eb(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),$g(l.h,p),Vg(p,g,h)}function cl(l,h){l.H&&ie(l.H,function(p,g){it(h,g,p)}),l.l&&sb({},function(p,g){it(h,g,p)})}function Eb(l,h,p){p=Math.min(l.i.length,p);var g=l.l?m(l.l.Na,l.l,l):null;e:{var A=l.i;let O=-1;for(;;){let U=["count="+p];O==-1?0<p?(O=A[0].g,U.push("ofs="+O)):O=0:U.push("ofs="+O);let Ze=!0;for(let Kt=0;Kt<p;Kt++){let Le=A[Kt].g,en=A[Kt].map;if(Le-=O,0>Le)O=Math.max(0,A[Kt].g-100),Ze=!1;else try{SL(en,U,"req"+Le+"_")}catch{g&&g(en)}}if(Ze){g=U.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,g}function Cb(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Gc||MT(),zc||(Gc(),zc=!0),Cg.add(h,l),l.v=0}}function Gg(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Jc(m(l.Fa,l),Sb(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,Tb(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Jc(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mn(10),Fd(this),Tb(this))};function zg(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Tb(l){l.g=new Bi(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=ni(l.qa);it(h,"RID","rpc"),it(h,"SID",l.K),it(h,"AID",l.T),it(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&it(h,"TO",l.ja),it(h,"TYPE","xmlhttp"),cl(l,h),l.m&&l.o&&Hg(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Pd(ni(h)),p.m=null,p.P=!0,ZT(p,l)}n.Za=function(){this.C!=null&&(this.C=null,Fd(this),Gg(this),mn(19))};function Vd(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function bb(l,h){var p=null;if(l.g==h){Vd(l),zg(l),l.g=null;var g=2}else if(Bg(l.h,h))p=h.D,rb(l.h,h),g=1;else return;if(l.G!=0){if(h.o)if(g==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var A=l.B;g=Dd(),pn(g,new WT(g,p)),Ld(l)}else Cb(l);else if(A=h.s,A==3||A==0&&0<h.X||!(g==1&&xL(l,h)||g==2&&Gg(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),A){case 1:Ds(l,5);break;case 4:Ds(l,10);break;case 3:Ds(l,6);break;default:Ds(l,2)}}}function Sb(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Ds(l,h){if(l.j.info("Error code "+h),h==2){var p=m(l.fb,l),g=l.Xa;let A=!g;g=new Ss(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Nd(g,"https"),Pd(g),A?CL(g.toString(),p):TL(g.toString(),p)}else mn(2);l.G=0,l.l&&l.l.sa(h),Db(l),wb(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),mn(2)):(this.j.info("Failed to ping google.com"),mn(1))};function Db(l){if(l.G=0,l.ka=[],l.l){let h=ib(l.h);(h.length!=0||l.i.length!=0)&&(R(l.ka,h),R(l.ka,l.i),l.h.i.length=0,M(l.i),l.i.length=0),l.l.ra()}}function Ab(l,h,p){var g=p instanceof Ss?ni(p):new Ss(p);if(g.g!="")h&&(g.g=h+"."+g.g),Md(g,g.s);else{var A=a.location;g=A.protocol,h=h?h+"."+A.hostname:A.hostname,A=+A.port;var O=new Ss(null);g&&Nd(O,g),h&&(O.g=h),A&&Md(O,A),p&&(O.l=p),g=O}return p=l.D,h=l.ya,p&&h&&it(g,p,h),it(g,"VER",l.la),cl(l,g),g}function Rb(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new _t(new il({eb:p})):new _t(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function xb(){}n=xb.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ud(){}Ud.prototype.g=function(l,h){return new Un(l,h)};function Un(l,h){Xt.call(this),this.g=new yb(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!q(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!q(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ho(this)}w(Un,Xt),Un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){qg(this.g)},Un.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Mg(l),l=p);h.i.push(new fL(h.Ya++,l)),h.G==3&&Ld(h)},Un.prototype.N=function(){this.g.l=null,delete this.j,qg(this.g),delete this.g,Un.aa.N.call(this)};function Nb(l){Og.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}w(Nb,Og);function Mb(){kg.call(this),this.status=1}w(Mb,kg);function Ho(l){this.g=l}w(Ho,xb),Ho.prototype.ua=function(){pn(this.g,"a")},Ho.prototype.ta=function(l){pn(this.g,new Nb(l))},Ho.prototype.sa=function(l){pn(this.g,new Mb)},Ho.prototype.ra=function(){pn(this.g,"b")},Ud.prototype.createWebChannel=Ud.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,dI=Ri.createWebChannelTransport=function(){return new Ud},uI=Ri.getStatEventTarget=function(){return Dd()},lI=Ri.Event=Ts,xp=Ri.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ad.NO_ERROR=0,Ad.TIMEOUT=8,Ad.HTTP_ERROR=6,Iu=Ri.ErrorCode=Ad,KT.COMPLETE="complete",cI=Ri.EventType=KT,HT.EventType=Yc,Yc.OPEN="a",Yc.CLOSE="b",Yc.ERROR="c",Yc.MESSAGE="d",Xt.prototype.listen=Xt.prototype.K,Ha=Ri.WebChannel=HT,P4=Ri.FetchXmlHttpFactory=il,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,aI=Ri.XhrIo=_t}).apply(typeof Rp<"u"?Rp:typeof self<"u"?self:typeof window<"u"?window:{});var sM="@firebase/firestore";var zt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};zt.UNAUTHENTICATED=new zt(null),zt.GOOGLE_CREDENTIALS=new zt("google-credentials-uid"),zt.FIRST_PARTY=new zt("first-party-uid"),zt.MOCK_USER=new zt("mock-user");var cc="10.14.0";var vo=new Mr("@firebase/firestore");function Eu(){return vo.logLevel}function z(n,...e){if(vo.logLevel<=rn.DEBUG){let t=e.map(WE);vo.debug(`Firestore (${cc}): ${n}`,...t)}}function xi(n,...e){if(vo.logLevel<=rn.ERROR){let t=e.map(WE);vo.error(`Firestore (${cc}): ${n}`,...t)}}function Ya(n,...e){if(vo.logLevel<=rn.WARN){let t=e.map(WE);vo.warn(`Firestore (${cc}): ${n}`,...t)}}function WE(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ce(n="Unexpected state"){let e=`FIRESTORE (${cc}) INTERNAL ASSERTION FAILED: `+n;throw xi(e),new Error(e)}function ze(n,e){n||ce()}function fe(n,e){return n}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},G=class extends Tn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Kr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var kp=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},gI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(zt.UNAUTHENTICATED))}shutdown(){}},vI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},_I=class{constructor(e){this.t=e,this.currentUser=zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ze(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Kr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Kr,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>_(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Kr)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ze(typeof r.accessToken=="string"),new kp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ze(e===null||typeof e=="string"),new zt(e)}},yI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},wI=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new yI(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},II=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},EI=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ze(this.o===void 0);let r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ze(typeof t.token=="string"),this.R=t.token,new II(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function O4(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Fp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=O4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function je(n,e){return n<e?-1:n>e?1:0}function Za(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Rt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ve=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Rt(0,0))}static max(){return new n(new Rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Lp=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ce(),r===void 0?r=e.length-t:r>e.length-t&&ce(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},mt=class n extends Lp{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},k4=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zn=class n extends Lp{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return k4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ee=class n{constructor(e){this.path=e}static fromPath(e){return new n(mt.fromString(e))}static fromName(e){return new n(mt.fromString(e).popFirst(5))}static empty(){return new n(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new mt(e.slice()))}};var CI=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};CI.UNKNOWN_ID=-1;function F4(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(r===1e9?new Rt(t+1,0):new Rt(t,r));return new _o(i,ee.empty(),e)}function L4(n){return new _o(n.readTime,n.key,-1)}var _o=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ve.min(),ee.empty(),-1)}static max(){return new n(ve.max(),ee.empty(),-1)}};function V4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ee.comparator(n.documentKey,e.documentKey),t!==0?t:je(n.largestBatchId,e.largestBatchId))}var U4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",TI=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Bu(n){return _(this,null,function*(){if(n.code!==F.FAILED_PRECONDITION||n.message!==U4)throw n;z("LocalStore","Unexpectedly lost primary lease")})}var V=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function j4(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function $u(n){return n.name==="IndexedDbTransactionError"}var jM=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function pm(n){return n==null}function Au(n){return n===0&&1/n==-1/0}function B4(n){return typeof n=="number"&&Number.isInteger(n)&&!Au(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var $4=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Aoe=[...$4,"documentOverlays"],H4=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],q4=H4,G4=[...q4,"indexConfiguration","indexState","indexEntries"];var Roe=[...G4,"globals"];function oM(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function lc(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function BM(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ct=class n{constructor(e,t){this.comparator=e,this.root=t||Qr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wa(this.root,e,this.comparator,!0)}},Wa=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Qr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ce();let e=this.left.check();if(e!==this.right.check())throw ce();return e+(this.isRed()?0:1)}};Qr.EMPTY=null,Qr.RED=!0,Qr.BLACK=!1;Qr.EMPTY=new class{constructor(){this.size=0}get key(){throw ce()}get value(){throw ce()}get color(){throw ce()}get left(){throw ce()}get right(){throw ce()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Qr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var an=class n{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Vp(this.data.getIterator())}getIteratorFrom(e){return new Vp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Vp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Wr=class n{constructor(e){this.fields=e,e.sort(zn.comparator)}static empty(){return new n([])}unionWith(e){let t=new an(zn.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Za(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Up=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var cn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Up("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};cn.EMPTY_BYTE_STRING=new cn("");var z4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(n){if(ze(!!n),typeof n=="string"){let e=0,t=z4.exec(n);if(ze(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(n.seconds),nanos:ut(n.nanos)}}function ut(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _s(n){return typeof n=="string"?cn.fromBase64String(n):cn.fromUint8Array(n)}function KE(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function QE(n){let e=n.mapValue.fields.__previous_value__;return KE(e)?QE(e):e}function Ru(n){let e=Ni(n.mapValue.fields.__local_write_time__.timestampValue);return new Rt(e.seconds,e.nanos)}var bI=class{constructor(e,t,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},jp=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Np={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function yo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?KE(n)?4:HM(n)?9007199254740991:$M(n)?10:11:ce()}function Jr(n,e){if(n===e)return!0;let t=yo(n);if(t!==yo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ru(n).isEqual(Ru(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ni(i.timestampValue),a=Ni(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return _s(i.bytesValue).isEqual(_s(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?Au(o)===Au(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Za(n.arrayValue.values||[],e.arrayValue.values||[],Jr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(oM(o)!==oM(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Jr(o[c],a[c])))return!1;return!0}(n,e);default:return ce()}}function xu(n,e){return(n.values||[]).find(t=>Jr(t,e))!==void 0}function Ja(n,e){if(n===e)return 0;let t=yo(n),r=yo(e);if(t!==r)return je(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return je(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=ut(s.integerValue||s.doubleValue),c=ut(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return aM(n.timestampValue,e.timestampValue);case 4:return aM(Ru(n),Ru(e));case 5:return je(n.stringValue,e.stringValue);case 6:return function(s,o){let a=_s(s),c=_s(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=je(a[u],c[u]);if(d!==0)return d}return je(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=je(ut(s.latitude),ut(o.latitude));return a!==0?a:je(ut(s.longitude),ut(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return cM(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,u,d;let f=s.fields||{},m=o.fields||{},v=(a=f.value)===null||a===void 0?void 0:a.arrayValue,w=(c=m.value)===null||c===void 0?void 0:c.arrayValue,M=je(((u=v?.values)===null||u===void 0?void 0:u.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return M!==0?M:cM(v,w)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Np.mapValue&&o===Np.mapValue)return 0;if(s===Np.mapValue)return 1;if(o===Np.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let m=je(c[f],d[f]);if(m!==0)return m;let v=Ja(a[c[f]],u[d[f]]);if(v!==0)return v}return je(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ce()}}function aM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return je(n,e);let t=Ni(n),r=Ni(e),i=je(t.seconds,r.seconds);return i!==0?i:je(t.nanos,r.nanos)}function cM(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Ja(t[i],r[i]);if(s)return s}return je(t.length,r.length)}function Xa(n){return SI(n)}function SI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Ni(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return _s(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ee.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=SI(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${SI(t.fields[o])}`;return i+"}"}(n.mapValue):ce()}function lM(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function DI(n){return!!n&&"integerValue"in n}function YE(n){return!!n&&"arrayValue"in n}function uM(n){return!!n&&"nullValue"in n}function dM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pp(n){return!!n&&"mapValue"in n}function $M(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Tu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return lc(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Tu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Tu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function HM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Cr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Pp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Tu(t)}setAll(e){let t=zn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Tu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Pp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Pp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){lc(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Tu(this.value))}};function qM(n){let e=[];return lc(n.fields,(t,r)=>{let i=new zn([t]);if(Pp(r)){let s=qM(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Wr(e)}var Tr=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ve.min(),ve.min(),ve.min(),Cr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ve.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ve.min(),ve.min(),Cr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ve.min(),ve.min(),Cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ec=class{constructor(e,t){this.position=e,this.inclusive=t}};function hM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),t.key):r=Ja(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function fM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Jr(n.position[t],e.position[t]))return!1;return!0}var tc=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function W4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Bp=class{},Lt=class n extends Bp{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new RI(e,t,r):t==="array-contains"?new MI(e,r):t==="in"?new PI(e,r):t==="not-in"?new OI(e,r):t==="array-contains-any"?new kI(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new xI(e,r):new NI(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ja(t,this.value)):t!==null&&yo(this.value)===yo(t)&&this.matchesComparison(Ja(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},br=class n extends Bp{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return GM(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function GM(n){return n.op==="and"}function zM(n){return K4(n)&&GM(n)}function K4(n){for(let e of n.filters)if(e instanceof br)return!1;return!0}function AI(n){if(n instanceof Lt)return n.field.canonicalString()+n.op.toString()+Xa(n.value);if(zM(n))return n.filters.map(e=>AI(e)).join(",");{let e=n.filters.map(t=>AI(t)).join(",");return`${n.op}(${e})`}}function WM(n,e){return n instanceof Lt?function(r,i){return i instanceof Lt&&r.op===i.op&&r.field.isEqual(i.field)&&Jr(r.value,i.value)}(n,e):n instanceof br?function(r,i){return i instanceof br&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&WM(o,i.filters[a]),!0):!1}(n,e):void ce()}function KM(n){return n instanceof Lt?function(t){return`${t.field.canonicalString()} ${t.op} ${Xa(t.value)}`}(n):n instanceof br?function(t){return t.op.toString()+" {"+t.getFilters().map(KM).join(" ,")+"}"}(n):"Filter"}var RI=class extends Lt{constructor(e,t,r){super(e,t,r),this.key=ee.fromName(r.referenceValue)}matches(e){let t=ee.comparator(e.key,this.key);return this.matchesComparison(t)}},xI=class extends Lt{constructor(e,t){super(e,"in",t),this.keys=QM("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},NI=class extends Lt{constructor(e,t){super(e,"not-in",t),this.keys=QM("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function QM(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ee.fromName(r.referenceValue))}var MI=class extends Lt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return YE(t)&&xu(t.arrayValue,this.value)}},PI=class extends Lt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&xu(this.value.arrayValue,t)}},OI=class extends Lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!xu(this.value.arrayValue,t)}},kI=class extends Lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!YE(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>xu(this.value.arrayValue,r))}};var FI=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function pM(n,e=null,t=[],r=[],i=null,s=null,o=null){return new FI(n,e,t,r,i,s,o)}function ZE(n){let e=fe(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>AI(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),pm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Xa(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Xa(r)).join(",")),e.ue=t}return e.ue}function JE(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!W4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!WM(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!fM(n.startAt,e.startAt)&&fM(n.endAt,e.endAt)}function LI(n){return ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wo=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Q4(n,e,t,r,i,s,o,a){return new wo(n,e,t,r,i,s,o,a)}function XE(n){return new wo(n)}function mM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function YM(n){return n.collectionGroup!==null}function bu(n){let e=fe(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new an(zn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new tc(s,r))}),t.has(zn.keyField().canonicalString())||e.ce.push(new tc(zn.keyField(),r))}return e.ce}function Yr(n){let e=fe(n);return e.le||(e.le=Y4(e,bu(n))),e.le}function Y4(n,e){if(n.limitType==="F")return pM(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new tc(i.field,s)});let t=n.endAt?new ec(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ec(n.startAt.position,n.startAt.inclusive):null;return pM(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function VI(n,e){let t=n.filters.concat([e]);return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function UI(n,e,t){return new wo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function mm(n,e){return JE(Yr(n),Yr(e))&&n.limitType===e.limitType}function ZM(n){return`${ZE(Yr(n))}|lt:${n.limitType}`}function qa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>KM(i)).join(", ")}]`),pm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Xa(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Xa(i)).join(",")),`Target(${r})`}(Yr(n))}; limitType=${n.limitType})`}function gm(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ee.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of bu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=hM(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,bu(r),i)||r.endAt&&!function(o,a,c){let u=hM(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,bu(r),i))}(n,e)}function Z4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JM(n){return(e,t)=>{let r=!1;for(let i of bu(n)){let s=J4(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function J4(n,e,t){let r=n.field.isKeyField()?ee.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Ja(c,u):ce()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ce()}}var ys=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lc(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return BM(this.inner)}size(){return this.innerSize}};var X4=new Ct(ee.comparator);function Mi(){return X4}var XM=new Ct(ee.comparator);function Cu(...n){let e=XM;for(let t of n)e=e.insert(t.key,t);return e}function eP(n){let e=XM;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function fo(){return Su()}function tP(){return Su()}function Su(){return new ys(n=>n.toString(),(n,e)=>n.isEqual(e))}var e3=new Ct(ee.comparator),t3=new an(ee.comparator);function Re(...n){let e=t3;for(let t of n)e=e.add(t);return e}var n3=new an(je);function r3(){return n3}function eC(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function nP(n){return{integerValue:""+n}}function i3(n,e){return B4(e)?nP(e):eC(n,e)}var nc=class{constructor(){this._=void 0}};function s3(n,e,t){return n instanceof rc?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&KE(s)&&(s=QE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Io?iP(n,e):n instanceof Eo?sP(n,e):function(i,s){let o=rP(i,s),a=gM(o)+gM(i.Pe);return DI(o)&&DI(i.Pe)?nP(a):eC(i.serializer,a)}(n,e)}function o3(n,e,t){return n instanceof Io?iP(n,e):n instanceof Eo?sP(n,e):t}function rP(n,e){return n instanceof ic?function(r){return DI(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var rc=class extends nc{},Io=class extends nc{constructor(e){super(),this.elements=e}};function iP(n,e){let t=oP(e);for(let r of n.elements)t.some(i=>Jr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Eo=class extends nc{constructor(e){super(),this.elements=e}};function sP(n,e){let t=oP(e);for(let r of n.elements)t=t.filter(i=>!Jr(i,r));return{arrayValue:{values:t}}}var ic=class extends nc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function gM(n){return ut(n.integerValue||n.doubleValue)}function oP(n){return YE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function a3(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Io&&i instanceof Io||r instanceof Eo&&i instanceof Eo?Za(r.elements,i.elements,Jr):r instanceof ic&&i instanceof ic?Jr(r.Pe,i.Pe):r instanceof rc&&i instanceof rc}(n.transform,e.transform)}var jI=class{constructor(e,t){this.version=e,this.transformResults=t}},go=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Op(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var sc=class{};function aP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $p(n.key,go.none()):new Co(n.key,n.data,go.none());{let t=n.data,r=Cr.empty(),i=new an(zn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Pi(n.key,r,new Wr(i.toArray()),go.none())}}function c3(n,e,t){n instanceof Co?function(i,s,o){let a=i.value.clone(),c=_M(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Pi?function(i,s,o){if(!Op(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=_M(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(cP(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Du(n,e,t,r){return n instanceof Co?function(s,o,a,c){if(!Op(s.precondition,o))return a;let u=s.value.clone(),d=yM(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Pi?function(s,o,a,c){if(!Op(s.precondition,o))return a;let u=yM(s.fieldTransforms,c,o),d=o.data;return d.setAll(cP(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return Op(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function l3(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=rP(r.transform,i||null);s!=null&&(t===null&&(t=Cr.empty()),t.set(r.field,s))}return t||null}function vM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Za(r,i,(s,o)=>a3(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Co=class extends sc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Pi=class extends sc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function cP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function _M(n,e,t){let r=new Map;ze(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,o3(o,a,t[i]))}return r}function yM(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,s3(s,o,e))}return r}var $p=class extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},BI=class extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var $I=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&c3(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Du(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Du(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=tP();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=aP(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Re())}isEqual(e){return this.batchId===e.batchId&&Za(this.mutations,e.mutations,(t,r)=>vM(t,r))&&Za(this.baseMutations,e.baseMutations,(t,r)=>vM(t,r))}},HI=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ze(e.mutations.length===r.length);let i=function(){return e3}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var qI=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var GI=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var kt,Oe;function u3(n){switch(n){default:return ce();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function lP(n){if(n===void 0)return xi("GRPC error has no .code"),F.UNKNOWN;switch(n){case kt.OK:return F.OK;case kt.CANCELLED:return F.CANCELLED;case kt.UNKNOWN:return F.UNKNOWN;case kt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case kt.INTERNAL:return F.INTERNAL;case kt.UNAVAILABLE:return F.UNAVAILABLE;case kt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case kt.NOT_FOUND:return F.NOT_FOUND;case kt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case kt.ABORTED:return F.ABORTED;case kt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case kt.DATA_LOSS:return F.DATA_LOSS;default:return ce()}}(Oe=kt||(kt={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";var wM=null;function d3(){return new TextEncoder}var h3=new ms([4294967295,4294967295],0);function IM(n){let e=d3().encode(n),t=new oI;return t.update(e),new Uint8Array(t.digest())}function EM(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ms([t,r],0),new ms([i,s],0)]}var zI=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new po(`Invalid padding: ${t}`);if(r<0)throw new po(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new po(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new po(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ms.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ms.fromNumber(r)));return i.compare(h3)===1&&(i=new ms([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=IM(e),[r,i]=EM(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=IM(e),[r,i]=EM(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},po=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Hp=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ve.min(),i,new Ct(je),Mi(),Re())}},Nu=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Re(),Re(),Re())}};var Ka=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},qp=class{constructor(e,t){this.targetId=e,this.me=t}},Gp=class{constructor(e,t,r=cn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},zp=class{constructor(){this.fe=0,this.ge=TM(),this.pe=cn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Re(),t=Re(),r=Re();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ce()}}),new Nu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=TM()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ze(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},WI=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mi(),this.qe=CM(),this.Qe=new Ct(je)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:ce()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(LI(s))if(r===0){let o=new ee(s.path);this.Ue(t,o,Tr.newNoDocument(o,ve.min()))}else ze(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}wM?.et(function(d,f,m,v,w){var M,R,L,q,W,te;let Ye={localCacheCount:d,existenceFilterCount:f.count,databaseId:m.database,projectId:m.projectId},ie=f.unchangedNames;return ie&&(Ye.bloomFilter={applied:w===0,hashCount:(M=ie?.hashCount)!==null&&M!==void 0?M:0,bitmapLength:(q=(L=(R=ie?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&q!==void 0?q:0,padding:(te=(W=ie?.bits)===null||W===void 0?void 0:W.padding)!==null&&te!==void 0?te:0,mightContain:C=>{var y;return(y=v?.mightContain(C))!==null&&y!==void 0&&y}}),Ye}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=_s(r).toUint8Array()}catch(c){if(c instanceof Up)return Ya("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new zI(o,i,s)}catch(c){return Ya(c instanceof po?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&LI(a.target)){let c=new ee(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Tr.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=Re();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Hp(e,t,this.Qe,this.ke,r);return this.ke=Mi(),this.qe=CM(),this.Qe=new Ct(je),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new zp,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new an(je),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||z("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zp),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function CM(){return new Ct(ee.comparator)}function TM(){return new Ct(ee.comparator)}var f3={asc:"ASCENDING",desc:"DESCENDING"},p3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},m3={and:"AND",or:"OR"},KI=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function QI(n,e){return n.useProto3Json||pm(e)?e:{value:e}}function Wp(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function g3(n,e){return Wp(n,e.toTimestamp())}function Zr(n){return ze(!!n),ve.fromTimestamp(function(t){let r=Ni(t);return new Rt(r.seconds,r.nanos)}(n))}function tC(n,e){return YI(n,e).canonicalString()}function YI(n,e){let t=function(i){return new mt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function dP(n){let e=mt.fromString(n);return ze(gP(e)),e}function ZI(n,e){return tC(n.databaseId,e.path)}function hI(n,e){let t=dP(e);if(t.get(1)!==n.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ee(fP(t))}function hP(n,e){return tC(n.databaseId,e)}function v3(n){let e=dP(n);return e.length===4?mt.emptyPath():fP(e)}function JI(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function fP(n){return ze(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function bM(n,e,t){return{name:ZI(n,e),fields:t.value.mapValue.fields}}function _3(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(ze(d===void 0||typeof d=="string"),cn.fromBase64String(d||"")):(ze(d===void 0||d instanceof Buffer||d instanceof Uint8Array),cn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let d=u.code===void 0?F.UNKNOWN:lP(u.code);return new G(d,u.message||"")}(o);t=new Gp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=hI(n,r.document.name),s=Zr(r.document.updateTime),o=r.document.createTime?Zr(r.document.createTime):ve.min(),a=new Cr({mapValue:{fields:r.document.fields}}),c=Tr.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Ka(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=hI(n,r.document),s=r.readTime?Zr(r.readTime):ve.min(),o=Tr.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Ka([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=hI(n,r.document),s=r.removedTargetIds||[];t=new Ka([],s,i,null)}else{if(!("filter"in e))return ce();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new GI(i,s),a=r.targetId;t=new qp(a,o)}}return t}function y3(n,e){let t;if(e instanceof Co)t={update:bM(n,e.key,e.value)};else if(e instanceof $p)t={delete:ZI(n,e.key)};else if(e instanceof Pi)t={update:bM(n,e.key,e.data),updateMask:A3(e.fieldMask)};else{if(!(e instanceof BI))return ce();t={verify:ZI(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof rc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Io)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Eo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ic)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ce()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:g3(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ce()}(n,e.precondition)),t}function w3(n,e){return n&&n.length>0?(ze(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Zr(i.updateTime):Zr(s);return o.isEqual(ve.min())&&(o=Zr(s)),new jI(o,i.transformResults||[])}(t,e))):[]}function I3(n,e){return{documents:[hP(n,e.path)]}}function E3(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=hP(n,i);let s=function(u){if(u.length!==0)return mP(br.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:Ga(m.field),direction:b3(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=QI(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function C3(n){let e=v3(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ze(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){let m=pP(f);return m instanceof br&&zM(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(m=>function(w){return new tc(za(w.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,pm(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(f){let m=!!f.before,v=f.values||[];return new ec(v,m)}(t.startAt));let u=null;return t.endAt&&(u=function(f){let m=!f.before,v=f.values||[];return new ec(v,m)}(t.endAt)),Q4(e,i,o,s,a,"F",c,u)}function T3(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function pP(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=za(t.unaryFilter.field);return Lt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=za(t.unaryFilter.field);return Lt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=za(t.unaryFilter.field);return Lt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=za(t.unaryFilter.field);return Lt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ce()}}(n):n.fieldFilter!==void 0?function(t){return Lt.create(za(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ce()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return br.create(t.compositeFilter.filters.map(r=>pP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ce()}}(t.compositeFilter.op))}(n):ce()}function b3(n){return f3[n]}function S3(n){return p3[n]}function D3(n){return m3[n]}function Ga(n){return{fieldPath:n.canonicalString()}}function za(n){return zn.fromServerFormat(n.fieldPath)}function mP(n){return n instanceof Lt?function(t){if(t.op==="=="){if(dM(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NAN"}};if(uM(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dM(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NAN"}};if(uM(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ga(t.field),op:S3(t.op),value:t.value}}}(n):n instanceof br?function(t){let r=t.getFilters().map(i=>mP(i));return r.length===1?r[0]:{compositeFilter:{op:D3(t.op),filters:r}}}(n):ce()}function A3(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function gP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Mu=class n{constructor(e,t,r,i,s=ve.min(),o=ve.min(),a=cn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var XI=class{constructor(e){this.ct=e}};function R3(n){let e=C3({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?UI(e,e.limit,"L"):e}var Kp=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ut(e.integerValue));else if("doubleValue"in e){let r=ut(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Au(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ni(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(_s(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?HM(e)?this.dt(t,Number.MAX_SAFE_INTEGER):$M(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):ce()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ut(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),ee.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Kp.vt=new Kp;var eE=class{constructor(){this.un=new tE}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(_o.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(_o.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}},tE=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new an(mt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new an(mt.comparator)).toArray()}};var Noe=new Uint8Array(0);var zr=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};zr.DEFAULT_COLLECTION_PERCENTILE=10,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zr.DEFAULT=new zr(41943040,zr.DEFAULT_COLLECTION_PERCENTILE,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zr.DISABLED=new zr(-1,0,0);var Pu=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var nE=class{constructor(){this.changes=new ys(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var rE=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var iE=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Du(r.mutation,i,Wr.empty(),Rt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Re()){let i=fo();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Cu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=fo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Re()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Mi(),o=Su(),a=function(){return Su()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Pi)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Du(d.mutation,u,d.mutation.getFieldMask(),Rt.now())):o.set(u.key,Wr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new rE(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Su(),i=new Ct((o,a)=>o-a),s=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||Wr.empty();d=a.applyToLocalView(u,d),r.set(c,d);let f=(i.get(a.batchId)||Re()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,f=tP();d.forEach(m=>{if(!s.has(m)){let v=aP(t.get(m),r.get(m));v!==null&&f.set(m,v),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):YM(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(fo()),a=-1,c=s;return o.next(u=>V.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,Re())).next(d=>({batchId:a,changes:eP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next(r=>{let i=Cu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Cu();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,c=>{let u=function(f,m){return new wo(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,u)=>{let d=u.getKey();o.get(d)===null&&(o=o.insert(d,Tr.newInvalidDocument(d)))});let a=Cu();return o.forEach((c,u)=>{let d=s.get(c);d!==void 0&&Du(d.mutation,u,Wr.empty(),Rt.now()),gm(t,u)&&(a=a.insert(c,u))}),a})}};var sE=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Zr(i.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:R3(i.bundledQuery),readTime:Zr(i.readTime)}}(t)),V.resolve()}};var oE=class{constructor(){this.overlays=new Ct(ee.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){let r=fo();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){let i=fo(),s=t.length+1,o=new ee(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ct((u,d)=>u-d),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=fo(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=fo(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return V.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new qI(t,r));let s=this.Ir.get(t);s===void 0&&(s=Re(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var aE=class{constructor(){this.sessionToken=cn.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}};var Ou=class{constructor(){this.Tr=new an(Ft.Er),this.dr=new an(Ft.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Ft(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ft(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new ee(new mt([])),r=new Ft(t,e),i=new Ft(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new ee(new mt([])),r=new Ft(t,e),i=new Ft(t,e+1),s=Re();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ft(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ft=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ee.comparator(e.key,t.key)||je(e.wr,t.wr)}static Ar(e,t){return je(e.wr,t.wr)||ee.comparator(e.key,t.key)}};var cE=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new an(Ft.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new $I(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ft(t,0),i=new Ft(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new an(je);return t.forEach(i=>{let s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;ee.isDocumentKey(s)||(s=s.child(""));let o=new Ft(new ee(s),0),a=new an(je);return this.br.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.wr)),!0)},o),V.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ze(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,i=>{let s=new Ft(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Ft(t,0),i=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var lE=class{constructor(e){this.Mr=e,this.docs=function(){return new Ct(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():Tr.newInvalidDocument(t))}getEntries(e,t){let r=Mi();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tr.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Mi(),o=t.path,a=new ee(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||V4(L4(d),r)<=0||(i.has(d.key)||gm(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ce()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new uE(this)}getSize(e){return V.resolve(this.size)}},uE=class extends nE{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var dE=class{constructor(e){this.persistence=e,this.Nr=new ys(t=>ZE(t),JE),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ou,this.targetCount=0,this.kr=Pu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Pu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}};var hE=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new jM(0),this.Kr=!1,this.Kr=!0,this.$r=new aE,this.referenceDelegate=e(this),this.Ur=new dE(this),this.indexManager=new eE,this.remoteDocumentCache=function(i){return new lE(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new XI(t),this.Gr=new sE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new cE(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){z("MemoryPersistence","Starting transaction:",e);let i=new fE(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},fE=class extends TI{constructor(e){super(),this.currentSequenceNumber=e}},pE=class n{constructor(e){this.persistence=e,this.Jr=new Ou,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw ce()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{let i=ee.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,ve.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var mE=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Re(),i=Re();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var gE=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var vE=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return jb()?8:j4(nn())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new gE;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Eu()<=rn.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",qa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(Eu()<=rn.DEBUG&&z("QueryEngine","Query:",qa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Eu()<=rn.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",qa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yr(t))):V.resolve())}Yi(e,t){if(mM(t))return V.resolve(null);let r=Yr(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=UI(t,null,"F"),r=Yr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Re(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.ts(t,a);return this.ns(t,u,o,c.readTime)?this.Yi(e,UI(t,null,"F")):this.rs(e,u,t,c)}))})))}Zi(e,t,r,i){return mM(t)||i.isEqual(ve.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?V.resolve(null):(Eu()<=rn.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qa(t)),this.rs(e,o,t,F4(i,-1)).next(a=>a))})}ts(e,t){let r=new an(JM(e));return t.forEach((i,s)=>{gm(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Eu()<=rn.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",qa(t)),this.Ji.getDocumentsMatchingQuery(e,t,_o.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var _E=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ct(je),this._s=new ys(s=>ZE(s),JE),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function x3(n,e,t,r){return new _E(n,e,t,r)}function vP(n,e){return _(this,null,function*(){let t=fe(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=Re();for(let u of i){o.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of s){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})})}function N3(n,e){let t=fe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let f=u.batch,m=f.keys(),v=V.resolve();return m.forEach(w=>{v=v.next(()=>d.getEntry(c,w)).next(M=>{let R=u.docVersions.get(w);ze(R!==null),M.version.compareTo(R)<0&&(f.applyToRemoteDocument(M,u),M.isValidDocument()&&(M.setReadTime(u.commitVersion),d.addEntry(M)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Re();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function _P(n){let e=fe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function M3(n,e){let t=fe(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,f)=>{let m=i.get(f);if(!m)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,f)));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(cn.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(f,v),function(M,R,L){return M.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(m,v,d)&&a.push(t.Ur.updateTargetData(s,v))});let c=Mi(),u=Re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(P3(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ve.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(f=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.os=i,s))}function P3(n,e,t){let r=Re(),i=Re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Mi();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function O3(n,e){let t=fe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function k3(n,e){let t=fe(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Mu(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function yE(n,e,t){return _(this,null,function*(){let r=fe(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!$u(o))throw o;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function SM(n,e,t){let r=fe(n),i=ve.min(),s=Re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){let f=fe(c),m=f._s.get(d);return m!==void 0?V.resolve(f.os.get(m)):f.Ur.getTargetData(u,d)}(r,o,Yr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:ve.min(),t?s:Re())).next(a=>(F3(r,Z4(e),a),{documents:a,Ts:s})))}function F3(n,e,t){let r=n.us.get(e)||ve.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Qp=class{constructor(){this.activeTargetIds=r3()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var wE=class{constructor(){this.so=new Qp,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Qp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var IE=class{_o(e){}shutdown(){}};var Yp=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Mp=null;function fI(){return Mp===null?Mp=function(){return 268435456+Math.round(2147483648*Math.random())}():Mp++,"0x"+Mp.toString(16)}var L3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var EE=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var on="WebChannelConnection",CE=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=fI(),c=this.xo(t,r.toUriEncodedString());z("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,c,u,i).then(d=>(z("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Ya("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=L3[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=fI();return new Promise((o,a)=>{let c=new aI;c.setWithCredentials(!0),c.listenOnce(cI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Iu.NO_ERROR:let d=c.getResponseJson();z(on,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Iu.TIMEOUT:z(on,`RPC '${e}' ${s} timed out`),a(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case Iu.HTTP_ERROR:let f=c.getStatus();if(z(on,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let w=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(L)>=0?L:F.UNKNOWN}(v.status);a(new G(w,v.message))}else a(new G(F.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new G(F.UNAVAILABLE,"Connection failed."));break;default:ce()}}finally{z(on,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);z(on,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",u,r,15)})}Bo(e,t,r){let i=fI(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=dI(),a=uI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");z(on,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=o.createWebChannel(d,c),m=!1,v=!1,w=new EE({Io:R=>{v?z(on,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(m||(z(on,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),z(on,`RPC '${e}' stream ${i} sending:`,R),f.send(R))},To:()=>f.close()}),M=(R,L,q)=>{R.listen(L,W=>{try{q(W)}catch(te){setTimeout(()=>{throw te},0)}})};return M(f,Ha.EventType.OPEN,()=>{v||(z(on,`RPC '${e}' stream ${i} transport opened.`),w.yo())}),M(f,Ha.EventType.CLOSE,()=>{v||(v=!0,z(on,`RPC '${e}' stream ${i} transport closed`),w.So())}),M(f,Ha.EventType.ERROR,R=>{v||(v=!0,Ya(on,`RPC '${e}' stream ${i} transport errored:`,R),w.So(new G(F.UNAVAILABLE,"The operation could not be completed")))}),M(f,Ha.EventType.MESSAGE,R=>{var L;if(!v){let q=R.data[0];ze(!!q);let W=q,te=W.error||((L=W[0])===null||L===void 0?void 0:L.error);if(te){z(on,`RPC '${e}' stream ${i} received error:`,te);let Ye=te.status,ie=function(I){let T=kt[I];if(T!==void 0)return lP(T)}(Ye),C=te.message;ie===void 0&&(ie=F.INTERNAL,C="Unknown error status: "+Ye+" with message "+te.message),v=!0,w.So(new G(ie,C)),f.close()}else z(on,`RPC '${e}' stream ${i} received:`,q),w.bo(q)}}),M(a,lI.STAT_EVENT,R=>{R.stat===xp.PROXY?z(on,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===xp.NOPROXY&&z(on,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.wo()},0),w}};function pI(){return typeof document<"u"?document:null}function vm(n){return new KI(n,!0)}var Zp=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Jp=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Zp(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return _(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return _(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return _(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(xi(t.toString()),xi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>_(this,null,function*(){this.state=0,this.start()}))}I_(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},TE=class extends Jp{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=_3(this.serializer,e),r=function(s){if(!("targetChange"in s))return ve.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Zr(o.readTime):ve.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=JI(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=LI(c)?{documents:I3(s,c)}:{query:E3(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=uP(s,o.resumeToken);let u=QI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Wp(s,o.snapshotVersion.toTimestamp());let u=QI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=T3(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=JI(this.serializer),t.removeTarget=e,this.a_(t)}},bE=class extends Jp{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ze(!!e.streamToken),this.lastStreamToken=e.streamToken,ze(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ze(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=w3(e.writeResults,e.commitTime),r=Zr(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=JI(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>y3(this.serializer,r))};this.a_(t)}};var SE=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,YI(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(F.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,YI(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},DE=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(xi(t),this.D_=!1):z("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var AE=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>_(this,null,function*(){So(this)&&(z("RemoteStore","Restarting streams for network reachability change."),yield function(c){return _(this,null,function*(){let u=fe(c);u.L_.add(4),yield Hu(u),u.q_.set("Unknown"),u.L_.delete(4),yield _m(u)})}(this))}))}),this.q_=new DE(r,i)}};function _m(n){return _(this,null,function*(){if(So(n))for(let e of n.B_)yield e(!0)})}function Hu(n){return _(this,null,function*(){for(let e of n.B_)yield e(!1)})}function yP(n,e){let t=fe(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),sC(t)?iC(t):uc(t).r_()&&rC(t,e))}function nC(n,e){let t=fe(n),r=uc(t);t.N_.delete(e),r.r_()&&wP(t,e),t.N_.size===0&&(r.r_()?r.o_():So(t)&&t.q_.set("Unknown"))}function rC(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}uc(n).A_(e)}function wP(n,e){n.Q_.xe(e),uc(n).R_(e)}function iC(n){n.Q_=new WI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),uc(n).start(),n.q_.v_()}function sC(n){return So(n)&&!uc(n).n_()&&n.N_.size>0}function So(n){return fe(n).L_.size===0}function IP(n){n.Q_=void 0}function V3(n){return _(this,null,function*(){n.q_.set("Online")})}function U3(n){return _(this,null,function*(){n.N_.forEach((e,t)=>{rC(n,e)})})}function j3(n,e){return _(this,null,function*(){IP(n),sC(n)?(n.q_.M_(e),iC(n)):n.q_.set("Unknown")})}function B3(n,e,t){return _(this,null,function*(){if(n.q_.set("Online"),e instanceof Gp&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Xp(n,r)}else if(e instanceof Ka?n.Q_.Ke(e):e instanceof qp?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ve.min()))try{let r=yield _P(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(cn.EMPTY_BYTE_STRING,d.snapshotVersion)),wP(s,c);let f=new Mu(d.target,c,u,d.sequenceNumber);rC(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){z("RemoteStore","Failed to raise snapshot:",r),yield Xp(n,r)}})}function Xp(n,e,t){return _(this,null,function*(){if(!$u(e))throw e;n.L_.add(1),yield Hu(n),n.q_.set("Offline"),t||(t=()=>_P(n.localStore)),n.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){z("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield _m(n)}))})}function EP(n,e){return e().catch(t=>Xp(n,t,e))}function ym(n){return _(this,null,function*(){let e=fe(n),t=ws(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;$3(e);)try{let i=yield O3(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,H3(e,i)}catch(i){yield Xp(e,i)}CP(e)&&TP(e)})}function $3(n){return So(n)&&n.O_.length<10}function H3(n,e){n.O_.push(e);let t=ws(n);t.r_()&&t.V_&&t.m_(e.mutations)}function CP(n){return So(n)&&!ws(n).n_()&&n.O_.length>0}function TP(n){ws(n).start()}function q3(n){return _(this,null,function*(){ws(n).p_()})}function G3(n){return _(this,null,function*(){let e=ws(n);for(let t of n.O_)e.m_(t.mutations)})}function z3(n,e,t){return _(this,null,function*(){let r=n.O_.shift(),i=HI.from(r,e,t);yield EP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ym(n)})}function W3(n,e){return _(this,null,function*(){e&&ws(n).V_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return u3(o)&&o!==F.ABORTED}(i.code)){let s=r.O_.shift();ws(r).s_(),yield EP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ym(r)}})}(n,e)),CP(n)&&TP(n)})}function DM(n,e){return _(this,null,function*(){let t=fe(n);t.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");let r=So(t);t.L_.add(3),yield Hu(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield _m(t)})}function K3(n,e){return _(this,null,function*(){let t=fe(n);e?(t.L_.delete(2),yield _m(t)):e||(t.L_.add(2),yield Hu(t),t.q_.set("Unknown"))})}function uc(n){return n.K_||(n.K_=function(t,r,i){let s=fe(t);return s.w_(),new TE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:V3.bind(null,n),Ro:U3.bind(null,n),mo:j3.bind(null,n),d_:B3.bind(null,n)}),n.B_.push(e=>_(this,null,function*(){e?(n.K_.s_(),sC(n)?iC(n):n.q_.set("Unknown")):(yield n.K_.stop(),IP(n))}))),n.K_}function ws(n){return n.U_||(n.U_=function(t,r,i){let s=fe(t);return s.w_(),new bE(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:q3.bind(null,n),mo:W3.bind(null,n),f_:G3.bind(null,n),g_:z3.bind(null,n)}),n.B_.push(e=>_(this,null,function*(){e?(n.U_.s_(),yield ym(n)):(yield n.U_.stop(),n.O_.length>0&&(z("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var RE=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function oC(n,e){if(xi("AsyncQueue",`${e}: ${n}`),$u(n))return new G(F.UNAVAILABLE,`${e}: ${n}`);throw n}var em=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ee.comparator(t.key,r.key):(t,r)=>ee.comparator(t.key,r.key),this.keyedMap=Cu(),this.sortedSet=new Ct(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var tm=class{constructor(){this.W_=new Ct(ee.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ce():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},oc=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,em.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var xE=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},NE=class{constructor(){this.queries=AM(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=fe(t),s=i.queries;i.queries=AM(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new G(F.ABORTED,"Firestore shutting down"))}};function AM(){return new ys(n=>ZM(n),mm)}function bP(n,e){return _(this,null,function*(){let t=fe(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new xE,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=oC(o,`Initialization of query '${qa(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&aC(t)})}function SP(n,e){return _(this,null,function*(){let t=fe(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function Q3(n,e){let t=fe(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&aC(t)}function Y3(n,e,t){let r=fe(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function aC(n){n.Y_.forEach(e=>{e.next()})}var ME,RM;(RM=ME||(ME={})).ea="default",RM.Cache="cache";var nm=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new oc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=oc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ME.Cache}};var rm=class{constructor(e){this.key=e}},im=class{constructor(e){this.key=e}},PE=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Re(),this.mutatedKeys=Re(),this.Aa=JM(e),this.Ra=new em(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new tm,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let m=i.get(d),v=gm(this.query,f)?f:null,w=!!m&&this.mutatedKeys.has(m.key),M=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),R=!1;m&&v?m.data.isEqual(v.data)?w!==M&&(r.track({type:3,doc:v}),R=!0):this.ga(m,v)||(r.track({type:2,doc:v}),R=!0,(c&&this.Aa(v,c)>0||u&&this.Aa(v,u)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),R=!0):m&&!v&&(r.track({type:1,doc:m}),R=!0,(c||u)&&(a=!0)),R&&(v?(o=o.add(v),s=M?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,f)=>function(v,w){let M=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce()}};return M(v)-M(w)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new oc(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new tm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Re(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new im(r))}),this.da.forEach(r=>{e.has(r)||t.push(new rm(r))}),t}ba(e){this.Ta=e.Ts,this.da=Re();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return oc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},OE=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},kE=class{constructor(e){this.key=e,this.va=!1}},FE=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ys(a=>ZM(a),mm),this.Ma=new Map,this.xa=new Set,this.Oa=new Ct(ee.comparator),this.Na=new Map,this.La=new Ou,this.Ba={},this.ka=new Map,this.qa=Pu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Z3(n,e,t=!0){return _(this,null,function*(){let r=MP(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield DP(r,e,t,!0),i})}function J3(n,e){return _(this,null,function*(){let t=MP(n);yield DP(t,e,!0,!1)})}function DP(n,e,t,r){return _(this,null,function*(){let i=yield k3(n.localStore,Yr(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield X3(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&yP(n.remoteStore,i),a})}function X3(n,e,t,r,i){return _(this,null,function*(){n.Ka=(f,m,v)=>function(M,R,L,q){return _(this,null,function*(){let W=R.view.ma(L);W.ns&&(W=yield SM(M.localStore,R.query,!1).then(({documents:C})=>R.view.ma(C,W)));let te=q&&q.targetChanges.get(R.targetId),Ye=q&&q.targetMismatches.get(R.targetId)!=null,ie=R.view.applyChanges(W,M.isPrimaryClient,te,Ye);return NM(M,R.targetId,ie.wa),ie.snapshot})}(n,f,m,v);let s=yield SM(n.localStore,e,!0),o=new PE(e,s.Ts),a=o.ma(s.documents),c=Nu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);NM(n,t,u.wa);let d=new OE(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot})}function e6(n,e,t){return _(this,null,function*(){let r=fe(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!mm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield yE(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&nC(r.remoteStore,i.targetId),LE(r,i.targetId)}).catch(Bu))):(LE(r,i.targetId),yield yE(r.localStore,i.targetId,!0))})}function t6(n,e){return _(this,null,function*(){let t=fe(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),nC(t.remoteStore,r.targetId))})}function n6(n,e,t){return _(this,null,function*(){let r=l6(n);try{let i=yield function(o,a){let c=fe(o),u=Rt.now(),d=a.reduce((v,w)=>v.add(w.key),Re()),f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let w=Mi(),M=Re();return c.cs.getEntries(v,d).next(R=>{w=R,w.forEach((L,q)=>{q.isValidDocument()||(M=M.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,w)).next(R=>{f=R;let L=[];for(let q of a){let W=l3(q,f.get(q.key).overlayedDocument);W!=null&&L.push(new Pi(q.key,W,qM(W.value.mapValue),go.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,L,a)}).next(R=>{m=R;let L=R.applyToLocalDocumentSet(f,M);return c.documentOverlayCache.saveOverlays(v,R.batchId,L)})}).then(()=>({batchId:m.batchId,changes:eP(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ct(je)),u=u.insert(a,c),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,t),yield qu(r,i.changes),yield ym(r.remoteStore)}catch(i){let s=oC(i,"Failed to persist write");t.reject(s)}})}function AP(n,e){return _(this,null,function*(){let t=fe(n);try{let r=yield M3(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?ze(o.va):i.removedDocuments.size>0&&(ze(o.va),o.va=!1))}),yield qu(t,r,e)}catch(r){yield Bu(r)}})}function xM(n,e,t){let r=fe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=fe(o);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(let m of f.j_)m.Z_(a)&&(u=!0)}),u&&aC(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function r6(n,e,t){return _(this,null,function*(){let r=fe(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ct(ee.comparator);o=o.insert(s,Tr.newNoDocument(s,ve.min()));let a=Re().add(s),c=new Hp(ve.min(),new Map,new Ct(je),o,a);yield AP(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),cC(r)}else yield yE(r.localStore,e,!1).then(()=>LE(r,e,t)).catch(Bu)})}function i6(n,e){return _(this,null,function*(){let t=fe(n),r=e.batch.batchId;try{let i=yield N3(t.localStore,e);xP(t,r,null),RP(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield qu(t,i)}catch(i){yield Bu(i)}})}function s6(n,e,t){return _(this,null,function*(){let r=fe(n);try{let i=yield function(o,a){let c=fe(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(ze(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);xP(r,e,t),RP(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield qu(r,i)}catch(i){yield Bu(i)}})}function RP(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function xP(n,e,t){let r=fe(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function LE(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||NP(n,r)})}function NP(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(nC(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),cC(n))}function NM(n,e,t){for(let r of t)r instanceof rm?(n.La.addReference(r.key,e),o6(n,r)):r instanceof im?(z("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||NP(n,r.key)):ce()}function o6(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(z("SyncEngine","New document in limbo: "+t),n.xa.add(r),cC(n))}function cC(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new ee(mt.fromString(e)),r=n.qa.next();n.Na.set(r,new kE(t)),n.Oa=n.Oa.insert(t,r),yP(n.remoteStore,new Mu(Yr(XE(t.path)),r,"TargetPurposeLimboResolution",jM.oe))}}function qu(n,e,t){return _(this,null,function*(){let r=fe(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){let f=u?!u.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);let f=mE.Wi(c.targetId,u);s.push(f)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,u){return _(this,null,function*(){let d=fe(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(u,m=>V.forEach(m.$i,v=>d.persistence.referenceDelegate.addReference(f,m.targetId,v)).next(()=>V.forEach(m.Ui,v=>d.persistence.referenceDelegate.removeReference(f,m.targetId,v)))))}catch(f){if(!$u(f))throw f;z("LocalStore","Failed to update sequence numbers: "+f)}for(let f of u){let m=f.targetId;if(!f.fromCache){let v=d.os.get(m),w=v.snapshotVersion,M=v.withLastLimboFreeSnapshotVersion(w);d.os=d.os.insert(m,M)}}})}(r.localStore,s))})}function a6(n,e){return _(this,null,function*(){let t=fe(n);if(!t.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());let r=yield vP(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new G(F.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield qu(t,r.hs)}})}function c6(n,e){let t=fe(n),r=t.Na.get(e);if(r&&r.va)return Re().add(r.key);{let i=Re(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function MP(n){let e=fe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=AP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r6.bind(null,e),e.Ca.d_=Q3.bind(null,e.eventManager),e.Ca.$a=Y3.bind(null,e.eventManager),e}function l6(n){let e=fe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s6.bind(null,e),e}var MM=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return _(this,null,function*(){this.serializer=vm(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return x3(this.persistence,new vE,t.initialUser,this.serializer)}Ga(t){return new hE(pE.Zr,this.serializer)}Wa(t){return new wE}terminate(){return _(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var u6=(()=>{class n{initialize(t,r){return _(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>xM(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=a6.bind(null,this.syncEngine),yield K3(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new NE}()}createDatastore(t){let r=vm(t.databaseInfo.databaseId),i=function(o){return new CE(o)}(t.databaseInfo);return function(o,a,c,u){return new SE(o,a,c,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,c){return new AE(i,s,o,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>xM(this.syncEngine,r,0),function(){return Yp.D()?new Yp:new IE}())}createSyncEngine(t,r){return function(s,o,a,c,u,d,f){let m=new FE(s,o,a,c,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return _(this,null,function*(){var t,r;yield function(s){return _(this,null,function*(){let o=fe(s);z("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Hu(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var sm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):xi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var VE=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=zt.UNAUTHENTICATED,this.clientId=Fp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>_(this,null,function*(){z("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(z("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=oC(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function mI(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield vP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function PM(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield d6(n);z("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>DM(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>DM(e.remoteStore,i)),n._onlineComponents=e})}function d6(n){return _(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{yield mI(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Ya("Error using user provided cache. Falling back to memory cache: "+t),yield mI(n,new MM)}}else z("FirestoreClient","Using default OfflineComponentProvider"),yield mI(n,new MM);return n._offlineComponents})}function PP(n){return _(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),yield PM(n,n._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),yield PM(n,new u6))),n._onlineComponents})}function h6(n){return PP(n).then(e=>e.syncEngine)}function UE(n){return _(this,null,function*(){let e=yield PP(n),t=e.eventManager;return t.onListen=Z3.bind(null,e.syncEngine),t.onUnlisten=e6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=t6.bind(null,e.syncEngine),t})}function f6(n,e,t={}){let r=new Kr;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,c,u){let d=new sm({next:m=>{d.Za(),o.enqueueAndForget(()=>SP(s,f)),m.fromCache&&c.source==="server"?u.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new nm(a,d,{includeMetadataChanges:!0,_a:!0});return bP(s,f)}(yield UE(n),n.asyncQueue,e,t,r)})),r.promise}function OP(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var OM=new Map;function kP(n,e,t){if(!t)throw new G(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function p6(n,e,t,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kM(n){if(!ee.isDocumentKey(n))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function FM(n){if(ee.isDocumentKey(n))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ce()}function gs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=wm(n);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var om=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}p6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ac=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new om({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new om(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gI;switch(r.type){case"firstParty":return new wI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return _(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=OM.get(t);r&&(z("ComponentProvider","Removing Datastore"),OM.delete(t),r.terminate())}(this),Promise.resolve()}};function FP(n,e,t,r={}){var i;let s=(n=gs(n,ac))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ya("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=zt.MOCK_USER;else{a=zo(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new zt(u)}n._authCredentials=new vI(new kp(a,c))}}var To=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},On=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},vs=class n extends To{constructor(e,t,r){super(e,t,XE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new On(this.firestore,null,new ee(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function LP(n,e,...t){if(n=xe(n),kP("collection","path",e),n instanceof ac){let r=mt.fromString(e,...t);return FM(r),new vs(n,null,r)}{if(!(n instanceof On||n instanceof vs))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(mt.fromString(e,...t));return FM(r),new vs(n.firestore,null,r)}}function VP(n,e,...t){if(n=xe(n),arguments.length===1&&(e=Fp.newId()),kP("doc","path",e),n instanceof ac){let r=mt.fromString(e,...t);return kM(r),new On(n,null,new ee(r))}{if(!(n instanceof On||n instanceof vs))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(mt.fromString(e,...t));return kM(r),new On(n.firestore,n instanceof vs?n.converter:null,new ee(r))}}var am=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Zp(this,"async_queue_retry"),this.Vu=()=>{let r=pI();r&&z("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=pI();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=pI();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Kr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return _(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!$u(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw xi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=RE.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ce()}verifyOperationInProgress(){}wu(){return _(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function LM(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var bo=class extends ac{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new am,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return _(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new am(e),this._firestoreClient=void 0,yield e}})}};function UP(n,e){let t=typeof n=="object"?n:Nt(),r=typeof n=="string"?n:e||"(default)",i=xt(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Gi("firestore");s&&FP(i,...s)}return i}function lC(n){if(n._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||m6(n),n._firestoreClient}function m6(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,u,d){return new bI(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,OP(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new VE(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}var ku=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(cn.fromBase64String(e))}catch(t){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Fu=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var cm=class{constructor(e){this._methodName=e}};var Lu=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}};var Vu=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var g6=/^__.*__$/,jE=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Co(e,this.data,t,this.fieldTransforms)}};function jP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce()}}var BE=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(jP(this.Cu)&&g6.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},$E=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vm(e)}Qu(e,t,r,i=!1){return new BE({Cu:e,methodName:t,qu:r,path:zn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function BP(n){let e=n._freezeSettings(),t=vm(n._databaseId);return new $E(n._databaseId,!!e.ignoreUndefinedProperties,t)}function v6(n,e,t,r,i,s={}){let o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);qP("Data must be an object, but it was:",o,r);let a=$P(r,o),c,u;if(s.merge)c=new Wr(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let f of s.mergeFields){let m=y6(e,f,t);if(!o.contains(m))throw new G(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);I6(d,m)||d.push(m)}c=new Wr(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new jE(new Cr(a),c,u)}function _6(n,e,t,r=!1){return uC(t,n.Qu(r?4:3,e))}function uC(n,e){if(HP(n=xe(n)))return qP("Unsupported field value:",e,n),$P(n,e);if(n instanceof cm)return function(r,i){if(!jP(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=uC(a,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return i3(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Rt.fromDate(r);return{timestampValue:Wp(i.serializer,s)}}if(r instanceof Rt){let s=new Rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wp(i.serializer,s)}}if(r instanceof Lu)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ku)return{bytesValue:uP(i.serializer,r._byteString)};if(r instanceof On){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:tC(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Vu)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return eC(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${wm(r)}`)}(n,e)}function $P(n,e){let t={};return BM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lc(n,(r,i)=>{let s=uC(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function HP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rt||n instanceof Lu||n instanceof ku||n instanceof On||n instanceof cm||n instanceof Vu)}function qP(n,e,t){if(!HP(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=wm(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function y6(n,e,t){if((e=xe(e))instanceof Fu)return e._internalPath;if(typeof e=="string")return GP(n,e);throw lm("Field path arguments must be of type string or ",n,!1,void 0,t)}var w6=new RegExp("[~\\*/\\[\\]]");function GP(n,e,t){if(e.search(w6)>=0)throw lm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fu(...e.split("."))._internalPath}catch{throw lm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lm(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new G(F.INVALID_ARGUMENT,a+n+c)}function I6(n,e){return n.some(t=>t.isEqual(e))}var um=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new On(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new HE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(dC("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},HE=class extends um{data(){return super.data()}};function dC(n,e){return typeof e=="string"?GP(n,e):e instanceof Fu?e._internalPath:e._delegate._internalPath}function zP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Uu=class{},qE=class extends Uu{};function WP(n,e,...t){let r=[];e instanceof Uu&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof GE).length,a=s.filter(c=>c instanceof dm).length;if(o>1||o>0&&a>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var dm=class n extends qE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return QP(e._query,t),new To(e.firestore,e.converter,VI(e._query,t))}_parse(e){let t=BP(e.firestore);return function(s,o,a,c,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){UM(f,d);let v=[];for(let w of f)v.push(VM(c,s,w));m={arrayValue:{values:v}}}else m=VM(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||UM(f,d),m=_6(a,o,f,d==="in"||d==="not-in");return Lt.create(u,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function KP(n,e,t){let r=e,i=dC("where",n);return dm._create(i,r,t)}var GE=class n extends Uu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:br.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)QP(o,c),o=VI(o,c)}(e._query,t),new To(e.firestore,e.converter,VI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function VM(n,e,t){if(typeof(t=xe(t))=="string"){if(t==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!YM(e)&&t.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(mt.fromString(t));if(!ee.isDocumentKey(r))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lM(n,new ee(r))}if(t instanceof On)return lM(n,t._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wm(t)}.`)}function UM(n,e){if(!Array.isArray(n)||n.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function QP(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var zE=class{convertValue(e,t="none"){switch(yo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ce()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return lc(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>ut(o.doubleValue));return new Vu(s)}convertGeoPoint(e){return new Lu(ut(e.latitude),ut(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=QE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){let t=Ni(e);return new Rt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=mt.fromString(e);ze(gP(r));let i=new jp(r.get(1),r.get(3)),s=new ee(r.popFirst(5));return i.isEqual(t)||xi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function E6(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var mo=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},hm=class extends um{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(dC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qa=class extends hm{data(e={}){return super.data(e)}},fm=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new mo(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qa(this._firestore,this._userDataWriter,r.key,r,new mo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Qa(i._firestore,i._userDataWriter,a.doc.key,a.doc,new mo(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Qa(i._firestore,i._userDataWriter,a.doc.key,a.doc,new mo(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:C6(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function C6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce()}}var ju=class extends zE{constructor(e){super(),this.firestore=e}convertBytes(e){return new ku(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new On(this.firestore,null,t)}};function YP(n){n=gs(n,To);let e=gs(n.firestore,bo),t=lC(e),r=new ju(e);return zP(n._query),f6(t,n._query).then(i=>new fm(e,r,n,i))}function ZP(n,e,t){n=gs(n,On);let r=gs(n.firestore,bo),i=E6(n.converter,e,t);return T6(r,[v6(BP(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,go.none())])}function hC(n,...e){var t,r,i;n=xe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||LM(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(LM(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,u,d;if(n instanceof On)u=gs(n.firestore,bo),d=XE(n._key.path),c={next:f=>{e[o]&&e[o](b6(u,n,f))},error:e[o+1],complete:e[o+2]};else{let f=gs(n,To);u=gs(f.firestore,bo),d=f._query;let m=new ju(u);c={next:v=>{e[o]&&e[o](new fm(u,m,f,v))},error:e[o+1],complete:e[o+2]},zP(n._query)}return function(m,v,w,M){let R=new sm(M),L=new nm(v,R,w);return m.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return bP(yield UE(m),L)})),()=>{R.Za(),m.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return SP(yield UE(m),L)}))}}(lC(u),d,a,c)}function T6(n,e){return function(r,i){let s=new Kr;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return n6(yield h6(r),i,s)})),s.promise}(lC(n),e)}function b6(n,e,t){let r=t.docs.get(e._key),i=new ju(n);return new hm(n,i,e._key,r,new mo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){cc=i})(bn),bt(new Tt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new bo(new _I(r.getProvider("auth-internal")),new EI(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jp(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),J(sM,"4.7.3",e),J(sM,"4.7.3","esm2017")})();var Im=function(){return Im=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Im.apply(this,arguments)};var A6={includeMetadataChanges:!1};function JP(n,e){return e===void 0&&(e=A6),new he(function(t){var r=hC(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function XP(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Im(Im({},r),(t={},t[e.idField]=n.id,t))}function eO(n){return JP(n,{includeMetadataChanges:!0}).pipe(Q(function(e){return e.docs}))}function tO(n,e){return e===void 0&&(e={}),eO(n).pipe(Q(function(t){return t.map(function(r){return XP(r,e)})}))}var Do=class{constructor(e){return e}},nO="firestore",fC=class{constructor(){return At(nO)}};var pC=new H("angularfire2.firestore-instances");function R6(n,e){let t=Ot(nO,n,e);return t&&new Do(t)}function x6(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Do(r)}}var N6={provide:fC,deps:[[new ue,pC]]},M6={provide:Do,useFactory:R6,deps:[[new ue,pC],ot]};function rO(n,...e){return J("angularfire",st.full,"fst"),nt([M6,N6,{provide:pC,useFactory:x6(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Er],[new ue,Pn],...e]}])}var ar=Ue(tO,!0);var cr=Ue(LP,!0);var mC=Ue(VP,!0);var gC=Ue(YP,!0);var iO=Ue(UP,!0);var sO=Ue(WP,!0);var vC=Ue(ZP,!0);var oO=Ue(KP,!0);var aO="@firebase/database",cO="1.0.8";var m0="";function P6(n){m0=n}var bC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),$t(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:$d(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var SC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Nr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var jO=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new bC(e)}}catch{}return new SC},Ro=jO("localStorage"),DC=jO("sessionStorage");var pc=new Mr("@firebase/database"),O6=function(){let n=1;return function(){return n++}}(),BO=function(n){let e=zb(n),t=new Hb;t.update(e);let r=t.digest();return Pb.encodeByteArray(r)},rd=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=rd.apply(null,r):typeof r=="object"?e+=$t(r):e+=r,e+=" "}return e},xo=null,lO=!0,k6=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(pc.logLevel=rn.VERBOSE,xo=pc.log.bind(pc),e&&DC.set("logging_enabled",!0)):typeof n=="function"?xo=n:(xo=null,DC.remove("logging_enabled"))},ln=function(...n){if(lO===!0&&(lO=!1,xo===null&&DC.get("logging_enabled")===!0&&k6(!0)),xo){let e=rd.apply(null,n);xo(e)}},id=function(n){return function(...e){ln(n,...e)}},AC=function(...n){let e="FIREBASE INTERNAL ERROR: "+rd(...n);pc.error(e)},ki=function(...n){let e=`FIREBASE FATAL ERROR: ${rd(...n)}`;throw pc.error(e),new Error(e)},Wn=function(...n){let e="FIREBASE WARNING: "+rd(...n);pc.warn(e)},F6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Wn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},$O=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},L6=function(n){if(Rr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},gc="[MIN_NAME]",No="[MAX_NAME]",Cc=function(n,e){if(n===e)return 0;if(n===gc||e===No)return-1;if(e===gc||n===No)return 1;{let t=uO(n),r=uO(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},V6=function(n,e){return n===e?0:n<e?-1:1},Gu=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+$t(e))},g0=function(n){if(typeof n!="object"||n===null)return $t(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=$t(e[r]),t+=":",t+=g0(n[e[r]]);return t+="}",t},HO=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function dr(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var qO=function(n){$(!$O(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let d=u.join(""),f="";for(c=0;c<64;c+=8){let m=parseInt(d.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},U6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},j6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var B6=new RegExp("^-?(0*)\\d{1,10}$"),$6=-2147483648,H6=2147483647,uO=function(n){if(B6.test(n)){let e=Number(n);if(e>=$6&&e<=H6)return e}return null},sd=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Wn("Exception was thrown by user callback.",t),e},Math.floor(0))}},q6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Yu=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var RC=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Wn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var xC=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(ln("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Wn(e)}},Zu=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Cm="5",GO="v",zO="s",WO="r",KO="f",QO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,YO="ls",ZO="p",NC="ac",JO="websocket",XO="long_polling";var Tm=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ro.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ro.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function G6(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function ek(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let r;if(e===JO)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===XO)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);G6(n)&&(t.ns=n.namespace);let i=[];return dr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var MC=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Nr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Fb(this.counters_)}};var _C={},yC={};function v0(n){let e=n.toString();return _C[e]||(_C[e]=new MC),_C[e]}function z6(n,e){let t=n.toString();return yC[t]||(yC[t]=e()),yC[t]}var PC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&sd(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var dO="start",W6="close",K6="pLPCommand",Q6="pRTLPCB",tk="id",nk="pw",rk="ser",Y6="cb",Z6="seg",J6="ts",X6="d",e9="dframe",ik=1870,sk=30,t9=ik-sk,n9=25e3,r9=3e4,OC=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=id(e),this.stats_=v0(t),this.urlFn=c=>(this.appCheckToken&&(c[NC]=this.appCheckToken),ek(t,XO,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new PC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(r9)),L6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new kC((...s)=>{let[o,a,c,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dO)this.id=a,this.password=c;else if(o===W6)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[dO]="t",r[rk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Y6]=this.scriptTagHolder.uniqueCallbackIdentifier),r[GO]=Cm,this.transportSessionId&&(r[zO]=this.transportSessionId),this.lastSessionId&&(r[YO]=this.lastSessionId),this.applicationId&&(r[ZO]=this.applicationId),this.appCheckToken&&(r[NC]=this.appCheckToken),typeof location<"u"&&location.hostname&&QO.test(location.hostname)&&(r[WO]=KO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Rr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!U6()&&!j6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=$t(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=Ob(t),i=HO(r,t9);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Rr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[e9]="t",r[tk]=e,r[nk]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=$t(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},kC=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Rr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=O6(),window[K6+this.uniqueCallbackIdentifier]=e,window[Q6+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ln("frame writing exception"),a.stack&&ln(a.stack),ln(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ln("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[tk]=this.myID,e[nk]=this.myPW,e[rk]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+sk+r.length<=ik;){let o=this.pendingSegs.shift();r=r+"&"+Z6+i+"="+o.seg+"&"+J6+i+"="+o.ts+"&"+X6+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(n9)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Rr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{ln("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var i9=16384,s9=45e3,bm=null;typeof MozWebSocket<"u"?bm=MozWebSocket:typeof WebSocket<"u"&&(bm=WebSocket);var zu=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=id(this.connId),this.stats_=v0(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[GO]=Cm,!Rr()&&typeof location<"u"&&location.hostname&&QO.test(location.hostname)&&(a[WO]=KO),r&&(a[zO]=r),i&&(a[YO]=i),s&&(a[NC]=s),o&&(a[ZO]=o),ek(t,JO,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ro.set("previous_websocket_failure",!0);try{let i;if(Rr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Cm}/${m0}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new bm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&bm!==null&&!n.forceDisallow_}static previouslyFailed(){return Ro.isInMemoryStorage||Ro.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ro.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=$d(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=$t(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=HO(r,i9);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(s9))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),o9=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[OC,zu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=zu&&zu.isAvailable(),i=r&&!zu.previouslyFailed();if(t.webSocketOnly&&(r||Wn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[zu];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),a9=6e4,c9=5e3,l9=10*1024,u9=100*1024,wC="t",hO="d",d9="s",fO="r",h9="e",pO="o",mO="a",gO="n",vO="p",f9="h",FC=class{constructor(e,t,r,i,s,o,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=id("c:"+this.id+":"),this.transportManager_=new o9(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Yu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>u9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>l9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wC in e){let t=e[wC];t===mO?this.upgradeIfSecondaryHealthy_():t===fO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===pO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Gu("t",e),r=Gu("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:vO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Gu("t",e),r=Gu("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Gu(wC,e);if(hO in e){let r=e[hO];if(t===f9){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===gO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===d9?this.onConnectionShutdown_(r):t===fO?this.onReset_(r):t===h9?AC("Server Error: "+r):t===pO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):AC("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Cm!==r&&Wn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Yu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(a9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Yu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(c9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:vO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ro.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Sm=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Dm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Am=class n extends Dm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ll()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var _O=32,yO=768,tt=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Qe(){return new tt("")}function ke(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Es(n){return n.pieces_.length-n.pieceNum_}function at(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new tt(n.pieces_,e)}function ok(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function p9(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function ak(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function ck(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new tt(e,0)}function Wt(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof tt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new tt(t,0)}function Me(n){return n.pieceNum_>=n.pieces_.length}function lr(n,e){let t=ke(n),r=ke(e);if(t===null)return e;if(t===r)return lr(at(n),at(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function lk(n,e){if(Es(n)!==Es(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Dr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Es(n)>Es(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var LC=class{constructor(e,t){this.errorPrefix_=t,this.parts_=ak(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ml(this.parts_[r]);uk(this)}};function m9(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ml(e),uk(n)}function g9(n){let e=n.parts_.pop();n.byteLength_-=ml(e),n.parts_.length>0&&(n.byteLength_-=1)}function uk(n){if(n.byteLength_>yO)throw new Error(n.errorPrefix_+"has a key path longer than "+yO+" bytes ("+n.byteLength_+").");if(n.parts_.length>_O)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+_O+") or object contains a cycle "+Ao(n))}function Ao(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var VC=class n extends Dm{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}};var Wu=1e3,v9=60*5*1e3,wO=30*1e3,_9=1.3,y9=3e4,w9="server_kill",IO=3,_0=(()=>{class n extends Sm{constructor(t,r,i,s,o,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=id("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Wu,this.maxReconnectDelay_=v9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Rr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VC.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Am.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_($t(o)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Qg,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Nr(t,"w")){let i=Rs(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Wn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||$b(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wO)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=Bb(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+$t(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):AC("Unrecognized action received from server: "+$t(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Wu,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Wu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>y9&&(this.reconnectDelay_=Wu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*_9)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(m){$(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(m)};this.realtime_={close:u,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,v]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?ln("getToken() completed but was canceled"):(ln("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=v&&v.token,c=new FC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{Wn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(w9)},o))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&Wn(m),u())}}})}interrupt(t){ln("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){ln("Resuming connection for reason: "+t),delete this.interruptReasons_[t],hl(this.interruptReasons_)&&(this.reconnectDelay_=Wu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>g0(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new tt(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){ln("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=IO&&(this.reconnectDelay_=wO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){ln("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=IO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Rr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+m0.replace(/\./g,"-")]=1,ll()?t["framework.cordova"]=1:Bd()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Am.getInstance().currentlyOnline();return hl(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Fe=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var vc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Fe(gc,e),i=new Fe(gc,t);return this.compare(r,i)!==0}minPost(){return Fe.MIN}};var Em,Rm=class extends vc{static get __EMPTY_NODE(){return Em}static set __EMPTY_NODE(e){Em=e}compare(e,t){return Cc(e.name,t.name)}isDefinedOn(e){throw Go("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Fe.MIN}maxPost(){return new Fe(No,Em)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new Fe(e,Em)}toString(){return".key"}},mc=new Rm;var hc=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Sr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??ur.EMPTY_NODE,this.right=o??ur.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ur.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return ur.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),UC=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Sr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ur=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Sr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Sr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new hc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new hc(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new hc(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new hc(this.root_,null,this.comparator_,!0,e)}};ur.EMPTY_NODE=new UC;function I9(n,e){return Cc(n.name,e.name)}function y0(n,e){return Cc(n,e)}var jC;function E9(n){jC=n}var dk=function(n){return typeof n=="number"?"number:"+qO(n):"string:"+n},hk=function(n){if(n.isLeafNode()){let e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Nr(e,".sv"),"Priority must be a string or number.")}else $(n===jC||n.isEmpty(),"priority of unexpected type.");$(n===jC||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var EO,_c=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),hk(this.priorityNode_)}static set __childrenNodeConstructor(t){EO=t}static get __childrenNodeConstructor(){return EO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Me(t)?this:ke(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ke(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:($(i!==".priority"||Es(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(at(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+dk(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=qO(this.value_):t+=this.value_,this.lazyHash_=BO(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return $(s>=0,"Unknown leaf type: "+r),$(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),fk,pk;function C9(n){fk=n}function T9(n){pk=n}var BC=class extends vc{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Cc(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Fe.MIN}maxPost(){return new Fe(No,new _c("[PRIORITY-POST]",pk))}makePost(e,t){let r=fk(e);return new Fe(t,new _c("[PRIORITY-POST]",r))}toString(){return".priority"}},dn=new BC;var b9=Math.log(2),$C=class{constructor(e){let t=s=>parseInt(Math.log(s)/b9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},xm=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,f,m;if(d===0)return null;if(d===1)return f=n[c],m=t?t(f):f,new Sr(m,f.node,Sr.BLACK,null,null);{let v=parseInt(d/2,10)+c,w=i(c,v),M=i(v+1,u);return f=n[v],m=t?t(f):f,new Sr(m,f.node,Sr.BLACK,w,M)}},s=function(c){let u=null,d=null,f=n.length,m=function(w,M){let R=f-w,L=f;f-=w;let q=i(R+1,L),W=n[R],te=t?t(W):W;v(new Sr(te,W.node,M,null,q))},v=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<c.count;++w){let M=c.nextBitIsOne(),R=Math.pow(2,c.count-(w+1));M?m(R,Sr.BLACK):(m(R,Sr.BLACK),m(R,Sr.RED))}return d},o=new $C(n.length),a=s(o);return new ur(r||e,a)};var IC,dc={},yc=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return $(dc&&dn,"ChildrenNode.ts has not been loaded"),IC=IC||new n({".priority":dc},{".priority":dn}),IC}get(e){let t=Rs(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ur?t:null}hasIndex(e){return Nr(this.indexSet_,e.toString())}addIndex(e,t){$(e!==mc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Fe.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=xm(r,e.getCompare()):a=dc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=fl(this.indexes_,(i,s)=>{let o=Rs(this.indexSet_,s);if($(o,"Missing index implementation for "+s),i===dc)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Fe.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),xm(a,o.getCompare())}else return dc;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Fe(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=fl(this.indexes_,i=>{if(i===dc)return i;{let s=t.get(e.name);return s?i.remove(new Fe(e.name,s)):i}});return new n(r,this.indexSet_)}};var Ku,gt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&hk(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ku||(Ku=new n(new ur(y0),null,yc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ku}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Ku:r}}getChild(t){let r=ke(t);return r===null?this:this.getImmediateChild(r).getChild(at(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if($(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Fe(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Ku:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ke(t);if(i===null)return r;{$(ke(t)!==".priority"||Es(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(at(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(dn,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+dk(this.getPriority().val())+":"),this.forEachChild(dn,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":BO(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Fe(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Fe(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Fe(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Fe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Fe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===od?-1:0}withIndex(t){if(t===mc||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===mc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(dn),s=r.getIterator(dn),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===mc?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),HC=class extends gt{constructor(){super(new ur(y0),gt.EMPTY_NODE,yc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return gt.EMPTY_NODE}isEmpty(){return!1}},od=new HC;Object.defineProperties(Fe,{MIN:{value:new Fe(gc,gt.EMPTY_NODE)},MAX:{value:new Fe(No,od)}});Rm.__EMPTY_NODE=gt.EMPTY_NODE;_c.__childrenNodeConstructor=gt;E9(od);T9(od);var S9=!0;function un(n,e=null){if(n===null)return gt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new _c(t,un(e))}if(!(n instanceof Array)&&S9){let t=[],r=!1;if(dr(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=un(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Fe(o,c)))}}),t.length===0)return gt.EMPTY_NODE;let s=xm(t,I9,o=>o.name,y0);if(r){let o=xm(t,dn.getCompare());return new gt(s,un(e),new yc({".priority":o},{".priority":dn}))}else return new gt(s,un(e),yc.Default)}else{let t=gt.EMPTY_NODE;return dr(n,(r,i)=>{if(Nr(n,r)&&r.substring(0,1)!=="."){let s=un(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(un(e))}}C9(un);var qC=class extends vc{constructor(e){super(),this.indexPath_=e,$(!Me(e)&&ke(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Cc(e.name,t.name):s}makePost(e,t){let r=un(e),i=gt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Fe(t,i)}maxPost(){let e=gt.EMPTY_NODE.updateChild(this.indexPath_,od);return new Fe(No,e)}toString(){return ak(this.indexPath_,0).join("/")}};var GC=class extends vc{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Cc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Fe.MIN}maxPost(){return Fe.MAX}makePost(e,t){let r=un(e);return new Fe(t,r)}toString(){return".value"}},D9=new GC;function A9(n){return{type:"value",snapshotNode:n}}function R9(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function x9(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function CO(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function N9(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var zC=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=dn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:gc}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:No}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===dn}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function TO(n){let e={};if(n.isDefault())return e;let t;if(n.index_===dn?t="$priority":n.index_===D9?t="$value":n.index_===mc?t="$key":($(n.index_ instanceof qC,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=$t(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=$t(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+$t(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=$t(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+$t(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function bO(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==dn&&(e.i=n.index_.toString()),e}var WC=class n extends Sm{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=id("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=TO(e._queryParams);this.restRequest_(s+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(s,f,!1,r),Rs(this.listens_,o)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=TO(e._queryParams),r=e._path.toString(),i=new Qg;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+xs(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=$d(a.responseText)}catch{Wn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Wn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var KC=class{constructor(){this.rootNode_=gt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Nm(){return{value:null,children:new Map}}function mk(n,e,t){if(Me(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ke(e);n.children.has(r)||n.children.set(r,Nm());let i=n.children.get(r);e=at(e),mk(i,e,t)}}function QC(n,e,t){n.value!==null?t(e,n.value):M9(n,(r,i)=>{let s=new tt(e.toString()+"/"+r);QC(i,s,t)})}function M9(n,e){n.children.forEach((t,r)=>{e(r,t)})}var YC=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&dr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var SO=10*1e3,P9=30*1e3,O9=5*60*1e3,ZC=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new YC(e);let r=SO+(P9-SO)*Math.random();Yu(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;dr(e,(i,s)=>{s>0&&Nr(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Yu(this.reportStats_.bind(this),Math.floor(Math.random()*2*O9))}};var Oi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Oi||{});function gk(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function vk(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function _k(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var JC=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Oi.ACK_USER_WRITE,this.source=gk()}operationForChild(e){if(Me(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new tt(e));return new n(Qe(),t,this.revert)}}else return $(ke(this.path)===e,"operationForChild called for unrelated child."),new n(at(this.path),this.affectedTree,this.revert)}};var wc=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Oi.OVERWRITE}operationForChild(e){return Me(this.path)?new n(this.source,Qe(),this.snap.getImmediateChild(e)):new n(this.source,at(this.path),this.snap)}};var Mm=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Oi.MERGE}operationForChild(e){if(Me(this.path)){let t=this.children.subtree(new tt(e));return t.isEmpty()?null:t.value?new wc(this.source,Qe(),t.value):new n(this.source,Qe(),t)}else return $(ke(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,at(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ed=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Me(e))return this.isFullyInitialized()&&!this.filtered_;let t=ke(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function k9(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(N9(o.childName,o.snapshotNode))}),Qu(n,i,"child_removed",e,r,t),Qu(n,i,"child_added",e,r,t),Qu(n,i,"child_moved",s,r,t),Qu(n,i,"child_changed",e,r,t),Qu(n,i,"value",e,r,t),i}function Qu(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>L9(n,a,c)),o.forEach(a=>{let c=F9(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function F9(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function L9(n,e,t){if(e.childName==null||t.childName==null)throw Go("Should only compare child_ events.");let r=new Fe(e.childName,e.snapshotNode),i=new Fe(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function yk(n,e){return{eventCache:n,serverCache:e}}function Ju(n,e,t,r){return yk(new ed(e,t,r),n.serverCache)}function wk(n,e,t,r){return yk(n.eventCache,new ed(e,t,r))}function XC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Mo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var EC,V9=()=>(EC||(EC=new ur(V6)),EC),kn=class n{constructor(e,t=V9()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return dr(e,(r,i)=>{t=t.set(new tt(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Qe(),value:this.value};if(Me(e))return null;{let r=ke(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(at(e),t);return s!=null?{path:Wt(new tt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Me(e))return this;{let t=ke(e),r=this.children.get(t);return r!==null?r.subtree(at(e)):new n(null)}}set(e,t){if(Me(e))return new n(t,this.children);{let r=ke(e),s=(this.children.get(r)||new n(null)).set(at(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(Me(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ke(e),r=this.children.get(t);if(r){let i=r.remove(at(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(Me(e))return this.value;{let t=ke(e),r=this.children.get(t);return r?r.get(at(e)):null}}setTree(e,t){if(Me(e))return t;{let r=ke(e),s=(this.children.get(r)||new n(null)).setTree(at(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Qe(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Wt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Qe(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Me(e))return null;{let s=ke(e),o=this.children.get(s);return o?o.findOnPath_(at(e),Wt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Qe(),t)}foreachOnPath_(e,t,r){if(Me(e))return this;{this.value&&r(t,this.value);let i=ke(e),s=this.children.get(i);return s?s.foreachOnPath_(at(e),Wt(t,i),r):new n(null)}}foreach(e){this.foreach_(Qe(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Wt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Ar=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new kn(null))}};function Xu(n,e,t){if(Me(e))return new Ar(new kn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=lr(i,e);return s=s.updateChild(o,t),new Ar(n.writeTree_.set(i,s))}else{let i=new kn(t),s=n.writeTree_.setTree(e,i);return new Ar(s)}}}function DO(n,e,t){let r=n;return dr(t,(i,s)=>{r=Xu(r,Wt(e,i),s)}),r}function AO(n,e){if(Me(e))return Ar.empty();{let t=n.writeTree_.setTree(e,new kn(null));return new Ar(t)}}function e0(n,e){return Po(n,e)!=null}function Po(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(lr(t.path,e)):null}function RO(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(dn,(r,i)=>{e.push(new Fe(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Fe(r,i.value))}),e}function Is(n,e){if(Me(e))return n;{let t=Po(n,e);return t!=null?new Ar(new kn(t)):new Ar(n.writeTree_.subtree(e))}}function t0(n){return n.writeTree_.isEmpty()}function Ic(n,e){return Ik(Qe(),n.writeTree_,e)}function Ik(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?($(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=Ik(Wt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Wt(n,".priority"),r)),t}}function Ek(n,e){return Dk(e,n)}function U9(n,e,t,r,i){$(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Xu(n.visibleWrites,e,t)),n.lastWriteId=r}function j9(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function B9(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&$9(a,r.path)?i=!1:Dr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return H9(n),!0;if(r.snap)n.visibleWrites=AO(n.visibleWrites,r.path);else{let a=r.children;dr(a,c=>{n.visibleWrites=AO(n.visibleWrites,Wt(r.path,c))})}return!0}else return!1}function $9(n,e){if(n.snap)return Dr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Dr(Wt(n.path,t),e))return!0;return!1}function H9(n){n.visibleWrites=Ck(n.allWrites,q9,Qe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function q9(n){return n.visible}function Ck(n,e,t){let r=Ar.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Dr(t,o)?(a=lr(t,o),r=Xu(r,a,s.snap)):Dr(o,t)&&(a=lr(o,t),r=Xu(r,Qe(),s.snap.getChild(a)));else if(s.children){if(Dr(t,o))a=lr(t,o),r=DO(r,a,s.children);else if(Dr(o,t))if(a=lr(o,t),Me(a))r=DO(r,Qe(),s.children);else{let c=Rs(s.children,ke(a));if(c){let u=c.getChild(at(a));r=Xu(r,Qe(),u)}}}else throw Go("WriteRecord should have .snap or .children")}}return r}function Tk(n,e,t,r,i){if(!r&&!i){let s=Po(n.visibleWrites,e);if(s!=null)return s;{let o=Is(n.visibleWrites,e);if(t0(o))return t;if(t==null&&!e0(o,Qe()))return null;{let a=t||gt.EMPTY_NODE;return Ic(o,a)}}}else{let s=Is(n.visibleWrites,e);if(!i&&t0(s))return t;if(!i&&t==null&&!e0(s,Qe()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Dr(u.path,e)||Dr(e,u.path))},a=Ck(n.allWrites,o,e),c=t||gt.EMPTY_NODE;return Ic(a,c)}}}function G9(n,e,t){let r=gt.EMPTY_NODE,i=Po(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(dn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Is(n.visibleWrites,e);return t.forEachChild(dn,(o,a)=>{let c=Ic(Is(s,new tt(o)),a);r=r.updateImmediateChild(o,c)}),RO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Is(n.visibleWrites,e);return RO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function z9(n,e,t,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Wt(e,t);if(e0(n.visibleWrites,s))return null;{let o=Is(n.visibleWrites,s);return t0(o)?i.getChild(t):Ic(o,i.getChild(t))}}function W9(n,e,t,r){let i=Wt(e,t),s=Po(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Is(n.visibleWrites,i);return Ic(o,r.getNode().getImmediateChild(t))}else return null}function K9(n,e){return Po(n.visibleWrites,e)}function Q9(n,e,t,r,i,s,o){let a,c=Is(n.visibleWrites,e),u=Po(c,Qe());if(u!=null)a=u;else if(t!=null)a=Ic(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),v=m.getNext();for(;v&&d.length<i;)f(v,r)!==0&&d.push(v),v=m.getNext();return d}else return[]}function Y9(){return{visibleWrites:Ar.empty(),allWrites:[],lastWriteId:-1}}function n0(n,e,t,r){return Tk(n.writeTree,n.treePath,e,t,r)}function bk(n,e){return G9(n.writeTree,n.treePath,e)}function xO(n,e,t,r){return z9(n.writeTree,n.treePath,e,t,r)}function Pm(n,e){return K9(n.writeTree,Wt(n.treePath,e))}function Z9(n,e,t,r,i,s){return Q9(n.writeTree,n.treePath,e,t,r,i,s)}function w0(n,e,t){return W9(n.writeTree,n.treePath,e,t)}function Sk(n,e){return Dk(Wt(n.treePath,e),n.writeTree)}function Dk(n,e){return{treePath:n,writeTree:e}}var r0=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,CO(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,x9(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,R9(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,CO(r,e.snapshotNode,i.oldSnap));else throw Go("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var i0=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},Ak=new i0,td=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ed(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return w0(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Mo(this.viewCache_),s=Z9(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function J9(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function X9(n,e,t,r,i){let s=new r0,o,a;if(t.type===Oi.OVERWRITE){let u=t;u.source.fromUser?o=s0(n,e,u.path,u.snap,r,i,s):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Me(u.path),o=Om(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===Oi.MERGE){let u=t;u.source.fromUser?o=t5(n,e,u.path,u.children,r,i,s):($(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=o0(n,e,u.path,u.children,r,i,a,s))}else if(t.type===Oi.ACK_USER_WRITE){let u=t;u.revert?o=i5(n,e,u.path,r,i,s):o=n5(n,e,u.path,u.affectedTree,r,i,s)}else if(t.type===Oi.LISTEN_COMPLETE)o=r5(n,e,t.path,r,s);else throw Go("Unknown operation type: "+t.type);let c=s.getChanges();return e5(e,o,c),{viewCache:o,changes:c}}function e5(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=XC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(A9(XC(e)))}}function Rk(n,e,t,r,i,s){let o=e.eventCache;if(Pm(r,t)!=null)return e;{let a,c;if(Me(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Mo(e),d=u instanceof gt?u:gt.EMPTY_NODE,f=bk(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{let u=n0(r,Mo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=ke(t);if(u===".priority"){$(Es(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let f=xO(r,t,d,c);f!=null?a=n.filter.updatePriority(d,f):a=o.getNode()}else{let d=at(t),f;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let m=xO(r,t,o.getNode(),c);m!=null?f=o.getNode().getImmediateChild(u).updateChild(d,m):f=o.getNode().getImmediateChild(u)}else f=w0(r,u,e.serverCache);f!=null?a=n.filter.updateChild(o.getNode(),u,f,d,i,s):a=o.getNode()}}return Ju(e,a,o.isFullyInitialized()||Me(t),n.filter.filtersNodes())}}function Om(n,e,t,r,i,s,o,a){let c=e.serverCache,u,d=o?n.filter:n.filter.getIndexedFilter();if(Me(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let v=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),v,null)}else{let v=ke(t);if(!c.isCompleteForPath(t)&&Es(t)>1)return e;let w=at(t),R=c.getNode().getImmediateChild(v).updateChild(w,r);v===".priority"?u=d.updatePriority(c.getNode(),R):u=d.updateChild(c.getNode(),v,R,w,Ak,null)}let f=wk(e,u,c.isFullyInitialized()||Me(t),d.filtersNodes()),m=new td(i,f,s);return Rk(n,f,t,i,m,a)}function s0(n,e,t,r,i,s,o){let a=e.eventCache,c,u,d=new td(i,e,s);if(Me(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Ju(e,u,!0,n.filter.filtersNodes());else{let f=ke(t);if(f===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=Ju(e,u,a.isFullyInitialized(),a.isFiltered());else{let m=at(t),v=a.getNode().getImmediateChild(f),w;if(Me(m))w=r;else{let M=d.getCompleteChild(f);M!=null?ok(m)===".priority"&&M.getChild(ck(m)).isEmpty()?w=M:w=M.updateChild(m,r):w=gt.EMPTY_NODE}if(v.equals(w))c=e;else{let M=n.filter.updateChild(a.getNode(),f,w,m,d,o);c=Ju(e,M,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function NO(n,e){return n.eventCache.isCompleteForChild(e)}function t5(n,e,t,r,i,s,o){let a=e;return r.foreach((c,u)=>{let d=Wt(t,c);NO(e,ke(d))&&(a=s0(n,a,d,u,i,s,o))}),r.foreach((c,u)=>{let d=Wt(t,c);NO(e,ke(d))||(a=s0(n,a,d,u,i,s,o))}),a}function MO(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function o0(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Me(t)?u=r:u=new kn(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){let v=e.serverCache.getNode().getImmediateChild(f),w=MO(n,v,m);c=Om(n,c,new tt(f),w,i,s,o,a)}}),u.children.inorderTraversal((f,m)=>{let v=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!d.hasChild(f)&&!v){let w=e.serverCache.getNode().getImmediateChild(f),M=MO(n,w,m);c=Om(n,c,new tt(f),M,i,s,o,a)}}),c}function n5(n,e,t,r,i,s,o){if(Pm(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Me(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Om(n,e,t,c.getNode().getChild(t),i,s,a,o);if(Me(t)){let u=new kn(null);return c.getNode().forEachChild(mc,(d,f)=>{u=u.set(new tt(d),f)}),o0(n,e,t,u,i,s,a,o)}else return e}else{let u=new kn(null);return r.foreach((d,f)=>{let m=Wt(t,d);c.isCompleteForPath(m)&&(u=u.set(d,c.getNode().getChild(m)))}),o0(n,e,t,u,i,s,a,o)}}function r5(n,e,t,r,i){let s=e.serverCache,o=wk(e,s.getNode(),s.isFullyInitialized()||Me(t),s.isFiltered());return Rk(n,o,t,r,Ak,i)}function i5(n,e,t,r,i,s){let o;if(Pm(r,t)!=null)return e;{let a=new td(r,e,i),c=e.eventCache.getNode(),u;if(Me(t)||ke(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=n0(r,Mo(e));else{let f=e.serverCache.getNode();$(f instanceof gt,"serverChildren would be complete if leaf node"),d=bk(r,f)}d=d,u=n.filter.updateFullNode(c,d,s)}else{let d=ke(t),f=w0(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=n.filter.updateChild(c,d,f,at(t),a,s):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,gt.EMPTY_NODE,at(t),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=n0(r,Mo(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Pm(r,Qe())!=null,Ju(e,u,o,n.filter.filtersNodes())}}function s5(n,e){let t=Mo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Me(e)&&!t.getImmediateChild(ke(e)).isEmpty())?t.getChild(e):null}function PO(n,e,t,r){e.type===Oi.MERGE&&e.source.queryId!==null&&($(Mo(n.viewCache_),"We should always have a full cache before handling merges"),$(XC(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=X9(n.processor_,i,e,t,r);return J9(n.processor_,s.viewCache),$(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,o5(n,s.changes,s.viewCache.eventCache.getNode(),null)}function o5(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return k9(n.eventGenerator_,e,t,i)}var OO;function a5(n){$(!OO,"__referenceConstructor has already been defined"),OO=n}function I0(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return $(s!=null,"SyncTree gave us an op for an invalid query."),PO(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(PO(o,e,t,r));return s}}function E0(n,e){let t=null;for(let r of n.views.values())t=t||s5(r,e);return t}var kO;function c5(n){$(!kO,"__referenceConstructor has already been defined"),kO=n}var km=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new kn(null),this.pendingWriteTree_=Y9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function l5(n,e,t,r,i){return U9(n.pendingWriteTree_,e,t,r,i),i?Lm(n,new wc(gk(),e,t)):[]}function fc(n,e,t=!1){let r=j9(n.pendingWriteTree_,e);if(B9(n.pendingWriteTree_,e)){let s=new kn(null);return r.snap!=null?s=s.set(Qe(),!0):dr(r.children,o=>{s=s.set(new tt(o),!0)}),Lm(n,new JC(r.path,s,t))}else return[]}function Fm(n,e,t){return Lm(n,new wc(vk(),e,t))}function u5(n,e,t){let r=kn.fromObject(t);return Lm(n,new Mm(vk(),e,r))}function d5(n,e,t,r){let i=Pk(n,r);if(i!=null){let s=Ok(i),o=s.path,a=s.queryId,c=lr(o,e),u=new wc(_k(a),c,t);return kk(n,o,u)}else return[]}function h5(n,e,t,r){let i=Pk(n,r);if(i){let s=Ok(i),o=s.path,a=s.queryId,c=lr(o,e),u=kn.fromObject(t),d=new Mm(_k(a),c,u);return kk(n,o,d)}else return[]}function xk(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=lr(o,e),u=E0(a,c);if(u)return u});return Tk(i,e,s,t,!0)}function Lm(n,e){return Nk(e,n.syncPointTree_,null,Ek(n.pendingWriteTree_,Qe()))}function Nk(n,e,t,r){if(Me(n.path))return Mk(n,e,t,r);{let i=e.get(Qe());t==null&&i!=null&&(t=E0(i,Qe()));let s=[],o=ke(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let u=t?t.getImmediateChild(o):null,d=Sk(r,o);s=s.concat(Nk(a,c,u,d))}return i&&(s=s.concat(I0(i,n,r,t))),s}}function Mk(n,e,t,r){let i=e.get(Qe());t==null&&i!=null&&(t=E0(i,Qe()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,u=Sk(r,o),d=n.operationForChild(o);d&&(s=s.concat(Mk(d,a,c,u)))}),i&&(s=s.concat(I0(i,n,r,t))),s}function Pk(n,e){return n.tagToQueryMap.get(e)}function Ok(n){let e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new tt(n.substr(0,e))}}function kk(n,e,t){let r=n.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");let i=Ek(n.pendingWriteTree_,e);return I0(r,t,i,null)}var a0=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},c0=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Wt(this.path_,e);return new n(this.syncTree_,t)}node(){return xk(this.syncTree_,this.path_)}},f5=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},FO=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return p5(n[".sv"],e,t);if(typeof n[".sv"]=="object")return m5(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},p5=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},m5=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);let i=e.node();if($(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},g5=function(n,e,t,r){return C0(e,new c0(t,n),r)},v5=function(n,e,t){return C0(n,new a0(e),t)};function C0(n,e,t){let r=n.getPriority().val(),i=FO(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=FO(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new _c(a,un(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new _c(i))),o.forEachChild(dn,(a,c)=>{let u=C0(c,e.getImmediateChild(a),t);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var nd=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function T0(n,e){let t=e instanceof tt?e:new tt(e),r=n,i=ke(t);for(;i!==null;){let s=Rs(r.node.children,i)||{children:{},childCount:0};r=new nd(i,r,s),t=at(t),i=ke(t)}return r}function Tc(n){return n.node.value}function Fk(n,e){n.node.value=e,l0(n)}function Lk(n){return n.node.childCount>0}function _5(n){return Tc(n)===void 0&&!Lk(n)}function Vm(n,e){dr(n.node.children,(t,r)=>{e(new nd(t,n,r))})}function Vk(n,e,t,r){t&&!r&&e(n),Vm(n,i=>{Vk(i,e,!0,r)}),t&&r&&e(n)}function y5(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ad(n){return new tt(n.parent===null?n.name:ad(n.parent)+"/"+n.name)}function l0(n){n.parent!==null&&w5(n.parent,n.name,n)}function w5(n,e,t){let r=_5(t),i=Nr(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,l0(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,l0(n))}var I5=/[\[\].#$\/\u0000-\u001F\u007F]/,E5=/[\[\].#$\u0000-\u001F\u007F]/,CC=10*1024*1024,Uk=function(n){return typeof n=="string"&&n.length!==0&&!I5.test(n)},C5=function(n){return typeof n=="string"&&n.length!==0&&!E5.test(n)},T5=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),C5(n)};var jk=function(n,e,t){let r=t instanceof tt?new LC(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ao(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ao(r)+" with contents = "+e.toString());if($O(e))throw new Error(n+"contains "+e.toString()+" "+Ao(r));if(typeof e=="string"&&e.length>CC/3&&ml(e)>CC)throw new Error(n+"contains a string greater than "+CC+" utf8 bytes "+Ao(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(dr(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Uk(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ao(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);m9(r,o),jk(n,a,r),g9(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ao(r)+" in addition to actual children.")}};var b5=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Uk(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!T5(t))throw new Error(Gb(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var u0=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function S5(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!lk(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Oo(n,e,t){S5(n,t),D5(n,r=>Dr(r,e)||Dr(e,r))}function D5(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(A5(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function A5(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();xo&&ln("event: "+t.toString()),sd(r)}}}var R5="repo_interrupt",x5=25,d0=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new u0,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Nm(),this.transactionQueueTree_=new nd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function N5(n,e,t){if(n.stats_=v0(n.repoInfo_),n.forceRestClient_||q6())n.server_=new WC(n.repoInfo_,(r,i,s,o)=>{LO(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>VO(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{$t(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new _0(n.repoInfo_,e,(r,i,s,o)=>{LO(n,r,i,s,o)},r=>{VO(n,r)},r=>{P5(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=z6(n.repoInfo_,()=>new ZC(n.stats_,n.server_)),n.infoData_=new KC,n.infoSyncTree_=new km({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Fm(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),b0(n,"connected",!1),n.serverSyncTree_=new km({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);Oo(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function M5(n){let t=n.infoData_.getNode(new tt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Bk(n){return f5({timestamp:M5(n)})}function LO(n,e,t,r,i){n.dataUpdateCount++;let s=new tt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=fl(t,u=>un(u));o=h5(n.serverSyncTree_,s,c,i)}else{let c=un(t);o=d5(n.serverSyncTree_,s,c,i)}else if(r){let c=fl(t,u=>un(u));o=u5(n.serverSyncTree_,s,c)}else{let c=un(t);o=Fm(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=D0(n,s)),Oo(n.eventQueue_,a,o)}function VO(n,e){b0(n,"connected",e),e===!1&&k5(n)}function P5(n,e){dr(e,(t,r)=>{b0(n,t,r)})}function b0(n,e,t){let r=new tt("/.info/"+e),i=un(t);n.infoData_.updateSnapshot(r,i);let s=Fm(n.infoSyncTree_,r,i);Oo(n.eventQueue_,r,s)}function O5(n){return n.nextWriteId_++}function k5(n){$k(n,"onDisconnectEvents");let e=Bk(n),t=Nm();QC(n.onDisconnect_,Qe(),(i,s)=>{let o=g5(i,s,n.serverSyncTree_,e);mk(t,i,o)});let r=[];QC(t,Qe(),(i,s)=>{r=r.concat(Fm(n.serverSyncTree_,i,s));let o=U5(n,i);D0(n,o)}),n.onDisconnect_=Nm(),Oo(n.eventQueue_,Qe(),r)}function F5(n){n.persistentConnection_&&n.persistentConnection_.interrupt(R5)}function $k(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),ln(t,...e)}function Hk(n,e,t){return xk(n.serverSyncTree_,e,t)||gt.EMPTY_NODE}function S0(n,e=n.transactionQueueTree_){if(e||Um(n,e),Tc(e)){let t=Gk(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&L5(n,ad(e),t)}else Lk(e)&&Vm(e,t=>{S0(n,t)})}function L5(n,e,t){let r=t.map(u=>u.currentWriteId),i=Hk(n,e,r),s=i,o=i.hash();for(let u=0;u<t.length;u++){let d=t[u];$(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=lr(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,u=>{$k(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let f=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat(fc(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&f.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();Um(n,T0(n.transactionQueueTree_,e)),S0(n,n.transactionQueueTree_),Oo(n.eventQueue_,e,d);for(let m=0;m<f.length;m++)sd(f[m])}else{if(u==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{Wn("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=u}D0(n,e)}},o)}function D0(n,e){let t=qk(n,e),r=ad(t),i=Gk(n,t);return V5(n,i,r),r}function V5(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=lr(t,c.path),d=!1,f;if($(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(fc(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=x5)d=!0,f="maxretry",i=i.concat(fc(n.serverSyncTree_,c.currentWriteId,!0));else{let m=Hk(n,c.path,o);c.currentInputSnapshot=m;let v=e[a].update(m.val());if(v!==void 0){jk("transaction failed: Data returned ",v,c.path);let w=un(v);typeof v=="object"&&v!=null&&Nr(v,".priority")||(w=w.updatePriority(m.getPriority()));let R=c.currentWriteId,L=Bk(n),q=v5(w,m,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=q,c.currentWriteId=O5(n),o.splice(o.indexOf(R),1),i=i.concat(l5(n.serverSyncTree_,c.path,q,c.currentWriteId,c.applyLocally)),i=i.concat(fc(n.serverSyncTree_,R,!0))}else d=!0,f="nodata",i=i.concat(fc(n.serverSyncTree_,c.currentWriteId,!0))}Oo(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Um(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)sd(r[a]);S0(n,n.transactionQueueTree_)}function qk(n,e){let t,r=n.transactionQueueTree_;for(t=ke(e);t!==null&&Tc(r)===void 0;)r=T0(r,t),e=at(e),t=ke(e);return r}function Gk(n,e){let t=[];return zk(n,e,t),t.sort((r,i)=>r.order-i.order),t}function zk(n,e,t){let r=Tc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Vm(e,i=>{zk(n,i,t)})}function Um(n,e){let t=Tc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,Fk(e,t.length>0?t:void 0)}Vm(e,r=>{Um(n,r)})}function U5(n,e){let t=ad(qk(n,e)),r=T0(n.transactionQueueTree_,e);return y5(r,i=>{TC(n,i)}),TC(n,r),Vk(r,i=>{TC(n,i)}),t}function TC(n,e){let t=Tc(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?($(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):($(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(fc(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Fk(e,void 0):t.length=s+1,Oo(n.eventQueue_,ad(e),i);for(let o=0;o<r.length;o++)sd(r[o])}}function j5(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function B5(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Wn(`Invalid query segment '${t}' in query '${n}'`)}return e}var UO=function(n,e){let t=$5(n),r=t.namespace;t.domain==="firebase.com"&&ki(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ki("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||F6();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Tm(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new tt(t.pathString)}},$5=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=j5(n.substring(d,f)));let m=B5(n.substring(Math.min(n.length,f)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let v=e.slice(0,u);if(v.toLowerCase()==="localhost")t="localhost";else if(v.split(".").length<=2)t=v;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var h0=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Me(this._path)?null:ok(this._path)}get ref(){return new Ec(this._repo,this._path)}get _queryIdentifier(){let e=bO(this._queryParams),t=g0(e);return t==="{}"?"default":t}get _queryObject(){return bO(this._queryParams)}isEqual(e){if(e=xe(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=lk(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+p9(this._path)}};var Ec=class n extends h0{constructor(e,t){super(e,t,new zC,!1)}get parent(){let e=ck(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};a5(Ec);c5(Ec);var H5="FIREBASE_DATABASE_EMULATOR_HOST",f0={},q5=!1;function G5(n,e,t,r){n.repoInfo_=new Tm(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function z5(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ki("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ln("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=UO(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[H5]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=UO(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Zu(Zu.OWNER):new xC(n.name,n.options,e);b5("Invalid Firebase Database URL",o),Me(o.path)||ki("Database URL must point to the root of a Firebase Database (not including a child path).");let f=K5(a,n,d,new RC(n.name,t));return new p0(f,n)}function W5(n,e){let t=f0[e];(!t||t[n.key]!==n)&&ki(`Database ${e}(${n.repoInfo_}) has already been deleted.`),F5(n),delete t[n.key]}function K5(n,e,t,r){let i=f0[e.name];i||(i={},f0[e.name]=i);let s=i[n.toURLString()];return s&&ki("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new d0(n,q5,t,r),i[n.toURLString()]=s,s}var p0=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(N5(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ec(this._repo,Qe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(W5(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ki("Cannot call "+e+" on a deleted database.")}};function Wk(n=Nt(),e){let t=xt(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Gi("database");r&&Kk(t,...r)}return t}function Kk(n,e,t,r={}){n=xe(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ki("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ki('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Zu(Zu.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:zo(r.mockUserToken,n.app.options.projectId);s=new Zu(o)}G5(i,e,t,s)}function Q5(n){P6(bn),bt(new Tt("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return z5(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),J(aO,cO,n),J(aO,cO,"esm2017")}_0.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};_0.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Q5();var cd=class{constructor(e){return e}},Qk="database",A0=class{constructor(){return At(Qk)}};var R0=new H("angularfire2.database-instances");function Y5(n,e){let t=Ot(Qk,n,e);return t&&new cd(t)}function Z5(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new cd(r)}}var J5={provide:A0,deps:[[new ue,R0]]},X5={provide:cd,useFactory:Y5,deps:[[new ue,R0],ot]};function Yk(n,...e){return J("angularfire",st.full,"rtdb"),nt([X5,J5,{provide:R0,useFactory:Z5(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Er],[new ue,Pn],...e]}])}var Zk=Ue(Wk,!0);var e1="functions";var x0=class{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||t.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return _(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return _(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return _(this,null,function*(){if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return _(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var N0="us-central1";var M0=class{constructor(e,t,r,i,s=N0,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new x0(t,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=N0}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function e8(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var Jk="@firebase/functions",Xk="0.11.8";var t8="auth-internal",n8="app-check-internal",r8="messaging-internal";function i8(n,e){let t=(r,{instanceIdentifier:i})=>{let s=r.getProvider("app").getImmediate(),o=r.getProvider(t8),a=r.getProvider(r8),c=r.getProvider(n8);return new M0(s,o,a,c,i,n)};bt(new Tt(e1,t,"PUBLIC").setMultipleInstances(!0)),J(Jk,Xk,e),J(Jk,Xk,"esm2017")}function t1(n=Nt(),e=N0){let r=xt(xe(n),e1).getImmediate({identifier:e}),i=Gi("functions");return i&&n1(r,...i),r}function n1(n,e,t){e8(xe(n),e,t)}i8(fetch.bind(self));var ld=class{constructor(e){return e}},r1="functions",P0=class{constructor(){return At(r1)}};var O0=new H("angularfire2.functions-instances");function s8(n,e){let t=Ot(r1,n,e);return t&&new ld(t)}function o8(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ld(r)}}var a8={provide:P0,deps:[[new ue,O0]]},c8={provide:ld,useFactory:s8,deps:[[new ue,O0],ot]};function i1(n,...e){return J("angularfire",st.full,"fn"),nt([c8,a8,{provide:O0,useFactory:o8(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Er],[new ue,Pn],...e]}])}var s1=Ue(t1,!0);var l8="/firebase-messaging-sw.js",u8="/firebase-cloud-messaging-push-scope",d1="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",d8="https://fcmregistrations.googleapis.com/v1",h1="google.c.a.c_id",h8="google.c.a.c_l",f8="google.c.a.ts",p8="google.c.a.e";var jm=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}(jm||{});function Fi(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m8(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}var k0="fcm_token_details_db",g8=5,o1="fcm_token_object_Store";function v8(n){return _(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(k0))return null;let e=null;return(yield Yg(k0,g8,{upgrade:(r,i,s,o)=>_(this,null,function*(){var a;if(i<2||!r.objectStoreNames.contains(o1))return;let c=o.objectStore(o1),u=yield c.index("fcmSenderId").get(n);if(yield c.clear(),!!u){if(i===2){let d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Fi(d.vapidKey)}}}else if(i===3){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fi(d.auth),p256dh:Fi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fi(d.vapidKey)}}}else if(i===4){let d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Fi(d.auth),p256dh:Fi(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Fi(d.vapidKey)}}}}})})).close(),yield Hd(k0),yield Hd("fcm_vapid_details_db"),yield Hd("undefined"),_8(e)?e:null})}function _8(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var y8="firebase-messaging-database",w8=1,ud="firebase-messaging-store",F0=null;function f1(){return F0||(F0=Yg(y8,w8,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ud)}}})),F0}function I8(n){return _(this,null,function*(){let e=p1(n),r=yield(yield f1()).transaction(ud).objectStore(ud).get(e);if(r)return r;{let i=yield v8(n.appConfig.senderId);if(i)return yield U0(n,i),i}})}function U0(n,e){return _(this,null,function*(){let t=p1(n),i=(yield f1()).transaction(ud,"readwrite");return yield i.objectStore(ud).put(e,t),yield i.done,e})}function p1({appConfig:n}){return n.appId}var E8={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},En=new xr("messaging","Messaging",E8);function C8(n,e){return _(this,null,function*(){let t=yield B0(n),r=m1(e),i={method:"POST",headers:t,body:JSON.stringify(r)},s;try{s=yield(yield fetch(j0(n.appConfig),i)).json()}catch(o){throw En.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw En.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw En.create("token-subscribe-no-token");return s.token})}function T8(n,e){return _(this,null,function*(){let t=yield B0(n),r=m1(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)},s;try{s=yield(yield fetch(`${j0(n.appConfig)}/${e.token}`,i)).json()}catch(o){throw En.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error){let o=s.error.message;throw En.create("token-update-failed",{errorInfo:o})}if(!s.token)throw En.create("token-update-no-token");return s.token})}function b8(n,e){return _(this,null,function*(){let r={method:"DELETE",headers:yield B0(n)};try{let s=yield(yield fetch(`${j0(n.appConfig)}/${e}`,r)).json();if(s.error){let o=s.error.message;throw En.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw En.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function j0({projectId:n}){return`${d8}/projects/${n}/registrations`}function B0(t){return _(this,arguments,function*({appConfig:n,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function m1({p256dh:n,auth:e,endpoint:t,vapidKey:r}){let i={web:{endpoint:t,auth:e,p256dh:n}};return r!==d1&&(i.web.applicationPubKey=r),i}var S8=7*24*60*60*1e3;function D8(n){return _(this,null,function*(){let e=yield R8(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Fi(e.getKey("auth")),p256dh:Fi(e.getKey("p256dh"))},r=yield I8(n.firebaseDependencies);if(r){if(x8(r.subscriptionOptions,t))return Date.now()>=r.createTime+S8?A8(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield b8(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return a1(n.firebaseDependencies,t)}else return a1(n.firebaseDependencies,t)})}function A8(n,e){return _(this,null,function*(){try{let t=yield T8(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield U0(n.firebaseDependencies,r),t}catch(t){throw t}})}function a1(n,e){return _(this,null,function*(){let r={token:yield C8(n,e),createTime:Date.now(),subscriptionOptions:e};return yield U0(n,r),r.token})}function R8(n,e){return _(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:m8(e)})})}function x8(n,e){let t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,s=e.p256dh===n.p256dh;return t&&r&&i&&s}function c1(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return N8(e,n),M8(e,n),P8(e,n),e}function N8(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let r=e.notification.body;r&&(n.notification.body=r);let i=e.notification.image;i&&(n.notification.image=i);let s=e.notification.icon;s&&(n.notification.icon=s)}function M8(n,e){e.data&&(n.data=e.data)}function P8(n,e){var t,r,i,s,o;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;a&&(n.fcmOptions.link=a);let c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(n.fcmOptions.analyticsLabel=c)}function O8(n){return typeof n=="object"&&!!n&&h1 in n}k8("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function k8(n,e){let t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function F8(n){if(!n||!n.options)throw L0("App Configuration Object");if(!n.name)throw L0("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let r of e)if(!t[r])throw L0(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function L0(n){return En.create("missing-app-config-values",{valueName:n})}var V0=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=F8(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};function L8(n){return _(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(l8,{scope:u8}),n.swRegistration.update().catch(()=>{})}catch(e){throw En.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function V8(n,e){return _(this,null,function*(){if(!e&&!n.swRegistration&&(yield L8(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw En.create("invalid-sw-registration");n.swRegistration=e}})}function U8(n,e){return _(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=d1)})}function j8(n,e){return _(this,null,function*(){if(!navigator)throw En.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw En.create("permission-blocked");return yield U8(n,e?.vapidKey),yield V8(n,e?.serviceWorkerRegistration),D8(n)})}function B8(n,e,t){return _(this,null,function*(){let r=$8(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[h1],message_name:t[h8],message_time:t[f8],message_device_time:Math.floor(Date.now()/1e3)})})}function $8(n){switch(n){case jm.NOTIFICATION_CLICKED:return"notification_open";case jm.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function H8(n,e){return _(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===jm.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(c1(t)):n.onMessageHandler.next(c1(t)));let r=t.data;O8(r)&&r[p8]==="1"&&(yield B8(n,t.messageType,r))})}var l1="@firebase/messaging",u1="0.12.12";var q8=n=>{let e=new V0(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>H8(e,t)),e},G8=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:r=>j8(e,r)}};function z8(){bt(new Tt("messaging",q8,"PUBLIC")),bt(new Tt("messaging-internal",G8,"PRIVATE")),J(l1,u1),J(l1,u1,"esm2017")}function $0(){return _(this,null,function*(){try{yield As()}catch{return!1}return typeof window<"u"&&ii()&&dl()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function g1(n=Nt()){return $0().then(e=>{if(!e)throw En.create("unsupported-browser")},e=>{throw En.create("indexed-db-unsupported")}),xt(xe(n),"messaging").getImmediate()}z8();var dd=class{constructor(e){return e}},v1="messaging",H0=class{constructor(){return At(v1)}};var _1="__angularfire_symbol__messagingIsSupported",q0="__angularfire_symbol__messagingIsSupportedValue";globalThis[_1]||=$0().then(n=>globalThis[q0]=n).catch(()=>globalThis[q0]=!1);var Bm={async:()=>globalThis[_1],sync:()=>{let n=globalThis[q0];if(n===void 0)throw new Error(Ua("Messaging"));return n}},G0=new H("angularfire2.messaging-instances");function W8(n,e){if(!Bm.sync())return null;let t=Ot(v1,n,e);return t&&new dd(t)}function K8(n){return(e,t)=>{if(!Bm.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new dd(r)}}var Q8={provide:H0,deps:[[new ue,G0]]},Y8={provide:dd,useFactory:W8,deps:[[new ue,G0],ot]};function y1(n,...e){return J("angularfire",st.full,"fcm"),nt([Y8,Q8,{provide:cs,useValue:Bm.async,multi:!0},{provide:G0,useFactory:K8(n),multi:!0,deps:[se,Ae,Et,pt,...e]}])}var zle=Bm.async;var w1=Ue(g1,!0);var hd=class{constructor(e){return e}},I1="performance",z0=class{constructor(){return At(I1)}};var W0=new H("angularfire2.performance-instances");function Z8(n,e,t){if(!my(t))return null;let r=Ot(I1,n,e);return r&&new hd(r)}function J8(n){return(e,t,r)=>{if(!my(t))return null;let i=e.runOutsideAngular(()=>n(r));return new hd(i)}}var X8={provide:z0,deps:[[new ue,W0]]},eK={provide:hd,useFactory:Z8,deps:[[new ue,W0],ot,yr]};function E1(n,...e){return J("angularfire",st.full,"perf"),nt([eK,X8,{provide:W0,useFactory:J8(n),multi:!0,deps:[se,yr,Ae,Et,pt,...e]}])}var C1=Ue(Kb,!0);var R1="firebasestorage.googleapis.com",tK="storageBucket",nK=2*60*1e3,rK=10*60*1e3;var Xr=class n extends Tn{constructor(e,t,r=0){super(K0(e),`Firebase Storage: ${t} (${K0(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return K0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Vi=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Vi||{});function K0(n){return"storage/"+n}function iK(){let n="An unknown error occurred, please check the error payload for server response.";return new Xr(Vi.UNKNOWN,n)}function sK(){return new Xr(Vi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function oK(){return new Xr(Vi.CANCELED,"User canceled the upload/download.")}function aK(n){return new Xr(Vi.INVALID_URL,"Invalid URL '"+n+"'.")}function cK(n){return new Xr(Vi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function T1(n){return new Xr(Vi.INVALID_ARGUMENT,n)}function x1(){return new Xr(Vi.APP_DELETED,"The Firebase app was deleted.")}function lK(n){return new Xr(Vi.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Li=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw cK(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(te){te.path.charAt(te.path.length-1)==="/"&&(te.path_=te.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(te){te.path_=decodeURIComponent(te.path)}let d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${d}/b/${i}/o${m}`,"i"),w={bucket:1,path:3},M=t===R1?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${M}/${i}/${R}`,"i"),W=[{regex:a,indices:c,postModify:s},{regex:v,indices:w,postModify:u},{regex:L,indices:{bucket:1,path:2},postModify:u}];for(let te=0;te<W.length;te++){let Ye=W[te],ie=Ye.regex.exec(e);if(ie){let C=ie[Ye.indices.bucket],y=ie[Ye.indices.path];y||(y=""),r=new n(C,y),Ye.postModify(r);break}}if(r==null)throw aK(e);return r}},Q0=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function uK(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function d(...R){u||(u=!0,e.apply(null,R))}function f(R){i=setTimeout(()=>{i=null,n(v,c())},R)}function m(){s&&clearTimeout(s)}function v(R,...L){if(u){m();return}if(R){m(),d.call(null,R,...L);return}if(c()||o){m(),d.call(null,R,...L);return}r<64&&(r*=2);let W;a===1?(a=2,W=0):W=(r+Math.random())*1e3,f(W)}let w=!1;function M(R){w||(w=!0,m(),!u&&(i!==null?(R||(a=2),clearTimeout(i),f(0)):R||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,M(!0)},t),M}function dK(n){n(!1)}function hK(n){return n!==void 0}function b1(n,e,t,r){if(r<e)throw T1(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw T1(`Invalid value for '${n}'. Expected ${t} or less.`)}function fK(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Y0=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Y0||{});function pK(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var Z0=class{constructor(e,t,r,i,s,o,a,c,u,d,f,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,w)=>{this.resolve_=v,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new bc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Y0.NO_ERROR,c=s.getStatus();if(!a||pK(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Y0.ABORT;r(!1,new bc(!1,null,d));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new bc(u,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());hK(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=iK();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?x1():oK();o(c)}else{let c=sK();o(c)}};this.canceled_?t(!1,new bc(!1,null,!0)):this.backoffId_=uK(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},bc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function mK(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function gK(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vK(n,e){e&&(n["X-Firebase-GMPID"]=e)}function _K(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function yK(n,e,t,r,i,s,o=!0){let a=fK(n.urlParams),c=n.url+a,u=Object.assign({},n.headers);return vK(u,e),mK(u,t),gK(u,s),_K(u,r),new Z0(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function wK(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function IK(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var lue=256*1024;var J0=class n{constructor(e,t){this._service=e,t instanceof Li?this._location=t:this._location=Li.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Li(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return IK(this._location.path)}get storage(){return this._service}get parent(){let e=wK(this._location.path);if(e===null)return null;let t=new Li(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw lK(e)}};function S1(n,e){let t=e?.[tK];return t==null?null:Li.makeFromBucketSpec(t,n)}function EK(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:zo(i,n.app.options.projectId))}var X0=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=R1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nK,this._maxUploadRetryTime=rK,this._requests=new Set,i!=null?this._bucket=Li.makeFromBucketSpec(i,this._host):this._bucket=S1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Li.makeFromBucketSpec(this._url,e):this._bucket=S1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){b1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){b1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return _(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return _(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new J0(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Q0(x1());{let o=yK(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return _(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},D1="@firebase/storage",A1="0.13.2";var N1="storage";function M1(n=Nt(),e){n=xe(n);let r=xt(n,N1).getImmediate({identifier:e}),i=Gi("storage");return i&&P1(r,...i),r}function P1(n,e,t,r={}){EK(n,e,t,r)}function CK(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new X0(t,r,i,e,bn)}function TK(){bt(new Tt(N1,CK,"PUBLIC").setMultipleInstances(!0)),J(D1,A1,""),J(D1,A1,"esm2017")}TK();var fd=class{constructor(e){return e}},O1="storage",eT=class{constructor(){return At(O1)}};var tT=new H("angularfire2.storage-instances");function bK(n,e){let t=Ot(O1,n,e);return t&&new fd(t)}function SK(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new fd(r)}}var DK={provide:eT,deps:[[new ue,tT]]},AK={provide:fd,useFactory:bK,deps:[[new ue,tT],ot]};function k1(n,...e){return J("angularfire",st.full,"gcs"),nt([AK,DK,{provide:tT,useFactory:SK(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Er],[new ue,Pn],...e]}])}var F1=Ue(M1,!0);var nT="@firebase/remote-config",L1="0.4.9";var V1="remote-config";var RK={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},Fn=new xr("remoteconfig","Remote Config",RK);function U1(n=Nt()){return n=xe(n),xt(n,V1).getImmediate()}function j1(n){let e=xe(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var rT=class{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return _(this,null,function*(){let[t,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&s.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(s),i})}};function xK(n=navigator){return n.languages&&n.languages[0]||n.language}var iT=class{constructor(e,t,r,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){return _(this,null,function*(){let[t,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:xK()},c={method:"POST",headers:o,body:JSON.stringify(a)},u=fetch(s,c),d=new Promise((R,L)=>{e.signal.addEventListener(()=>{let q=new Error("The operation was aborted.");q.name="AbortError",L(q)})}),f;try{yield Promise.race([u,d]),f=yield u}catch(R){let L="fetch-client-network";throw R?.name==="AbortError"&&(L="fetch-timeout"),Fn.create(L,{originalErrorMessage:R?.message})}let m=f.status,v=f.headers.get("ETag")||void 0,w,M;if(f.status===200){let R;try{R=yield f.json()}catch(L){throw Fn.create("fetch-client-parse",{originalErrorMessage:L?.message})}w=R.entries,M=R.state}if(M==="INSTANCE_STATE_UNSPECIFIED"?m=500:M==="NO_CHANGE"?m=304:(M==="NO_TEMPLATE"||M==="EMPTY_CONFIG")&&(w={}),m!==304&&m!==200)throw Fn.create("fetch-status",{httpStatus:m});return{status:m,eTag:v,config:w}})}};function NK(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(Fn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function MK(n){if(!(n instanceof Tn)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var sT=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return _(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(i,s){return _(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:r}){yield NK(e.signal,t);try{let o=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),o}catch(o){if(!MK(o))throw o;let a={throttleEndTimeMillis:Date.now()+gl(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(a),this.attemptFetch(e,a)}})}};var PK=60*1e3,OK=12*60*60*1e3,oT=class{constructor(e,t,r,i,s){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:PK,minimumFetchIntervalMillis:OK},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}};function $m(n,e){let t=n.target.error||void 0;return Fn.create(e,{originalErrorMessage:t&&t?.message})}var ko="app_namespace_store",kK="firebase_remote_config",FK=1;function LK(){return new Promise((n,e)=>{try{let t=indexedDB.open(kK,FK);t.onerror=r=>{e($m(r,"storage-open"))},t.onsuccess=r=>{n(r.target.result)},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ko,{keyPath:"compositeKey"})}}}catch(t){e(Fn.create("storage-open",{originalErrorMessage:t?.message}))}})}var aT=class{constructor(e,t,r,i=LK()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){return _(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let o=t.transaction([ko],"readonly").objectStore(ko),a=this.createCompositeKey(e);try{let c=o.get(a);c.onerror=u=>{i($m(u,"storage-get"))},c.onsuccess=u=>{let d=u.target.result;r(d?d.value:void 0)}}catch(c){i(Fn.create("storage-get",{originalErrorMessage:c?.message}))}})})}set(e,t){return _(this,null,function*(){let r=yield this.openDbPromise;return new Promise((i,s)=>{let a=r.transaction([ko],"readwrite").objectStore(ko),c=this.createCompositeKey(e);try{let u=a.put({compositeKey:c,value:t});u.onerror=d=>{s($m(d,"storage-set"))},u.onsuccess=()=>{i()}}catch(u){s(Fn.create("storage-set",{originalErrorMessage:u?.message}))}})})}delete(e){return _(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let o=t.transaction([ko],"readwrite").objectStore(ko),a=this.createCompositeKey(e);try{let c=o.delete(a);c.onerror=u=>{i($m(u,"storage-delete"))},c.onsuccess=()=>{r()}}catch(c){i(Fn.create("storage-delete",{originalErrorMessage:c?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}};var cT=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){return _(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=yield e;i&&(this.lastFetchStatus=i);let s=yield t;s&&(this.lastSuccessfulFetchTimestampMillis=s);let o=yield r;o&&(this.activeConfig=o)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}};function VK(){bt(new Tt(V1,n,"PUBLIC").setMultipleInstances(!0)),J(nT,L1),J(nT,L1,"esm2017");function n(e,{instanceIdentifier:t}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Fn.create("registration-window");if(!ii())throw Fn.create("indexed-db-unavailable");let{projectId:s,apiKey:o,appId:a}=r.options;if(!s)throw Fn.create("registration-project-id");if(!o)throw Fn.create("registration-api-key");if(!a)throw Fn.create("registration-app-id");t=t||"firebase";let c=new aT(a,r.name,t),u=new cT(c),d=new Mr(nT);d.logLevel=rn.ERROR;let f=new iT(i,bn,t,s,o,a),m=new sT(f,c),v=new rT(m,c,u,d),w=new oT(r,v,u,c,d);return j1(w),w}}function B1(){return _(this,null,function*(){if(!ii())return!1;try{return yield As()}catch{return!1}})}VK();var pd=class{constructor(e){return e}},$1="remote-config",lT=class{constructor(){return At($1)}};var uT="__angularfire_symbol__remoteConfigIsSupportedValue",H1="__angularfire_symbol__remoteConfigIsSupported";globalThis[H1]||=B1().then(n=>globalThis[uT]=n).catch(()=>globalThis[uT]=!1);var Hm={async:()=>globalThis[H1],sync:()=>{let n=globalThis[uT];if(n===void 0)throw new Error(Ua("RemoteConfig"));return n}},dT=new H("angularfire2.remote-config-instances");function UK(n,e){if(!Hm.sync())return null;let t=Ot($1,n,e);return t&&new pd(t)}function jK(n){return(e,t)=>{if(!Hm.sync())return null;let r=e.runOutsideAngular(()=>n(t));return new pd(r)}}var BK={provide:lT,deps:[[new ue,dT]]},$K={provide:pd,useFactory:UK,deps:[[new ue,dT],ot]};function q1(n,...e){return J("angularfire",st.full,"rc"),nt([$K,BK,{provide:cs,useValue:Hm.async,multi:!0},{provide:dT,useFactory:jK(n),multi:!0,deps:[se,Ae,Et,pt,...e]}])}var ode=Hm.async;var G1=Ue(U1,!0);var z1="@firebase/vertexai-preview",W1="0.0.4";var K1="vertexAI",Q1="us-central1";var hT=class{constructor(e,t,r,i){var s;this.app=e,this.options=i;let o=r?.getImmediate({optional:!0}),a=t?.getImmediate({optional:!0});this.auth=a||null,this.appCheck=o||null,this.location=((s=this.options)===null||s===void 0?void 0:s.location)||Q1}_delete(){return Promise.resolve()}};var fT=function(n){return n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.OTHER="OTHER",n}(fT||{});var hde=[fT.RECITATION,fT.SAFETY];function Y1(n=Nt(),e){return n=xe(n),xt(n,K1).getImmediate({identifier:e?.location||Q1})}function HK(){bt(new Tt(K1,(n,{instanceIdentifier:e})=>{let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new hT(t,r,i,{location:e})},"PUBLIC").setMultipleInstances(!0)),J(z1,W1),J(z1,W1,"esm2017")}HK();var md=class{constructor(e){return e}},Z1="vertexai",pT=class{constructor(){return At(Z1)}};var mT=new H("angularfire2.vertexai-instances");function qK(n,e){let t=Ot(Z1,n,e);return t&&new md(t)}function GK(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new md(r)}}var zK={provide:pT,deps:[[new ue,mT]]},WK={provide:md,useFactory:qK,deps:[[new ue,mT],ot]};function J1(n,...e){return J("angularfire",st.full,"vertexai"),nt([WK,zK,{provide:mT,useFactory:GK(n),multi:!0,deps:[se,Ae,Et,pt,[new ue,Pn],...e]}])}var X1=Ue(Y1,!0);var eF={firebaseConfig:{apiKey:"AIzaSyBggO56pZ3V5jgNnv_4i_CpUbgU_iGvcsk",authDomain:"dash-boar-7ee0d.firebaseapp.com",projectId:"dash-boar-7ee0d",storageBucket:"dash-boar-7ee0d.firebasestorage.app",messagingSenderId:"325394396819",appId:"1:325394396819:web:e9673769b33be96849bf66",measurementId:"G-V0X3V5XKL2"},production:!0};var tF={providers:[NR({eventCoalescing:!0}),Vx(Ux),jx(()=>Bx(eF.firebaseConfig)),PN(()=>kN()),nM(()=>eM()),tM,iI,rO(()=>iO()),Yk(()=>Zk()),i1(()=>s1()),y1(()=>w1()),E1(()=>C1()),k1(()=>F1()),q1(()=>G1()),J1(()=>X1())]};var Ln=class n{destroyRef=P(ss);firestore=P(Do);destroyed=new ht;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed.next(),this.destroyed.complete()})}generateNextId(){return _(this,null,function*(){let e=yield gC(this.collectionRef),t=0;return e.forEach(r=>{let i=r.data(),s=parseInt(i.id,10);!isNaN(s)&&s>t&&(t=s)}),(t+1).toString()})}createData(e,t){let r=mC(this.collectionRef,e);return vC(r,t)}updateData(e,t){return vC(mC(this.collectionRef,e),t,{merge:!0})}getDataById(e){return _(this,null,function*(){let t=sO(this.collectionRef,oO("id","==",e)),r=yield gC(t);if(!r.empty)return r.docs[0].data()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};function vt(n){n||(hf(vt),n=P(ss));let e=new he(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(Ht(e))}function De(n,e){!e?.injector&&hf(De);let t=e?.injector??P(Ae),r=new Cl(1),i=Ii(()=>{let s;try{s=n()}catch(o){rr(()=>r.error(o));return}rr(()=>r.next(s))},{injector:t,manualCleanup:!0});return t.get(ss).onDestroy(()=>{i.destroy(),r.complete()}),r.asObservable()}var dt=class n extends Ln{collectionPath="/race-configs";collectionRef=cr(this.firestore,this.collectionPath);activeRaceConfig=X(void 0);constructor(){super(),this.getAll().pipe(vt()).subscribe(e=>{e.length>0&&this.activeRaceConfig.set(e.at(0))})}updateFuelDurationMinute(e){let t=this.activeRaceConfig();return t?(t.fuelDurationMinute=e,this.updateData(t.id,t)):Promise.resolve()}updateStartRaceDriverId(e){let t=this.activeRaceConfig();return t?(t.startRaceDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitDriverId(e){let t=this.activeRaceConfig();return t?(t.nextPitDriverId=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitRefueling(e){let t=this.activeRaceConfig();return t?(t.nextPitRefueling=e,this.updateData(t.id,t)):Promise.resolve()}updateNextPitTyreChange(e){let t=this.activeRaceConfig();return t?(t.nextPitTyreChange=e,this.updateData(t.id,t)):Promise.resolve()}getAll(){return ar(this.collectionRef).pipe(Ht(this.destroyed),Q(e=>e.filter(t=>!t.deleted)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var KK=Math.pow(10,8)*24*60*60*1e3,dhe=-KK;var nF=864e5,Sc=6e4,Dc=36e5,rF=1e3;var QK=3600;var iF=QK*24,hhe=iF*7,YK=iF*365.2425,ZK=YK/12,fhe=ZK*3,gT=Symbol.for("constructDateFrom");function Kn(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&gT in n?n[gT](e):n instanceof Date?new n.constructor(e):new Date(e)}function Be(n,e){return Kn(e||n,n)}function sF(n,e,t){let r=Be(n,t?.in);return isNaN(e)?Kn(t?.in||n,NaN):(e&&r.setDate(r.getDate()+e),r)}function oF(n,e,t){let r=Be(n,t?.in);if(isNaN(e))return Kn(t?.in||n,NaN);if(!e)return r;let i=r.getDate(),s=Kn(t?.in||n,r.getTime());s.setMonth(r.getMonth()+e+1,0);let o=s.getDate();return i>=o?s:(r.setFullYear(s.getFullYear(),s.getMonth(),i),r)}function Ac(n,e,t){let{years:r=0,months:i=0,weeks:s=0,days:o=0,hours:a=0,minutes:c=0,seconds:u=0}=e,d=Be(n,t?.in),f=i||r?oF(d,i+r*12):d,m=o||s?sF(f,o+s*7):f,v=c+a*60,M=(u+v*60)*1e3;return Kn(t?.in||n,+m+M)}function qm(n,e,t){return Kn(t?.in||n,+Be(n)+e)}function Rc(n,e,t){return qm(n,e*Dc,t)}function vT(n){let e=Be(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function hn(n,...e){let t=Kn.bind(null,n||e.find(r=>typeof r=="object"));return e.map(t)}function _T(n,e){let t=Be(n,e?.in);return t.setHours(0,0,0,0),t}function aF(n,e,t){let[r,i]=hn(t?.in,n,e),s=_T(r),o=_T(i),a=+s-vT(s),c=+o-vT(o);return Math.round((a-c)/nF)}function Fo(n,e,t){let r=Be(n,t?.in);return r.setTime(r.getTime()+e*Sc),r}function cF(n,e,t){return qm(n,e*1e3,t)}function Lo(n,e){let t=+Be(n)-+Be(e);return t<0?-1:t>0?1:t}function lF(n,e,t){let[r,i]=hn(t?.in,n,e),s=r.getFullYear()-i.getFullYear(),o=r.getMonth()-i.getMonth();return s*12+o}function uF(n,e,t){let[r,i]=hn(t?.in,n,e);return r.getFullYear()-i.getFullYear()}function hF(n,e,t){let[r,i]=hn(t?.in,n,e),s=dF(r,i),o=Math.abs(aF(r,i));r.setDate(r.getDate()-s*o);let a=+(dF(r,i)===-s),c=s*(o-a);return c===0?0:c}function dF(n,e){let t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function xc(n){return e=>{let r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function fF(n,e,t){let[r,i]=hn(t?.in,n,e),s=(+r-+i)/Dc;return xc(t?.roundingMethod)(s)}function Ui(n,e){return+Be(n)-+Be(e)}function Gm(n,e,t){let r=Ui(n,e)/Sc;return xc(t?.roundingMethod)(r)}function pF(n,e){let t=Be(n,e?.in);return t.setHours(23,59,59,999),t}function mF(n,e){let t=Be(n,e?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function gF(n,e){let t=Be(n,e?.in);return+pF(t,e)==+mF(t,e)}function vF(n,e,t){let[r,i,s]=hn(t?.in,n,n,e),o=Lo(i,s),a=Math.abs(lF(i,s));if(a<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-o*a);let c=Lo(i,s)===-o;gF(r)&&a===1&&Lo(r,s)===1&&(c=!1);let u=o*(a-+c);return u===0?0:u}function _F(n,e,t){let r=Ui(n,e)/1e3;return xc(t?.roundingMethod)(r)}function yF(n,e,t){let[r,i]=hn(t?.in,n,e),s=Lo(r,i),o=Math.abs(uF(r,i));r.setFullYear(1584),i.setFullYear(1584);let a=Lo(r,i)===-s,c=s*(o-+a);return c===0?0:c}function wF(n,e){let[t,r]=hn(n,e.start,e.end);return{start:t,end:r}}function yT(n){return Math.trunc(n*Dc)}function wT(n,e){let{start:t,end:r}=wF(e?.in,n),i={},s=yF(r,t);s&&(i.years=s);let o=Ac(t,{years:i.years}),a=vF(r,o);a&&(i.months=a);let c=Ac(o,{months:i.months}),u=hF(r,c);u&&(i.days=u);let d=Ac(c,{days:i.days}),f=fF(r,d);f&&(i.hours=f);let m=Ac(d,{hours:i.hours}),v=Gm(r,m);v&&(i.minutes=v);let w=Ac(m,{minutes:i.minutes}),M=_F(r,w);return M&&(i.seconds=M),i}function IF(n,e){return+Be(n)>+Be(e)}function EF(n,e){return+Be(n)<+Be(e)}function zm(n){return Math.trunc(n*Sc)}function CF(n){return n*rF}function TF(n,e,t){return Fo(n,-e,t)}var Vt=class n extends Ln{collectionPath="/races";collectionRef=cr(this.firestore,this.collectionPath);raceConfigService=P(dt);activeRace=X(void 0);endRaceDate=X(void 0);constructor(){super(),Je({races:this.getAll(),raceConfig:De(this.raceConfigService.activeRaceConfig)}).pipe(vt(),Q(({races:e,raceConfig:t})=>{if(e&&t){let r=this.getActiveRace(e,t),i=r?Rc(r.start.toDate(),t.durationHour):void 0;return{activeRace:r,endRaceDate:i}}return{activeRace:void 0,endRaceDate:void 0}})).subscribe(e=>{this.activeRace.set(e.activeRace),this.endRaceDate.set(e.endRaceDate)})}create(e){return _(this,null,function*(){return this.activeRace()!==void 0?(console.warn("Race already active -> "+this.activeRace()),Promise.resolve()):(e.id=yield this.generateNextId(),yield this.createData(e.id,e),e)})}getAll(){return ar(this.collectionRef).pipe(Ht(this.destroyed),Q(e=>e.filter(t=>!t.deleted)))}getActiveRace(e,t){let r=new Date,i=e.sort((s,o)=>o.start.toDate().getTime()-s.start.toDate().getTime());for(let s of i)if(Rc(s.start.toDate(),t.durationHour)>=r)return s}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};function Cs(n,e){if(!n||!e)return"--:--:--";let t=wT({end:e,start:n});return Wm(t)}function Vo(n){if(!n)return"--:--:--";let e=wT({end:n,start:new Date});return Wm(e)}function Cn(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={hours:Math.floor(e/3600),minutes:Math.floor(e%3600/60),seconds:e%60};return Wm(t)}function bF(n){if(!n||n<0)return"--:--:--";let e=Math.floor(n/1e3),t={minutes:Math.floor(e%3600/60),seconds:e%60};return Wm(t)}function SF(n){if(!n||n<0)return"--:--:---";let e=Math.floor(n/1e3),t=n%1e3,r={minutes:Math.floor(e/60),seconds:e%60};return JK(r,t)}function JK(n,e){return n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:---":[gd(n.minutes),gd(n.seconds),XK(e)].join(":")}function Wm(n){return n.hours&&n.hours<0||n.minutes&&n.minutes<0||n.seconds&&n.seconds<0?"--:--:--":[gd(n.hours),gd(n.minutes),gd(n.seconds)].join(":")}function gd(n){return n?n<10?`0${n}`:`${n}`:"00"}function XK(n){return n<10?`00${n}`:n<100?`0${n}`:`${n}`}var fn=class n extends Ln{collectionPath="/pits";collectionRef=cr(this.firestore,this.collectionPath);raceService=P(Vt);raceConfigService=P(dt);activePit=X(void 0);activePitRemainingMilliseconds=X(0);lastRefuelPit=X(void 0);pits=X([]);completedDriverChanges=X(0);lastDriverChangePit=X(void 0);remainingDriverChanges=X(0);constructor(){super(),Je({pits:this.getRacePits(),activeRaceConfig:De(this.raceConfigService.activeRaceConfig),ping:Yt(1e3)}).pipe(vt()).subscribe(({pits:e,activeRaceConfig:t})=>{this.pits.set(e),this.activePit.set(this.getActivePit(e)),this.activePitRemainingMilliseconds.set(this.calculateActivePitRemainingMilliseconds(e,t)),this.lastRefuelPit.set(this.getLastRefuelPit(e)),this.lastDriverChangePit.set(this.getLastDriverChangePit(e)),this.completedDriverChanges.set(this.calculateCompletedDriverChanges(e)),this.remainingDriverChanges.set(this.calculateRemainingDriverChanges(e,t))})}create(e){return _(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return this.updateData(e.id,e)}getRacePits(){return Je({pits:ar(this.collectionRef),activeRace:De(this.raceService.activeRace)}).pipe(Ht(this.destroyed),Q(({pits:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()):[]))}getActivePit(e){for(let t of e)if(!t.exitTime)return t}calculateActivePitRemainingMilliseconds(e,t){if(!t)return 0;let r=this.getActivePit(e);if(r){let i=new Date().getTime();return cF(r.entryTime.toDate(),t.minPitSeconds).getTime()-i}return 0}getLastRefuelPit(e){return e.filter(r=>r.refuel&&r.exitTime).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime()).at(0)}getLastDriverChangePit(e){if(e.length===0)return;let t=e.filter(r=>r.exitTime).sort((r,i)=>i.entryTime.toDate().getTime()-r.entryTime.toDate().getTime());for(let r of t)if(r.entryDriverId!==r.exitDriverId)return r}calculateCompletedDriverChanges(e){return e.filter(t=>t.exitTime).reduce((t,r)=>t+(r.entryDriverId!==r.exitDriverId?1:0),0)}calculateRemainingDriverChanges(e,t){return t?Math.max(0,t.minDriverChange-this.calculateCompletedDriverChanges(e)):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var Nc=class n{raceService=P(Vt);pitService=P(fn);raceConfigService=P(dt);optimizedStint=X(void 0);constructor(){Je({activeRace:De(this.raceService.activeRace),endRaceDate:De(this.raceService.endRaceDate),activeRaceConfig:De(this.raceConfigService.activeRaceConfig),remainingDriverChanges:De(this.pitService.remainingDriverChanges),lastDriverChangePit:De(this.pitService.lastDriverChangePit),ping:Yt(1e3)}).pipe(vt()).subscribe(({activeRace:e,endRaceDate:t,activeRaceConfig:r,remainingDriverChanges:i,lastDriverChangePit:s})=>{e&&t&&r?this.optimizedStint.set(this.calculateOptimizedStint(e,t,r,i,s)):this.optimizedStint.set(void 0)})}calculateOptimizedStint(e,t,r,i,s){let o=new Date;if(o>=t)return;let a=CF(r.minPitSeconds*i),c=Ui(t,o)-a,u=s?s.entryTime.toDate():e.start.toDate(),f=(Ui(t,u)-a)/(i+1),m=c/i;return{avgStintMillisecondsTime:f,laps:Math.floor(f/r.referenceLapTimeMillisecond),avgStintMillisecondsIfDriverChangedNow:m,lapsIfDriverChangeNow:Math.floor(m/r.referenceLapTimeMillisecond)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vn=class n extends Ln{collectionPath="/stints";collectionRef=cr(this.firestore,this.collectionPath);raceService=P(Vt);raceConfigService=P(dt);stintOptimizerService=P(Nc);activeRace=this.raceService.activeRace;stints=X([]);activeStint=X(void 0);activeStintTimeOnTrack=X(0);activeStintLaps=X(0);activeStintRemainingTimeOnTrack=X(0);activeStintRemainingLaps=X(0);activeStintGainedTimeOnTrack=X(0);activeStintGainedLaps=X(0);constructor(){super(),Je({stints:this.getRaceStints(),activeRaceConfig:De(this.raceConfigService.activeRaceConfig),optimizedStint:De(this.stintOptimizerService.optimizedStint),ping:Yt(1e3)}).pipe(vt()).subscribe(({stints:e,activeRaceConfig:t,optimizedStint:r})=>{this.stints.set(e),this.activeStint.set(this.getActiveStint(e)),this.activeStintTimeOnTrack.set(this.calculateActiveStintTimeOnTrack(this.activeStint())),this.activeStintLaps.set(this.calculateActiveStintLaps(this.activeStintTimeOnTrack(),t)),this.activeStintRemainingTimeOnTrack.set(this.calculateActiveStintRemainingTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintRemainingLaps.set(this.calculateActiveStintRemainingLaps(this.activeStintLaps(),r)),this.activeStintGainedTimeOnTrack.set(this.calculateActiveStintGainedTimeOnTrack(this.activeStintTimeOnTrack(),r)),this.activeStintGainedLaps.set(this.calculateActiveStintGainedLaps(this.activeStintLaps(),r))})}create(e){return _(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}update(e){return _(this,null,function*(){return yield this.updateData(e.id,e),e})}getRaceStints(){return Je({stints:ar(this.collectionRef),activeRace:De(this.activeRace)}).pipe(Ht(this.destroyed),Q(({stints:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id).sort((r,i)=>i.startDate.toDate().getTime()-r.startDate.toDate().getTime()):[]))}getActiveStint(e){for(let t of e)if(!t.endDate)return t}calculateActiveStintTimeOnTrack(e){return e?new Date().getTime()-e.startDate.toDate().getTime():0}calculateActiveStintLaps(e,t){return e>=0&&t?Math.floor(e/t.referenceLapTimeMillisecond):0}calculateActiveStintRemainingTimeOnTrack(e,t){return e>=0&&t?t.avgStintMillisecondsTime-e:0}calculateActiveStintRemainingLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r>0?r:0}calculateActiveStintGainedTimeOnTrack(e,t){let r=0;return e>=0&&t&&(r=t.avgStintMillisecondsTime-e),r<0?Math.abs(r):0}calculateActiveStintGainedLaps(e,t){let r=0;return e>=0&&t&&(r=t.laps-e),r<0?Math.abs(r):0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mc=class n{raceService=P(Vt);stintService=P(Vn);pitService=P(fn);activeRace=this.raceService.activeRace;activeStint=this.stintService.activeStint;activePit=this.pitService.activePit;startRace(e){return _(this,null,function*(){let t=this.createRace(),r=yield this.raceService.create(t);r&&(yield this.startStint(r.id,e,r.start))})}pitIn(e,t,r){return _(this,null,function*(){let i=this.activeRace(),s=this.activeStint();if(i&&s){let o=this.createPit(s.driverId,e,i.id,t,r),a=yield this.pitService.create(o);yield this.closeActiveStint(a.entryTime)}})}pitOut(){return _(this,null,function*(){let e=this.activeRace(),t=this.activePit();if(e&&t){let r=Rt.now(),i=yield this.startStint(e.id,t.exitDriverId,r);yield this.closeActivePit(i.startDate)}})}startStint(e,t,r){return _(this,null,function*(){let i=this.createStint(e,t,r);return yield this.stintService.create(i),i})}closeActiveStint(e){return _(this,null,function*(){let t=this.activeStint();t&&(t.endDate=e,yield this.stintService.update(t))})}closeActivePit(e){return _(this,null,function*(){let t=this.activePit();t&&(t.exitTime=e,yield this.pitService.update(t))})}createRace(){return{id:"1",start:Rt.now(),deleted:!1}}createStint(e,t,r){return{id:"1",deleted:!1,driverId:t,endDate:null,raceId:e,startDate:r}}createPit(e,t,r,i,s){return{id:"1",entryDriverId:e,entryTime:Rt.now(),exitDriverId:t,exitTime:null,raceId:r,refuel:i,tyreChange:s,deleted:!1}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var FF=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(Se(gi),Se(Br))}}static{this.\u0275dir=ft({type:n})}}return n})(),Cd=(()=>{class n extends FF{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,features:[Mn]})}}return n})(),Lc=new H(""),e7={provide:Lc,useExisting:er(()=>CT),multi:!0},CT=(()=>{class n extends Cd{writeValue(t){this.setProperty("checked",t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&we("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[$r([e7]),Mn]})}}return n})(),t7={provide:Lc,useExisting:er(()=>tg),multi:!0};function n7(){let n=Ti()?Ti().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var r7=new H(""),tg=(()=>{class n extends FF{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!n7())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(Se(gi),Se(Br),Se(r7,8))}}static{this.\u0275dir=ft({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&we("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[$r([t7]),Mn]})}}return n})();function IT(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var ng=new H(""),LF=new H("");function i7(n){return e=>{if(IT(e.value)||IT(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function s7(n){return IT(n.value)?{required:!0}:null}function DF(n){return null}function VF(n){return n!=null}function UF(n){return Js(n)?ct(n):n}function jF(n){let e={};return n.forEach(t=>{e=t!=null?j(j({},e),t):e}),Object.keys(e).length===0?null:e}function BF(n,e){return e.map(t=>t(n))}function o7(n){return!n.validate}function $F(n){return n.map(e=>o7(e)?e:t=>e.validate(t))}function a7(n){if(!n)return null;let e=n.filter(VF);return e.length==0?null:function(t){return jF(BF(t,e))}}function TT(n){return n!=null?a7($F(n)):null}function c7(n){if(!n)return null;let e=n.filter(VF);return e.length==0?null:function(t){let r=BF(t,e).map(UF);return pv(r).pipe(Q(jF))}}function bT(n){return n!=null?c7($F(n)):null}function AF(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function l7(n){return n._rawValidators}function u7(n){return n._rawAsyncValidators}function ET(n){return n?Array.isArray(n)?n:[n]:[]}function Qm(n,e){return Array.isArray(n)?n.includes(e):n===e}function RF(n,e){let t=ET(e);return ET(n).forEach(i=>{Qm(t,i)||t.push(i)}),t}function xF(n,e){return ET(e).filter(t=>!Qm(n,t))}var Ym=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=TT(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=bT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},kc=class extends Ym{get formDirective(){return null}get path(){return null}},Ed=class extends Ym{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Zm=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},d7={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Rme=Te(j({},d7),{"[class.ng-submitted]":"isSubmitted"}),Vc=(()=>{class n extends Zm{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Se(Ed,2))}}static{this.\u0275dir=ft({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Tf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Mn]})}}return n})(),Uc=(()=>{class n extends Zm{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Se(kc,10))}}static{this.\u0275dir=ft({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Tf("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Mn]})}}return n})();var vd="VALID",Km="INVALID",Pc="PENDING",_d="DISABLED",Fc=class{},Jm=class extends Fc{constructor(e,t){super(),this.value=e,this.source=t}},wd=class extends Fc{constructor(e,t){super(),this.pristine=e,this.source=t}},Id=class extends Fc{constructor(e,t){super(),this.touched=e,this.source=t}},Oc=class extends Fc{constructor(e,t){super(),this.status=e,this.source=t}};function HF(n){return(rg(n)?n.validators:n)||null}function h7(n){return Array.isArray(n)?TT(n):n||null}function qF(n,e){return(rg(e)?e.asyncValidators:n)||null}function f7(n){return Array.isArray(n)?bT(n):n||null}function rg(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function p7(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Y(1e3,"");if(!r[t])throw new Y(1001,"")}function m7(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Y(1002,"")})}var Xm=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Pe(()=>this.statusReactive()),this.statusReactive=X(void 0),this._pristine=Pe(()=>this.pristineReactive()),this.pristineReactive=X(!0),this._touched=Pe(()=>this.touchedReactive()),this.touchedReactive=X(!1),this._events=new ht,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return rr(this.statusReactive)}set status(e){rr(()=>this.statusReactive.set(e))}get valid(){return this.status===vd}get invalid(){return this.status===Km}get pending(){return this.status==Pc}get disabled(){return this.status===_d}get enabled(){return this.status!==_d}get pristine(){return rr(this.pristineReactive)}set pristine(e){rr(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return rr(this.touchedReactive)}set touched(e){rr(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(RF(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(RF(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(xF(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(xF(e,this._rawAsyncValidators))}hasValidator(e){return Qm(this._rawValidators,e)}hasAsyncValidator(e){return Qm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Te(j({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Id(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Id(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Te(j({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new wd(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new wd(!0,r))}markAsPending(e={}){this.status=Pc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Oc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Te(j({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=_d,this.errors=null,this._forEachChild(i=>{i.disable(Te(j({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Jm(this.value,r)),this._events.next(new Oc(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Te(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=vd,this._forEachChild(r=>{r.enable(Te(j({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Te(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vd||this.status===Pc)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Jm(this.value,t)),this._events.next(new Oc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Te(j({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?_d:vd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Pc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=UF(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Oc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Mt,this.statusChanges=new Mt}_calculateStatus(){return this._allControlsDisabled()?_d:this.errors?Km:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Pc)?Pc:this._anyControlsHaveStatus(Km)?Km:vd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new wd(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Id(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){rg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=h7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=f7(this._rawAsyncValidators)}},eg=class extends Xm{constructor(e,t,r){super(HF(t),qF(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){m7(this,!0,e),Object.keys(e).forEach(r=>{p7(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var ST=new H("CallSetDisabledState",{providedIn:"root",factory:()=>DT}),DT="always";function g7(n,e){return[...e.path,n]}function GF(n,e,t=DT){zF(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),_7(n,e),w7(n,e),y7(n,e),v7(n,e)}function NF(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function v7(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function zF(n,e){let t=l7(n);e.validator!==null?n.setValidators(AF(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=u7(n);e.asyncValidator!==null?n.setAsyncValidators(AF(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();NF(e._rawValidators,i),NF(e._rawAsyncValidators,i)}function _7(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&WF(n,e)})}function y7(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&WF(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function WF(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function w7(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function I7(n,e){n==null,zF(n,e)}function E7(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function C7(n){return Object.getPrototypeOf(n.constructor)===Cd}function T7(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function b7(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===tg?t=s:C7(s)?r=s:i=s}),i||r||t||null}var S7={provide:kc,useExisting:er(()=>Uo)},yd=Promise.resolve(),Uo=(()=>{class n extends kc{get submitted(){return rr(this.submittedReactive)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=Pe(()=>this.submittedReactive()),this.submittedReactive=X(!1),this._directives=new Set,this.ngSubmit=new Mt,this.form=new eg({},TT(t),bT(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){yd.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),GF(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){yd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){yd.then(()=>{let r=this._findContainer(t.path),i=new eg({});I7(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){yd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){yd.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),T7(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||n)(Se(ng,10),Se(LF,10),Se(ST,8))}}static{this.\u0275dir=ft({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&we("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$r([S7]),Mn]})}}return n})();function MF(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function PF(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var D7=class extends Xm{constructor(e=null,t,r){super(HF(t),qF(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),rg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(PF(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){MF(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){MF(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){PF(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var A7={provide:Ed,useExisting:er(()=>jo)},OF=Promise.resolve(),jo=(()=>{class n extends Ed{constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new D7,this._registered=!1,this.name="",this.update=new Mt,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=b7(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),E7(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){GF(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){OF.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&Hl(r);OF.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?g7(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(Se(kc,9),Se(ng,10),Se(LF,10),Se(Lc,10),Se(ls,8),Se(ST,8))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[$r([A7]),Mn,mi]})}}return n})(),jc=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=ft({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})(),R7={provide:Lc,useExisting:er(()=>AT),multi:!0},AT=(()=>{class n extends Cd{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&we("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[$r([R7]),Mn]})}}return n})();var x7={provide:Lc,useExisting:er(()=>Bc),multi:!0};function KF(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function N7(n){return n.split(":")[0]}var Bc=(()=>{class n extends Cd{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r=this._getOptionId(t),i=KF(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=N7(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&we("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[$r([x7]),Mn]})}}return n})(),ig=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(KF(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(Se(Br),Se(gi),Se(Bc,9))}}static{this.\u0275dir=ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})(),M7={provide:Lc,useExisting:er(()=>QF),multi:!0};function kF(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function P7(n){return n.split(":")[0]}var QF=(()=>{class n extends Cd{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(s=>this._getOptionId(s));r=(s,o)=>{s._setSelected(i.indexOf(o.toString())>-1)}}else r=(i,s)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],s=r.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let c=o[a],u=this._getOptionValue(c.value);i.push(u)}}else{let o=r.options;for(let a=0;a<o.length;a++){let c=o[a];if(c.selected){let u=this._getOptionValue(c.value);i.push(u)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=P7(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&we("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[$r([M7]),Mn]})}}return n})(),sg=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(kF(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(kF(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(Se(Br),Se(gi),Se(QF,9))}}static{this.\u0275dir=ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();function O7(n){return typeof n=="number"?n:parseFloat(n)}var YF=(()=>{class n{constructor(){this._validator=DF}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):DF,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=ft({type:n,features:[mi]})}}return n})();var k7={provide:ng,useExisting:er(()=>RT),multi:!0},RT=(()=>{class n extends YF{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>O7(t),this.createValidator=t=>i7(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&$l("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[$r([k7]),Mn]})}}return n})(),F7={provide:ng,useExisting:er(()=>xT),multi:!0};var xT=(()=>{class n extends YF{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Hl,this.createValidator=t=>s7}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=_r(n)))(i||n)}})()}static{this.\u0275dir=ft({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&$l("required",i._enabled?"":null)},inputs:{required:"required"},features:[$r([F7]),Mn]})}}return n})();var L7=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Ks({type:n})}static{this.\u0275inj=Ws({})}}return n})();var $c=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ST,useValue:t.callSetDisabledState??DT}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Ks({type:n})}static{this.\u0275inj=Ws({imports:[L7]})}}return n})();var og=class n extends Ln{collectionPath="/laps";collectionRef=cr(this.firestore,this.collectionPath);raceService=P(Vt);laps=X([]);constructor(){super(),Je({laps:this.getRaceLaps(),activeRace:De(this.raceService.activeRace)}).pipe(vt()).subscribe(e=>this.laps.set(e.laps))}getRaceLaps(){return Je({laps:ar(this.collectionRef),activeRace:De(this.raceService.activeRace)}).pipe(Ht(this.destroyed),Q(({laps:e,activeRace:t})=>t?e.filter(r=>!r.deleted&&r.raceId===t.id):[]))}create(e){return _(this,null,function*(){return e.id=yield this.generateNextId(),yield this.createData(e.id,e),e})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var ei=class n extends Ln{collectionPath="/drivers";collectionRef=cr(this.firestore,this.collectionPath);lapService=P(og);stintService=P(Vn);raceConfigService=P(dt);drivers=X([]);driversReferenceLapTimeMap=X(new Map);driversTimeOnTrackMap=X(new Map);driversTimeOnTrackWarningMap=X(new Map);driversStintCountMap=X(new Map);driverWithLessTimeOnTrack=X(void 0);driversTimeOnTrackWarningCount=Pe(()=>{let e=this.driversTimeOnTrackWarningMap(),t=0;return e.forEach(r=>{r&&t++}),t});constructor(){super(),Je({drivers:this.getAll(),laps:De(this.lapService.laps),stints:De(this.stintService.stints),activeRaceConfig:De(this.raceConfigService.activeRaceConfig),ping:Yt(1e3)}).pipe(vt()).subscribe(({drivers:e,laps:t,stints:r,activeRaceConfig:i})=>{this.drivers.set(e),this.driversReferenceLapTimeMap.set(this.createDriverReferenceLapTimeMap(t,e)),this.driversTimeOnTrackMap.set(this.createDriverTrackTimeMap(r,e)),this.driversTimeOnTrackWarningMap.set(this.createDriversTimeOnTrackWarningMap(this.driversTimeOnTrackMap(),i)),this.driversStintCountMap.set(this.createDriverStintCountMap(r,e)),this.driverWithLessTimeOnTrack.set(this.getDriverWithLessTimeOnTrack(r,e))})}getAll(){return ar(this.collectionRef).pipe(Ht(this.destroyed),Q(e=>e.filter(t=>!t.deleted)))}createDriverReferenceLapTimeMap(e,t){let r=new Map;t.forEach(s=>{r.set(s.id,0)});let i=e.reduce((s,o)=>(s[o.driverId]||(s[o.driverId]=[]),s[o.driverId].push(o.millisecondsTime),s),{});for(let s in i){let o=i[s],a=o.reduce((c,u)=>c+u,0)/o.length;r.set(s,a)}return r}createDriverTrackTimeMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{let s;i.endDate?s=i.endDate.toDate().getTime()-i.startDate.toDate().getTime():s=new Date().getTime()-i.startDate.toDate().getTime(),r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+s):r.set(i.driverId,s)}),r}createDriversTimeOnTrackWarningMap(e,t){let r=new Map;if(t){let i=yT(t.minDriverOnTrackHour),s=yT(t.maxDriverOnTrackHour),o=zm(t.warningDriverOnTrackThresholdMinute);e.forEach((a,c)=>{let u=a<i,d=s-a<=o;r.set(c,u||d)})}return r}createDriverStintCountMap(e,t){let r=new Map;return t.forEach(i=>{r.set(i.id,0)}),e.forEach(i=>{r.has(i.driverId)?r.set(i.driverId,r.get(i.driverId)+1):r.set(i.driverId,1)}),r}getDriverWithLessTimeOnTrack(e,t){if(t.length===0)return;let r=this.createDriverTrackTimeMap(e,t),i=e.find(c=>c.endDate===null)?.driverId,s=new Map(t.map(c=>[c.id,c])),o=1/0,a;return r.forEach((c,u)=>{u!==i&&c<o&&(o=c,a=s.get(u))}),a}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};function V7(n,e){if(n&1&&(b(0,"option",7),N(1),S()),n&2){let t=e.$implicit;re("value",t.id),k(),K(" ",t.raceName," ")}}function U7(n,e){if(n&1){let t=Zs();b(0,"div",0)(1,"div",2)(2,"form")(3,"label",3),N(4,"Start driver"),S(),b(5,"select",4),_i("ngModelChange",function(i){qt(t);let s=Z();return as(s.selectedDriver,i)||(s.selectedDriver=i),Gt(i)}),we("change",function(){qt(t);let i=Z();return Gt(i.updateDriverId())}),ae(6,V7,2,2,"option",5),S()()(),b(7,"button",6),we("click",function(){qt(t);let i=Z();return Gt(i.startRace())}),N(8," Start race "),S()()}if(n&2){let t=Z();k(5),vi("ngModel",t.selectedDriver),k(),re("ngForOf",t.drivers())}}function j7(n,e){if(n&1&&(b(0,"div",1),N(1),S()),n&2){let t=Z();k(),K(" ",t.endRaceCountdown," ")}}var ag=class n{raceService=P(Vt);raceConfigService=P(dt);raceManagerService=P(Mc);driverService=P(ei);drivers=this.driverService.drivers;endRaceDate=this.raceService.endRaceDate;endRaceCountdown="--:--:--";selectedDriver="1";constructor(){Je({endRaceDate:De(this.endRaceDate),ping:Yt(1e3)}).pipe(vt()).subscribe(e=>{this.endRaceCountdown=Vo(e.endRaceDate)}),Ii(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.startRaceDriverId)})}startRace(){this.raceManagerService.startRace(this.selectedDriver)}updateDriverId(){this.raceConfigService.updateStartRaceDriverId(this.selectedDriver)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-race"]],standalone:!0,features:[Ke],decls:2,vars:1,consts:[[1,"flex","items-center","justify-center"],[1,"text-2xl","md:text-4xl","font-bold","font-mono","dark:text-white"],[1,"font-bold","mr-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bg-green-500","hover:bg-green-700","text-white","font-bold","py-2","px-4","rounded",3,"click"],[3,"value"]],template:function(t,r){t&1&&ae(0,U7,9,2,"div",0)(1,j7,2,1,"div",1),t&2&&ge(r.endRaceDate()?1:0)},dependencies:[$c,jc,ig,sg,Bc,Vc,Uc,jo,Uo,Hr]})};var Hc=class n{raceService=P(Vt);raceConfigService=P(dt);pitService=P(fn);openingTime=X(void 0);closingTime=X(void 0);tyreChangeWindowOpen=X(!1);remainingTyreChange=X(0);constructor(){Je({pits:De(this.pitService.pits),activeRace:De(this.raceService.activeRace),raceConfig:De(this.raceConfigService.activeRaceConfig),ping:Yt(1e3)}).pipe(vt()).subscribe(({pits:e,activeRace:t,raceConfig:r})=>{t&&r?(this.openingTime.set(Rc(t.start.toDate(),r.startTyreChangeWindowHour)),this.closingTime.set(Rc(t.start.toDate(),r.endTyreChangeWindowHour)),this.tyreChangeWindowOpen.set(this.isTyreChangeWindowOpen(this.openingTime(),this.closingTime()))):(this.openingTime.set(void 0),this.closingTime.set(void 0),this.tyreChangeWindowOpen.set(!1)),r&&this.remainingTyreChange.set(this.calculateRemainingTyreChange(e,r.minTyreChange))})}isTyreChangeWindowOpen(e,t){if(e&&t){let r=new Date;return r>=e&&r<=t}return!1}calculateRemainingTyreChange(e,t){let r=e.filter(i=>i.tyreChange&&i.exitTime).length;return t-r}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var B7=n=>({"mb-2":n}),$7=n=>({"animate-bounce":n});function H7(n,e){if(n&1&&(b(0,"div",4),N(1),S()),n&2){let t=Z();k(),K(" Remaining: ",t.remainingTyreChange()," ")}}function q7(n,e){n&1&&(b(0,"div",5),N(1," Completed! "),S())}function G7(n,e){if(n&1&&(b(0,"div",6),N(1," Window open "),S()),n&2){let t=Z();re("ngClass",lt(1,$7,t.remainingTyreChange()>0))}}function z7(n,e){n&1&&(b(0,"div",7),N(1," Window closed "),S())}function W7(n,e){if(n&1&&(N(0),yi(1,"date")),n&2){let t=Z(2);K(" ",wi(1,1,t.openingTime(),"HH:mm:ss")," ")}}function K7(n,e){n&1&&N(0," --:--:-- ")}function Q7(n,e){if(n&1&&(N(0),yi(1,"date")),n&2){let t=Z(2);K(" ",wi(1,1,t.closingTime(),"HH:mm:ss")," ")}}function Y7(n,e){n&1&&N(0," --:--:-- ")}function Z7(n,e){if(n&1&&(b(0,"div",8)(1,"div")(2,"div",9),N(3,"Opening time"),S(),b(4,"div",10),ae(5,W7,2,4)(6,K7,1,0),S()(),b(7,"div")(8,"div",11),N(9,"Opening in"),S(),b(10,"div",12),N(11),S()()(),Ce(12,"hr",13),b(13,"div",14)(14,"div")(15,"div",9),N(16,"Closing time"),S(),b(17,"div",10),ae(18,Q7,2,4)(19,Y7,1,0),S()(),b(20,"div")(21,"div",11),N(22,"Closing in"),S(),b(23,"div",12),N(24),S()()()),n&2){let t=Z();k(5),ge(t.openingTime()?5:6),k(6),K(" ",t.countdownOpeningTime()," "),k(7),ge(t.closingTime()?18:19),k(6),K(" ",t.countdownClosingTime()," ")}}var cg=class n{tyreService=P(Hc);openingTime=this.tyreService.openingTime;closingTime=this.tyreService.closingTime;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;countdownOpeningTime=Pe(()=>Vo(this.tyreService.openingTime()));countdownClosingTime=Pe(()=>Vo(this.tyreService.closingTime()));isOpen=!1;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-tyre-change-window"]],standalone:!0,features:[Ke],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default",3,"ngClass"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F6DE} \u{1F504} Tyre change"),S(),b(4,"div",3),ae(5,H7,2,1,"div",4)(6,q7,2,0,"div",5)(7,G7,2,3,"div",6)(8,z7,2,0,"div",7),S()(),ae(9,Z7,25,4),S()),t&2&&(k(),re("ngClass",lt(4,B7,r.isOpen)),k(4),ge(r.remainingTyreChange()>0?5:6),k(2),ge(r.tyreChangeWindowOpen()?7:8),k(2),ge(r.isOpen?9:-1))},dependencies:[Da,It]})};var lg=class n{charge=100;batteryColor="bg-green-500";batteryBorderColor="border-gray-200";ngOnChanges(e){this.batteryColor=this.getBackgroundColor(this.charge),this.batteryBorderColor=this.getBorderColor(this.charge)}getBackgroundColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}getBorderColor(e){return e<=10?"border-red-500":e<=25?"border-orange-500":"border-gray-200"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-battery"]],inputs:{charge:"charge"},standalone:!0,features:[mi,Ke],decls:6,vars:6,consts:[[1,"w-16","lg:w-20","h-8","grid","grid-cols-6","items-center"],[1,"shadow","col-span-5","rounded","border-2","flex","relative",3,"ngClass"],[1,"cursor-default","leading-none","rounded-sm","flex","items-center","m-0.5","py-3",3,"ngClass"],[1,"absolute","right-2","text-black","font-semibold","font-mono"],[1,"ml-0.5","border-r-8","w-1","h-4","rounded-r",3,"ngClass"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),N(4),S()()(),Ce(5,"div",4),S()),t&2&&(k(),re("ngClass",r.batteryBorderColor),k(),Cf("width",r.charge,"%"),re("ngClass",r.batteryColor),k(2),sn(r.charge),k(),re("ngClass",r.batteryBorderColor))},dependencies:[It],changeDetection:0})};var ug=class n{raceService=P(Vt);pitService=P(fn);raceConfigService=P(dt);lastRefuelTime=X(void 0);emptyFuelTime=X(void 0);remainingFuelPercentage=X(100);remainingFuelLap=X(0);constructor(){Je({lastRefuelPit:De(this.pitService.lastRefuelPit),activeRace:De(this.raceService.activeRace),raceConfig:De(this.raceConfigService.activeRaceConfig),ping:Yt(1e3)}).pipe(vt()).subscribe(({lastRefuelPit:e,activeRace:t,raceConfig:r})=>{this.lastRefuelTime.set(this.getLastRefuelDate(e,t)),this.emptyFuelTime.set(this.calculateEmptyFuelTime(this.lastRefuelTime(),r)),this.remainingFuelLap.set(this.calculateRemainingFuelLaps(this.emptyFuelTime(),r)),this.remainingFuelPercentage.set(this.calculateRemainingFuelPercentage(this.emptyFuelTime(),r))})}getLastRefuelDate(e,t){if(e&&e.exitTime)return e.exitTime.toDate();if(t)return t.start.toDate()}calculateEmptyFuelTime(e,t){if(e&&t)return Fo(e,t.fuelDurationMinute)}calculateRemainingFuelPercentage(e,t){if(e&&t){let i=Gm(e,new Date)/t.fuelDurationMinute*100,s=Math.max(0,Math.min(i,100));return parseFloat(s.toFixed(0))}return 100}calculateRemainingFuelLaps(e,t){if(e&&t){let r=Ui(e,new Date);return Math.floor(r/t.referenceLapTimeMillisecond)}if(!e&&t){let r=zm(t.fuelDurationMinute);return Math.floor(r/t.referenceLapTimeMillisecond)}return 0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var J7=n=>({"mb-2":n}),X7=n=>({"animate-bounce":n});function eQ(n,e){if(n&1&&(N(0),yi(1,"date")),n&2){let t=Z(2);K(" ",wi(1,1,t.lastRefuelTime(),"HH:mm:ss")," ")}}function tQ(n,e){n&1&&N(0," --:--:-- ")}function nQ(n,e){if(n&1&&(N(0),yi(1,"date")),n&2){let t=Z(2);K(" ",wi(1,1,t.emptyFuelTime(),"HH:mm:ss")," ")}}function rQ(n,e){n&1&&N(0," --:--:-- ")}function iQ(n,e){if(n&1){let t=Zs();b(0,"div",7)(1,"div")(2,"div",8),N(3,"Last refuel time"),S(),b(4,"div",9),ae(5,eQ,2,4)(6,tQ,1,0),S()(),b(7,"div")(8,"div",10),N(9,"Since last refuel"),S(),b(10,"div",11),N(11),S()()(),Ce(12,"hr",12),b(13,"div",7)(14,"div")(15,"div",8),N(16,"Empty time"),S(),b(17,"div",9),ae(18,nQ,2,4)(19,rQ,1,0),S()(),b(20,"div")(21,"div",10),N(22,"Empty in"),S(),b(23,"div",11),N(24),S()()(),Ce(25,"hr",12),b(26,"div",13)(27,"div")(28,"div",8),N(29,"Remaining laps"),S(),b(30,"div",9),N(31),S()(),b(32,"div")(33,"div",10),N(34,"Fuel duration (min):"),S(),b(35,"div",14)(36,"button",15),we("click",function(){qt(t);let i=Z();return Gt(i.increaseFuelDuration())}),N(37,"+"),S(),b(38,"form",16),we("ngSubmit",function(){qt(t);let i=Z();return Gt(i.onSubmit())}),b(39,"input",17),_i("ngModelChange",function(i){qt(t);let s=Z();return as(s.fuelDurationMinute,i)||(s.fuelDurationMinute=i),Gt(i)}),S()(),b(40,"button",18),we("click",function(){qt(t);let i=Z();return Gt(i.decreaseFuelDuration())}),N(41,"-"),S()()()()}if(n&2){let t=Z();k(5),ge(t.lastRefuelTime()?5:6),k(6),K(" ",t.sinceLastRefuel()," "),k(7),ge(t.emptyFuelTime()?18:19),k(6),K(" ",t.emptyFuelCountdown()," "),k(7),K(" ",t.remainingFuelLap()," "),k(8),vi("ngModel",t.fuelDurationMinute)}}var dg=class n{raceConfigService=P(dt);fuelService=P(ug);remainingFuelPercentage=this.fuelService.remainingFuelPercentage;remainingFuelLap=this.fuelService.remainingFuelLap;emptyFuelTime=this.fuelService.emptyFuelTime;lastRefuelTime=this.fuelService.lastRefuelTime;emptyFuelCountdown=Pe(()=>Vo(this.emptyFuelTime()));sinceLastRefuel=Pe(()=>Cs(this.lastRefuelTime(),new Date));warning=Pe(()=>this.remainingFuelPercentage()<=20);remainingColor=Pe(()=>this.getRemainingColor(this.remainingFuelPercentage()));isOpen=!0;fuelDurationMinute=0;constructor(){Ii(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.fuelDurationMinute=e.fuelDurationMinute)})}onSubmit(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute)}increaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute+1)}decreaseFuelDuration(){this.raceConfigService.updateFuelDurationMinute(this.fuelDurationMinute-1)}getRemainingColor(e){return e<=10?"bg-red-500":e<=25?"bg-orange-500":e<=50?"bg-yellow-500":"bg-green-500"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-fuel"]],standalone:!0,features:[Ke],decls:11,vars:12,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center",3,"ngClass"],[1,"px-2","py-1","w-36","rounded-lg","text-left","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[1,"px-2","py-1","rounded-lg","text-center","text-white","font-medium","mr-1","hover:cursor-default",3,"ngClass"],[3,"charge"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"],[1,"flex","justify-end"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","mr-1","rounded",3,"click"],[1,"text-right",3,"ngSubmit"],["type","number","id","fuelDuration","name","fuelDuration","required","","min","1",1,"border","rounded-lg","px-2","py-1","w-20","text-right",3,"ngModelChange","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","active:bg-gray-400","text-black","px-4","ml-1","rounded",3,"click"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u26FD\uFE0F Fuel"),S(),b(4,"div",3)(5,"div",4),N(6),S(),b(7,"div",5),N(8),S(),Ce(9,"app-battery",6),S()(),ae(10,iQ,42,6),S()),t&2&&(k(),re("ngClass",lt(8,J7,r.isOpen)),k(3),re("ngClass",lt(10,X7,r.warning())),k(),re("ngClass",r.remainingColor()),k(),K(" Empty: ",r.emptyFuelCountdown()," "),k(),re("ngClass",r.remainingColor()),k(),K(" Laps: ",r.remainingFuelLap()," "),k(),re("charge",r.remainingFuelPercentage()),k(),ge(r.isOpen?10:-1))},dependencies:[It,Da,lg,$c,jc,tg,AT,Vc,Uc,xT,RT,jo,Uo]})};var sQ=n=>({"mb-2":n});function oQ(n,e){if(n&1&&(b(0,"div",6)(1,"div")(2,"div",7),N(3,"Optimized AVG time"),S(),b(4,"div",8),N(5),S()(),b(6,"div")(7,"div",9),N(8,"Laps"),S(),b(9,"div",10),N(10),S()()(),Ce(11,"hr",11),b(12,"div",12)(13,"div")(14,"div",7),N(15," Optimized AVG time "),b(16,"strong"),N(17,"if driver change now"),S()(),b(18,"div",8),N(19),S()(),b(20,"div")(21,"div",9),N(22,"Laps"),S(),b(23,"div",10),N(24),S()()()),n&2){let t=Z();k(5),K(" ",t.AVGStintTime()," "),k(5),K(" ",t.laps()," "),k(9),K(" ",t.AVGStintTimeIfDriverChangeNow()," "),k(5),K(" ",t.lapsIfDriverChangeNow()," ")}}var hg=class n{stintOptimizerService=P(Nc);AVGStintTime=Pe(()=>{let e=this.stintOptimizerService.optimizedStint();return e?Cn(e.avgStintMillisecondsTime):"--:--:--"});laps=Pe(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.laps:0});AVGStintTimeIfDriverChangeNow=Pe(()=>{let e=this.stintOptimizerService.optimizedStint();return e?Cn(e.avgStintMillisecondsIfDriverChangedNow):"--:--:--"});lapsIfDriverChangeNow=Pe(()=>{let e=this.stintOptimizerService.optimizedStint();return e?e.lapsIfDriverChangeNow:0});isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-stint-optimizer"]],standalone:!0,features:[Ke],decls:10,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F9E0} Stint optimizer"),S(),b(4,"div",3)(5,"div",4),N(6),S(),b(7,"div",5),N(8),S()()(),ae(9,oQ,25,4),S()),t&2&&(k(),re("ngClass",lt(4,sQ,r.isOpen)),k(5),K(" Optimum: ",r.AVGStintTime()," "),k(2),K(" Laps: ",r.laps()," "),k(),ge(r.isOpen?9:-1))},dependencies:[It]})};var aQ=n=>({"mb-2":n}),cQ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e}),lQ=n=>({"bg-yellow-500 text-white":n});function uQ(n,e){if(n&1&&(b(0,"div",4),N(1),S()),n&2){let t=Z();k(),K(" Warning: ",t.driversTimeOnTrackWarningCount()," ")}}function dQ(n,e){n&1&&(b(0,"div",5),N(1," Completed! "),S())}function hQ(n,e){if(n&1&&(b(0,"tr",17)(1,"td",18),N(2),S(),b(3,"td",19),N(4),S(),b(5,"td",20),N(6),S(),b(7,"td",21),N(8),S(),b(9,"td",22)(10,"div",23),N(11),S()()()),n&2){let t=e.$implicit,r=Z(2);re("ngClass",Sa(7,cQ,t.id===r.activeStintDriverId(),t.id!==r.activeStintDriverId())),k(2),sn(t.id),k(2),sn(t.raceName),k(2),K("",r.getDriverReferenceLapTime(t.id)," "),k(2),K(" ",r.getDriverStintCount(t.id)," "),k(2),re("ngClass",lt(10,lQ,r.getDriverTimeOnTrackWarning(t.id))),k(),K(" ",r.getDriverTimeOnTrack(t.id)," ")}}function fQ(n,e){if(n&1&&(b(0,"div",6)(1,"table",7)(2,"thead",8)(3,"tr"),Ce(4,"th",9),b(5,"th",10),N(6," Name "),S(),b(7,"th",11),N(8," Reference lap "),S(),b(9,"th",12),N(10," Stint "),S(),b(11,"th",13),N(12," On track "),S()()()(),b(13,"div",14)(14,"table",15)(15,"tbody"),ae(16,hQ,12,12,"tr",16),S()()()()),n&2){let t=Z();k(16),re("ngForOf",t.drivers())}}var fg=class n{driverService=P(ei);stintService=P(Vn);drivers=this.driverService.drivers;driversTimeOnTrackWarningCount=this.driverService.driversTimeOnTrackWarningCount;activeStintDriverId=Pe(()=>{let e=this.stintService.activeStint();if(e)return e.driverId});isOpen=!0;getDriverReferenceLapTime(e){return SF(this.driverService.driversReferenceLapTimeMap().get(e))}getDriverTimeOnTrack(e){return Cn(this.driverService.driversTimeOnTrackMap().get(e))}getDriverTimeOnTrackWarning(e){return this.driverService.driversTimeOnTrackWarningMap().get(e)||!1}getDriverStintCount(e){return this.driverService.driversStintCountMap().get(e)||0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-driver"]],standalone:!0,features:[Ke],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","3",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","text-black"],["colspan","3",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[1,"p-1","text-center","rounded",3,"ngClass"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F417} Driver"),S(),b(4,"div",3),ae(5,uQ,2,1,"div",4)(6,dQ,2,0,"div",5),S()(),ae(7,fQ,17,1,"div",6),S()),t&2&&(k(),re("ngClass",lt(3,aQ,r.isOpen)),k(4),ge(r.driversTimeOnTrackWarningCount()>0?5:6),k(2),ge(r.isOpen?7:-1))},dependencies:[It,Hr]})};var pg=class n{raceService=P(Vt);stintService=P(Vn);raceConfigService=P(dt);open=X(!1);openInMilliseconds=X(0);constructor(){Je({endRaceDate:De(this.raceService.endRaceDate),activeStint:De(this.stintService.activeStint),activeRaceConfig:De(this.raceConfigService.activeRaceConfig),ping:Yt(1e3)}).pipe(vt()).subscribe(({endRaceDate:e,activeStint:t,activeRaceConfig:r})=>{e&&t&&r?(this.open.set(this.calculatePitLaneOpen(e,t,r)),this.openInMilliseconds.set(this.calculatePitLaneOpenInMilliseconds(t,r))):(this.open.set(!1),this.openInMilliseconds.set(0))})}calculatePitLaneOpenInMilliseconds(e,t){let r=new Date().getTime();return Fo(e.startDate.toDate(),t.minStintMinute).getTime()-r}calculatePitLaneOpen(e,t,r){let i=new Date,s=TF(e,r.pitLaneCloseBeforeEndRaceMinute),o=EF(i,s),a=Fo(t.startDate.toDate(),r.minStintMinute),c=IF(i,a);return o&&c}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var mg=class n{audio=new Audio;constructor(){this.audio.addEventListener("error",e=>console.error("Audio error:",e))}play(){this.audio.play()}playFile(e){this.audio=new Audio(e),this.audio.play()}pause(){this.audio.pause()}stop(){this.audio.pause(),this.audio.currentTime=0}seek(e){this.audio.currentTime=e}setVolume(e){this.audio.volume=e}setLoop(e){this.audio.loop=e}on(e,t){this.audio.addEventListener(e,t)}off(e,t){this.audio.removeEventListener(e,t)}getCurrentTime(){return this.audio.currentTime}getDuration(){return this.audio.duration}static \u0275fac=function(t){return new(t||n)};static \u0275prov=B({token:n,factory:n.\u0275fac,providedIn:"root"})};var pQ=n=>({"mb-4":n}),mQ=n=>({"animate-bounce":n});function gQ(n,e){if(n&1&&(b(0,"div",3),N(1),S()),n&2){let t=Z();k(),K(" Open in: ",t.pitLaneOpenInMillisecondsString()," ")}}function vQ(n,e){n&1&&(b(0,"div",5),N(1," Open "),S())}function _Q(n,e){n&1&&(b(0,"div",6),N(1," Closed "),S())}function yQ(n,e){if(n&1&&(b(0,"option",20),N(1),S()),n&2){let t=e.$implicit;re("value",t.id),k(),K(" ",t.raceName," ")}}function wQ(n,e){if(n&1){let t=Zs();b(0,"div",11),N(1,"PIT SETTINGS"),S(),b(2,"form")(3,"div",12)(4,"label",13),N(5,"\u{1F417} Driver"),S(),b(6,"select",14),_i("ngModelChange",function(i){qt(t);let s=Z(2);return as(s.selectedDriver,i)||(s.selectedDriver=i),Gt(i)}),we("change",function(){qt(t);let i=Z(2);return Gt(i.updateDriverId())}),ae(7,yQ,2,2,"option",15),S()(),b(8,"div",12)(9,"label",16),N(10,"\u26FD\uFE0F Refueling"),S(),b(11,"input",17),we("change",function(){qt(t);let i=Z(2);return Gt(i.updateRefueling())}),_i("ngModelChange",function(i){qt(t);let s=Z(2);return as(s.refueling,i)||(s.refueling=i),Gt(i)}),S()(),b(12,"div",12)(13,"label",18),N(14,"\u{1F6DE} Tyre change"),S(),b(15,"input",19),_i("ngModelChange",function(i){qt(t);let s=Z(2);return as(s.tyreChange,i)||(s.tyreChange=i),Gt(i)}),we("change",function(){qt(t);let i=Z(2);return Gt(i.updateTyreChange())}),S()()()}if(n&2){let t=Z(2);k(6),re("disabled",t.activePit()!==void 0),vi("ngModel",t.selectedDriver),k(),re("ngForOf",t.drivers()),k(4),re("disabled",t.activePit()!==void 0),vi("ngModel",t.refueling),k(4),re("disabled",t.activePit()!==void 0||!t.tyreChangeWindowOpen()||t.remainingTyreChange()<=0),vi("ngModel",t.tyreChange)}}function IQ(n,e){if(n&1&&(b(0,"div",21),N(1),S()),n&2){let t=Z(3);re("ngClass",lt(2,mQ,t.activePitRemainingMilliseconds()<1e4)),k(),K(" Pit out enabled in: ",t.activePitRemainingMillisecondsString()," ")}}function EQ(n,e){n&1&&(b(0,"div",22),N(1," Pit out ready! "),S())}function CQ(n,e){if(n&1&&ae(0,IQ,2,4,"div",21)(1,EQ,2,0,"div",22),n&2){let t=Z(2);ge(t.activePitRemainingMilliseconds()>0?0:1)}}function TQ(n,e){if(n&1){let t=Zs();b(0,"div",7),ae(1,wQ,16,7)(2,CQ,2,1),S(),b(3,"div",8)(4,"button",9),we("click",function(){qt(t);let i=Z();return Gt(i.pitIn())}),N(5," Pit in "),S(),b(6,"button",10),we("click",function(){qt(t);let i=Z();return Gt(i.pitOut())}),N(7," Pit out "),S()()}if(n&2){let t=Z();k(),ge(t.activePit()?2:1),k(3),re("disabled",!t.pitLaneOpen()),k(2),re("disabled",!t.activePit()||t.activePit()&&t.activePitRemainingMilliseconds()>0)}}var gg=class n{pitLaneService=P(pg);pitService=P(fn);driverService=P(ei);raceManagerService=P(Mc);tyreService=P(Hc);raceConfigService=P(dt);audioService=P(mg);pitLaneOpen=this.pitLaneService.open;pitLaneOpenInMilliseconds=this.pitLaneService.openInMilliseconds;pitLaneOpenInMillisecondsString=Pe(()=>Cn(this.pitLaneService.openInMilliseconds()));activePit=this.pitService.activePit;activePitRemainingMilliseconds=this.pitService.activePitRemainingMilliseconds;activePitRemainingMillisecondsString=Pe(()=>bF(this.pitService.activePitRemainingMilliseconds()));drivers=this.driverService.drivers;remainingTyreChange=this.tyreService.remainingTyreChange;tyreChangeWindowOpen=this.tyreService.tyreChangeWindowOpen;isOpen=!0;refueling=!1;tyreChange=!1;selectedDriver="1";constructor(){Ii(()=>{let e=this.raceConfigService.activeRaceConfig();e&&(this.selectedDriver=e.nextPitDriverId,this.refueling=e.nextPitRefueling,this.tyreChange=e.nextPitTyreChange)})}pitIn(){return _(this,null,function*(){this.audioService.playFile("assets/box_box_box_box.mp3"),yield this.raceManagerService.pitIn(this.selectedDriver,this.refueling,this.tyreChange)})}pitOut(){return _(this,null,function*(){yield this.raceManagerService.pitOut(),this.raceConfigService.updateNextPitRefueling(!1),this.raceConfigService.updateNextPitTyreChange(!1);let e=this.driverService.driverWithLessTimeOnTrack();e&&this.raceConfigService.updateNextPitDriverId(e.id)})}updateDriverId(){this.raceConfigService.updateNextPitDriverId(this.selectedDriver)}updateTyreChange(){this.raceConfigService.updateNextPitTyreChange(this.tyreChange)}updateRefueling(){this.raceConfigService.updateNextPitRefueling(this.refueling)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-pit-lane"]],standalone:!0,features:[Ke],decls:9,vars:6,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","mr-1","hover:cursor-default"],[1,"flex","items-center"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-red-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","flex-col","items-center","mb-2"],[1,"flex","justify-between"],[1,"bg-green-500","hover:bg-green-700","disabled:bg-green-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"bg-red-500","hover:bg-red-700","disabled:bg-red-200","text-white","font-bold","py-2","px-4","rounded",3,"click","disabled"],[1,"font-semibold","mb-2"],[1,"mb-2"],["for","driverSelect",1,"mr-2"],["id","driverSelect","name","driverSelect",1,"border","rounded","p-1",3,"ngModelChange","change","disabled","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","refueling",1,"mr-2"],["type","checkbox","id","refueling","name","refueling",3,"change","ngModelChange","disabled","ngModel"],["for","tyreChange",1,"mr-2"],["type","checkbox","id","tyreChange","name","tyreChange",3,"ngModelChange","change","disabled","ngModel"],[3,"value"],[1,"bg-yellow-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default",3,"ngClass"],[1,"bg-green-500","p-2","rounded-lg","text-white","text-center","text-xl","font-black","hover:cursor-default"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F17F}\uFE0F Pit Lane"),S(),ae(4,gQ,2,1,"div",3),b(5,"div",4),ae(6,vQ,2,0,"div",5)(7,_Q,2,0,"div",6),S()(),ae(8,TQ,8,3),S()),t&2&&(k(),re("ngClass",lt(4,pQ,r.isOpen)),k(3),ge(r.pitLaneOpenInMilliseconds()>0?4:-1),k(2),ge(r.pitLaneOpen()?6:7),k(2),ge(r.isOpen?8:-1))},dependencies:[It,$c,jc,ig,sg,CT,Bc,Vc,Uc,jo,Uo,Hr]})};var bQ=n=>({"mb-2":n});function SQ(n,e){if(n&1&&(b(0,"div",4),N(1),S()),n&2){let t=Z();k(),K(" Remaining: ",t.remainingDriverChanges()," ")}}function DQ(n,e){n&1&&(b(0,"div",5),N(1," Completed! "),S())}function AQ(n,e){if(n&1&&(b(0,"div",6)(1,"div")(2,"div",7),N(3,"Competed"),S(),b(4,"div",8),N(5),S()(),b(6,"div")(7,"div",9),N(8,"Remaining"),S(),b(9,"div",10),N(10),S()()()),n&2){let t=Z();k(5),K(" ",t.completedDriverChanges()," "),k(5),K(" ",t.remainingDriverChanges()," ")}}var vg=class n{pitService=P(fn);remainingDriverChanges=this.pitService.remainingDriverChanges;completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!1;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-driver-change"]],standalone:!0,features:[Ke],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F417} \u{1F504} Driver change"),S(),b(4,"div",3),ae(5,SQ,2,1,"div",4)(6,DQ,2,0,"div",5),S()(),ae(7,AQ,11,2,"div",6),S()),t&2&&(k(),re("ngClass",lt(3,bQ,r.isOpen)),k(4),ge(r.remainingDriverChanges()>0?5:6),k(2),ge(r.isOpen?7:-1))},dependencies:[It]})};var RQ=n=>({"mb-2":n});function xQ(n,e){if(n&1&&(b(0,"div",4),N(1),S(),b(2,"div",5),N(3),S()),n&2){let t=Z(2);k(),K(" Remaining: ",t.activeStintRemainingTimeOnTrackString()," "),k(2),K(" Laps: ",t.activeStintRemainingLaps()," ")}}function NQ(n,e){if(n&1&&(b(0,"div",6),N(1),S(),b(2,"div",7),N(3),S()),n&2){let t=Z(2);k(),K(" Gained: ",t.activeStintGainedTimeOnTrackString()," "),k(2),K(" Laps: ",t.activeStintGainedLaps()," ")}}function MQ(n,e){if(n&1&&ae(0,xQ,4,2)(1,NQ,4,2),n&2){let t=Z();ge(t.activeStintRemainingTimeOnTrack()>0?0:1)}}function PQ(n,e){if(n&1&&N(0),n&2){let t=Z(2);K(" ",t.activeStintRemainingTimeOnTrackString()," ")}}function OQ(n,e){n&1&&N(0," --:--:-- ")}function kQ(n,e){if(n&1&&N(0),n&2){let t=Z(2);K(" ",t.activeStintRemainingLaps()," ")}}function FQ(n,e){n&1&&N(0," 0 ")}function LQ(n,e){if(n&1&&(b(0,"div",8)(1,"div")(2,"div",9),N(3,"Time on track"),S(),b(4,"div",10),N(5),S()(),b(6,"div")(7,"div",11),N(8,"Laps"),S(),b(9,"div",12),N(10),S()()(),Ce(11,"hr",13),b(12,"div",8)(13,"div")(14,"div",9),N(15,"Remaining time on track"),S(),b(16,"div",10),ae(17,PQ,1,1)(18,OQ,1,0),S()(),b(19,"div")(20,"div",11),N(21,"Remaining laps"),S(),b(22,"div",12),ae(23,kQ,1,1)(24,FQ,1,0),S()()(),Ce(25,"hr",13),b(26,"div",14)(27,"div")(28,"div",9),N(29,"Gained time on track"),S(),b(30,"div",10),N(31),S()(),b(32,"div")(33,"div",11),N(34,"Gained laps"),S(),b(35,"div",12),N(36),S()()()),n&2){let t=Z();k(5),K(" ",t.activeStintTimeOnTrackString()," "),k(5),K(" ",t.activeStintLaps()," "),k(7),ge(t.activeStint()?17:18),k(6),ge(t.activeStint()?23:24),k(8),K(" ",t.activeStintGainedTimeOnTrackString()," "),k(5),K(" ",t.activeStintGainedLaps()," ")}}var _g=class n{stintService=P(Vn);activeStint=this.stintService.activeStint;activeStintRemainingTimeOnTrack=this.stintService.activeStintRemainingTimeOnTrack;activeStintTimeOnTrackString=Pe(()=>Cn(this.stintService.activeStintTimeOnTrack()));activeStintRemainingTimeOnTrackString=Pe(()=>Cn(this.stintService.activeStintRemainingTimeOnTrack()));activeStintGainedTimeOnTrackString=Pe(()=>Cn(this.stintService.activeStintGainedTimeOnTrack()));activeStintLaps=this.stintService.activeStintLaps;activeStintRemainingLaps=this.stintService.activeStintRemainingLaps;activeStintGainedLaps=this.stintService.activeStintGainedLaps;isOpen=!0;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-active-stint"]],standalone:!0,features:[Ke],decls:7,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-yellow-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","mr-1","font-medium","hover:cursor-default"],[1,"bg-green-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"flex","justify-between","mb-2"],[1,"text-gray-600"],[1,"text-black","font-mono"],[1,"text-gray-600","text-right"],[1,"text-black","font-mono","text-right"],[1,"mb-2"],[1,"flex","justify-between"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F3CE}\uFE0F \u{1F4A8} Active stint"),S(),b(4,"div",3),ae(5,MQ,2,1),S()(),ae(6,LQ,37,6),S()),t&2&&(k(),re("ngClass",lt(3,RQ,r.isOpen)),k(4),ge(r.activeStint()?5:-1),k(),ge(r.isOpen?6:-1))},dependencies:[It]})};var VQ=n=>({"mb-2":n}),UQ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function jQ(n,e){if(n&1&&(N(0),yi(1,"date")),n&2){let t=Z().$implicit;K(" ",wi(1,1,t.endDate.toDate(),"HH:mm:ss")," ")}}function BQ(n,e){if(n&1&&(b(0,"tr",19)(1,"td",20),N(2),S(),b(3,"td",21),N(4),S(),b(5,"td",22),N(6),yi(7,"date"),S(),b(8,"td",22),ae(9,jQ,2,4),S(),b(10,"td",22),N(11),S()()),n&2){let t=e.$implicit,r=Z(2);re("ngClass",Sa(9,UQ,t.id===r.activeStintId(),t.id!==r.activeStintId())),k(2),sn(t.id),k(2),K("",r.getDriverRacingName(t.driverId)," "),k(2),sn(wi(7,6,t.startDate.toDate(),"HH:mm:ss")),k(3),ge(t.endDate?9:-1),k(2),K(" ",r.calculateTimeOnTrack(t.startDate.toDate(),t.endDate==null?null:t.endDate.toDate())," ")}}function $Q(n,e){if(n&1&&(b(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),Ce(4,"th",8),b(5,"th",9),N(6,"Driver"),S(),b(7,"th",10),N(8,"Start"),S(),b(9,"th",10),N(10,"End"),S(),b(11,"th",10),N(12,"On track"),S()()()(),b(13,"div",11)(14,"table",12)(15,"tbody"),ae(16,BQ,12,12,"tr",13),S()()(),b(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),N(22,"Totals"),S(),b(23,"td",18),N(24),S()()()()()()),n&2){let t=Z();k(16),re("ngForOf",t.stints()),k(8),sn(t.calculateTotalTimeOnTrack())}}var yg=class n{stintService=P(Vn);driverService=P(ei);stints=this.stintService.stints;activeStintId=Pe(()=>{let e=this.stintService.activeStint();if(e)return e.id});isOpen=!0;getDriverRacingName(e){let r=this.driverService.drivers().find(i=>i.id===e);return r?r.raceName:""}calculateTimeOnTrack(e,t){return t?Cs(e,t):Cs(e,new Date)}calculateTotalTimeOnTrack(){let e=this.stintService.stints(),t=0;return e.forEach(r=>{r.endDate?t+=r.endDate.toDate().getTime()-r.startDate.toDate().getTime():t+=new Date().getTime()-r.startDate.toDate().getTime()}),Cn(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-stint"]],standalone:!0,features:[Ke],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],["colspan","6",1,"py-2","px-3","border-b","border-gray-200","text-sm","xl:text-base","text-black"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-sm","xl:text-base","text-black"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u23F3 Stint"),S(),b(4,"div",3)(5,"div",4),N(6),S()()(),ae(7,$Q,25,2,"div",5),S()),t&2&&(k(),re("ngClass",lt(3,VQ,r.isOpen)),k(5),K(" Total: ",r.stints().length," "),k(),ge(r.isOpen&&r.stints().length>0?7:-1))},dependencies:[It,Hr,Da]})};var HQ=n=>({"mb-2":n});function qQ(n,e){}var wg=class n{isOpen=!1;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-lap"]],standalone:!0,features:[Ke],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u23F1\uFE0F Lap"),S(),b(4,"div",3)(5,"div",4),N(6),S()()(),ae(7,qQ,0,0),S()),t&2&&(k(),re("ngClass",lt(3,HQ,r.isOpen)),k(5),K(" Reference: ",0," "),k(),ge(r.isOpen?7:-1))},dependencies:[It]})};var GQ=n=>({"mb-2":n}),zQ=(n,e)=>({"bg-green-100 font-semibold":n,"hover:bg-gray-50":e});function WQ(n,e){n&1&&N(0," \u2705 ")}function KQ(n,e){n&1&&N(0," \u2705 ")}function QQ(n,e){n&1&&N(0," \u2705 ")}function YQ(n,e){if(n&1&&(b(0,"tr",20)(1,"td",17),N(2),S(),b(3,"td",21),ae(4,WQ,1,0),S(),b(5,"td",22),ae(6,KQ,1,0),S(),b(7,"td",22),ae(8,QQ,1,0),S(),b(9,"td",23),N(10),S()()),n&2){let t=e.$implicit,r=Z(2);re("ngClass",Sa(6,zQ,t.id===r.activePitId(),t.id!==r.activePitId())),k(2),sn(t.id),k(2),ge(t.entryDriverId!==t.exitDriverId?4:-1),k(2),ge(t.refuel?6:-1),k(2),ge(t.tyreChange?8:-1),k(2),K(" ",r.calculatePitTime(t.entryTime.toDate(),t.exitTime==null?null:t.exitTime.toDate())," ")}}function ZQ(n,e){if(n&1&&(b(0,"div",5)(1,"table",6)(2,"thead",7)(3,"tr"),Ce(4,"th",8),b(5,"th",9),N(6,"\u{1F417} \u{1F504}"),S(),b(7,"th",9),N(8,"\u26FD\uFE0F"),S(),b(9,"th",9),N(10,"\u{1F6DE} \u{1F504}"),S(),b(11,"th",10),N(12,"Time"),S()()()(),b(13,"div",11)(14,"table",12)(15,"tbody"),ae(16,YQ,11,9,"tr",13),S()()(),b(17,"div",14)(18,"table",12)(19,"tfoot",15)(20,"tr",16)(21,"td",17),N(22,"Totals"),S(),b(23,"td",18),N(24),S(),b(25,"td",18),N(26),S(),b(27,"td",18),N(28),S(),b(29,"td",19),N(30),S()()()()()()),n&2){let t=Z();k(16),re("ngForOf",t.pits()),k(8),sn(t.completedDriverChanges()),k(2),sn(t.calculateTotalRefueling()),k(2),sn(t.calculateTotalTyreChanges()),k(2),sn(t.calculateTotalPitTime())}}var Ig=class n{pitService=P(fn);pits=this.pitService.pits;activePitId=Pe(()=>{let e=this.pitService.activePit();if(e)return e.id});completedDriverChanges=this.pitService.completedDriverChanges;isOpen=!0;calculatePitTime(e,t){return t?Cs(e,t):Cs(e,new Date)}calculateTotalPitTime(){let e=this.pitService.pits(),t=0;return e.forEach(r=>{r.exitTime?t+=r.exitTime.toDate().getTime()-r.entryTime.toDate().getTime():t+=new Date().getTime()-r.entryTime.toDate().getTime()}),Cn(t)}calculateTotalRefueling(){return this.pitService.pits().filter(e=>e.refuel).length}calculateTotalTyreChanges(){return this.pitService.pits().filter(e=>e.tyreChange).length}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-pit"]],standalone:!0,features:[Ke],decls:8,vars:5,consts:[[1,"bg-white","shadow-md","rounded-lg","p-2","md:p-3","lg:p-4","w-auto","mx-auto","border","hover:shadow-xl"],[1,"flex","justify-between","items-center","hover:cursor-pointer",3,"click","ngClass"],[1,"text-lg","lg:text-xl","font-bold"],[1,"flex","items-center"],[1,"bg-blue-500","px-2","py-1","rounded-lg","text-white","text-center","font-medium","hover:cursor-default"],[1,"max-h-72","flex","flex-col","overflow-clip"],[1,"w-full","bg-white","table-fixed"],[1,"sticky","top-0"],[1,"py-2","px-3","border-b","border-gray-200","text-left","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","font-medium","text-gray-700"],[1,"flex-1","overflow-y-auto"],[1,"w-full","table-fixed"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"flex"],[1,"sticky","bottom-0-0"],[1,"bg-gray-100","font-bold"],[1,"py-2","px-3","border-b","border-gray-200","text-sm","xl:text-base","text-black"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],[3,"ngClass"],[1,"py-2","px-3","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black"],[1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"],["colspan","2",1,"py-2","border-b","border-gray-200","text-center","text-sm","xl:text-base","text-black","font-mono"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1),we("click",function(){return r.isOpen=!r.isOpen}),b(2,"div",2),N(3,"\u{1F468}\u{1F3FB}\u200D\u{1F527} Pit"),S(),b(4,"div",3)(5,"div",4),N(6),S()()(),ae(7,ZQ,31,5,"div",5),S()),t&2&&(k(),re("ngClass",lt(3,GQ,r.isOpen)),k(5),K(" Total: ",r.pits().length," "),k(),ge(r.isOpen&&r.pits().length>0?7:-1))},dependencies:[It,Hr]})};var Eg=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=We({type:n,selectors:[["app-root"]],standalone:!0,features:[Ke],decls:43,vars:0,consts:[[1,"w-full","h-full","min-h-full","dark:bg-black"],[1,"p-4","grid","grid-cols-2","lg:grid-cols-3","gap-3"],[1,"text-xl","md:text-3xl","dark:text-white","font-semibold"],[1,"text-right","lg:text-center"],[1,"mx-4","grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3","mb-4"],[1,"flex-col","md:h-fit"],[1,"mb-3","lg:mb-4"],[1,"lg:mb-4"],[1,"flex-col"],[1,"mx-4","lg:mb-4","dark:text-white"],[1,"flex","flex-col","justify-center","items-center"],["src","assets/cremona_circuit.jpg","alt","Circuito",1,"max-w-sm","md:max-w-md"]],template:function(t,r){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),N(3,"\u{1F3CE}\uFE0F dash-boar \u{1F417}"),S(),b(4,"div",3),Ce(5,"app-race"),S()(),b(6,"div",4)(7,"div",5)(8,"div",6),Ce(9,"app-pit-lane"),S(),b(10,"div",6),Ce(11,"app-driver-change"),S(),b(12,"div",6),Ce(13,"app-tyre-change-window"),S(),b(14,"div",7),Ce(15,"app-pit"),S()(),b(16,"div",8)(17,"div",6),Ce(18,"app-fuel"),S(),b(19,"div",6),Ce(20,"app-lap"),S(),b(21,"div",7),Ce(22,"app-driver"),S()(),b(23,"div",8)(24,"div",6),Ce(25,"app-active-stint"),S(),b(26,"div",6),Ce(27,"app-stint-optimizer"),S(),b(28,"div",7),Ce(29,"app-stint"),S()()(),b(30,"div",9)(31,"strong"),N(32,"TODO:"),S(),Ce(33,"br"),N(34," - Driver: sistemare gestione warning"),Ce(35,"br"),N(36," - Componente per gestione reference lap time"),Ce(37,"br"),S(),b(38,"div",10)(39,"div",2),N(40,"Cremona kart circuit"),S(),Ce(41,"img",11),S()(),Ce(42,"router-outlet"))},dependencies:[nw,ag,cg,dg,hg,fg,gg,vg,_g,yg,wg,Ig]})};tx(Eg,tF).catch(n=>console.error(n));
